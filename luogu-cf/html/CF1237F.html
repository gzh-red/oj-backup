<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Balanced Domino Placements - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573403548:XNfFFzFyzVteCt7cJzQ1h7+Yif6yvLpzOMRq+J9W2Ac=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Consider%20a%20square%20grid%20with%20%24%20h%20%24%20rows%20and%20%24%20w%20%24%20columns%20with%20some%20dominoes%20on%20it.%20Each%20domino%20covers%20exactly%20two%20cells%20of%20the%20grid%20that%20share%20a%20common%20side.%20Every%20cell%20is%20covered%20by%20at%20most%20one%20domino.%5Cn%5CnLet%27s%20call%20a%20placement%20of%20dominoes%20on%20the%20grid%20perfectly%20balanced%20if%20no%20row%20and%20no%20column%20contains%20a%20pair%20of%20cells%20covered%20by%20two%20different%20dominoes.%20In%20other%20words%2C%20every%20row%20and%20column%20may%20contain%20no%20covered%20cells%2C%20one%20covered%20cell%2C%20or%20two%20covered%20cells%20that%20belong%20to%20the%20same%20domino.%5Cn%5CnYou%20are%20given%20a%20perfectly%20balanced%20placement%20of%20dominoes%20on%20a%20grid.%20Find%20the%20number%20of%20ways%20to%20place%20zero%20or%20more%20extra%20dominoes%20on%20this%20grid%20to%20keep%20the%20placement%20perfectly%20balanced.%20Output%20this%20number%20modulo%20%24%20998%5C%5C%2C244%5C%5C%2C353%20%24%20.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20three%20integers%20%24%20h%20%24%20%2C%20%24%20w%20%24%20%2C%20and%20%24%20n%20%24%20%28%20%24%201%20%5C%5Cle%20h%2C%20w%20%5C%5Cle%203600%20%24%20%3B%20%24%200%20%5C%5Cle%20n%20%5C%5Cle%202400%20%24%20%29%2C%20denoting%20the%20dimensions%20of%20the%20grid%20and%20the%20number%20of%20already%20placed%20dominoes.%20The%20rows%20are%20numbered%20from%20%24%201%20%24%20to%20%24%20h%20%24%20%2C%20and%20the%20columns%20are%20numbered%20from%20%24%201%20%24%20to%20%24%20w%20%24%20.%5Cn%5CnEach%20of%20the%20next%20%24%20n%20%24%20lines%20contains%20four%20integers%20%24%20r_%7Bi%2C%201%7D%2C%20c_%7Bi%2C%201%7D%2C%20r_%7Bi%2C%202%7D%2C%20c_%7Bi%2C%202%7D%20%24%20%28%20%24%201%20%5C%5Cle%20r_%7Bi%2C%201%7D%20%5C%5Cle%20r_%7Bi%2C%202%7D%20%5C%5Cle%20h%20%24%20%3B%20%24%201%20%5C%5Cle%20c_%7Bi%2C%201%7D%20%5C%5Cle%20c_%7Bi%2C%202%7D%20%5C%5Cle%20w%20%24%20%29%2C%20denoting%20the%20row%20id%20and%20the%20column%20id%20of%20the%20cells%20covered%20by%20the%20%24%20i%20%24%20-th%20domino.%20Cells%20%24%20%28r_%7Bi%2C%201%7D%2C%20c_%7Bi%2C%201%7D%29%20%24%20and%20%24%20%28r_%7Bi%2C%202%7D%2C%20c_%7Bi%2C%202%7D%29%20%24%20are%20distinct%20and%20share%20a%20common%20side.%5Cn%5CnThe%20given%20domino%20placement%20is%20perfectly%20balanced.%22%2C%22outputFormat%22%3A%22Output%20the%20number%20of%20ways%20to%20place%20zero%20or%20more%20extra%20dominoes%20on%20the%20grid%20to%20keep%20the%20placement%20perfectly%20balanced%2C%20modulo%20%24%20998%5C%5C%2C244%5C%5C%2C353%20%24%20.%22%2C%22samples%22%3A%5B%5B%22%5Cn5%207%202%5Cn3%201%203%202%5Cn4%204%204%205%5Cn%22%2C%22%5Cn8%5Cn%22%5D%2C%5B%22%5Cn5%204%202%5Cn1%202%202%202%5Cn4%203%204%204%5Cn%22%2C%22%5Cn1%5Cn%22%5D%2C%5B%22%5Cn23%2042%200%5Cn%22%2C%22%5Cn102848351%5Cn%22%5D%5D%2C%22hint%22%3A%22In%20the%20first%20example%2C%20the%20initial%20grid%20looks%20like%20this%3A%5Cn%5Cn%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF1237F%5C%2F23d2c7832fa87b26433f4443e57f8a2c61335a78.png%29%5Cn%5CnHere%20are%20%24%208%20%24%20ways%20to%20place%20zero%20or%20more%20extra%20dominoes%20to%20keep%20the%20placement%20perfectly%20balanced%3A%5Cn%5Cn%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF1237F%5C%2Ff39e74c5e6c5abc41daa487ad47333c83b2084c2.png%29%5Cn%5CnIn%20the%20second%20example%2C%20the%20initial%20grid%20looks%20like%20this%3A%5Cn%5Cn%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF1237F%5C%2F7739b264ee73fb643402600eb5d0f9454c11a61d.png%29%5Cn%5CnNo%20extra%20dominoes%20can%20be%20placed%20here.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B512000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F1237%5C%2FF%22%2C%22id%22%3A%221237F%22%7D%2C%22translation%22%3A%22%5Cu7ed9%5Cu4f60%5Cu4e00%5Cu4e2a%24n%5C%5Ctimes%20m%24%5Cu7684%5Cu68cb%5Cu76d8%5Cuff0c%5Cu4e0a%5Cu9762%5Cu5df2%5Cu7ecf%5Cu653e%5Cu4e86%24k%24%5Cu4e2a%5Cu7684%5Cu9aa8%5Cu724c%5Cuff08%241%5C%5Ctimes2%24%5Cuff09%5Cr%5Cn%5Cr%5Cn%5Cu5bf9%5Cu4e8e%5Cu4e00%5Cu4e2a%5Cu9aa8%5Cu724c%5Cu7684%5Cu6bcf%5Cu4e2a%5Cu683c%5Cu5b50%5Cuff0c%5Cu4e0d%5Cu80fd%5Cu6709%5Cu5176%5Cu4ed6%5Cu9aa8%5Cu724c%5Cu7684%5Cu683c%5Cu5b50%5Cu548c%5Cu5b83%5Cu5728%5Cu540c%5Cu4e00%5Cu5217%5Cuff0c%5Cu540c%5Cu4e00%5Cu884c%5Cr%5Cn%5Cr%5Cn%5Cu4f60%5Cu53ef%5Cu4ee5%5Cu5728%5Cu5269%5Cu4e0b%5Cu7684%5Cu683c%5Cu5b50%5Cu91cc%5Cu653e%5Cu9aa8%5Cu724c%5Cuff0c%5Cu4e5f%5Cu53ef%5Cu4ee5%5Cu4e0d%5Cu653e%5Cr%5Cn%5Cr%5Cn%5Cu95ee%5Cu8fd9%5Cu4e2a%5Cu68cb%5Cu76d8%5Cu6709%5Cu591a%5Cu5c11%5Cu79cd%5Cu653e%5Cu9aa8%5Cu724c%5Cu7684%5Cu65b9%5Cu6848%5Cuff0c%5Cu5bf9%24998244353%24%5Cu53d6%5Cu6a21%5Cr%5Cn%5Cr%5Cn%241%5C%5Cle%20n%2Cm%5C%5Cle3600%2C0%5C%5Cle%20k%5C%5Cle2400%24%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A12%2C%22totalAccepted%22%3A12%2C%22pid%22%3A%22CF1237F%22%2C%22title%22%3A%22Balanced%20Domino%20Placements%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Balanced%20Domino%20Placements%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Balanced Domino Placements</h1>
<h2>题意翻译</h2>
<div>给你一个$n\times m$的棋盘，上面已经放了$k$个的骨牌（$1\times2$）
对于一个骨牌的每个格子，不能有其他骨牌的格子和它在同一列，同一行
你可以在剩下的格子里放骨牌，也可以不放
问这个棋盘有多少种放骨牌的方案，对$998244353$取模
$1\le n,m\le3600,0\le k\le2400$</div>
<h2>题目描述</h2>
<div>Consider a square grid with $ h $ rows and $ w $ columns with some dominoes on it. Each domino covers exactly two cells of the grid that share a common side. Every cell is covered by at most one domino.
Let's call a placement of dominoes on the grid perfectly balanced if no row and no column contains a pair of cells covered by two different dominoes. In other words, every row and column may contain no covered cells, one covered cell, or two covered cells that belong to the same domino.
You are given a perfectly balanced placement of dominoes on a grid. Find the number of ways to place zero or more extra dominoes on this grid to keep the placement perfectly balanced. Output this number modulo $ 998\,244\,353 $ .</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains three integers $ h $ , $ w $ , and $ n $ ( $ 1 \le h, w \le 3600 $ ; $ 0 \le n \le 2400 $ ), denoting the dimensions of the grid and the number of already placed dominoes. The rows are numbered from $ 1 $ to $ h $ , and the columns are numbered from $ 1 $ to $ w $ .
Each of the next $ n $ lines contains four integers $ r_{i, 1}, c_{i, 1}, r_{i, 2}, c_{i, 2} $ ( $ 1 \le r_{i, 1} \le r_{i, 2} \le h $ ; $ 1 \le c_{i, 1} \le c_{i, 2} \le w $ ), denoting the row id and the column id of the cells covered by the $ i $ -th domino. Cells $ (r_{i, 1}, c_{i, 1}) $ and $ (r_{i, 2}, c_{i, 2}) $ are distinct and share a common side.
The given domino placement is perfectly balanced.</div>
<h3>输出格式</h3>
<br />
<div>Output the number of ways to place zero or more extra dominoes on the grid to keep the placement perfectly balanced, modulo $ 998\,244\,353 $ .</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>
5 7 2
3 1 3 2
4 4 4 5
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>
8
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>
5 4 2
1 2 2 2
4 3 4 4
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>
1
</code></pre>
<h3>输入样例 #3</h3>
<pre><code>
23 42 0
</code></pre>
<h3>输出样例 #3</h3>
<pre><code>
102848351
</code></pre>
<h2>说明</h2>
<div>In the first example, the initial grid looks like this:
![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1237F/23d2c7832fa87b26433f4443e57f8a2c61335a78.png)
Here are $ 8 $ ways to place zero or more extra dominoes to keep the placement perfectly balanced:
![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1237F/f39e74c5e6c5abc41daa487ad47333c83b2084c2.png)
In the second example, the initial grid looks like this:
![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1237F/7739b264ee73fb643402600eb5d0f9454c11a61d.png)
No extra dominoes can be placed here.</div>
</article>
</div>
</div>
</body>
</html>
