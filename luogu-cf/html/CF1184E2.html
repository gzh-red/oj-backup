<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Daleks&#039; Invasion (medium) - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573402770:kA2mqi2muAQafJ7ulC8uV6NV9TrptPfjHRiKvWMzABA=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22After%20a%20successful%20field%20test%2C%20Heidi%20is%20considering%20deploying%20a%20trap%20along%20some%20Corridor%2C%20possibly%20not%20the%20first%20one.%20She%20wants%20to%20avoid%20meeting%20the%20Daleks%20inside%20the%20Time%20Vortex%2C%20so%20for%20abundance%20of%20caution%20she%20considers%20placing%20the%20traps%20only%20along%20those%20Corridors%20that%20are%20not%20going%20to%20be%20used%20according%20to%20the%20current%20Daleks%27%20plan%20%5Cu2013%20which%20is%20to%20use%20a%20minimum%20spanning%20tree%20of%20Corridors.%20Heidi%20knows%20that%20all%20energy%20requirements%20for%20different%20Corridors%20are%20now%20different%2C%20and%20that%20the%20Daleks%20have%20a%20single%20unique%20plan%20which%20they%20are%20intending%20to%20use.%5Cn%5CnYour%20task%20is%20to%20calculate%20the%20number%20%24%20E_%7Bmax%7D%28c%29%20%24%20%2C%20which%20is%20defined%20in%20the%20same%20way%20as%20in%20the%20easy%20version%20%5Cu2013%20i.e.%2C%20the%20largest%20%24%20e%20%5C%5Cle%2010%5E9%20%24%20such%20that%20if%20we%20changed%20the%20energy%20of%20corridor%20%24%20c%20%24%20to%20%24%20e%20%24%20%2C%20the%20Daleks%20might%20use%20it%20%5Cu2013%20but%20now%20for%20every%20corridor%20that%20Heidi%20considers.%22%2C%22inputFormat%22%3A%22The%20first%20line%3A%20number%20%24%20n%20%24%20of%20destinations%2C%20number%20%24%20m%20%24%20of%20Time%20Corridors%20%28%20%24%202%20%5C%5Cleq%20n%20%5C%5Cleq%2010%5E5%20%24%20%2C%20%24%20n%20-%201%20%5C%5Cleq%20m%20%5C%5Cleq%2010%5E6%20%24%20%29.%20The%20next%20%24%20m%20%24%20lines%3A%20destinations%20%24%20a%20%24%20%2C%20%24%20b%20%24%20and%20energy%20%24%20e%20%24%20%28%20%24%201%20%5C%5Cleq%20a%2C%20b%20%5C%5Cleq%20n%20%24%20%2C%20%24%20a%20%5C%5Cneq%20b%20%24%20%2C%20%24%200%20%5C%5Cleq%20e%20%5C%5Cleq%2010%5E9%20%24%20%29.%5Cn%5CnNo%20pair%20%24%20%5C%5C%7Ba%2C%20b%5C%5C%7D%20%24%20will%20repeat.%20The%20graph%20is%20guaranteed%20to%20be%20connected.%20All%20energy%20requirements%20%24%20e%20%24%20are%20distinct.%22%2C%22outputFormat%22%3A%22Output%20%24%20m-%28n-1%29%20%24%20lines%2C%20each%20containing%20one%20integer%3A%20%24%20E_%7Bmax%7D%28c_i%29%20%24%20for%20the%20%24%20i%20%24%20-th%20Corridor%20%24%20c_i%20%24%20from%20the%20input%20that%20is%20not%20part%20of%20the%20current%20Daleks%27%20plan%20%28minimum%20spanning%20tree%29.%22%2C%22samples%22%3A%5B%5B%223%203%5Cn1%202%208%5Cn2%203%203%5Cn3%201%204%5Cn%22%2C%224%5Cn%22%5D%5D%2C%22hint%22%3A%22If%20%24%20m%20%3D%20n-1%20%24%20%2C%20then%20you%20need%20not%20output%20anything.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B15000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F1184%5C%2FE2%22%2C%22id%22%3A%221184E2%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A1%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22CF1184E2%22%2C%22title%22%3A%22Daleks%27%20Invasion%20%28medium%29%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Daleks%27%20Invasion%20%28medium%29%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Daleks&#039; Invasion (medium)</h1>
<h2>题目描述</h2>
<div>After a successful field test, Heidi is considering deploying a trap along some Corridor, possibly not the first one. She wants to avoid meeting the Daleks inside the Time Vortex, so for abundance of caution she considers placing the traps only along those Corridors that are not going to be used according to the current Daleks' plan – which is to use a minimum spanning tree of Corridors. Heidi knows that all energy requirements for different Corridors are now different, and that the Daleks have a single unique plan which they are intending to use.
Your task is to calculate the number $ E_{max}(c) $ , which is defined in the same way as in the easy version – i.e., the largest $ e \le 10^9 $ such that if we changed the energy of corridor $ c $ to $ e $ , the Daleks might use it – but now for every corridor that Heidi considers.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line: number $ n $ of destinations, number $ m $ of Time Corridors ( $ 2 \leq n \leq 10^5 $ , $ n - 1 \leq m \leq 10^6 $ ). The next $ m $ lines: destinations $ a $ , $ b $ and energy $ e $ ( $ 1 \leq a, b \leq n $ , $ a \neq b $ , $ 0 \leq e \leq 10^9 $ ).
No pair $ \{a, b\} $ will repeat. The graph is guaranteed to be connected. All energy requirements $ e $ are distinct.</div>
<h3>输出格式</h3>
<br />
<div>Output $ m-(n-1) $ lines, each containing one integer: $ E_{max}(c_i) $ for the $ i $ -th Corridor $ c_i $ from the input that is not part of the current Daleks' plan (minimum spanning tree).</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>3 3
1 2 8
2 3 3
3 1 4
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>4
</code></pre>
<h2>说明</h2>
<div>If $ m = n-1 $ , then you need not output anything.</div>
</article>
</div>
</div>
</body>
</html>
