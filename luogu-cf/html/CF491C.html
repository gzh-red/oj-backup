<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Deciphering - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573394650:mpfiMHDkTcT3JFjksTwUzG8TOWBjaYOFW3HcHnjlmrk=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22One%20day%20Maria%20Ivanovna%20found%20a%20Sasha%27s%20piece%20of%20paper%20with%20a%20message%20dedicated%20to%20Olya.%20Maria%20Ivanovna%20wants%20to%20know%20what%20is%20there%20in%20a%20message%2C%20but%20unfortunately%20the%20message%20is%20ciphered.%20Maria%20Ivanovna%20knows%20that%20her%20students%20usually%20cipher%20their%20messages%20by%20replacing%20each%20letter%20of%20an%20original%20message%20by%20some%20another%20letter.%20Replacement%20works%20in%20such%20way%20that%20same%20letters%20are%20always%20replaced%20with%20some%20fixed%20letter%2C%20and%20different%20letters%20are%20always%20replaced%20by%20different%20letters.%5Cn%5CnMaria%20Ivanovna%20supposed%20that%20the%20message%20contains%20answers%20to%20the%20final%20exam%20%28since%20its%20length%20is%20equal%20to%20the%20number%20of%20final%20exam%20questions%29.%20On%20the%20other%20hand%20she%20knows%20that%20Sasha%27s%20answer%20are%20not%20necessary%20correct.%20There%20are%20%24%20K%20%24%20possible%20answers%20for%20each%20questions.%20Of%20course%2C%20Maria%20Ivanovna%20knows%20correct%20answers.%5Cn%5CnMaria%20Ivanovna%20decided%20to%20decipher%20message%20in%20such%20way%20that%20the%20number%20of%20Sasha%27s%20correct%20answers%20is%20maximum%20possible.%20She%20is%20very%20busy%20now%2C%20so%20your%20task%20is%20to%20help%20her.%22%2C%22inputFormat%22%3A%22First%20line%20contains%20length%20of%20both%20strings%20%24%20N%20%24%20%28%20%24%201%3C%3DN%3C%3D2000000%20%24%20%29%20and%20an%20integer%20%24%20K%20%24%20%5Cu2014%20number%20of%20possible%20answers%20for%20each%20of%20the%20questions%20%28%20%24%201%3C%3DK%3C%3D52%20%24%20%29.%20Answers%20to%20the%20questions%20are%20denoted%20as%20Latin%20letters%20abcde...xyzABCDE...XYZ%20in%20the%20order.%20For%20example%20for%20%24%20K%3D6%20%24%20%2C%20possible%20answers%20are%20abcdef%20and%20for%20%24%20K%3D30%20%24%20possible%20answers%20are%20abcde...xyzABCD.%5Cn%5CnSecond%20line%20contains%20a%20ciphered%20message%20string%20consisting%20of%20Latin%20letters.%5Cn%5CnThird%20line%20contains%20a%20correct%20answers%20string%20consisting%20of%20Latin%20letters.%22%2C%22outputFormat%22%3A%22In%20the%20first%20line%20output%20maximum%20possible%20number%20of%20correct%20Sasha%27s%20answers.%5Cn%5CnIn%20the%20second%20line%20output%20cipher%20rule%20as%20the%20string%20of%20length%20%24%20K%20%24%20where%20for%20each%20letter%20from%20the%20students%27%20cipher%20%28starting%20from%20%27a%27%20as%20mentioned%20above%29%20there%20is%20specified%20which%20answer%20does%20it%20correspond%20to.%5Cn%5CnIf%20there%20are%20several%20ways%20to%20produce%20maximum%20answer%2C%20output%20any%20of%20them.%22%2C%22samples%22%3A%5B%5B%2210%202%5Cnaaabbbaaab%5Cnbbbbabbbbb%5Cn%22%2C%227%5Cnba%5Cn%22%5D%2C%5B%2210%202%5Cnaaaaaaabbb%5Cnbbbbaaabbb%5Cn%22%2C%226%5Cnab%5Cn%22%5D%2C%5B%229%204%5Cndacbdacbd%5Cnacbdacbda%5Cn%22%2C%229%5Cncdba%5Cn%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F491%5C%2FC%22%2C%22id%22%3A%22491C%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22CF491C%22%2C%22title%22%3A%22Deciphering%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Deciphering%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Deciphering</h1>
<h2>题目描述</h2>
<div>One day Maria Ivanovna found a Sasha's piece of paper with a message dedicated to Olya. Maria Ivanovna wants to know what is there in a message, but unfortunately the message is ciphered. Maria Ivanovna knows that her students usually cipher their messages by replacing each letter of an original message by some another letter. Replacement works in such way that same letters are always replaced with some fixed letter, and different letters are always replaced by different letters.
Maria Ivanovna supposed that the message contains answers to the final exam (since its length is equal to the number of final exam questions). On the other hand she knows that Sasha's answer are not necessary correct. There are $ K $ possible answers for each questions. Of course, Maria Ivanovna knows correct answers.
Maria Ivanovna decided to decipher message in such way that the number of Sasha's correct answers is maximum possible. She is very busy now, so your task is to help her.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>First line contains length of both strings $ N $ ( $ 1<=N<=2000000 $ ) and an integer $ K $ — number of possible answers for each of the questions ( $ 1<=K<=52 $ ). Answers to the questions are denoted as Latin letters abcde...xyzABCDE...XYZ in the order. For example for $ K=6 $ , possible answers are abcdef and for $ K=30 $ possible answers are abcde...xyzABCD.
Second line contains a ciphered message string consisting of Latin letters.
Third line contains a correct answers string consisting of Latin letters.</div>
<h3>输出格式</h3>
<br />
<div>In the first line output maximum possible number of correct Sasha's answers.
In the second line output cipher rule as the string of length $ K $ where for each letter from the students' cipher (starting from 'a' as mentioned above) there is specified which answer does it correspond to.
If there are several ways to produce maximum answer, output any of them.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>10 2
aaabbbaaab
bbbbabbbbb
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>7
ba
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>10 2
aaaaaaabbb
bbbbaaabbb
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>6
ab
</code></pre>
<h3>输入样例 #3</h3>
<pre><code>9 4
dacbdacbd
acbdacbda
</code></pre>
<h3>输出样例 #3</h3>
<pre><code>9
cdba
</code></pre>
</article>
</div>
</div>
</body>
</html>
