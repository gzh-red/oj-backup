<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Pathwalks - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573399831:9jsMaR+cvkNWCaLY242NS/R7UMOEtYbZSEcWOG43dcg=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22You%20are%20given%20a%20directed%20graph%20with%20%24%20n%20%24%20nodes%20and%20%24%20m%20%24%20edges%2C%20with%20all%20edges%20having%20a%20certain%20weight.%5Cn%5CnThere%20might%20be%20multiple%20edges%20and%20self%20loops%2C%20and%20the%20graph%20can%20also%20be%20disconnected.%5Cn%5CnYou%20need%20to%20choose%20a%20path%20%28possibly%20passing%20through%20same%20vertices%20multiple%20times%29%20in%20the%20graph%20such%20that%20the%20weights%20of%20the%20edges%20are%20in%20strictly%20increasing%20order%2C%20and%20these%20edges%20come%20in%20the%20order%20of%20input.%20Among%20all%20such%20paths%2C%20you%20need%20to%20find%20the%20the%20path%20that%20has%20the%20maximum%20possible%20number%20of%20edges%2C%20and%20report%20this%20value.%5Cn%5CnPlease%20note%20that%20the%20edges%20picked%20don%27t%20have%20to%20be%20consecutive%20in%20the%20input.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20two%20integers%20%24%20n%20%24%20and%20%24%20m%20%24%20%28%20%24%201%3C%3Dn%3C%3D100000%20%24%20%2C%20%24%201%3C%3Dm%3C%3D100000%20%24%20%29%20%5Cu2014%20the%20number%20of%20vertices%20and%20edges%20in%20the%20graph%2C%20respectively.%5Cn%5Cn%20%24%20m%20%24%20lines%20follows.%5Cn%5CnThe%20%24%20i%20%24%20-th%20of%20these%20lines%20contains%20three%20space%20separated%20integers%20%24%20a_%7Bi%7D%20%24%20%2C%20%24%20b_%7Bi%7D%20%24%20and%20%24%20w_%7Bi%7D%20%24%20%28%20%24%201%3C%3Da_%7Bi%7D%2Cb_%7Bi%7D%3C%3Dn%20%24%20%2C%20%24%200%3C%3Dw_%7Bi%7D%3C%3D100000%20%24%20%29%2C%20denoting%20an%20edge%20from%20vertex%20%24%20a_%7Bi%7D%20%24%20to%20vertex%20%24%20b_%7Bi%7D%20%24%20having%20weight%20%24%20w_%7Bi%7D%20%24%22%2C%22outputFormat%22%3A%22Print%20one%20integer%20in%20a%20single%20line%20%5Cu2014%20the%20maximum%20number%20of%20edges%20in%20the%20path.%22%2C%22samples%22%3A%5B%5B%223%203%5Cn3%201%203%5Cn1%202%201%5Cn2%203%202%5Cn%22%2C%222%22%5D%2C%5B%225%205%5Cn1%203%202%5Cn3%202%203%5Cn3%204%205%5Cn5%204%200%5Cn4%205%208%5Cn%22%2C%223%22%5D%5D%2C%22hint%22%3A%22The%20answer%20for%20the%20first%20sample%20input%20is%20%24%202%20%24%20%3A%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF960F%5C%2F64f1808592d29bd3c0ddf93b30b30da2e43f461a.png%29.%20Note%20that%20you%20cannot%20traverse%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF960F%5C%2F701350564a202a853dc0a2e9276e318c9ca164a2.png%29%20because%20edge%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF960F%5C%2Fb59064b21bfeab8af7de18849682bc80881d0361.png%29%20appears%20earlier%20in%20the%20input%20than%20the%20other%20two%20edges%20and%20hence%20cannot%20be%20picked%5C%2Ftraversed%20after%20either%20of%20the%20other%20two%20edges.%5Cn%5CnIn%20the%20second%20sample%2C%20it%27s%20optimal%20to%20pick%20%24%201%20%24%20-st%2C%20%24%203%20%24%20-rd%20and%20%24%205%20%24%20-th%20edges%20to%20get%20the%20optimal%20answer%3A%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF960F%5C%2Fda8446025ba10d3435163cc331ea49b0612f49e8.png%29.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F960%5C%2FF%22%2C%22id%22%3A%22960F%22%7D%2C%22translation%22%3A%22%5Cu9898%5Cu610f%5Cuff1a%5Cu7ed9%5Cu5b9a%24n%24%5Cu4e2a%5Cu70b9%24m%24%5Cu6761%5Cu8fb9%5Cu7684%5Cu6709%5Cu5411%5Cu56fe%5Cuff0c%5Cu53ef%5Cu80fd%5Cu4e0d%5Cu8fde%5Cu901a%5Cuff0c%5Cu53ef%5Cu80fd%5Cu6709%5Cu91cd%5Cu8fb9%5Cuff0c%5Cu4e5f%5Cu53ef%5Cu80fd%5Cu4f1a%5Cu6709%5Cu81ea%5Cu73af%5Cu3002%5Cu6c42%5Cu6700%5Cu957f%5Cu7684%5Cu8def%5Cu5f84%5Cuff08%5Cu53ef%5Cu4ee5%5Cu7ecf%5Cu8fc7%5Cu91cd%5Cu590d%5Cu8282%5Cu70b9%5Cuff09%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu8f93%5Cu5165%5Cuff1a%5Cu7b2c%5Cu4e00%5Cu884c%5Cuff0c%5Cu4e24%5Cu4e2a%5Cu6574%5Cu6570%24n%24%2C%24m%24%5Cu3002%20%5Cu7b2c%5Cu4e8c%5Cu884c%5Cu5230%5Cu7b2c%24m%2B1%24%5Cu884c%5Cuff0c%5Cu6bcf%5Cu884c%5Cu4e09%5Cu4e2a%5Cu6574%5Cu6570%20%24a%24%2C%24b%24%2C%24k%24%5Cuff0c%5Cu8868%5Cu793a%5Cu9876%5Cu70b9%24a%24%5Cu4e0e%5Cu9876%5Cu70b9%24b%24%5Cu6709%5Cu4e00%5Cu6761%5Cu8fb9%5Cu76f8%5Cu8fde%5Cuff0c%5Cu8fb9%5Cu6743%5Cu4e3a%24k%24%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu8f93%5Cu51fa%5Cuff1a%5Cu4e00%5Cu4e2a%5Cu6574%5Cu6570%5Cuff0c%5Cu8868%5Cu793a%5Cu6700%5Cu957f%5Cu7684%5Cu8def%5Cu5f84%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu6ce8%5Cu610f%5Cuff1a%5Cu6ee1%5Cu8db3%5Cu7f16%5Cu53f7%5Cu548c%5Cu8fb9%5Cu6743%5Cu90fd%5Cu4e25%5Cu683c%5Cu9012%5Cu589e%5Cu3002%24n%24%2C%24m%24%2C%24wi%5C%5Cleq10%5E5%24%5Cu3002%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A178%2C%22totalAccepted%22%3A67%2C%22pid%22%3A%22CF960F%22%2C%22title%22%3A%22Pathwalks%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A160674%2C%22title%22%3A%22%5Cu8fd8%5Cu662f%5Cu4e0d%5Cu61c2%5Cu9898%5Cu610f%22%2C%22forum%22%3A%7B%22id%22%3A24983%2C%22name%22%3A%22CF960F%20Pathwalks%22%2C%22slug%22%3A%22CF960F%22%7D%7D%2C%7B%22id%22%3A160672%2C%22title%22%3A%22%5Cu9898%5Cu610f%5Cu6ca1%5Cu6709%5Cu53ef%5Cu80fd%5Cu88ab%5Cu8bef%5Cu89e3%22%2C%22forum%22%3A%7B%22id%22%3A24983%2C%22name%22%3A%22CF960F%20Pathwalks%22%2C%22slug%22%3A%22CF960F%22%7D%7D%2C%7B%22id%22%3A158723%2C%22title%22%3A%22%5Cu9898%5Cu610f%5Cu53ef%5Cu80fd%5Cu88ab%5Cu8bef%5Cu89e3%22%2C%22forum%22%3A%7B%22id%22%3A24983%2C%22name%22%3A%22CF960F%20Pathwalks%22%2C%22slug%22%3A%22CF960F%22%7D%7D%2C%7B%22id%22%3A64363%2C%22title%22%3A%22%5Cu7ffb%5Cu8bd1%22%2C%22forum%22%3A%7B%22id%22%3A24983%2C%22name%22%3A%22CF960F%20Pathwalks%22%2C%22slug%22%3A%22CF960F%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P1912%22%2C%22title%22%3A%22%5BNOI2009%5D%5Cu8bd7%5Cu4eba%5Cu5c0fG%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22CF161B%22%2C%22title%22%3A%22Discounts%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1025D%22%2C%22title%22%3A%22Recovering%20BST%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1039D%22%2C%22title%22%3A%22You%20Are%20Given%20a%20Tree%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1070C%22%2C%22title%22%3A%22Cloud%20Computing%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Pathwalks%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Pathwalks</h1>
<h2>题意翻译</h2>
<div>题意：给定$n$个点$m$条边的有向图，可能不连通，可能有重边，也可能会有自环。求最长的路径（可以经过重复节点）。
输入：第一行，两个整数$n$,$m$。 第二行到第$m+1$行，每行三个整数 $a$,$b$,$k$，表示顶点$a$与顶点$b$有一条边相连，边权为$k$。
输出：一个整数，表示最长的路径。
注意：满足编号和边权都严格递增。$n$,$m$,$wi\leq10^5$。</div>
<h2>题目描述</h2>
<div>You are given a directed graph with $ n $ nodes and $ m $ edges, with all edges having a certain weight.
There might be multiple edges and self loops, and the graph can also be disconnected.
You need to choose a path (possibly passing through same vertices multiple times) in the graph such that the weights of the edges are in strictly increasing order, and these edges come in the order of input. Among all such paths, you need to find the the path that has the maximum possible number of edges, and report this value.
Please note that the edges picked don't have to be consecutive in the input.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains two integers $ n $ and $ m $ ( $ 1<=n<=100000 $ , $ 1<=m<=100000 $ ) — the number of vertices and edges in the graph, respectively.
$ m $ lines follows.
The $ i $ -th of these lines contains three space separated integers $ a_{i} $ , $ b_{i} $ and $ w_{i} $ ( $ 1<=a_{i},b_{i}<=n $ , $ 0<=w_{i}<=100000 $ ), denoting an edge from vertex $ a_{i} $ to vertex $ b_{i} $ having weight $ w_{i} $</div>
<h3>输出格式</h3>
<br />
<div>Print one integer in a single line — the maximum number of edges in the path.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>3 3
3 1 3
1 2 1
2 3 2
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>2</code></pre>
<h3>输入样例 #2</h3>
<pre><code>5 5
1 3 2
3 2 3
3 4 5
5 4 0
4 5 8
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>3</code></pre>
<h2>说明</h2>
<div>The answer for the first sample input is $ 2 $ : ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF960F/64f1808592d29bd3c0ddf93b30b30da2e43f461a.png). Note that you cannot traverse ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF960F/701350564a202a853dc0a2e9276e318c9ca164a2.png) because edge ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF960F/b59064b21bfeab8af7de18849682bc80881d0361.png) appears earlier in the input than the other two edges and hence cannot be picked/traversed after either of the other two edges.
In the second sample, it's optimal to pick $ 1 $ -st, $ 3 $ -rd and $ 5 $ -th edges to get the optimal answer: ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF960F/da8446025ba10d3435163cc331ea49b0612f49e8.png).</div>
</article>
</div>
</div>
</body>
</html>
