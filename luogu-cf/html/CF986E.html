<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Prince&#039;s Problem - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573400112:Ixr0vIEZBrk4J9u3V5+y48xFzanPROt6BqnkmvTGNXA=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Let%20the%20main%20characters%20of%20this%20problem%20be%20personages%20from%20some%20recent%20movie.%20New%20Avengers%20seem%20to%20make%20a%20lot%20of%20buzz.%20I%20didn%27t%20watch%20any%20part%20of%20the%20franchise%20and%20don%27t%20know%20its%20heroes%20well%2C%20but%20it%20won%27t%20stop%20me%20from%20using%20them%20in%20this%20problem%20statement.%20So%2C%20Thanos%20and%20Dr.%20Strange%20are%20doing%20their%20superhero%20and%20supervillain%20stuff%2C%20but%20then%20suddenly%20they%20stumble%20across%20a%20regular%20competitive%20programming%20problem.%5Cn%5CnYou%20are%20given%20a%20tree%20with%20%24%20n%20%24%20vertices.%5Cn%5CnIn%20each%20vertex%20%24%20v%20%24%20there%20is%20positive%20integer%20%24%20a_%7Bv%7D%20%24%20.%5Cn%5CnYou%20have%20to%20answer%20%24%20q%20%24%20queries.%5Cn%5CnEach%20query%20has%20a%20from%20%24%20u%20%24%20%24%20v%20%24%20%24%20x%20%24%20.%5Cn%5CnYou%20have%20to%20calculate%20%24%20%5C%5Cprod_%7Bw%20%5C%5Cin%20P%7D%20gcd%28x%2C%20a_%7Bw%7D%29%20%5C%5Cmod%20%2810%5E%7B9%7D%20%2B%207%29%20%24%20%2C%20where%20%24%20P%20%24%20is%20a%20set%20of%20vertices%20on%20path%20from%20%24%20u%20%24%20to%20%24%20v%20%24%20.%20In%20other%20words%2C%20you%20are%20to%20calculate%20the%20product%20of%20%24%20gcd%28x%2C%20a_%7Bw%7D%29%20%24%20for%20all%20vertices%20%24%20w%20%24%20on%20the%20path%20from%20%24%20u%20%24%20to%20%24%20v%20%24%20.%20As%20it%20might%20be%20large%2C%20compute%20it%20modulo%20%24%2010%5E9%2B7%20%24%20.%20Here%20%24%20gcd%28s%2C%20t%29%20%24%20denotes%20the%20greatest%20common%20divisor%20of%20%24%20s%20%24%20and%20%24%20t%20%24%20.%5Cn%5CnNote%20that%20the%20numbers%20in%20vertices%20do%20not%20change%20after%20queries.%5Cn%5CnI%20suppose%20that%20you%20are%20more%20interested%20in%20superhero%20business%20of%20Thanos%20and%20Dr.%20Strange%20than%20in%20them%20solving%20the%20problem.%20So%20you%20are%20invited%20to%20solve%20this%20problem%20instead%20of%20them.%22%2C%22inputFormat%22%3A%22In%20the%20first%20line%20of%20input%20there%20is%20one%20integer%20%24%20n%20%24%20%28%20%24%201%20%5C%5Cle%20n%20%5C%5Cle%2010%5E%7B5%7D%20%24%20%29%20%5Cu2014%20the%20size%20of%20the%20tree.%5Cn%5CnIn%20the%20next%20%24%20n-1%20%24%20lines%20the%20edges%20of%20the%20tree%20are%20described.%20The%20%24%20i%20%24%20-th%20edge%20is%20described%20with%20two%20integers%20%24%20u_%7Bi%7D%20%24%20and%20%24%20v_%7Bi%7D%20%24%20%28%20%24%201%20%5C%5Cle%20u_%7Bi%7D%2C%20v_%7Bi%7D%20%5C%5Cle%20n%20%24%20%29%20and%20it%20connects%20the%20vertices%20%24%20u_%7Bi%7D%20%24%20and%20%24%20v_%7Bi%7D%20%24%20.%20It%20is%20guaranteed%20that%20graph%20with%20these%20edges%20is%20a%20tree.%5Cn%5CnIn%20the%20next%20line%20there%20are%20%24%20n%20%24%20integers%20%24%20a_1%2C%20a_2%2C%20%5C%5Cldots%2C%20a_n%20%24%20%28%20%24%201%20%5C%5Cle%20a_%7Bv%7D%20%5C%5Cle%2010%5E%7B7%7D%20%24%20%29.%5Cn%5CnIn%20the%20next%20line%20there%20is%20one%20integer%20%24%20q%20%24%20%28%20%24%201%20%5C%5Cle%20q%20%5C%5Cle%2010%5E%7B5%7D%20%24%20%29%20%5Cu2014%20the%20number%20of%20queries.%5Cn%5CnAnd%20in%20the%20next%20%24%20q%20%24%20lines%20the%20queries%20are%20described.%20Each%20query%20is%20described%20with%20three%20integers%20%24%20u_%7Bi%7D%20%24%20%2C%20%24%20v_%7Bi%7D%20%24%20and%20%24%20x_%7Bi%7D%20%24%20%28%20%24%201%20%5C%5Cle%20u_%7Bi%7D%2C%20v_%7Bi%7D%20%5C%5Cle%20n%20%24%20%2C%20%24%201%20%5C%5Cle%20x_%7Bi%7D%20%5C%5Cle%2010%5E%7B7%7D%20%24%20%29.%22%2C%22outputFormat%22%3A%22Print%20%24%20q%20%24%20numbers%20%5Cu2014%20the%20answers%20to%20the%20queries%20in%20the%20order%20they%20are%20given%20in%20the%20input.%20Print%20each%20answer%20modulo%20%24%2010%5E9%2B7%20%3D%201000000007%20%24%20.%20Print%20each%20number%20on%20a%20separate%20line.%22%2C%22samples%22%3A%5B%5B%224%5Cn1%202%5Cn1%203%5Cn1%204%5Cn6%204%209%205%5Cn3%5Cn2%203%206%5Cn2%203%202%5Cn3%204%207%5Cn%22%2C%2236%5Cn4%5Cn1%5Cn%22%5D%2C%5B%226%5Cn1%202%5Cn2%203%5Cn2%204%5Cn1%205%5Cn5%206%5Cn100000%20200000%20500000%2040000%20800000%20250000%5Cn3%5Cn3%205%2010000000%5Cn6%202%203500000%5Cn4%201%2064000%5Cn%22%2C%22196000%5Cn12250%5Cn999998215%5Cn%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B3000%5D%2C%22memory%22%3A%5B512000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F986%5C%2FE%22%2C%22id%22%3A%22986E%22%7D%2C%22translation%22%3A%22%20%5Cu7ed9%5Cu5b9a%5Cu4f60%5Cu4e00%5Cu68f5%5Cu6811%5Cuff0c%5Cu6709%5Cu70b9%5Cu6743%24val_i%5C%5Cle%2010%5E7%24%5Cu3002%5Cu73b0%5Cu5728%5Cu6709%24m%24%5Cu7ec4%5Cu8be2%5Cu95ee%5Cu7ed9%5Cu5b9a%5Cu53c2%5Cu6570%24x%2Cy%2Cw%24%5Cu95ee%5Cu4f60%5Cu5bf9%5Cu4e8e%24%28x-%3Ey%29%24%5Cu7684%5Cu8def%5Cu5f84%5Cu7ecf%5Cu8fc7%5Cu7684%5Cu70b9%5Cu96c6%24P%24%5Cuff0c%5Cu95ee%5Cu4f60%5Cu8fd9%5Cu4e2a%5Cu4e1c%5Cu897f%5Cuff1a%5Cr%5Cn%20%24%24%5Cr%5Cn%20%5C%5Cprod_%7Bu%20%5C%5Cin%20P%7D%20%7B%5C%5Cmathrm%7Bgcd%7D%28w%2Cval_u%29%7D%20%5C%5Cmod%201000000007%5Cr%5Cn%20%24%24%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A42%2C%22totalAccepted%22%3A20%2C%22pid%22%3A%22CF986E%22%2C%22title%22%3A%22Prince%27s%20Problem%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Prince%27s%20Problem%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Prince&#039;s Problem</h1>
<h2>题意翻译</h2>
<div> 给定你一棵树，有点权$val_i\le 10^7$。现在有$m$组询问给定参数$x,y,w$问你对于$(x->y)$的路径经过的点集$P$，问你这个东西：
$$
\prod_{u \in P} {\mathrm{gcd}(w,val_u)} \mod 1000000007
$$</div>
<h2>题目描述</h2>
<div>Let the main characters of this problem be personages from some recent movie. New Avengers seem to make a lot of buzz. I didn't watch any part of the franchise and don't know its heroes well, but it won't stop me from using them in this problem statement. So, Thanos and Dr. Strange are doing their superhero and supervillain stuff, but then suddenly they stumble across a regular competitive programming problem.
You are given a tree with $ n $ vertices.
In each vertex $ v $ there is positive integer $ a_{v} $ .
You have to answer $ q $ queries.
Each query has a from $ u $ $ v $ $ x $ .
You have to calculate $ \prod_{w \in P} gcd(x, a_{w}) \mod (10^{9} + 7) $ , where $ P $ is a set of vertices on path from $ u $ to $ v $ . In other words, you are to calculate the product of $ gcd(x, a_{w}) $ for all vertices $ w $ on the path from $ u $ to $ v $ . As it might be large, compute it modulo $ 10^9+7 $ . Here $ gcd(s, t) $ denotes the greatest common divisor of $ s $ and $ t $ .
Note that the numbers in vertices do not change after queries.
I suppose that you are more interested in superhero business of Thanos and Dr. Strange than in them solving the problem. So you are invited to solve this problem instead of them.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>In the first line of input there is one integer $ n $ ( $ 1 \le n \le 10^{5} $ ) — the size of the tree.
In the next $ n-1 $ lines the edges of the tree are described. The $ i $ -th edge is described with two integers $ u_{i} $ and $ v_{i} $ ( $ 1 \le u_{i}, v_{i} \le n $ ) and it connects the vertices $ u_{i} $ and $ v_{i} $ . It is guaranteed that graph with these edges is a tree.
In the next line there are $ n $ integers $ a_1, a_2, \ldots, a_n $ ( $ 1 \le a_{v} \le 10^{7} $ ).
In the next line there is one integer $ q $ ( $ 1 \le q \le 10^{5} $ ) — the number of queries.
And in the next $ q $ lines the queries are described. Each query is described with three integers $ u_{i} $ , $ v_{i} $ and $ x_{i} $ ( $ 1 \le u_{i}, v_{i} \le n $ , $ 1 \le x_{i} \le 10^{7} $ ).</div>
<h3>输出格式</h3>
<br />
<div>Print $ q $ numbers — the answers to the queries in the order they are given in the input. Print each answer modulo $ 10^9+7 = 1000000007 $ . Print each number on a separate line.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>4
1 2
1 3
1 4
6 4 9 5
3
2 3 6
2 3 2
3 4 7
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>36
4
1
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>6
1 2
2 3
2 4
1 5
5 6
100000 200000 500000 40000 800000 250000
3
3 5 10000000
6 2 3500000
4 1 64000
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>196000
12250
999998215
</code></pre>
</article>
</div>
</div>
</body>
</html>
