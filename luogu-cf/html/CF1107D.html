<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Compression - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573401777:7PY3wGY9uaMy4LqkrsGL/DwknYqgFv8LDI6TBnVt3gw=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%22%2C%22description%22%3A%22You%20are%20given%20a%20binary%20matrix%20%24%20A%20%24%20of%20size%20%24%20n%20%5C%5Ctimes%20n%20%24%20.%20Let%27s%20denote%20an%20%24%20x%20%24%20-compression%20of%20the%20given%20matrix%20as%20a%20matrix%20%24%20B%20%24%20of%20size%20%24%20%5C%5Cfrac%7Bn%7D%7Bx%7D%20%5C%5Ctimes%20%5C%5Cfrac%7Bn%7D%7Bx%7D%20%24%20such%20that%20for%20every%20%24%20i%20%5C%5Cin%20%5B1%2C%20n%5D%2C%20j%20%5C%5Cin%20%5B1%2C%20n%5D%20%24%20the%20condition%20%24%20A%5Bi%5D%5Bj%5D%20%3D%20B%5B%5C%5Clceil%20%5C%5Cfrac%7Bi%7D%7Bx%7D%20%5C%5Crceil%5D%5B%5C%5Clceil%20%5C%5Cfrac%7Bj%7D%7Bx%7D%20%5C%5Crceil%5D%20%24%20is%20met.%5Cn%5CnObviously%2C%20%24%20x%20%24%20-compression%20is%20possible%20only%20if%20%24%20x%20%24%20divides%20%24%20n%20%24%20%2C%20but%20this%20condition%20is%20not%20enough.%20For%20example%2C%20the%20following%20matrix%20of%20size%20%24%202%20%5C%5Ctimes%202%20%24%20does%20not%20have%20any%20%24%202%20%24%20-compression%3A%5Cn%5Cn%20%24%2001%20%24%20%20%20%24%2010%20%24%20For%20the%20given%20matrix%20%24%20A%20%24%20%2C%20find%20maximum%20%24%20x%20%24%20such%20that%20an%20%24%20x%20%24%20-compression%20of%20this%20matrix%20is%20possible.%5Cn%5CnNote%20that%20the%20input%20is%20given%20in%20compressed%20form.%20But%20even%20though%20it%20is%20compressed%2C%20you%27d%20better%20use%20fast%20input.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20one%20number%20%24%20n%20%24%20%28%20%24%204%20%5C%5Cle%20n%20%5C%5Cle%205200%20%24%20%29%20%5Cu2014%20the%20number%20of%20rows%20and%20columns%20in%20the%20matrix%20%24%20A%20%24%20.%20It%20is%20guaranteed%20that%20%24%20n%20%24%20is%20divisible%20by%20%24%204%20%24%20.%5Cn%5CnThen%20the%20representation%20of%20matrix%20follows.%20Each%20of%20%24%20n%20%24%20next%20lines%20contains%20%24%20%5C%5Cfrac%7Bn%7D%7B4%7D%20%24%20one-digit%20hexadecimal%20numbers%20%28that%20is%2C%20these%20numbers%20can%20be%20represented%20either%20as%20digits%20from%20%24%200%20%24%20to%20%24%209%20%24%20or%20as%20uppercase%20Latin%20letters%20from%20%24%20A%20%24%20to%20%24%20F%20%24%20%29.%20Binary%20representation%20of%20each%20of%20these%20numbers%20denotes%20next%20%24%204%20%24%20elements%20of%20the%20matrix%20in%20the%20corresponding%20row.%20For%20example%2C%20if%20the%20number%20%24%20B%20%24%20is%20given%2C%20then%20the%20corresponding%20elements%20are%201011%2C%20and%20if%20the%20number%20is%20%24%205%20%24%20%2C%20then%20the%20corresponding%20elements%20are%200101.%5Cn%5CnElements%20are%20not%20separated%20by%20whitespaces.%22%2C%22outputFormat%22%3A%22Print%20one%20number%3A%20maximum%20%24%20x%20%24%20such%20that%20an%20%24%20x%20%24%20-compression%20of%20the%20given%20matrix%20is%20possible.%22%2C%22samples%22%3A%5B%5B%228%5CnE7%5CnE7%5CnE7%5Cn00%5Cn00%5CnE7%5CnE7%5CnE7%5Cn%22%2C%221%5Cn%22%5D%2C%5B%224%5Cn7%5CnF%5CnF%5CnF%5Cn%22%2C%221%5Cn%22%5D%5D%2C%22hint%22%3A%22The%20first%20example%20corresponds%20to%20the%20matrix%3A%5Cn%5Cn%20%24%2011100111%20%24%20%20%20%24%2011100111%20%24%20%20%20%24%2011100111%20%24%20%20%20%24%2000000000%20%24%20%20%20%24%2000000000%20%24%20%20%20%24%2011100111%20%24%20%20%20%24%2011100111%20%24%20%20%20%24%2011100111%20%24%20It%20is%20easy%20to%20see%20that%20the%20answer%20on%20this%20example%20is%20%24%201%20%24%20.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2500%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F1107%5C%2FD%22%2C%22id%22%3A%221107D%22%7D%2C%22translation%22%3A%22%5Cu7ed9%5Cu4f60%5Cu4e00%5Cu4e2a%24n%5C%5Ctimes%20n%24%5Cu7684%5Cu77e9%5Cu9635%5Cu3002%5Cu4fdd%5Cu8bc1%24n%24%5Cu662f%244%24%5Cu7684%5Cu500d%5Cu6570%5Cu3002%5Cn%5Cn%5Cu73b0%5Cu5728%5Cuff0c%5Cu4f60%5Cu9700%5Cu8981%5Cu627e%5Cu5230%5Cu4e00%5Cu4e2a%5Cu65b0%5Cu7684%5Cu77e9%5Cu9635%5Cuff0c%5Cu5b83%5Cu7684%5Cu8fb9%5Cu957f%5Cu662f%24%5C%5Cfrac%7Bn%7D%7Bx%7D%24%5Cu3002%5Cu5bf9%5Cu4e8e%5Cu6240%5Cu6709%5Cu7684%241%5C%5Cleq%20i%20%5C%5Cleq%20n%2C%201%20%5C%5Cleq%20j%5C%5Cleq%20n%24%2C%5Cu6709%24a%5Bi%2Cj%5D%3Db%5B%5C%5Clceil%5C%5Cfrac%7Bi%7Dx%5C%5Crceil%2C%5C%5Clceil%5C%5Cfrac%7Bj%7Dx%5C%5Crceil%5D%24%5Cu3002%5Cn%5Cn%5Cu663e%5Cu7136%5Cuff0c%5Cu5f53%5Cu4e14%5Cu4ec5%5Cu5f53%24x%7Cn%24%5Cu65f6%5Cu80fd%5Cu591f%5Cu627e%5Cu5230%5Cu8fd9%5Cu6837%5Cu7684%24x%24%5Cuff0c%5Cu4f46%5Cu662f%5Cuff0c%5Cu8003%5Cu8651%5Cu8fd9%5Cu4e2a%5Cu77e9%5Cu9635%5Cuff1a%5Cn%24%2410%24%24%5Cn%24%2401%24%24%5Cn%5Cu5f53%24x%3D2%24%5Cu65f6%5Cuff0c%5Cu627e%5Cu4e0d%5Cu5230%5Cu8fd9%5Cu6837%5Cu7684%5Cu77e9%5Cu9635%5Cu3002%5Cn%5Cn%5Cu73b0%5Cu5728%5Cu8bf7%5Cu5bf9%5Cu4e8e%5Cu4e00%5Cu4e2a%5Cu7ed9%5Cu5b9a%5Cu7684%5Cu77e9%5Cu9635%5Cuff0c%5Cu6c42%5Cu51fa%5Cu6700%5Cu5927%5Cu7684%24x%24%5Cu503c%5Cu3002%5Cu4f60%5Cu4e0d%5Cu9700%5Cu8981%5Cu6c42%5Cu51fa%24b%24%5Cu77e9%5Cu9635%5Cu3002%5Cn%5Cn%2A%2A%5Cu672c%5Cu9898%5Cu91c7%5Cu7528%5Cu7279%5Cu6b8a%5Cu65b9%5Cu5f0f%5Cu8f93%5Cu5165%2A%2A%5Cu3002%5Cu7b2c%5Cu4e00%5Cu884c%5Cu8f93%5Cu5165%5Cu4e00%5Cu4e2a%5Cu6574%5Cu6570%24n%24%2C%20%5Cu4e0b%5Cu9762%5Cu6bcf%5Cu4e00%5Cu884c%5Cu5305%5Cu542b%24%5C%5Cfrac%7Bn%7D%7B4%7D%24%5Cu4e2a%2416%24%5Cu8fdb%5Cu5236%5Cu6570%5Cu5b57%5Cuff0c%5Cu6bcf%5Cu4e2a%5Cu6570%5Cu5b57%5Cu8868%5Cu793a%5Cu8fd9%5Cu4e2a%5Cu77e9%5Cu9635%5Cu7684%5Cu540e%244%24%5Cu4e2a%5Cu4f4d%5Cu7f6e%5Cu3002%5Cu4f8b%5Cu5982%5Cuff0c%24B%5C%5Cto%201110%2C%205%20%5C%5Cto%200101%24.%20%2A%2A%5Cu6ca1%5Cu6709%5Cu7a7a%5Cu683c%5Cu9694%5Cu5f00%2A%2A%5Cn%5Cn%2A%2A%5Cu8bf7%5Cu4f7f%5Cu7528%5Cu5feb%5Cu8bfb%2A%2A%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A81%2C%22totalAccepted%22%3A52%2C%22pid%22%3A%22CF1107D%22%2C%22title%22%3A%22Compression%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A97663%2C%22title%22%3A%22%5Cu5173%5Cu4e8e%5Cu7ffb%5Cu8bd1%22%2C%22forum%22%3A%7B%22id%22%3A33962%2C%22name%22%3A%22CF1107D%20Compression%22%2C%22slug%22%3A%22CF1107D%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22CF1107E%22%2C%22title%22%3A%22Vasya%20and%20Binary%20String%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1107C%22%2C%22title%22%3A%22Brutality%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1107B%22%2C%22title%22%3A%22Digital%20root%22%2C%22difficulty%22%3A3%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1106F%22%2C%22title%22%3A%22Lunar%20New%20Year%20and%20a%20Recursive%20Sequence%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1225D%22%2C%22title%22%3A%22Power%20Products%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Compression%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Compression</h1>
<h2>题意翻译</h2>
<div>给你一个$n\times n$的矩阵。保证$n$是$4$的倍数。
现在，你需要找到一个新的矩阵，它的边长是$\frac{n}{x}$。对于所有的$1\leq i \leq n, 1 \leq j\leq n$,有$a[i,j]=b[\lceil\frac{i}x\rceil,\lceil\frac{j}x\rceil]$。
显然，当且仅当$x|n$时能够找到这样的$x$，但是，考虑这个矩阵：
$$10$$
$$01$$
当$x=2$时，找不到这样的矩阵。
现在请对于一个给定的矩阵，求出最大的$x$值。你不需要求出$b$矩阵。
**本题采用特殊方式输入**。第一行输入一个整数$n$, 下面每一行包含$\frac{n}{4}$个$16$进制数字，每个数字表示这个矩阵的后$4$个位置。例如，$B\to 1110, 5 \to 0101$. **没有空格隔开**
**请使用快读**</div>
<h2>题目描述</h2>
<div>You are given a binary matrix $ A $ of size $ n \times n $ . Let's denote an $ x $ -compression of the given matrix as a matrix $ B $ of size $ \frac{n}{x} \times \frac{n}{x} $ such that for every $ i \in [1, n], j \in [1, n] $ the condition $ A[i][j] = B[\lceil \frac{i}{x} \rceil][\lceil \frac{j}{x} \rceil] $ is met.
Obviously, $ x $ -compression is possible only if $ x $ divides $ n $ , but this condition is not enough. For example, the following matrix of size $ 2 \times 2 $ does not have any $ 2 $ -compression:
$ 01 $ $ 10 $ For the given matrix $ A $ , find maximum $ x $ such that an $ x $ -compression of this matrix is possible.
Note that the input is given in compressed form. But even though it is compressed, you'd better use fast input.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains one number $ n $ ( $ 4 \le n \le 5200 $ ) — the number of rows and columns in the matrix $ A $ . It is guaranteed that $ n $ is divisible by $ 4 $ .
Then the representation of matrix follows. Each of $ n $ next lines contains $ \frac{n}{4} $ one-digit hexadecimal numbers (that is, these numbers can be represented either as digits from $ 0 $ to $ 9 $ or as uppercase Latin letters from $ A $ to $ F $ ). Binary representation of each of these numbers denotes next $ 4 $ elements of the matrix in the corresponding row. For example, if the number $ B $ is given, then the corresponding elements are 1011, and if the number is $ 5 $ , then the corresponding elements are 0101.
Elements are not separated by whitespaces.</div>
<h3>输出格式</h3>
<br />
<div>Print one number: maximum $ x $ such that an $ x $ -compression of the given matrix is possible.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>8
E7
E7
E7
00
00
E7
E7
E7
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>1
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>4
7
F
F
F
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>1
</code></pre>
<h2>说明</h2>
<div>The first example corresponds to the matrix:
$ 11100111 $ $ 11100111 $ $ 11100111 $ $ 00000000 $ $ 00000000 $ $ 11100111 $ $ 11100111 $ $ 11100111 $ It is easy to see that the answer on this example is $ 1 $ .</div>
</article>
</div>
</div>
</body>
</html>
