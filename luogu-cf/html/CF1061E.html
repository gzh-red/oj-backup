<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Politics - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573401107:Y17noYUlEdgL21mXpxyPofDyV6fQTIts0zs3KR88l64=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22There%20are%20%24%20n%20%24%20cities%20in%20the%20country.%5Cn%5CnTwo%20candidates%20are%20fighting%20for%20the%20post%20of%20the%20President.%20The%20elections%20are%20set%20in%20the%20future%2C%20and%20both%20candidates%20have%20already%20planned%20how%20they%20are%20going%20to%20connect%20the%20cities%20with%20roads.%20Both%20plans%20will%20connect%20all%20cities%20using%20%24%20n%20-%201%20%24%20roads%20only.%20That%20is%2C%20each%20plan%20can%20be%20viewed%20as%20a%20tree.%20Both%20of%20the%20candidates%20had%20also%20specified%20their%20choice%20of%20the%20capital%20among%20%24%20n%20%24%20cities%20%28%20%24%20x%20%24%20for%20the%20first%20candidate%20and%20%24%20y%20%24%20for%20the%20second%20candidate%29%2C%20which%20may%20or%20may%20not%20be%20same.%5Cn%5CnEach%20city%20has%20a%20potential%20of%20building%20a%20port%20%28one%20city%20can%20have%20at%20most%20one%20port%29.%20Building%20a%20port%20in%20%24%20i%20%24%20-th%20city%20brings%20%24%20a_i%20%24%20amount%20of%20money.%20However%2C%20each%20candidate%20has%20his%20specific%20demands.%20The%20demands%20are%20of%20the%20form%3A%5Cn%5Cn-%20%24%20k%20%24%20%24%20x%20%24%20%2C%20which%20means%20that%20the%20candidate%20wants%20to%20build%20exactly%20%24%20x%20%24%20ports%20in%20the%20subtree%20of%20the%20%24%20k%20%24%20-th%20city%20of%20his%20tree%20%28the%20tree%20is%20rooted%20at%20the%20capital%20of%20his%20choice%29.%5Cn%5CnFind%20out%20the%20maximum%20revenue%20that%20can%20be%20gained%20while%20fulfilling%20all%20demands%20of%20both%20candidates%2C%20or%20print%20-1%20if%20it%20is%20not%20possible%20to%20do.%5Cn%5CnIt%20is%20additionally%20guaranteed%2C%20that%20each%20candidate%20has%20specified%20the%20port%20demands%20for%20the%20capital%20of%20his%20choice.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20integers%20%24%20n%20%24%20%2C%20%24%20x%20%24%20and%20%24%20y%20%24%20%28%20%24%201%20%5C%5Cle%20n%20%5C%5Cle%20500%20%24%20%2C%20%24%201%20%5C%5Cle%20x%2C%20y%20%5C%5Cle%20n%20%24%20%29%20%5Cu2014%20the%20number%20of%20cities%2C%20the%20capital%20of%20the%20first%20candidate%20and%20the%20capital%20of%20the%20second%20candidate%20respectively.%5Cn%5CnNext%20line%20contains%20integers%20%24%20a_1%2C%20a_2%2C%20%5C%5Cldots%2C%20a_n%20%24%20%28%20%24%201%20%5C%5Cle%20a_i%20%5C%5Cle%20100%5C%5C%2C000%20%24%20%29%20%5Cu2014%20the%20revenue%20gained%20if%20the%20port%20is%20constructed%20in%20the%20corresponding%20city.%5Cn%5CnEach%20of%20the%20next%20%24%20n%20-%201%20%24%20lines%20contains%20integers%20%24%20u_i%20%24%20and%20%24%20v_i%20%24%20%28%20%24%201%20%5C%5Cle%20u_i%2C%20v_i%20%5C%5Cle%20n%20%24%20%2C%20%24%20u_i%20%5C%5Cne%20v_i%20%24%20%29%2C%20denoting%20edges%20between%20cities%20in%20the%20tree%20of%20the%20first%20candidate.%5Cn%5CnEach%20of%20the%20next%20%24%20n%20-%201%20%24%20lines%20contains%20integers%20%24%20u%27_i%20%24%20and%20%24%20v%27_i%20%24%20%28%20%24%201%20%5C%5Cle%20u%27_i%2C%20v%27_i%20%5C%5Cle%20n%20%24%20%2C%20%24%20u%27_i%20%5C%5Cne%20v%27_i%20%24%20%29%2C%20denoting%20edges%20between%20cities%20in%20the%20tree%20of%20the%20second%20candidate.%5Cn%5CnNext%20line%20contains%20an%20integer%20%24%20q_1%20%24%20%28%20%24%201%20%5C%5Cle%20q_1%20%5C%5Cle%20n%20%24%20%29%2C%20denoting%20the%20number%20of%20demands%20of%20the%20first%20candidate.%5Cn%5CnEach%20of%20the%20next%20%24%20q_1%20%24%20lines%20contains%20two%20integers%20%24%20k%20%24%20and%20%24%20x%20%24%20%28%20%24%201%20%5C%5Cle%20k%20%5C%5Cle%20n%20%24%20%2C%20%24%201%20%5C%5Cle%20x%20%5C%5Cle%20n%20%24%20%29%20%5Cu2014%20the%20city%20number%20and%20the%20number%20of%20ports%20in%20its%20subtree.%5Cn%5CnNext%20line%20contains%20an%20integer%20%24%20q_2%20%24%20%28%20%24%201%20%5C%5Cle%20q_2%20%5C%5Cle%20n%20%24%20%29%2C%20denoting%20the%20number%20of%20demands%20of%20the%20second%20candidate.%5Cn%5CnEach%20of%20the%20next%20%24%20q_2%20%24%20lines%20contain%20two%20integers%20%24%20k%20%24%20and%20%24%20x%20%24%20%28%20%24%201%20%5C%5Cle%20k%20%5C%5Cle%20n%20%24%20%2C%20%24%201%20%5C%5Cle%20x%20%5C%5Cle%20n%20%24%20%29%20%5Cu2014%20the%20city%20number%20and%20the%20number%20of%20ports%20in%20its%20subtree.%5Cn%5CnIt%20is%20guaranteed%2C%20that%20given%20edges%20correspond%20to%20valid%20trees%2C%20each%20candidate%20has%20given%20demand%20about%20each%20city%20at%20most%20once%20and%20that%20each%20candidate%20has%20specified%20the%20port%20demands%20for%20the%20capital%20of%20his%20choice.%20That%20is%2C%20the%20city%20%24%20x%20%24%20is%20always%20given%20in%20demands%20of%20the%20first%20candidate%20and%20city%20%24%20y%20%24%20is%20always%20given%20in%20the%20demands%20of%20the%20second%20candidate.%22%2C%22outputFormat%22%3A%22Print%20exactly%20one%20integer%20%5Cu2014%20the%20maximum%20possible%20revenue%20that%20can%20be%20gained%2C%20while%20satisfying%20demands%20of%20both%20candidates%2C%20or%20-1%20if%20it%20is%20not%20possible%20to%20satisfy%20all%20of%20the%20demands.%22%2C%22samples%22%3A%5B%5B%224%201%202%5Cn1%202%203%204%5Cn1%202%5Cn1%203%5Cn3%204%5Cn1%202%5Cn2%203%5Cn1%204%5Cn2%5Cn1%203%5Cn4%201%5Cn1%5Cn2%203%5Cn%22%2C%229%22%5D%2C%5B%225%201%201%5Cn3%2099%2099%20100%202%5Cn1%202%5Cn1%203%5Cn3%204%5Cn3%205%5Cn1%203%5Cn1%202%5Cn2%204%5Cn2%205%5Cn2%5Cn1%202%5Cn3%201%5Cn2%5Cn1%202%5Cn2%201%5Cn%22%2C%22198%22%5D%2C%5B%224%201%202%5Cn1%202%203%204%5Cn1%202%5Cn1%203%5Cn3%204%5Cn2%201%5Cn2%204%5Cn4%203%5Cn1%5Cn1%204%5Cn2%5Cn4%201%5Cn2%204%5Cn%22%2C%22-1%22%5D%5D%2C%22hint%22%3A%22In%20the%20first%20example%2C%20it%20is%20optimal%20to%20build%20ports%20in%20cities%20%24%202%20%24%20%2C%20%24%203%20%24%20and%20%24%204%20%24%20%2C%20which%20fulfills%20all%20demands%20of%20both%20candidates%20and%20gives%20revenue%20equal%20to%20%24%202%20%2B%203%20%2B%204%20%3D%209%20%24%20.%5Cn%5CnIn%20the%20second%20example%2C%20it%20is%20optimal%20to%20build%20ports%20in%20cities%20%24%202%20%24%20and%20%24%203%20%24%20%2C%20which%20fulfills%20all%20demands%20of%20both%20candidates%20and%20gives%20revenue%20equal%20to%20%24%2099%20%2B%2099%20%3D%20198%20%24%20.%5Cn%5CnIn%20the%20third%20example%2C%20it%20is%20not%20possible%20to%20build%20ports%20in%20such%20way%2C%20that%20all%20demands%20of%20both%20candidates%20are%20specified%2C%20hence%20the%20answer%20is%20-1.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B4000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F1061%5C%2FE%22%2C%22id%22%3A%221061E%22%7D%2C%22translation%22%3A%22%5Cu4e24%5Cu9897%5Cu6709%5Cu6839%5Cu6811%5Cuff0c%5Cu7ed9%5Cu5b9a%5Cu5404%5Cu4e2a%5Cu6811%5Cu7684%5Cu6839%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu8fd9%5Cu4e24%5Cu9897%5Cu6811%5Cu90fd%5Cu6709%24n%24%5Cu4e2a%5Cu70b9%5Cuff0c%5Cu4f9d%5Cu6b21%5Cu7f16%5Cu53f7%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu7ed9%5Cu5b9a%5Cu6bcf%5Cu4e2a%5Cu7f16%5Cu53f7%5Cu7684%5Cu4ef7%5Cu503c%5Cuff0c%5Cu4f60%5Cu53ef%5Cu4ee5%5Cu6807%5Cu8bb0%5Cu67d0%5Cu4e9b%5Cu7f16%5Cu53f7%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu4e24%5Cu9897%5Cu6811%5Cu90fd%5Cu6709%5Cu82e5%5Cu5e72%5Cu6761%5Cu4ef6%5Cuff1a%5Cu5728%5Cu90a3%5Cu68f5%5Cu6811%5Cu4e0a%5Cuff0c%5Cu67d0%5Cu4e2a%5Cu7f16%5Cu53f7%5Cu5bf9%5Cu5e94%5Cu8282%5Cu70b9%5Cu7684%5Cu5b50%5Cu6811%5Cu5185%5Cu6709%5Cu7ed9%5Cu5b9a%5Cu4e2a%5Cu6570%5Cu7684%5Cu7f16%5Cu53f7%5Cu88ab%5Cu6807%5Cu8bb0%5Cr%5Cn%5Cr%5Cn%5Cu6c42%5Cu6ee1%5Cu8db3%5Cu6761%5Cu4ef6%5Cu7684%5Cu6700%5Cu5927%5Cu7684%5Cu6807%5Cu8bb0%5Cu7f16%5Cu53f7%5Cu7684%5Cu4ef7%5Cu503c%5Cu548c%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A104%2C%22totalAccepted%22%3A48%2C%22pid%22%3A%22CF1061E%22%2C%22title%22%3A%22Politics%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P1935%22%2C%22title%22%3A%22%5B%5Cu56fd%5Cu5bb6%5Cu96c6%5Cu8bad%5Cu961f%5D%5Cu5708%5Cu5730%5Cu8ba1%5Cu5212%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22CF960G%22%2C%22title%22%3A%22Bandit%20Blues%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1045H%22%2C%22title%22%3A%22Self-exploration%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22P4980%22%2C%22title%22%3A%22%5Cu3010%5Cu6a21%5Cu677f%5Cu3011Polya%5Cu5b9a%5Cu7406%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P5401%22%2C%22title%22%3A%22%5BCTS2019%5D%5Cu73cd%5Cu73e0%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Politics%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Politics</h1>
<h2>题意翻译</h2>
<div>两颗有根树，给定各个树的根。
这两颗树都有$n$个点，依次编号。
给定每个编号的价值，你可以标记某些编号。
两颗树都有若干条件：在那棵树上，某个编号对应节点的子树内有给定个数的编号被标记
求满足条件的最大的标记编号的价值和</div>
<h2>题目描述</h2>
<div>There are $ n $ cities in the country.
Two candidates are fighting for the post of the President. The elections are set in the future, and both candidates have already planned how they are going to connect the cities with roads. Both plans will connect all cities using $ n - 1 $ roads only. That is, each plan can be viewed as a tree. Both of the candidates had also specified their choice of the capital among $ n $ cities ( $ x $ for the first candidate and $ y $ for the second candidate), which may or may not be same.
Each city has a potential of building a port (one city can have at most one port). Building a port in $ i $ -th city brings $ a_i $ amount of money. However, each candidate has his specific demands. The demands are of the form:
- $ k $ $ x $ , which means that the candidate wants to build exactly $ x $ ports in the subtree of the $ k $ -th city of his tree (the tree is rooted at the capital of his choice).
Find out the maximum revenue that can be gained while fulfilling all demands of both candidates, or print -1 if it is not possible to do.
It is additionally guaranteed, that each candidate has specified the port demands for the capital of his choice.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains integers $ n $ , $ x $ and $ y $ ( $ 1 \le n \le 500 $ , $ 1 \le x, y \le n $ ) — the number of cities, the capital of the first candidate and the capital of the second candidate respectively.
Next line contains integers $ a_1, a_2, \ldots, a_n $ ( $ 1 \le a_i \le 100\,000 $ ) — the revenue gained if the port is constructed in the corresponding city.
Each of the next $ n - 1 $ lines contains integers $ u_i $ and $ v_i $ ( $ 1 \le u_i, v_i \le n $ , $ u_i \ne v_i $ ), denoting edges between cities in the tree of the first candidate.
Each of the next $ n - 1 $ lines contains integers $ u'_i $ and $ v'_i $ ( $ 1 \le u'_i, v'_i \le n $ , $ u'_i \ne v'_i $ ), denoting edges between cities in the tree of the second candidate.
Next line contains an integer $ q_1 $ ( $ 1 \le q_1 \le n $ ), denoting the number of demands of the first candidate.
Each of the next $ q_1 $ lines contains two integers $ k $ and $ x $ ( $ 1 \le k \le n $ , $ 1 \le x \le n $ ) — the city number and the number of ports in its subtree.
Next line contains an integer $ q_2 $ ( $ 1 \le q_2 \le n $ ), denoting the number of demands of the second candidate.
Each of the next $ q_2 $ lines contain two integers $ k $ and $ x $ ( $ 1 \le k \le n $ , $ 1 \le x \le n $ ) — the city number and the number of ports in its subtree.
It is guaranteed, that given edges correspond to valid trees, each candidate has given demand about each city at most once and that each candidate has specified the port demands for the capital of his choice. That is, the city $ x $ is always given in demands of the first candidate and city $ y $ is always given in the demands of the second candidate.</div>
<h3>输出格式</h3>
<br />
<div>Print exactly one integer — the maximum possible revenue that can be gained, while satisfying demands of both candidates, or -1 if it is not possible to satisfy all of the demands.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>4 1 2
1 2 3 4
1 2
1 3
3 4
1 2
2 3
1 4
2
1 3
4 1
1
2 3
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>9</code></pre>
<h3>输入样例 #2</h3>
<pre><code>5 1 1
3 99 99 100 2
1 2
1 3
3 4
3 5
1 3
1 2
2 4
2 5
2
1 2
3 1
2
1 2
2 1
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>198</code></pre>
<h3>输入样例 #3</h3>
<pre><code>4 1 2
1 2 3 4
1 2
1 3
3 4
2 1
2 4
4 3
1
1 4
2
4 1
2 4
</code></pre>
<h3>输出样例 #3</h3>
<pre><code>-1</code></pre>
<h2>说明</h2>
<div>In the first example, it is optimal to build ports in cities $ 2 $ , $ 3 $ and $ 4 $ , which fulfills all demands of both candidates and gives revenue equal to $ 2 + 3 + 4 = 9 $ .
In the second example, it is optimal to build ports in cities $ 2 $ and $ 3 $ , which fulfills all demands of both candidates and gives revenue equal to $ 99 + 99 = 198 $ .
In the third example, it is not possible to build ports in such way, that all demands of both candidates are specified, hence the answer is -1.</div>
</article>
</div>
</div>
</body>
</html>
