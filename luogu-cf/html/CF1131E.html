<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>String Multiplication - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573402016:56f+D98IGWXT0JW4q1dm9vk8I3g2KjsLDrH+ZTbVRw4=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Roman%20and%20Denis%20are%20on%20the%20trip%20to%20the%20programming%20competition.%20Since%20the%20trip%20was%20long%2C%20they%20soon%20got%20bored%2C%20and%20hence%20decided%20to%20came%20up%20with%20something.%20Roman%20invented%20a%20pizza%27s%20recipe%2C%20while%20Denis%20invented%20a%20string%20multiplication.%20According%20to%20Denis%2C%20the%20result%20of%20multiplication%20%28product%29%20of%20strings%20%24%20s%20%24%20of%20length%20%24%20m%20%24%20and%20%24%20t%20%24%20is%20a%20string%20%24%20t%20%2B%20s_1%20%2B%20t%20%2B%20s_2%20%2B%20%5C%5Cldots%20%2B%20t%20%2B%20s_m%20%2B%20t%20%24%20%2C%20where%20%24%20s_i%20%24%20denotes%20the%20%24%20i%20%24%20-th%20symbol%20of%20the%20string%20%24%20s%20%24%20%2C%20and%20%5C%22%2B%5C%22%20denotes%20string%20concatenation.%20For%20example%2C%20the%20product%20of%20strings%20%5C%22abc%5C%22%20and%20%5C%22de%5C%22%20is%20a%20string%20%5C%22deadebdecde%5C%22%2C%20while%20the%20product%20of%20the%20strings%20%5C%22ab%5C%22%20and%20%5C%22z%5C%22%20is%20a%20string%20%5C%22zazbz%5C%22.%20Note%2C%20that%20unlike%20the%20numbers%20multiplication%2C%20the%20product%20of%20strings%20%24%20s%20%24%20and%20%24%20t%20%24%20is%20not%20necessarily%20equal%20to%20product%20of%20%24%20t%20%24%20and%20%24%20s%20%24%20.%5Cn%5CnRoman%20was%20jealous%20of%20Denis%2C%20since%20he%20invented%20such%20a%20cool%20operation%2C%20and%20hence%20decided%20to%20invent%20something%20string-related%20too.%20Since%20Roman%20is%20beauty-lover%2C%20he%20decided%20to%20define%20the%20beauty%20of%20the%20string%20as%20the%20length%20of%20the%20longest%20substring%2C%20consisting%20of%20only%20one%20letter.%20For%20example%2C%20the%20beauty%20of%20the%20string%20%5C%22xayyaaabca%5C%22%20is%20equal%20to%20%24%203%20%24%20%2C%20since%20there%20is%20a%20substring%20%5C%22aaa%5C%22%2C%20while%20the%20beauty%20of%20the%20string%20%5C%22qwerqwer%5C%22%20is%20equal%20to%20%24%201%20%24%20%2C%20since%20all%20neighboring%20symbols%20in%20it%20are%20different.%5Cn%5CnIn%20order%20to%20entertain%20Roman%2C%20Denis%20wrote%20down%20%24%20n%20%24%20strings%20%24%20p_1%2C%20p_2%2C%20p_3%2C%20%5C%5Cldots%2C%20p_n%20%24%20on%20the%20paper%20and%20asked%20him%20to%20calculate%20the%20beauty%20of%20the%20string%20%24%20%28%20%5C%5Cldots%20%28%28%28p_1%20%5C%5Ccdot%20p_2%29%20%5C%5Ccdot%20p_3%29%20%5C%5Ccdot%20%5C%5Cldots%20%29%20%5C%5Ccdot%20p_n%20%24%20%2C%20where%20%24%20s%20%5C%5Ccdot%20t%20%24%20denotes%20a%20multiplication%20of%20strings%20%24%20s%20%24%20and%20%24%20t%20%24%20.%20Roman%20hasn%27t%20fully%20realized%20how%20Denis%27s%20multiplication%20works%2C%20so%20he%20asked%20you%20for%20a%20help.%20Denis%20knows%2C%20that%20Roman%20is%20very%20impressionable%2C%20he%20guarantees%2C%20that%20the%20beauty%20of%20the%20resulting%20string%20is%20at%20most%20%24%2010%5E9%20%24%20.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20a%20single%20integer%20%24%20n%20%24%20%28%20%24%202%20%5C%5Cleq%20n%20%5C%5Cleq%20100%5C%5C%2C000%20%24%20%29%20%5Cu2014%20the%20number%20of%20strings%2C%20wroted%20by%20Denis.%5Cn%5CnNext%20%24%20n%20%24%20lines%20contain%20non-empty%20strings%20%24%20p_1%2C%20p_2%2C%20%5C%5Cldots%2C%20p_n%20%24%20%2C%20consisting%20of%20lowercase%20english%20letters.%5Cn%5CnIt%27s%20guaranteed%2C%20that%20the%20total%20length%20of%20the%20strings%20%24%20p_i%20%24%20is%20at%20most%20%24%20100%5C%5C%2C000%20%24%20%2C%20and%20that%27s%20the%20beauty%20of%20the%20resulting%20product%20is%20at%20most%20%24%2010%5E9%20%24%20.%22%2C%22outputFormat%22%3A%22Print%20exactly%20one%20integer%20%5Cu2014%20the%20beauty%20of%20the%20product%20of%20the%20strings.%22%2C%22samples%22%3A%5B%5B%22%5Cn3%5Cna%5Cnb%5Cna%5Cn%22%2C%22%5Cn3%5Cn%22%5D%2C%5B%22%5Cn2%5Cnbnn%5Cna%5Cn%22%2C%22%5Cn1%5Cn%22%5D%5D%2C%22hint%22%3A%22In%20the%20first%20example%2C%20the%20product%20of%20strings%20is%20equal%20to%20%5C%22abaaaba%5C%22.%5Cn%5CnIn%20the%20second%20example%2C%20the%20product%20of%20strings%20is%20equal%20to%20%5C%22abanana%5C%22.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F1131%5C%2FE%22%2C%22id%22%3A%221131E%22%7D%2C%22translation%22%3A%22%5Cu5b9a%5Cu4e49%5Cu4e24%5Cu4e2a%5Cu5b57%5Cu7b26%5Cu4e32%20%24s%24%20%5Cu548c%20%24t%24%5Cuff08%24s%24%20%5Cu7684%5Cu957f%5Cu5ea6%5Cu4e3a%20%24m%24%5Cuff09%5Cu7684%5Cu4e58%5Cu79ef%5Cu4e3a%20%24t%2Bs_1%2Bt%2Bs_2%2B%5C%5Cdots%2Bt%2Bs_m%2Bt%24%5Cu3002%5Cu5b9a%5Cu4e49%5Cu4e00%5Cu4e2a%5Cu5b57%5Cu7b26%5Cu4e32%5Cu7684%5Cu7f8e%5Cu4e3d%5Cu5ea6%5Cu4e3a%5Cu6700%5Cu957f%5Cu7684%5Cu76f8%5Cu540c%5Cu5b57%5Cu6bcd%5Cu8fde%5Cu7eed%5Cu5b50%5Cu5e8f%5Cu5217%5Cu7684%5Cu957f%5Cu5ea6%5Cu3002%5Cu73b0%5Cu5728%5Cu7ed9%5Cu51fa%20%24n%24%20%5Cu4e2a%5Cu5b57%5Cu7b26%5Cu4e32%20%24p_i%24%5Cuff0c%5Cu95ee%20%24%28%28p_1p_2%29p_3%29%5C%5Cdots%20p_n%24%20%5Cu7684%5Cu7f8e%5Cu4e3d%5Cu5ea6%5Cu3002%5Cr%5Cn%5Cr%5Cn%241%5C%5Cle%20n%5C%5Cle%2010%5E5%2C%5C%5Csum%7Cp_i%7C%5C%5Cle%2010%5E5%24%5Cu3002%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A30%2C%22totalAccepted%22%3A27%2C%22pid%22%3A%22CF1131E%22%2C%22title%22%3A%22String%20Multiplication%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22String%20Multiplication%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>String Multiplication</h1>
<h2>题意翻译</h2>
<div>定义两个字符串 $s$ 和 $t$（$s$ 的长度为 $m$）的乘积为 $t+s_1+t+s_2+\dots+t+s_m+t$。定义一个字符串的美丽度为最长的相同字母连续子序列的长度。现在给出 $n$ 个字符串 $p_i$，问 $((p_1p_2)p_3)\dots p_n$ 的美丽度。
$1\le n\le 10^5,\sum|p_i|\le 10^5$。</div>
<h2>题目描述</h2>
<div>Roman and Denis are on the trip to the programming competition. Since the trip was long, they soon got bored, and hence decided to came up with something. Roman invented a pizza's recipe, while Denis invented a string multiplication. According to Denis, the result of multiplication (product) of strings $ s $ of length $ m $ and $ t $ is a string $ t + s_1 + t + s_2 + \ldots + t + s_m + t $ , where $ s_i $ denotes the $ i $ -th symbol of the string $ s $ , and "+" denotes string concatenation. For example, the product of strings "abc" and "de" is a string "deadebdecde", while the product of the strings "ab" and "z" is a string "zazbz". Note, that unlike the numbers multiplication, the product of strings $ s $ and $ t $ is not necessarily equal to product of $ t $ and $ s $ .
Roman was jealous of Denis, since he invented such a cool operation, and hence decided to invent something string-related too. Since Roman is beauty-lover, he decided to define the beauty of the string as the length of the longest substring, consisting of only one letter. For example, the beauty of the string "xayyaaabca" is equal to $ 3 $ , since there is a substring "aaa", while the beauty of the string "qwerqwer" is equal to $ 1 $ , since all neighboring symbols in it are different.
In order to entertain Roman, Denis wrote down $ n $ strings $ p_1, p_2, p_3, \ldots, p_n $ on the paper and asked him to calculate the beauty of the string $ ( \ldots (((p_1 \cdot p_2) \cdot p_3) \cdot \ldots ) \cdot p_n $ , where $ s \cdot t $ denotes a multiplication of strings $ s $ and $ t $ . Roman hasn't fully realized how Denis's multiplication works, so he asked you for a help. Denis knows, that Roman is very impressionable, he guarantees, that the beauty of the resulting string is at most $ 10^9 $ .</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains a single integer $ n $ ( $ 2 \leq n \leq 100\,000 $ ) — the number of strings, wroted by Denis.
Next $ n $ lines contain non-empty strings $ p_1, p_2, \ldots, p_n $ , consisting of lowercase english letters.
It's guaranteed, that the total length of the strings $ p_i $ is at most $ 100\,000 $ , and that's the beauty of the resulting product is at most $ 10^9 $ .</div>
<h3>输出格式</h3>
<br />
<div>Print exactly one integer — the beauty of the product of the strings.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>
3
a
b
a
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>
3
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>
2
bnn
a
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>
1
</code></pre>
<h2>说明</h2>
<div>In the first example, the product of strings is equal to "abaaaba".
In the second example, the product of strings is equal to "abanana".</div>
</article>
</div>
</div>
</body>
</html>
