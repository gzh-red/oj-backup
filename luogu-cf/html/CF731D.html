<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>80-th Level Archeology - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573397200:2NS+s1teiEw0G6h10TdtHVpzu6fAM6Hdc0W/rxwNVSw=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Archeologists%20have%20found%20a%20secret%20pass%20in%20the%20dungeon%20of%20one%20of%20the%20pyramids%20of%20Cycleland.%20To%20enter%20the%20treasury%20they%20have%20to%20open%20an%20unusual%20lock%20on%20the%20door.%20The%20lock%20consists%20of%20%24%20n%20%24%20words%2C%20each%20consisting%20of%20some%20hieroglyphs.%20The%20wall%20near%20the%20lock%20has%20a%20round%20switch.%20Each%20rotation%20of%20this%20switch%20changes%20the%20hieroglyphs%20according%20to%20some%20rules.%20The%20instruction%20nearby%20says%20that%20the%20door%20will%20open%20only%20if%20words%20written%20on%20the%20lock%20would%20be%20sorted%20in%20lexicographical%20order%20%28the%20definition%20of%20lexicographical%20comparison%20in%20given%20in%20notes%20section%29.%5Cn%5CnThe%20rule%20that%20changes%20hieroglyphs%20is%20the%20following.%20One%20clockwise%20rotation%20of%20the%20round%20switch%20replaces%20each%20hieroglyph%20with%20the%20next%20hieroglyph%20in%20alphabet%2C%20i.e.%20hieroglyph%20%24%20x%20%24%20%28%20%24%201%3C%3Dx%3C%3Dc-1%20%24%20%29%20is%20replaced%20with%20hieroglyph%20%24%20%28x%2B1%29%20%24%20%2C%20and%20hieroglyph%20%24%20c%20%24%20is%20replaced%20with%20hieroglyph%20%24%201%20%24%20.%5Cn%5CnHelp%20archeologist%20determine%2C%20how%20many%20clockwise%20rotations%20they%20should%20perform%20in%20order%20to%20open%20the%20door%2C%20or%20determine%20that%20this%20is%20impossible%2C%20i.e.%20no%20cyclic%20shift%20of%20the%20alphabet%20will%20make%20the%20sequence%20of%20words%20sorted%20lexicographically.%22%2C%22inputFormat%22%3A%22The%20first%20line%20of%20the%20input%20contains%20two%20integers%20%24%20n%20%24%20and%20%24%20c%20%24%20%28%20%24%202%3C%3Dn%3C%3D500000%20%24%20%2C%20%24%201%3C%3Dc%3C%3D10%5E%7B6%7D%20%24%20%29%20%5Cu2014%20the%20number%20of%20words%2C%20written%20on%20the%20lock%2C%20and%20the%20number%20of%20different%20hieroglyphs.%5Cn%5CnEach%20of%20the%20following%20%24%20n%20%24%20lines%20contains%20the%20description%20of%20one%20word.%20The%20%24%20i%20%24%20-th%20of%20these%20lines%20starts%20with%20integer%20%24%20l_%7Bi%7D%20%24%20%28%20%24%201%3C%3Dl_%7Bi%7D%3C%3D500000%20%24%20%29%2C%20that%20denotes%20the%20length%20of%20the%20%24%20i%20%24%20-th%20word%2C%20followed%20by%20%24%20l_%7Bi%7D%20%24%20integers%20%24%20w_%7Bi%2C1%7D%20%24%20%2C%20%24%20w_%7Bi%2C2%7D%20%24%20%2C%20...%2C%20%24%20w_%7Bi%2Cli%7D%20%24%20%28%20%24%201%3C%3Dw_%7Bi%2Cj%7D%3C%3Dc%20%24%20%29%20%5Cu2014%20the%20indices%20of%20hieroglyphs%20that%20make%20up%20the%20%24%20i%20%24%20-th%20word.%20Hieroglyph%20with%20index%20%24%201%20%24%20is%20the%20smallest%20in%20the%20alphabet%20and%20with%20index%20%24%20c%20%24%20%5Cu2014%20the%20biggest.%5Cn%5CnIt%27s%20guaranteed%2C%20that%20the%20total%20length%20of%20all%20words%20doesn%27t%20exceed%20%24%2010%5E%7B6%7D%20%24%20.%22%2C%22outputFormat%22%3A%22If%20it%20is%20possible%20to%20open%20the%20door%20by%20rotating%20the%20round%20switch%2C%20print%20integer%20%24%20x%20%24%20%28%20%24%200%3C%3Dx%3C%3Dc-1%20%24%20%29%20that%20defines%20the%20required%20number%20of%20clockwise%20rotations.%20If%20there%20are%20several%20valid%20%24%20x%20%24%20%2C%20print%20any%20of%20them.%5Cn%5CnIf%20it%20is%20impossible%20to%20open%20the%20door%20by%20this%20method%2C%20print%20%24%20-1%20%24%20.%22%2C%22samples%22%3A%5B%5B%224%203%5Cn2%203%202%5Cn1%201%5Cn3%202%203%201%5Cn4%202%203%201%202%5Cn%22%2C%221%5Cn%22%5D%2C%5B%222%205%5Cn2%204%202%5Cn2%204%202%5Cn%22%2C%220%5Cn%22%5D%2C%5B%224%204%5Cn1%202%5Cn1%203%5Cn1%204%5Cn1%202%5Cn%22%2C%22-1%5Cn%22%5D%5D%2C%22hint%22%3A%22Word%20%24%20a_%7B1%7D%2Ca_%7B2%7D%2C...%2Ca_%7Bm%7D%20%24%20of%20length%20%24%20m%20%24%20is%20lexicographically%20not%20greater%20than%20word%20%24%20b_%7B1%7D%2Cb_%7B2%7D%2C...%2Cb_%7Bk%7D%20%24%20of%20length%20%24%20k%20%24%20%2C%20if%20one%20of%20two%20conditions%20hold%3A%5Cn%5Cn-%20at%20first%20position%20%24%20i%20%24%20%2C%20such%20that%20%24%20a_%7Bi%7D%5Cu2260b_%7Bi%7D%20%24%20%2C%20the%20character%20%24%20a_%7Bi%7D%20%24%20goes%20earlier%20in%20the%20alphabet%20than%20character%20%24%20b_%7Bi%7D%20%24%20%2C%20i.e.%20%24%20a%20%24%20has%20smaller%20character%20in%20the%20first%20position%20where%20they%20differ%3B%5Cn-%20if%20there%20is%20no%20such%20position%20%24%20i%20%24%20and%20%24%20m%3C%3Dk%20%24%20%2C%20i.e.%20the%20first%20word%20is%20a%20prefix%20of%20the%20second%20or%20two%20words%20are%20equal.%5Cn%5CnThe%20sequence%20of%20words%20is%20said%20to%20be%20sorted%20in%20lexicographical%20order%20if%20each%20word%20%28except%20the%20last%20one%29%20is%20lexicographically%20not%20greater%20than%20the%20next%20word.%5Cn%5CnIn%20the%20first%20sample%2C%20after%20the%20round%20switch%20is%20rotated%20%24%201%20%24%20position%20clockwise%20the%20words%20look%20as%20follows%3A%5Cn%5Cn%60%3Cbr%3E%3C%5C%2Fbr%3E1%203%3Cbr%3E%3C%5C%2Fbr%3E2%3Cbr%3E%3C%5C%2Fbr%3E3%201%202%3Cbr%3E%3C%5C%2Fbr%3E3%201%202%203%3Cbr%3E%3C%5C%2Fbr%3E%60In%20the%20second%20sample%2C%20words%20are%20already%20sorted%20in%20lexicographical%20order.%5Cn%5CnIn%20the%20last%20sample%2C%20one%20can%20check%20that%20no%20shift%20of%20the%20alphabet%20will%20work.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F731%5C%2FD%22%2C%22id%22%3A%22731D%22%7D%2C%22translation%22%3A%22%5Cu6709n%5Cu4e2a%5Cu6570%5Cu5217%5Cuff0c%5Cu6bcf%5Cu4e2a%5Cu6570%5Cu5217%5Cu957f%5Cu5ea6%5Cu53ef%5Cu80fd%5Cu4e0d%5Cu4e00%5Cu6837%5Cuff0c%5Cu540c%5Cu65f6%5Cu6709%5Cu4e00%5Cu4e2ac%5Cuff0c%5Cu4f60%5Cu6709%5Cu4e00%5Cu79cd%5Cu64cd%5Cu4f5c%5Cuff0c%5Cu8ba9%5Cu8fd9n%5Cu4e2a%5Cu6570%5Cu5217%5Cu4e2d%5Cu6240%5Cu6709%5Cu5c0f%5Cu4e8ec%5Cu7684%5Cu6570%5Cu90fd%5Cu52a01%5Cuff0c%5Cu6240%5Cu6709%5Cu7b49%5Cu4e8ec%5Cu7684%5Cu6570%5Cu53d8%5Cu62100.%5Cu95ee%5Cu4f60%5Cu6700%5Cu5c11%5Cu53ef%5Cu4ee5%5Cu64cd%5Cu4f5c%5Cu51e0%5Cu6b21%5Cu53ef%5Cu4ee5%5Cu8ba9%5Cu8fd9n%5Cu4e2a%5Cu6570%5Cu5217%5Cu6ee1%5Cu8db3%5Cu5b57%5Cu5178%5Cu5e8f%22%2C%22tags%22%3A%5B1%2C254%2C266%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A13%2C%22totalAccepted%22%3A5%2C%22pid%22%3A%22CF731D%22%2C%22title%22%3A%2280-th%20Level%20Archeology%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A106133%2C%22title%22%3A%22%5Cu7ffb%5Cu8bd12%22%2C%22forum%22%3A%7B%22id%22%3A9697%2C%22name%22%3A%22CF731D%2080-th%20Level%20Archeology%22%2C%22slug%22%3A%22CF731D%22%7D%7D%2C%7B%22id%22%3A40966%2C%22title%22%3A%22%5Cu7ffb%5Cu8bd1%22%2C%22forum%22%3A%7B%22id%22%3A9697%2C%22name%22%3A%22CF731D%2080-th%20Level%20Archeology%22%2C%22slug%22%3A%22CF731D%22%7D%7D%2C%7B%22id%22%3A37324%2C%22title%22%3A%22%5Cu849f%5Cu84bb%5Cu7ffb%5Cu8bd1%22%2C%22forum%22%3A%7B%22id%22%3A9697%2C%22name%22%3A%22CF731D%2080-th%20Level%20Archeology%22%2C%22slug%22%3A%22CF731D%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%2280-th%20Level%20Archeology%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>80-th Level Archeology</h1>
<h2>题意翻译</h2>
<div>有n个数列，每个数列长度可能不一样，同时有一个c，你有一种操作，让这n个数列中所有小于c的数都加1，所有等于c的数变成0.问你最少可以操作几次可以让这n个数列满足字典序</div>
<h2>题目描述</h2>
<div>Archeologists have found a secret pass in the dungeon of one of the pyramids of Cycleland. To enter the treasury they have to open an unusual lock on the door. The lock consists of $ n $ words, each consisting of some hieroglyphs. The wall near the lock has a round switch. Each rotation of this switch changes the hieroglyphs according to some rules. The instruction nearby says that the door will open only if words written on the lock would be sorted in lexicographical order (the definition of lexicographical comparison in given in notes section).
The rule that changes hieroglyphs is the following. One clockwise rotation of the round switch replaces each hieroglyph with the next hieroglyph in alphabet, i.e. hieroglyph $ x $ ( $ 1<=x<=c-1 $ ) is replaced with hieroglyph $ (x+1) $ , and hieroglyph $ c $ is replaced with hieroglyph $ 1 $ .
Help archeologist determine, how many clockwise rotations they should perform in order to open the door, or determine that this is impossible, i.e. no cyclic shift of the alphabet will make the sequence of words sorted lexicographically.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line of the input contains two integers $ n $ and $ c $ ( $ 2<=n<=500000 $ , $ 1<=c<=10^{6} $ ) — the number of words, written on the lock, and the number of different hieroglyphs.
Each of the following $ n $ lines contains the description of one word. The $ i $ -th of these lines starts with integer $ l_{i} $ ( $ 1<=l_{i}<=500000 $ ), that denotes the length of the $ i $ -th word, followed by $ l_{i} $ integers $ w_{i,1} $ , $ w_{i,2} $ , ..., $ w_{i,li} $ ( $ 1<=w_{i,j}<=c $ ) — the indices of hieroglyphs that make up the $ i $ -th word. Hieroglyph with index $ 1 $ is the smallest in the alphabet and with index $ c $ — the biggest.
It's guaranteed, that the total length of all words doesn't exceed $ 10^{6} $ .</div>
<h3>输出格式</h3>
<br />
<div>If it is possible to open the door by rotating the round switch, print integer $ x $ ( $ 0<=x<=c-1 $ ) that defines the required number of clockwise rotations. If there are several valid $ x $ , print any of them.
If it is impossible to open the door by this method, print $ -1 $ .</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>4 3
2 3 2
1 1
3 2 3 1
4 2 3 1 2
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>1
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>2 5
2 4 2
2 4 2
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>0
</code></pre>
<h3>输入样例 #3</h3>
<pre><code>4 4
1 2
1 3
1 4
1 2
</code></pre>
<h3>输出样例 #3</h3>
<pre><code>-1
</code></pre>
<h2>说明</h2>
<div>Word $ a_{1},a_{2},...,a_{m} $ of length $ m $ is lexicographically not greater than word $ b_{1},b_{2},...,b_{k} $ of length $ k $ , if one of two conditions hold:
- at first position $ i $ , such that $ a_{i}≠b_{i} $ , the character $ a_{i} $ goes earlier in the alphabet than character $ b_{i} $ , i.e. $ a $ has smaller character in the first position where they differ;
- if there is no such position $ i $ and $ m<=k $ , i.e. the first word is a prefix of the second or two words are equal.
The sequence of words is said to be sorted in lexicographical order if each word (except the last one) is lexicographically not greater than the next word.
In the first sample, after the round switch is rotated $ 1 $ position clockwise the words look as follows:
`<br></br>1 3<br></br>2<br></br>3 1 2<br></br>3 1 2 3<br></br>`In the second sample, words are already sorted in lexicographical order.
In the last sample, one can check that no shift of the alphabet will work.</div>
</article>
</div>
</div>
</body>
</html>
