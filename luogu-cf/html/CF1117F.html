<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Crisp String - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573401897:H5ZONDRwcKQH1biw2bZqv1nwUgt+nNbv4JA2KtXxxaA=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22You%20are%20given%20a%20string%20of%20length%20%24%20n%20%24%20.%20Each%20character%20is%20one%20of%20the%20first%20%24%20p%20%24%20lowercase%20Latin%20letters.%5Cn%5CnYou%20are%20also%20given%20a%20matrix%20%24%20A%20%24%20with%20binary%20values%20of%20size%20%24%20p%20%5C%5Ctimes%20p%20%24%20.%20This%20matrix%20is%20symmetric%20%28%20%24%20A_%7Bij%7D%20%3D%20A_%7Bji%7D%20%24%20%29.%20%24%20A_%7Bij%7D%20%3D%201%20%24%20means%20that%20the%20string%20can%20have%20the%20%24%20i%20%24%20-th%20and%20%24%20j%20%24%20-th%20letters%20of%20Latin%20alphabet%20adjacent.%5Cn%5CnLet%27s%20call%20the%20string%20crisp%20if%20all%20of%20the%20adjacent%20characters%20in%20it%20can%20be%20adjacent%20%28have%201%20in%20the%20corresponding%20cell%20of%20matrix%20%24%20A%20%24%20%29.%5Cn%5CnYou%20are%20allowed%20to%20do%20the%20following%20move.%20Choose%20any%20letter%2C%20remove%20all%20its%20occurrences%20and%20join%20the%20remaining%20parts%20of%20the%20string%20without%20changing%20their%20order.%20For%20example%2C%20removing%20letter%20%27a%27%20from%20%5C%22abacaba%5C%22%20will%20yield%20%5C%22bcb%5C%22.%5Cn%5CnThe%20string%20you%20are%20given%20is%20crisp.%20The%20string%20should%20remain%20crisp%20after%20every%20move%20you%20make.%5Cn%5CnYou%20are%20allowed%20to%20do%20arbitrary%20number%20of%20moves%20%28possible%20zero%29.%20What%20is%20the%20shortest%20resulting%20string%20you%20can%20obtain%3F%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20two%20integers%20%24%20n%20%24%20and%20%24%20p%20%24%20%28%20%24%201%20%5C%5Cle%20n%20%5C%5Cle%2010%5E5%20%24%20%2C%20%24%201%20%5C%5Cle%20p%20%5C%5Cle%2017%20%24%20%29%20%5Cu2014%20the%20length%20of%20the%20initial%20string%20and%20the%20length%20of%20the%20allowed%20prefix%20of%20Latin%20alphabet.%5Cn%5CnThe%20second%20line%20contains%20the%20initial%20string.%20It%20is%20guaranteed%20that%20it%20contains%20only%20first%20%24%20p%20%24%20lowercase%20Latin%20letters%20and%20that%20is%20it%20crisp.%20Some%20of%20these%20%24%20p%20%24%20first%20Latin%20letters%20might%20not%20be%20present%20in%20the%20string.%5Cn%5CnEach%20of%20the%20next%20%24%20p%20%24%20lines%20contains%20%24%20p%20%24%20integer%20numbers%20%5Cu2014%20the%20matrix%20%24%20A%20%24%20%28%20%24%200%20%5C%5Cle%20A_%7Bij%7D%20%5C%5Cle%201%20%24%20%2C%20%24%20A_%7Bij%7D%20%3D%20A_%7Bji%7D%20%24%20%29.%20%24%20A_%7Bij%7D%20%3D%201%20%24%20means%20that%20the%20string%20can%20have%20the%20%24%20i%20%24%20-th%20and%20%24%20j%20%24%20-th%20letters%20of%20Latin%20alphabet%20adjacent.%22%2C%22outputFormat%22%3A%22Print%20a%20single%20integer%20%5Cu2014%20the%20length%20of%20the%20shortest%20string%20after%20you%20make%20arbitrary%20number%20of%20moves%20%28possible%20zero%29.%22%2C%22samples%22%3A%5B%5B%22%5Cn7%203%5Cnabacaba%5Cn0%201%201%5Cn1%200%200%5Cn1%200%200%5Cn%22%2C%22%5Cn7%5Cn%22%5D%2C%5B%22%5Cn7%203%5Cnabacaba%5Cn1%201%201%5Cn1%200%200%5Cn1%200%200%5Cn%22%2C%22%5Cn0%5Cn%22%5D%2C%5B%22%5Cn7%204%5Cnbacadab%5Cn0%201%201%201%5Cn1%200%200%200%5Cn1%200%200%200%5Cn1%200%200%200%5Cn%22%2C%22%5Cn5%5Cn%22%5D%2C%5B%22%5Cn3%203%5Cncbc%5Cn0%200%200%5Cn0%200%201%5Cn0%201%200%5Cn%22%2C%22%5Cn0%5Cn%22%5D%5D%2C%22hint%22%3A%22In%20the%20first%20example%20no%20letter%20can%20be%20removed%20from%20the%20initial%20string.%5Cn%5CnIn%20the%20second%20example%20you%20can%20remove%20letters%20in%20order%3A%20%27b%27%2C%20%27c%27%2C%20%27a%27.%20The%20strings%20on%20the%20intermediate%20steps%20will%20be%3A%20%5C%22abacaba%5C%22%20%24%20%5C%5Crightarrow%20%24%20%5C%22aacaa%5C%22%20%24%20%5C%5Crightarrow%20%24%20%5C%22aaaa%5C%22%20%24%20%5C%5Crightarrow%20%24%20%5C%22%5C%22.%5Cn%5CnIn%20the%20third%20example%20you%20can%20remove%20letter%20%27b%27%20and%20that%27s%20it.%5Cn%5CnIn%20the%20fourth%20example%20you%20can%20remove%20letters%20in%20order%20%27c%27%2C%20%27b%27%2C%20but%20not%20in%20the%20order%20%27b%27%2C%20%27c%27%20because%20two%20letters%20%27c%27%20can%27t%20be%20adjacent.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F1117%5C%2FF%22%2C%22id%22%3A%221117F%22%7D%2C%22translation%22%3A%22%2A%2A%5Cu9898%5Cu610f%2A%2A%5Cr%5Cn%5Cr%5Cn%5Cu7ed9%5Cu4e00%5Cu4e2a%5Cu7531%5Cu524d%24p%24%5Cuff08%24p%3C%3D17%24%5Cuff09%5Cu4e2a%5Cu5c0f%5Cu5199%5Cu5b57%5Cu6bcd%5Cu6784%5Cu6210%5Cu7684%5Cu957f%5Cu5ea6%5Cu4e3a%24n%24%5Cuff08%24n%3C%3D100000%24%5Cuff09%5Cu7684%5Cu5b57%5Cu7b26%5Cu4e32%5Cuff0c%5Cu518d%5Cu7ed9%5Cu4e00%5Cu4e2a%24p%5Cu00d7p%24%5Cu7684%5Cu90bb%5Cu63a5%5Cu77e9%5Cu9635%24G%24%5Cuff08%5Cu4fdd%5Cu8bc1%24G_%7Bij%7D%3DG_%7Bji%7D%24%5Cuff09%5Cuff0c%5Cu82e5%5Cu4e00%5Cu4e2a%5Cu5b57%5Cu7b26%5Cu4e32%5Cu7684%5Cu6240%5Cu6709%5Cu76f8%5Cu90bb%5Cu7684%5Cu5b57%5Cu7b26%24i%24%5Cu548c%24j%24%5Cuff08%5Cu8fd9%5Cu91cc%5Cu662f%5Cu6307%5Cu4ece%24a%24%5Cu5f00%5Cu59cb%5Cu7b2c%24i%24%5Cu548c%5Cu7b2c%24j%24%5Cu4e2a%5Cu5b57%5Cu6bcd%5Cuff09%5Cu6ee1%5Cu8db3%24G_%7Bij%7D%3D1%24%5Cuff0c%5Cu90a3%5Cu4e48%5Cu79f0%5Cu8fd9%5Cu4e2a%5Cu5b57%5Cu7b26%5Cu4e32%5Cu662f%5Cu201c%5Cu597d%5Cu7684%5Cu201d%5Cuff08%5Cu7a7a%5Cu4e32%5Cu4e5f%5Cu662f%5Cu597d%5Cu7684%5Cuff09%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu4f60%5Cu6bcf%5Cu6b21%5Cu80fd%5Cu591f%5Cu9009%5Cu62e9%5Cu4e00%5Cu79cd%5Cu5b57%5Cu7b26%5Cu5e76%5Cu628a%5Cu5f53%5Cu524d%5Cu4e32%5Cu5185%5Cu6240%5Cu6709%5Cu8fd9%5Cu4e2a%5Cu5b57%5Cu7b26%5Cu5220%5Cu53bb%5Cuff0c%5Cu4f46%5Cu64cd%5Cu4f5c%5Cu540e%5Cu7684%5Cu5b57%5Cu7b26%5Cu4e32%5Cu5fc5%5Cu987b%5Cu8fd8%5Cu662f%5Cu597d%5Cu7684%5Cu3002%5Cu95ee%5Cu6700%5Cu7ec8%5Cu80fd%5Cu591f%5Cu5f97%5Cu5230%5Cu7684%5Cu5b57%5Cu7b26%5Cu4e32%5Cu7684%5Cu6700%5Cu5c0f%5Cu957f%5Cu5ea6%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu4fdd%5Cu8bc1%5Cu4e00%5Cu5f00%5Cu59cb%5Cu7684%5Cu4e32%5Cu662f%5Cu597d%5Cu7684%5Cu3002%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A9%2C%22totalAccepted%22%3A6%2C%22pid%22%3A%22CF1117F%22%2C%22title%22%3A%22Crisp%20String%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Crisp%20String%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Crisp String</h1>
<h2>题意翻译</h2>
<div>**题意**
给一个由前$p$（$p<=17$）个小写字母构成的长度为$n$（$n<=100000$）的字符串，再给一个$p×p$的邻接矩阵$G$（保证$G_{ij}=G_{ji}$），若一个字符串的所有相邻的字符$i$和$j$（这里是指从$a$开始第$i$和第$j$个字母）满足$G_{ij}=1$，那么称这个字符串是“好的”（空串也是好的）。
你每次能够选择一种字符并把当前串内所有这个字符删去，但操作后的字符串必须还是好的。问最终能够得到的字符串的最小长度。
保证一开始的串是好的。</div>
<h2>题目描述</h2>
<div>You are given a string of length $ n $ . Each character is one of the first $ p $ lowercase Latin letters.
You are also given a matrix $ A $ with binary values of size $ p \times p $ . This matrix is symmetric ( $ A_{ij} = A_{ji} $ ). $ A_{ij} = 1 $ means that the string can have the $ i $ -th and $ j $ -th letters of Latin alphabet adjacent.
Let's call the string crisp if all of the adjacent characters in it can be adjacent (have 1 in the corresponding cell of matrix $ A $ ).
You are allowed to do the following move. Choose any letter, remove all its occurrences and join the remaining parts of the string without changing their order. For example, removing letter 'a' from "abacaba" will yield "bcb".
The string you are given is crisp. The string should remain crisp after every move you make.
You are allowed to do arbitrary number of moves (possible zero). What is the shortest resulting string you can obtain?</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains two integers $ n $ and $ p $ ( $ 1 \le n \le 10^5 $ , $ 1 \le p \le 17 $ ) — the length of the initial string and the length of the allowed prefix of Latin alphabet.
The second line contains the initial string. It is guaranteed that it contains only first $ p $ lowercase Latin letters and that is it crisp. Some of these $ p $ first Latin letters might not be present in the string.
Each of the next $ p $ lines contains $ p $ integer numbers — the matrix $ A $ ( $ 0 \le A_{ij} \le 1 $ , $ A_{ij} = A_{ji} $ ). $ A_{ij} = 1 $ means that the string can have the $ i $ -th and $ j $ -th letters of Latin alphabet adjacent.</div>
<h3>输出格式</h3>
<br />
<div>Print a single integer — the length of the shortest string after you make arbitrary number of moves (possible zero).</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>
7 3
abacaba
0 1 1
1 0 0
1 0 0
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>
7
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>
7 3
abacaba
1 1 1
1 0 0
1 0 0
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>
0
</code></pre>
<h3>输入样例 #3</h3>
<pre><code>
7 4
bacadab
0 1 1 1
1 0 0 0
1 0 0 0
1 0 0 0
</code></pre>
<h3>输出样例 #3</h3>
<pre><code>
5
</code></pre>
<h3>输入样例 #4</h3>
<pre><code>
3 3
cbc
0 0 0
0 0 1
0 1 0
</code></pre>
<h3>输出样例 #4</h3>
<pre><code>
0
</code></pre>
<h2>说明</h2>
<div>In the first example no letter can be removed from the initial string.
In the second example you can remove letters in order: 'b', 'c', 'a'. The strings on the intermediate steps will be: "abacaba" $ \rightarrow $ "aacaa" $ \rightarrow $ "aaaa" $ \rightarrow $ "".
In the third example you can remove letter 'b' and that's it.
In the fourth example you can remove letters in order 'c', 'b', but not in the order 'b', 'c' because two letters 'c' can't be adjacent.</div>
</article>
</div>
</div>
</body>
</html>
