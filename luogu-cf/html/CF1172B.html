<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Nauuo and Circle - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573402558:uffrsMvifCh9pUD64LaZWSLsd/U63hQ8MfPOGZxEoAI=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Nauuo%20is%20a%20girl%20who%20loves%20drawing%20circles.%5Cn%5CnOne%20day%20she%20has%20drawn%20a%20circle%20and%20wanted%20to%20draw%20a%20tree%20on%20it.%5Cn%5CnThe%20tree%20is%20a%20connected%20undirected%20graph%20consisting%20of%20%24%20n%20%24%20nodes%20and%20%24%20n-1%20%24%20edges.%20The%20nodes%20are%20numbered%20from%20%24%201%20%24%20to%20%24%20n%20%24%20.%5Cn%5CnNauuo%20wants%20to%20draw%20a%20tree%20on%20the%20circle%2C%20the%20nodes%20of%20the%20tree%20should%20be%20in%20%24%20n%20%24%20distinct%20points%20on%20the%20circle%2C%20and%20the%20edges%20should%20be%20straight%20without%20crossing%20each%20other.%5Cn%5Cn%5C%22Without%20crossing%20each%20other%5C%22%20means%20that%20every%20two%20edges%20have%20no%20common%20point%20or%20the%20only%20common%20point%20is%20an%20endpoint%20of%20both%20edges.%5Cn%5CnNauuo%20wants%20to%20draw%20the%20tree%20using%20a%20permutation%20of%20%24%20n%20%24%20elements.%20A%20permutation%20of%20%24%20n%20%24%20elements%20is%20a%20sequence%20of%20integers%20%24%20p_1%2Cp_2%2C%5C%5Cldots%2Cp_n%20%24%20in%20which%20every%20integer%20from%20%24%201%20%24%20to%20%24%20n%20%24%20appears%20exactly%20once.%5Cn%5CnAfter%20a%20permutation%20is%20chosen%20Nauuo%20draws%20the%20%24%20i%20%24%20-th%20node%20in%20the%20%24%20p_i%20%24%20-th%20point%20on%20the%20circle%2C%20then%20draws%20the%20edges%20connecting%20the%20nodes.%5Cn%5CnThe%20tree%20is%20given%2C%20Nauuo%20wants%20to%20know%20how%20many%20permutations%20are%20there%20so%20that%20the%20tree%20drawn%20satisfies%20the%20rule%20%28the%20edges%20are%20straight%20without%20crossing%20each%20other%29.%20She%20only%20wants%20to%20know%20the%20answer%20modulo%20%24%20998244353%20%24%20%2C%20can%20you%20help%20her%3F%5Cn%5CnIt%20is%20obvious%20that%20whether%20a%20permutation%20is%20valid%20or%20not%20does%20not%20depend%20on%20which%20%24%20n%20%24%20points%20on%20the%20circle%20are%20chosen.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20a%20single%20integer%20%24%20n%20%24%20%28%20%24%202%5C%5Cle%20n%5C%5Cle%202%5C%5Ccdot%2010%5E5%20%24%20%29%20%5Cu2014%20the%20number%20of%20nodes%20in%20the%20tree.%5Cn%5CnEach%20of%20the%20next%20%24%20n-1%20%24%20lines%20contains%20two%20integers%20%24%20u%20%24%20and%20%24%20v%20%24%20%28%20%24%201%5C%5Cle%20u%2Cv%5C%5Cle%20n%20%24%20%29%2C%20denoting%20there%20is%20an%20edge%20between%20%24%20u%20%24%20and%20%24%20v%20%24%20.%5Cn%5CnIt%20is%20guaranteed%20that%20the%20given%20edges%20form%20a%20tree.%22%2C%22outputFormat%22%3A%22The%20output%20contains%20a%20single%20integer%20%5Cu2014%20the%20number%20of%20permutations%20suitable%20to%20draw%20the%20given%20tree%20on%20a%20circle%20satisfying%20the%20rule%2C%20modulo%20%24%20998244353%20%24%20.%22%2C%22samples%22%3A%5B%5B%22%5Cn4%5Cn1%202%5Cn1%203%5Cn2%204%5Cn%22%2C%22%5Cn16%22%5D%2C%5B%22%5Cn4%5Cn1%202%5Cn1%203%5Cn1%204%5Cn%22%2C%22%5Cn24%22%5D%5D%2C%22hint%22%3A%22Example%201%5Cn%5CnAll%20valid%20permutations%20and%20their%20spanning%20trees%20are%20as%20follows.%5Cn%5Cn%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF1172B%5C%2F25ee321eec5c118e8098a8f3a592f1369d970aef.png%29%5Cn%5CnHere%20is%20an%20example%20of%20invalid%20permutation%3A%20the%20edges%20%24%20%281%2C3%29%20%24%20and%20%24%20%282%2C4%29%20%24%20are%20crossed.%5Cn%5Cn%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF1172B%5C%2F4cf3287ea7f8a1a7304d82d6bac221dccc155245.png%29%5Cn%5CnExample%202%5Cn%5CnEvery%20permutation%20leads%20to%20a%20valid%20tree%2C%20so%20the%20answer%20is%20%24%204%21%20%3D%2024%20%24%20.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F1172%5C%2FB%22%2C%22id%22%3A%221172B%22%7D%2C%22translation%22%3A%22%5Cu7ed9%5Cu5b9a%5Cu4e00%5Cu5706%5Cuff0c%5Cu4e0a%5Cu6709n%5Cu4e2a%5Cu8282%5Cu70b9%5Cuff08%5Cu4e0d%5Cu91cd%5Cu5408%5Cuff0c%5Cu4ece1%5Cu5230n%5Cu7f16%5Cu53f7%5Cuff09%5Cu3002%5Cu5b83%5Cu4eec%5Cu6309%5Cu7167%5Cu8f93%5Cu5165%5Cu8fde%5Cu6210%5Cu4e00%5Cu68f5%5Cu6811%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu6c42%5Cu5408%5Cu6cd5%5Cu6811%5Cu7684%5Cu65b9%5Cu6848%5Cu603b%5Cu6570%5Cuff0c%5Cu5bf9998244353%5Cu53d6%5Cu6a21%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu4e00%5Cu68f5%5Cu6811%5Cu662f%5Cu5408%5Cu6cd5%5Cu7684%5Cuff0c%5Cu5f53%5Cu4e14%5Cu4ec5%5Cu5f53%5Cu8fd9%5Cu68f5%5Cu6811%5Cu4e2d%5Cu65e0%5Cu4ea4%5Cu53c9%5Cu7684%5Cu8fb9%5Cuff08%5Cu4e24%5Cu8fb9%5Cu5171%5Cu7528%5Cu4e00%5Cu7aef%5Cu70b9%5Cu9664%5Cu5916%5Cuff09%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu6ce8%5Cu610f%5Cuff1a%5Cu53ea%5Cu8981%5Cu4ece%20%2A%2A%5Cu6700%5Cu4e0a%5Cu9762%5Cu7aef%5Cu70b9%28%5Cu4e0d%5Cu4e00%5Cu5b9a%5Cu5bf9%5Cu4e8e%5Cu6bcf%5Cu4e2a%5Cu90fd%5Cu662f1%5Cuff0c%5Cu89c1%5Cu6837%5Cu4f8b1%5Cu89e3%5Cu91ca3%265%29%2A%2A%20%5Cu987a%5Cu65f6%5Cu9488%5Cu6cbf%5Cu5706%5Cu904d%5Cu5386%5Cu6240%5Cu6709%5Cu8282%5Cu70b9%5Cu5f97%5Cu5230%5Cu7684%5Cu5e8f%5Cu5217%5Cu4e0d%5Cu540c%5Cuff0c%5Cu90a3%5Cu4e48%5Cu4e24%5Cu79cd%5Cu65b9%5Cu6848%5Cu5c31%5Cu662f%5Cu4e0d%5Cu540c%5Cu7684%5Cuff0c%5Cu5373%5Cu4f7f%5Cu5b83%5Cu4eec%5Cu672c%5Cu8d28%5Cu76f8%5Cu540c%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu8f93%5Cu5165%5Cu683c%5Cu5f0f%5Cuff1a%5Cu7b2c%5Cu4e00%5Cu884cn%5Cuff0c%5Cu540e%5Cuff08n-1%5Cuff09%5Cu884c%5Cu4e3a%5Cu88ab%5Cu8fde%5Cu63a5%5Cu7684%5Cu8fb9%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu8f93%5Cu51fa%5Cu683c%5Cu5f0f%5Cuff1a%5Cu5408%5Cu6cd5%5Cu6811%5Cu7684%5Cu65b9%5Cu6848%5Cu603b%5Cu6570%5Cu3002%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A177%2C%22totalAccepted%22%3A131%2C%22pid%22%3A%22CF1172B%22%2C%22title%22%3A%22Nauuo%20and%20Circle%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22CF300E%22%2C%22title%22%3A%22Empire%20Strikes%20Back%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1175E%22%2C%22title%22%3A%22Minimal%20Segment%20Cover%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1172D%22%2C%22title%22%3A%22Nauuo%20and%20Portals%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1172A%22%2C%22title%22%3A%22Nauuo%20and%20Cards%22%2C%22difficulty%22%3A4%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1220D%22%2C%22title%22%3A%22Alex%20and%20Julian%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Nauuo%20and%20Circle%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Nauuo and Circle</h1>
<h2>题意翻译</h2>
<div>给定一圆，上有n个节点（不重合，从1到n编号）。它们按照输入连成一棵树。
求合法树的方案总数，对998244353取模。
一棵树是合法的，当且仅当这棵树中无交叉的边（两边共用一端点除外）。
注意：只要从 **最上面端点(不一定对于每个都是1，见样例1解释3&5)** 顺时针沿圆遍历所有节点得到的序列不同，那么两种方案就是不同的，即使它们本质相同。
输入格式：第一行n，后（n-1）行为被连接的边。
输出格式：合法树的方案总数。</div>
<h2>题目描述</h2>
<div>Nauuo is a girl who loves drawing circles.
One day she has drawn a circle and wanted to draw a tree on it.
The tree is a connected undirected graph consisting of $ n $ nodes and $ n-1 $ edges. The nodes are numbered from $ 1 $ to $ n $ .
Nauuo wants to draw a tree on the circle, the nodes of the tree should be in $ n $ distinct points on the circle, and the edges should be straight without crossing each other.
"Without crossing each other" means that every two edges have no common point or the only common point is an endpoint of both edges.
Nauuo wants to draw the tree using a permutation of $ n $ elements. A permutation of $ n $ elements is a sequence of integers $ p_1,p_2,\ldots,p_n $ in which every integer from $ 1 $ to $ n $ appears exactly once.
After a permutation is chosen Nauuo draws the $ i $ -th node in the $ p_i $ -th point on the circle, then draws the edges connecting the nodes.
The tree is given, Nauuo wants to know how many permutations are there so that the tree drawn satisfies the rule (the edges are straight without crossing each other). She only wants to know the answer modulo $ 998244353 $ , can you help her?
It is obvious that whether a permutation is valid or not does not depend on which $ n $ points on the circle are chosen.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains a single integer $ n $ ( $ 2\le n\le 2\cdot 10^5 $ ) — the number of nodes in the tree.
Each of the next $ n-1 $ lines contains two integers $ u $ and $ v $ ( $ 1\le u,v\le n $ ), denoting there is an edge between $ u $ and $ v $ .
It is guaranteed that the given edges form a tree.</div>
<h3>输出格式</h3>
<br />
<div>The output contains a single integer — the number of permutations suitable to draw the given tree on a circle satisfying the rule, modulo $ 998244353 $ .</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>
4
1 2
1 3
2 4
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>
16</code></pre>
<h3>输入样例 #2</h3>
<pre><code>
4
1 2
1 3
1 4
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>
24</code></pre>
<h2>说明</h2>
<div>Example 1
All valid permutations and their spanning trees are as follows.
![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1172B/25ee321eec5c118e8098a8f3a592f1369d970aef.png)
Here is an example of invalid permutation: the edges $ (1,3) $ and $ (2,4) $ are crossed.
![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1172B/4cf3287ea7f8a1a7304d82d6bac221dccc155245.png)
Example 2
Every permutation leads to a valid tree, so the answer is $ 4! = 24 $ .</div>
</article>
</div>
</div>
</body>
</html>
