<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Make It Connected - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573401547:+/bFdeBsrL28edXYtH4DaoXBnoO7pBL6rln8QattMhM=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22You%20are%20given%20an%20undirected%20graph%20consisting%20of%20%24%20n%20%24%20vertices.%20A%20number%20is%20written%20on%20each%20vertex%3B%20the%20number%20on%20vertex%20%24%20i%20%24%20is%20%24%20a_i%20%24%20.%20Initially%20there%20are%20no%20edges%20in%20the%20graph.%5Cn%5CnYou%20may%20add%20some%20edges%20to%20this%20graph%2C%20but%20you%20have%20to%20pay%20for%20them.%20The%20cost%20of%20adding%20an%20edge%20between%20vertices%20%24%20x%20%24%20and%20%24%20y%20%24%20is%20%24%20a_x%20%2B%20a_y%20%24%20coins.%20There%20are%20also%20%24%20m%20%24%20special%20offers%2C%20each%20of%20them%20is%20denoted%20by%20three%20numbers%20%24%20x%20%24%20%2C%20%24%20y%20%24%20and%20%24%20w%20%24%20%2C%20and%20means%20that%20you%20can%20add%20an%20edge%20connecting%20vertices%20%24%20x%20%24%20and%20%24%20y%20%24%20and%20pay%20%24%20w%20%24%20coins%20for%20it.%20You%20don%27t%20have%20to%20use%20special%20offers%3A%20if%20there%20is%20a%20pair%20of%20vertices%20%24%20x%20%24%20and%20%24%20y%20%24%20that%20has%20a%20special%20offer%20associated%20with%20it%2C%20you%20still%20may%20connect%20these%20two%20vertices%20paying%20%24%20a_x%20%2B%20a_y%20%24%20coins%20for%20it.%5Cn%5CnWhat%20is%20the%20minimum%20number%20of%20coins%20you%20have%20to%20spend%20to%20make%20the%20graph%20connected%3F%20Recall%20that%20a%20graph%20is%20connected%20if%20it%27s%20possible%20to%20get%20from%20any%20vertex%20to%20any%20other%20vertex%20using%20only%20the%20edges%20belonging%20to%20this%20graph.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20two%20integers%20%24%20n%20%24%20and%20%24%20m%20%24%20%28%20%24%201%20%5C%5Cle%20n%20%5C%5Cle%202%20%5C%5Ccdot%2010%5E5%20%24%20%2C%20%24%200%20%5C%5Cle%20m%20%5C%5Cle%202%20%5C%5Ccdot%2010%5E5%20%24%20%29%20%5Cu2014%20the%20number%20of%20vertices%20in%20the%20graph%20and%20the%20number%20of%20special%20offers%2C%20respectively.%5Cn%5CnThe%20second%20line%20contains%20%24%20n%20%24%20integers%20%24%20a_1%2C%20a_2%2C%20%5C%5Cdots%2C%20a_n%20%24%20%28%20%24%201%20%5C%5Cle%20a_i%20%5C%5Cle%2010%5E%7B12%7D%20%24%20%29%20%5Cu2014%20the%20numbers%20written%20on%20the%20vertices.%5Cn%5CnThen%20%24%20m%20%24%20lines%20follow%2C%20each%20containing%20three%20integers%20%24%20x%20%24%20%2C%20%24%20y%20%24%20and%20%24%20w%20%24%20%28%20%24%201%20%5C%5Cle%20x%2C%20y%20%5C%5Cle%20n%20%24%20%2C%20%24%201%20%5C%5Cle%20w%20%5C%5Cle%2010%5E%7B12%7D%20%24%20%2C%20%24%20x%20%5C%5Cne%20y%20%24%20%29%20denoting%20a%20special%20offer%3A%20you%20may%20add%20an%20edge%20connecting%20vertex%20%24%20x%20%24%20and%20vertex%20%24%20y%20%24%20%2C%20and%20this%20edge%20will%20cost%20%24%20w%20%24%20coins.%22%2C%22outputFormat%22%3A%22Print%20one%20integer%20%5Cu2014%20the%20minimum%20number%20of%20coins%20you%20have%20to%20pay%20to%20make%20the%20graph%20connected.%22%2C%22samples%22%3A%5B%5B%22%5Cn3%202%5Cn1%203%203%5Cn2%203%205%5Cn2%201%201%5Cn%22%2C%22%5Cn5%5Cn%22%5D%2C%5B%22%5Cn4%200%5Cn1%203%203%207%5Cn%22%2C%22%5Cn16%5Cn%22%5D%2C%5B%22%5Cn5%204%5Cn1%202%203%204%205%5Cn1%202%208%5Cn1%203%2010%5Cn1%204%207%5Cn1%205%2015%5Cn%22%2C%22%5Cn18%5Cn%22%5D%5D%2C%22hint%22%3A%22In%20the%20first%20example%20it%20is%20possible%20to%20connect%20%24%201%20%24%20to%20%24%202%20%24%20using%20special%20offer%20%24%202%20%24%20%2C%20and%20then%20%24%201%20%24%20to%20%24%203%20%24%20without%20using%20any%20offers.%5Cn%5CnIn%20next%20two%20examples%20the%20optimal%20answer%20may%20be%20achieved%20without%20using%20special%20offers.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F1095%5C%2FF%22%2C%22id%22%3A%221095F%22%7D%2C%22translation%22%3A%22%5Cu7ed9%5Cu4f60n%5Cu4e2a%5Cu70b9%2C%5Cu6bcf%5Cu4e2a%5Cu70b9%5Cu6709%5Cu4e00%5Cu4e2a%5Cu6743%5Cu503c%24a_i%24%2C%5Cu5df2%5Cu77e5%5Cu8fde%5Cu63a5%5Cu4e24%5Cu70b9%5Cu7684%5Cu4ee3%5Cu4ef7%5Cu4e3a%24a_i%2Ba_j%24%2C%5Cu73b0%5Cu5728%5Cu8fd8%5Cu6709%5Cu5176%5Cu4ed6%5Cu7684m%5Cu79cd%5Cu8fde%5Cu63a5%5Cu65b9%5Cu6cd5%2C%5Cu8fde%5Cu63a5%24u%2Cv%24%5Cu7684%5Cu8d39%5Cu7528%5Cu4e3a%24w%24.%5Cr%5Cn%5Cu6c42%5Cu51fa%5Cu8ba9%5Cu8fd9%5Cu4e2a%5Cu56fe%5Cu8fde%5Cu901a%5Cu7684%5Cu6700%5Cu5c0f%5Cu4ee3%5Cu4ef7.%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A131%2C%22totalAccepted%22%3A70%2C%22pid%22%3A%22CF1095F%22%2C%22title%22%3A%22Make%20It%20Connected%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22CF702F%22%2C%22title%22%3A%22T-Shirts%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF547E%22%2C%22title%22%3A%22Mike%20and%20Friends%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1095E%22%2C%22title%22%3A%22Almost%20Regular%20Bracket%20Sequence%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1095D%22%2C%22title%22%3A%22Circular%20Dance%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1096D%22%2C%22title%22%3A%22Easy%20Problem%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22CF%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Make%20It%20Connected%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Make It Connected</h1>
<h2>题意翻译</h2>
<div>给你n个点,每个点有一个权值$a_i$,已知连接两点的代价为$a_i+a_j$,现在还有其他的m种连接方法,连接$u,v$的费用为$w$.
求出让这个图连通的最小代价.</div>
<h2>题目描述</h2>
<div>You are given an undirected graph consisting of $ n $ vertices. A number is written on each vertex; the number on vertex $ i $ is $ a_i $ . Initially there are no edges in the graph.
You may add some edges to this graph, but you have to pay for them. The cost of adding an edge between vertices $ x $ and $ y $ is $ a_x + a_y $ coins. There are also $ m $ special offers, each of them is denoted by three numbers $ x $ , $ y $ and $ w $ , and means that you can add an edge connecting vertices $ x $ and $ y $ and pay $ w $ coins for it. You don't have to use special offers: if there is a pair of vertices $ x $ and $ y $ that has a special offer associated with it, you still may connect these two vertices paying $ a_x + a_y $ coins for it.
What is the minimum number of coins you have to spend to make the graph connected? Recall that a graph is connected if it's possible to get from any vertex to any other vertex using only the edges belonging to this graph.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains two integers $ n $ and $ m $ ( $ 1 \le n \le 2 \cdot 10^5 $ , $ 0 \le m \le 2 \cdot 10^5 $ ) — the number of vertices in the graph and the number of special offers, respectively.
The second line contains $ n $ integers $ a_1, a_2, \dots, a_n $ ( $ 1 \le a_i \le 10^{12} $ ) — the numbers written on the vertices.
Then $ m $ lines follow, each containing three integers $ x $ , $ y $ and $ w $ ( $ 1 \le x, y \le n $ , $ 1 \le w \le 10^{12} $ , $ x \ne y $ ) denoting a special offer: you may add an edge connecting vertex $ x $ and vertex $ y $ , and this edge will cost $ w $ coins.</div>
<h3>输出格式</h3>
<br />
<div>Print one integer — the minimum number of coins you have to pay to make the graph connected.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>
3 2
1 3 3
2 3 5
2 1 1
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>
5
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>
4 0
1 3 3 7
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>
16
</code></pre>
<h3>输入样例 #3</h3>
<pre><code>
5 4
1 2 3 4 5
1 2 8
1 3 10
1 4 7
1 5 15
</code></pre>
<h3>输出样例 #3</h3>
<pre><code>
18
</code></pre>
<h2>说明</h2>
<div>In the first example it is possible to connect $ 1 $ to $ 2 $ using special offer $ 2 $ , and then $ 1 $ to $ 3 $ without using any offers.
In next two examples the optimal answer may be achieved without using special offers.</div>
</article>
</div>
</div>
</body>
</html>
