<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Road Construction - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573403844:Q9j4BhtS8causoNyuopybN2Gd6Gvtt7uYqFGAEu3lTA=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22There%20are%20%24%20N%20%24%20cities%20in%20the%20country%20of%20Numbata%2C%20numbered%20from%20%24%201%20%24%20to%20%24%20N%20%24%20.%20Currently%2C%20there%20is%20no%20road%20connecting%20them.%20Therefore%2C%20each%20of%20these%20%24%20N%20%24%20cities%20proposes%20a%20road%20candidate%20to%20be%20constructed.%5Cn%5CnCity%20%24%20i%20%24%20likes%20to%20connect%20with%20city%20%24%20A_i%20%24%20%2C%20so%20city%20%24%20i%20%24%20proposes%20to%20add%20a%20direct%20bidirectional%20road%20connecting%20city%20%24%20i%20%24%20and%20city%20%24%20A_i%20%24%20.%20It%20is%20guaranteed%20that%20no%20two%20cities%20like%20to%20connect%20with%20each%20other.%20In%20other%20words%2C%20there%20is%20no%20pair%20of%20integers%20%24%20i%20%24%20and%20%24%20j%20%24%20where%20%24%20A_i%20%3D%20j%20%24%20and%20%24%20A_j%20%3D%20i%20%24%20.%20It%20is%20also%20guaranteed%20that%20any%20pair%20of%20cities%20are%20connected%20by%20a%20sequence%20of%20road%20proposals.%20In%20other%20words%2C%20if%20all%20proposed%20roads%20are%20constructed%2C%20then%20any%20pair%20of%20cities%20are%20connected%20by%20a%20sequence%20of%20constructed%20road.%5Cn%5CnCity%20%24%20i%20%24%20also%20prefers%20the%20road%20to%20be%20constructed%20using%20a%20specific%20material.%20Each%20material%20can%20be%20represented%20by%20an%20integer%20%28for%20example%2C%20%24%200%20%24%20for%20asphalt%2C%20%24%201%20%24%20for%20wood%2C%20etc.%29.%20The%20material%20that%20can%20be%20used%20for%20the%20road%20connecting%20city%20%24%20i%20%24%20and%20city%20%24%20A_i%20%24%20is%20represented%20by%20an%20array%20%24%20B_i%20%24%20containing%20%24%20M_i%20%24%20integers%3A%20%24%20%5B%28B_i%29_1%2C%20%28B_i%29_2%2C%20%5C%5Cdots%2C%20%28B_i%29_%7BM_i%7D%5D%20%24%20.%20This%20means%20that%20the%20road%20connecting%20city%20%24%20i%20%24%20and%20city%20%24%20A_i%20%24%20can%20be%20constructed%20with%20either%20of%20the%20material%20in%20%24%20B_i%20%24%20.%5Cn%5CnThere%20are%20%24%20K%20%24%20workers%20to%20construct%20the%20roads.%20Each%20worker%20is%20only%20familiar%20with%20one%20material%2C%20thus%20can%20only%20construct%20a%20road%20with%20a%20specific%20material.%20In%20particular%2C%20the%20%24%20i%5E%7Bth%7D%20%24%20worker%20can%20only%20construct%20a%20road%20with%20material%20%24%20C_i%20%24%20.%20Each%20worker%20can%20only%20construct%20at%20most%20one%20road.%20You%20want%20to%20assign%20each%20worker%20to%20construct%20a%20road%20such%20that%20any%20pair%20of%20cities%20are%20connected%20by%20a%20sequence%20of%20constructed%20road.%22%2C%22inputFormat%22%3A%22Input%20begins%20with%20a%20line%20containing%20two%20integers%3A%20%24%20N%20%24%20%24%20K%20%24%20%28%20%24%203%20%5C%5Cle%20N%20%5C%5Cle%202000%20%24%20%3B%20%24%201%20%5C%5Cle%20K%20%5C%5Cle%202000%20%24%20%29%20representing%20the%20number%20of%20cities%20and%20the%20number%20of%20workers%2C%20respectively.%20The%20next%20%24%20N%20%24%20lines%20each%20contains%20several%20integers%3A%20%24%20A_i%20%24%20%24%20M_i%20%24%20%24%20%28B_i%29_1%20%24%20%2C%20%24%20%28B_i%29_2%20%24%20%2C%20%24%20%5C%5Ccdots%20%24%20%2C%20%24%20%28B_i%29_%7BM_i%7D%20%24%20%28%20%24%201%20%5C%5Cle%20A_i%20%5C%5Cle%20N%20%24%20%3B%20%24%20A_i%20%5C%5Cne%20i%20%24%20%3B%20%24%201%20%5C%5Cle%20M_i%20%5C%5Cle%2010%5C%5C%2C000%20%24%20%3B%20%24%200%20%5C%5Cle%20%28B_i%29_1%20%3C%20%28B_i%29_2%20%3C%20%5C%5Cdots%20%3C%20%28B_i%29_%7BM_i%7D%20%5C%5Cle%2010%5E9%20%24%20%29%20representing%20the%20bidirectional%20road%20that%20city%20%24%20i%20%24%20likes%20to%20construct.%20It%20is%20guaranteed%20that%20the%20sum%20of%20%24%20M_i%20%24%20does%20not%20exceed%20%24%2010%5C%5C%2C000%20%24%20.%20It%20is%20also%20guaranteed%20that%20no%20two%20cities%20like%20to%20connect%20with%20each%20other%20and%20any%20pair%20of%20cities%20are%20connected%20by%20a%20sequence%20of%20road%20proposals.%20The%20next%20line%20contains%20%24%20K%20%24%20integers%3A%20%24%20C_i%20%24%20%28%20%24%200%20%5C%5Cle%20C_i%20%5C%5Cle%2010%5E9%20%24%20%29%20representing%20the%20material%20that%20is%20familiarized%20by%20the%20workers.%22%2C%22outputFormat%22%3A%22If%20it%20is%20not%20possible%20to%20assign%20each%20worker%20to%20construct%20a%20road%20such%20that%20any%20pair%20of%20cities%20are%20connected%20by%20a%20sequence%20of%20constructed%20road%2C%20simply%20output%20-1%20in%20a%20line.%20Otherwise%2C%20for%20each%20worker%20in%20the%20same%20order%20as%20input%2C%20output%20in%20a%20line%20two%20integers%20%28separated%20by%20a%20single%20space%29%3A%20%24%20u%20%24%20and%20%24%20v%20%24%20in%20any%20order.%20This%20means%20that%20the%20worker%20constructs%20a%20direct%20bidirectional%20road%20connecting%20city%20%24%20u%20%24%20and%20%24%20v%20%24%20.%20If%20the%20worker%20does%20not%20construct%20any%20road%2C%20output%20%5C%220%200%5C%22%20%28without%20quotes%29%20instead.%20Each%20pair%20of%20cities%20can%20only%20be%20assigned%20to%20at%20most%20one%20worker.%20You%20may%20output%20any%20assignment%20as%20long%20as%20any%20pair%20of%20cities%20are%20connected%20by%20a%20sequence%20of%20constructed%20road.%22%2C%22samples%22%3A%5B%5B%22%5Cn4%205%5Cn2%202%201%202%5Cn3%202%202%203%5Cn4%202%203%204%5Cn2%202%204%205%5Cn1%202%203%204%205%5Cn%22%2C%22%5Cn1%202%5Cn2%203%5Cn3%204%5Cn0%200%5Cn4%202%5Cn%22%5D%2C%5B%22%5Cn4%205%5Cn2%202%2010%2020%5Cn3%202%202%203%5Cn4%202%203%204%5Cn2%202%204%205%5Cn1%202%203%204%205%5Cn%22%2C%22%5Cn-1%5Cn%22%5D%5D%2C%22hint%22%3A%22Explanation%20for%20the%20sample%20input%5C%2Foutput%20%231%5Cn%5CnWe%20can%20assign%20the%20workers%20to%20construct%20the%20following%20roads%3A%5Cn%5Cn-%20The%20first%20worker%20constructs%20a%20road%20connecting%20city%20%24%201%20%24%20and%20city%20%24%202%20%24%20.%5Cn-%20The%20second%20worker%20constructs%20a%20road%20connecting%20city%20%24%202%20%24%20and%20city%20%24%203%20%24%20.%5Cn-%20The%20third%20worker%20constructs%20a%20road%20connecting%20city%20%24%203%20%24%20and%20city%20%24%204%20%24%20.%5Cn-%20The%20fourth%20worker%20does%20not%20construct%20any%20road.%5Cn-%20The%20fifth%20worker%20constructs%20a%20road%20connecting%20city%20%24%204%20%24%20and%20city%20%24%202%20%24%20.%5Cn%5Cn%20Therefore%2C%20any%20pair%20of%20cities%20are%20now%20connected%20by%20a%20sequence%20of%20constructed%20road.Explanation%20for%20the%20sample%20input%5C%2Foutput%20%232%5Cn%5CnThere%20is%20no%20worker%20that%20can%20construct%20a%20road%20connecting%20city%20%24%201%20%24%20%2C%20thus%20city%20%24%201%20%24%20is%20certainly%20isolated.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F1252%5C%2FL%22%2C%22id%22%3A%221252L%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A1%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22CF1252L%22%2C%22title%22%3A%22Road%20Construction%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A163372%2C%22title%22%3A%22%5Cu7f51%5Cu7edc%5Cu6d41%5Cu6c42%5Cu52a9%22%2C%22forum%22%3A%7B%22id%22%3A42208%2C%22name%22%3A%22CF1252L%20Road%20Construction%22%2C%22slug%22%3A%22CF1252L%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Road%20Construction%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Road Construction</h1>
<h2>题目描述</h2>
<div>There are $ N $ cities in the country of Numbata, numbered from $ 1 $ to $ N $ . Currently, there is no road connecting them. Therefore, each of these $ N $ cities proposes a road candidate to be constructed.
City $ i $ likes to connect with city $ A_i $ , so city $ i $ proposes to add a direct bidirectional road connecting city $ i $ and city $ A_i $ . It is guaranteed that no two cities like to connect with each other. In other words, there is no pair of integers $ i $ and $ j $ where $ A_i = j $ and $ A_j = i $ . It is also guaranteed that any pair of cities are connected by a sequence of road proposals. In other words, if all proposed roads are constructed, then any pair of cities are connected by a sequence of constructed road.
City $ i $ also prefers the road to be constructed using a specific material. Each material can be represented by an integer (for example, $ 0 $ for asphalt, $ 1 $ for wood, etc.). The material that can be used for the road connecting city $ i $ and city $ A_i $ is represented by an array $ B_i $ containing $ M_i $ integers: $ [(B_i)_1, (B_i)_2, \dots, (B_i)_{M_i}] $ . This means that the road connecting city $ i $ and city $ A_i $ can be constructed with either of the material in $ B_i $ .
There are $ K $ workers to construct the roads. Each worker is only familiar with one material, thus can only construct a road with a specific material. In particular, the $ i^{th} $ worker can only construct a road with material $ C_i $ . Each worker can only construct at most one road. You want to assign each worker to construct a road such that any pair of cities are connected by a sequence of constructed road.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>Input begins with a line containing two integers: $ N $ $ K $ ( $ 3 \le N \le 2000 $ ; $ 1 \le K \le 2000 $ ) representing the number of cities and the number of workers, respectively. The next $ N $ lines each contains several integers: $ A_i $ $ M_i $ $ (B_i)_1 $ , $ (B_i)_2 $ , $ \cdots $ , $ (B_i)_{M_i} $ ( $ 1 \le A_i \le N $ ; $ A_i \ne i $ ; $ 1 \le M_i \le 10\,000 $ ; $ 0 \le (B_i)_1 < (B_i)_2 < \dots < (B_i)_{M_i} \le 10^9 $ ) representing the bidirectional road that city $ i $ likes to construct. It is guaranteed that the sum of $ M_i $ does not exceed $ 10\,000 $ . It is also guaranteed that no two cities like to connect with each other and any pair of cities are connected by a sequence of road proposals. The next line contains $ K $ integers: $ C_i $ ( $ 0 \le C_i \le 10^9 $ ) representing the material that is familiarized by the workers.</div>
<h3>输出格式</h3>
<br />
<div>If it is not possible to assign each worker to construct a road such that any pair of cities are connected by a sequence of constructed road, simply output -1 in a line. Otherwise, for each worker in the same order as input, output in a line two integers (separated by a single space): $ u $ and $ v $ in any order. This means that the worker constructs a direct bidirectional road connecting city $ u $ and $ v $ . If the worker does not construct any road, output "0 0" (without quotes) instead. Each pair of cities can only be assigned to at most one worker. You may output any assignment as long as any pair of cities are connected by a sequence of constructed road.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>
4 5
2 2 1 2
3 2 2 3
4 2 3 4
2 2 4 5
1 2 3 4 5
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>
1 2
2 3
3 4
0 0
4 2
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>
4 5
2 2 10 20
3 2 2 3
4 2 3 4
2 2 4 5
1 2 3 4 5
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>
-1
</code></pre>
<h2>说明</h2>
<div>Explanation for the sample input/output #1
We can assign the workers to construct the following roads:
- The first worker constructs a road connecting city $ 1 $ and city $ 2 $ .
- The second worker constructs a road connecting city $ 2 $ and city $ 3 $ .
- The third worker constructs a road connecting city $ 3 $ and city $ 4 $ .
- The fourth worker does not construct any road.
- The fifth worker constructs a road connecting city $ 4 $ and city $ 2 $ .
Therefore, any pair of cities are now connected by a sequence of constructed road.Explanation for the sample input/output #2
There is no worker that can construct a road connecting city $ 1 $ , thus city $ 1 $ is certainly isolated.</div>
</article>
</div>
</div>
</body>
</html>
