<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Representative Sampling - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573391491:9jC6DE5k4gLBFNQY4CLOqlE2VRaso+qhku78P9cwHe8=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22The%20Smart%20Beaver%20from%20ABBYY%20has%20a%20long%20history%20of%20cooperating%20with%20the%20%5C%22Institute%20of%20Cytology%20and%20Genetics%5C%22.%20Recently%2C%20the%20Institute%20staff%20challenged%20the%20Beaver%20with%20a%20new%20problem.%20The%20problem%20is%20as%20follows.%5Cn%5CnThere%20is%20a%20collection%20of%20%24%20n%20%24%20proteins%20%28not%20necessarily%20distinct%29.%20Each%20protein%20is%20a%20string%20consisting%20of%20lowercase%20Latin%20letters.%20The%20problem%20that%20the%20scientists%20offered%20to%20the%20Beaver%20is%20to%20select%20a%20subcollection%20of%20size%20%24%20k%20%24%20from%20the%20initial%20collection%20of%20proteins%20so%20that%20the%20representativity%20of%20the%20selected%20subset%20of%20proteins%20is%20maximum%20possible.%5Cn%5CnThe%20Smart%20Beaver%20from%20ABBYY%20did%20some%20research%20and%20came%20to%20the%20conclusion%20that%20the%20representativity%20of%20a%20collection%20of%20proteins%20can%20be%20evaluated%20by%20a%20single%20number%2C%20which%20is%20simply%20calculated.%20Let%27s%20suppose%20we%20have%20a%20collection%20%24%20%7Ba_%7B1%7D%2C...%2Ca_%7Bk%7D%7D%20%24%20consisting%20of%20%24%20k%20%24%20strings%20describing%20proteins.%20The%20representativity%20of%20this%20collection%20is%20the%20following%20value%3A%5Cn%5Cn%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF178F3%5C%2Fc7b3873e6751582bb5e2ad2c1deb58138ab9c543.png%29where%20%24%20f%28x%2Cy%29%20%24%20is%20the%20length%20of%20the%20longest%20common%20prefix%20of%20strings%20%24%20x%20%24%20and%20%24%20y%20%24%20%3B%20for%20example%2C%20%24%20f%28%20%24%20%5C%22abc%5C%22%2C%20%5C%22abd%5C%22%20%24%20%29%3D2%20%24%20%2C%20and%20%24%20f%28%20%24%20%5C%22ab%5C%22%2C%20%5C%22bcd%5C%22%20%24%20%29%3D0%20%24%20.%5Cn%5CnThus%2C%20the%20representativity%20of%20collection%20of%20proteins%20%24%20%7B%20%24%20%5C%22abc%5C%22%2C%20%5C%22abd%5C%22%2C%20%5C%22abe%5C%22%20%24%20%7D%20%24%20equals%20%24%206%20%24%20%2C%20and%20the%20representativity%20of%20collection%20%24%20%7B%20%24%20%5C%22aaa%5C%22%2C%20%5C%22ba%5C%22%2C%20%5C%22ba%5C%22%20%24%20%7D%20%24%20equals%20%24%202%20%24%20.%5Cn%5CnHaving%20discovered%20that%2C%20the%20Smart%20Beaver%20from%20ABBYY%20asked%20the%20Cup%20contestants%20to%20write%20a%20program%20that%20selects%2C%20from%20the%20given%20collection%20of%20proteins%2C%20a%20subcollection%20of%20size%20%24%20k%20%24%20which%20has%20the%20largest%20possible%20value%20of%20representativity.%20Help%20him%20to%20solve%20this%20problem%21%22%2C%22inputFormat%22%3A%22The%20first%20input%20line%20contains%20two%20integers%20%24%20n%20%24%20and%20%24%20k%20%24%20%28%20%24%201%3C%3Dk%3C%3Dn%20%24%20%29%2C%20separated%20by%20a%20single%20space.%20The%20following%20%24%20n%20%24%20lines%20contain%20the%20descriptions%20of%20proteins%2C%20one%20per%20line.%20Each%20protein%20is%20a%20non-empty%20string%20of%20no%20more%20than%20%24%20500%20%24%20characters%20consisting%20of%20only%20lowercase%20Latin%20letters%20%28a%20%24%20...%20%24%20z%29.%20Some%20of%20the%20strings%20may%20be%20equal.%5Cn%5CnThe%20input%20limitations%20for%20getting%2020%20points%20are%3A%5Cn%5Cn-%20%24%201%3C%3Dn%3C%3D20%20%24%5Cn%5CnThe%20input%20limitations%20for%20getting%2050%20points%20are%3A%5Cn%5Cn-%20%24%201%3C%3Dn%3C%3D100%20%24%5Cn%5CnThe%20input%20limitations%20for%20getting%20100%20points%20are%3A%5Cn%5Cn-%20%24%201%3C%3Dn%3C%3D2000%20%24%22%2C%22outputFormat%22%3A%22Print%20a%20single%20number%20denoting%20the%20largest%20possible%20value%20of%20representativity%20that%20a%20subcollection%20of%20size%20%24%20k%20%24%20of%20the%20given%20collection%20of%20proteins%20can%20have.%22%2C%22samples%22%3A%5B%5B%223%202%5Cnaba%5Cnbzd%5Cnabq%5Cn%22%2C%222%5Cn%22%5D%2C%5B%224%203%5Cneee%5Cnrrr%5Cnttt%5Cnqqq%5Cn%22%2C%220%5Cn%22%5D%2C%5B%224%203%5Cnaaa%5Cnabba%5Cnabbc%5Cnabbd%5Cn%22%2C%229%5Cn%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F178%5C%2FF3%22%2C%22id%22%3A%22178F3%22%7D%2C%22translation%22%3A%22%5Cu6709%24n%24%5Cu4e2a%5Cu5b57%5Cu7b26%5Cu4e32%24a_i%24%5Cuff0c%5Cu4ece%5Cu4e2d%5Cu9009%5Cu53d6%24k%24%5Cu4e2a%5Cuff0c%5Cu4f7f%5Cu5b83%5Cu4eec%5Cu4e24%5Cu4e24%5Cu4e4b%5Cu95f4%5Cu7684%24LCP%24%5Cuff08%5Cu6700%5Cu957f%5Cu516c%5Cu5171%5Cu524d%5Cu7f00%5Cuff09%5Cu4e4b%5Cu548c%5Cu6700%5Cu5927%5Cu3002%5Cu8f93%5Cu51fa%5Cu8fd9%5Cu4e2a%5Cu6700%5Cu5927%5Cu503c%5Cu3002%5Cr%5Cn%5Cr%5Cn%24k%5C%5Cle%20n%5C%5Cle%202000%2C%7Ca_i%7C%5C%5Cle%20500%24%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A2%2C%22totalAccepted%22%3A2%2C%22pid%22%3A%22CF178F3%22%2C%22title%22%3A%22Representative%20Sampling%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Representative%20Sampling%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573286098;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Representative Sampling</h1>
<h2>题意翻译</h2>
<div>有$n$个字符串$a_i$，从中选取$k$个，使它们两两之间的$LCP$（最长公共前缀）之和最大。输出这个最大值。
$k\le n\le 2000,|a_i|\le 500$</div>
<h2>题目描述</h2>
<div>The Smart Beaver from ABBYY has a long history of cooperating with the "Institute of Cytology and Genetics". Recently, the Institute staff challenged the Beaver with a new problem. The problem is as follows.
There is a collection of $ n $ proteins (not necessarily distinct). Each protein is a string consisting of lowercase Latin letters. The problem that the scientists offered to the Beaver is to select a subcollection of size $ k $ from the initial collection of proteins so that the representativity of the selected subset of proteins is maximum possible.
The Smart Beaver from ABBYY did some research and came to the conclusion that the representativity of a collection of proteins can be evaluated by a single number, which is simply calculated. Let's suppose we have a collection $ {a_{1},...,a_{k}} $ consisting of $ k $ strings describing proteins. The representativity of this collection is the following value:
![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF178F3/c7b3873e6751582bb5e2ad2c1deb58138ab9c543.png)where $ f(x,y) $ is the length of the longest common prefix of strings $ x $ and $ y $ ; for example, $ f( $ "abc", "abd" $ )=2 $ , and $ f( $ "ab", "bcd" $ )=0 $ .
Thus, the representativity of collection of proteins $ { $ "abc", "abd", "abe" $ } $ equals $ 6 $ , and the representativity of collection $ { $ "aaa", "ba", "ba" $ } $ equals $ 2 $ .
Having discovered that, the Smart Beaver from ABBYY asked the Cup contestants to write a program that selects, from the given collection of proteins, a subcollection of size $ k $ which has the largest possible value of representativity. Help him to solve this problem!</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first input line contains two integers $ n $ and $ k $ ( $ 1<=k<=n $ ), separated by a single space. The following $ n $ lines contain the descriptions of proteins, one per line. Each protein is a non-empty string of no more than $ 500 $ characters consisting of only lowercase Latin letters (a $ ... $ z). Some of the strings may be equal.
The input limitations for getting 20 points are:
- $ 1<=n<=20 $
The input limitations for getting 50 points are:
- $ 1<=n<=100 $
The input limitations for getting 100 points are:
- $ 1<=n<=2000 $</div>
<h3>输出格式</h3>
<br />
<div>Print a single number denoting the largest possible value of representativity that a subcollection of size $ k $ of the given collection of proteins can have.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>3 2
aba
bzd
abq
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>2
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>4 3
eee
rrr
ttt
qqq
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>0
</code></pre>
<h3>输入样例 #3</h3>
<pre><code>4 3
aaa
abba
abbc
abbd
</code></pre>
<h3>输出样例 #3</h3>
<pre><code>9
</code></pre>
</article>
</div>
</div>
</body>
</html>
