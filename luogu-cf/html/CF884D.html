<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Boxes And Balls - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573399004:ZkabMOfKBnjPJ0cF1nPeCr6AWRxX9ezAiRv0FDH0Ug4=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Ivan%20has%20%24%20n%20%24%20different%20boxes.%20The%20first%20of%20them%20contains%20some%20balls%20of%20%24%20n%20%24%20different%20colors.%5Cn%5CnIvan%20wants%20to%20play%20a%20strange%20game.%20He%20wants%20to%20distribute%20the%20balls%20into%20boxes%20in%20such%20a%20way%20that%20for%20every%20%24%20i%20%24%20%28%20%24%201%3C%3Di%3C%3Dn%20%24%20%29%20%24%20i%20%24%20-th%20box%20will%20contain%20all%20balls%20with%20color%20%24%20i%20%24%20.%5Cn%5CnIn%20order%20to%20do%20this%2C%20Ivan%20will%20make%20some%20turns.%20Each%20turn%20he%20does%20the%20following%3A%5Cn%5Cn1.%20Ivan%20chooses%20any%20non-empty%20box%20and%20takes%20all%20balls%20from%20this%20box%3B%5Cn2.%20Then%20Ivan%20chooses%20any%20%24%20k%20%24%20empty%20boxes%20%28the%20box%20from%20the%20first%20step%20becomes%20empty%2C%20and%20Ivan%20is%20allowed%20to%20choose%20it%29%2C%20separates%20the%20balls%20he%20took%20on%20the%20previous%20step%20into%20%24%20k%20%24%20non-empty%20groups%20and%20puts%20each%20group%20into%20one%20of%20the%20boxes.%20He%20should%20put%20each%20group%20into%20a%20separate%20box.%20He%20can%20choose%20either%20%24%20k%3D2%20%24%20or%20%24%20k%3D3%20%24%20.%5Cn%5CnThe%20penalty%20of%20the%20turn%20is%20the%20number%20of%20balls%20Ivan%20takes%20from%20the%20box%20during%20the%20first%20step%20of%20the%20turn.%20And%20penalty%20of%20the%20game%20is%20the%20total%20penalty%20of%20turns%20made%20by%20Ivan%20until%20he%20distributes%20all%20balls%20to%20corresponding%20boxes.%5Cn%5CnHelp%20Ivan%20to%20determine%20the%20minimum%20possible%20penalty%20of%20the%20game%21%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20one%20integer%20number%20%24%20n%20%24%20%28%20%24%201%3C%3Dn%3C%3D200000%20%24%20%29%20%5Cu2014%20the%20number%20of%20boxes%20and%20colors.%5Cn%5CnThe%20second%20line%20contains%20%24%20n%20%24%20integer%20numbers%20%24%20a_%7B1%7D%20%24%20%2C%20%24%20a_%7B2%7D%20%24%20%2C%20...%2C%20%24%20a_%7Bn%7D%20%24%20%28%20%24%201%3C%3Da_%7Bi%7D%3C%3D10%5E%7B9%7D%20%24%20%29%2C%20where%20%24%20a_%7Bi%7D%20%24%20is%20the%20number%20of%20balls%20with%20color%20%24%20i%20%24%20.%22%2C%22outputFormat%22%3A%22Print%20one%20number%20%5Cu2014%20the%20minimum%20possible%20penalty%20of%20the%20game.%22%2C%22samples%22%3A%5B%5B%223%5Cn1%202%203%5Cn%22%2C%226%5Cn%22%5D%2C%5B%224%5Cn2%203%204%205%5Cn%22%2C%2219%5Cn%22%5D%5D%2C%22hint%22%3A%22In%20the%20first%20example%20you%20take%20all%20the%20balls%20from%20the%20first%20box%2C%20choose%20%24%20k%3D3%20%24%20and%20sort%20all%20colors%20to%20corresponding%20boxes.%20Penalty%20is%20%24%206%20%24%20.%5Cn%5CnIn%20the%20second%20example%20you%20make%20two%20turns%3A%5Cn%5Cn1.%20Take%20all%20the%20balls%20from%20the%20first%20box%2C%20choose%20%24%20k%3D3%20%24%20%2C%20put%20balls%20of%20color%20%24%203%20%24%20to%20the%20third%20box%2C%20of%20color%20%24%204%20%24%20%5Cu2014%20to%20the%20fourth%20box%20and%20the%20rest%20put%20back%20into%20the%20first%20box.%20Penalty%20is%20%24%2014%20%24%20%3B%5Cn2.%20Take%20all%20the%20balls%20from%20the%20first%20box%2C%20choose%20%24%20k%3D2%20%24%20%2C%20put%20balls%20of%20color%20%24%201%20%24%20to%20the%20first%20box%2C%20of%20color%20%24%202%20%24%20%5Cu2014%20to%20the%20second%20box.%20Penalty%20is%20%24%205%20%24%20.%5Cn%5CnTotal%20penalty%20is%20%24%2019%20%24%20.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F884%5C%2FD%22%2C%22id%22%3A%22884D%22%7D%2C%22translation%22%3A%22%5Cu4f60%5Cu6709%20%24n%24%20%5Cu4e2a%5Cu76d2%5Cu5b50%5Cu548c%20%24n%24%20%5Cu79cd%5Cu989c%5Cu8272%5Cu7684%5Cu7403%5Cuff0c%5Cu7b2c%20%24i%24%20%5Cu79cd%5Cu989c%5Cu8272%5Cu7684%5Cu7403%5Cu7684%5Cu6570%5Cu91cf%5Cu662f%20%24a_i%24%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu8d77%5Cu521d%5Cu6240%5Cu6709%5Cu7403%5Cu90fd%5Cu5728%5Cu7b2c%20%241%24%20%5Cu4e2a%5Cu76d2%5Cu5b50%5Cu91cc%5Cuff0c%5Cu4f60%5Cu5e0c%5Cu671b%5Cu8ba9%5Cu6240%5Cu6709%5Cu7b2c%20%24i%24%20%5Cu79cd%5Cu989c%5Cu8272%5Cu7684%5Cu7403%5Cu90fd%5Cu5728%5Cu7b2c%20%24i%24%20%5Cu4e2a%5Cu76d2%5Cu5b50%5Cu91cc%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu4e8e%5Cu662f%5Cu4f60%5Cu6253%5Cu7b97%5Cu8fdb%5Cu884c%5Cu4e00%5Cu7cfb%5Cu5217%5Cu64cd%5Cu4f5c%5Cu3002%5Cu6bcf%5Cu6b21%5Cu64cd%5Cu4f5c%5Cu53ef%5Cu4ee5%5Cu53d6%5Cu51fa%5Cu67d0%5Cu4e2a%5Cu76d2%5Cu5b50%5Cu4e2d%5Cu7684%5Cu6240%5Cu6709%5Cu7403%5Cuff0c%5Cu817e%5Cu7a7a%5Cu8be5%5Cu76d2%5Cu5b50%5Cuff0c%5Cu4f46%5Cu8981%5Cu6263%5Cu9664%5Cu7b49%5Cu4e8e%5Cu53d6%5Cu51fa%5Cu7403%5Cu6570%5Cu7684%5Cu70b9%5Cu6570%5Cuff0c%5Cu7136%5Cu540e%5Cu5206%5Cu6210%20%242%24%20%5Cu6216%20%243%24%20%5Cu7ec4%5Cuff0c%5Cu5c06%5Cu6bcf%5Cu7ec4%5Cu653e%5Cu5230%5Cu4e00%5Cu4e2a%5Cu7a7a%5Cu76d2%5Cu5b50%5Cu4e2d%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu6c42%5Cu8fbe%5Cu5230%5Cu76ee%5Cu6807%5Cu6700%5Cu5c11%5Cu9700%5Cu8981%5Cu6263%5Cu9664%5Cu7684%5Cu70b9%5Cu6570%5Cu3002%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A23%2C%22totalAccepted%22%3A11%2C%22pid%22%3A%22CF884D%22%2C%22title%22%3A%22Boxes%20And%20Balls%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A35160%2C%22title%22%3A%22%5Cu6b64%5Cu9898%5Cu7ffb%5Cu8bd1%22%2C%22forum%22%3A%7B%22id%22%3A9043%2C%22name%22%3A%22CF884D%20Boxes%20And%20Balls%22%2C%22slug%22%3A%22CF884D%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Boxes%20And%20Balls%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Boxes And Balls</h1>
<h2>题意翻译</h2>
<div>你有 $n$ 个盒子和 $n$ 种颜色的球，第 $i$ 种颜色的球的数量是 $a_i$。
起初所有球都在第 $1$ 个盒子里，你希望让所有第 $i$ 种颜色的球都在第 $i$ 个盒子里。
于是你打算进行一系列操作。每次操作可以取出某个盒子中的所有球，腾空该盒子，但要扣除等于取出球数的点数，然后分成 $2$ 或 $3$ 组，将每组放到一个空盒子中。
求达到目标最少需要扣除的点数。</div>
<h2>题目描述</h2>
<div>Ivan has $ n $ different boxes. The first of them contains some balls of $ n $ different colors.
Ivan wants to play a strange game. He wants to distribute the balls into boxes in such a way that for every $ i $ ( $ 1<=i<=n $ ) $ i $ -th box will contain all balls with color $ i $ .
In order to do this, Ivan will make some turns. Each turn he does the following:
1. Ivan chooses any non-empty box and takes all balls from this box;
2. Then Ivan chooses any $ k $ empty boxes (the box from the first step becomes empty, and Ivan is allowed to choose it), separates the balls he took on the previous step into $ k $ non-empty groups and puts each group into one of the boxes. He should put each group into a separate box. He can choose either $ k=2 $ or $ k=3 $ .
The penalty of the turn is the number of balls Ivan takes from the box during the first step of the turn. And penalty of the game is the total penalty of turns made by Ivan until he distributes all balls to corresponding boxes.
Help Ivan to determine the minimum possible penalty of the game!</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains one integer number $ n $ ( $ 1<=n<=200000 $ ) — the number of boxes and colors.
The second line contains $ n $ integer numbers $ a_{1} $ , $ a_{2} $ , ..., $ a_{n} $ ( $ 1<=a_{i}<=10^{9} $ ), where $ a_{i} $ is the number of balls with color $ i $ .</div>
<h3>输出格式</h3>
<br />
<div>Print one number — the minimum possible penalty of the game.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>3
1 2 3
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>6
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>4
2 3 4 5
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>19
</code></pre>
<h2>说明</h2>
<div>In the first example you take all the balls from the first box, choose $ k=3 $ and sort all colors to corresponding boxes. Penalty is $ 6 $ .
In the second example you make two turns:
1. Take all the balls from the first box, choose $ k=3 $ , put balls of color $ 3 $ to the third box, of color $ 4 $ — to the fourth box and the rest put back into the first box. Penalty is $ 14 $ ;
2. Take all the balls from the first box, choose $ k=2 $ , put balls of color $ 1 $ to the first box, of color $ 2 $ — to the second box. Penalty is $ 5 $ .
Total penalty is $ 19 $ .</div>
</article>
</div>
</div>
</body>
</html>
