<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Dormitory - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573392094:HIfDWNoGnNIOZf7T/J04qxbamsZJOCzPONBoBvy6nNs=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Student%20Vasya%20came%20to%20study%20in%20Berland%20State%20University%20from%20the%20country%2C%20so%20he%20is%20living%20in%20a%20dormitory.%20A%20semester%20has%20%24%20n%20%24%20days%2C%20and%20in%20each%20of%20those%20days%20his%20parents%20send%20him%20some%20food.%20In%20the%20morning%20of%20the%20%24%20i%20%24%20-th%20day%20he%20receives%20%24%20a_%7Bi%7D%20%24%20kilograms%20of%20food%20that%20can%20be%20eaten%20on%20that%20day%20and%20on%20the%20next%20one%20%28then%20the%20food%20goes%20bad%20and%20becomes%20unfit%20for%20consumption%29.%5Cn%5CnEvery%20day%20Vasya%20eats%20%24%20v%20%24%20kilograms%20of%20food.%20It%20is%20known%20that%20Vasya%27s%20parents%20do%20not%20allow%20him%20to%20starve%2C%20so%20there%20always%20is%20enough%20food%20for%20Vasya.%20Vasya%20has%20%24%20m%20%24%20friends%20who%20sometimes%20live%20with%20him.%20Let%27s%20index%20the%20friends%20from%201%20to%20%24%20m%20%24%20.%20Friend%20number%20%24%20j%20%24%20lives%20with%20Vasya%20from%20day%20%24%20l_%7Bj%7D%20%24%20to%20day%20%24%20r_%7Bj%7D%20%24%20%2C%20inclusive.%20Also%2C%20the%20%24%20j%20%24%20-th%20friend%20requires%20%24%20f_%7Bj%7D%20%24%20kilograms%20of%20food%20per%20day.%20Usually%20Vasya%27s%20friends%20eat%20in%20the%20canteen%2C%20but%20sometimes%20generous%20Vasya%20feeds%20some%20of%20them.%20Every%20day%20Vasya%20can%20feed%20some%20friends%20who%20live%20with%20him%20this%20day%20%28or%20may%20feed%20nobody%29.%5Cn%5CnEvery%20time%20Vasya%20feeds%20his%20friend%2C%20he%20gives%20him%20as%20much%20food%20as%20the%20friend%20needs%20for%20the%20day%2C%20and%20Vasya%27s%20popularity%20rating%20at%20the%20University%20increases%20by%20one.%20Vasya%20cannot%20feed%20the%20same%20friend%20multiple%20times%20in%20one%20day.%20In%20addition%2C%20he%20knows%20that%20eating%20habits%20must%20be%20regular%2C%20so%20he%20always%20eats%20%24%20v%20%24%20kilograms%20of%20food%20per%20day.%5Cn%5CnVasya%20wants%20so%20choose%20whom%20he%20will%20feed%20each%20day%20of%20the%20semester%20to%20make%20his%20rating%20as%20high%20as%20possible.%20Originally%20Vasya%27s%20rating%20is%200%20because%20he%20is%20a%20freshman.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20two%20integers%20%24%20n%20%24%20and%20%24%20v%20%24%20%28%20%24%201%3C%3Dn%2Cv%3C%3D400%20%24%20%29.%20The%20second%20line%20contains%20%24%20n%20%24%20integers%20%24%20a_%7B1%7D%2Ca_%7B2%7D%2C...%2Ca_%7Bn%7D%20%24%20%28%20%24%201%3C%3Da_%7Bi%7D%3C%3D400%20%24%20%29%2C%20separated%20by%20single%20spaces.%20Value%20%24%20a_%7Bi%7D%20%24%20means%20that%20in%20the%20morning%20of%20the%20%24%20i%20%24%20-th%20day%20%24%20a_%7Bi%7D%20%24%20kilograms%20of%20food%20come%2C%20the%20food%20is%20good%20for%20eating%20on%20day%20%24%20i%20%24%20and%5C%2For%20on%20day%20%24%20i%2B1%20%24%20%28then%20the%20food%20goes%20bad%29.%20It%20is%20guaranteed%20that%20if%20Vasya%20doesn%27t%20feed%20anyone%2C%20there%20is%20a%20way%20for%20him%20to%20eat%20so%20as%20to%20consume%20%24%20v%20%24%20kilograms%20of%20food%20every%20day.%5Cn%5CnThe%20third%20line%20contains%20integer%20%24%20m%20%24%20%28%20%24%201%3C%3Dm%3C%3D400%20%24%20%29.%20Each%20of%20the%20following%20%24%20m%20%24%20lines%20describes%20one%20Vasya%27s%20friend%3A%20the%20%24%20j%20%24%20-th%20of%20these%20lines%20contains%20three%20integers%20%24%20l_%7Bj%7D%2Cr_%7Bj%7D%2Cf_%7Bj%7D%20%24%20%28%20%24%201%3C%3Dl_%7Bj%7D%3C%3Dr_%7Bj%7D%3C%3Dn%2C1%3C%3Df_%7Bj%7D%3C%3D400%20%24%20%29%2C%20separated%20by%20single%20spaces.%22%2C%22outputFormat%22%3A%22In%20the%20first%20line%20print%20the%20highest%20rating%20Vasya%20can%20reach.%20In%20the%20next%20%24%20n%20%24%20lines%20print%2C%20which%20friends%20Vasya%20needs%20to%20feed%20on%20each%20day.%20In%20the%20%24%20i%20%24%20-th%20of%20these%20lines%20first%20print%20the%20number%20of%20friends%20to%20feed%20on%20the%20%24%20i%20%24%20-th%20day%2C%20and%20then%20list%20the%20indexes%20of%20these%20friends.%20Print%20the%20friends%20in%20these%20lists%20in%20any%20order.%20If%20there%20are%20multiple%20optimal%20solutions%2C%20print%20any%20of%20them.%22%2C%22samples%22%3A%5B%5B%224%201%5Cn3%202%205%204%5Cn3%5Cn1%203%202%5Cn1%204%201%5Cn3%204%202%5Cn%22%2C%227%5Cn1%202%5Cn1%202%5Cn3%202%201%203%5Cn2%202%203%5Cn%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F254%5C%2FE%22%2C%22id%22%3A%22254E%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22CF254E%22%2C%22title%22%3A%22Dormitory%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Dormitory%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573295103;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Dormitory</h1>
<h2>题目描述</h2>
<div>Student Vasya came to study in Berland State University from the country, so he is living in a dormitory. A semester has $ n $ days, and in each of those days his parents send him some food. In the morning of the $ i $ -th day he receives $ a_{i} $ kilograms of food that can be eaten on that day and on the next one (then the food goes bad and becomes unfit for consumption).
Every day Vasya eats $ v $ kilograms of food. It is known that Vasya's parents do not allow him to starve, so there always is enough food for Vasya. Vasya has $ m $ friends who sometimes live with him. Let's index the friends from 1 to $ m $ . Friend number $ j $ lives with Vasya from day $ l_{j} $ to day $ r_{j} $ , inclusive. Also, the $ j $ -th friend requires $ f_{j} $ kilograms of food per day. Usually Vasya's friends eat in the canteen, but sometimes generous Vasya feeds some of them. Every day Vasya can feed some friends who live with him this day (or may feed nobody).
Every time Vasya feeds his friend, he gives him as much food as the friend needs for the day, and Vasya's popularity rating at the University increases by one. Vasya cannot feed the same friend multiple times in one day. In addition, he knows that eating habits must be regular, so he always eats $ v $ kilograms of food per day.
Vasya wants so choose whom he will feed each day of the semester to make his rating as high as possible. Originally Vasya's rating is 0 because he is a freshman.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains two integers $ n $ and $ v $ ( $ 1<=n,v<=400 $ ). The second line contains $ n $ integers $ a_{1},a_{2},...,a_{n} $ ( $ 1<=a_{i}<=400 $ ), separated by single spaces. Value $ a_{i} $ means that in the morning of the $ i $ -th day $ a_{i} $ kilograms of food come, the food is good for eating on day $ i $ and/or on day $ i+1 $ (then the food goes bad). It is guaranteed that if Vasya doesn't feed anyone, there is a way for him to eat so as to consume $ v $ kilograms of food every day.
The third line contains integer $ m $ ( $ 1<=m<=400 $ ). Each of the following $ m $ lines describes one Vasya's friend: the $ j $ -th of these lines contains three integers $ l_{j},r_{j},f_{j} $ ( $ 1<=l_{j}<=r_{j}<=n,1<=f_{j}<=400 $ ), separated by single spaces.</div>
<h3>输出格式</h3>
<br />
<div>In the first line print the highest rating Vasya can reach. In the next $ n $ lines print, which friends Vasya needs to feed on each day. In the $ i $ -th of these lines first print the number of friends to feed on the $ i $ -th day, and then list the indexes of these friends. Print the friends in these lists in any order. If there are multiple optimal solutions, print any of them.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>4 1
3 2 5 4
3
1 3 2
1 4 1
3 4 2
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>7
1 2
1 2
3 2 1 3
2 2 3
</code></pre>
</article>
</div>
</div>
</body>
</html>
