<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Run for beer - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573395547:yrDyUf7mwxmB9rlAPzFM0xfkBS0uxL6FUii7RUlfiHc=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22People%20in%20BubbleLand%20like%20to%20drink%20beer.%20Little%20do%20you%20know%2C%20beer%20here%20is%20so%20good%20and%20strong%20that%20every%20time%20you%20drink%20it%20your%20speed%20goes%2010%20times%20slower%20than%20before%20you%20drank%20it.%5Cn%5CnBirko%20lives%20in%20city%20Beergrade%2C%20but%20wants%20to%20go%20to%20city%20Beerburg.%20You%20are%20given%20a%20road%20map%20of%20BubbleLand%20and%20you%20need%20to%20find%20the%20fastest%20way%20for%20him.%20When%20he%20starts%20his%20journey%20in%20Beergrade%20his%20speed%20is%201.%20When%20he%20comes%20to%20a%20new%20city%20he%20always%20tries%20a%20glass%20of%20local%20beer%2C%20which%20divides%20his%20speed%20by%2010.%5Cn%5CnThe%20question%20here%20is%20what%20the%20minimal%20time%20for%20him%20to%20reach%20Beerburg%20is.%20If%20there%20are%20several%20paths%20with%20the%20same%20minimal%20time%2C%20pick%20the%20one%20that%20has%20least%20roads%20on%20it.%20If%20there%20is%20still%20more%20than%20one%20path%2C%20pick%20any.%5Cn%5CnIt%20is%20guaranteed%20that%20there%20will%20be%20at%20least%20one%20path%20from%20Beergrade%20to%20Beerburg.%22%2C%22inputFormat%22%3A%22The%20first%20line%20of%20input%20contains%20integer%20%24%20N%20%24%20%5Cu2014%20the%20number%20of%20cities%20in%20Bubbleland%20and%20integer%20%24%20M%20%24%20%5Cu2014%20the%20number%20of%20roads%20in%20this%20country.%20Cities%20are%20enumerated%20from%200%20to%20%24%20N-1%20%24%20%2C%20with%20city%200%20being%20Beergrade%2C%20and%20city%20%24%20N-1%20%24%20being%20Beerburg.%20Each%20of%20the%20following%20%24%20M%20%24%20lines%20contains%20three%20integers%20%24%20a%20%24%20%2C%20%24%20b%20%24%20%28%20%24%20a%5Cu2260b%20%24%20%29%20and%20%24%20len%20%24%20.%20These%20numbers%20indicate%20that%20there%20is%20a%20bidirectional%20road%20between%20cities%20%24%20a%20%24%20and%20%24%20b%20%24%20with%20length%20%24%20len%20%24%20.%5Cn%5Cn-%20%24%202%3C%3DN%3C%3D10%5E%7B5%7D%20%24%5Cn-%20%24%201%3C%3DM%3C%3D10%5E%7B5%7D%20%24%5Cn-%20%24%200%3C%3Dlen%3C%3D9%20%24%5Cn-%20There%20is%20at%20most%20one%20road%20between%20two%20cities%22%2C%22outputFormat%22%3A%22The%20first%20line%20of%20output%20should%20contain%20minimal%20time%20needed%20to%20go%20from%20Beergrade%20to%20Beerburg.%5Cn%5CnThe%20second%20line%20of%20the%20output%20should%20contain%20the%20number%20of%20cities%20on%20the%20path%20from%20Beergrade%20to%20Beerburg%20that%20takes%20minimal%20time.%5Cn%5CnThe%20third%20line%20of%20output%20should%20contain%20the%20numbers%20of%20cities%20on%20this%20path%20in%20the%20order%20they%20are%20visited%2C%20separated%20by%20spaces.%22%2C%22samples%22%3A%5B%5B%228%2010%5Cn0%201%201%5Cn1%202%205%5Cn2%207%206%5Cn0%203%202%5Cn3%207%203%5Cn0%204%200%5Cn4%205%200%5Cn5%207%202%5Cn0%206%200%5Cn6%207%207%5Cn%22%2C%2232%5Cn3%5Cn0%203%207%5Cn%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F575%5C%2FG%22%2C%22id%22%3A%22575G%22%7D%2C%22translation%22%3A%22n%5Cu4e2a%5Cu70b9m%5Cu6761%5Cu8fb9%5Cu7684%5Cu5e26%5Cu6743%5Cu56fe%5Cuff0c%5Cu6c421%5Cu5230n%5Cu7684%5Cu6700%5Cu5c0f%5Cu6743%5Cu503c%5Cu7684%5Cu8def%5Cu5f84%5Cuff0c%5Cu6743%5Cu503c%5Cu4e3a%5Cu628a%5Cu8def%5Cu5f84%5Cu7ecf%5Cu8fc7%5Cu7684%5Cu8fb9%5Cu7684%5Cu6743%5Cu4ece%5Cu5de6%5Cu5f80%5Cu53f3%5Cu4f9d%5Cu6b21%5Cu5199%5Cu4e0b%5Cu7ec4%5Cu6210%5Cu7684%5Cu5341%5Cu8fdb%5Cu5236%5Cu6570%5Cr%5Cn%5Cr%5Cn0%3C%3D%5Cu8fb9%5Cu6743%3C%3D9%5Cr%5Cn%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A56%2C%22totalAccepted%22%3A18%2C%22pid%22%3A%22CF575G%22%2C%22title%22%3A%22Run%20for%20beer%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A42337%2C%22title%22%3A%22%5Cu9898%5Cu610f%22%2C%22forum%22%3A%7B%22id%22%3A10374%2C%22name%22%3A%22CF575G%20Run%20for%20beer%22%2C%22slug%22%3A%22CF575G%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P2371%22%2C%22title%22%3A%22%5B%5Cu56fd%5Cu5bb6%5Cu96c6%5Cu8bad%5Cu961f%5D%5Cu58a8%5Cu58a8%5Cu7684%5Cu7b49%5Cu5f0f%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P3783%22%2C%22title%22%3A%22%5BSDOI2017%5D%5Cu5929%5Cu624d%5Cu9ed1%5Cu5ba2%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22CF521E%22%2C%22title%22%3A%22Cycling%20City%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22P4208%22%2C%22title%22%3A%22%5BJSOI2008%5D%5Cu6700%5Cu5c0f%5Cu751f%5Cu6210%5Cu6811%5Cu8ba1%5Cu6570%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22CF1209E2%22%2C%22title%22%3A%22Rotate%20Columns%20%28hard%20version%29%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Run%20for%20beer%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Run for beer</h1>
<h2>题意翻译</h2>
<div>n个点m条边的带权图，求1到n的最小权值的路径，权值为把路径经过的边的权从左往右依次写下组成的十进制数
0<=边权<=9
</div>
<h2>题目描述</h2>
<div>People in BubbleLand like to drink beer. Little do you know, beer here is so good and strong that every time you drink it your speed goes 10 times slower than before you drank it.
Birko lives in city Beergrade, but wants to go to city Beerburg. You are given a road map of BubbleLand and you need to find the fastest way for him. When he starts his journey in Beergrade his speed is 1. When he comes to a new city he always tries a glass of local beer, which divides his speed by 10.
The question here is what the minimal time for him to reach Beerburg is. If there are several paths with the same minimal time, pick the one that has least roads on it. If there is still more than one path, pick any.
It is guaranteed that there will be at least one path from Beergrade to Beerburg.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line of input contains integer $ N $ — the number of cities in Bubbleland and integer $ M $ — the number of roads in this country. Cities are enumerated from 0 to $ N-1 $ , with city 0 being Beergrade, and city $ N-1 $ being Beerburg. Each of the following $ M $ lines contains three integers $ a $ , $ b $ ( $ a≠b $ ) and $ len $ . These numbers indicate that there is a bidirectional road between cities $ a $ and $ b $ with length $ len $ .
- $ 2<=N<=10^{5} $
- $ 1<=M<=10^{5} $
- $ 0<=len<=9 $
- There is at most one road between two cities</div>
<h3>输出格式</h3>
<br />
<div>The first line of output should contain minimal time needed to go from Beergrade to Beerburg.
The second line of the output should contain the number of cities on the path from Beergrade to Beerburg that takes minimal time.
The third line of output should contain the numbers of cities on this path in the order they are visited, separated by spaces.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>8 10
0 1 1
1 2 5
2 7 6
0 3 2
3 7 3
0 4 0
4 5 0
5 7 2
0 6 0
6 7 7
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>32
3
0 3 7
</code></pre>
</article>
</div>
</div>
</body>
</html>
