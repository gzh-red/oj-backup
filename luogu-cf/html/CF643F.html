<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Bears and Juice - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573396332:kT30etgFef9lu+Bqwc+c5AvfI3lXTLik+qLhi8nq4u4=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%22%2C%22description%22%3A%22There%20are%20%24%20n%20%24%20bears%20in%20the%20inn%20and%20%24%20p%20%24%20places%20to%20sleep.%20Bears%20will%20party%20together%20for%20some%20number%20of%20nights%20%28and%20days%29.%5Cn%5CnBears%20love%20drinking%20juice.%20They%20don%27t%20like%20wine%20but%20they%20can%27t%20distinguish%20it%20from%20juice%20by%20taste%20or%20smell.%5Cn%5CnA%20bear%20doesn%27t%20sleep%20unless%20he%20drinks%20wine.%20A%20bear%20must%20go%20to%20sleep%20a%20few%20hours%20after%20drinking%20a%20wine.%20He%20will%20wake%20up%20many%20days%20after%20the%20party%20is%20over.%5Cn%5CnRadewoosh%20is%20the%20owner%20of%20the%20inn.%20He%20wants%20to%20put%20some%20number%20of%20barrels%20in%20front%20of%20bears.%20One%20barrel%20will%20contain%20wine%20and%20all%20other%20ones%20will%20contain%20juice.%20Radewoosh%20will%20challenge%20bears%20to%20find%20a%20barrel%20with%20wine.%5Cn%5CnEach%20night%2C%20the%20following%20happens%20in%20this%20exact%20order%3A%5Cn%5Cn1.%20Each%20bear%20must%20choose%20a%20%28maybe%20empty%29%20set%20of%20barrels.%20The%20same%20barrel%20may%20be%20chosen%20by%20many%20bears.%5Cn2.%20Each%20bear%20drinks%20a%20glass%20from%20each%20barrel%20he%20chose.%5Cn3.%20All%20bears%20who%20drink%20wine%20go%20to%20sleep%20%28exactly%20those%20bears%20who%20chose%20a%20barrel%20with%20wine%29.%20They%20will%20wake%20up%20many%20days%20after%20the%20party%20is%20over.%20If%20there%20are%20not%20enough%20places%20to%20sleep%20then%20bears%20lose%20immediately.%5Cn%5CnAt%20the%20end%2C%20if%20it%27s%20sure%20where%20wine%20is%20and%20there%20is%20at%20least%20one%20awake%20bear%20then%20bears%20win%20%28unless%20they%20have%20lost%20before%20because%20of%20the%20number%20of%20places%20to%20sleep%29.%5Cn%5CnRadewoosh%20wants%20to%20allow%20bears%20to%20win.%20He%20considers%20%24%20q%20%24%20scenarios.%20In%20the%20%24%20i%20%24%20-th%20scenario%20the%20party%20will%20last%20for%20%24%20i%20%24%20nights.%20Then%2C%20let%20%24%20R_%7Bi%7D%20%24%20denote%20the%20maximum%20number%20of%20barrels%20for%20which%20bears%20surely%20win%20if%20they%20behave%20optimally.%20Let%27s%20define%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF643F%5C%2F3cf222972365b649aecc64bb442b708fd8b7a182.png%29.%20Your%20task%20is%20to%20find%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF643F%5C%2F7ba18b4dd857c67bb4a6e2b14cb4cab7c95a919c.png%29%2C%20where%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF643F%5C%2F4298d47c0191af3c0a3103f431751061bc7e2362.png%29%20denotes%20the%20exclusive%20or%20%28also%20denoted%20as%20XOR%29.%5Cn%5CnNote%20that%20the%20same%20barrel%20may%20be%20chosen%20by%20many%20bears%20and%20all%20of%20them%20will%20go%20to%20sleep%20at%20once.%22%2C%22inputFormat%22%3A%22The%20only%20line%20of%20the%20input%20contains%20three%20integers%20%24%20n%20%24%20%2C%20%24%20p%20%24%20and%20%24%20q%20%24%20%28%20%24%201%3C%3Dn%3C%3D10%5E%7B9%7D%20%24%20%2C%20%24%201%3C%3Dp%3C%3D130%20%24%20%2C%20%24%201%3C%3Dq%3C%3D2000000%20%24%20%29%20%5Cu2014%20the%20number%20of%20bears%2C%20the%20number%20of%20places%20to%20sleep%20and%20the%20number%20of%20scenarios%2C%20respectively.%22%2C%22outputFormat%22%3A%22Print%20one%20integer%2C%20equal%20to%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF643F%5C%2F7ba18b4dd857c67bb4a6e2b14cb4cab7c95a919c.png%29.%22%2C%22samples%22%3A%5B%5B%225%201%203%5Cn%22%2C%2232%5Cn%22%5D%2C%5B%221%20100%204%5Cn%22%2C%224%5Cn%22%5D%2C%5B%223%202%201%5Cn%22%2C%227%5Cn%22%5D%2C%5B%22100%20100%20100%5Cn%22%2C%22381863924%5Cn%22%5D%5D%2C%22hint%22%3A%22In%20the%20first%20sample%2C%20there%20are%20%24%205%20%24%20bears%20and%20only%20%24%201%20%24%20place%20to%20sleep.%20We%20have%20%24%20R_%7B1%7D%3D6%2CR_%7B2%7D%3D11%2CR_%7B3%7D%3D16%20%24%20so%20the%20answer%20is%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF643F%5C%2F3044a14b49b8a41a1aadeeb76be7dca4826f9b52.png%29.%20Let%27s%20analyze%20the%20optimal%20strategy%20for%20scenario%20with%20%24%202%20%24%20days.%20There%20are%20%24%20R_%7B2%7D%3D11%20%24%20barrels%20and%20%24%2010%20%24%20of%20them%20contain%20juice.%5Cn%5Cn-%20In%20the%20first%20night%2C%20the%20%24%20i%20%24%20-th%20bear%20chooses%20a%20barrel%20%24%20i%20%24%20only.%20%5Cn%20%20-%20If%20one%20of%20the%20first%20%24%205%20%24%20barrels%20contains%20wine%20then%20one%20bear%20goes%20to%20sleep.%20Then%2C%20bears%20win%20because%20they%20know%20where%20wine%20is%20and%20there%20is%20at%20least%20one%20awake%20bear.%5Cn%20%20-%20But%20let%27s%20say%20none%20of%20the%20first%20%24%205%20%24%20barrels%20contains%20wine.%20In%20the%20second%20night%2C%20the%20%24%20i%20%24%20-th%20bear%20chooses%20a%20barrel%20%24%205%2Bi%20%24%20.%20%5Cn%20%20%20%20%20%20-%20If%20one%20of%20barrels%20%24%206%5Cu201310%20%24%20contains%20wine%20then%20one%20bear%20goes%20to%20sleep.%20And%20again%2C%20bears%20win%20in%20such%20a%20situation.%5Cn%20%20%20%20%20%20-%20If%20nobody%20went%20to%20sleep%20then%20wine%20is%20in%20a%20barrel%20%24%2011%20%24%20.%5Cn%5CnIn%20the%20second%20sample%2C%20there%20is%20only%20one%20bear.%20He%20should%20choose%20an%20empty%20set%20of%20barrels%20in%20each%20night.%20Otherwise%2C%20he%20would%20maybe%20get%20wine%20and%20bears%20would%20lose%20%28because%20there%20must%20be%20at%20least%20one%20awake%20bear%29.%20So%2C%20for%20any%20number%20of%20days%20we%20have%20%24%20R_%7Bi%7D%3D1%20%24%20.%20The%20answer%20is%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF643F%5C%2F17441c3ac6d006f5ad9af5d20538f3ec4ec78ffd.png%29.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B5000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F643%5C%2FF%22%2C%22id%22%3A%22643F%22%7D%2C%22translation%22%3A%22%5Cu6709%20n%20%5Cu53ea%5Cu718a%5Cu548c%5Cu82e5%5Cu5e72%5Cu6876%5Cu679c%5Cu6c41%5Cu548c%5Cu6070%5Cu597d%5Cu4e00%5Cu6876%5Cu9152%5Cuff0c%5Cu6bcf%5Cu4e00%5Cu5929%5Cu6bcf%5Cu53ea%5Cu718a%5Cu4f1a%5Cu9009%5Cu62e9%5Cu4e00%5Cu4e9b%5Cu6876%5Cuff08%5Cu53ef%5Cu80fd%5Cu4e0d%5Cu9009%5Cuff09%5Cu5e76%5Cu5404%5Cu559d%5Cu4e00%5Cn%5Cu676f%5Cuff0c%5Cu559d%5Cu5230%5Cu9152%5Cu7684%5Cu718a%5Cu4f1a%5Cu53bb%5Cu7761%5Cu89c9%5Cu5e76%5Cu4e0d%5Cu518d%5Cu56de%5Cu6765%5Cuff0c%5Cu901a%5Cu8fc7%5Cu8fd9%5Cu4e2a%5Cu4fe1%5Cu606f%5Cuff0c%5Cu718a%5Cu4eec%5Cu60f3%5Cu77e5%5Cu9053%5Cu54ea%5Cu4e2a%5Cu6876%5Cu91cc%5Cu662f%5Cu9152%5Cu3002%5Cu53ea%5Cu6709%20p%20%5Cu4e2a%5Cu7761%5Cn%5Cu89c9%5Cu7684%5Cu4f4d%5Cu7f6e%5Cuff0c%5Cu5f53%5Cu7761%5Cu89c9%5Cu7684%5Cu718a%5Cu8d85%5Cu8fc7%5Cu4e86%20p%20%5Cu53ea%5Cu6216%5Cu8005%5Cu6240%5Cu6709%5Cu718a%5Cu90fd%5Cu5728%5Cu7761%5Cu89c9%5Cu65f6%5Cu718a%5Cu4eec%5Cu5c31%5Cu5931%5Cu8d25%5Cu4e86%5Cu3002%5Cu4ee4%20Ri%20%5Cu8868%5Cu793a%5Cu5728%20i%20%5Cu5929%5Cu5185%5Cn%5Cu6876%5Cu7684%5Cu6570%5Cu91cf%5Cu6700%5Cu591a%5Cu4e3a%5Cu591a%5Cu5c11%5Cuff0c%5Cu4f7f%5Cu5f97%5Cu718a%5Cu53ef%5Cu4ee5%5Cu6210%5Cu529f%5Cu77e5%5Cu9053%5Cu9152%5Cu7684%5Cu4f4d%5Cu7f6e%5Cu3002%5Cu4ee4%20Xi%20%3D%20%28i%20%5Cu00b7%20Ri%29%20mod%202%5Cn32%5Cuff0c%5Cu4f60%5Cu9700%5Cu8981%5Cu6c42%5Cu51fa%5CnX1%20%5Cu2295%20X2%20%5Cu2295%20%5Cu00b7%20%5Cu00b7%20%5Cu00b7%20%5Cu2295%20Xq%5Cuff0c%5Cu5176%5Cu4e2d%20%5Cu2295%20%5Cu8868%5Cu793a%5Cu6309%5Cu4f4d%5Cu5f02%5Cu6216%5Cu3002%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A4%2C%22totalAccepted%22%3A2%2C%22pid%22%3A%22CF643F%22%2C%22title%22%3A%22Bears%20and%20Juice%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Bears%20and%20Juice%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573306449;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Bears and Juice</h1>
<h2>题意翻译</h2>
<div>有 n 只熊和若干桶果汁和恰好一桶酒，每一天每只熊会选择一些桶（可能不选）并各喝一
杯，喝到酒的熊会去睡觉并不再回来，通过这个信息，熊们想知道哪个桶里是酒。只有 p 个睡
觉的位置，当睡觉的熊超过了 p 只或者所有熊都在睡觉时熊们就失败了。令 Ri 表示在 i 天内
桶的数量最多为多少，使得熊可以成功知道酒的位置。令 Xi = (i · Ri) mod 2
32，你需要求出
X1 ⊕ X2 ⊕ · · · ⊕ Xq，其中 ⊕ 表示按位异或。</div>
<h2>题目描述</h2>
<div>There are $ n $ bears in the inn and $ p $ places to sleep. Bears will party together for some number of nights (and days).
Bears love drinking juice. They don't like wine but they can't distinguish it from juice by taste or smell.
A bear doesn't sleep unless he drinks wine. A bear must go to sleep a few hours after drinking a wine. He will wake up many days after the party is over.
Radewoosh is the owner of the inn. He wants to put some number of barrels in front of bears. One barrel will contain wine and all other ones will contain juice. Radewoosh will challenge bears to find a barrel with wine.
Each night, the following happens in this exact order:
1. Each bear must choose a (maybe empty) set of barrels. The same barrel may be chosen by many bears.
2. Each bear drinks a glass from each barrel he chose.
3. All bears who drink wine go to sleep (exactly those bears who chose a barrel with wine). They will wake up many days after the party is over. If there are not enough places to sleep then bears lose immediately.
At the end, if it's sure where wine is and there is at least one awake bear then bears win (unless they have lost before because of the number of places to sleep).
Radewoosh wants to allow bears to win. He considers $ q $ scenarios. In the $ i $ -th scenario the party will last for $ i $ nights. Then, let $ R_{i} $ denote the maximum number of barrels for which bears surely win if they behave optimally. Let's define ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF643F/3cf222972365b649aecc64bb442b708fd8b7a182.png). Your task is to find ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF643F/7ba18b4dd857c67bb4a6e2b14cb4cab7c95a919c.png), where ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF643F/4298d47c0191af3c0a3103f431751061bc7e2362.png) denotes the exclusive or (also denoted as XOR).
Note that the same barrel may be chosen by many bears and all of them will go to sleep at once.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The only line of the input contains three integers $ n $ , $ p $ and $ q $ ( $ 1<=n<=10^{9} $ , $ 1<=p<=130 $ , $ 1<=q<=2000000 $ ) — the number of bears, the number of places to sleep and the number of scenarios, respectively.</div>
<h3>输出格式</h3>
<br />
<div>Print one integer, equal to ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF643F/7ba18b4dd857c67bb4a6e2b14cb4cab7c95a919c.png).</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>5 1 3
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>32
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>1 100 4
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>4
</code></pre>
<h3>输入样例 #3</h3>
<pre><code>3 2 1
</code></pre>
<h3>输出样例 #3</h3>
<pre><code>7
</code></pre>
<h3>输入样例 #4</h3>
<pre><code>100 100 100
</code></pre>
<h3>输出样例 #4</h3>
<pre><code>381863924
</code></pre>
<h2>说明</h2>
<div>In the first sample, there are $ 5 $ bears and only $ 1 $ place to sleep. We have $ R_{1}=6,R_{2}=11,R_{3}=16 $ so the answer is ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF643F/3044a14b49b8a41a1aadeeb76be7dca4826f9b52.png). Let's analyze the optimal strategy for scenario with $ 2 $ days. There are $ R_{2}=11 $ barrels and $ 10 $ of them contain juice.
- In the first night, the $ i $ -th bear chooses a barrel $ i $ only.
- If one of the first $ 5 $ barrels contains wine then one bear goes to sleep. Then, bears win because they know where wine is and there is at least one awake bear.
- But let's say none of the first $ 5 $ barrels contains wine. In the second night, the $ i $ -th bear chooses a barrel $ 5+i $ .
- If one of barrels $ 6–10 $ contains wine then one bear goes to sleep. And again, bears win in such a situation.
- If nobody went to sleep then wine is in a barrel $ 11 $ .
In the second sample, there is only one bear. He should choose an empty set of barrels in each night. Otherwise, he would maybe get wine and bears would lose (because there must be at least one awake bear). So, for any number of days we have $ R_{i}=1 $ . The answer is ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF643F/17441c3ac6d006f5ad9af5d20538f3ec4ec78ffd.png).</div>
</article>
</div>
</div>
</body>
</html>
