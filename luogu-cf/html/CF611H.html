<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>New Year and Forgotten Tree - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573395967:mRSfC5/xp6SzZV4wNx2Ik7fUfqEJidQoY4XatRbf7ls=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22A%20tree%20is%20a%20connected%20undirected%20graph%20with%20%24%20n-1%20%24%20edges%2C%20where%20%24%20n%20%24%20denotes%20the%20number%20of%20vertices.%20Vertices%20are%20numbered%20%24%201%20%24%20through%20%24%20n%20%24%20.%5Cn%5CnLimak%20is%20a%20little%20polar%20bear.%20His%20bear%20family%20prepares%20a%20New%20Year%20tree%20every%20year.%20One%20year%20ago%20their%20tree%20was%20more%20awesome%20than%20usually.%20Thus%2C%20they%20decided%20to%20prepare%20the%20same%20tree%20in%20the%20next%20year.%20Limak%20was%20responsible%20for%20remembering%20that%20tree.%5Cn%5CnIt%20would%20be%20hard%20to%20remember%20a%20whole%20tree.%20Limak%20decided%20to%20describe%20it%20in%20his%20notebook%20instead.%20He%20took%20a%20pen%20and%20wrote%20%24%20n-1%20%24%20lines%2C%20each%20with%20two%20integers%20%5Cu2014%20indices%20of%20two%20vertices%20connected%20by%20an%20edge.%5Cn%5CnNow%2C%20the%20New%20Year%20is%20just%20around%20the%20corner%20and%20Limak%20is%20asked%20to%20reconstruct%20that%20tree.%20Of%20course%2C%20there%20is%20a%20problem.%20He%20was%20a%20very%20little%20bear%20a%20year%20ago%2C%20and%20he%20didn%27t%20know%20digits%20and%20the%20alphabet%2C%20so%20he%20just%20replaced%20each%20digit%20with%20a%20question%20mark%20%5Cu2014%20the%20only%20character%20he%20knew.%20That%20means%2C%20for%20any%20vertex%20index%20in%20his%20notes%20he%20knows%20only%20the%20number%20of%20digits%20in%20it.%20At%20least%20he%20knows%20there%20were%20no%20leading%20zeroes.%5Cn%5CnLimak%20doesn%27t%20want%20to%20disappoint%20everyone.%20Please%2C%20take%20his%20notes%20and%20reconstruct%20a%20New%20Year%20tree.%20Find%20any%20tree%20matching%20Limak%27s%20records%20and%20print%20its%20edges%20in%20any%20order.%20It%27s%20also%20possible%20that%20Limak%20made%20a%20mistake%20and%20there%20is%20no%20suitable%20tree%20%5Cu2013%20in%20this%20case%20print%20%5C%22-1%5C%22%20%28without%20the%20quotes%29.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20a%20single%20integer%20%24%20n%20%24%20%28%20%24%202%3C%3Dn%3C%3D200000%20%24%20%29%20%5Cu2014%20the%20number%20of%20vertices.%5Cn%5CnEach%20of%20the%20next%20%24%20n-1%20%24%20lines%20contains%20two%20space-separated%20non-empty%20strings%2C%20both%20consisting%20of%20questions%20marks%20only.%20No%20string%20has%20more%20characters%20than%20the%20number%20of%20digits%20in%20%24%20n%20%24%20.%22%2C%22outputFormat%22%3A%22If%20there%20is%20no%20tree%20matching%20Limak%27s%20records%2C%20print%20the%20only%20line%20with%20%5C%22-1%5C%22%20%28without%20the%20quotes%29.%5Cn%5CnOtherwise%2C%20describe%20any%20tree%20matching%20Limak%27s%20notes.%20Print%20%24%20n-1%20%24%20lines%2C%20each%20with%20two%20space-separated%20integers%20%5Cu2013%20indices%20of%20vertices%20connected%20by%20an%20edge.%20You%20can%20print%20edges%20in%20any%20order.%22%2C%22samples%22%3A%5B%5B%2212%5Cn%3F%20%3F%5Cn%3F%20%3F%5Cn%3F%20%3F%5Cn%3F%20%3F%3F%5Cn%3F%3F%20%3F%5Cn%3F%3F%20%3F%3F%5Cn%3F%20%3F%3F%5Cn%3F%20%3F%5Cn%3F%20%3F%5Cn%3F%20%3F%5Cn%3F%20%3F%5Cn%22%2C%223%201%5Cn1%206%5Cn9%201%5Cn2%2010%5Cn1%207%5Cn8%201%5Cn1%204%5Cn1%2010%5Cn5%201%5Cn10%2011%5Cn12%201%5Cn%22%5D%2C%5B%2212%5Cn%3F%3F%20%3F%3F%5Cn%3F%20%3F%5Cn%3F%20%3F%5Cn%3F%20%3F%3F%5Cn%3F%3F%20%3F%5Cn%3F%3F%20%3F%3F%5Cn%3F%20%3F%3F%5Cn%3F%20%3F%5Cn%3F%20%3F%5Cn%3F%3F%20%3F%3F%5Cn%3F%20%3F%5Cn%22%2C%22-1%5Cn%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B7000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F611%5C%2FH%22%2C%22id%22%3A%22611H%22%7D%2C%22translation%22%3A%22%23%23%20%5Cu9898%5Cu76ee%5Cu63cf%5Cu8ff0%5Cr%5Cn%5Cu7ed9%5Cu5b9a%5Cu4f60%5Cu4e00%5Cu68f5%5Cu6811%5Cuff0c%5Cu53ef%5Cu662f%5Cu6bcf%5Cu4e2a%5Cu8282%5Cu70b9%5Cu4e0a%5Cu7684%5Cu7f16%5Cu53f7%5Cu770b%5Cu4e0d%5Cu6e05%5Cu4e86%5Cuff0c%5Cu53ea%5Cu80fd%5Cu8fa8%5Cu522b%5Cu5b83%5Cu7684%5Cu957f%5Cu5ea6%5Cu3002%5Cu73b0%5Cu5728%5Cu7528%5Cu95ee%5Cu53f7%5Cu7684%5Cu4e2a%5Cu6570%5Cu4ee3%5Cu8868%5Cu6bcf%5Cu4e2a%5Cu8282%5Cu70b9%5Cu7f16%5Cu53f7%5Cu90a3%5Cu4e2a%5Cu6570%5Cu5b57%5Cu7684%2A%2A%5Cu957f%5Cu5ea6%2A%2A%5Cuff0c%5Cu8bf7%5Cu4f60%5Cu8fd8%5Cu539f%5Cu8fd9%5Cu4e00%5Cu9897%5Cu6811%5Cuff0c%5Cu4efb%5Cu610f%5Cu8f93%5Cu51fa%5Cu4e00%5Cu4e2a%5Cu65b9%5Cu6848%5Cuff0c%5Cu6709%24SPJ%24%5Cu6765%5Cu68c0%5Cu9a8c%5Cu4f60%5Cu7684%5Cu6b63%5Cu786e%5Cu6027%5Cu3002%5Cu65e0%5Cu89e3%5Cu8f93%5Cu51fa%5Cu4e00%5Cu884c%24-1%24%5Cu3002%5Cr%5Cn%5Cr%5Cn%23%23%20%5Cu8f93%5Cu5165%5Cu683c%5Cu5f0f%5Cuff1a%5Cr%5Cn%5Cu7b2c%5Cu4e00%5Cu884c%5Cu4e00%5Cu4e2a%5Cu6574%5Cu6570%24n%24%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu63a5%5Cu4e0b%5Cu6765%20%24n-1%24%5Cu884c%5Cu6bcf%5Cu884c%5Cu4e24%5Cu4e2a%5Cu6709%5Cu95ee%5Cu53f7%5Cu6784%5Cu6210%5Cu7684%5Cu5b57%5Cu7b26%5Cu4e32%5Cuff0c%5Cu4ee3%5Cu8868%5Cu7f16%5Cu53f7%5Cu957f%5Cu5ea6%5Cu3002%5Cr%5Cn%23%23%20%5Cu8f93%5Cu51fa%5Cu683c%5Cu5f0f%20%3A%5Cr%5Cn%5Cu82e5%5Cu6709%5Cu89e3%5Cuff0c%5Cu76f4%5Cu63a5%5Cu8f93%5Cu51fa%24n-1%24%5Cu884c%5Cuff0c%5Cu6bcf%5Cu884c%5Cu4e24%5Cu4e2a%5Cu6b63%5Cu6574%5Cu6570%5Cuff0c%5Cu4ee3%5Cu8868%5Cu4f60%5Cu8fd8%5Cu539f%5Cu7684%5Cu8fd9%5Cu9897%5Cu6811%5Cu7684%5Cu8fb9%5Cu8fde%5Cu63a5%5Cu7684%5Cu4e24%5Cu4e2a%5Cu8282%5Cu70b9%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu82e5%5Cu65e0%5Cu89e3%5Cu8f93%5Cu51fa%24-1%24%5Cr%5Cn%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A39%2C%22totalAccepted%22%3A15%2C%22pid%22%3A%22CF611H%22%2C%22title%22%3A%22New%20Year%20and%20Forgotten%20Tree%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22New%20Year%20and%20Forgotten%20Tree%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>New Year and Forgotten Tree</h1>
<h2>题意翻译</h2>
<div>## 题目描述
给定你一棵树，可是每个节点上的编号看不清了，只能辨别它的长度。现在用问号的个数代表每个节点编号那个数字的**长度**，请你还原这一颗树，任意输出一个方案，有$SPJ$来检验你的正确性。无解输出一行$-1$。
## 输入格式：
第一行一个整数$n$。
接下来 $n-1$行每行两个有问号构成的字符串，代表编号长度。
## 输出格式 :
若有解，直接输出$n-1$行，每行两个正整数，代表你还原的这颗树的边连接的两个节点。
若无解输出$-1$
</div>
<h2>题目描述</h2>
<div>A tree is a connected undirected graph with $ n-1 $ edges, where $ n $ denotes the number of vertices. Vertices are numbered $ 1 $ through $ n $ .
Limak is a little polar bear. His bear family prepares a New Year tree every year. One year ago their tree was more awesome than usually. Thus, they decided to prepare the same tree in the next year. Limak was responsible for remembering that tree.
It would be hard to remember a whole tree. Limak decided to describe it in his notebook instead. He took a pen and wrote $ n-1 $ lines, each with two integers — indices of two vertices connected by an edge.
Now, the New Year is just around the corner and Limak is asked to reconstruct that tree. Of course, there is a problem. He was a very little bear a year ago, and he didn't know digits and the alphabet, so he just replaced each digit with a question mark — the only character he knew. That means, for any vertex index in his notes he knows only the number of digits in it. At least he knows there were no leading zeroes.
Limak doesn't want to disappoint everyone. Please, take his notes and reconstruct a New Year tree. Find any tree matching Limak's records and print its edges in any order. It's also possible that Limak made a mistake and there is no suitable tree – in this case print "-1" (without the quotes).</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains a single integer $ n $ ( $ 2<=n<=200000 $ ) — the number of vertices.
Each of the next $ n-1 $ lines contains two space-separated non-empty strings, both consisting of questions marks only. No string has more characters than the number of digits in $ n $ .</div>
<h3>输出格式</h3>
<br />
<div>If there is no tree matching Limak's records, print the only line with "-1" (without the quotes).
Otherwise, describe any tree matching Limak's notes. Print $ n-1 $ lines, each with two space-separated integers – indices of vertices connected by an edge. You can print edges in any order.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>12
? ?
? ?
? ?
? ??
?? ?
?? ??
? ??
? ?
? ?
? ?
? ?
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>3 1
1 6
9 1
2 10
1 7
8 1
1 4
1 10
5 1
10 11
12 1
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>12
?? ??
? ?
? ?
? ??
?? ?
?? ??
? ??
? ?
? ?
?? ??
? ?
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>-1
</code></pre>
</article>
</div>
</div>
</body>
</html>
