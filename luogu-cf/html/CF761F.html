<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Dasha and Photos - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573397561:IzoLvAV7n0r8WR3hWGdH8q8nt0L66qWrcAljzxBtK3w=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Dasha%20decided%20to%20have%20a%20rest%20after%20solving%20the%20problem%20%24%20D%20%24%20and%20began%20to%20look%20photos%20from%20previous%20competitions.%5Cn%5CnLet%27s%20call%20photos%20as%20the%20matrix%20with%20the%20size%20%24%20n%5Cu00d7m%20%24%20%2C%20which%20consists%20of%20lowercase%20English%20letters.%5Cn%5CnSome%20%24%20k%20%24%20photos%20especially%20interested%20her%2C%20because%20they%20can%20be%20received%20from%20photo-template%20by%20painting%20a%20rectangular%20area%20in%20a%20certain%20color.%20Let%27s%20call%20such%20photos%20special.%5Cn%5Cn%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF761F%5C%2Fff915ee1c7a85910e49e0252b0f437800b1b420a.png%29More%20formally%20the%20%24%20i%20%24%20-th%20special%20photo%20is%20received%20from%20the%20photo-template%20by%20replacing%20all%20characters%20on%20some%20rectangle%20with%20upper%20left%20corner%20of%20the%20cell%20with%20coordinates%20%24%20%28a_%7Bi%7D%2Cb_%7Bi%7D%29%20%24%20and%20lower%20right%20corner%20in%20the%20cell%20with%20coordinates%20%24%20%28c_%7Bi%7D%2Cd_%7Bi%7D%29%20%24%20to%20the%20symbol%20%24%20e_%7Bi%7D%20%24%20.%5Cn%5CnDasha%20asks%20you%20to%20find%20the%20special%20photo%20so%20that%20the%20total%20distance%20from%20it%20to%20all%20other%20special%20photos%20is%20minimum.%20And%20calculate%20this%20distance.%5Cn%5CnDetermine%20the%20distance%20between%20two%20photos%20as%20the%20sum%20of%20distances%20between%20all%20corresponding%20letters.%20The%20distance%20between%20two%20letters%20is%20the%20difference%20module%20of%20their%20positions%20in%20the%20alphabet.%20For%20example%2C%20the%20distance%20between%20letters%20%27h%27%20and%20%27m%27%20equals%20%24%20%7C8-13%7C%3D5%20%24%20%2C%20because%20the%20letter%20%27h%27%20is%20the%208-th%20in%20the%20alphabet%2C%20the%20letter%20%27m%27%20is%20the%2013-th.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20three%20integers%20%24%20n%20%24%20%2C%20%24%20m%20%24%20%2C%20%24%20k%20%24%20%24%20%281%3C%3Dn%2Cm%3C%3D10%5E%7B3%7D%2C1%3C%3Dk%3C%3D3%5Cu00b710%5E%7B5%7D%29%20%24%20%5Cu2014%20the%20number%20of%20strings%20in%20the%20photo-template%2C%20the%20number%20of%20columns%20and%20the%20number%20of%20special%20photos%20which%20are%20interesting%20for%20Dasha.%5Cn%5CnThe%20next%20%24%20n%20%24%20lines%20contains%20the%20string%20with%20%24%20m%20%24%20length%20which%20consists%20of%20little%20Latin%20characters%20%5Cu2014%20the%20description%20of%20the%20photo-template.%5Cn%5CnEach%20of%20the%20next%20%24%20k%20%24%20lines%20contains%20the%20description%20of%20the%20special%20photo%20in%20the%20following%20format%2C%20%5C%22%20%24%20a_%7Bi%7D%20%24%20%24%20b_%7Bi%7D%20%24%20%24%20c_%7Bi%7D%20%24%20%24%20d_%7Bi%7D%20%24%20%24%20e_%7Bi%7D%20%24%20%5C%22%20%24%20%281%3C%3Da_%7Bi%7D%3C%3Dc_%7Bi%7D%3C%3Dn%2C1%3C%3Db_%7Bi%7D%3C%3Dd_%7Bi%7D%3C%3Dm%29%20%24%20%2C%20where%20%24%20%28a_%7Bi%7D%2Cb_%7Bi%7D%29%20%24%20%5Cu2014%20is%20the%20coordinate%20of%20the%20upper%20left%20corner%20of%20the%20rectangle%2C%20%24%20%28c_%7Bi%7D%2Cd_%7Bi%7D%29%20%24%20%5Cu2014%20is%20the%20description%20of%20the%20lower%20right%20corner%2C%20and%20%24%20e_%7Bi%7D%20%24%20%5Cu2014%20is%20the%20little%20Latin%20letter%20which%20replaces%20the%20photo-template%20in%20the%20described%20rectangle.%22%2C%22outputFormat%22%3A%22In%20the%20only%20line%20print%20the%20minimum%20total%20distance%20from%20the%20found%20special%20photo%20to%20all%20other%20special%20photos.%22%2C%22samples%22%3A%5B%5B%223%203%202%5Cnaaa%5Cnaaa%5Cnaaa%5Cn1%201%202%202%20b%5Cn2%202%203%203%20c%5Cn%22%2C%2210%5Cn%22%5D%2C%5B%225%205%203%5Cnabcde%5Cneabcd%5Cndeabc%5Cncdeab%5Cnbcdea%5Cn1%201%203%204%20f%5Cn1%202%203%203%20e%5Cn1%203%203%204%20i%5Cn%22%2C%2259%5Cn%22%5D%5D%2C%22hint%22%3A%22In%20the%20first%20example%20the%20photos%20are%20following%3A%5Cn%5Cn%60%3Cbr%3E%3C%5C%2Fbr%3Ebba%20%20%20%20aaa%3Cbr%3E%3C%5C%2Fbr%3Ebba%20%20%20%20acc%3Cbr%3E%3C%5C%2Fbr%3Eaaa%20%20%20%20acc%3Cbr%3E%3C%5C%2Fbr%3E%60The%20distance%20between%20them%20is%20%24%2010%20%24%20.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B4000%5D%2C%22memory%22%3A%5B512000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F761%5C%2FF%22%2C%22id%22%3A%22761F%22%7D%2C%22translation%22%3A%22%23%23%23%20%5Cu9898%5Cu76ee%5Cu5927%5Cu610f%5Cr%5Cn%5Cu7ed9%5Cu4f60%5Cu4e00%5Cu4e2a%24n%5C%5Ctimes%20m%24%5Cu7684%5Cu65b9%5Cu683c%5Cuff0c%20%5Cu6bcf%5Cu4e2a%5Cu683c%5Cu5b50%5Cu91cc%5Cu6709%5Cu4e00%5Cu4e2a%5Cu5c0f%5Cu5199%5Cu82f1%5Cu6587%5Cu5b57%5Cu6bcd%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu73b0%5Cu5728%5Cu4f60%5Cu6709%24k%24%5Cu4e2a%24n%5C%5Ctimes%20m%24%5Cu7684%5Cu65b9%5Cu683c%5Cuff0c%20%5Cu8fd9%5Cu4e9b%5Cu65b9%5Cu683c%5Cu90fd%5Cu662f%5Cu5728%5Cu7ed9%5Cu51fa%5Cu65b9%5Cu683c%5Cu7684%5Cu57fa%5Cu7840%5Cu4e0a%5Cu5c06%5Cu4e00%5Cu4e2a%5Cu77e9%5Cu5f62%5Cu533a%5Cu57df%5Cu7684%5Cu65b9%5Cu683c%5Cu4e2d%5Cu7684%5Cu5b57%5Cu6bcd%5Cu5168%5Cu90e8%5Cu53d8%5Cu6210%5Cu4e00%5Cu79cd%5Cu5f97%5Cu5230%5Cu7684%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu5b9a%5Cu4e49%5Cu4e24%5Cu4e2a%5Cu65b9%5Cu683c%5Cu7684%5Cu8ddd%5Cu79bb%5Cu4e3a%5Cu6240%5Cu6709%5Cu683c%5Cu5b50%5Cu4e2d%5Cu5b57%5Cu6bcd%5Cu5728%5Cu5b57%5Cu6bcd%5Cu8868%5Cu4e2d%5Cu4f4d%5Cu7f6e%5Cu7684%5Cu5dee%5Cu3002%20%5Cu4f60%5Cu8981%5Cu627e%5Cu5230%24k%24%5Cu4e2a%5Cu65b9%5Cu683c%5Cu4e2d%5Cu7684%5Cu4e00%5Cu4e2a%5Cu65b9%5Cu683c%5Cuff0c%20%5Cu6ee1%5Cu8db3%5Cu5b83%5Cu5230%5Cu5176%5Cu4ed6%24k-1%24%5Cu4e2a%5Cu77e9%5Cu9635%5Cu7684%5Cu8ddd%5Cu79bb%5Cu4e4b%5Cu548c%5Cu6700%5Cu5c0f%5Cuff0c%20%5Cu5e76%5Cu8f93%5Cu51fa%5Cu8fd9%5Cu4e2a%5Cu6700%5Cu5c0f%5Cu503c%5Cu3002%5Cr%5Cn%5Cr%5Cn%23%23%23%20%5Cu8f93%5Cu5165%5Cu8f93%5Cu51fa%5Cu683c%5Cu5f0f%5Cr%5Cn%23%23%23%23%20%5Cu8f93%5Cu5165%5Cu683c%5Cu5f0f%5Cr%5Cn%5Cu7b2c%5Cu4e00%5Cu884c%5Cu4e09%5Cu4e2a%5Cu6b63%5Cu6574%5Cu6570%24n%2C%20m%2C%20k%24%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu4ee5%5Cu4e0b%24n%24%5Cu884c%5Cuff0c%20%5Cu6bcf%5Cu884c%24m%24%5Cu4e2a%5Cu5c0f%5Cu5199%5Cu5b57%5Cu6bcd%5Cuff0c%5Cu8868%5Cu793a%5Cu539f%5Cu59cb%5Cu65b9%5Cu683c%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu4ee5%5Cu4e0b%24k%24%5Cu884c%5Cuff0c%20%5Cu6bcf%5Cu884c%244%24%5Cu4e2a%5Cu6b63%5Cu6574%5Cu6570%24a_i%2Cb_i%2Cc_i%2Cd_i%24%5Cu548c%5Cu4e00%5Cu4e2a%5Cu5b57%5Cu7b26%24ch%24%5Cuff0c%20%5Cu8868%5Cu793a%5Cu8fd9%5Cu4e2a%5Cu65b9%5Cu683c%5Cu662f%5Cu5c06%5Cu539f%5Cu59cb%5Cu65b9%5Cu683c%5Cu5de6%5Cu4e0a%5Cu89d2%5Cu4e3a%24a_i%24%5Cu884c%24b_i%24%5Cu5217%5Cu7684%5Cu683c%5Cu5b50%5Cu3001%20%5Cu53f3%5Cu4e0b%5Cu89d2%5Cu4e3a%24c_i%24%5Cu884c%24d_i%24%5Cu5217%5Cu7684%5Cu683c%5Cu5b50%5Cu4e2d%5Cu7684%5Cu5b57%5Cu6bcd%5Cu5168%5Cu90e8%5Cu66ff%5Cu6362%5Cu6210%24ch%24%5Cu5f97%5Cu5230%5Cu7684%5Cu3002%5Cr%5Cn%23%23%23%23%20%5Cu8f93%5Cu51fa%5Cu683c%5Cu5f0f%5Cr%5Cn%5Cu8f93%5Cu51fa%5Cu4e00%5Cu884c%5Cu4e00%5Cu4e2a%5Cu6574%5Cu6570%5Cuff0c%20%5Cu8868%5Cu793a%5Cu6700%5Cu5c0f%5Cu7684%5Cu8ddd%5Cu79bb%5Cu4e4b%5Cu548c%5Cu3002%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A6%2C%22totalAccepted%22%3A2%2C%22pid%22%3A%22CF761F%22%2C%22title%22%3A%22Dasha%20and%20Photos%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Dasha%20and%20Photos%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573306449;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Dasha and Photos</h1>
<h2>题意翻译</h2>
<div>### 题目大意
给你一个$n\times m$的方格， 每个格子里有一个小写英文字母。
现在你有$k$个$n\times m$的方格， 这些方格都是在给出方格的基础上将一个矩形区域的方格中的字母全部变成一种得到的。
定义两个方格的距离为所有格子中字母在字母表中位置的差。 你要找到$k$个方格中的一个方格， 满足它到其他$k-1$个矩阵的距离之和最小， 并输出这个最小值。
### 输入输出格式
#### 输入格式
第一行三个正整数$n, m, k$。
以下$n$行， 每行$m$个小写字母，表示原始方格。
以下$k$行， 每行$4$个正整数$a_i,b_i,c_i,d_i$和一个字符$ch$， 表示这个方格是将原始方格左上角为$a_i$行$b_i$列的格子、 右下角为$c_i$行$d_i$列的格子中的字母全部替换成$ch$得到的。
#### 输出格式
输出一行一个整数， 表示最小的距离之和。</div>
<h2>题目描述</h2>
<div>Dasha decided to have a rest after solving the problem $ D $ and began to look photos from previous competitions.
Let's call photos as the matrix with the size $ n×m $ , which consists of lowercase English letters.
Some $ k $ photos especially interested her, because they can be received from photo-template by painting a rectangular area in a certain color. Let's call such photos special.
![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF761F/ff915ee1c7a85910e49e0252b0f437800b1b420a.png)More formally the $ i $ -th special photo is received from the photo-template by replacing all characters on some rectangle with upper left corner of the cell with coordinates $ (a_{i},b_{i}) $ and lower right corner in the cell with coordinates $ (c_{i},d_{i}) $ to the symbol $ e_{i} $ .
Dasha asks you to find the special photo so that the total distance from it to all other special photos is minimum. And calculate this distance.
Determine the distance between two photos as the sum of distances between all corresponding letters. The distance between two letters is the difference module of their positions in the alphabet. For example, the distance between letters 'h' and 'm' equals $ |8-13|=5 $ , because the letter 'h' is the 8-th in the alphabet, the letter 'm' is the 13-th.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains three integers $ n $ , $ m $ , $ k $ $ (1<=n,m<=10^{3},1<=k<=3·10^{5}) $ — the number of strings in the photo-template, the number of columns and the number of special photos which are interesting for Dasha.
The next $ n $ lines contains the string with $ m $ length which consists of little Latin characters — the description of the photo-template.
Each of the next $ k $ lines contains the description of the special photo in the following format, " $ a_{i} $ $ b_{i} $ $ c_{i} $ $ d_{i} $ $ e_{i} $ " $ (1<=a_{i}<=c_{i}<=n,1<=b_{i}<=d_{i}<=m) $ , where $ (a_{i},b_{i}) $ — is the coordinate of the upper left corner of the rectangle, $ (c_{i},d_{i}) $ — is the description of the lower right corner, and $ e_{i} $ — is the little Latin letter which replaces the photo-template in the described rectangle.</div>
<h3>输出格式</h3>
<br />
<div>In the only line print the minimum total distance from the found special photo to all other special photos.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>3 3 2
aaa
aaa
aaa
1 1 2 2 b
2 2 3 3 c
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>10
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>5 5 3
abcde
eabcd
deabc
cdeab
bcdea
1 1 3 4 f
1 2 3 3 e
1 3 3 4 i
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>59
</code></pre>
<h2>说明</h2>
<div>In the first example the photos are following:
`<br></br>bba aaa<br></br>bba acc<br></br>aaa acc<br></br>`The distance between them is $ 10 $ .</div>
</article>
</div>
</div>
</body>
</html>
