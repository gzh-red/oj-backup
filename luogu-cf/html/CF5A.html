<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Chat Server&#039;s Outgoing Traffic - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573389865:GYF23+HlGccjWWg2tHXyHvr4kZPiA+E/t6RDRu1Z8R0=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%22%2C%22description%22%3A%22Polycarp%20is%20working%20on%20a%20new%20project%20called%20%5C%22Polychat%5C%22.%20Following%20modern%20tendencies%20in%20IT%2C%20he%20decided%2C%20that%20this%20project%20should%20contain%20chat%20as%20well.%20To%20achieve%20this%20goal%2C%20Polycarp%20has%20spent%20several%20hours%20in%20front%20of%20his%20laptop%20and%20implemented%20a%20chat%20server%20that%20can%20process%20three%20types%20of%20commands%3A%5Cn%5Cn-%20Include%20a%20person%20to%20the%20chat%20%28%27Add%27%20command%29.%5Cn-%20Remove%20a%20person%20from%20the%20chat%20%28%27Remove%27%20command%29.%5Cn-%20Send%20a%20message%20from%20a%20person%20to%20all%20people%2C%20who%20are%20currently%20in%20the%20chat%2C%20including%20the%20one%2C%20who%20sends%20the%20message%20%28%27Send%27%20command%29.%5Cn%5CnNow%20Polycarp%20wants%20to%20find%20out%20the%20amount%20of%20outgoing%20traffic%20that%20the%20server%20will%20produce%20while%20processing%20a%20particular%20set%20of%20commands.%5Cn%5CnPolycarp%20knows%20that%20chat%20server%20sends%20no%20traffic%20for%20%27Add%27%20and%20%27Remove%27%20commands.%20When%20%27Send%27%20command%20is%20processed%2C%20server%20sends%20%24%20l%20%24%20bytes%20to%20each%20participant%20of%20the%20chat%2C%20where%20%24%20l%20%24%20is%20the%20length%20of%20the%20message.%5Cn%5CnAs%20Polycarp%20has%20no%20time%2C%20he%20is%20asking%20for%20your%20help%20in%20solving%20this%20problem.%22%2C%22inputFormat%22%3A%22Input%20file%20will%20contain%20not%20more%20than%20100%20commands%2C%20each%20in%20its%20own%20line.%20No%20line%20will%20exceed%20100%20characters.%20Formats%20of%20the%20commands%20will%20be%20the%20following%3A%5Cn%5Cn-%20%2B%3Cname%3E%20for%20%27Add%27%20command.%5Cn-%20-%3Cname%3E%20for%20%27Remove%27%20command.%5Cn-%20%3Csender%5C%5C_name%3E%3A%3Cmessage%5C%5C_text%3E%20for%20%27Send%27%20command.%5Cn%5Cn%3Cname%3E%20and%20%3Csender%5C%5C_name%3E%20is%20a%20non-empty%20sequence%20of%20Latin%20letters%20and%20digits.%20%3Cmessage%5C%5C_text%3E%20can%20contain%20letters%2C%20digits%20and%20spaces%2C%20but%20can%27t%20start%20or%20end%20with%20a%20space.%20%3Cmessage%5C%5C_text%3E%20can%20be%20an%20empty%20line.%5Cn%5CnIt%20is%20guaranteed%2C%20that%20input%20data%20are%20correct%2C%20i.e.%20there%20will%20be%20no%20%27Add%27%20command%20if%20person%20with%20such%20a%20name%20is%20already%20in%20the%20chat%2C%20there%20will%20be%20no%20%27Remove%27%20command%20if%20there%20is%20no%20person%20with%20such%20a%20name%20in%20the%20chat%20etc.%5Cn%5CnAll%20names%20are%20case-sensitive.%22%2C%22outputFormat%22%3A%22Print%20a%20single%20number%20%5Cu2014%20answer%20to%20the%20problem.%22%2C%22samples%22%3A%5B%5B%22%2BMike%5CnMike%3Ahello%5Cn%2BKate%5Cn%2BDmitry%5Cn-Dmitry%5CnKate%3Ahi%5Cn-Kate%5Cn%22%2C%229%5Cn%22%5D%2C%5B%22%2BMike%5Cn-Mike%5Cn%2BMike%5CnMike%3AHi%20%20%20I%20am%20here%5Cn-Mike%5Cn%2BKate%5Cn-Kate%5Cn%22%2C%2214%5Cn%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%5D%2C%22memory%22%3A%5B64000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F5%5C%2FA%22%2C%22id%22%3A%225A%22%7D%2C%22translation%22%3A%22Polycarp%5Cu6b63%5Cu5728%5Cu5f00%5Cu53d1%5Cu4e00%5Cu4e2a%5Cu540d%5Cu4e3a%5Cu201cPolychat%5Cu201d%5Cu7684%5Cu65b0%5Cu9879%5Cu76ee%5Cu3002%5Cu6309%5Cu7167IT%5Cu7684%5Cu73b0%5Cu4ee3%5Cu503e%5Cu5411%5Cuff0c%5Cu4ed6%5Cu51b3%5Cu5b9a%5Cuff0c%5Cu8fd9%5Cu4e2a%5Cu9879%5Cu76ee%5Cu4e5f%5Cu5e94%5Cu8be5%5Cu5305%5Cu542b%5Cu804a%5Cu5929%5Cu3002%5Cu4e3a%5Cu4e86%5Cu5b9e%5Cu73b0%5Cu8fd9%5Cu4e00%5Cu76ee%5Cu6807%5Cuff0cPolycarp%5Cu5728%5Cu7b14%5Cu8bb0%5Cu672c%5Cu7535%5Cu8111%5Cu524d%5Cu82b1%5Cu8d39%5Cu4e86%5Cu51e0%5Cu4e2a%5Cu5c0f%5Cu65f6%5Cuff0c%5Cu5b9e%5Cu73b0%5Cu4e86%5Cu4e00%5Cu4e2a%5Cu53ef%5Cu4ee5%5Cu5904%5Cu7406%5Cu4e09%5Cu79cd%5Cu547d%5Cu4ee4%5Cu7684%5Cu804a%5Cu5929%5Cu670d%5Cu52a1%5Cu5668%5Cuff1a%5Cn%5Cn%5Cu5c06%5Cu4e00%5Cu4e2a%5Cu4eba%5Cu52a0%5Cu5165%5Cu804a%5Cu5929%5Cuff08%5Cu201c%5Cu6dfb%5Cu52a0%5Cu201d%5Cu547d%5Cu4ee4%5Cuff09%5Cu3002%5Cn%5Cn%5Cu4ece%5Cu804a%5Cu5929%5Cu4e2d%5Cu5220%5Cu9664%5Cu4e00%5Cu4e2a%5Cu4eba%5Cuff08%5Cu201c%5Cu5220%5Cu9664%5Cu201d%5Cu547d%5Cu4ee4%5Cuff09%5Cu3002%5Cn%5Cn%5Cu5411%5Cu6240%5Cu6709%5Cu6b63%5Cu5728%5Cu804a%5Cu5929%5Cu7684%5Cu4eba%5Cu53d1%5Cu9001%5Cu6d88%5Cu606f%5Cuff0c%5Cu5305%5Cu62ec%5Cu53d1%5Cu9001%5Cu6d88%5Cu606f%5Cu7684%5Cu4eba%5Cuff08%5Cu201c%5Cu53d1%5Cu9001%5Cu201d%5Cu547d%5Cu4ee4%5Cuff09%5Cu3002%5Cn%5Cn%5Cu73b0%5Cu5728%5Cuff0cPolycarp%5Cu5e0c%5Cu671b%5Cu4e86%5Cu89e3%5Cu5904%5Cu7406%5Cu7279%5Cu5b9a%5Cu547d%5Cu4ee4%5Cu96c6%5Cu65f6%5Cu670d%5Cu52a1%5Cu5668%5Cu5c06%5Cu4ea7%5Cu751f%5Cu7684%5Cu4f20%5Cu51fa%5Cu6d41%5Cu91cf%5Cu3002%5Cn%5CnPolycarp%5Cu77e5%5Cu9053%5Cu804a%5Cu5929%5Cu670d%5Cu52a1%5Cu5668%5Cu4e0d%5Cu4f1a%5Cu4e3a%5Cu201c%5Cu6dfb%5Cu52a0%5Cu201d%5Cu548c%5Cu201c%5Cu5220%5Cu9664%5Cu201d%5Cu547d%5Cu4ee4%5Cu53d1%5Cu9001%5Cu6d41%5Cu91cf%5Cu3002%5Cu5f53%5Cu5904%5Cu7406%5Cu201c%5Cu53d1%5Cu9001%5Cu201d%5Cu547d%5Cu4ee4%5Cu65f6%5Cuff0c%5Cu670d%5Cu52a1%5Cu5668%5Cu5411%5Cu804a%5Cu5929%5Cu7684%5Cu6bcf%5Cu4e2a%5Cu53c2%5Cu4e0e%5Cu8005%28%5Cu5f53%5Cu524d%5Cu5728%5Cu7ebf%5Cu7684%5Cu4eba%29%5Cu53d1%5Cu9001l%5Cu4e2a%5Cu5b57%5Cu8282%5Cuff0c%5Cu5176%5Cu4e2dl%5Cu662f%5Cu6d88%5Cu606f%5Cu7684%5Cu957f%5Cu5ea6%5Cu3002%5Cn%5Cn%5Cu7531%5Cu4e8ePolycarp%5Cu6ca1%5Cu6709%5Cu65f6%5Cu95f4%5Cuff0c%5Cu4ed6%5Cu5728%5Cu5bfb%5Cu6c42%5Cu5e2e%5Cu52a9%5Cu6765%5Cu89e3%5Cu51b3%5Cu8fd9%5Cu4e2a%5Cu95ee%5Cu9898%5Cu3002%5Cn%5Cn%5Cu8f93%5Cu5165%5Cu683c%5Cu5f0f%5Cn%5Cn%5Cu8f93%5Cu5165%5Cu6587%5Cu4ef6%5Cu5c06%5Cu5305%5Cu542b%5Cu4e0d%5Cu8d85%5Cu8fc7100%5Cu4e2a%5Cu547d%5Cu4ee4%5Cuff0c%5Cu6bcf%5Cu4e2a%5Cu547d%5Cu4ee4%5Cu90fd%5Cu5728%5Cu81ea%5Cu5df1%5Cu7684%5Cu884c%5Cu4e2d%5Cu3002%5Cu6bcf%5Cu884c%5Cu4e0d%5Cu8d85%5Cu8fc7100%5Cu4e2a%5Cu5b57%5Cu7b26%5Cu3002%5Cu547d%5Cu4ee4%5Cu7684%5Cu683c%5Cu5f0f%5Cu5982%5Cu4e0b%5Cuff1a%5Cn%5Cn%2B%3C%5Cu540d%5Cu79f0%3E%5Cu4e3a%5Cu201c%5Cu6dfb%5Cu52a0%5Cu201d%5Cu547d%5Cu4ee4%5Cu3002%5Cn-%3C%5Cu540d%5Cu79f0%3E%5Cu4e3a%5Cu201c%5Cu5220%5Cu9664%5Cu201d%5Cu547d%5Cu4ee4%5Cu3002%5Cn%3CSENDER_NAME%3E%5Cuff1a%3CMESSAGE_TEXT%3E%5Cu4e3a%27%5Cu53d1%5Cu9001%27%5Cu547d%5Cu4ee4%5Cu3002%5Cn%5Cn%3Cname%3E%28%5Cu540d%5Cu5b57%29%5Cu548c%3Csender_name%3E%5Cu662f%5Cu62c9%5Cu4e01%5Cu5b57%5Cu6bcd%5Cu548c%5Cu6570%5Cu5b57%5Cu7684%5Cu975e%5Cu7a7a%5Cu5e8f%5Cu5217%5Cu3002%3Cmessage_text%3E%5Cu53ef%5Cu4ee5%5Cu5305%5Cu542b%5Cu5b57%5Cu6bcd%5Cuff0c%5Cu6570%5Cu5b57%5Cu548c%5Cu7a7a%5Cu683c%5Cuff0c%5Cu4f46%5Cu4e0d%5Cu80fd%5Cu4ee5%5Cu7a7a%5Cu683c%5Cu5f00%5Cu59cb%5Cu6216%5Cu7ed3%5Cu675f%3Cmessage_text%3E%5Cu662f%5Cu4e00%5Cu4e2a%5Cu7a7a%5Cu884c%5Cu3002%5Cn%5Cn%5Cu4fdd%5Cu8bc1%5Cu8f93%5Cu5165%5Cu6570%5Cu636e%5Cu662f%5Cu6b63%5Cu786e%5Cu7684%5Cuff0c%5Cu5373%5Cu4e0d%5Cu4f1a%5Cu6709%5Cu201c%5Cu6dfb%5Cu52a0%5Cu201d%5Cu547d%5Cu4ee4%5Cuff0c%5Cu5982%5Cu679c%5Cu4eba%5Cu7528%5Cu8fd9%5Cu6837%5Cu7684%5Cu540d%5Cu5b57%5Cu5df2%5Cu7ecf%5Cu5728%5Cu804a%5Cu5929%5Cuff0c%5Cu4e0d%5Cu4f1a%5Cu6709%5Cu201c%5Cu5220%5Cu9664%5Cu201d%5Cu547d%5Cu4ee4%5Cuff0c%5Cu5982%5Cu679c%5Cu6ca1%5Cu6709%5Cu4eba%5Cu8ddf%5Cu5728%5Cu8fd9%5Cu6837%5Cu7684%5Cu540d%5Cu5b57%5Cu804a%5Cu5929%5Cu7b49%5Cn%5Cn%5Cu6240%5Cu6709%5Cu7684%5Cu540d%5Cu5b57%5Cu90fd%5Cu662f%5Cu533a%5Cu5206%5Cu5927%5Cu5c0f%5Cu5199%5Cu7684%5Cu3002%5Cn%5Cn%5Cu8f93%5Cu51fa%5Cu683c%5Cu5f0f%5Cn%5Cn%5Cu8f93%5Cu51fa%5Cu6d41%5Cu91cf%5Cn%5CnTranslated%20by%20%40liyifeng%20%22%2C%22tags%22%3A%5B1%2C2%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A213%2C%22totalAccepted%22%3A126%2C%22pid%22%3A%22CF5A%22%2C%22title%22%3A%22Chat%20Server%27s%20Outgoing%20Traffic%22%2C%22difficulty%22%3A2%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A136983%2C%22title%22%3A%22%5Cu8fd9%5Cu9053%5Cu9898%5Cu600e%5Cu4e48%5Cu8f93%5Cu51fa%5Cu7b54%5Cu6848%22%2C%22forum%22%3A%7B%22id%22%3A12695%2C%22name%22%3A%22CF5A%20Chat%20Server%27s%20Outgoing%20Traffic%22%2C%22slug%22%3A%22CF5A%22%7D%7D%2C%7B%22id%22%3A59200%2C%22title%22%3A%22%5Cu867d%5Cu7136%5Cu8fc7%5Cu4e86%5Cuff0c%5Cu4f46%5Cu8fd8%5Cu662f%5Cu8981%5Cu95ee%5Cu4e00%5Cu4e0b%22%2C%22forum%22%3A%7B%22id%22%3A12695%2C%22name%22%3A%22CF5A%20Chat%20Server%27s%20Outgoing%20Traffic%22%2C%22slug%22%3A%22CF5A%22%7D%7D%2C%7B%22id%22%3A32311%2C%22title%22%3A%22%5Cu7ffb%5Cu8bd1%22%2C%22forum%22%3A%7B%22id%22%3A12695%2C%22name%22%3A%22CF5A%20Chat%20Server%27s%20Outgoing%20Traffic%22%2C%22slug%22%3A%22CF5A%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22CF7A%22%2C%22title%22%3A%22Kalevitch%20and%20Chess%22%2C%22difficulty%22%3A2%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF6C%22%2C%22title%22%3A%22Alice%2C%20Bob%20and%20Chocolate%22%2C%22difficulty%22%3A2%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF6B%22%2C%22title%22%3A%22President%27s%20Office%22%2C%22difficulty%22%3A2%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF6A%22%2C%22title%22%3A%22Triangle%22%2C%22difficulty%22%3A1%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF5B%22%2C%22title%22%3A%22Center%20Alignment%22%2C%22difficulty%22%3A2%2C%22type%22%3A%22CF%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Chat%20Server%27s%20Outgoing%20Traffic%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573286098;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Chat Server&#039;s Outgoing Traffic</h1>
<h2>题意翻译</h2>
<div>Polycarp正在开发一个名为“Polychat”的新项目。按照IT的现代倾向，他决定，这个项目也应该包含聊天。为了实现这一目标，Polycarp在笔记本电脑前花费了几个小时，实现了一个可以处理三种命令的聊天服务器：
将一个人加入聊天（“添加”命令）。
从聊天中删除一个人（“删除”命令）。
向所有正在聊天的人发送消息，包括发送消息的人（“发送”命令）。
现在，Polycarp希望了解处理特定命令集时服务器将产生的传出流量。
Polycarp知道聊天服务器不会为“添加”和“删除”命令发送流量。当处理“发送”命令时，服务器向聊天的每个参与者(当前在线的人)发送l个字节，其中l是消息的长度。
由于Polycarp没有时间，他在寻求帮助来解决这个问题。
输入格式
输入文件将包含不超过100个命令，每个命令都在自己的行中。每行不超过100个字符。命令的格式如下：
+<名称>为“添加”命令。
-<名称>为“删除”命令。
<SENDER_NAME>：<MESSAGE_TEXT>为'发送'命令。
<name>(名字)和<sender_name>是拉丁字母和数字的非空序列。<message_text>可以包含字母，数字和空格，但不能以空格开始或结束<message_text>是一个空行。
保证输入数据是正确的，即不会有“添加”命令，如果人用这样的名字已经在聊天，不会有“删除”命令，如果没有人跟在这样的名字聊天等
所有的名字都是区分大小写的。
输出格式
输出流量
Translated by @liyifeng </div>
<h2>题目描述</h2>
<div>Polycarp is working on a new project called "Polychat". Following modern tendencies in IT, he decided, that this project should contain chat as well. To achieve this goal, Polycarp has spent several hours in front of his laptop and implemented a chat server that can process three types of commands:
- Include a person to the chat ('Add' command).
- Remove a person from the chat ('Remove' command).
- Send a message from a person to all people, who are currently in the chat, including the one, who sends the message ('Send' command).
Now Polycarp wants to find out the amount of outgoing traffic that the server will produce while processing a particular set of commands.
Polycarp knows that chat server sends no traffic for 'Add' and 'Remove' commands. When 'Send' command is processed, server sends $ l $ bytes to each participant of the chat, where $ l $ is the length of the message.
As Polycarp has no time, he is asking for your help in solving this problem.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>Input file will contain not more than 100 commands, each in its own line. No line will exceed 100 characters. Formats of the commands will be the following:
- +<name> for 'Add' command.
- -<name> for 'Remove' command.
- <sender\_name>:<message\_text> for 'Send' command.
<name> and <sender\_name> is a non-empty sequence of Latin letters and digits. <message\_text> can contain letters, digits and spaces, but can't start or end with a space. <message\_text> can be an empty line.
It is guaranteed, that input data are correct, i.e. there will be no 'Add' command if person with such a name is already in the chat, there will be no 'Remove' command if there is no person with such a name in the chat etc.
All names are case-sensitive.</div>
<h3>输出格式</h3>
<br />
<div>Print a single number — answer to the problem.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>+Mike
Mike:hello
+Kate
+Dmitry
-Dmitry
Kate:hi
-Kate
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>9
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>+Mike
-Mike
+Mike
Mike:Hi   I am here
-Mike
+Kate
-Kate
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>14
</code></pre>
</article>
</div>
</div>
</body>
</html>
