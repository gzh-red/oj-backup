<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Till I Collapse - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573397859:PAXRoO1EwWdqfw0bkwu5yIsOnukJZ3as8g6bElhLYII=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Rick%20and%20Morty%20want%20to%20find%20MR.%20PBH%20and%20they%20can%27t%20do%20it%20alone.%20So%20they%20need%20of%20Mr.%20Meeseeks.%20They%20Have%20generated%20%24%20n%20%24%20Mr.%20Meeseeks%2C%20standing%20in%20a%20line%20numbered%20from%20%24%201%20%24%20to%20%24%20n%20%24%20.%20Each%20of%20them%20has%20his%20own%20color.%20%24%20i%20%24%20-th%20Mr.%20Meeseeks%27%20color%20is%20%24%20a_%7Bi%7D%20%24%20.%5Cn%5CnRick%20and%20Morty%20are%20gathering%20their%20army%20and%20they%20want%20to%20divide%20Mr.%20Meeseeks%20into%20some%20squads.%20They%20don%27t%20want%20their%20squads%20to%20be%20too%20colorful%2C%20so%20each%20squad%20should%20have%20Mr.%20Meeseeks%20of%20at%20most%20%24%20k%20%24%20different%20colors.%20Also%20each%20squad%20should%20be%20a%20continuous%20subarray%20of%20Mr.%20Meeseeks%20in%20the%20line.%20Meaning%20that%20for%20each%20%24%201%3C%3Di%3C%3De%3C%3Dj%3C%3Dn%20%24%20%2C%20if%20Mr.%20Meeseeks%20number%20%24%20i%20%24%20and%20Mr.%20Meeseeks%20number%20%24%20j%20%24%20are%20in%20the%20same%20squad%20then%20Mr.%20Meeseeks%20number%20%24%20e%20%24%20should%20be%20in%20that%20same%20squad.%5Cn%5Cn%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF786C%5C%2Ff2b873f46d1ce1d5117f05fee6c23499da101533.png%29Also%2C%20each%20squad%20needs%20its%20own%20presidio%2C%20and%20building%20a%20presidio%20needs%20money%2C%20so%20they%20want%20the%20total%20number%20of%20squads%20to%20be%20minimized.%5Cn%5CnRick%20and%20Morty%20haven%27t%20finalized%20the%20exact%20value%20of%20%24%20k%20%24%20%2C%20so%20in%20order%20to%20choose%20it%2C%20for%20each%20%24%20k%20%24%20between%20%24%201%20%24%20and%20%24%20n%20%24%20%28inclusive%29%20need%20to%20know%20the%20minimum%20number%20of%20presidios%20needed.%22%2C%22inputFormat%22%3A%22The%20first%20line%20of%20input%20contains%20a%20single%20integer%20%24%20n%20%24%20%28%20%24%201%3C%3Dn%3C%3D10%5E%7B5%7D%20%24%20%29%20%5Cu2014%20number%20of%20Mr.%20Meeseeks.%5Cn%5CnThe%20second%20line%20contains%20%24%20n%20%24%20integers%20%24%20a_%7B1%7D%2Ca_%7B2%7D%2C...%2Ca_%7Bn%7D%20%24%20separated%20by%20spaces%20%28%20%24%201%3C%3Da_%7Bi%7D%3C%3Dn%20%24%20%29%20%5Cu2014%20colors%20of%20Mr.%20Meeseeks%20in%20order%20they%20standing%20in%20a%20line.%22%2C%22outputFormat%22%3A%22In%20the%20first%20and%20only%20line%20of%20input%20print%20%24%20n%20%24%20integers%20separated%20by%20spaces.%20%24%20i%20%24%20-th%20integer%20should%20be%20the%20minimum%20number%20of%20presidios%20needed%20if%20the%20value%20of%20%24%20k%20%24%20is%20%24%20i%20%24%20.%22%2C%22samples%22%3A%5B%5B%225%5Cn1%203%204%203%203%5Cn%22%2C%224%202%201%201%201%20%5Cn%22%5D%2C%5B%228%5Cn1%205%207%208%201%207%206%201%5Cn%22%2C%228%204%203%202%201%201%201%201%20%5Cn%22%5D%5D%2C%22hint%22%3A%22For%20the%20first%20sample%20testcase%2C%20some%20optimal%20ways%20of%20dividing%20army%20into%20squads%20for%20each%20%24%20k%20%24%20are%3A%5Cn%5Cn1.%20%24%20%5B1%5D%2C%5B3%5D%2C%5B4%5D%2C%5B3%2C3%5D%20%24%5Cn2.%20%24%20%5B1%5D%2C%5B3%2C4%2C3%2C3%5D%20%24%5Cn3.%20%24%20%5B1%2C3%2C4%2C3%2C3%5D%20%24%5Cn4.%20%24%20%5B1%2C3%2C4%2C3%2C3%5D%20%24%5Cn5.%20%24%20%5B1%2C3%2C4%2C3%2C3%5D%20%24%5Cn%5CnFor%20the%20second%20testcase%2C%20some%20optimal%20ways%20of%20dividing%20army%20into%20squads%20for%20each%20%24%20k%20%24%20are%3A%5Cn%5Cn1.%20%24%20%5B1%5D%2C%5B5%5D%2C%5B7%5D%2C%5B8%5D%2C%5B1%5D%2C%5B7%5D%2C%5B6%5D%2C%5B1%5D%20%24%5Cn2.%20%24%20%5B1%2C5%5D%2C%5B7%2C8%5D%2C%5B1%2C7%5D%2C%5B6%2C1%5D%20%24%5Cn3.%20%24%20%5B1%2C5%2C7%5D%2C%5B8%5D%2C%5B1%2C7%2C6%2C1%5D%20%24%5Cn4.%20%24%20%5B1%2C5%2C7%2C8%5D%2C%5B1%2C7%2C6%2C1%5D%20%24%5Cn5.%20%24%20%5B1%2C5%2C7%2C8%2C1%2C7%2C6%2C1%5D%20%24%5Cn6.%20%24%20%5B1%2C5%2C7%2C8%2C1%2C7%2C6%2C1%5D%20%24%5Cn7.%20%24%20%5B1%2C5%2C7%2C8%2C1%2C7%2C6%2C1%5D%20%24%5Cn8.%20%24%20%5B1%2C5%2C7%2C8%2C1%2C7%2C6%2C1%5D%20%24%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F786%5C%2FC%22%2C%22id%22%3A%22786C%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A28%2C%22totalAccepted%22%3A20%2C%22pid%22%3A%22CF786C%22%2C%22title%22%3A%22Till%20I%20Collapse%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Till%20I%20Collapse%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Till I Collapse</h1>
<h2>题目描述</h2>
<div>Rick and Morty want to find MR. PBH and they can't do it alone. So they need of Mr. Meeseeks. They Have generated $ n $ Mr. Meeseeks, standing in a line numbered from $ 1 $ to $ n $ . Each of them has his own color. $ i $ -th Mr. Meeseeks' color is $ a_{i} $ .
Rick and Morty are gathering their army and they want to divide Mr. Meeseeks into some squads. They don't want their squads to be too colorful, so each squad should have Mr. Meeseeks of at most $ k $ different colors. Also each squad should be a continuous subarray of Mr. Meeseeks in the line. Meaning that for each $ 1<=i<=e<=j<=n $ , if Mr. Meeseeks number $ i $ and Mr. Meeseeks number $ j $ are in the same squad then Mr. Meeseeks number $ e $ should be in that same squad.
![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF786C/f2b873f46d1ce1d5117f05fee6c23499da101533.png)Also, each squad needs its own presidio, and building a presidio needs money, so they want the total number of squads to be minimized.
Rick and Morty haven't finalized the exact value of $ k $ , so in order to choose it, for each $ k $ between $ 1 $ and $ n $ (inclusive) need to know the minimum number of presidios needed.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line of input contains a single integer $ n $ ( $ 1<=n<=10^{5} $ ) — number of Mr. Meeseeks.
The second line contains $ n $ integers $ a_{1},a_{2},...,a_{n} $ separated by spaces ( $ 1<=a_{i}<=n $ ) — colors of Mr. Meeseeks in order they standing in a line.</div>
<h3>输出格式</h3>
<br />
<div>In the first and only line of input print $ n $ integers separated by spaces. $ i $ -th integer should be the minimum number of presidios needed if the value of $ k $ is $ i $ .</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>5
1 3 4 3 3
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>4 2 1 1 1 
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>8
1 5 7 8 1 7 6 1
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>8 4 3 2 1 1 1 1 
</code></pre>
<h2>说明</h2>
<div>For the first sample testcase, some optimal ways of dividing army into squads for each $ k $ are:
1. $ [1],[3],[4],[3,3] $
2. $ [1],[3,4,3,3] $
3. $ [1,3,4,3,3] $
4. $ [1,3,4,3,3] $
5. $ [1,3,4,3,3] $
For the second testcase, some optimal ways of dividing army into squads for each $ k $ are:
1. $ [1],[5],[7],[8],[1],[7],[6],[1] $
2. $ [1,5],[7,8],[1,7],[6,1] $
3. $ [1,5,7],[8],[1,7,6,1] $
4. $ [1,5,7,8],[1,7,6,1] $
5. $ [1,5,7,8,1,7,6,1] $
6. $ [1,5,7,8,1,7,6,1] $
7. $ [1,5,7,8,1,7,6,1] $
8. $ [1,5,7,8,1,7,6,1] $</div>
</article>
</div>
</div>
</body>
</html>
