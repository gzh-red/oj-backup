<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Polycarpus and Tasks - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573391333:Yg/h3jiQ0BzxwQM3LpTEef45OB1sa/LZyn0KHLAqJlE=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Polycarpus%20has%20many%20tasks.%20Each%20task%20is%20characterized%20by%20three%20integers%20%24%20l_%7Bi%7D%20%24%20%2C%20%24%20r_%7Bi%7D%20%24%20and%20%24%20t_%7Bi%7D%20%24%20.%20Three%20integers%20%24%20%28l_%7Bi%7D%2Cr_%7Bi%7D%2Ct_%7Bi%7D%29%20%24%20mean%20that%20to%20perform%20task%20%24%20i%20%24%20%2C%20one%20needs%20to%20choose%20an%20integer%20%24%20s_%7Bi%7D%20%24%20%24%20%28l_%7Bi%7D%3C%3Ds_%7Bi%7D%3B%5Cu00a0s_%7Bi%7D%2Bt_%7Bi%7D-1%3C%3Dr_%7Bi%7D%29%20%24%20%2C%20then%20the%20task%20will%20be%20carried%20out%20continuously%20for%20%24%20t_%7Bi%7D%20%24%20units%20of%20time%2C%20starting%20at%20time%20%24%20s_%7Bi%7D%20%24%20and%20up%20to%20time%20%24%20s_%7Bi%7D%2Bt_%7Bi%7D-1%20%24%20%2C%20inclusive.%20In%20other%20words%2C%20a%20task%20is%20performed%20for%20a%20continuous%20period%20of%20time%20lasting%20%24%20t_%7Bi%7D%20%24%20%2C%20should%20be%20started%20no%20earlier%20than%20%24%20l_%7Bi%7D%20%24%20%2C%20and%20completed%20no%20later%20than%20%24%20r_%7Bi%7D%20%24%20.%5Cn%5CnPolycarpus%27s%20tasks%20have%20a%20surprising%20property%3A%20for%20any%20task%20%24%20j%2Ck%20%24%20%28with%20%24%20j%26lt%3Bk%20%24%20%29%20%24%20l_%7Bj%7D%26lt%3Bl_%7Bk%7D%20%24%20and%20%24%20r_%7Bj%7D%26lt%3Br_%7Bk%7D%20%24%20.%5Cn%5CnLet%27s%20suppose%20there%20is%20an%20ordered%20set%20of%20tasks%20%24%20A%20%24%20%2C%20containing%20%24%20%7CA%7C%20%24%20tasks.%20We%27ll%20assume%20that%20%24%20a_%7Bj%7D%3D%28l_%7Bj%7D%2Cr_%7Bj%7D%2Ct_%7Bj%7D%29%20%24%20%24%20%281%3C%3Dj%3C%3D%7CA%7C%29%20%24%20.%20Also%2C%20we%27ll%20assume%20that%20the%20tasks%20are%20ordered%20by%20increasing%20%24%20l_%7Bj%7D%20%24%20with%20the%20increase%20in%20number.%5Cn%5CnLet%27s%20consider%20the%20following%20recursive%20function%20%24%20f%20%24%20%2C%20whose%20argument%20is%20an%20ordered%20set%20of%20tasks%20%24%20A%20%24%20%2C%20and%20the%20result%20is%20an%20integer.%20The%20function%20%24%20f%28A%29%20%24%20is%20defined%20by%20the%20greedy%20algorithm%2C%20which%20is%20described%20below%20in%20a%20pseudo-language%20of%20programming.%5Cn%5Cn-%20Step%201.%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF164E%5C%2F505672ebb2b2b965326774e11bdb5318ba7faecb.png%29%2C%20%24%20ans%3D0%20%24%20.%5Cn-%20Step%202.%20We%20consider%20all%20tasks%20in%20the%20order%20of%20increasing%20of%20their%20numbers%20in%20the%20set%20%24%20A%20%24%20.%20Lets%20define%20the%20current%20task%20counter%20%24%20i%3D0%20%24%20.%5Cn-%20Step%203.%20Consider%20the%20next%20task%3A%20%24%20i%3Di%2B1%20%24%20.%20If%20%24%20i%26gt%3B%7CA%7C%20%24%20fulfilled%2C%20then%20go%20to%20the%208%20step.%5Cn-%20Step%204.%20If%20you%20can%20get%20the%20task%20done%20starting%20at%20time%20%24%20s_%7Bi%7D%20%24%20%3D%20max%20%24%20%28ans%2B1%2Cl_%7Bi%7D%29%20%24%20%2C%20then%20do%20the%20task%20%24%20i%20%24%20%3A%20%24%20s_%7Bi%7D%20%24%20%3D%20max%28%20%24%20ans%2B1%20%24%20%2C%20%24%20l_%7Bi%7D%20%24%20%29%2C%20%24%20ans%3Ds_%7Bi%7D%2Bt_%7Bi%7D-1%20%24%20%2C%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF164E%5C%2Fd2234314ce27181704f05522f3cbe0bb4c2084f6.png%29.%20Go%20to%20the%20next%20task%20%28step%203%29.%5Cn-%20Step%205.%20Otherwise%2C%20find%20such%20task%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF164E%5C%2Fdb7c19304472a3497fd497a6f1e2760996659e37.png%29%2C%20that%20first%2C%20task%20%24%20a_%7Bi%7D%20%24%20can%20be%20done%20at%20time%20%24%20s_%7Bi%7D%20%24%20%3D%20max%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF164E%5C%2Fd857492755e7baa46eb71131dba20b0df2735eda.png%29%2C%20and%20secondly%2C%20the%20value%20of%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF164E%5C%2Fe2b4f2ae14b40555edd964dcebdcd214e3d92a26.png%29%20is%20positive%20and%20takes%20the%20maximum%20value%20among%20all%20%24%20b_%7Bk%7D%20%24%20that%20satisfy%20the%20first%20condition.%20If%20you%20can%20choose%20multiple%20tasks%20as%20%24%20b_%7Bk%7D%20%24%20%2C%20choose%20the%20one%20with%20the%20maximum%20number%20in%20set%20%24%20A%20%24%20.%5Cn-%20Step%206.%20If%20you%20managed%20to%20choose%20task%20%24%20b_%7Bk%7D%20%24%20%2C%20then%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF164E%5C%2Fd1831216ca74c7c20f5ce96b3cd78426f390c87c.png%29%2C%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF164E%5C%2F8e57d31c10d27acc9143b9238807ed05e31fe78c.png%29.%20Go%20to%20the%20next%20task%20%28step%203%29.%5Cn-%20Step%207.%20If%20you%20didn%27t%20manage%20to%20choose%20task%20%24%20b_%7Bk%7D%20%24%20%2C%20then%20skip%20task%20%24%20i%20%24%20.%20Go%20to%20the%20next%20task%20%28step%203%29.%5Cn-%20Step%208.%20Return%20%24%20ans%20%24%20as%20a%20result%20of%20executing%20%24%20f%28A%29%20%24%20.%5Cn%5CnPolycarpus%20got%20entangled%20in%20all%20these%20formulas%20and%20definitions%2C%20so%20he%20asked%20you%20to%20simulate%20the%20execution%20of%20the%20function%20%24%20f%20%24%20%2C%20calculate%20the%20value%20of%20%24%20f%28A%29%20%24%20.%22%2C%22inputFormat%22%3A%22The%20first%20line%20of%20the%20input%20contains%20a%20single%20integer%20%24%20n%20%24%20%28%20%24%201%3C%3Dn%3C%3D10%5E%7B5%7D%20%24%20%29%20%5Cu2014%20the%20number%20of%20tasks%20in%20set%20%24%20A%20%24%20.%5Cn%5CnThen%20%24%20n%20%24%20lines%20describe%20the%20tasks.%20The%20%24%20i%20%24%20-th%20line%20contains%20three%20space-separated%20integers%20%24%20l_%7Bi%7D%20%24%20%2C%20%24%20r_%7Bi%7D%20%24%20%2C%20%24%20t_%7Bi%7D%20%24%20%28%20%24%201%3C%3Dl_%7Bi%7D%3C%3Dr_%7Bi%7D%3C%3D10%5E%7B9%7D%20%24%20%2C%20%24%201%3C%3Dt_%7Bi%7D%3C%3Dr_%7Bi%7D-l_%7Bi%7D%2B1%20%24%20%29%20%5Cu2014%20the%20description%20of%20the%20%24%20i%20%24%20-th%20task.%5Cn%5CnIt%20is%20guaranteed%20that%20for%20any%20tasks%20%24%20j%2Ck%20%24%20%28considering%20that%20%24%20j%26lt%3Bk%20%24%20%29%20the%20following%20is%20true%3A%20%24%20l_%7Bj%7D%26lt%3Bl_%7Bk%7D%20%24%20and%20%24%20r_%7Bj%7D%26lt%3Br_%7Bk%7D%20%24%20.%22%2C%22outputFormat%22%3A%22For%20each%20task%20%24%20i%20%24%20print%20a%20single%20integer%20%5Cu2014%20the%20result%20of%20processing%20task%20%24%20i%20%24%20on%20the%20%24%20i%20%24%20-th%20iteration%20of%20the%20cycle%20%28step%203%29%20in%20function%20%24%20f%28A%29%20%24%20.%20In%20the%20%24%20i%20%24%20-th%20line%20print%3A%5Cn%5Cn-%200%20%5Cu2014%20if%20you%20managed%20to%20add%20task%20%24%20i%20%24%20on%20step%204.%5Cn-%20-1%20%5Cu2014%20if%20you%20didn%27t%20manage%20to%20add%20or%20replace%20task%20%24%20i%20%24%20%28step%207%29.%5Cn-%20%24%20res_%7Bi%7D%20%24%20%28%20%24%201%3C%3Dres_%7Bi%7D%3C%3Dn%20%24%20%29%20%5Cu2014%20if%20you%20managed%20to%20replace%20the%20task%20%28step%206%29%3A%20%24%20res_%7Bi%7D%20%24%20equals%20the%20task%20number%20%28in%20set%20%24%20A%20%24%20%29%2C%20that%20should%20be%20chosen%20as%20%24%20b_%7Bk%7D%20%24%20and%20replaced%20by%20task%20%24%20a_%7Bi%7D%20%24%20.%22%2C%22samples%22%3A%5B%5B%225%5Cn1%208%205%5Cn2%209%203%5Cn3%2010%203%5Cn8%2011%204%5Cn11%2012%202%5Cn%22%2C%220%200%201%200%20-1%20%22%5D%2C%5B%2213%5Cn1%208%205%5Cn2%209%204%5Cn3%2010%201%5Cn4%2011%203%5Cn8%2012%205%5Cn9%2013%205%5Cn10%2014%205%5Cn11%2015%201%5Cn12%2016%201%5Cn13%2017%201%5Cn14%2018%203%5Cn15%2019%203%5Cn16%2020%202%5Cn%22%2C%220%200%200%202%20-1%20-1%200%200%200%200%207%200%2012%20%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B3000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F164%5C%2FE%22%2C%22id%22%3A%22164E%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A1%2C%22totalAccepted%22%3A1%2C%22pid%22%3A%22CF164E%22%2C%22title%22%3A%22Polycarpus%20and%20Tasks%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Polycarpus%20and%20Tasks%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573286098;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Polycarpus and Tasks</h1>
<h2>题目描述</h2>
<div>Polycarpus has many tasks. Each task is characterized by three integers $ l_{i} $ , $ r_{i} $ and $ t_{i} $ . Three integers $ (l_{i},r_{i},t_{i}) $ mean that to perform task $ i $ , one needs to choose an integer $ s_{i} $ $ (l_{i}<=s_{i}; s_{i}+t_{i}-1<=r_{i}) $ , then the task will be carried out continuously for $ t_{i} $ units of time, starting at time $ s_{i} $ and up to time $ s_{i}+t_{i}-1 $ , inclusive. In other words, a task is performed for a continuous period of time lasting $ t_{i} $ , should be started no earlier than $ l_{i} $ , and completed no later than $ r_{i} $ .
Polycarpus's tasks have a surprising property: for any task $ j,k $ (with $ j&lt;k $ ) $ l_{j}&lt;l_{k} $ and $ r_{j}&lt;r_{k} $ .
Let's suppose there is an ordered set of tasks $ A $ , containing $ |A| $ tasks. We'll assume that $ a_{j}=(l_{j},r_{j},t_{j}) $ $ (1<=j<=|A|) $ . Also, we'll assume that the tasks are ordered by increasing $ l_{j} $ with the increase in number.
Let's consider the following recursive function $ f $ , whose argument is an ordered set of tasks $ A $ , and the result is an integer. The function $ f(A) $ is defined by the greedy algorithm, which is described below in a pseudo-language of programming.
- Step 1. ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF164E/505672ebb2b2b965326774e11bdb5318ba7faecb.png), $ ans=0 $ .
- Step 2. We consider all tasks in the order of increasing of their numbers in the set $ A $ . Lets define the current task counter $ i=0 $ .
- Step 3. Consider the next task: $ i=i+1 $ . If $ i&gt;|A| $ fulfilled, then go to the 8 step.
- Step 4. If you can get the task done starting at time $ s_{i} $ = max $ (ans+1,l_{i}) $ , then do the task $ i $ : $ s_{i} $ = max( $ ans+1 $ , $ l_{i} $ ), $ ans=s_{i}+t_{i}-1 $ , ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF164E/d2234314ce27181704f05522f3cbe0bb4c2084f6.png). Go to the next task (step 3).
- Step 5. Otherwise, find such task ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF164E/db7c19304472a3497fd497a6f1e2760996659e37.png), that first, task $ a_{i} $ can be done at time $ s_{i} $ = max![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF164E/d857492755e7baa46eb71131dba20b0df2735eda.png), and secondly, the value of ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF164E/e2b4f2ae14b40555edd964dcebdcd214e3d92a26.png) is positive and takes the maximum value among all $ b_{k} $ that satisfy the first condition. If you can choose multiple tasks as $ b_{k} $ , choose the one with the maximum number in set $ A $ .
- Step 6. If you managed to choose task $ b_{k} $ , then ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF164E/d1831216ca74c7c20f5ce96b3cd78426f390c87c.png), ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF164E/8e57d31c10d27acc9143b9238807ed05e31fe78c.png). Go to the next task (step 3).
- Step 7. If you didn't manage to choose task $ b_{k} $ , then skip task $ i $ . Go to the next task (step 3).
- Step 8. Return $ ans $ as a result of executing $ f(A) $ .
Polycarpus got entangled in all these formulas and definitions, so he asked you to simulate the execution of the function $ f $ , calculate the value of $ f(A) $ .</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line of the input contains a single integer $ n $ ( $ 1<=n<=10^{5} $ ) — the number of tasks in set $ A $ .
Then $ n $ lines describe the tasks. The $ i $ -th line contains three space-separated integers $ l_{i} $ , $ r_{i} $ , $ t_{i} $ ( $ 1<=l_{i}<=r_{i}<=10^{9} $ , $ 1<=t_{i}<=r_{i}-l_{i}+1 $ ) — the description of the $ i $ -th task.
It is guaranteed that for any tasks $ j,k $ (considering that $ j&lt;k $ ) the following is true: $ l_{j}&lt;l_{k} $ and $ r_{j}&lt;r_{k} $ .</div>
<h3>输出格式</h3>
<br />
<div>For each task $ i $ print a single integer — the result of processing task $ i $ on the $ i $ -th iteration of the cycle (step 3) in function $ f(A) $ . In the $ i $ -th line print:
- 0 — if you managed to add task $ i $ on step 4.
- -1 — if you didn't manage to add or replace task $ i $ (step 7).
- $ res_{i} $ ( $ 1<=res_{i}<=n $ ) — if you managed to replace the task (step 6): $ res_{i} $ equals the task number (in set $ A $ ), that should be chosen as $ b_{k} $ and replaced by task $ a_{i} $ .</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>5
1 8 5
2 9 3
3 10 3
8 11 4
11 12 2
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>0 0 1 0 -1 </code></pre>
<h3>输入样例 #2</h3>
<pre><code>13
1 8 5
2 9 4
3 10 1
4 11 3
8 12 5
9 13 5
10 14 5
11 15 1
12 16 1
13 17 1
14 18 3
15 19 3
16 20 2
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>0 0 0 2 -1 -1 0 0 0 0 7 0 12 </code></pre>
</article>
</div>
</div>
</body>
</html>
