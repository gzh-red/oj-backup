<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Digits of Number Pi - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573395669:6mXMR9I6ZIQrgcVy+mDvNsGopNCH9cQg7ebA8M4Wpdo=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Vasily%20has%20recently%20learned%20about%20the%20amazing%20properties%20of%20number%20%24%20%5Cu03c0%20%24%20.%20In%20one%20of%20the%20articles%20it%20has%20been%20hypothesized%20that%2C%20whatever%20the%20sequence%20of%20numbers%20we%20have%2C%20in%20some%20position%2C%20this%20sequence%20is%20found%20among%20the%20digits%20of%20number%20%24%20%5Cu03c0%20%24%20.%20Thus%2C%20if%20you%20take%2C%20for%20example%2C%20the%20epic%20novel%20%5C%22War%20and%20Peace%5C%22%20of%20famous%20Russian%20author%20Leo%20Tolstoy%2C%20and%20encode%20it%20with%20numbers%2C%20then%20we%20will%20find%20the%20novel%20among%20the%20characters%20of%20number%20%24%20%5Cu03c0%20%24%20.%5Cn%5CnVasily%20was%20absolutely%20delighted%20with%20this%2C%20because%20it%20means%20that%20all%20the%20books%2C%20songs%20and%20programs%20have%20already%20been%20written%20and%20encoded%20in%20the%20digits%20of%20%24%20%5Cu03c0%20%24%20.%20Vasily%20is%2C%20of%20course%2C%20a%20bit%20wary%20that%20this%20is%20only%20a%20hypothesis%20and%20it%20hasn%27t%20been%20proved%2C%20so%20he%20decided%20to%20check%20it%20out.%5Cn%5CnTo%20do%20this%2C%20Vasily%20downloaded%20from%20the%20Internet%20the%20archive%20with%20the%20sequence%20of%20digits%20of%20number%20%24%20%5Cu03c0%20%24%20%2C%20starting%20with%20a%20certain%20position%2C%20and%20began%20to%20check%20the%20different%20strings%20of%20digits%20on%20the%20presence%20in%20the%20downloaded%20archive.%20Vasily%20quickly%20found%20short%20strings%20of%20digits%2C%20but%20each%20time%20he%20took%20a%20longer%20string%2C%20it%20turned%20out%20that%20it%20is%20not%20in%20the%20archive.%20Vasily%20came%20up%20with%20a%20definition%20that%20a%20string%20of%20length%20%24%20d%20%24%20is%20a%20half-occurrence%20if%20it%20contains%20a%20substring%20of%20length%20of%20at%20least%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF585F%5C%2Fcb7b717ebd73c919034f7aa2697aede2fa62dd31.png%29%2C%20which%20occurs%20in%20the%20archive.%5Cn%5CnTo%20complete%20the%20investigation%2C%20Vasily%20took%20%24%202%20%24%20large%20numbers%20%24%20x%2Cy%20%24%20%28%20%24%20x%3C%3Dy%20%24%20%29%20with%20the%20same%20number%20of%20digits%20and%20now%20he%20wants%20to%20find%20the%20number%20of%20numbers%20in%20the%20interval%20from%20%24%20x%20%24%20to%20%24%20y%20%24%20%2C%20which%20are%20half-occurrences%20in%20the%20archive.%20Help%20Vasily%20calculate%20this%20value%20modulo%20%24%2010%5E%7B9%7D%2B7%20%24%20.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20string%20%24%20s%20%24%20consisting%20of%20decimal%20digits%20%28%20%24%201%3C%3D%7Cs%7C%3C%3D1000%20%24%20%29%20that%20Vasily%20will%20use%20to%20search%20substrings%20in.%20According%20to%20hypothesis%2C%20this%20sequence%20of%20digis%20indeed%20occurs%20in%20the%20decimal%20representation%20of%20%24%20%5Cu03c0%20%24%20%2C%20although%20we%20can%27t%20guarantee%20that.%5Cn%5CnThe%20second%20and%20third%20lines%20contain%20two%20positive%20integers%20%24%20x%2Cy%20%24%20of%20the%20same%20length%20%24%20d%20%24%20%28%20%24%20x%3C%3Dy%20%24%20%2C%20%24%202%3C%3Dd%3C%3D50%20%24%20%29.%20Numbers%20%24%20x%2Cy%20%24%20do%20not%20contain%20leading%20zeroes.%22%2C%22outputFormat%22%3A%22Print%20how%20many%20numbers%20in%20the%20segment%20from%20%24%20x%20%24%20to%20%24%20y%20%24%20that%20are%20half-occurrences%20in%20%24%20s%20%24%20modulo%20%24%2010%5E%7B9%7D%2B7%20%24%20.%22%2C%22samples%22%3A%5B%5B%2202%5Cn10%5Cn19%5Cn%22%2C%222%5Cn%22%5D%2C%5B%22023456789%5Cn10%5Cn19%5Cn%22%2C%229%5Cn%22%5D%2C%5B%2231415926535%5Cn10%5Cn29%5Cn%22%2C%2220%5Cn%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F585%5C%2FF%22%2C%22id%22%3A%22585F%22%7D%2C%22translation%22%3A%22%5Cu5b9a%5Cu4e49%5Cu957f%5Cu5ea6%5Cu4e3a%24d%24%5Cu7684%5Cu5b57%5Cu7b26%5Cu4e32%24T%24%5Cu4e3a%5Cu5b57%5Cu7b26%5Cu4e32%24S%24%5Cu7684%5Cu534a%5Cu5339%5Cu914d%5Cu4e32%5Cuff0c%5Cu5f53%5Cu4e14%5Cu4ec5%5Cu5f53%24T%24%5Cu5185%5Cu5b58%5Cu5728%5Cu957f%5Cu5ea6%5Cu81f3%5Cu5c11%5Cu4e3a%24%5C%5Clfloor%20%5C%5Cfrac%7Bd%7D%7B2%7D%5C%5Crfloor%24%5Cu7684%5Cu5b50%5Cu4e32%5Cuff0c%5Cu4f7f%5Cu5f97%5Cu5176%5Cu4e3a%24S%24%5Cu7684%5Cu5b50%5Cu4e32%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu7ed9%5Cu51fa%5Cu4e00%5Cu4e2a%5Cu5b57%5Cu7b26%5Cu4e32%24S%24%5Cuff0c%5Cu4e24%5Cu4e2a%5Cu957f%5Cu5ea6%5Cu90fd%5Cu4e3a%24d%24%5Cu7684%5Cu5341%5Cu8fdb%5Cu5236%5Cu6574%5Cu6570%5Cu5b57%5Cu7b26%5Cu4e32%24x%24%5Cu548c%24y%24%5Cuff0c%5Cu6c42%5Cu533a%5Cu95f4%24%5Bx%2Cy%5D%24%5Cu4e2d%5Cu6709%5Cu591a%5Cu5c11%5Cu4e2a%5Cu6570%5Cu5b57%5Cu5b57%5Cu7b26%5Cu4e32%5Cu662f%24S%24%5Cu7684%5Cu534a%5Cu5339%5Cu914d%5Cu4e32%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu8f93%5Cu5165%5Cu7684%5Cu7b2c%5Cu4e00%5Cu884c%5Cu4e3a%24S%24%5Cuff0c%5Cu7b2c%5Cu4e8c%5Cu884c%5Cu4e3a%24x%24%5Cuff0c%5Cu7b2c%5Cu4e09%5Cu884c%5Cu4e3a%24y%24%5Cu3002%24x%24%5Cu548c%24y%24%5Cu4e0d%5Cu542b%5Cu524d%5Cu5bfc%5Cu96f6%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu6570%5Cu636e%5Cu4fdd%5Cu8bc1%241%5C%5Cleq%7CS%7C%5C%5Cleq1000%24%5Cuff0c%242%5C%5Cleq%20d%5C%5Cleq%2050%24%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu8bf7%5Cu5c06%5Cu7b54%5Cu6848%5Cu5bf9%2410%5E9%2B7%24%5Cu53d6%5Cu6a21%5Cu3002%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A6%2C%22totalAccepted%22%3A4%2C%22pid%22%3A%22CF585F%22%2C%22title%22%3A%22Digits%20of%20Number%20Pi%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Digits%20of%20Number%20Pi%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Digits of Number Pi</h1>
<h2>题意翻译</h2>
<div>定义长度为$d$的字符串$T$为字符串$S$的半匹配串，当且仅当$T$内存在长度至少为$\lfloor \frac{d}{2}\rfloor$的子串，使得其为$S$的子串。
给出一个字符串$S$，两个长度都为$d$的十进制整数字符串$x$和$y$，求区间$[x,y]$中有多少个数字字符串是$S$的半匹配串。
输入的第一行为$S$，第二行为$x$，第三行为$y$。$x$和$y$不含前导零。
数据保证$1\leq|S|\leq1000$，$2\leq d\leq 50$。
请将答案对$10^9+7$取模。</div>
<h2>题目描述</h2>
<div>Vasily has recently learned about the amazing properties of number $ π $ . In one of the articles it has been hypothesized that, whatever the sequence of numbers we have, in some position, this sequence is found among the digits of number $ π $ . Thus, if you take, for example, the epic novel "War and Peace" of famous Russian author Leo Tolstoy, and encode it with numbers, then we will find the novel among the characters of number $ π $ .
Vasily was absolutely delighted with this, because it means that all the books, songs and programs have already been written and encoded in the digits of $ π $ . Vasily is, of course, a bit wary that this is only a hypothesis and it hasn't been proved, so he decided to check it out.
To do this, Vasily downloaded from the Internet the archive with the sequence of digits of number $ π $ , starting with a certain position, and began to check the different strings of digits on the presence in the downloaded archive. Vasily quickly found short strings of digits, but each time he took a longer string, it turned out that it is not in the archive. Vasily came up with a definition that a string of length $ d $ is a half-occurrence if it contains a substring of length of at least ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF585F/cb7b717ebd73c919034f7aa2697aede2fa62dd31.png), which occurs in the archive.
To complete the investigation, Vasily took $ 2 $ large numbers $ x,y $ ( $ x<=y $ ) with the same number of digits and now he wants to find the number of numbers in the interval from $ x $ to $ y $ , which are half-occurrences in the archive. Help Vasily calculate this value modulo $ 10^{9}+7 $ .</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains string $ s $ consisting of decimal digits ( $ 1<=|s|<=1000 $ ) that Vasily will use to search substrings in. According to hypothesis, this sequence of digis indeed occurs in the decimal representation of $ π $ , although we can't guarantee that.
The second and third lines contain two positive integers $ x,y $ of the same length $ d $ ( $ x<=y $ , $ 2<=d<=50 $ ). Numbers $ x,y $ do not contain leading zeroes.</div>
<h3>输出格式</h3>
<br />
<div>Print how many numbers in the segment from $ x $ to $ y $ that are half-occurrences in $ s $ modulo $ 10^{9}+7 $ .</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>02
10
19
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>2
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>023456789
10
19
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>9
</code></pre>
<h3>输入样例 #3</h3>
<pre><code>31415926535
10
29
</code></pre>
<h3>输出样例 #3</h3>
<pre><code>20
</code></pre>
</article>
</div>
</div>
</body>
</html>
