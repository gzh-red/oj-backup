<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Graph Traveler - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573403002:IBD35oA6CvBNyib5cCsSMywdEA5zqLqDRTjVctB5cTw=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Gildong%20is%20experimenting%20with%20an%20interesting%20machine%20Graph%20Traveler.%20In%20Graph%20Traveler%2C%20there%20is%20a%20directed%20graph%20consisting%20of%20%24%20n%20%24%20vertices%20numbered%20from%20%24%201%20%24%20to%20%24%20n%20%24%20.%20The%20%24%20i%20%24%20-th%20vertex%20has%20%24%20m_i%20%24%20outgoing%20edges%20that%20are%20labeled%20as%20%24%20e_i%5B0%5D%20%24%20%2C%20%24%20e_i%5B1%5D%20%24%20%2C%20%24%20%5C%5Cldots%20%24%20%2C%20%24%20e_i%5Bm_i-1%5D%20%24%20%2C%20each%20representing%20the%20destination%20vertex%20of%20the%20edge.%20The%20graph%20can%20have%20multiple%20edges%20and%20self-loops.%20The%20%24%20i%20%24%20-th%20vertex%20also%20has%20an%20integer%20%24%20k_i%20%24%20written%20on%20itself.%5Cn%5CnA%20travel%20on%20this%20graph%20works%20as%20follows.%5Cn%5Cn1.%20Gildong%20chooses%20a%20vertex%20to%20start%20from%2C%20and%20an%20integer%20to%20start%20with.%20Set%20the%20variable%20%24%20c%20%24%20to%20this%20integer.%5Cn2.%20After%20arriving%20at%20the%20vertex%20%24%20i%20%24%20%2C%20or%20when%20Gildong%20begins%20the%20travel%20at%20some%20vertex%20%24%20i%20%24%20%2C%20add%20%24%20k_i%20%24%20to%20%24%20c%20%24%20.%5Cn3.%20The%20next%20vertex%20is%20%24%20e_i%5Bx%5D%20%24%20where%20%24%20x%20%24%20is%20an%20integer%20%24%200%20%5C%5Cle%20x%20%5C%5Cle%20m_i-1%20%24%20satisfying%20%24%20x%20%5C%5Cequiv%20c%20%5C%5Cpmod%20%7Bm_i%7D%20%24%20.%20Go%20to%20the%20next%20vertex%20and%20go%20back%20to%20step%202.%5Cn%5CnIt%27s%20obvious%20that%20a%20travel%20never%20ends%2C%20since%20the%202nd%20and%20the%203rd%20step%20will%20be%20repeated%20endlessly.%5Cn%5CnFor%20example%2C%20assume%20that%20Gildong%20starts%20at%20vertex%20%24%201%20%24%20with%20%24%20c%20%3D%205%20%24%20%2C%20and%20%24%20m_1%20%3D%202%20%24%20%2C%20%24%20e_1%5B0%5D%20%3D%201%20%24%20%2C%20%24%20e_1%5B1%5D%20%3D%202%20%24%20%2C%20%24%20k_1%20%3D%20-3%20%24%20.%20Right%20after%20he%20starts%20at%20vertex%20%24%201%20%24%20%2C%20%24%20c%20%24%20becomes%20%24%202%20%24%20.%20Since%20the%20only%20integer%20%24%20x%20%24%20%28%20%24%200%20%5C%5Cle%20x%20%5C%5Cle%201%20%24%20%29%20where%20%24%20x%20%5C%5Cequiv%20c%20%5C%5Cpmod%20%7Bm_i%7D%20%24%20is%20%24%200%20%24%20%2C%20Gildong%20goes%20to%20vertex%20%24%20e_1%5B0%5D%20%3D%201%20%24%20.%20After%20arriving%20at%20vertex%20%24%201%20%24%20again%2C%20%24%20c%20%24%20becomes%20%24%20-1%20%24%20.%20The%20only%20integer%20%24%20x%20%24%20satisfying%20the%20conditions%20is%20%24%201%20%24%20%2C%20so%20he%20goes%20to%20vertex%20%24%20e_1%5B1%5D%20%3D%202%20%24%20%2C%20and%20so%20on.%5Cn%5CnSince%20Gildong%20is%20quite%20inquisitive%2C%20he%27s%20going%20to%20ask%20you%20%24%20q%20%24%20queries.%20He%20wants%20to%20know%20how%20many%20distinct%20vertices%20will%20be%20visited%20infinitely%20many%20times%2C%20if%20he%20starts%20the%20travel%20from%20a%20certain%20vertex%20with%20a%20certain%20value%20of%20%24%20c%20%24%20.%20Note%20that%20you%20should%20not%20count%20the%20vertices%20that%20will%20be%20visited%20only%20finite%20times.%22%2C%22inputFormat%22%3A%22The%20first%20line%20of%20the%20input%20contains%20an%20integer%20%24%20n%20%24%20%28%20%24%201%20%5C%5Cle%20n%20%5C%5Cle%201000%20%24%20%29%2C%20the%20number%20of%20vertices%20in%20the%20graph.%5Cn%5CnThe%20second%20line%20contains%20%24%20n%20%24%20integers.%20The%20%24%20i%20%24%20-th%20integer%20is%20%24%20k_i%20%24%20%28%20%24%20-10%5E9%20%5C%5Cle%20k_i%20%5C%5Cle%2010%5E9%20%24%20%29%2C%20the%20integer%20written%20on%20the%20%24%20i%20%24%20-th%20vertex.%5Cn%5CnNext%20%24%202%20%5C%5Ccdot%20n%20%24%20lines%20describe%20the%20edges%20of%20each%20vertex.%20The%20%24%20%282%20%5C%5Ccdot%20i%20%2B%201%29%20%24%20-st%20line%20contains%20an%20integer%20%24%20m_i%20%24%20%28%20%24%201%20%5C%5Cle%20m_i%20%5C%5Cle%2010%20%24%20%29%2C%20the%20number%20of%20outgoing%20edges%20of%20the%20%24%20i%20%24%20-th%20vertex.%20The%20%24%20%282%20%5C%5Ccdot%20i%20%2B%202%29%20%24%20-nd%20line%20contains%20%24%20m_i%20%24%20integers%20%24%20e_i%5B0%5D%20%24%20%2C%20%24%20e_i%5B1%5D%20%24%20%2C%20%24%20%5C%5Cldots%20%24%20%2C%20%24%20e_i%5Bm_i-1%5D%20%24%20%2C%20each%20having%20an%20integer%20value%20between%20%24%201%20%24%20and%20%24%20n%20%24%20%2C%20inclusive.%5Cn%5CnNext%20line%20contains%20an%20integer%20%24%20q%20%24%20%28%20%24%201%20%5C%5Cle%20q%20%5C%5Cle%2010%5E5%20%24%20%29%2C%20the%20number%20of%20queries%20Gildong%20wants%20to%20ask.%5Cn%5CnNext%20%24%20q%20%24%20lines%20contains%20two%20integers%20%24%20x%20%24%20and%20%24%20y%20%24%20%28%20%24%201%20%5C%5Cle%20x%20%5C%5Cle%20n%20%24%20%2C%20%24%20-10%5E9%20%5C%5Cle%20y%20%5C%5Cle%2010%5E9%20%24%20%29%20each%2C%20which%20mean%20that%20the%20start%20vertex%20is%20%24%20x%20%24%20and%20the%20starting%20value%20of%20%24%20c%20%24%20is%20%24%20y%20%24%20.%22%2C%22outputFormat%22%3A%22For%20each%20query%2C%20print%20the%20number%20of%20distinct%20vertices%20that%20will%20be%20visited%20infinitely%20many%20times%2C%20if%20Gildong%20starts%20at%20vertex%20%24%20x%20%24%20with%20starting%20integer%20%24%20y%20%24%20.%22%2C%22samples%22%3A%5B%5B%22%5Cn4%5Cn0%200%200%200%5Cn2%5Cn2%203%5Cn1%5Cn2%5Cn3%5Cn2%204%201%5Cn4%5Cn3%201%202%201%5Cn6%5Cn1%200%5Cn2%200%5Cn3%20-1%5Cn4%20-2%5Cn1%201%5Cn1%205%5Cn%22%2C%22%5Cn1%5Cn1%5Cn2%5Cn1%5Cn3%5Cn2%5Cn%22%5D%2C%5B%22%5Cn4%5Cn4%20-5%20-3%20-1%5Cn2%5Cn2%203%5Cn1%5Cn2%5Cn3%5Cn2%204%201%5Cn4%5Cn3%201%202%201%5Cn6%5Cn1%200%5Cn2%200%5Cn3%20-1%5Cn4%20-2%5Cn1%201%5Cn1%205%5Cn%22%2C%22%5Cn1%5Cn1%5Cn1%5Cn3%5Cn1%5Cn1%5Cn%22%5D%5D%2C%22hint%22%3A%22The%20first%20example%20can%20be%20shown%20like%20the%20following%20image%3A%5Cn%5Cn%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF1200F%5C%2Fa011bde48ef56a4766df088c213c0f3fb6972396.png%29Three%20integers%20are%20marked%20on%20%24%20i%20%24%20-th%20vertex%3A%20%24%20i%20%24%20%2C%20%24%20k_i%20%24%20%2C%20and%20%24%20m_i%20%24%20respectively.%20The%20outgoing%20edges%20are%20labeled%20with%20an%20integer%20representing%20the%20edge%20number%20of%20%24%20i%20%24%20-th%20vertex.%5Cn%5CnThe%20travel%20for%20each%20query%20works%20as%20follows.%20It%20is%20described%20as%20a%20sequence%20of%20phrases%2C%20each%20in%20the%20format%20%5C%22vertex%20%28%20%24%20c%20%24%20after%20%24%20k_i%20%24%20added%29%5C%22.%5Cn%5Cn-%20%24%201%280%29%20%5C%5Cto%202%280%29%20%5C%5Cto%202%280%29%20%5C%5Cto%20%5C%5Cldots%20%24%5Cn-%20%24%202%280%29%20%5C%5Cto%202%280%29%20%5C%5Cto%20%5C%5Cldots%20%24%5Cn-%20%24%203%28-1%29%20%5C%5Cto%201%28-1%29%20%5C%5Cto%203%28-1%29%20%5C%5Cto%20%5C%5Cldots%20%24%5Cn-%20%24%204%28-2%29%20%5C%5Cto%202%28-2%29%20%5C%5Cto%202%28-2%29%20%5C%5Cto%20%5C%5Cldots%20%24%5Cn-%20%24%201%281%29%20%5C%5Cto%203%281%29%20%5C%5Cto%204%281%29%20%5C%5Cto%201%281%29%20%5C%5Cto%20%5C%5Cldots%20%24%5Cn-%20%24%201%285%29%20%5C%5Cto%203%285%29%20%5C%5Cto%201%285%29%20%5C%5Cto%20%5C%5Cldots%20%24%5Cn%5CnThe%20second%20example%20is%20same%20as%20the%20first%20example%2C%20except%20that%20the%20vertices%20have%20non-zero%20values.%20Therefore%20the%20answers%20to%20the%20queries%20also%20differ%20from%20the%20first%20example.%5Cn%5Cn%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF1200F%5C%2Ffa2b54acddea0c522ade11c446830a8460d01a6b.png%29The%20queries%20for%20the%20second%20example%20works%20as%20follows%3A%5Cn%5Cn-%20%24%201%284%29%20%5C%5Cto%202%28-1%29%20%5C%5Cto%202%28-6%29%20%5C%5Cto%20%5C%5Cldots%20%24%5Cn-%20%24%202%28-5%29%20%5C%5Cto%202%28-10%29%20%5C%5Cto%20%5C%5Cldots%20%24%5Cn-%20%24%203%28-4%29%20%5C%5Cto%201%280%29%20%5C%5Cto%202%28-5%29%20%5C%5Cto%202%28-10%29%20%5C%5Cto%20%5C%5Cldots%20%24%5Cn-%20%24%204%28-3%29%20%5C%5Cto%201%281%29%20%5C%5Cto%203%28-2%29%20%5C%5Cto%204%28-3%29%20%5C%5Cto%20%5C%5Cldots%20%24%5Cn-%20%24%201%285%29%20%5C%5Cto%203%282%29%20%5C%5Cto%201%286%29%20%5C%5Cto%202%281%29%20%5C%5Cto%202%28-4%29%20%5C%5Cto%20%5C%5Cldots%20%24%5Cn-%20%24%201%289%29%20%5C%5Cto%203%286%29%20%5C%5Cto%202%281%29%20%5C%5Cto%202%28-4%29%20%5C%5Cto%20%5C%5Cldots%20%24%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B512000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F1200%5C%2FF%22%2C%22id%22%3A%221200F%22%7D%2C%22translation%22%3A%22Gildong%5Cu6b63%5Cu5728%5Cu8bd5%5Cu9a8c%5Cu4e00%5Cu4e2a%5Cu6709%5Cu8da3%5Cu7684Graph%20Traveler%2C%5Cu5177%5Cu4f53%5Cu6765%5Cu8bf4%2C%5Cu8fd9%5Cu4e2aGraph%20Traveler%5Cu662f%5Cu4e2a%5Cu7531n%5Cu4e2a%5Cu7f16%5Cu53f7%5Cu4e3a1-n%5Cu7684%5Cu70b9%5Cu6784%5Cu6210%5Cu7684%5Cu6709%5Cu5411%5Cu56fe%2C%5Cu7b2ci%5Cu4e2a%5Cu70b9%5Cu6709%24m_i%24%5Cu6761%5Cu51fa%5Cu8fb9%2C%5Cu8fb9%5Cu5230%5Cu8fbe%5Cu7684%5Cu70b9%5Cu5206%5Cu522b%5Cu88ab%5Cu8bb0%5Cu4e3a%24e_i%5B0%5D%2Ce_i%5B1%5D...e_i%5Bm_i-1%5D%24.%5Cu6bcf%5Cu4e2a%5Cu70b9%5Cu8fd8%5Cu6709%5Cu70b9%5Cu6743%24k_i%24%5Cr%5Cn%5Cr%5Cn%5Cu73b0%5Cu5728%5Cu6709%24q%24%5Cu4e2a%5Cu8be2%5Cu95ee%2C%5Cu6bcf%5Cu4e2a%5Cu8be2%5Cu95ee%5Cu8981%5Cu6c42%5Cu4ece%5Cu67d0%5Cu4e2a%5Cu70b9%5Cu5f00%5Cu59cb%2C%5Cu521d%5Cu59cb%5Cu6709%5Cu4e2a%5Cu70b9%5Cu6743%24c%24%2C%5Cu6bcf%5Cu6b21%5Cu5230%5Cu4e00%5Cu4e2a%5Cu70b9%24i%24%28%5Cu8d77%5Cu70b9%5Cu4e5f%5Cu7b97%29%5Cu5c31%5Cu628a%5Cu70b9%5Cu6743%24c%24%5Cu52a0%5Cu4e0a%24k_i%24%2C%5Cu7136%5Cu540e%5Cu8d70%24i%24%5Cu7684%5Cu51fa%5Cu8fb9%24e_i%5Bx%5D%28x%20%5C%5Cequiv%20c%5C%5Cmod%20m_i%29%24.%5Cu53ef%5Cu4ee5%5Cu53d1%5Cu73b0%5Cu8fd9%5Cu4e2a%5Cu8fc7%5Cu7a0b%5Cu662f%5Cu4f1a%5Cu4e00%5Cu76f4%5Cu8fdb%5Cu884c%5Cu4e0b%5Cu53bb%5Cu7684.%5Cu73b0%5Cu5728%5Cu95ee%5Cu6bcf%5Cu6b21%5Cu8fd9%5Cu6837%5Cu8d70%2C%5Cu56fe%5Cu4e0a%5Cu6709%5Cu591a%5Cu5c11%5Cu4e2a%5Cu70b9%5Cu4f1a%5Cu88ab%5Cu7ecf%5Cu8fc7%5Cu65e0%5Cu9650%5Cu6b21%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A58%2C%22totalAccepted%22%3A46%2C%22pid%22%3A%22CF1200F%22%2C%22title%22%3A%22Graph%20Traveler%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22CF1200E%22%2C%22title%22%3A%22Compress%20Words%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1200D%22%2C%22title%22%3A%22White%20Lines%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1200C%22%2C%22title%22%3A%22Round%20Corridor%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1205A%22%2C%22title%22%3A%22Almost%20Equal%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1217E%22%2C%22title%22%3A%22Sum%20Queries%3F%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Graph%20Traveler%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Graph Traveler</h1>
<h2>题意翻译</h2>
<div>Gildong正在试验一个有趣的Graph Traveler,具体来说,这个Graph Traveler是个由n个编号为1-n的点构成的有向图,第i个点有$m_i$条出边,边到达的点分别被记为$e_i[0],e_i[1]...e_i[m_i-1]$.每个点还有点权$k_i$
现在有$q$个询问,每个询问要求从某个点开始,初始有个点权$c$,每次到一个点$i$(起点也算)就把点权$c$加上$k_i$,然后走$i$的出边$e_i[x](x \equiv c\mod m_i)$.可以发现这个过程是会一直进行下去的.现在问每次这样走,图上有多少个点会被经过无限次</div>
<h2>题目描述</h2>
<div>Gildong is experimenting with an interesting machine Graph Traveler. In Graph Traveler, there is a directed graph consisting of $ n $ vertices numbered from $ 1 $ to $ n $ . The $ i $ -th vertex has $ m_i $ outgoing edges that are labeled as $ e_i[0] $ , $ e_i[1] $ , $ \ldots $ , $ e_i[m_i-1] $ , each representing the destination vertex of the edge. The graph can have multiple edges and self-loops. The $ i $ -th vertex also has an integer $ k_i $ written on itself.
A travel on this graph works as follows.
1. Gildong chooses a vertex to start from, and an integer to start with. Set the variable $ c $ to this integer.
2. After arriving at the vertex $ i $ , or when Gildong begins the travel at some vertex $ i $ , add $ k_i $ to $ c $ .
3. The next vertex is $ e_i[x] $ where $ x $ is an integer $ 0 \le x \le m_i-1 $ satisfying $ x \equiv c \pmod {m_i} $ . Go to the next vertex and go back to step 2.
It's obvious that a travel never ends, since the 2nd and the 3rd step will be repeated endlessly.
For example, assume that Gildong starts at vertex $ 1 $ with $ c = 5 $ , and $ m_1 = 2 $ , $ e_1[0] = 1 $ , $ e_1[1] = 2 $ , $ k_1 = -3 $ . Right after he starts at vertex $ 1 $ , $ c $ becomes $ 2 $ . Since the only integer $ x $ ( $ 0 \le x \le 1 $ ) where $ x \equiv c \pmod {m_i} $ is $ 0 $ , Gildong goes to vertex $ e_1[0] = 1 $ . After arriving at vertex $ 1 $ again, $ c $ becomes $ -1 $ . The only integer $ x $ satisfying the conditions is $ 1 $ , so he goes to vertex $ e_1[1] = 2 $ , and so on.
Since Gildong is quite inquisitive, he's going to ask you $ q $ queries. He wants to know how many distinct vertices will be visited infinitely many times, if he starts the travel from a certain vertex with a certain value of $ c $ . Note that you should not count the vertices that will be visited only finite times.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line of the input contains an integer $ n $ ( $ 1 \le n \le 1000 $ ), the number of vertices in the graph.
The second line contains $ n $ integers. The $ i $ -th integer is $ k_i $ ( $ -10^9 \le k_i \le 10^9 $ ), the integer written on the $ i $ -th vertex.
Next $ 2 \cdot n $ lines describe the edges of each vertex. The $ (2 \cdot i + 1) $ -st line contains an integer $ m_i $ ( $ 1 \le m_i \le 10 $ ), the number of outgoing edges of the $ i $ -th vertex. The $ (2 \cdot i + 2) $ -nd line contains $ m_i $ integers $ e_i[0] $ , $ e_i[1] $ , $ \ldots $ , $ e_i[m_i-1] $ , each having an integer value between $ 1 $ and $ n $ , inclusive.
Next line contains an integer $ q $ ( $ 1 \le q \le 10^5 $ ), the number of queries Gildong wants to ask.
Next $ q $ lines contains two integers $ x $ and $ y $ ( $ 1 \le x \le n $ , $ -10^9 \le y \le 10^9 $ ) each, which mean that the start vertex is $ x $ and the starting value of $ c $ is $ y $ .</div>
<h3>输出格式</h3>
<br />
<div>For each query, print the number of distinct vertices that will be visited infinitely many times, if Gildong starts at vertex $ x $ with starting integer $ y $ .</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>
4
0 0 0 0
2
2 3
1
2
3
2 4 1
4
3 1 2 1
6
1 0
2 0
3 -1
4 -2
1 1
1 5
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>
1
1
2
1
3
2
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>
4
4 -5 -3 -1
2
2 3
1
2
3
2 4 1
4
3 1 2 1
6
1 0
2 0
3 -1
4 -2
1 1
1 5
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>
1
1
1
3
1
1
</code></pre>
<h2>说明</h2>
<div>The first example can be shown like the following image:
![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1200F/a011bde48ef56a4766df088c213c0f3fb6972396.png)Three integers are marked on $ i $ -th vertex: $ i $ , $ k_i $ , and $ m_i $ respectively. The outgoing edges are labeled with an integer representing the edge number of $ i $ -th vertex.
The travel for each query works as follows. It is described as a sequence of phrases, each in the format "vertex ( $ c $ after $ k_i $ added)".
- $ 1(0) \to 2(0) \to 2(0) \to \ldots $
- $ 2(0) \to 2(0) \to \ldots $
- $ 3(-1) \to 1(-1) \to 3(-1) \to \ldots $
- $ 4(-2) \to 2(-2) \to 2(-2) \to \ldots $
- $ 1(1) \to 3(1) \to 4(1) \to 1(1) \to \ldots $
- $ 1(5) \to 3(5) \to 1(5) \to \ldots $
The second example is same as the first example, except that the vertices have non-zero values. Therefore the answers to the queries also differ from the first example.
![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1200F/fa2b54acddea0c522ade11c446830a8460d01a6b.png)The queries for the second example works as follows:
- $ 1(4) \to 2(-1) \to 2(-6) \to \ldots $
- $ 2(-5) \to 2(-10) \to \ldots $
- $ 3(-4) \to 1(0) \to 2(-5) \to 2(-10) \to \ldots $
- $ 4(-3) \to 1(1) \to 3(-2) \to 4(-3) \to \ldots $
- $ 1(5) \to 3(2) \to 1(6) \to 2(1) \to 2(-4) \to \ldots $
- $ 1(9) \to 3(6) \to 2(1) \to 2(-4) \to \ldots $</div>
</article>
</div>
</div>
</body>
</html>
