<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Legen... - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573396773:SDUszM2Ry15hF2hcPoFgrszK+/LCdL9Yqboq5yKRZ3o=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%22%2C%22description%22%3A%22Barney%20was%20hanging%20out%20with%20Nora%20for%20a%20while%20and%20now%20he%20thinks%20he%20may%20have%20feelings%20for%20her.%20Barney%20wants%20to%20send%20her%20a%20cheesy%20text%20message%20and%20wants%20to%20make%20her%20as%20happy%20as%20possible.%5Cn%5Cn%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF696D%5C%2F5ab3ea47563ae6400cc578e63bb9e0de4cf3a082.png%29Initially%2C%20happiness%20level%20of%20Nora%20is%20%24%200%20%24%20.%20Nora%20loves%20some%20pickup%20lines%20like%20%5C%22I%27m%20falling%20for%20you%5C%22%20and%20stuff.%20Totally%2C%20she%20knows%20%24%20n%20%24%20pickup%20lines%2C%20each%20consisting%20only%20of%20lowercase%20English%20letters%2C%20also%20some%20of%20them%20may%20be%20equal%20%28in%20writing%2C%20but%20different%20in%20pronouncing%20or%20meaning%20though%29.%20Every%20time%20Nora%20sees%20%24%20i%20%24%20-th%20pickup%20line%20as%20a%20consecutive%20subsequence%20of%20Barney%27s%20text%20message%20her%20happiness%20level%20increases%20by%20%24%20a_%7Bi%7D%20%24%20.%20These%20substrings%20may%20overlap%2C%20for%20example%2C%20Nora%20will%20see%20the%20pickup%20line%20aa%20twice%20and%20the%20pickup%20line%20ab%20once%20in%20text%20message%20aaab.%5Cn%5CnDue%20to%20texting%20app%20limits%2C%20Barney%27s%20text%20may%20have%20up%20to%20%24%20l%20%24%20characters.%5Cn%5CnBarney%20asked%20you%20to%20help%20him%20make%20Nora%20as%20much%20happy%20as%20possible%2C%20it%27s%20gonna%20be%20legen...%22%2C%22inputFormat%22%3A%22The%20first%20line%20of%20input%20contains%20two%20integers%20%24%20n%20%24%20and%20%24%20l%20%24%20%28%20%24%201%3C%3Dn%3C%3D200%2C1%3C%3Dl%3C%3D10%5E%7B14%7D%20%24%20%29%20%5Cu2014%20the%20number%20of%20pickup%20lines%20and%20the%20maximum%20length%20of%20Barney%27s%20text.%5Cn%5CnThe%20second%20line%20contains%20%24%20n%20%24%20integers%20%24%20a_%7B1%7D%2Ca_%7B2%7D%2C...%2Ca_%7Bn%7D%20%24%20%28%20%24%201%3C%3Da_%7Bi%7D%3C%3D100%20%24%20%29%2C%20meaning%20that%20Nora%27s%20happiness%20level%20increases%20by%20%24%20a_%7Bi%7D%20%24%20after%20every%20time%20seeing%20%24%20i%20%24%20-th%20pickup%20line.%5Cn%5CnThe%20next%20%24%20n%20%24%20lines%20contain%20the%20pickup%20lines.%20%24%20i%20%24%20-th%20of%20them%20contains%20a%20single%20string%20%24%20s_%7Bi%7D%20%24%20consisting%20of%20only%20English%20lowercase%20letter.%20Summary%20length%20of%20all%20pickup%20lines%20does%20not%20exceed%20%24%20200%20%24%20.%5Cn%5CnAll%20strings%20are%20not%20empty.%22%2C%22outputFormat%22%3A%22Print%20the%20only%20integer%20%5Cu2014%20the%20maximum%20possible%20value%20of%20Nora%27s%20happiness%20level%20after%20reading%20Barney%27s%20text.%22%2C%22samples%22%3A%5B%5B%223%206%5Cn3%202%201%5Cnheart%5Cnearth%5Cnart%5Cn%22%2C%226%5Cn%22%5D%2C%5B%223%206%5Cn3%202%208%5Cnheart%5Cnearth%5Cnart%5Cn%22%2C%2216%5Cn%22%5D%5D%2C%22hint%22%3A%22An%20optimal%20answer%20for%20the%20first%20sample%20case%20is%20hearth%20containing%20each%20pickup%20line%20exactly%20once.%5Cn%5CnAn%20optimal%20answer%20for%20the%20second%20sample%20case%20is%20artart.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B6000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F696%5C%2FD%22%2C%22id%22%3A%22696D%22%7D%2C%22translation%22%3A%22%5Cn%5CnBarney%5Cu4e0eNora%5Cu4e00%5Cu8d77%5Cu73a9%5Cu7684%5Cu65f6%5Cu5019%5Cuff0c%5Cu89c9%5Cu5f97%5Cu81ea%5Cu5df1%5Cu559c%5Cu6b22%5Cu4e0aNora%5Cu4e86%5Cu3002%5Cu4ed6%5Cu60f3%5Cu7ed9%5Cu5979%5Cu53d1%5Cu4e00%5Cu6bb5%5Cu4fe1%5Cu606f%5Cu8ba9%5Cu5979%5Cu5f00%5Cu5fc3%5Cu3002%5Cn%5CnNora%5Cu7684%5Cu521d%5Cu59cb%5Cu5feb%5Cu4e50%5Cu503c%5Cu662f0%20%5Cu3002Nora%5Cu559c%5Cu6b22%5Cu201c%5Cu6211%5Cu6df1%5Cu6df1%5Cu5730%5Cu7231%5Cu4e0a%5Cu4f60%5Cu4e86%5Cu201d%5Cu8fd9%5Cu6837%5Cu7684%5Cu60c5%5Cu8bdd%5Cu3002%5Cu5979%5Cu4e00%5Cu5171%5Cu77e5%5Cu9053n%5Cu53e5%5Cu60c5%5Cu8bdd%5Cuff0c%5Cu6bcf%5Cu53e5%5Cu4ec5%5Cu5305%5Cu542b%5Cu5c0f%5Cu5199%5Cu82f1%5Cu6587%5Cu5b57%5Cu6bcd%5Cuff0c%5Cu5176%5Cu4e2d%5Cu7684%5Cu4e00%5Cu4e9b%5Cu53ef%5Cu80fd%5Cu76f8%5Cu540c%5Cuff08%5Cu5199%5Cu6cd5%5Cu76f8%5Cu540c%5Cuff0c%5Cu4f46%5Cu8bfb%5Cu97f3%5Cu6216%5Cu610f%5Cu601d%5Cu662f%5Cu4e0d%5Cu540c%5Cu7684%5Cuff09%5Cu3002%5Cu6bcf%5Cu6b21Nora%5Cu5728Barney%5Cu7684%5Cu4fe1%5Cu606f%5Cu4e2d%5Cu770b%5Cu5230%5Cu7b2ci%5Cu53e5%5Cu60c5%5Cu8bdd%5Cuff0c%5Cu5979%5Cu7684%5Cu5feb%5Cu4e50%5Cu503c%5Cu5c31%5Cu4f1a%5Cu589e%5Cu52a0%24a_i%24%20%5Cu3002%5Cu8fd9%5Cu4e9b%5Cu60c5%5Cu8bdd%5Cu5728%5Cu4fe1%5Cu606f%5Cu4e2d%5Cu53ef%5Cu80fd%5Cu91cd%5Cu53e0%5Cu3002%5Cu4f8b%5Cu5982%5Cuff0c%5Cu5728aaab%20%5Cu4e2d%5Cuff0cNora%5Cu4f1a%5Cu770b%5Cu5230aa%20%5Cu4e24%5Cu6b21%5Cuff0c%5Cu770b%5Cu5230ab%20%5Cu4e00%5Cu6b21%5Cu3002%5Cn%5Cn%5Cu56e0%5Cu4e3a%5Cu77ed%5Cu4fe1%5Cu7684%5Cu957f%5Cu5ea6%5Cu9650%5Cu5236%5Cuff0cBarney%5Cu7684%5Cu77ed%5Cu4fe1%5Cu6700%5Cu957f%5Cu542b%5Cu6709lll%20%5Cu4e2a%5Cu5b57%5Cu7b26%5Cu3002Barney%5Cu60f3%5Cu8ba9%5Cu4f60%5Cu5e2e%5Cu4ed6%5Cu8ba9Nora%5Cu5c3d%5Cu53ef%5Cu80fd%5Cu5f00%5Cu5fc3%5Cu3002%5Cn%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A40%2C%22totalAccepted%22%3A26%2C%22pid%22%3A%22CF696D%22%2C%22title%22%3A%22Legen...%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A34907%2C%22title%22%3A%22%5Cu7ffb%5Cu8bd1%22%2C%22forum%22%3A%7B%22id%22%3A9879%2C%22name%22%3A%22CF696D%20Legen...%22%2C%22slug%22%3A%22CF696D%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Legen...%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573306449;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Legen...</h1>
<h2>题意翻译</h2>
<div>
Barney与Nora一起玩的时候，觉得自己喜欢上Nora了。他想给她发一段信息让她开心。
Nora的初始快乐值是0 。Nora喜欢“我深深地爱上你了”这样的情话。她一共知道n句情话，每句仅包含小写英文字母，其中的一些可能相同（写法相同，但读音或意思是不同的）。每次Nora在Barney的信息中看到第i句情话，她的快乐值就会增加$a_i$ 。这些情话在信息中可能重叠。例如，在aaab 中，Nora会看到aa 两次，看到ab 一次。
因为短信的长度限制，Barney的短信最长含有lll 个字符。Barney想让你帮他让Nora尽可能开心。
</div>
<h2>题目描述</h2>
<div>Barney was hanging out with Nora for a while and now he thinks he may have feelings for her. Barney wants to send her a cheesy text message and wants to make her as happy as possible.
![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF696D/5ab3ea47563ae6400cc578e63bb9e0de4cf3a082.png)Initially, happiness level of Nora is $ 0 $ . Nora loves some pickup lines like "I'm falling for you" and stuff. Totally, she knows $ n $ pickup lines, each consisting only of lowercase English letters, also some of them may be equal (in writing, but different in pronouncing or meaning though). Every time Nora sees $ i $ -th pickup line as a consecutive subsequence of Barney's text message her happiness level increases by $ a_{i} $ . These substrings may overlap, for example, Nora will see the pickup line aa twice and the pickup line ab once in text message aaab.
Due to texting app limits, Barney's text may have up to $ l $ characters.
Barney asked you to help him make Nora as much happy as possible, it's gonna be legen...</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line of input contains two integers $ n $ and $ l $ ( $ 1<=n<=200,1<=l<=10^{14} $ ) — the number of pickup lines and the maximum length of Barney's text.
The second line contains $ n $ integers $ a_{1},a_{2},...,a_{n} $ ( $ 1<=a_{i}<=100 $ ), meaning that Nora's happiness level increases by $ a_{i} $ after every time seeing $ i $ -th pickup line.
The next $ n $ lines contain the pickup lines. $ i $ -th of them contains a single string $ s_{i} $ consisting of only English lowercase letter. Summary length of all pickup lines does not exceed $ 200 $ .
All strings are not empty.</div>
<h3>输出格式</h3>
<br />
<div>Print the only integer — the maximum possible value of Nora's happiness level after reading Barney's text.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>3 6
3 2 1
heart
earth
art
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>6
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>3 6
3 2 8
heart
earth
art
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>16
</code></pre>
<h2>说明</h2>
<div>An optimal answer for the first sample case is hearth containing each pickup line exactly once.
An optimal answer for the second sample case is artart.</div>
</article>
</div>
</div>
</body>
</html>
