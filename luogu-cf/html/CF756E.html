<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Byteland coins - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573397506:L4Dk/to7zMV1LBWDJxQJ1gfoH0oEYlxtjAlDgEAoTrM=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22There%20are%20%24%20n%20%24%20types%20of%20coins%20in%20Byteland.%20Conveniently%2C%20the%20denomination%20of%20the%20coin%20type%20%24%20k%20%24%20divides%20the%20denomination%20of%20the%20coin%20type%20%24%20k%2B1%20%24%20%2C%20the%20denomination%20of%20the%20coin%20type%20%24%201%20%24%20equals%20%24%201%20%24%20tugrick.%20The%20ratio%20of%20the%20denominations%20of%20coin%20types%20%24%20k%2B1%20%24%20and%20%24%20k%20%24%20equals%20%24%20a_%7Bk%7D%20%24%20.%20It%20is%20known%20that%20for%20each%20%24%20x%20%24%20there%20are%20at%20most%2020%20coin%20types%20of%20denomination%20%24%20x%20%24%20.%5Cn%5CnByteasar%20has%20%24%20b_%7Bk%7D%20%24%20coins%20of%20type%20%24%20k%20%24%20with%20him%2C%20and%20he%20needs%20to%20pay%20exactly%20%24%20m%20%24%20tugricks.%20It%20is%20known%20that%20Byteasar%20never%20has%20more%20than%20%24%203%5Cu00b710%5E%7B5%7D%20%24%20coins%20with%20him.%20Byteasar%20want%20to%20know%20how%20many%20ways%20there%20are%20to%20pay%20exactly%20%24%20m%20%24%20tugricks.%20Two%20ways%20are%20different%20if%20there%20is%20an%20integer%20%24%20k%20%24%20such%20that%20the%20amount%20of%20coins%20of%20type%20%24%20k%20%24%20differs%20in%20these%20two%20ways.%20As%20all%20Byteland%20citizens%2C%20Byteasar%20wants%20to%20know%20the%20number%20of%20ways%20modulo%20%24%2010%5E%7B9%7D%2B7%20%24%20.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20single%20integer%20%24%20n%20%24%20%28%20%24%201%3C%3Dn%3C%3D3%5Cu00b710%5E%7B5%7D%20%24%20%29%20%5Cu2014%20the%20number%20of%20coin%20types.%5Cn%5CnThe%20second%20line%20contains%20%24%20n-1%20%24%20integers%20%24%20a_%7B1%7D%20%24%20%2C%20%24%20a_%7B2%7D%20%24%20%2C%20%24%20...%20%24%20%2C%20%24%20a_%7Bn-1%7D%20%24%20%28%20%24%201%3C%3Da_%7Bk%7D%3C%3D10%5E%7B9%7D%20%24%20%29%20%5Cu2014%20the%20ratios%20between%20the%20coin%20types%20denominations.%20It%20is%20guaranteed%20that%20for%20each%20%24%20x%20%24%20there%20are%20at%20most%2020%20coin%20types%20of%20denomination%20%24%20x%20%24%20.%5Cn%5CnThe%20third%20line%20contains%20%24%20n%20%24%20non-negative%20integers%20%24%20b_%7B1%7D%20%24%20%2C%20%24%20b_%7B2%7D%20%24%20%2C%20%24%20...%20%24%20%2C%20%24%20b_%7Bn%7D%20%24%20%5Cu2014%20the%20number%20of%20coins%20of%20each%20type%20Byteasar%20has.%20It%20is%20guaranteed%20that%20the%20sum%20of%20these%20integers%20doesn%27t%20exceed%20%24%203%5Cu00b710%5E%7B5%7D%20%24%20.%5Cn%5CnThe%20fourth%20line%20contains%20single%20integer%20%24%20m%20%24%20%28%20%24%200%3C%3Dm%26lt%3B10%5E%7B10000%7D%20%24%20%29%20%5Cu2014%20the%20amount%20in%20tugricks%20Byteasar%20needs%20to%20pay.%22%2C%22outputFormat%22%3A%22Print%20single%20integer%20%5Cu2014%20the%20number%20of%20ways%20to%20pay%20exactly%20%24%20m%20%24%20tugricks%20modulo%20%24%2010%5E%7B9%7D%2B7%20%24%20.%22%2C%22samples%22%3A%5B%5B%221%5Cn%5Cn4%5Cn2%5Cn%22%2C%221%5Cn%22%5D%2C%5B%222%5Cn1%5Cn4%204%5Cn2%5Cn%22%2C%223%5Cn%22%5D%2C%5B%223%5Cn3%203%5Cn10%2010%2010%5Cn17%5Cn%22%2C%226%5Cn%22%5D%5D%2C%22hint%22%3A%22In%20the%20first%20example%20Byteasar%20has%20%24%204%20%24%20coins%20of%20denomination%20%24%201%20%24%20%2C%20and%20he%20has%20to%20pay%20%24%202%20%24%20tugricks.%20There%20is%20only%20one%20way.%5Cn%5CnIn%20the%20second%20example%20Byteasar%20has%20%24%204%20%24%20coins%20of%20each%20of%20two%20different%20types%20of%20denomination%20%24%201%20%24%20%2C%20he%20has%20to%20pay%20%24%202%20%24%20tugricks.%20There%20are%20%24%203%20%24%20ways%3A%20pay%20one%20coin%20of%20the%20first%20type%20and%20one%20coin%20of%20the%20other%2C%20pay%20two%20coins%20of%20the%20first%20type%2C%20and%20pay%20two%20coins%20of%20the%20second%20type.%5Cn%5CnIn%20the%20third%20example%20the%20denominations%20are%20equal%20to%20%24%201%20%24%20%2C%20%24%203%20%24%20%2C%20%24%209%20%24%20.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%5D%2C%22memory%22%3A%5B512000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F756%5C%2FE%22%2C%22id%22%3A%22756E%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22CF756E%22%2C%22title%22%3A%22Byteland%20coins%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Byteland%20coins%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Byteland coins</h1>
<h2>题目描述</h2>
<div>There are $ n $ types of coins in Byteland. Conveniently, the denomination of the coin type $ k $ divides the denomination of the coin type $ k+1 $ , the denomination of the coin type $ 1 $ equals $ 1 $ tugrick. The ratio of the denominations of coin types $ k+1 $ and $ k $ equals $ a_{k} $ . It is known that for each $ x $ there are at most 20 coin types of denomination $ x $ .
Byteasar has $ b_{k} $ coins of type $ k $ with him, and he needs to pay exactly $ m $ tugricks. It is known that Byteasar never has more than $ 3·10^{5} $ coins with him. Byteasar want to know how many ways there are to pay exactly $ m $ tugricks. Two ways are different if there is an integer $ k $ such that the amount of coins of type $ k $ differs in these two ways. As all Byteland citizens, Byteasar wants to know the number of ways modulo $ 10^{9}+7 $ .</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains single integer $ n $ ( $ 1<=n<=3·10^{5} $ ) — the number of coin types.
The second line contains $ n-1 $ integers $ a_{1} $ , $ a_{2} $ , $ ... $ , $ a_{n-1} $ ( $ 1<=a_{k}<=10^{9} $ ) — the ratios between the coin types denominations. It is guaranteed that for each $ x $ there are at most 20 coin types of denomination $ x $ .
The third line contains $ n $ non-negative integers $ b_{1} $ , $ b_{2} $ , $ ... $ , $ b_{n} $ — the number of coins of each type Byteasar has. It is guaranteed that the sum of these integers doesn't exceed $ 3·10^{5} $ .
The fourth line contains single integer $ m $ ( $ 0<=m&lt;10^{10000} $ ) — the amount in tugricks Byteasar needs to pay.</div>
<h3>输出格式</h3>
<br />
<div>Print single integer — the number of ways to pay exactly $ m $ tugricks modulo $ 10^{9}+7 $ .</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>1

4
2
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>1
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>2
1
4 4
2
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>3
</code></pre>
<h3>输入样例 #3</h3>
<pre><code>3
3 3
10 10 10
17
</code></pre>
<h3>输出样例 #3</h3>
<pre><code>6
</code></pre>
<h2>说明</h2>
<div>In the first example Byteasar has $ 4 $ coins of denomination $ 1 $ , and he has to pay $ 2 $ tugricks. There is only one way.
In the second example Byteasar has $ 4 $ coins of each of two different types of denomination $ 1 $ , he has to pay $ 2 $ tugricks. There are $ 3 $ ways: pay one coin of the first type and one coin of the other, pay two coins of the first type, and pay two coins of the second type.
In the third example the denominations are equal to $ 1 $ , $ 3 $ , $ 9 $ .</div>
</article>
</div>
</div>
</body>
</html>
