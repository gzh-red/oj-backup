<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Rooter&#039;s Song - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573398587:KMHZfO52qvk6lAMsuDSyw26+e/JwRSDl3xE4fhOs968=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Wherever%20the%20destination%20is%2C%20whoever%20we%20meet%2C%20let%27s%20render%20this%20song%20together.%5Cn%5CnOn%20a%20Cartesian%20coordinate%20plane%20lies%20a%20rectangular%20stage%20of%20size%20%24%20w%5Cu00d7h%20%24%20%2C%20represented%20by%20a%20rectangle%20with%20corners%20%24%20%280%2C0%29%20%24%20%2C%20%24%20%28w%2C0%29%20%24%20%2C%20%24%20%28w%2Ch%29%20%24%20and%20%24%20%280%2Ch%29%20%24%20.%20It%20can%20be%20seen%20that%20no%20collisions%20will%20happen%20before%20one%20enters%20the%20stage.%5Cn%5CnOn%20the%20sides%20of%20the%20stage%20stand%20%24%20n%20%24%20dancers.%20The%20%24%20i%20%24%20-th%20of%20them%20falls%20into%20one%20of%20the%20following%20groups%3A%5Cn%5Cn-%20Vertical%3A%20stands%20at%20%24%20%28x_%7Bi%7D%2C0%29%20%24%20%2C%20moves%20in%20positive%20%24%20y%20%24%20direction%20%28upwards%29%3B%5Cn-%20Horizontal%3A%20stands%20at%20%24%20%280%2Cy_%7Bi%7D%29%20%24%20%2C%20moves%20in%20positive%20%24%20x%20%24%20direction%20%28rightwards%29.%5Cn%5Cn%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF848B%5C%2F78a4617a270ecba0555a87f4deb825cf1f501330.png%29According%20to%20choreography%2C%20the%20%24%20i%20%24%20-th%20dancer%20should%20stand%20still%20for%20the%20first%20%24%20t_%7Bi%7D%20%24%20milliseconds%2C%20and%20then%20start%20moving%20in%20the%20specified%20direction%20at%20%24%201%20%24%20unit%20per%20millisecond%2C%20until%20another%20border%20is%20reached.%20It%20is%20guaranteed%20that%20no%20two%20dancers%20have%20the%20same%20group%2C%20position%20and%20waiting%20time%20at%20the%20same%20time.%5Cn%5CnWhen%20two%20dancers%20collide%20%28i.e.%20are%20on%20the%20same%20point%20at%20some%20time%20when%20both%20of%20them%20are%20moving%29%2C%20they%20immediately%20exchange%20their%20moving%20directions%20and%20go%20on.%5Cn%5Cn%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF848B%5C%2F14a342567b0e0e96e2854bafb4e39a8b293ebae4.png%29Dancers%20stop%20when%20a%20border%20of%20the%20stage%20is%20reached.%20Find%20out%20every%20dancer%27s%20stopping%20position.%22%2C%22inputFormat%22%3A%22The%20first%20line%20of%20input%20contains%20three%20space-separated%20positive%20integers%20%24%20n%20%24%20%2C%20%24%20w%20%24%20and%20%24%20h%20%24%20%28%20%24%201%3C%3Dn%3C%3D100000%20%24%20%2C%20%24%202%3C%3Dw%2Ch%3C%3D100000%20%24%20%29%20%5Cu2014%20the%20number%20of%20dancers%20and%20the%20width%20and%20height%20of%20the%20stage%2C%20respectively.%5Cn%5CnThe%20following%20%24%20n%20%24%20lines%20each%20describes%20a%20dancer%3A%20the%20%24%20i%20%24%20-th%20among%20them%20contains%20three%20space-separated%20integers%20%24%20g_%7Bi%7D%20%24%20%2C%20%24%20p_%7Bi%7D%20%24%20%2C%20and%20%24%20t_%7Bi%7D%20%24%20%28%20%24%201%3C%3Dg_%7Bi%7D%3C%3D2%20%24%20%2C%20%24%201%3C%3Dp_%7Bi%7D%3C%3D99999%20%24%20%2C%20%24%200%3C%3Dt_%7Bi%7D%3C%3D100000%20%24%20%29%2C%20describing%20a%20dancer%27s%20group%20%24%20g_%7Bi%7D%20%24%20%28%20%24%20g_%7Bi%7D%3D1%20%24%20%5Cu2014%20vertical%2C%20%24%20g_%7Bi%7D%3D2%20%24%20%5Cu2014%20horizontal%29%2C%20position%2C%20and%20waiting%20time.%20If%20%24%20g_%7Bi%7D%3D1%20%24%20then%20%24%20p_%7Bi%7D%3Dx_%7Bi%7D%20%24%20%3B%20otherwise%20%24%20p_%7Bi%7D%3Dy_%7Bi%7D%20%24%20.%20It%27s%20guaranteed%20that%20%24%201%3C%3Dx_%7Bi%7D%3C%3Dw-1%20%24%20and%20%24%201%3C%3Dy_%7Bi%7D%3C%3Dh-1%20%24%20.%20It%20is%20guaranteed%20that%20no%20two%20dancers%20have%20the%20same%20group%2C%20position%20and%20waiting%20time%20at%20the%20same%20time.%22%2C%22outputFormat%22%3A%22Output%20%24%20n%20%24%20lines%2C%20the%20%24%20i%20%24%20-th%20of%20which%20contains%20two%20space-separated%20integers%20%24%20%28x_%7Bi%7D%2Cy_%7Bi%7D%29%20%24%20%5Cu2014%20the%20stopping%20position%20of%20the%20%24%20i%20%24%20-th%20dancer%20in%20the%20input.%22%2C%22samples%22%3A%5B%5B%228%2010%208%5Cn1%201%2010%5Cn1%204%2013%5Cn1%207%201%5Cn1%208%202%5Cn2%202%200%5Cn2%205%2014%5Cn2%206%200%5Cn2%206%201%5Cn%22%2C%224%208%5Cn10%205%5Cn8%208%5Cn10%206%5Cn10%202%5Cn1%208%5Cn7%208%5Cn10%206%5Cn%22%5D%2C%5B%223%202%203%5Cn1%201%202%5Cn2%201%201%5Cn1%201%205%5Cn%22%2C%221%203%5Cn2%201%5Cn1%203%5Cn%22%5D%5D%2C%22hint%22%3A%22The%20first%20example%20corresponds%20to%20the%20initial%20setup%20in%20the%20legend%2C%20and%20the%20tracks%20of%20dancers%20are%20marked%20with%20different%20colours%20in%20the%20following%20figure.%5Cn%5Cn%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF848B%5C%2Fd441e2a826ff927d107333215574de12d2f00a07.png%29In%20the%20second%20example%2C%20no%20dancers%20collide.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F848%5C%2FB%22%2C%22id%22%3A%22848B%22%7D%2C%22translation%22%3A%22%5Cu597d%5Cu591a%5Cu4e2a%5Cu4eba%5Cu5206%5Cu522b%5Cu4ecex%2Cy%5Cu8f74%5Cu4e0d%5Cu540c%5Cu4f4d%5Cu7f6e%5Cu4e0d%5Cu540c%5Cu65f6%5Cu95f4%5Cu5f80%5Cu5782%5Cu76f4%5Cu5750%5Cu6807%5Cu8f74%5Cu65b9%5Cu5411%5Cu79fb%5Cu52a8%5Cuff0c%5Cu4e00%5Cu65e6%5Cu76f8%5Cu9047%5Cu4ed6%5Cu4eec%5Cu8f6c%5Cu5411%5Cuff0c%5Cu95ee%5Cu6240%5Cu6709%5Cu4eba%5Cu7684%5Cu5230%5Cu8fbe%5Cu8fb9%5Cu7f18%5Cu7684%5Cu4f4d%5Cu7f6e%5Cu3002%22%2C%22tags%22%3A%5B1%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A44%2C%22totalAccepted%22%3A17%2C%22pid%22%3A%22CF848B%22%2C%22title%22%3A%22Rooter%27s%20Song%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Rooter%27s%20Song%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Rooter&#039;s Song</h1>
<h2>题意翻译</h2>
<div>好多个人分别从x,y轴不同位置不同时间往垂直坐标轴方向移动，一旦相遇他们转向，问所有人的到达边缘的位置。</div>
<h2>题目描述</h2>
<div>Wherever the destination is, whoever we meet, let's render this song together.
On a Cartesian coordinate plane lies a rectangular stage of size $ w×h $ , represented by a rectangle with corners $ (0,0) $ , $ (w,0) $ , $ (w,h) $ and $ (0,h) $ . It can be seen that no collisions will happen before one enters the stage.
On the sides of the stage stand $ n $ dancers. The $ i $ -th of them falls into one of the following groups:
- Vertical: stands at $ (x_{i},0) $ , moves in positive $ y $ direction (upwards);
- Horizontal: stands at $ (0,y_{i}) $ , moves in positive $ x $ direction (rightwards).
![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF848B/78a4617a270ecba0555a87f4deb825cf1f501330.png)According to choreography, the $ i $ -th dancer should stand still for the first $ t_{i} $ milliseconds, and then start moving in the specified direction at $ 1 $ unit per millisecond, until another border is reached. It is guaranteed that no two dancers have the same group, position and waiting time at the same time.
When two dancers collide (i.e. are on the same point at some time when both of them are moving), they immediately exchange their moving directions and go on.
![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF848B/14a342567b0e0e96e2854bafb4e39a8b293ebae4.png)Dancers stop when a border of the stage is reached. Find out every dancer's stopping position.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line of input contains three space-separated positive integers $ n $ , $ w $ and $ h $ ( $ 1<=n<=100000 $ , $ 2<=w,h<=100000 $ ) — the number of dancers and the width and height of the stage, respectively.
The following $ n $ lines each describes a dancer: the $ i $ -th among them contains three space-separated integers $ g_{i} $ , $ p_{i} $ , and $ t_{i} $ ( $ 1<=g_{i}<=2 $ , $ 1<=p_{i}<=99999 $ , $ 0<=t_{i}<=100000 $ ), describing a dancer's group $ g_{i} $ ( $ g_{i}=1 $ — vertical, $ g_{i}=2 $ — horizontal), position, and waiting time. If $ g_{i}=1 $ then $ p_{i}=x_{i} $ ; otherwise $ p_{i}=y_{i} $ . It's guaranteed that $ 1<=x_{i}<=w-1 $ and $ 1<=y_{i}<=h-1 $ . It is guaranteed that no two dancers have the same group, position and waiting time at the same time.</div>
<h3>输出格式</h3>
<br />
<div>Output $ n $ lines, the $ i $ -th of which contains two space-separated integers $ (x_{i},y_{i}) $ — the stopping position of the $ i $ -th dancer in the input.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>8 10 8
1 1 10
1 4 13
1 7 1
1 8 2
2 2 0
2 5 14
2 6 0
2 6 1
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>4 8
10 5
8 8
10 6
10 2
1 8
7 8
10 6
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>3 2 3
1 1 2
2 1 1
1 1 5
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>1 3
2 1
1 3
</code></pre>
<h2>说明</h2>
<div>The first example corresponds to the initial setup in the legend, and the tracks of dancers are marked with different colours in the following figure.
![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF848B/d441e2a826ff927d107333215574de12d2f00a07.png)In the second example, no dancers collide.</div>
</article>
</div>
</div>
</body>
</html>
