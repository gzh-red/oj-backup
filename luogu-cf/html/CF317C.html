<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Balance - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573392630:D2xrM9RE8SS0NpYB4GApqu/AHQc61qM/g3iFkfAmye8=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22A%20system%20of%20%24%20n%20%24%20vessels%20with%20water%20is%20given.%20Several%20pairs%20of%20vessels%20are%20connected%20by%20tubes%20with%20transfusion%20mechanisms.%20One%20may%20transfer%20an%20integer%20amount%20of%20liters%20of%20water%20between%20two%20vessels%20connected%20by%20such%20tube%20%28tube%20works%20in%20both%20directions%29.%20There%20might%20be%20multiple%20tubes%20between%20two%20vessels.%20Total%20number%20of%20tubes%20equals%20%24%20e%20%24%20.%20Volume%20of%20each%20vessel%20equals%20%24%20v%20%24%20liters.%20Of%20course%2C%20the%20amount%20of%20the%20water%20in%20any%20vessel%20cannot%20exceed%20%24%20v%20%24%20liters%20in%20the%20process%20of%20transfusions.%5Cn%5CnGiven%20the%20initial%20amounts%20%24%20a_%7Bi%7D%20%24%20of%20water%20in%20the%20vessels%20and%20the%20desired%20amounts%20%24%20b_%7Bi%7D%20%24%20find%20a%20sequence%20of%20transfusions%20that%20deals%20with%20the%20task.%20Total%20number%20of%20transfusions%20must%20not%20exceed%20%24%202%5Cu00b7n%5E%7B2%7D%20%24%20.%22%2C%22inputFormat%22%3A%22First%20line%20of%20the%20input%20contains%20integers%20%24%20n%20%24%20%2C%20%24%20v%20%24%20%2C%20%24%20e%20%24%20%28%20%24%201%3C%3Dn%3C%3D300%20%24%20%2C%20%24%201%3C%3Dv%3C%3D10%5E%7B9%7D%20%24%20%2C%20%24%200%3C%3De%3C%3D50000%20%24%20%29.%5Cn%5CnNext%20two%20lines%20contain%20%24%20n%20%24%20integers%20each%3A%20initial%20%24%20a_%7Bi%7D%20%24%20and%20the%20desired%20amounts%20%24%20b_%7Bi%7D%20%24%20of%20water%20in%20corresponding%20vessels%20%28%20%24%200%3C%3Da_%7Bi%7D%2Cb_%7Bi%7D%3C%3Dv%20%24%20%29.%5Cn%5CnNext%20%24%20e%20%24%20lines%20describe%20one%20tube%20each%20in%20the%20format%20%24%20x%20%24%20%24%20y%20%24%20%28%20%24%201%3C%3Dx%2Cy%3C%3Dn%2Cx%5Cu2260y%20%24%20%29%20for%20a%20tube%20between%20vessels%20number%20%24%20x%20%24%20and%20%24%20y%20%24%20.%20There%20might%20be%20multiple%20tubes%20between%20two%20vessels.%20You%20may%20assume%20that%20vessels%20are%20numbered%20from%201%20to%20%24%20n%20%24%20in%20some%20way.%22%2C%22outputFormat%22%3A%22Print%20%5C%22NO%5C%22%20%28without%20quotes%29%2C%20if%20such%20sequence%20of%20transfusions%20does%20not%20exist.%5Cn%5CnOtherwise%20print%20any%20suitable%20sequence%20in%20the%20following%20format.%20On%20the%20first%20line%20print%20the%20total%20number%20of%20transfusions%20%24%20k%20%24%20%28%20%24%20k%20%24%20should%20not%20exceed%20%24%202%5Cu00b7n%5E%7B2%7D%20%24%20%29.%20In%20the%20following%20%24%20k%20%24%20lines%20print%20transfusions%20in%20the%20format%20%24%20x%20%24%20%24%20y%20%24%20%24%20d%20%24%20%28transfusion%20of%20%24%20d%20%24%20liters%20from%20the%20vessel%20number%20%24%20x%20%24%20to%20the%20vessel%20number%20%24%20y%20%24%20%2C%20%24%20x%20%24%20and%20%24%20y%20%24%20must%20be%20distinct%29.%20For%20all%20transfusions%20%24%20d%20%24%20must%20be%20a%20non-negative%20integer.%22%2C%22samples%22%3A%5B%5B%222%2010%201%5Cn1%209%5Cn5%205%5Cn1%202%5Cn%22%2C%221%5Cn2%201%204%5Cn%22%5D%2C%5B%222%2010%200%5Cn5%202%5Cn4%202%5Cn%22%2C%22NO%5Cn%22%5D%2C%5B%222%2010%200%5Cn4%202%5Cn4%202%5Cn%22%2C%220%5Cn%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F317%5C%2FC%22%2C%22id%22%3A%22317C%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A6%2C%22totalAccepted%22%3A2%2C%22pid%22%3A%22CF317C%22%2C%22title%22%3A%22Balance%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Balance%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573286098;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Balance</h1>
<h2>题目描述</h2>
<div>A system of $ n $ vessels with water is given. Several pairs of vessels are connected by tubes with transfusion mechanisms. One may transfer an integer amount of liters of water between two vessels connected by such tube (tube works in both directions). There might be multiple tubes between two vessels. Total number of tubes equals $ e $ . Volume of each vessel equals $ v $ liters. Of course, the amount of the water in any vessel cannot exceed $ v $ liters in the process of transfusions.
Given the initial amounts $ a_{i} $ of water in the vessels and the desired amounts $ b_{i} $ find a sequence of transfusions that deals with the task. Total number of transfusions must not exceed $ 2·n^{2} $ .</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>First line of the input contains integers $ n $ , $ v $ , $ e $ ( $ 1<=n<=300 $ , $ 1<=v<=10^{9} $ , $ 0<=e<=50000 $ ).
Next two lines contain $ n $ integers each: initial $ a_{i} $ and the desired amounts $ b_{i} $ of water in corresponding vessels ( $ 0<=a_{i},b_{i}<=v $ ).
Next $ e $ lines describe one tube each in the format $ x $ $ y $ ( $ 1<=x,y<=n,x≠y $ ) for a tube between vessels number $ x $ and $ y $ . There might be multiple tubes between two vessels. You may assume that vessels are numbered from 1 to $ n $ in some way.</div>
<h3>输出格式</h3>
<br />
<div>Print "NO" (without quotes), if such sequence of transfusions does not exist.
Otherwise print any suitable sequence in the following format. On the first line print the total number of transfusions $ k $ ( $ k $ should not exceed $ 2·n^{2} $ ). In the following $ k $ lines print transfusions in the format $ x $ $ y $ $ d $ (transfusion of $ d $ liters from the vessel number $ x $ to the vessel number $ y $ , $ x $ and $ y $ must be distinct). For all transfusions $ d $ must be a non-negative integer.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>2 10 1
1 9
5 5
1 2
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>1
2 1 4
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>2 10 0
5 2
4 2
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>NO
</code></pre>
<h3>输入样例 #3</h3>
<pre><code>2 10 0
4 2
4 2
</code></pre>
<h3>输出样例 #3</h3>
<pre><code>0
</code></pre>
</article>
</div>
</div>
</body>
</html>
