<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Election Promises - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573402299:xOj35ZGvM9B31+qJwbEsUM1CxEZbaQnIztSro7aLzPE=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22In%20Byteland%2C%20there%20are%20two%20political%20parties%20fighting%20for%20seats%20in%20the%20Parliament%20in%20the%20upcoming%20elections%3A%20Wrong%20Answer%20Party%20and%20Time%20Limit%20Exceeded%20Party.%20As%20they%20want%20to%20convince%20as%20many%20citizens%20as%20possible%20to%20cast%20their%20votes%20on%20them%2C%20they%20keep%20promising%20lower%20and%20lower%20taxes.%5Cn%5CnThere%20are%20%24%20n%20%24%20cities%20in%20Byteland%2C%20connected%20by%20%24%20m%20%24%20one-way%20roads.%20Interestingly%20enough%2C%20the%20road%20network%20has%20no%20cycles%20%5Cu2014%20it%27s%20impossible%20to%20start%20in%20any%20city%2C%20follow%20a%20number%20of%20roads%2C%20and%20return%20to%20that%20city.%20Last%20year%2C%20citizens%20of%20the%20%24%20i%20%24%20-th%20city%20had%20to%20pay%20%24%20h_i%20%24%20bourles%20of%20tax.%5Cn%5CnParties%20will%20now%20alternately%20hold%20the%20election%20conventions%20in%20various%20cities.%20If%20a%20party%20holds%20a%20convention%20in%20city%20%24%20v%20%24%20%2C%20the%20party%20needs%20to%20decrease%20the%20taxes%20in%20this%20city%20to%20a%20non-negative%20integer%20amount%20of%20bourles.%20However%2C%20at%20the%20same%20time%20they%20can%20arbitrarily%20modify%20the%20taxes%20in%20each%20of%20the%20cities%20that%20can%20be%20reached%20from%20%24%20v%20%24%20using%20a%20single%20road.%20The%20only%20condition%20that%20must%20be%20fulfilled%20that%20the%20tax%20in%20each%20city%20has%20to%20remain%20a%20non-negative%20integer%20amount%20of%20bourles.%5Cn%5CnThe%20first%20party%20to%20hold%20the%20convention%20is%20Wrong%20Answer%20Party.%20It%27s%20predicted%20that%20the%20party%20to%20hold%20the%20last%20convention%20will%20win%20the%20election.%20Can%20Wrong%20Answer%20Party%20win%20regardless%20of%20Time%20Limit%20Exceeded%20Party%27s%20moves%3F%22%2C%22inputFormat%22%3A%22The%20first%20line%20of%20the%20input%20contains%20two%20integers%20%24%20n%20%24%20%2C%20%24%20m%20%24%20%28%20%24%201%20%5C%5Cleq%20n%20%5C%5Cleq%20200%5C%5C%2C000%20%24%20%2C%20%24%200%20%5C%5Cleq%20m%20%5C%5Cleq%20200%5C%5C%2C000%20%24%20%29%20%5Cu2014%20the%20number%20of%20cities%20and%20roads%20in%20Byteland.%5Cn%5CnThe%20next%20line%20contains%20%24%20n%20%24%20space-separated%20integers%20%24%20h_1%2C%20h_2%2C%20%5C%5Cdots%2C%20h_n%20%24%20%28%20%24%200%20%5C%5Cleq%20h_i%20%5C%5Cleq%2010%5E9%20%24%20%29%3B%20%24%20h_i%20%24%20denotes%20the%20amount%20of%20taxes%20paid%20in%20the%20%24%20i%20%24%20-th%20city.%5Cn%5CnEach%20of%20the%20following%20%24%20m%20%24%20lines%20contains%20two%20integers%20%28%20%24%201%20%5C%5Cleq%20u%2C%20v%20%5C%5Cleq%20n%20%24%20%2C%20%24%20u%20%5C%5Cneq%20v%20%24%20%29%2C%20and%20describes%20a%20one-way%20road%20leading%20from%20the%20city%20%24%20u%20%24%20to%20the%20city%20%24%20v%20%24%20.%20There%20will%20be%20no%20cycles%20in%20the%20road%20network.%20No%20two%20roads%20will%20connect%20the%20same%20pair%20of%20cities.%5Cn%5CnWe%20can%20show%20that%20the%20conventions%20cannot%20be%20held%20indefinitely%20for%20any%20correct%20test%20case.%22%2C%22outputFormat%22%3A%22If%20Wrong%20Answer%20Party%20can%20win%20the%20election%2C%20output%20WIN%20in%20the%20first%20line%20of%20your%20output.%20In%20this%20case%2C%20you%27re%20additionally%20asked%20to%20produce%20any%20convention%20allowing%20the%20party%20to%20win%20regardless%20of%20the%20opponent%27s%20actions.%20The%20second%20line%20should%20contain%20%24%20n%20%24%20non-negative%20integers%20%24%20h%27_1%2C%20h%27_2%2C%20%5C%5Cdots%2C%20h%27_n%20%24%20%28%20%24%200%20%5C%5Cleq%20h%27_i%20%5C%5Cleq%202%20%5C%5Ccdot%2010%5E%7B18%7D%20%24%20%29%20describing%20the%20amount%20of%20taxes%20paid%20in%20consecutive%20cities%20after%20the%20convention.%20If%20there%20are%20multiple%20answers%2C%20output%20any.%20We%20guarantee%20that%20if%20the%20party%20has%20any%20winning%20move%2C%20there%20exists%20a%20move%20after%20which%20no%20city%20has%20to%20pay%20more%20than%20%24%202%20%5C%5Ccdot%2010%5E%7B18%7D%20%24%20bourles.%5Cn%5CnIf%20the%20party%20cannot%20assure%20their%20victory%2C%20output%20LOSE%20in%20the%20first%20and%20only%20line%20of%20the%20output.%22%2C%22samples%22%3A%5B%5B%22%5Cn4%202%5Cn2%201%201%205%5Cn1%202%5Cn3%204%5Cn%22%2C%22%5CnWIN%5Cn1%205%201%205%20%5Cn%22%5D%2C%5B%22%5Cn4%202%5Cn1%205%201%205%5Cn1%202%5Cn3%204%5Cn%22%2C%22%5CnLOSE%5Cn%22%5D%2C%5B%22%5Cn3%203%5Cn314%20159%20265%5Cn1%202%5Cn1%203%5Cn3%202%5Cn%22%2C%22%5CnWIN%5Cn0%200%200%20%5Cn%22%5D%2C%5B%22%5Cn6%204%5Cn2%202%205%205%206%206%5Cn1%203%5Cn2%204%5Cn3%205%5Cn4%206%5Cn%22%2C%22%5CnLOSE%5Cn%22%5D%5D%2C%22hint%22%3A%22In%20the%20first%20example%2C%20Wrong%20Answer%20Party%20should%20hold%20the%20convention%20in%20the%20city%20%24%201%20%24%20.%20The%20party%20will%20decrease%20the%20taxes%20in%20this%20city%20to%20%24%201%20%24%20bourle.%20As%20the%20city%20%24%202%20%24%20is%20directly%20reachable%20from%20%24%201%20%24%20%2C%20we%20can%20arbitrarily%20modify%20the%20taxes%20in%20this%20city.%20The%20party%20should%20change%20the%20tax%20to%20%24%205%20%24%20bourles.%20It%20can%20be%20easily%20proved%20that%20Time%20Limit%20Exceeded%20cannot%20win%20the%20election%20after%20this%20move%20if%20Wrong%20Answer%20Party%20plays%20optimally.%5Cn%5CnThe%20second%20example%20test%20presents%20the%20situation%20we%20created%20after%20a%20single%20move%20in%20the%20previous%20test%3B%20as%20it%27s%20Wrong%20Answer%20Party%27s%20move%20now%2C%20the%20party%20cannot%20win.%5Cn%5CnIn%20the%20third%20test%2C%20we%20should%20hold%20the%20convention%20in%20the%20first%20city.%20This%20allows%20us%20to%20change%20the%20taxes%20in%20any%20city%20to%20any%20desired%20value%3B%20we%20can%20for%20instance%20decide%20to%20set%20all%20the%20taxes%20to%20zero%2C%20which%20allows%20the%20Wrong%20Answer%20Party%20to%20win%20the%20election%20immediately.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F1149%5C%2FE%22%2C%22id%22%3A%221149E%22%7D%2C%22translation%22%3A%22%5Cu5728Byteland%5Cuff0c%5Cu4e24%5Cu4e2a%5Cu515a%5Cu6d3e%5Cu2014%5Cu2014WA%5Cu515a%5Cu548cTLE%5Cu515a%5Cuff0c%5Cu6b64%5Cu65f6%5Cu6b63%5Cu5728%5Cu4e89%5Cu593a%5Cu5e2d%5Cu4f4d%5Cu3002%5Cu4e3a%5Cu4e86%5Cu8ba9%5Cu66f4%5Cu591a%5Cu516c%5Cu6c11%5Cu7ed9%5Cu4ed6%5Cu4eec%5Cu9009%5Cu7968%5Cuff0c%5Cu4ed6%5Cu4eec%5Cu90fd%5Cu5728%5Cu4e0d%5Cu505c%5Cu5730%5Cu627f%5Cu8bfa%5Cu964d%5Cu7a0e%5Cu3002%5Cr%5Cn%5Cr%5CnByteland%5Cu6709%24n%24%5Cu4e2a%5Cu57ce%5Cu5e02%5Cuff0c%24m%24%5Cu6761%5Cu5355%5Cu884c%5Cu9053%5Cuff0c%5Cu5e76%5Cu4e14%5Cu4e0d%5Cu80fd%5Cu4ece%5Cu4e00%5Cu4e2a%5Cu57ce%5Cu5e02%5Cu51fa%5Cu53d1%5Cu53c8%5Cu56de%5Cu5230%5Cu8fd9%5Cu4e2a%5Cu57ce%5Cu5e02%5Cu3002%5Cu7ade%5Cu9009%5Cu5f00%5Cu59cb%5Cu524d%5Cuff0c%5Cu7b2c%24i%24%5Cu4e2a%5Cu57ce%5Cu5e02%5Cu7684%5Cu7a0e%5Cu6536%5Cu662f%5Cu975e%5Cu8d1f%5Cu6574%5Cu6570%24h_i%24%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu4e00%5Cu6b21%5Cu62c9%5Cu7968%5Cu7684%5Cu8fc7%5Cu7a0b%5Cuff1a%5Cu8fd9%5Cu4e2a%5Cu515a%5Cu6d3e%5Cu4f1a%5Cu6765%5Cu5230%5Cu4e00%5Cu4e2a%5Cu57ce%5Cu5e02%24x%24%5Cuff0c%5Cu627f%5Cu8bfa%5Cu4f1a%5Cu5c06%5Cu8fd9%5Cu4e2a%5Cu57ce%5Cu5e02%5Cu7684%5Cu7a0e%5Cu6536%2A%2A%5Cu964d%5Cu4f4e%2A%2A%5Cu4e3a%5Cu4e00%5Cu4e2a%5Cu975e%5Cu8d1f%5Cu6574%5Cu6570%5Cu3002%5Cu540c%5Cu65f6%5Cuff0c%5Cu8fd9%5Cu4e2a%5Cu515a%5Cu6d3e%5Cu53ef%5Cu4ee5%5Cu5c06%5Cu4ece%24x%24%5Cu8d70%5Cu4e00%5Cu6761%5Cu5355%5Cu884c%5Cu9053%5Cu53ef%5Cu4ee5%5Cu76f4%5Cu8fbe%5Cu7684%5Cu57ce%5Cu5e02%5Cu7684%5Cu7a0e%5Cu6536%5Cu505a%5Cu4efb%5Cu610f%5Cu66f4%5Cu6539%5Cuff0c%5Cu53d8%5Cu9ad8%5Cu53d8%5Cu4f4e%5Cu90fd%5Cu884c%5Cuff0c%5Cu4f46%5Cu8fd8%5Cu5f97%5Cu4fdd%5Cu8bc1%5Cu8be5%5Cu57ce%5Cu5e02%5Cu7684%5Cu7a0e%5Cu6536%5Cu662f%5Cu975e%5Cu8d1f%5Cu6574%5Cu6570%5Cu3002%5Cr%5Cn%5Cr%5CnWA%5Cu515a%5Cu4f1a%5Cu5148%5Cu8fdb%5Cu884c%5Cu4e00%5Cu6b21%5Cu62c9%5Cu7968%5Cuff0c%5Cu7136%5Cu540eTLE%5Cu515a%5Cu8fdb%5Cu884c%5Cuff0c%5Cu7136%5Cu540eWA%5Cu515a%5Cu8fdb%5Cu884c%5Cuff0c%5Cu4ee5%5Cu6b64%5Cu7c7b%5Cu63a8%5Cu3002%5Cu65e0%5Cu6cd5%5Cu6267%5Cu884c%5Cu4e00%5Cu6b21%5Cu62c9%5Cu7968%5Cu7684%5Cu515a%5Cu6d3e%5Cu4f1a%5Cu8f93%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu5047%5Cu8bbe%5Cu4e24%5Cu4e2a%5Cu515a%5Cu6d3e%5Cu90fd%5Cu91c7%5Cu7528%5Cu6700%5Cu4f18%5Cu51b3%5Cu7b56%5Cuff0c%5Cu5982%5Cu679cWA%5Cu515a%5Cu8d62%5Cu4e86%5Cuff0c%5Cu8f93%5Cu51fa%60WIN%60%5Cuff0c%5Cu7136%5Cu540e%5Cu627e%5Cu51fa%5Cu4e00%5Cu79cd%5Cu7b2c%5Cu4e00%5Cu6b21%5Cu62c9%5Cu7968%5Cu7684%5Cu65b9%5Cu6848%5Cuff0c%5Cu4f7f%5Cu5f97%5Cu63a5%5Cu4e0b%5Cu6765TLE%5Cu515a%5Cu5fc5%5Cu8d25%5Cuff0c%5Cu8f93%5Cu51fa%5Cu6267%5Cu884c%5Cu8be5%5Cu65b9%5Cu6848%5Cu540e%5Cu6bcf%5Cu4e2a%5Cu57ce%5Cu5e02%5Cu7684%5Cu7a0e%5Cu6536%5Cu60c5%5Cu51b5%5Cu3002%5Cu5426%5Cu5219%5Cuff0c%5Cu8f93%5Cu51fa%60LOSE%60%5Cu3002%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A20%2C%22totalAccepted%22%3A10%2C%22pid%22%3A%22CF1149E%22%2C%22title%22%3A%22Election%20Promises%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Election%20Promises%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Election Promises</h1>
<h2>题意翻译</h2>
<div>在Byteland，两个党派——WA党和TLE党，此时正在争夺席位。为了让更多公民给他们选票，他们都在不停地承诺降税。
Byteland有$n$个城市，$m$条单行道，并且不能从一个城市出发又回到这个城市。竞选开始前，第$i$个城市的税收是非负整数$h_i$。
一次拉票的过程：这个党派会来到一个城市$x$，承诺会将这个城市的税收**降低**为一个非负整数。同时，这个党派可以将从$x$走一条单行道可以直达的城市的税收做任意更改，变高变低都行，但还得保证该城市的税收是非负整数。
WA党会先进行一次拉票，然后TLE党进行，然后WA党进行，以此类推。无法执行一次拉票的党派会输。
假设两个党派都采用最优决策，如果WA党赢了，输出`WIN`，然后找出一种第一次拉票的方案，使得接下来TLE党必败，输出执行该方案后每个城市的税收情况。否则，输出`LOSE`。</div>
<h2>题目描述</h2>
<div>In Byteland, there are two political parties fighting for seats in the Parliament in the upcoming elections: Wrong Answer Party and Time Limit Exceeded Party. As they want to convince as many citizens as possible to cast their votes on them, they keep promising lower and lower taxes.
There are $ n $ cities in Byteland, connected by $ m $ one-way roads. Interestingly enough, the road network has no cycles — it's impossible to start in any city, follow a number of roads, and return to that city. Last year, citizens of the $ i $ -th city had to pay $ h_i $ bourles of tax.
Parties will now alternately hold the election conventions in various cities. If a party holds a convention in city $ v $ , the party needs to decrease the taxes in this city to a non-negative integer amount of bourles. However, at the same time they can arbitrarily modify the taxes in each of the cities that can be reached from $ v $ using a single road. The only condition that must be fulfilled that the tax in each city has to remain a non-negative integer amount of bourles.
The first party to hold the convention is Wrong Answer Party. It's predicted that the party to hold the last convention will win the election. Can Wrong Answer Party win regardless of Time Limit Exceeded Party's moves?</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line of the input contains two integers $ n $ , $ m $ ( $ 1 \leq n \leq 200\,000 $ , $ 0 \leq m \leq 200\,000 $ ) — the number of cities and roads in Byteland.
The next line contains $ n $ space-separated integers $ h_1, h_2, \dots, h_n $ ( $ 0 \leq h_i \leq 10^9 $ ); $ h_i $ denotes the amount of taxes paid in the $ i $ -th city.
Each of the following $ m $ lines contains two integers ( $ 1 \leq u, v \leq n $ , $ u \neq v $ ), and describes a one-way road leading from the city $ u $ to the city $ v $ . There will be no cycles in the road network. No two roads will connect the same pair of cities.
We can show that the conventions cannot be held indefinitely for any correct test case.</div>
<h3>输出格式</h3>
<br />
<div>If Wrong Answer Party can win the election, output WIN in the first line of your output. In this case, you're additionally asked to produce any convention allowing the party to win regardless of the opponent's actions. The second line should contain $ n $ non-negative integers $ h'_1, h'_2, \dots, h'_n $ ( $ 0 \leq h'_i \leq 2 \cdot 10^{18} $ ) describing the amount of taxes paid in consecutive cities after the convention. If there are multiple answers, output any. We guarantee that if the party has any winning move, there exists a move after which no city has to pay more than $ 2 \cdot 10^{18} $ bourles.
If the party cannot assure their victory, output LOSE in the first and only line of the output.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>
4 2
2 1 1 5
1 2
3 4
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>
WIN
1 5 1 5 
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>
4 2
1 5 1 5
1 2
3 4
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>
LOSE
</code></pre>
<h3>输入样例 #3</h3>
<pre><code>
3 3
314 159 265
1 2
1 3
3 2
</code></pre>
<h3>输出样例 #3</h3>
<pre><code>
WIN
0 0 0 
</code></pre>
<h3>输入样例 #4</h3>
<pre><code>
6 4
2 2 5 5 6 6
1 3
2 4
3 5
4 6
</code></pre>
<h3>输出样例 #4</h3>
<pre><code>
LOSE
</code></pre>
<h2>说明</h2>
<div>In the first example, Wrong Answer Party should hold the convention in the city $ 1 $ . The party will decrease the taxes in this city to $ 1 $ bourle. As the city $ 2 $ is directly reachable from $ 1 $ , we can arbitrarily modify the taxes in this city. The party should change the tax to $ 5 $ bourles. It can be easily proved that Time Limit Exceeded cannot win the election after this move if Wrong Answer Party plays optimally.
The second example test presents the situation we created after a single move in the previous test; as it's Wrong Answer Party's move now, the party cannot win.
In the third test, we should hold the convention in the first city. This allows us to change the taxes in any city to any desired value; we can for instance decide to set all the taxes to zero, which allows the Wrong Answer Party to win the election immediately.</div>
</article>
</div>
</div>
</body>
</html>
