<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Natasha, Sasha and the Prefix Sums - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573403086:7LD7x3MjY9viZvE6VTNrf8VC5oJFh5xpu8jMJuiXVaU=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%22%2C%22description%22%3A%22Natasha%27s%20favourite%20numbers%20are%20%24%20n%20%24%20and%20%24%201%20%24%20%2C%20and%20Sasha%27s%20favourite%20numbers%20are%20%24%20m%20%24%20and%20%24%20-1%20%24%20.%20One%20day%20Natasha%20and%20Sasha%20met%20and%20wrote%20down%20every%20possible%20array%20of%20length%20%24%20n%2Bm%20%24%20such%20that%20some%20%24%20n%20%24%20of%20its%20elements%20are%20equal%20to%20%24%201%20%24%20and%20another%20%24%20m%20%24%20elements%20are%20equal%20to%20%24%20-1%20%24%20.%20For%20each%20such%20array%20they%20counted%20its%20maximal%20prefix%20sum%2C%20probably%20an%20empty%20one%20which%20is%20equal%20to%20%24%200%20%24%20%28in%20another%20words%2C%20if%20every%20nonempty%20prefix%20sum%20is%20less%20to%20zero%2C%20then%20it%20is%20considered%20equal%20to%20zero%29.%20Formally%2C%20denote%20as%20%24%20f%28a%29%20%24%20the%20maximal%20prefix%20sum%20of%20an%20array%20%24%20a_%7B1%2C%20%5C%5Cldots%20%2Cl%7D%20%24%20of%20length%20%24%20l%20%5C%5Cgeq%200%20%24%20.%20Then%3A%5Cn%5Cn%20%24%20%24%24%24f%28a%29%20%3D%20%5C%5Cmax%20%280%2C%20%5C%5Csmash%7B%5C%5Cdisplaystyle%5C%5Cmax_%7B1%20%5C%5Cleq%20i%20%5C%5Cleq%20l%7D%7D%20%5C%5Csum_%7Bj%3D1%7D%5E%7Bi%7D%20a_j%20%29%20%24%20%24%20%3C%5C%2Fp%3E%3Cp%3ENow%20they%20want%20to%20count%20the%20sum%20of%20maximal%20prefix%20sums%20for%20each%20such%20an%20array%20and%20they%20are%20asking%20you%20to%20help.%20As%20this%20sum%20can%20be%20very%20large%2C%20output%20it%20modulo%20%20%24%20998%5C%5C%5C%5C%3A%20244%5C%5C%5C%5C%3A%20853%24%24%24.%22%2C%22inputFormat%22%3A%22The%20only%20line%20contains%20two%20integers%20%24%20n%20%24%20and%20%24%20m%20%24%20%28%20%24%200%20%5C%5Cle%20n%2Cm%20%5C%5Cle%202%5C%5C%2C000%20%24%20%29.%22%2C%22outputFormat%22%3A%22Output%20the%20answer%20to%20the%20problem%20modulo%20%24%20998%5C%5C%3A%20244%5C%5C%3A%20853%20%24%20.%22%2C%22samples%22%3A%5B%5B%220%202%5Cn%22%2C%220%5Cn%22%5D%2C%5B%222%200%5Cn%22%2C%222%5Cn%22%5D%2C%5B%222%202%5Cn%22%2C%225%5Cn%22%5D%2C%5B%222000%202000%5Cn%22%2C%22674532367%5Cn%22%5D%5D%2C%22hint%22%3A%22In%20the%20first%20example%20the%20only%20possible%20array%20is%20%5C%5C%5B-1%2C-1%5C%5C%5D%2C%20its%20maximal%20prefix%20sum%20is%20equal%20to%20%24%200%20%24%20.%5Cn%5CnIn%20the%20second%20example%20the%20only%20possible%20array%20is%20%5C%5C%5B1%2C1%5C%5C%5D%2C%20its%20maximal%20prefix%20sum%20is%20equal%20to%20%24%202%20%24%20.%5Cn%5CnThere%20are%20%24%206%20%24%20possible%20arrays%20in%20the%20third%20example%3A%5Cn%5Cn%5C%5C%5B1%2C1%2C-1%2C-1%5C%5C%5D%2C%20f%28%5C%5C%5B1%2C1%2C-1%2C-1%5C%5C%5D%29%20%3D%202%5Cn%5Cn%5C%5C%5B1%2C-1%2C1%2C-1%5C%5C%5D%2C%20f%28%5C%5C%5B1%2C-1%2C1%2C-1%5C%5C%5D%29%20%3D%201%5Cn%5Cn%5C%5C%5B1%2C-1%2C-1%2C1%5C%5C%5D%2C%20f%28%5C%5C%5B1%2C-1%2C-1%2C1%5C%5C%5D%29%20%3D%201%5Cn%5Cn%5C%5C%5B-1%2C1%2C1%2C-1%5C%5C%5D%2C%20f%28%5C%5C%5B-1%2C1%2C1%2C-1%5C%5C%5D%29%20%3D%201%5Cn%5Cn%5C%5C%5B-1%2C1%2C-1%2C1%5C%5C%5D%2C%20f%28%5C%5C%5B-1%2C1%2C-1%2C1%5C%5C%5D%29%20%3D%200%5Cn%5Cn%5C%5C%5B-1%2C-1%2C1%2C1%5C%5C%5D%2C%20f%28%5C%5C%5B-1%2C-1%2C1%2C1%5C%5C%5D%29%20%3D%200%5Cn%5CnSo%20the%20answer%20for%20the%20third%20example%20is%20%24%202%2B1%2B1%2B1%2B0%2B0%20%3D%205%20%24%20.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F1204%5C%2FE%22%2C%22id%22%3A%221204E%22%7D%2C%22translation%22%3A%22%23%23%20%5Cu9898%5Cu76ee%5Cu63cf%5Cu8ff0%5CnNaCly_Fish%20%5Cu6700%5Cu559c%5Cu6b22%5Cu7684%5Cu6570%5Cu5b57%5Cu662f%20%24n%24%20%5Cu548c%20%241%24%5Cuff1b%24%5C%5Cmathsf%20E%20%5C%5Ccolor%7Bred%7D%20%5C%5Cmathsf%7BntropyIncreaser%7D%24%20%5Cu6700%5Cu559c%5Cu6b22%20%24m%24%20%5Cu548c%20%24-1%24%5Cu3002%5Cn%5Cn%5Cu6709%5Cu4e00%5Cu5929%5Cuff0c%5Cu5979%5Cu4eec%5Cu5728%5Cu4e00%5Cu8d77%5Cu5199%5Cu51fa%5Cu4e86%5Cu4e00%5Cu4e2a%5Cu957f%5Cu5ea6%5Cu4e3a%20%24n%2Bm%24%5Cuff0c%5Cu6709%20%24n%24%20%5Cu4e2a%20%241%24%20%5Cu548c%20%24m%24%20%5Cu4e2a%20%24-1%24%20%5Cu7684%5Cu5e8f%5Cu5217%20%24a%24%5Cuff0c%5Cu5b9a%5Cu4e49%5Cu5176%5Cu6700%5Cu5927%5Cu524d%5Cu7f00%5Cu548c%5Cu4e3a%5Cuff1a%20%5Cn%24%24%5C%5Clarge%20%5C%5Cmax%5C%5C%7B%200%2C%5C%5Cmax%5C%5Climits_%7B1%5C%5Cle%20i%5C%5Cle%20n%2Bm%7D%5C%5Csum%5C%5Climits_%7Bj%3D1%7D%5Eia_j%20%5C%5C%7D%24%24%5Cn%5Cu6362%5Cu53e5%5Cu8bdd%5Cu8bf4%5Cuff0c%5Cu5c31%5Cu662f%5Cu5bf9%5Cu4e8e%20%24a%24%20%5Cu7684%5Cu524d%5Cu7f00%5Cu548c%5Cu7684%5Cu6240%5Cu6709%5Cu9879%5Cu548c%20%240%24%20%5Cu53d6%20%24%5C%5Cmax%24%20%5Cu7684%5Cu503c%5Cu3002%5Cn%5CnNaCly_Fish%20%5Cu60f3%5Cu77e5%5Cu9053%5Cuff0c%5Cu5bf9%5Cu4e8e%5Cu5168%5Cu90e8%5Cu53ef%5Cu80fd%5Cu7684%5Cu5e8f%5Cu5217%5Cuff0c%5Cu5b83%5Cu4eec%5Cu7684%20%5Cu6700%5Cu5927%5Cu524d%5Cu7f00%5Cu548c%20%5Cu4e4b%5Cu548c%5Cu662f%5Cu591a%5Cu5c11%5Cu3002%20%20%5Cn%5Cu4e3a%5Cu4e86%5Cu9632%5Cu6b62%5Cu7b54%5Cu6848%5Cu8fc7%5Cu5927%5Cuff0c%5Cu8981%5Cu5bf9%20%24998244853%24%20%28%5Cu662f%5Cu4e2a%5Cu8d28%5Cu6570%29%20%5Cu53d6%5Cu6a21%5Cu3002%5Cn%5Cn%24%5C%5Cmathsf%20E%20%5C%5Ccolor%7Bred%7D%20%5C%5Cmathsf%7BntropyIncreaser%7D%24%20%5Cu53ea%5Cu7528%201s%20%5Cu5c31%5Cu60f3%5Cu5230%5Cu4e86%5Cu505a%5Cu6cd5%5Cuff0c%5Cu4f46%5Cu662f%20NaCly_Fish%20%5Cu8fd8%5Cu4e0d%5Cu4f1a%5Cuff0c%5Cu4f60%5Cu80fd%5Cu5e2e%5Cu5e2e%5Cu5979%5Cu5417%5Cuff1f%5Cn%5Cn%23%23%20%5Cu8f93%5Cu5165%5Cu683c%5Cu5f0f%20%20%5Cn%5Cu4e00%5Cu884c%5Cu4e24%5Cu4e2a%5Cu975e%5Cu8d1f%5Cu6574%5Cu6570%20%24n%2Cm%24%5Cn%23%23%20%5Cu8f93%5Cu51fa%5Cu683c%5Cu5f0f%20%20%5Cn%5Cu4e00%5Cu884c%5Cu4e00%5Cu4e2a%5Cu6574%5Cu6570%5Cu8868%5Cu793a%5Cu7b54%5Cu6848%5Cu3002%5Cn%23%23%20%5Cu8bf4%5Cu660e%20%20%5Cn%5Cu3010%5Cu6837%5Cu4f8b%20%243%24%20%5Cu89e3%5Cu91ca%5Cu3011%20%20%5Cn%5Cu53ef%5Cu80fd%5Cu7684%5Cu5e8f%5Cu5217%5Cu6709%20%246%24%20%5Cu79cd%5Cuff1a%20%20%5Cn%241%2C1%2C-1%2C-1%24%20%20%5Cn%241%2C-1%2C1%2C-1%24%20%20%5Cn%241%2C-1%2C-1%2C1%24%20%20%5Cn%24-1%2C1%2C1%2C-1%24%20%20%5Cn%24-1%2C1%2C-1%2C1%24%20%20%5Cn%24-1%2C-1%2C1%2C1%24%20%20%5Cn%5Cu5b83%5Cu4eec%5Cu7684%5Cu6700%5Cu5927%5Cu524d%5Cu7f00%5Cu548c%5Cu5206%5Cu522b%5Cu4e3a%20%242%2C1%2C1%2C1%2C0%2C0%24%5Cuff0c%5Cu52a0%5Cu8d77%5Cu6765%5Cu7b54%5Cu6848%5Cu4e3a%20%245%24%5Cu3002%5Cn%5Cn%5Cu3010%5Cu6570%5Cu636e%5Cu8303%5Cu56f4%5Cu3011%20%20%5Cn%240%5C%5Cle%20n%2Cm%20%5C%5Cle%202000%24%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A126%2C%22totalAccepted%22%3A90%2C%22pid%22%3A%22CF1204E%22%2C%22title%22%3A%22Natasha%2C%20Sasha%20and%20the%20Prefix%20Sums%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22CF1204D2%22%2C%22title%22%3A%22Kirk%20and%20a%20Binary%20String%20%28hard%20version%29%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1204D1%22%2C%22title%22%3A%22Kirk%20and%20a%20Binary%20String%20%28easy%20version%29%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1204C%22%2C%22title%22%3A%22Anna%2C%20Svyatoslav%20and%20Maps%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1207F%22%2C%22title%22%3A%22Remainder%20Problem%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1207E%22%2C%22title%22%3A%22XOR%20Guessing%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Natasha%2C%20Sasha%20and%20the%20Prefix%20Sums%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Natasha, Sasha and the Prefix Sums</h1>
<h2>题意翻译</h2>
<div>## 题目描述
NaCly_Fish 最喜欢的数字是 $n$ 和 $1$；$\mathsf E \color{red} \mathsf{ntropyIncreaser}$ 最喜欢 $m$ 和 $-1$。
有一天，她们在一起写出了一个长度为 $n+m$，有 $n$ 个 $1$ 和 $m$ 个 $-1$ 的序列 $a$，定义其最大前缀和为：
$$\large \max\{ 0,\max\limits_{1\le i\le n+m}\sum\limits_{j=1}^ia_j \}$$
换句话说，就是对于 $a$ 的前缀和的所有项和 $0$ 取 $\max$ 的值。
NaCly_Fish 想知道，对于全部可能的序列，它们的 最大前缀和 之和是多少。
为了防止答案过大，要对 $998244853$ (是个质数) 取模。
$\mathsf E \color{red} \mathsf{ntropyIncreaser}$ 只用 1s 就想到了做法，但是 NaCly_Fish 还不会，你能帮帮她吗？
## 输入格式
一行两个非负整数 $n,m$
## 输出格式
一行一个整数表示答案。
## 说明
【样例 $3$ 解释】
可能的序列有 $6$ 种：
$1,1,-1,-1$
$1,-1,1,-1$
$1,-1,-1,1$
$-1,1,1,-1$
$-1,1,-1,1$
$-1,-1,1,1$
它们的最大前缀和分别为 $2,1,1,1,0,0$，加起来答案为 $5$。
【数据范围】
$0\le n,m \le 2000$</div>
<h2>题目描述</h2>
<div>Natasha's favourite numbers are $ n $ and $ 1 $ , and Sasha's favourite numbers are $ m $ and $ -1 $ . One day Natasha and Sasha met and wrote down every possible array of length $ n+m $ such that some $ n $ of its elements are equal to $ 1 $ and another $ m $ elements are equal to $ -1 $ . For each such array they counted its maximal prefix sum, probably an empty one which is equal to $ 0 $ (in another words, if every nonempty prefix sum is less to zero, then it is considered equal to zero). Formally, denote as $ f(a) $ the maximal prefix sum of an array $ a_{1, \ldots ,l} $ of length $ l \geq 0 $ . Then:
$ $$$f(a) = \max (0, \smash{\displaystyle\max_{1 \leq i \leq l}} \sum_{j=1}^{i} a_j ) $ $ </p><p>Now they want to count the sum of maximal prefix sums for each such an array and they are asking you to help. As this sum can be very large, output it modulo $ 998\\: 244\\: 853$$$.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The only line contains two integers $ n $ and $ m $ ( $ 0 \le n,m \le 2\,000 $ ).</div>
<h3>输出格式</h3>
<br />
<div>Output the answer to the problem modulo $ 998\: 244\: 853 $ .</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>0 2
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>0
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>2 0
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>2
</code></pre>
<h3>输入样例 #3</h3>
<pre><code>2 2
</code></pre>
<h3>输出样例 #3</h3>
<pre><code>5
</code></pre>
<h3>输入样例 #4</h3>
<pre><code>2000 2000
</code></pre>
<h3>输出样例 #4</h3>
<pre><code>674532367
</code></pre>
<h2>说明</h2>
<div>In the first example the only possible array is \[-1,-1\], its maximal prefix sum is equal to $ 0 $ .
In the second example the only possible array is \[1,1\], its maximal prefix sum is equal to $ 2 $ .
There are $ 6 $ possible arrays in the third example:
\[1,1,-1,-1\], f(\[1,1,-1,-1\]) = 2
\[1,-1,1,-1\], f(\[1,-1,1,-1\]) = 1
\[1,-1,-1,1\], f(\[1,-1,-1,1\]) = 1
\[-1,1,1,-1\], f(\[-1,1,1,-1\]) = 1
\[-1,1,-1,1\], f(\[-1,1,-1,1\]) = 0
\[-1,-1,1,1\], f(\[-1,-1,1,1\]) = 0
So the answer for the third example is $ 2+1+1+1+0+0 = 5 $ .</div>
</article>
</div>
</div>
</body>
</html>
