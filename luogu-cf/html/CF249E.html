<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Endless Matrix - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573392059:DSDAb3Go4N5CisEvc4lY9uIcGfIy41C2jlqSYzsQlCY=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22A%20Russian%20space%20traveller%20Alisa%20Selezneva%2C%20like%20any%20other%20schoolgirl%20of%20the%20late%2021%20century%2C%20is%20interested%20in%20science.%20She%20has%20recently%20visited%20the%20MIT%20%28Moscow%20Institute%20of%20Time%29%2C%20where%20its%20chairman%20and%20the%20co-inventor%20of%20the%20time%20machine%20academician%20Petrov%20told%20her%20about%20the%20construction%20of%20a%20time%20machine.%5Cn%5CnDuring%20the%20demonstration%20of%20the%20time%20machine%20performance%20Alisa%20noticed%20that%20the%20machine%20does%20not%20have%20high%20speed%20and%20the%20girl%20got%20interested%20in%20the%20reason%20for%20such%20disadvantage.%20As%20it%20turns%20out%20on%20closer%20examination%2C%20one%20of%20the%20problems%20that%20should%20be%20solved%20for%20the%20time%20machine%20isn%27t%20solved%20by%20an%20optimal%20algorithm.%20If%20you%20find%20a%20way%20to%20solve%20this%20problem%20optimally%2C%20the%20time%20machine%20will%20run%20faster%20and%20use%20less%20energy.%5Cn%5CnA%20task%20that%20none%20of%20the%20staff%20can%20solve%20optimally%20is%20as%20follows.%20There%20exists%20a%20matrix%20%24%20a%20%24%20%2C%20which%20is%20filled%20by%20the%20following%20rule%3A%5Cn%5CnThe%20cells%20are%20consecutive%20positive%20integers%2C%20starting%20with%20one.%20Besides%2C%20%24%20a_%7Bi%2Cj%7D%26lt%3Ba_%7Bt%2Ck%7D%20%24%20%28%20%24%20i%2Cj%2Ct%2Ck%3E%3D1%20%24%20%29%2C%20if%3A%5Cn%5Cn1.%20%24%20max%28i%2Cj%29%26lt%3Bmax%28t%2Ck%29%20%24%20%3B%5Cn2.%20%24%20max%28i%2Cj%29%3Dmax%28t%2Ck%29%20%24%20and%20%24%20j%26lt%3Bk%20%24%20%3B%5Cn3.%20%24%20max%28i%2Cj%29%3Dmax%28t%2Ck%29%20%24%20%2C%20%24%20j%3Dk%20%24%20and%20%24%20i%26gt%3Bt%20%24%20.%5Cn%5CnSo%2C%20after%20the%20first%20%24%2036%20%24%20numbers%20are%20inserted%2C%20matrix%20%24%20a%20%24%20will%20look%20as%20follows%3A%5Cn%5Cn%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF249E%5C%2Fdb70d71da432099ee5c0691f8311f2105a4c00eb.png%29To%20solve%20the%20problem%2C%20you%20should%20learn%20to%20find%20rather%20quickly%20for%20the%20given%20values%20of%20%24%20x_%7B1%7D%2Cy_%7B1%7D%2Cx_%7B2%7D%20%24%20and%20%24%20y_%7B2%7D%20%24%20%28%20%24%20x_%7B1%7D%3C%3Dx_%7B2%7D%2Cy_%7B1%7D%3C%3Dy_%7B2%7D%20%24%20%29%20the%20meaning%20of%20expression%3A%5Cn%5Cn%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF249E%5C%2Fdedf88341ac4206f3e0349d9d8443767ae3040af.png%29As%20the%20meaning%20of%20this%20expression%20can%20be%20large%20enough%2C%20it%20is%20sufficient%20to%20know%20only%20the%20last%20%24%2010%20%24%20digits%20of%20the%20sought%20value.%5Cn%5CnSo%2C%20no%20one%20in%20MTI%20can%20solve%20the%20given%20task.%20Alice%20was%20brave%20enough%20to%20use%20the%20time%20machine%20and%20travel%20the%20past%20to%20help%20you.%5Cn%5CnYour%20task%20is%20to%20write%20a%20program%20that%20uses%20the%20given%20values%20%24%20x_%7B1%7D%2Cy_%7B1%7D%2Cx_%7B2%7D%20%24%20and%20%24%20y_%7B2%7D%20%24%20finds%20the%20last%20%24%2010%20%24%20digits%20of%20the%20given%20expression.%22%2C%22inputFormat%22%3A%22The%20first%20input%20line%20contains%20a%20single%20integer%20%24%20t%20%24%20%28%20%24%201%3C%3Dt%3C%3D10%5E%7B5%7D%20%24%20%29%20%5Cu2014%20the%20number%20of%20test%20sets%20for%20which%20you%20should%20solve%20the%20problem.%5Cn%5CnEach%20of%20the%20next%20%24%20t%20%24%20lines%20contains%20the%20description%20of%20a%20test%20%5Cu2014%20four%20positive%20integers%20%24%20x_%7B1%7D%2Cy_%7B1%7D%2Cx_%7B2%7D%20%24%20and%20%24%20y_%7B2%7D%20%24%20%28%20%24%201%3C%3Dx_%7B1%7D%3C%3Dx_%7B2%7D%3C%3D10%5E%7B9%7D%2C1%3C%3Dy_%7B1%7D%3C%3Dy_%7B2%7D%3C%3D10%5E%7B9%7D%20%24%20%29%2C%20separated%20by%20spaces.%22%2C%22outputFormat%22%3A%22For%20each%20query%20print%20the%20meaning%20of%20the%20expression%20if%20it%20contains%20at%20most%20%24%2010%20%24%20characters.%20Otherwise%2C%20print%20three%20characters%20%5C%22.%5C%22%20%28without%20the%20quotes%29%2C%20and%20then%20ten%20last%20digits%20of%20the%20time%20expression.%20Print%20the%20answer%20to%20each%20query%20on%20a%20single%20line.%20Follow%20the%20format%2C%20given%20in%20the%20sample%20as%20closely%20as%20possible.%22%2C%22samples%22%3A%5B%5B%225%5Cn1%201%201%201%5Cn2%202%203%203%5Cn2%203%205%206%5Cn100%2087%20288%202002%5Cn4%202%205%204%5Cn%22%2C%221%5Cn24%5Cn300%5Cn...5679392764%5Cn111%5Cn%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B3000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F249%5C%2FE%22%2C%22id%22%3A%22249E%22%7D%2C%22translation%22%3A%22%5Cu7ed9%5Cu4f60%5Cu4e00%5Cu4e2a%5Cu5f62%5Cu5982%5Cu4e0b%5Cu56fe%5Cu7684%5Cu77e9%5Cu9635%5Cr%5Cn%5Cr%5Cn%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.org%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF249E%5C%2Fdb70d71da432099ee5c0691f8311f2105a4c00eb.png%29%5Cr%5Cn%5Cr%5Cn%5Cu5e76%5Cu6709%24T%24%5Cu7ec4%5Cu8be2%5Cu95ee%20%5Cu6bcf%5Cu7ec4%5Cu8be2%5Cu95ee%5Cu7ed9%5Cu51fa%24x_1%2Cy_1%2Cx_2%2Cy_2%24%5Cr%5Cn%5Cr%5Cn%5Cu6c42%24%5C%5Csum_%7Bi%3Dx_1%7D%5E%7Bx_2%7D%5C%5Csum_%7Bj%3Dy_1%7D%5E%7By_2%7DA%5Bi%5D%5Bj%5D%24%5Cr%5Cn%5Cr%5Cn%5Cu5176%5Cu4e2d%24A%5Bi%5D%5Bj%5D%24%5Cu8868%5Cu793a%5Cu5728%5Cu77e9%5Cu9635%5Cu4e2d%5Cu7684%5Cu6570%5Cr%5Cn%5Cr%5Cn%24T%5C%5Cleq%2010%5E5%24%5Cr%5Cn%5Cr%5Cn%241%5C%5Cleq%20x_1%20%5C%5Cleq%20x_2%20%5C%5Cleq%2010%5E9%24%5Cr%5Cn%5Cr%5Cn%241%5C%5Cleq%20y_1%20%5C%5Cleq%20y_2%20%5C%5Cleq%2010%5E9%24%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A1%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22CF249E%22%2C%22title%22%3A%22Endless%20Matrix%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Endless%20Matrix%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573286098;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Endless Matrix</h1>
<h2>题意翻译</h2>
<div>给你一个形如下图的矩阵
![](https://cdn.luogu.org/upload/vjudge_pic/CF249E/db70d71da432099ee5c0691f8311f2105a4c00eb.png)
并有$T$组询问 每组询问给出$x_1,y_1,x_2,y_2$
求$\sum_{i=x_1}^{x_2}\sum_{j=y_1}^{y_2}A[i][j]$
其中$A[i][j]$表示在矩阵中的数
$T\leq 10^5$
$1\leq x_1 \leq x_2 \leq 10^9$
$1\leq y_1 \leq y_2 \leq 10^9$</div>
<h2>题目描述</h2>
<div>A Russian space traveller Alisa Selezneva, like any other schoolgirl of the late 21 century, is interested in science. She has recently visited the MIT (Moscow Institute of Time), where its chairman and the co-inventor of the time machine academician Petrov told her about the construction of a time machine.
During the demonstration of the time machine performance Alisa noticed that the machine does not have high speed and the girl got interested in the reason for such disadvantage. As it turns out on closer examination, one of the problems that should be solved for the time machine isn't solved by an optimal algorithm. If you find a way to solve this problem optimally, the time machine will run faster and use less energy.
A task that none of the staff can solve optimally is as follows. There exists a matrix $ a $ , which is filled by the following rule:
The cells are consecutive positive integers, starting with one. Besides, $ a_{i,j}&lt;a_{t,k} $ ( $ i,j,t,k>=1 $ ), if:
1. $ max(i,j)&lt;max(t,k) $ ;
2. $ max(i,j)=max(t,k) $ and $ j&lt;k $ ;
3. $ max(i,j)=max(t,k) $ , $ j=k $ and $ i&gt;t $ .
So, after the first $ 36 $ numbers are inserted, matrix $ a $ will look as follows:
![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF249E/db70d71da432099ee5c0691f8311f2105a4c00eb.png)To solve the problem, you should learn to find rather quickly for the given values of $ x_{1},y_{1},x_{2} $ and $ y_{2} $ ( $ x_{1}<=x_{2},y_{1}<=y_{2} $ ) the meaning of expression:
![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF249E/dedf88341ac4206f3e0349d9d8443767ae3040af.png)As the meaning of this expression can be large enough, it is sufficient to know only the last $ 10 $ digits of the sought value.
So, no one in MTI can solve the given task. Alice was brave enough to use the time machine and travel the past to help you.
Your task is to write a program that uses the given values $ x_{1},y_{1},x_{2} $ and $ y_{2} $ finds the last $ 10 $ digits of the given expression.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first input line contains a single integer $ t $ ( $ 1<=t<=10^{5} $ ) — the number of test sets for which you should solve the problem.
Each of the next $ t $ lines contains the description of a test — four positive integers $ x_{1},y_{1},x_{2} $ and $ y_{2} $ ( $ 1<=x_{1}<=x_{2}<=10^{9},1<=y_{1}<=y_{2}<=10^{9} $ ), separated by spaces.</div>
<h3>输出格式</h3>
<br />
<div>For each query print the meaning of the expression if it contains at most $ 10 $ characters. Otherwise, print three characters "." (without the quotes), and then ten last digits of the time expression. Print the answer to each query on a single line. Follow the format, given in the sample as closely as possible.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>5
1 1 1 1
2 2 3 3
2 3 5 6
100 87 288 2002
4 2 5 4
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>1
24
300
...5679392764
111
</code></pre>
</article>
</div>
</div>
</body>
</html>
