<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Hag&#039;s Khashba - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573399931:h2sgRQD8GguWjxZDue0k79vyX+FlFx5tKrEFcNgr1Ds=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Hag%20is%20a%20very%20talented%20person.%20He%20has%20always%20had%20an%20artist%20inside%20him%20but%20his%20father%20forced%20him%20to%20study%20mechanical%20engineering.%5Cn%5CnYesterday%20he%20spent%20all%20of%20his%20time%20cutting%20a%20giant%20piece%20of%20wood%20trying%20to%20make%20it%20look%20like%20a%20goose.%20Anyway%2C%20his%20dad%20found%20out%20that%20he%20was%20doing%20arts%20rather%20than%20studying%20mechanics%20and%20other%20boring%20subjects.%20He%20confronted%20Hag%20with%20the%20fact%20that%20he%20is%20a%20spoiled%20son%20that%20does%20not%20care%20about%20his%20future%2C%20and%20if%20he%20continues%20to%20do%20arts%20he%20will%20cut%20his%2025%20Lira%20monthly%20allowance.%5Cn%5CnHag%20is%20trying%20to%20prove%20to%20his%20dad%20that%20the%20wooden%20piece%20is%20a%20project%20for%20mechanics%20subject.%20He%20also%20told%20his%20dad%20that%20the%20wooden%20piece%20is%20a%20strictly%20convex%20polygon%20with%20%24%20n%20%24%20vertices.%5Cn%5CnHag%20brought%20two%20pins%20and%20pinned%20the%20polygon%20with%20them%20in%20the%20%24%201%20%24%20-st%20and%20%24%202%20%24%20-nd%20vertices%20to%20the%20wall.%20His%20dad%20has%20%24%20q%20%24%20queries%20to%20Hag%20of%20two%20types.%5Cn%5Cn-%20%24%201%20%24%20%24%20f%20%24%20%24%20t%20%24%20%3A%20pull%20a%20pin%20from%20the%20vertex%20%24%20f%20%24%20%2C%20wait%20for%20the%20wooden%20polygon%20to%20rotate%20under%20the%20gravity%20force%20%28if%20it%20will%20rotate%29%20and%20stabilize.%20And%20then%20put%20the%20pin%20in%20vertex%20%24%20t%20%24%20.%5Cn-%20%24%202%20%24%20%24%20v%20%24%20%3A%20answer%20what%20are%20the%20coordinates%20of%20the%20vertex%20%24%20v%20%24%20.%5Cn%5CnPlease%20help%20Hag%20to%20answer%20his%20father%27s%20queries.%5Cn%5CnYou%20can%20assume%20that%20the%20wood%20that%20forms%20the%20polygon%20has%20uniform%20density%20and%20the%20polygon%20has%20a%20positive%20thickness%2C%20same%20in%20all%20points.%20After%20every%20query%20of%20the%201-st%20type%20Hag%27s%20dad%20tries%20to%20move%20the%20polygon%20a%20bit%20and%20watches%20it%20stabilize%20again.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20two%20integers%20%24%20n%20%24%20and%20%24%20q%20%24%20%28%20%24%203%5C%5Cleq%20n%20%5C%5Cleq%2010%5C%5C%2C000%20%24%20%2C%20%24%201%20%5C%5Cleq%20q%20%5C%5Cleq%20200000%20%24%20%29%20%5Cu2014%20the%20number%20of%20vertices%20in%20the%20polygon%20and%20the%20number%20of%20queries.%5Cn%5CnThe%20next%20%24%20n%20%24%20lines%20describe%20the%20wooden%20polygon%2C%20the%20%24%20i%20%24%20-th%20line%20contains%20two%20integers%20%24%20x_i%20%24%20and%20%24%20y_i%20%24%20%28%20%24%20%7Cx_i%7C%2C%20%7Cy_i%7C%5C%5Cleq%2010%5E8%20%24%20%29%20%5Cu2014%20the%20coordinates%20of%20the%20%24%20i%20%24%20-th%20vertex%20of%20the%20polygon.%20It%20is%20guaranteed%20that%20polygon%20is%20strictly%20convex%20and%20the%20vertices%20are%20given%20in%20the%20counter-clockwise%20order%20and%20all%20vertices%20are%20distinct.%5Cn%5CnThe%20next%20%24%20q%20%24%20lines%20describe%20the%20queries%2C%20one%20per%20line.%20Each%20query%20starts%20with%20its%20type%20%24%201%20%24%20or%20%24%202%20%24%20.%20Each%20query%20of%20the%20first%20type%20continues%20with%20two%20integers%20%24%20f%20%24%20and%20%24%20t%20%24%20%28%20%24%201%20%5C%5Cle%20f%2C%20t%20%5C%5Cle%20n%20%24%20%29%20%5Cu2014%20the%20vertex%20the%20pin%20is%20taken%20from%2C%20and%20the%20vertex%20the%20pin%20is%20put%20to%20and%20the%20polygon%20finishes%20rotating.%20It%20is%20guaranteed%20that%20the%20vertex%20%24%20f%20%24%20contains%20a%20pin.%20Each%20query%20of%20the%20second%20type%20continues%20with%20a%20single%20integer%20%24%20v%20%24%20%28%20%24%201%20%5C%5Cle%20v%20%5C%5Cle%20n%20%24%20%29%20%5Cu2014%20the%20vertex%20the%20coordinates%20of%20which%20Hag%20should%20tell%20his%20father.%5Cn%5CnIt%20is%20guaranteed%20that%20there%20is%20at%20least%20one%20query%20of%20the%20second%20type.%22%2C%22outputFormat%22%3A%22The%20output%20should%20contain%20the%20answer%20to%20each%20query%20of%20second%20type%20%5Cu2014%20two%20numbers%20in%20a%20separate%20line.%20Your%20answer%20is%20considered%20correct%2C%20if%20its%20absolute%20or%20relative%20error%20does%20not%20exceed%20%24%2010%5E%7B-4%7D%20%24%20.%5Cn%5CnFormally%2C%20let%20your%20answer%20be%20%24%20a%20%24%20%2C%20and%20the%20jury%27s%20answer%20be%20%24%20b%20%24%20.%20Your%20answer%20is%20considered%20correct%20if%20%24%20%5C%5Cfrac%7B%7Ca%20-%20b%7C%7D%7B%5C%5Cmax%7B%281%2C%20%7Cb%7C%29%7D%7D%20%5C%5Cle%2010%5E%7B-4%7D%20%24%22%2C%22samples%22%3A%5B%5B%223%204%5Cn0%200%5Cn2%200%5Cn2%202%5Cn1%201%202%5Cn2%201%5Cn2%202%5Cn2%203%5Cn%22%2C%223.4142135624%20-1.4142135624%5Cn2.0000000000%200.0000000000%5Cn0.5857864376%20-1.4142135624%5Cn%22%5D%2C%5B%223%202%5Cn-1%201%5Cn0%200%5Cn1%201%5Cn1%201%202%5Cn2%201%5Cn%22%2C%221.0000000000%20-1.0000000000%5Cn%22%5D%5D%2C%22hint%22%3A%22In%20the%20first%20test%20note%20the%20initial%20and%20the%20final%20state%20of%20the%20wooden%20polygon.%5Cn%5Cn%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF975E%5C%2Ff8978da0d59e4f05456975859a255315f1ec8aa6.png%29Red%20Triangle%20is%20the%20initial%20state%20and%20the%20green%20one%20is%20the%20triangle%20after%20rotation%20around%20%24%20%282%2C0%29%20%24%20.%5Cn%5CnIn%20the%20second%20sample%20note%20that%20the%20polygon%20rotates%20%24%20180%20%24%20degrees%20counter-clockwise%20or%20clockwise%20direction%20%28it%20does%20not%20matter%29%2C%20because%20Hag%27s%20father%20makes%20sure%20that%20the%20polygon%20is%20stable%20and%20his%20son%20does%20not%20trick%20him.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B3000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F975%5C%2FE%22%2C%22id%22%3A%22975E%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A4%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22CF975E%22%2C%22title%22%3A%22Hag%27s%20Khashba%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A41530%2C%22title%22%3A%22%5Cu8fd9%5Cu9053%5Cu9898%5Cu662f%5Cu4e0d%5Cu662f%5Cu5361%5Cu7cbe%5Cu5ea6%5Cu554a%22%2C%22forum%22%3A%7B%22id%22%3A25562%2C%22name%22%3A%22CF975E%20Hag%27s%20Khashba%22%2C%22slug%22%3A%22CF975E%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Hag%27s%20Khashba%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Hag&#039;s Khashba</h1>
<h2>题目描述</h2>
<div>Hag is a very talented person. He has always had an artist inside him but his father forced him to study mechanical engineering.
Yesterday he spent all of his time cutting a giant piece of wood trying to make it look like a goose. Anyway, his dad found out that he was doing arts rather than studying mechanics and other boring subjects. He confronted Hag with the fact that he is a spoiled son that does not care about his future, and if he continues to do arts he will cut his 25 Lira monthly allowance.
Hag is trying to prove to his dad that the wooden piece is a project for mechanics subject. He also told his dad that the wooden piece is a strictly convex polygon with $ n $ vertices.
Hag brought two pins and pinned the polygon with them in the $ 1 $ -st and $ 2 $ -nd vertices to the wall. His dad has $ q $ queries to Hag of two types.
- $ 1 $ $ f $ $ t $ : pull a pin from the vertex $ f $ , wait for the wooden polygon to rotate under the gravity force (if it will rotate) and stabilize. And then put the pin in vertex $ t $ .
- $ 2 $ $ v $ : answer what are the coordinates of the vertex $ v $ .
Please help Hag to answer his father's queries.
You can assume that the wood that forms the polygon has uniform density and the polygon has a positive thickness, same in all points. After every query of the 1-st type Hag's dad tries to move the polygon a bit and watches it stabilize again.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains two integers $ n $ and $ q $ ( $ 3\leq n \leq 10\,000 $ , $ 1 \leq q \leq 200000 $ ) — the number of vertices in the polygon and the number of queries.
The next $ n $ lines describe the wooden polygon, the $ i $ -th line contains two integers $ x_i $ and $ y_i $ ( $ |x_i|, |y_i|\leq 10^8 $ ) — the coordinates of the $ i $ -th vertex of the polygon. It is guaranteed that polygon is strictly convex and the vertices are given in the counter-clockwise order and all vertices are distinct.
The next $ q $ lines describe the queries, one per line. Each query starts with its type $ 1 $ or $ 2 $ . Each query of the first type continues with two integers $ f $ and $ t $ ( $ 1 \le f, t \le n $ ) — the vertex the pin is taken from, and the vertex the pin is put to and the polygon finishes rotating. It is guaranteed that the vertex $ f $ contains a pin. Each query of the second type continues with a single integer $ v $ ( $ 1 \le v \le n $ ) — the vertex the coordinates of which Hag should tell his father.
It is guaranteed that there is at least one query of the second type.</div>
<h3>输出格式</h3>
<br />
<div>The output should contain the answer to each query of second type — two numbers in a separate line. Your answer is considered correct, if its absolute or relative error does not exceed $ 10^{-4} $ .
Formally, let your answer be $ a $ , and the jury's answer be $ b $ . Your answer is considered correct if $ \frac{|a - b|}{\max{(1, |b|)}} \le 10^{-4} $</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>3 4
0 0
2 0
2 2
1 1 2
2 1
2 2
2 3
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>3.4142135624 -1.4142135624
2.0000000000 0.0000000000
0.5857864376 -1.4142135624
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>3 2
-1 1
0 0
1 1
1 1 2
2 1
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>1.0000000000 -1.0000000000
</code></pre>
<h2>说明</h2>
<div>In the first test note the initial and the final state of the wooden polygon.
![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF975E/f8978da0d59e4f05456975859a255315f1ec8aa6.png)Red Triangle is the initial state and the green one is the triangle after rotation around $ (2,0) $ .
In the second sample note that the polygon rotates $ 180 $ degrees counter-clockwise or clockwise direction (it does not matter), because Hag's father makes sure that the polygon is stable and his son does not trick him.</div>
</article>
</div>
</div>
</body>
</html>
