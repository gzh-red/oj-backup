<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Two out of Three - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573390655:tBiZzLCpkW6nYVOIcyiuB2qeH+WcpwcrJ3xkoBYyRa4=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Vasya%20has%20recently%20developed%20a%20new%20algorithm%20to%20optimize%20the%20reception%20of%20customer%20flow%20and%20he%20considered%20the%20following%20problem.%5Cn%5CnLet%20the%20queue%20to%20the%20cashier%20contain%20%24%20n%20%24%20people%2C%20at%20that%20each%20of%20them%20is%20characterized%20by%20a%20positive%20integer%20%24%20a_%7Bi%7D%20%24%20%5Cu2014%20that%20is%20the%20time%20needed%20to%20work%20with%20this%20customer.%20What%20is%20special%20about%20this%20very%20cashier%20is%20that%20it%20can%20serve%20two%20customers%20simultaneously.%20However%2C%20if%20two%20customers%20need%20%24%20a_%7Bi%7D%20%24%20and%20%24%20a_%7Bj%7D%20%24%20of%20time%20to%20be%20served%2C%20the%20time%20needed%20to%20work%20with%20both%20of%20them%20customers%20is%20equal%20to%20%24%20max%28a_%7Bi%7D%2Ca_%7Bj%7D%29%20%24%20.%20Please%20note%20that%20working%20with%20customers%20is%20an%20uninterruptable%20process%2C%20and%20therefore%2C%20if%20two%20people%20simultaneously%20come%20to%20the%20cashier%2C%20it%20means%20that%20they%20begin%20to%20be%20served%20simultaneously%2C%20and%20will%20both%20finish%20simultaneously%20%28it%20is%20possible%20that%20one%20of%20them%20will%20have%20to%20wait%29.%5Cn%5CnVasya%20used%20in%20his%20algorithm%20an%20ingenious%20heuristic%20%5Cu2014%20as%20long%20as%20the%20queue%20has%20more%20than%20one%20person%20waiting%2C%20then%20some%20two%20people%20of%20the%20first%20three%20standing%20in%20front%20of%20the%20queue%20are%20sent%20simultaneously.%20If%20the%20queue%20has%20only%20one%20customer%20number%20%24%20i%20%24%20%2C%20then%20he%20goes%20to%20the%20cashier%2C%20and%20is%20served%20within%20%24%20a_%7Bi%7D%20%24%20of%20time.%20Note%20that%20the%20total%20number%20of%20phases%20of%20serving%20a%20customer%20will%20always%20be%20equal%20to%20%24%20%5Cu2308n%5C%2F2%5Cu2309%20%24%20.%5Cn%5CnVasya%20thinks%20that%20this%20method%20will%20help%20to%20cope%20with%20the%20queues%20we%20all%20hate.%20That%27s%20why%20he%20asked%20you%20to%20work%20out%20a%20program%20that%20will%20determine%20the%20minimum%20time%20during%20which%20the%20whole%20queue%20will%20be%20served%20using%20this%20algorithm.%22%2C%22inputFormat%22%3A%22The%20first%20line%20of%20the%20input%20file%20contains%20a%20single%20number%20%24%20n%20%24%20%28%20%24%201%3C%3Dn%3C%3D1000%20%24%20%29%2C%20which%20is%20the%20number%20of%20people%20in%20the%20sequence.%20The%20second%20line%20contains%20space-separated%20integers%20%24%20a_%7B1%7D%2Ca_%7B2%7D%2C...%2Ca_%7Bn%7D%20%24%20%28%20%24%201%3C%3Da_%7Bi%7D%3C%3D10%5E%7B6%7D%20%24%20%29.%20The%20people%20are%20numbered%20starting%20from%20the%20cashier%20to%20the%20end%20of%20the%20queue.%22%2C%22outputFormat%22%3A%22Print%20on%20the%20first%20line%20a%20single%20number%20%5Cu2014%20the%20minimum%20time%20needed%20to%20process%20all%20%24%20n%20%24%20people.%20Then%20on%20%24%20%5Cu2308n%5C%2F2%5Cu2309%20%24%20lines%20print%20the%20order%20in%20which%20customers%20will%20be%20served.%20Each%20line%20%28probably%2C%20except%20for%20the%20last%20one%29%20must%20contain%20two%20numbers%20separated%20by%20a%20space%20%5Cu2014%20the%20numbers%20of%20customers%20who%20will%20be%20served%20at%20the%20current%20stage%20of%20processing.%20If%20%24%20n%20%24%20is%20odd%2C%20then%20the%20last%20line%20must%20contain%20a%20single%20number%20%5Cu2014%20the%20number%20of%20the%20last%20served%20customer%20in%20the%20queue.%20The%20customers%20are%20numbered%20starting%20from%20%24%201%20%24%20.%22%2C%22samples%22%3A%5B%5B%224%5Cn1%202%203%204%5Cn%22%2C%226%5Cn1%202%5Cn3%204%5Cn%22%5D%2C%5B%225%5Cn2%204%203%201%204%5Cn%22%2C%228%5Cn1%203%5Cn2%205%5Cn4%5Cn%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F82%5C%2FD%22%2C%22id%22%3A%2282D%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A18%2C%22totalAccepted%22%3A12%2C%22pid%22%3A%22CF82D%22%2C%22title%22%3A%22Two%20out%20of%20Three%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Two%20out%20of%20Three%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573295103;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Two out of Three</h1>
<h2>题目描述</h2>
<div>Vasya has recently developed a new algorithm to optimize the reception of customer flow and he considered the following problem.
Let the queue to the cashier contain $ n $ people, at that each of them is characterized by a positive integer $ a_{i} $ — that is the time needed to work with this customer. What is special about this very cashier is that it can serve two customers simultaneously. However, if two customers need $ a_{i} $ and $ a_{j} $ of time to be served, the time needed to work with both of them customers is equal to $ max(a_{i},a_{j}) $ . Please note that working with customers is an uninterruptable process, and therefore, if two people simultaneously come to the cashier, it means that they begin to be served simultaneously, and will both finish simultaneously (it is possible that one of them will have to wait).
Vasya used in his algorithm an ingenious heuristic — as long as the queue has more than one person waiting, then some two people of the first three standing in front of the queue are sent simultaneously. If the queue has only one customer number $ i $ , then he goes to the cashier, and is served within $ a_{i} $ of time. Note that the total number of phases of serving a customer will always be equal to $ ⌈n/2⌉ $ .
Vasya thinks that this method will help to cope with the queues we all hate. That's why he asked you to work out a program that will determine the minimum time during which the whole queue will be served using this algorithm.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line of the input file contains a single number $ n $ ( $ 1<=n<=1000 $ ), which is the number of people in the sequence. The second line contains space-separated integers $ a_{1},a_{2},...,a_{n} $ ( $ 1<=a_{i}<=10^{6} $ ). The people are numbered starting from the cashier to the end of the queue.</div>
<h3>输出格式</h3>
<br />
<div>Print on the first line a single number — the minimum time needed to process all $ n $ people. Then on $ ⌈n/2⌉ $ lines print the order in which customers will be served. Each line (probably, except for the last one) must contain two numbers separated by a space — the numbers of customers who will be served at the current stage of processing. If $ n $ is odd, then the last line must contain a single number — the number of the last served customer in the queue. The customers are numbered starting from $ 1 $ .</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>4
1 2 3 4
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>6
1 2
3 4
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>5
2 4 3 1 4
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>8
1 3
2 5
4
</code></pre>
</article>
</div>
</div>
</body>
</html>
