<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Data Center Maintenance - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573399687:V4e1Sck3DpI/oT9Z/X1rzYcynybeQldXcjoDXAfjzUE=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%22%2C%22description%22%3A%22BigData%20Inc.%20is%20a%20corporation%20that%20has%20%24%20n%20%24%20data%20centers%20indexed%20from%20%24%201%20%24%20to%20%24%20n%20%24%20that%20are%20located%20all%20over%20the%20world.%20These%20data%20centers%20provide%20storage%20for%20client%20data%20%28you%20can%20figure%20out%20that%20client%20data%20is%20really%20big%21%29.%5Cn%5CnMain%20feature%20of%20services%20offered%20by%20BigData%20Inc.%20is%20the%20access%20availability%20guarantee%20even%20under%20the%20circumstances%20of%20any%20data%20center%20having%20an%20outage.%20Such%20a%20guarantee%20is%20ensured%20by%20using%20the%20two-way%20replication.%20Two-way%20replication%20is%20such%20an%20approach%20for%20data%20storage%20that%20any%20piece%20of%20data%20is%20represented%20by%20two%20identical%20copies%20that%20are%20stored%20in%20two%20different%20data%20centers.%5Cn%5CnFor%20each%20of%20%24%20m%20%24%20company%20clients%2C%20let%20us%20denote%20indices%20of%20two%20different%20data%20centers%20storing%20this%20client%20data%20as%20%24%20c_%7Bi%2C1%7D%20%24%20and%20%24%20c_%7Bi%2C2%7D%20%24%20.%5Cn%5CnIn%20order%20to%20keep%20data%20centers%20operational%20and%20safe%2C%20the%20software%20running%20on%20data%20center%20computers%20is%20being%20updated%20regularly.%20Release%20cycle%20of%20BigData%20Inc.%20is%20one%20day%20meaning%20that%20the%20new%20version%20of%20software%20is%20being%20deployed%20to%20the%20data%20center%20computers%20each%20day.%5Cn%5CnData%20center%20software%20update%20is%20a%20non-trivial%20long%20process%2C%20that%20is%20why%20there%20is%20a%20special%20hour-long%20time%20frame%20that%20is%20dedicated%20for%20data%20center%20maintenance.%20During%20the%20maintenance%20period%2C%20data%20center%20computers%20are%20installing%20software%20updates%2C%20and%20thus%20they%20may%20be%20unavailable.%20Consider%20the%20day%20to%20be%20exactly%20%24%20h%20%24%20hours%20long.%20For%20each%20data%20center%20there%20is%20an%20integer%20%24%20u_%7Bj%7D%20%24%20%28%20%24%200%3C%3Du_%7Bj%7D%3C%3Dh-1%20%24%20%29%20defining%20the%20index%20of%20an%20hour%20of%20day%2C%20such%20that%20during%20this%20hour%20data%20center%20%24%20j%20%24%20is%20unavailable%20due%20to%20maintenance.%5Cn%5CnSumming%20up%20everything%20above%2C%20the%20condition%20%24%20u_%7Bci%2C1%7D%5Cu2260u_%7Bci%2C2%7D%20%24%20should%20hold%20for%20each%20client%2C%20or%20otherwise%20his%20data%20may%20be%20unaccessible%20while%20data%20centers%20that%20store%20it%20are%20under%20maintenance.%5Cn%5CnDue%20to%20occasional%20timezone%20change%20in%20different%20cities%20all%20over%20the%20world%2C%20the%20maintenance%20time%20in%20some%20of%20the%20data%20centers%20may%20change%20by%20one%20hour%20sometimes.%20Company%20should%20be%20prepared%20for%20such%20situation%2C%20that%20is%20why%20they%20decided%20to%20conduct%20an%20experiment%2C%20choosing%20some%20non-empty%20subset%20of%20data%20centers%2C%20and%20shifting%20the%20maintenance%20time%20for%20them%20by%20an%20hour%20later%20%28i.e.%20if%20%24%20u_%7Bj%7D%3Dh-1%20%24%20%2C%20then%20the%20new%20maintenance%20hour%20would%20become%20%24%200%20%24%20%2C%20otherwise%20it%20would%20become%20%24%20u_%7Bj%7D%2B1%20%24%20%29.%20Nonetheless%2C%20such%20an%20experiment%20should%20not%20break%20the%20accessibility%20guarantees%2C%20meaning%20that%20data%20of%20any%20client%20should%20be%20still%20available%20during%20any%20hour%20of%20a%20day%20after%20the%20data%20center%20maintenance%20times%20are%20changed.%5Cn%5CnSuch%20an%20experiment%20would%20provide%20useful%20insights%2C%20but%20changing%20update%20time%20is%20quite%20an%20expensive%20procedure%2C%20that%20is%20why%20the%20company%20asked%20you%20to%20find%20out%20the%20minimum%20number%20of%20data%20centers%20that%20have%20to%20be%20included%20in%20an%20experiment%20in%20order%20to%20keep%20the%20data%20accessibility%20guarantees.%22%2C%22inputFormat%22%3A%22The%20first%20line%20of%20input%20contains%20three%20integers%20%24%20n%20%24%20%2C%20%24%20m%20%24%20and%20%24%20h%20%24%20%28%20%24%202%3C%3Dn%3C%3D100000%20%24%20%2C%20%24%201%3C%3Dm%3C%3D100000%20%24%20%2C%20%24%202%3C%3Dh%3C%3D100000%20%24%20%29%2C%20the%20number%20of%20company%20data%20centers%2C%20number%20of%20clients%20and%20the%20day%20length%20of%20day%20measured%20in%20hours.%5Cn%5CnThe%20second%20line%20of%20input%20contains%20%24%20n%20%24%20integers%20%24%20u_%7B1%7D%2Cu_%7B2%7D%2C...%2Cu_%7Bn%7D%20%24%20%28%20%24%200%3C%3Du_%7Bj%7D%3Ch%20%24%20%29%2C%20%24%20j%20%24%20-th%20of%20these%20numbers%20is%20an%20index%20of%20a%20maintenance%20hour%20for%20data%20center%20%24%20j%20%24%20.%5Cn%5CnEach%20of%20the%20next%20%24%20m%20%24%20lines%20contains%20two%20integers%20%24%20c_%7Bi%2C1%7D%20%24%20and%20%24%20c_%7Bi%2C2%7D%20%24%20%28%20%24%201%3C%3Dc_%7Bi%2C1%7D%2Cc_%7Bi%2C2%7D%3C%3Dn%20%24%20%2C%20%24%20c_%7Bi%2C1%7D%5Cu2260c_%7Bi%2C2%7D%20%24%20%29%2C%20defining%20the%20data%20center%20indices%20containing%20the%20data%20of%20client%20%24%20i%20%24%20.%5Cn%5CnIt%20is%20guaranteed%20that%20the%20given%20maintenance%20schedule%20allows%20each%20client%20to%20access%20at%20least%20one%20copy%20of%20his%20data%20at%20any%20moment%20of%20day.%22%2C%22outputFormat%22%3A%22In%20the%20first%20line%20print%20the%20minimum%20possible%20number%20of%20data%20centers%20%24%20k%20%24%20%28%20%24%201%3C%3Dk%3C%3Dn%20%24%20%29%20that%20have%20to%20be%20included%20in%20an%20experiment%20in%20order%20to%20keep%20the%20data%20available%20for%20any%20client.%5Cn%5CnIn%20the%20second%20line%20print%20%24%20k%20%24%20distinct%20integers%20%24%20x_%7B1%7D%2Cx_%7B2%7D%2C...%2Cx_%7Bk%7D%20%24%20%28%20%24%201%3C%3Dx_%7Bi%7D%3C%3Dn%20%24%20%29%2C%20the%20indices%20of%20data%20centers%20whose%20maintenance%20time%20will%20be%20shifted%20by%20one%20hour%20later.%20Data%20center%20indices%20may%20be%20printed%20in%20any%20order.%5Cn%5CnIf%20there%20are%20several%20possible%20answers%2C%20it%20is%20allowed%20to%20print%20any%20of%20them.%20It%20is%20guaranteed%20that%20at%20there%20is%20at%20least%20one%20valid%20choice%20of%20data%20centers.%22%2C%22samples%22%3A%5B%5B%223%203%205%5Cn4%204%200%5Cn1%203%5Cn3%202%5Cn3%201%5Cn%22%2C%221%5Cn3%20%22%5D%2C%5B%224%205%204%5Cn2%201%200%203%5Cn4%203%5Cn3%202%5Cn1%202%5Cn1%204%5Cn1%203%5Cn%22%2C%224%5Cn1%202%203%204%20%22%5D%5D%2C%22hint%22%3A%22Consider%20the%20first%20sample%20test.%20The%20given%20answer%20is%20the%20only%20way%20to%20conduct%20an%20experiment%20involving%20the%20only%20data%20center.%20In%20such%20a%20scenario%20the%20third%20data%20center%20has%20a%20maintenance%20during%20the%20hour%201%2C%20and%20no%20two%20data%20centers%20storing%20the%20information%20of%20the%20same%20client%20have%20maintenance%20at%20the%20same%20hour.%5Cn%5CnOn%20the%20other%20hand%2C%20for%20example%2C%20if%20we%20shift%20the%20maintenance%20time%20on%20hour%20later%20for%20the%20first%20data%20center%2C%20then%20the%20data%20of%20clients%201%20and%203%20will%20be%20unavailable%20during%20the%20hour%200.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%5D%2C%22memory%22%3A%5B512000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F949%5C%2FC%22%2C%22id%22%3A%22949C%22%7D%2C%22translation%22%3A%22%5Cu67d0%5Cu571f%5Cu8c6a%5Cu516c%5Cu53f8%5Cu5efa%5Cu7acb%5Cu4e86n%5Cu4e2a%5Cu6570%5Cu636e%5Cu4e2d%5Cu5fc3%5Cuff0c%5Cu628am%5Cu4efd%5Cu8d44%5Cu6599%5Cu6bcf%5Cu4efd%5Cu5728%5Cu5176%5Cu4e2d%5Cu7684%5Cu4e24%5Cu4e2a%5Cu6570%5Cu636e%5Cu4e2d%5Cu5fc3%5Cu5907%5Cu4efd%5Cu3002%5Cn%5Cu6bcf%5Cu4e2a%5Cu6570%5Cu636e%5Cu4e2d%5Cu5fc3%5Cu5728%5Cu4e00%5Cu5929h%5Cu4e2a%5Cu5c0f%5Cu65f6%5Cu5f53%5Cu4e2d%5Cu6709%5Cu4e00%5Cu4e2a%5Cu5c0f%5Cu65f6%5Cu9700%5Cu8981%5Cu7ef4%5Cu62a4%5Cuff0c%5Cu6b64%5Cu65f6%5Cu4e0d%5Cu63d0%5Cu4f9b%5Cu8d44%5Cu6599%5Cu4e0b%5Cu8f7d%5Cu670d%5Cu52a1%5Cu3002%5Cn%5Cu73b0%5Cu5728%5Cu571f%5Cu8c6a%5Cu516c%5Cu53f8%5Cu60f3%5Cu8981%5Cu5c06%5Cu5176%5Cu4e2d%5Cu82e5%5Cu5e72%5Cu4e2a%5Cu6570%5Cu636e%5Cu4e2d%5Cu5fc3%5Cu7684%5Cu7ef4%5Cu62a4%5Cu65f6%5Cu95f4%5Cu5411%5Cu540e%5Cu63a8%5Cu8fdf%5Cu4e00%5Cu5c0f%5Cu65f6%5Cuff0c%5Cu5e76%5Cu8981%5Cu6c42%5Cu4e00%5Cu5929%5Cu4e2d%5Cu4efb%5Cu610f%5Cu65f6%5Cu523b%5Cu6bcf%5Cu4efd%5Cu8d44%5Cu6599%5Cu90fd%5Cu53ef%5Cu4ee5%5Cu88ab%5Cu4e0b%5Cu8f7d%5Cuff0c%5Cu95ee%5Cu6700%5Cu5c11%5Cu9009%5Cu53d6%5Cu591a%5Cu5c11%5Cu4e2a%5Cu6570%5Cu636e%5Cu4e2d%5Cu5fc3%5Cu7ef4%5Cu62a4%5Cu3002%5Cn%5Cn%5Cu8f93%5Cu5165%5Cn%5Cu7b2c%5Cu4e00%5Cu884cn%2Cm%2Ch%2C%5Cu89c1%5Cu9898%5Cu76ee%5Cu63cf%5Cu8ff0%5Cn%5Cu7b2c%5Cu4e8c%5Cu884cn%5Cu4e2a%5Cu6574%5Cu6570%5Cuff0c%5Cu7ef4%5Cu62a4%5Cu65f6%5Cu95f4%5Cn%5Cu63a5%5Cu4e0b%5Cu6765m%5Cu884c%5Cuff0c%5Cu6bcf%5Cu884c%5Cu4e24%5Cu4e2a%5Cu6574%5Cu6570%5Cuff0c%5Cu5b58%5Cu76f8%5Cu540c%5Cu8d44%5Cu6599%5Cu7684%5Cu4e00%5Cu5bf9%5Cu4e2d%5Cu5fc3%5Cn%5Cn%5Cu8f93%5Cu51fa%5Cn%5Cu7b2c%5Cu4e00%5Cu884c%5Cn%5Cu5fc5%5Cu987b%5Cu63a8%5Cu8fdf%5Cu6570%5Cn%5Cu7b2c%5Cu4e8c%5Cu884c%5Cn%5Cu5206%5Cu522b%5Cu662f%5Cu54ea%5Cu4e9b%5Cu4e2d%5Cu5fc3%5Cn%5Cn%5Cu611f%5Cu8c22%40dijstra%20%5Cu63d0%5Cu4f9b%5Cu7684%5Cu7ffb%5Cu8bd1%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A186%2C%22totalAccepted%22%3A85%2C%22pid%22%3A%22CF949C%22%2C%22title%22%3A%22Data%20Center%20Maintenance%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A48070%2C%22title%22%3A%22%5Cu8fd9%5Cu9053%5Cu9898%5Cu6ce8%5Cu610f%5Cu52a0%5Cu8fb9%5Cu4e0d%5Cu8981%5Cu52a0%5Cu5c11%5Cu4e86%22%2C%22forum%22%3A%7B%22id%22%3A24371%2C%22name%22%3A%22CF949C%20Data%20Center%20Maintenance%22%2C%22slug%22%3A%22CF949C%22%7D%7D%2C%7B%22id%22%3A47959%2C%22title%22%3A%22cf%5Cu51e0%5Cu4e2a%5Cu610f%5Cu601d%5Cuff1f%5Cuff1f%5Cuff1f%5Cu84c4%5Cu610f%5Cu4e0d%5Cu7ed9%5Cu6211%5Cu8bc4%5Cuff1f%5Cuff1f%5Cuff1f%22%2C%22forum%22%3A%7B%22id%22%3A24371%2C%22name%22%3A%22CF949C%20Data%20Center%20Maintenance%22%2C%22slug%22%3A%22CF949C%22%7D%7D%2C%7B%22id%22%3A47846%2C%22title%22%3A%22%5Cu7ffb%5Cu8bd1%5Cu6709%5Cu8bef%22%2C%22forum%22%3A%7B%22id%22%3A24371%2C%22name%22%3A%22CF949C%20Data%20Center%20Maintenance%22%2C%22slug%22%3A%22CF949C%22%7D%7D%2C%7B%22id%22%3A37955%2C%22title%22%3A%22%5Cu7ffb%5Cu8bd1%22%2C%22forum%22%3A%7B%22id%22%3A24371%2C%22name%22%3A%22CF949C%20Data%20Center%20Maintenance%22%2C%22slug%22%3A%22CF949C%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P2272%22%2C%22title%22%3A%22%5BZJOI2007%5D%5Cu6700%5Cu5927%5Cu534a%5Cu8fde%5Cu901a%5Cu5b50%5Cu56fe%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P4297%22%2C%22title%22%3A%22%5BNOI2006%5D%5Cu7f51%5Cu7edc%5Cu6536%5Cu8d39%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22CF875C%22%2C%22title%22%3A%22National%20Property%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF732F%22%2C%22title%22%3A%22Tourist%20Reform%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF949D%22%2C%22title%22%3A%22Curfew%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Data%20Center%20Maintenance%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Data Center Maintenance</h1>
<h2>题意翻译</h2>
<div>某土豪公司建立了n个数据中心，把m份资料每份在其中的两个数据中心备份。
每个数据中心在一天h个小时当中有一个小时需要维护，此时不提供资料下载服务。
现在土豪公司想要将其中若干个数据中心的维护时间向后推迟一小时，并要求一天中任意时刻每份资料都可以被下载，问最少选取多少个数据中心维护。
输入
第一行n,m,h,见题目描述
第二行n个整数，维护时间
接下来m行，每行两个整数，存相同资料的一对中心
输出
第一行
必须推迟数
第二行
分别是哪些中心
感谢@dijstra 提供的翻译</div>
<h2>题目描述</h2>
<div>BigData Inc. is a corporation that has $ n $ data centers indexed from $ 1 $ to $ n $ that are located all over the world. These data centers provide storage for client data (you can figure out that client data is really big!).
Main feature of services offered by BigData Inc. is the access availability guarantee even under the circumstances of any data center having an outage. Such a guarantee is ensured by using the two-way replication. Two-way replication is such an approach for data storage that any piece of data is represented by two identical copies that are stored in two different data centers.
For each of $ m $ company clients, let us denote indices of two different data centers storing this client data as $ c_{i,1} $ and $ c_{i,2} $ .
In order to keep data centers operational and safe, the software running on data center computers is being updated regularly. Release cycle of BigData Inc. is one day meaning that the new version of software is being deployed to the data center computers each day.
Data center software update is a non-trivial long process, that is why there is a special hour-long time frame that is dedicated for data center maintenance. During the maintenance period, data center computers are installing software updates, and thus they may be unavailable. Consider the day to be exactly $ h $ hours long. For each data center there is an integer $ u_{j} $ ( $ 0<=u_{j}<=h-1 $ ) defining the index of an hour of day, such that during this hour data center $ j $ is unavailable due to maintenance.
Summing up everything above, the condition $ u_{ci,1}≠u_{ci,2} $ should hold for each client, or otherwise his data may be unaccessible while data centers that store it are under maintenance.
Due to occasional timezone change in different cities all over the world, the maintenance time in some of the data centers may change by one hour sometimes. Company should be prepared for such situation, that is why they decided to conduct an experiment, choosing some non-empty subset of data centers, and shifting the maintenance time for them by an hour later (i.e. if $ u_{j}=h-1 $ , then the new maintenance hour would become $ 0 $ , otherwise it would become $ u_{j}+1 $ ). Nonetheless, such an experiment should not break the accessibility guarantees, meaning that data of any client should be still available during any hour of a day after the data center maintenance times are changed.
Such an experiment would provide useful insights, but changing update time is quite an expensive procedure, that is why the company asked you to find out the minimum number of data centers that have to be included in an experiment in order to keep the data accessibility guarantees.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line of input contains three integers $ n $ , $ m $ and $ h $ ( $ 2<=n<=100000 $ , $ 1<=m<=100000 $ , $ 2<=h<=100000 $ ), the number of company data centers, number of clients and the day length of day measured in hours.
The second line of input contains $ n $ integers $ u_{1},u_{2},...,u_{n} $ ( $ 0<=u_{j}<h $ ), $ j $ -th of these numbers is an index of a maintenance hour for data center $ j $ . Each of the next $ m $ lines contains two integers $ c_{i,1} $ and $ c_{i,2} $ ( $ 1<=c_{i,1},c_{i,2}<=n $ , $ c_{i,1}≠c_{i,2} $ ), defining the data center indices containing the data of client $ i $ . It is guaranteed that the given maintenance schedule allows each client to access at least one copy of his data at any moment of day.</div>
<h3>输出格式</h3>
<br />
<div>In the first line print the minimum possible number of data centers $ k $ ( $ 1<=k<=n $ ) that have to be included in an experiment in order to keep the data available for any client.
In the second line print $ k $ distinct integers $ x_{1},x_{2},...,x_{k} $ ( $ 1<=x_{i}<=n $ ), the indices of data centers whose maintenance time will be shifted by one hour later. Data center indices may be printed in any order.
If there are several possible answers, it is allowed to print any of them. It is guaranteed that at there is at least one valid choice of data centers.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>3 3 5
4 4 0
1 3
3 2
3 1
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>1
3 </code></pre>
<h3>输入样例 #2</h3>
<pre><code>4 5 4
2 1 0 3
4 3
3 2
1 2
1 4
1 3
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>4
1 2 3 4 </code></pre>
<h2>说明</h2>
<div>Consider the first sample test. The given answer is the only way to conduct an experiment involving the only data center. In such a scenario the third data center has a maintenance during the hour 1, and no two data centers storing the information of the same client have maintenance at the same hour.
On the other hand, for example, if we shift the maintenance time on hour later for the first data center, then the data of clients 1 and 3 will be unavailable during the hour 0.</div>
</article>
</div>
</div>
</body>
</html>
