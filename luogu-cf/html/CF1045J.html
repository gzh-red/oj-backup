<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Moonwalk challenge - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573400967:vU74fKv4xcvQymz2i1DbqZQPNdC0D+vh+75Ic4uMmMM=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Since%20astronauts%20from%20BubbleCup%20XI%20mission%20finished%20their%20mission%20on%20the%20Moon%20and%20are%20big%20fans%20of%20famous%20singer%2C%20they%20decided%20to%20spend%20some%20fun%20time%20before%20returning%20to%20the%20Earth%20and%20hence%20created%20a%20so%20called%20%5C%22Moonwalk%20challenge%5C%22%20game.%5Cn%5CnTeams%20of%20astronauts%20are%20given%20the%20map%20of%20craters%20on%20the%20Moon%20and%20direct%20bidirectional%20paths%20from%20some%20craters%20to%20others%20that%20are%20safe%20for%20%5C%22Moonwalking%5C%22.%20Each%20of%20those%20direct%20paths%20is%20colored%20in%20one%20color%20and%20there%20is%20unique%20path%20between%20each%20two%20craters.%20Goal%20of%20the%20game%20is%20to%20find%20two%20craters%20such%20that%20given%20array%20of%20colors%20appears%20most%20times%20as%20continuous%20subarray%20on%20the%20path%20between%20those%20two%20craters%20%28overlapping%20appearances%20should%20be%20counted%29.%5Cn%5CnTo%20help%20your%20favorite%20team%20win%2C%20you%20should%20make%20a%20program%20that%2C%20given%20the%20map%2C%20answers%20the%20queries%20of%20the%20following%20type%3A%20For%20two%20craters%20and%20array%20of%20colors%20answer%20how%20many%20times%20given%20array%20appears%20as%20continuous%20subarray%20on%20the%20path%20from%20the%20first%20crater%20to%20the%20second.%5Cn%5CnColors%20are%20represented%20as%20lowercase%20English%20alphabet%20letters.%22%2C%22inputFormat%22%3A%22In%20the%20first%20line%2C%20integer%20%24%20N%20%24%20%24%20%282%20%5C%5Cleq%20N%20%5C%5Cleq%2010%5E5%29%20%24%20%5Cu2014%20number%20of%20craters%20on%20the%20Moon.%20Craters%20are%20numerated%20with%20numbers%20%24%201%20%24%20to%20%24%20N%20%24%20.%5Cn%5CnIn%20next%20%24%20N-1%20%24%20lines%2C%20three%20values%20%24%20u%2C%20v%2C%20L%20%24%20%24%20%281%20%5C%5Cleq%20u%2C%20v%20%5C%5Cleq%20N%2C%20L%20%5C%5Cin%20%5C%5C%7Ba%2C%20...%2C%20z%5C%5C%7D%29%20%24%20%5Cu2014%20denoting%20that%20there%20is%20a%20direct%20path%20with%20color%20%24%20L%20%24%20between%20craters%20%24%20u%20%24%20and%20%24%20v%20%24%20.%5Cn%5CnNext%20line%20contains%20integer%20%24%20Q%20%24%20%24%20%281%20%5C%5Cleq%20Q%20%5C%5Cleq%2010%5E5%29%20%24%20%5Cu2014%20number%20of%20queries.%5Cn%5CnNext%20%24%20Q%20%24%20lines%20contain%20three%20values%20%24%20u%2C%20v%20%24%20%24%20%281%20%5C%5Cleq%20u%2C%20v%20%5C%5Cleq%20N%29%20%24%20and%20%24%20S%20%24%20%24%20%28%7CS%7C%20%5C%5Cleq%20100%29%20%24%20%2C%20where%20%24%20u%20%24%20and%20%24%20v%20%24%20are%20the%20two%20cratersfor%20which%20you%20should%20find%20how%20many%20times%20array%20of%20colors%20%24%20S%20%24%20%28represented%20as%20string%29%20appears%20on%20the%20path%20from%20%24%20u%20%24%20to%20%24%20v%20%24%20.%22%2C%22outputFormat%22%3A%22For%20each%20query%20output%20one%20number%20that%20represents%20number%20of%20occurrences%20of%20array%20S%20on%20the%20path%20from%20%24%20u%20%24%20to%20%24%20v%20%24%20.%22%2C%22samples%22%3A%5B%5B%226%5Cn2%203%20g%5Cn3%204%20n%5Cn5%203%20o%5Cn6%201%20n%5Cn1%202%20d%5Cn7%5Cn1%206%20n%5Cn6%204%20dg%5Cn6%204%20n%5Cn2%205%20og%5Cn1%202%20d%5Cn6%205%20go%5Cn2%203%20g%5Cn%22%2C%221%5Cn1%5Cn2%5Cn0%5Cn1%5Cn1%5Cn1%5Cn%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B6000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F1045%5C%2FJ%22%2C%22id%22%3A%221045J%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A19%2C%22totalAccepted%22%3A10%2C%22pid%22%3A%22CF1045J%22%2C%22title%22%3A%22Moonwalk%20challenge%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Moonwalk%20challenge%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Moonwalk challenge</h1>
<h2>题目描述</h2>
<div>Since astronauts from BubbleCup XI mission finished their mission on the Moon and are big fans of famous singer, they decided to spend some fun time before returning to the Earth and hence created a so called "Moonwalk challenge" game.
Teams of astronauts are given the map of craters on the Moon and direct bidirectional paths from some craters to others that are safe for "Moonwalking". Each of those direct paths is colored in one color and there is unique path between each two craters. Goal of the game is to find two craters such that given array of colors appears most times as continuous subarray on the path between those two craters (overlapping appearances should be counted).
To help your favorite team win, you should make a program that, given the map, answers the queries of the following type: For two craters and array of colors answer how many times given array appears as continuous subarray on the path from the first crater to the second.
Colors are represented as lowercase English alphabet letters.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>In the first line, integer $ N $ $ (2 \leq N \leq 10^5) $ — number of craters on the Moon. Craters are numerated with numbers $ 1 $ to $ N $ .
In next $ N-1 $ lines, three values $ u, v, L $ $ (1 \leq u, v \leq N, L \in \{a, ..., z\}) $ — denoting that there is a direct path with color $ L $ between craters $ u $ and $ v $ .
Next line contains integer $ Q $ $ (1 \leq Q \leq 10^5) $ — number of queries.
Next $ Q $ lines contain three values $ u, v $ $ (1 \leq u, v \leq N) $ and $ S $ $ (|S| \leq 100) $ , where $ u $ and $ v $ are the two cratersfor which you should find how many times array of colors $ S $ (represented as string) appears on the path from $ u $ to $ v $ .</div>
<h3>输出格式</h3>
<br />
<div>For each query output one number that represents number of occurrences of array S on the path from $ u $ to $ v $ .</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>6
2 3 g
3 4 n
5 3 o
6 1 n
1 2 d
7
1 6 n
6 4 dg
6 4 n
2 5 og
1 2 d
6 5 go
2 3 g
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>1
1
2
0
1
1
1
</code></pre>
</article>
</div>
</div>
</body>
</html>
