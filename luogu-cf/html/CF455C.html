<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Civilization - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573394271:ci262u5b39s3jykXqK2s4zNv5+i0aQQQDlxtRZnusgI=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%22%2C%22description%22%3A%22Andrew%20plays%20a%20game%20called%20%5C%22Civilization%5C%22.%20Dima%20helps%20him.%5Cn%5CnThe%20game%20has%20%24%20n%20%24%20cities%20and%20%24%20m%20%24%20bidirectional%20roads.%20The%20cities%20are%20numbered%20from%20%24%201%20%24%20to%20%24%20n%20%24%20.%20Between%20any%20pair%20of%20cities%20there%20either%20is%20a%20single%20%28unique%29%20path%2C%20or%20there%20is%20no%20path%20at%20all.%20A%20path%20is%20such%20a%20sequence%20of%20distinct%20cities%20%24%20v_%7B1%7D%2Cv_%7B2%7D%2C...%2Cv_%7Bk%7D%20%24%20%2C%20that%20there%20is%20a%20road%20between%20any%20contiguous%20cities%20%24%20v_%7Bi%7D%20%24%20and%20%24%20v_%7Bi%2B1%7D%20%24%20%28%20%24%201%3C%3Di%3Ck%20%24%20%29.%20The%20length%20of%20the%20described%20path%20equals%20to%20%24%20%28k-1%29%20%24%20.%20We%20assume%20that%20two%20cities%20lie%20in%20the%20same%20region%20if%20and%20only%20if%2C%20there%20is%20a%20path%20connecting%20these%20two%20cities.%5Cn%5CnDuring%20the%20game%20events%20of%20two%20types%20take%20place%3A%5Cn%5Cn1.%20Andrew%20asks%20Dima%20about%20the%20length%20of%20the%20longest%20path%20in%20the%20region%20where%20city%20%24%20x%20%24%20lies.%5Cn2.%20Andrew%20asks%20Dima%20to%20merge%20the%20region%20where%20city%20%24%20x%20%24%20lies%20with%20the%20region%20where%20city%20%24%20y%20%24%20lies.%20If%20the%20cities%20lie%20in%20the%20same%20region%2C%20then%20no%20merging%20is%20needed.%20Otherwise%2C%20you%20need%20to%20merge%20the%20regions%20as%20follows%3A%20choose%20a%20city%20from%20the%20first%20region%2C%20a%20city%20from%20the%20second%20region%20and%20connect%20them%20by%20a%20road%20so%20as%20to%20minimize%20the%20length%20of%20the%20longest%20path%20in%20the%20resulting%20region.%20If%20there%20are%20multiple%20ways%20to%20do%20so%2C%20you%20are%20allowed%20to%20choose%20any%20of%20them.%5Cn%5CnDima%20finds%20it%20hard%20to%20execute%20Andrew%27s%20queries%2C%20so%20he%20asks%20you%20to%20help%20him.%20Help%20Dima.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20three%20integers%20%24%20n%20%24%20%2C%20%24%20m%20%24%20%2C%20%24%20q%20%24%20%28%20%24%201%3C%3Dn%3C%3D3%5Cu00b710%5E%7B5%7D%20%24%20%3B%20%24%200%3C%3Dm%3Cn%20%24%20%3B%20%24%201%3C%3Dq%3C%3D3%5Cu00b710%5E%7B5%7D%20%24%20%29%20%5Cu2014%20the%20number%20of%20cities%2C%20the%20number%20of%20the%20roads%20we%20already%20have%20and%20the%20number%20of%20queries%2C%20correspondingly.%5Cn%5CnEach%20of%20the%20following%20%24%20m%20%24%20lines%20contains%20two%20integers%2C%20%24%20a_%7Bi%7D%20%24%20and%20%24%20b_%7Bi%7D%20%24%20%28%20%24%20a_%7Bi%7D%5Cu2260b_%7Bi%7D%3B%20%24%20%24%201%3C%3Da_%7Bi%7D%2Cb_%7Bi%7D%3C%3Dn%20%24%20%29.%20These%20numbers%20represent%20the%20road%20between%20cities%20%24%20a_%7Bi%7D%20%24%20and%20%24%20b_%7Bi%7D%20%24%20.%20There%20can%20be%20at%20most%20one%20road%20between%20two%20cities.%5Cn%5CnEach%20of%20the%20following%20%24%20q%20%24%20lines%20contains%20one%20of%20the%20two%20events%20in%20the%20following%20format%3A%5Cn%5Cn-%20%24%201%20%24%20%24%20x_%7Bi%7D%20%24%20.%20It%20is%20the%20request%20Andrew%20gives%20to%20Dima%20to%20find%20the%20length%20of%20the%20maximum%20path%20in%20the%20region%20that%20contains%20city%20%24%20x_%7Bi%7D%20%24%20%28%20%24%201%3C%3Dx_%7Bi%7D%3C%3Dn%20%24%20%29.%5Cn-%20%24%202%20%24%20%24%20x_%7Bi%7D%20%24%20%24%20y_%7Bi%7D%20%24%20.%20It%20is%20the%20request%20Andrew%20gives%20to%20Dima%20to%20merge%20the%20region%20that%20contains%20city%20%24%20x_%7Bi%7D%20%24%20and%20the%20region%20that%20contains%20city%20%24%20y_%7Bi%7D%20%24%20%28%20%24%201%3C%3Dx_%7Bi%7D%2Cy_%7Bi%7D%3C%3Dn%20%24%20%29.%20Note%2C%20that%20%24%20x_%7Bi%7D%20%24%20can%20be%20equal%20to%20%24%20y_%7Bi%7D%20%24%20.%22%2C%22outputFormat%22%3A%22For%20each%20event%20of%20the%20first%20type%20print%20the%20answer%20on%20a%20separate%20line.%22%2C%22samples%22%3A%5B%5B%226%200%206%5Cn2%201%202%5Cn2%203%204%5Cn2%205%206%5Cn2%203%202%5Cn2%205%203%5Cn1%201%5Cn%22%2C%224%5Cn%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F455%5C%2FC%22%2C%22id%22%3A%22455C%22%7D%2C%22translation%22%3A%22%5Cu7ed9%5Cu51fa%5Cu4e00%5Cu4e9b%5Cu70b9%5Cuff0c%5Cu4ed6%5Cu4eec%5Cu4e4b%5Cu95f4%5Cu521d%5Cu59cb%5Cu5b58%5Cu5728%5Cu4e00%5Cu4e9b%5Cu8fb9%5Cuff0c%5Cu7ed9%5Cu51fa%5Cu4e24%5Cu79cd%5Cu64cd%5Cu4f5c%5Cuff0c%5Cu7b2c%5Cu4e00%5Cu79cd%5Cu662f%5Cu67e5%5Cu8be2%5Cu67d0%5Cu4e2a%5Cu70b9%5Cu6240%5Cu5728%5Cu7684%5Cu6811%5Cu7684%5Cu76f4%5Cu5f84%5Cuff0c%5Cu53e6%5Cu4e00%5Cu79cd%5Cu662f%5Cu5c06%5Cu4e24%5Cu4e2a%5Cu6811%5Cu5408%5Cu5e76%5Cuff0c%5Cu8981%5Cu6c42%5Cu4f7f%5Cu5408%5Cu5e76%5Cu540e%5Cu7684%5Cu6811%5Cu7684%5Cu76f4%5Cu5f84%5Cu6700%5Cu5c0f%5Cu3002%5CnTranslated%20by%20%40Dr.%5Cu4e5d%5Cu547d%5Cu732b%20%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A260%2C%22totalAccepted%22%3A113%2C%22pid%22%3A%22CF455C%22%2C%22title%22%3A%22Civilization%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A116886%2C%22title%22%3A%22%5Cu65b0%5Cu7684%5Cu7ffb%5Cu8bd1%5Cuff08%5Cu539f%5Cu7ffb%5Cu8bd1%5Cu6709%5Cu70b9%5Cu95ee%5Cu9898%5Cuff09%22%2C%22forum%22%3A%7B%22id%22%3A10833%2C%22name%22%3A%22CF455C%20Civilization%22%2C%22slug%22%3A%22CF455C%22%7D%7D%2C%7B%22id%22%3A32601%2C%22title%22%3A%22%5Cu7ffb%5Cu8bd1%22%2C%22forum%22%3A%7B%22id%22%3A10833%2C%22name%22%3A%22CF455C%20Civilization%22%2C%22slug%22%3A%22CF455C%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P2195%22%2C%22title%22%3A%22HXY%5Cu9020%5Cu516c%5Cu56ed%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P2491%22%2C%22title%22%3A%22%5BSDOI2011%5D%5Cu6d88%5Cu9632%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P3629%22%2C%22title%22%3A%22%5BAPIO2010%5D%5Cu5de1%5Cu903b%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22CF455D%22%2C%22title%22%3A%22Serega%20and%20Fun%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22P4408%22%2C%22title%22%3A%22%5BNOI2003%5D%5Cu9003%5Cu5b66%5Cu7684%5Cu5c0f%5Cu5b69%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22P%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Civilization%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573306449;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Civilization</h1>
<h2>题意翻译</h2>
<div>给出一些点，他们之间初始存在一些边，给出两种操作，第一种是查询某个点所在的树的直径，另一种是将两个树合并，要求使合并后的树的直径最小。
Translated by @Dr.九命猫 </div>
<h2>题目描述</h2>
<div>Andrew plays a game called "Civilization". Dima helps him.
The game has $ n $ cities and $ m $ bidirectional roads. The cities are numbered from $ 1 $ to $ n $ . Between any pair of cities there either is a single (unique) path, or there is no path at all. A path is such a sequence of distinct cities $ v_{1},v_{2},...,v_{k} $ , that there is a road between any contiguous cities $ v_{i} $ and $ v_{i+1} $ ( $ 1<=i<k $ ). The length of the described path equals to $ (k-1) $ . We assume that two cities lie in the same region if and only if, there is a path connecting these two cities. During the game events of two types take place: 1. Andrew asks Dima about the length of the longest path in the region where city $ x $ lies. 2. Andrew asks Dima to merge the region where city $ x $ lies with the region where city $ y $ lies. If the cities lie in the same region, then no merging is needed. Otherwise, you need to merge the regions as follows: choose a city from the first region, a city from the second region and connect them by a road so as to minimize the length of the longest path in the resulting region. If there are multiple ways to do so, you are allowed to choose any of them. Dima finds it hard to execute Andrew's queries, so he asks you to help him. Help Dima.</div>

    <h2>输入输出格式</h2>
    <h3>输入格式</h3>
    <br />
    <div>The first line contains three integers $ n $ , $ m $ , $ q $ ( $ 1<=n<=3·10^{5} $ ; $ 0<=m<n $ ; $ 1<=q<=3·10^{5} $ ) — the number of cities, the number of the roads we already have and the number of queries, correspondingly.

Each of the following $ m $ lines contains two integers, $ a_{i} $ and $ b_{i} $ ( $ a_{i}≠b_{i}; $ $ 1<=a_{i},b_{i}<=n $ ). These numbers represent the road between cities $ a_{i} $ and $ b_{i} $ . There can be at most one road between two cities.

Each of the following $ q $ lines contains one of the two events in the following format:

- $ 1 $ $ x_{i} $ . It is the request Andrew gives to Dima to find the length of the maximum path in the region that contains city $ x_{i} $ ( $ 1<=x_{i}<=n $ ).
- $ 2 $ $ x_{i} $ $ y_{i} $ . It is the request Andrew gives to Dima to merge the region that contains city $ x_{i} $ and the region that contains city $ y_{i} $ ( $ 1<=x_{i},y_{i}<=n $ ). Note, that $ x_{i} $ can be equal to $ y_{i} $ .</div>
    <h3>输出格式</h3>
    <br />
    <div>For each event of the first type print the answer on a separate line.</div>

    <h2>输入输出样例</h2>
                        <h3>输入样例 #1</h3>
            <pre><code>6 0 6
2 1 2
2 3 4
2 5 6
2 3 2
2 5 3
1 1
</code></pre>
            <h3>输出样例 #1</h3>
            <pre><code>4
</code></pre>
            
    </article>
    </div>
</div>
<!-- <script src="//www.recaptcha.net/recaptcha/api.js?hl=zh-CN&render=explicit&onload=renderCaptcha" async defer></script> -->
</body>
</html>
