<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Pills - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573390997:glLtRwDVCI6/3mo8swWIL8LoKEu8LREUV81R1oT1nXU=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Doctor%20prescribed%20medicine%20to%20his%20patient.%20The%20medicine%20is%20represented%20by%20pills.%20Each%20pill%20consists%20of%20a%20shell%20and%20healing%20powder.%20The%20shell%20consists%20of%20two%20halves%3B%20each%20half%20has%20one%20of%20four%20colors%20%5Cu2014%20blue%2C%20red%2C%20white%20or%20yellow.%5Cn%5CnThe%20doctor%20wants%20to%20put%20%24%2028%20%24%20pills%20in%20a%20rectangular%20box%20%24%207%5Cu00d78%20%24%20in%20size.%20Besides%2C%20each%20pill%20occupies%20exactly%20two%20neighboring%20cells%20and%20any%20cell%20contains%20exactly%20one%20half%20of%20a%20pill.%20Thus%2C%20the%20result%20is%20a%20four%20colored%20picture%20%24%207%5Cu00d78%20%24%20in%20size.%5Cn%5CnThe%20doctor%20thinks%20that%20a%20patient%20will%20recover%20sooner%20if%20the%20picture%20made%20by%20the%20pills%20will%20be%20special.%20Unfortunately%2C%20putting%20the%20pills%20in%20the%20box%20so%20as%20to%20get%20the%20required%20picture%20is%20not%20a%20very%20easy%20task.%20That%27s%20why%20doctor%20asks%20you%20to%20help.%5Cn%5CnDoctor%20has%20some%20amount%20of%20pills%20of%20each%20of%20%24%2010%20%24%20painting%20types.%20They%20all%20contain%20the%20same%20medicine%2C%20that%27s%20why%20it%20doesn%27t%20matter%20which%20%24%2028%20%24%20of%20them%20will%20be%20stored%20inside%20the%20box.%5Cn%5CnPlace%20the%20pills%20in%20the%20box%20so%20that%20the%20required%20picture%20was%20formed.%20If%20it%20is%20impossible%20to%20place%20the%20pills%20in%20the%20required%20manner%2C%20then%20place%20them%20so%20that%20the%20number%20of%20matching%20colors%20in%20all%20%24%2056%20%24%20cells%20in%20the%20final%20arrangement%20and%20the%20doctor%27s%20picture%20were%20maximum.%22%2C%22inputFormat%22%3A%22First%20%24%207%20%24%20lines%20contain%20the%20doctor%27s%20picture.%20Each%20line%20contains%20%24%208%20%24%20characters%2C%20each%20character%20can%20be%20%5C%22B%5C%22%2C%20%5C%22R%5C%22%2C%20%5C%22W%5C%22%20and%20%5C%22Y%5C%22%20that%20stands%20for%20blue%2C%20red%2C%20white%20and%20yellow%20colors%20correspondingly.%5Cn%5CnNext%20four%20lines%20contain%20%24%2010%20%24%20numbers%20that%20stand%20for%2C%20correspondingly%2C%20the%20number%20of%20pills%20painted%3A%5Cn%5Cn%5C%22BY%5C%22%20%5C%22BW%5C%22%20%5C%22BR%5C%22%20%5C%22BB%5C%22%5Cn%5Cn%5C%22RY%5C%22%20%5C%22RW%5C%22%20%5C%22RR%5C%22%5Cn%5Cn%5C%22WY%5C%22%20%5C%22WW%5C%22%5Cn%5Cn%5C%22YY%5C%22%5Cn%5CnThose%20numbers%20lie%20within%20range%20from%20%24%200%20%24%20to%20%24%2028%20%24%20inclusively.%20It%20is%20guaranteed%20that%20the%20total%20number%20of%20pills%20in%20no%20less%20than%20%24%2028%20%24%20.%22%2C%22outputFormat%22%3A%22Print%20on%20the%20first%20line%20the%20maximal%20number%20cells%20for%20which%20the%20colors%20match.%5Cn%5CnThen%20print%20%24%2013%20%24%20lines%20each%20containing%20%24%2015%20%24%20characters%20%5Cu2014%20the%20pills%27%20position%20in%20the%20optimal%20arrangement.%20The%20intersections%20of%20odd%20lines%20and%20odd%20columns%20should%20contain%20characters%20%5C%22B%5C%22%2C%20%5C%22R%5C%22%2C%20%5C%22W%5C%22%20and%20%5C%22Y%5C%22.%20All%20other%20positions%20should%20contain%20characters%20%5C%22.%5C%22%2C%20%5C%22-%5C%22%20and%20%5C%22%7C%5C%22.%20Use%20%5C%22-%5C%22%20and%20%5C%22%7C%5C%22%20to%20show%20which%20halves%20belong%20to%20one%20pill.%20See%20the%20samples%20for%20more%20clarification.%5Cn%5CnIf%20there%20are%20several%20possible%20solutions%2C%20print%20any%20of%20them.%22%2C%22samples%22%3A%5B%5B%22WWWBBWWW%5CnWWWBBWWW%5CnYYWBBWWW%5CnYYWBBWRR%5CnYYWBBWRR%5CnYYWBBWRR%5CnYYWBBWRR%5Cn0%200%200%208%5Cn0%201%205%5Cn1%2010%5Cn5%5Cn%22%2C%2253%5CnW.W.W.B.B.W.W.W%5Cn%7C.%7C.%7C.%7C.%7C.%7C.%7C.%7C%5CnW.W.W.B.B.W.W.W%5Cn...............%5CnY.Y.W.B.B.W.W-W%5Cn%7C.%7C.%7C.%7C.%7C.%7C....%5CnY.Y.W.B.B.W.R.R%5Cn............%7C.%7C%5CnY.Y.W.B.B.R.R.R%5Cn%7C.%7C.%7C.%7C.%7C.%7C....%5CnY.Y.W.B.B.W.R.R%5Cn............%7C.%7C%5CnY-Y.B-B.B-B.R.R%5Cn%22%5D%2C%5B%22WWWWWWWW%5CnWBYWRBBY%5CnBRYRBWYY%5CnWWBRYWBB%5CnBWWRWBYW%5CnRBWRBWYY%5CnWWWWWWWW%5Cn0%200%200%201%5Cn0%200%201%5Cn0%201%5Cn25%5Cn%22%2C%2215%5CnW.Y.Y-Y.Y-Y.Y-Y%5Cn%7C.%7C............%5CnW.Y.Y.Y.Y.B-B.Y%5Cn....%7C.%7C.%7C.....%7C%5CnY-Y.Y.Y.Y.Y-Y.Y%5Cn...............%5CnY.Y.Y.R.Y.Y.Y-Y%5Cn%7C.%7C.%7C.%7C.%7C.%7C....%5CnY.Y.Y.R.Y.Y.Y.Y%5Cn............%7C.%7C%5CnY-Y.Y.Y-Y.Y.Y.Y%5Cn....%7C.....%7C....%5CnY-Y.Y.Y-Y.Y.Y-Y%5Cn%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1500%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F126%5C%2FE%22%2C%22id%22%3A%22126E%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22CF126E%22%2C%22title%22%3A%22Pills%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Pills%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573295103;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Pills</h1>
<h2>题目描述</h2>
<div>Doctor prescribed medicine to his patient. The medicine is represented by pills. Each pill consists of a shell and healing powder. The shell consists of two halves; each half has one of four colors — blue, red, white or yellow.
The doctor wants to put $ 28 $ pills in a rectangular box $ 7×8 $ in size. Besides, each pill occupies exactly two neighboring cells and any cell contains exactly one half of a pill. Thus, the result is a four colored picture $ 7×8 $ in size.
The doctor thinks that a patient will recover sooner if the picture made by the pills will be special. Unfortunately, putting the pills in the box so as to get the required picture is not a very easy task. That's why doctor asks you to help.
Doctor has some amount of pills of each of $ 10 $ painting types. They all contain the same medicine, that's why it doesn't matter which $ 28 $ of them will be stored inside the box.
Place the pills in the box so that the required picture was formed. If it is impossible to place the pills in the required manner, then place them so that the number of matching colors in all $ 56 $ cells in the final arrangement and the doctor's picture were maximum.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>First $ 7 $ lines contain the doctor's picture. Each line contains $ 8 $ characters, each character can be "B", "R", "W" and "Y" that stands for blue, red, white and yellow colors correspondingly.
Next four lines contain $ 10 $ numbers that stand for, correspondingly, the number of pills painted:
"BY" "BW" "BR" "BB"
"RY" "RW" "RR"
"WY" "WW"
"YY"
Those numbers lie within range from $ 0 $ to $ 28 $ inclusively. It is guaranteed that the total number of pills in no less than $ 28 $ .</div>
<h3>输出格式</h3>
<br />
<div>Print on the first line the maximal number cells for which the colors match.
Then print $ 13 $ lines each containing $ 15 $ characters — the pills' position in the optimal arrangement. The intersections of odd lines and odd columns should contain characters "B", "R", "W" and "Y". All other positions should contain characters ".", "-" and "|". Use "-" and "|" to show which halves belong to one pill. See the samples for more clarification.
If there are several possible solutions, print any of them.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>WWWBBWWW
WWWBBWWW
YYWBBWWW
YYWBBWRR
YYWBBWRR
YYWBBWRR
YYWBBWRR
0 0 0 8
0 1 5
1 10
5
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>53
W.W.W.B.B.W.W.W
|.|.|.|.|.|.|.|
W.W.W.B.B.W.W.W
...............
Y.Y.W.B.B.W.W-W
|.|.|.|.|.|....
Y.Y.W.B.B.W.R.R
............|.|
Y.Y.W.B.B.R.R.R
|.|.|.|.|.|....
Y.Y.W.B.B.W.R.R
............|.|
Y-Y.B-B.B-B.R.R
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>WWWWWWWW
WBYWRBBY
BRYRBWYY
WWBRYWBB
BWWRWBYW
RBWRBWYY
WWWWWWWW
0 0 0 1
0 0 1
0 1
25
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>15
W.Y.Y-Y.Y-Y.Y-Y
|.|............
W.Y.Y.Y.Y.B-B.Y
....|.|.|.....|
Y-Y.Y.Y.Y.Y-Y.Y
...............
Y.Y.Y.R.Y.Y.Y-Y
|.|.|.|.|.|....
Y.Y.Y.R.Y.Y.Y.Y
............|.|
Y-Y.Y.Y-Y.Y.Y.Y
....|.....|....
Y-Y.Y.Y-Y.Y.Y-Y
</code></pre>
</article>
</div>
</div>
</body>
</html>
