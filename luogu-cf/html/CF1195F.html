<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Geometers Anonymous Club - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573402942:GDFMzRg8inbGM92W1Zt9Jx8kh8fe8+4/YS7mp/WKw8c=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Denis%20holds%20a%20Geometers%20Anonymous%20Club%20meeting%20in%20SIS.%20He%20has%20prepared%20%24%20n%20%24%20convex%20polygons%20numbered%20from%20%24%201%20%24%20to%20%24%20n%20%24%20for%20the%20club.%20He%20plans%20to%20offer%20members%20of%20the%20club%20to%20calculate%20Minkowski%20sums%20of%20these%20polygons.%20More%20precisely%2C%20he%20plans%20to%20give%20%24%20q%20%24%20tasks%2C%20the%20%24%20i%20%24%20-th%20of%20them%20asks%20to%20calculate%20the%20sum%20of%20Minkowski%20of%20polygons%20with%20indices%20from%20%24%20l_i%20%24%20to%20%24%20r_i%20%24%20inclusive.%5Cn%5CnThe%20sum%20of%20Minkowski%20of%20two%20sets%20%24%20A%20%24%20and%20%24%20B%20%24%20is%20the%20set%20%24%20C%20%3D%20%5C%5C%7Ba%20%2B%20b%20%3A%20a%20%5C%5Cin%20A%2C%20b%20%5C%5Cin%20B%5C%5C%7D%20%24%20.%20It%20can%20be%20proven%20that%20if%20%24%20A%20%24%20and%20%24%20B%20%24%20are%20convex%20polygons%20then%20%24%20C%20%24%20will%20also%20be%20a%20convex%20polygon.%5Cn%5Cn%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF1195F%5C%2F6cb3a86dcaf05238ec4394822e407fdc522f38b9.png%29%20Sum%20of%20two%20convex%20polygons%20To%20calculate%20the%20sum%20of%20Minkowski%20of%20%24%20p%20%24%20polygons%20%28%20%24%20p%20%3E%202%20%24%20%29%2C%20you%20need%20to%20calculate%20the%20sum%20of%20Minkowski%20of%20the%20first%20%24%20p%20-%201%20%24%20polygons%2C%20and%20then%20calculate%20the%20sum%20of%20Minkowski%20of%20the%20resulting%20polygon%20and%20the%20%24%20p%20%24%20-th%20polygon.%5Cn%5CnFor%20the%20convenience%20of%20checking%20answers%2C%20Denis%20has%20decided%20to%20prepare%20and%20calculate%20the%20number%20of%20vertices%20in%20the%20sum%20of%20Minkowski%20for%20each%20task%20he%20prepared.%20Help%20him%20to%20do%20it.%22%2C%22inputFormat%22%3A%22The%20first%20line%20of%20the%20input%20contains%20one%20integer%20%24%20n%20%24%20%5Cu2014%20the%20number%20of%20convex%20polygons%20Denis%20prepared%20%28%20%24%201%20%5C%5Cle%20n%20%5C%5Cle%20100%5C%5C%2C000%20%24%20%29.%5Cn%5CnThen%20%24%20n%20%24%20convex%20polygons%20follow.%20The%20description%20of%20the%20%24%20i%20%24%20-th%20polygon%20starts%20with%20one%20integer%20%24%20k_i%20%24%20%5Cu2014%20the%20number%20of%20vertices%20in%20the%20%24%20i%20%24%20-th%20polygon%20%28%20%24%203%20%5C%5Cle%20k_i%20%24%20%29.%20The%20next%20%24%20k_i%20%24%20lines%20contain%20two%20integers%20%24%20x_%7Bij%7D%20%24%20%2C%20%24%20y_%7Bij%7D%20%24%20each%20%5Cu2014%20coordinates%20of%20vertices%20of%20the%20%24%20i%20%24%20-th%20polygon%20in%20counterclockwise%20order%20%28%20%24%20%7Cx_%7Bij%7D%7C%2C%20%7Cy_%7Bij%7D%7C%20%5C%5Cle%2010%20%5E%209%20%24%20%29.%5Cn%5CnIt%20is%20guaranteed%2C%20that%20there%20are%20no%20three%20consecutive%20vertices%20lying%20on%20the%20same%20line.%20The%20total%20number%20of%20vertices%20over%20all%20polygons%20does%20not%20exceed%20%24%20300%5C%5C%2C000%20%24%20.%5Cn%5CnThe%20following%20line%20contains%20one%20integer%20%24%20q%20%24%20%5Cu2014%20the%20number%20of%20tasks%20%28%20%24%201%20%5C%5Cle%20q%20%5C%5Cle%20100%5C%5C%2C000%20%24%20%29.%20The%20next%20%24%20q%20%24%20lines%20contain%20descriptions%20of%20tasks.%20Description%20of%20the%20%24%20i%20%24%20-th%20task%20contains%20two%20integers%20%24%20l_i%20%24%20and%20%24%20r_i%20%24%20%28%20%24%201%20%5C%5Cle%20l_i%20%5C%5Cle%20r_i%20%5C%5Cle%20n%20%24%20%29.%22%2C%22outputFormat%22%3A%22For%20each%20task%20print%20a%20single%20integer%20%5Cu2014%20the%20number%20of%20vertices%20in%20the%20sum%20of%20Minkowski%20of%20polygons%20with%20indices%20from%20%24%20l_i%20%24%20to%20%24%20r_i%20%24%20.%22%2C%22samples%22%3A%5B%5B%22%5Cn3%5Cn3%5Cn0%200%5Cn1%200%5Cn0%201%5Cn4%5Cn1%201%5Cn1%202%5Cn0%202%5Cn0%201%5Cn3%5Cn2%202%5Cn1%202%5Cn2%201%5Cn3%5Cn1%202%5Cn2%203%5Cn1%203%5Cn%22%2C%22%5Cn5%5Cn5%5Cn6%5Cn%22%5D%5D%2C%22hint%22%3A%22Description%20of%20the%20example%3A%5Cn%5Cn%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF1195F%5C%2F7fef00df88160094dee94144ed635016f4f9336b.png%29%20First%2C%20second%20and%20third%20polygons%20from%20the%20example%20%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF1195F%5C%2Fb26197f6a29c4e49f72b5ed1cd886243ac11f90c.png%29%20Minkowski%20sums%20of%20the%20first%20and%20second%2C%20the%20second%20and%20third%20and%20all%20polygons%20correspondingly%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F1195%5C%2FF%22%2C%22id%22%3A%221195F%22%7D%2C%22translation%22%3A%22%23%23%20%5Cu9898%5Cu76ee%5Cu63cf%5Cu8ff0%5Cr%5Cnn%5Cu4e2a%5Cu51f8%5Cu591a%5Cu8fb9%5Cu5f62%20%24%5Cuff081%20%3C%3D%20n%20%3C%3D%20100000%20%20%5Cuff09%24%20%2C%5Cu9876%5Cu70b9%5Cu603b%5Cu6570%5Cu4e0d%5Cu8d85%5Cu8fc7%24%20300000%20%24%20%5Cuff1b%5Cr%5Cn%5Cr%5Cn%5Cu6709q%20%24%281%20%3C%3D%20q%20%3C%3D%20100000%29%24%20%20%5Cu4e2a%5Cu8be2%5Cu95ee%5Cuff0c%5Cu6bcf%5Cu4e2a%5Cu8be2%5Cu95ee%5Cu5230%24r_i%24%5Cu7f16%5Cu53f7%5Cu591a%5Cu8fb9%5Cu5f62%5Cu7684%5Cu95f5%5Cu53ef%5Cu592b%5Cu65af%5Cu57fa%5Cu548c%5Cr%5Cn%5Cr%5Cn%5Cuff08%5Cu95f5%5Cu53ef%5Cu592b%5Cu65af%5Cu57fa%5Cu548c%5Cuff1aA%20%5Cuff0cB%5Cu7684%5Cu95f5%5Cu53ef%5Cu592b%5Cu65af%5Cu57fa%5Cu548c%5Cu5c31%5Cu662fC%20%3D%20%7Ba%2Bb%7D%2Ca%2Cb%5Cu662fA%5Cuff0cB%5Cu4e2d%5Cu7684%5Cu5143%5Cu7d20%5Cuff0c%5Cu7ed3%5Cu5408%5Cu56fe%5Cu5f62%5Cu7406%5Cu89e3%5Cu4e00%5Cu4e0bqwq%5Cuff09%5Cr%5Cn%5Cr%5Cn%23%23%20%5Cu8f93%5Cu5165%5Cu8f93%5Cu51fa%5Cu683c%5Cu5f0f%5Cr%5Cn%2A%20%5Cu8f93%5Cu5165%5Cu683c%5Cu5f0f%5Cr%5Cn%5Cr%5Cn%5Cu7b2c%5Cu4e00%5Cu884c%5Cu8f93%5Cu5165n%5Cr%5Cn%5Cr%5Cn%5Cu968f%5Cu540e%5Cu8f93%5Cu5165n%5Cu4e2a%24k_i%24%20%24%28k%3E%3D3%29%24%20%5Cu8868%5Cu793a%5Cu51f8%5Cu591a%5Cu8fb9%5Cu5f62%5Cu7684%5Cu9876%5Cu70b9%5Cu6570%5Cu91cf%20%2C%5Cu7136%5Cu540e%5Cu8f93%5Cu5165%24k_i%24%20%5Cu884c%20%24x_i%20%2C%20y_i%24%20%28%5Cu7edd%5Cu5bf9%5Cu503c%5Cu4e0d%5Cu5927%5Cu4e8e1e9%29%5Cr%5Cn%5Cr%5Cn%5Cu968f%5Cu540e%5Cu8f93%5Cu5165q%5Cr%5Cn%5Cr%5Cn%5Cu63a5%5Cu4e0b%5Cu6765q%5Cu884c%2C%5Cu6bcf%5Cu884c%24l_i%20%2C%20r_i%20%24%5Cu8868%5Cu793a%5Cu8be2%5Cu95ee%5Cu533a%5Cu95f4%5Cr%5Cn%5Cr%5Cn%2A%20%5Cu8f93%5Cu51fa%5Cu683c%5Cu5f0f%5Cr%5Cn%5Cr%5Cnq%5Cu884c%20%5Cuff0c%5Cu6bcf%5Cu884c%5Cu8868%5Cu793a%5Cu6700%5Cu7ec8%5Cu7b54%5Cu6848%5Cu591a%5Cu8fb9%5Cu5f62%5Cu7684%5Cu9876%5Cu70b9%5Cu6570%5Cr%5Cn%5Cr%5Cn%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A29%2C%22totalAccepted%22%3A20%2C%22pid%22%3A%22CF1195F%22%2C%22title%22%3A%22Geometers%20Anonymous%20Club%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Geometers%20Anonymous%20Club%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Geometers Anonymous Club</h1>
<h2>题意翻译</h2>
<div>## 题目描述
n个凸多边形 $（1 <= n <= 100000 ）$ ,顶点总数不超过$ 300000 $ ；
有q $(1 <= q <= 100000)$ 个询问，每个询问到$r_i$编号多边形的闵可夫斯基和
（闵可夫斯基和：A ，B的闵可夫斯基和就是C = {a+b},a,b是A，B中的元素，结合图形理解一下qwq）
## 输入输出格式
* 输入格式
第一行输入n
随后输入n个$k_i$ $(k>=3)$ 表示凸多边形的顶点数量 ,然后输入$k_i$ 行 $x_i , y_i$ (绝对值不大于1e9)
随后输入q
接下来q行,每行$l_i , r_i $表示询问区间
* 输出格式
q行 ，每行表示最终答案多边形的顶点数
</div>
<h2>题目描述</h2>
<div>Denis holds a Geometers Anonymous Club meeting in SIS. He has prepared $ n $ convex polygons numbered from $ 1 $ to $ n $ for the club. He plans to offer members of the club to calculate Minkowski sums of these polygons. More precisely, he plans to give $ q $ tasks, the $ i $ -th of them asks to calculate the sum of Minkowski of polygons with indices from $ l_i $ to $ r_i $ inclusive.
The sum of Minkowski of two sets $ A $ and $ B $ is the set $ C = \{a + b : a \in A, b \in B\} $ . It can be proven that if $ A $ and $ B $ are convex polygons then $ C $ will also be a convex polygon.
![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1195F/6cb3a86dcaf05238ec4394822e407fdc522f38b9.png) Sum of two convex polygons To calculate the sum of Minkowski of $ p $ polygons ( $ p > 2 $ ), you need to calculate the sum of Minkowski of the first $ p - 1 $ polygons, and then calculate the sum of Minkowski of the resulting polygon and the $ p $ -th polygon.
For the convenience of checking answers, Denis has decided to prepare and calculate the number of vertices in the sum of Minkowski for each task he prepared. Help him to do it.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line of the input contains one integer $ n $ — the number of convex polygons Denis prepared ( $ 1 \le n \le 100\,000 $ ).
Then $ n $ convex polygons follow. The description of the $ i $ -th polygon starts with one integer $ k_i $ — the number of vertices in the $ i $ -th polygon ( $ 3 \le k_i $ ). The next $ k_i $ lines contain two integers $ x_{ij} $ , $ y_{ij} $ each — coordinates of vertices of the $ i $ -th polygon in counterclockwise order ( $ |x_{ij}|, |y_{ij}| \le 10 ^ 9 $ ).
It is guaranteed, that there are no three consecutive vertices lying on the same line. The total number of vertices over all polygons does not exceed $ 300\,000 $ .
The following line contains one integer $ q $ — the number of tasks ( $ 1 \le q \le 100\,000 $ ). The next $ q $ lines contain descriptions of tasks. Description of the $ i $ -th task contains two integers $ l_i $ and $ r_i $ ( $ 1 \le l_i \le r_i \le n $ ).</div>
<h3>输出格式</h3>
<br />
<div>For each task print a single integer — the number of vertices in the sum of Minkowski of polygons with indices from $ l_i $ to $ r_i $ .</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>
3
3
0 0
1 0
0 1
4
1 1
1 2
0 2
0 1
3
2 2
1 2
2 1
3
1 2
2 3
1 3
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>
5
5
6
</code></pre>
<h2>说明</h2>
<div>Description of the example:
![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1195F/7fef00df88160094dee94144ed635016f4f9336b.png) First, second and third polygons from the example ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1195F/b26197f6a29c4e49f72b5ed1cd886243ac11f90c.png) Minkowski sums of the first and second, the second and third and all polygons correspondingly</div>
</article>
</div>
</div>
</body>
</html>
