<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Smart Cheater - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573391200:euoaYXVTipD/V3w5gYQ71IZ1+yRKetr1zOfH9cKVDMI=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22I%20guess%20there%27s%20not%20much%20point%20in%20reminding%20you%20that%20Nvodsk%20winters%20aren%27t%20exactly%20hot.%20That%20increased%20the%20popularity%20of%20the%20public%20transport%20dramatically.%20The%20route%20of%20bus%20%24%2062%20%24%20has%20exactly%20%24%20n%20%24%20stops%20%28stop%20%24%201%20%24%20goes%20first%20on%20its%20way%20and%20stop%20%24%20n%20%24%20goes%20last%29.%20The%20stops%20are%20positioned%20on%20a%20straight%20line%20and%20their%20coordinates%20are%20%24%200%3Dx_%7B1%7D%26lt%3Bx_%7B2%7D%26lt%3B...%26lt%3Bx_%7Bn%7D%20%24%20.%5Cn%5CnEach%20day%20exactly%20%24%20m%20%24%20people%20use%20bus%20%24%2062%20%24%20.%20For%20each%20person%20we%20know%20the%20number%20of%20the%20stop%20where%20he%20gets%20on%20the%20bus%20and%20the%20number%20of%20the%20stop%20where%20he%20gets%20off%20the%20bus.%20A%20ticket%20from%20stop%20%24%20a%20%24%20to%20stop%20%24%20b%20%24%20%28%20%24%20a%26lt%3Bb%20%24%20%29%20costs%20%24%20x_%7Bb%7D-x_%7Ba%7D%20%24%20rubles.%20However%2C%20the%20conductor%20can%20choose%20no%20more%20than%20one%20segment%20NOT%20TO%20SELL%20a%20ticket%20for.%20We%20mean%20that%20conductor%20should%20choose%20C%20and%20D%20%28%5Cu0421%20%3C%3D%20D%29%20and%20sell%20a%20ticket%20for%20the%20segments%20%5C%5C%5B%20%24%20A%20%24%20%2C%20%24%20C%20%24%20%5C%5C%5D%20and%20%5C%5C%5B%20%24%20D%20%24%20%2C%20%24%20B%20%24%20%5C%5C%5D%2C%20or%20not%20sell%20the%20ticket%20at%20all.%20The%20conductor%20and%20the%20passenger%20divide%20the%20saved%20money%20between%20themselves%20equally.%20The%20conductor%27s%20%5C%22untaxed%20income%5C%22%20is%20sometimes%20interrupted%20by%20inspections%20that%20take%20place%20as%20the%20bus%20drives%20on%20some%20segment%20of%20the%20route%20located%20between%20two%20consecutive%20stops.%20The%20inspector%20fines%20the%20conductor%20by%20%24%20c%20%24%20rubles%20for%20each%20passenger%20who%20doesn%27t%20have%20the%20ticket%20for%20this%20route%27s%20segment.%5Cn%5CnYou%20know%20the%20coordinated%20of%20all%20stops%20%24%20x_%7Bi%7D%20%24%20%3B%20the%20numbers%20of%20stops%20where%20the%20%24%20i%20%24%20-th%20passenger%20gets%20on%20and%20off%2C%20%24%20a_%7Bi%7D%20%24%20and%20%24%20b_%7Bi%7D%20%24%20%28%20%24%20a_%7Bi%7D%26lt%3Bb_%7Bi%7D%20%24%20%29%3B%20the%20fine%20%24%20c%20%24%20%3B%20and%20also%20%24%20p_%7Bi%7D%20%24%20%5Cu2014%20the%20probability%20of%20inspection%20on%20segment%20between%20the%20%24%20i%20%24%20-th%20and%20the%20%24%20i%2B1%20%24%20-th%20stop.%20The%20conductor%20asked%20you%20to%20help%20him%20make%20a%20plan%20of%20selling%20tickets%20that%20maximizes%20the%20mathematical%20expectation%20of%20his%20profit.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20three%20integers%20%24%20n%20%24%20%2C%20%24%20m%20%24%20and%20%24%20c%20%24%20%28%20%24%202%3C%3Dn%3C%3D150000%20%24%20%2C%20%24%201%3C%3Dm%3C%3D300000%20%24%20%2C%20%24%201%3C%3Dc%3C%3D10000%20%24%20%29.%5Cn%5CnThe%20next%20line%20contains%20%24%20n%20%24%20integers%20%24%20x_%7Bi%7D%20%24%20%28%20%24%200%3C%3Dx_%7Bi%7D%3C%3D10%5E%7B9%7D%20%24%20%2C%20%24%20x_%7B1%7D%3D0%20%24%20%2C%20%24%20x_%7Bi%7D%26lt%3Bx_%7Bi%2B1%7D%20%24%20%29%20%5Cu2014%20the%20coordinates%20of%20the%20stops%20on%20the%20bus%27s%20route.%5Cn%5CnThe%20third%20line%20contains%20%24%20n-1%20%24%20integer%20%24%20p_%7Bi%7D%20%24%20%28%20%24%200%3C%3Dp_%7Bi%7D%3C%3D100%20%24%20%29%20%5Cu2014%20the%20probability%20of%20inspection%20in%20percents%20on%20the%20segment%20between%20stop%20%24%20i%20%24%20and%20stop%20%24%20i%2B1%20%24%20.%5Cn%5CnThen%20follow%20%24%20m%20%24%20lines%20that%20describe%20the%20bus%27s%20passengers.%20Each%20line%20contains%20exactly%20two%20integers%20%24%20a_%7Bi%7D%20%24%20and%20%24%20b_%7Bi%7D%20%24%20%28%20%24%201%3C%3Da_%7Bi%7D%26lt%3Bb_%7Bi%7D%3C%3Dn%20%24%20%29%20%5Cu2014%20the%20numbers%20of%20stops%20where%20the%20%24%20i%20%24%20-th%20passenger%20gets%20on%20and%20off.%22%2C%22outputFormat%22%3A%22Print%20the%20single%20real%20number%20%5Cu2014%20the%20maximum%20expectation%20of%20the%20conductor%27s%20profit.%20Your%20answer%20will%20be%20considered%20correct%20if%20its%20absolute%20or%20relative%20error%20does%20not%20exceed%20%24%2010%5E%7B-6%7D%20%24%20.%5Cn%5CnNamely%3A%20let%27s%20assume%20that%20your%20answer%20is%20%24%20a%20%24%20%2C%20and%20the%20answer%20of%20the%20jury%20is%20%24%20b%20%24%20.%20The%20checker%20program%20will%20consider%20your%20answer%20correct%2C%20if%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF150C%5C%2F259203790d90e969d73ec841bd0673c1e8e7d69a.png%29.%22%2C%22samples%22%3A%5B%5B%223%203%2010%5Cn0%2010%20100%5Cn100%200%5Cn1%202%5Cn2%203%5Cn1%203%5Cn%22%2C%2290.000000000%5Cn%22%5D%2C%5B%2210%208%20187%5Cn0%2010%2030%2070%20150%20310%20630%201270%202550%2051100%5Cn13%2087%2065%200%20100%2044%2067%203%204%5Cn1%2010%5Cn2%209%5Cn3%208%5Cn1%205%5Cn6%2010%5Cn2%207%5Cn4%2010%5Cn4%205%5Cn%22%2C%2276859.990000000%5Cn%22%5D%5D%2C%22hint%22%3A%22A%20comment%20to%20the%20first%20sample%3A%5Cn%5CnThe%20first%20and%20third%20passengers%20get%20tickets%20from%20stop%20%24%201%20%24%20to%20stop%20%24%202%20%24%20.%20The%20second%20passenger%20doesn%27t%20get%20a%20ticket.%20There%20always%20is%20inspection%20on%20the%20segment%20%24%201%20%24%20-%20%24%202%20%24%20but%20both%20passengers%20have%20the%20ticket%20for%20it.%20There%20never%20is%20an%20inspection%20on%20the%20segment%20%24%202%20%24%20-%20%24%203%20%24%20%2C%20that%27s%20why%20the%20second%20passenger%20gets%20away%20with%20the%20cheating.%20Our%20total%20profit%20is%20%24%20%280%2B90%5C%2F2%2B90%5C%2F2%29%3D90%20%24%20.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B5000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F150%5C%2FC%22%2C%22id%22%3A%22150C%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22CF150C%22%2C%22title%22%3A%22Smart%20Cheater%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Smart%20Cheater%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573295103;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Smart Cheater</h1>
<h2>题目描述</h2>
<div>I guess there's not much point in reminding you that Nvodsk winters aren't exactly hot. That increased the popularity of the public transport dramatically. The route of bus $ 62 $ has exactly $ n $ stops (stop $ 1 $ goes first on its way and stop $ n $ goes last). The stops are positioned on a straight line and their coordinates are $ 0=x_{1}&lt;x_{2}&lt;...&lt;x_{n} $ .
Each day exactly $ m $ people use bus $ 62 $ . For each person we know the number of the stop where he gets on the bus and the number of the stop where he gets off the bus. A ticket from stop $ a $ to stop $ b $ ( $ a&lt;b $ ) costs $ x_{b}-x_{a} $ rubles. However, the conductor can choose no more than one segment NOT TO SELL a ticket for. We mean that conductor should choose C and D (С <= D) and sell a ticket for the segments \[ $ A $ , $ C $ \] and \[ $ D $ , $ B $ \], or not sell the ticket at all. The conductor and the passenger divide the saved money between themselves equally. The conductor's "untaxed income" is sometimes interrupted by inspections that take place as the bus drives on some segment of the route located between two consecutive stops. The inspector fines the conductor by $ c $ rubles for each passenger who doesn't have the ticket for this route's segment.
You know the coordinated of all stops $ x_{i} $ ; the numbers of stops where the $ i $ -th passenger gets on and off, $ a_{i} $ and $ b_{i} $ ( $ a_{i}&lt;b_{i} $ ); the fine $ c $ ; and also $ p_{i} $ — the probability of inspection on segment between the $ i $ -th and the $ i+1 $ -th stop. The conductor asked you to help him make a plan of selling tickets that maximizes the mathematical expectation of his profit.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains three integers $ n $ , $ m $ and $ c $ ( $ 2<=n<=150000 $ , $ 1<=m<=300000 $ , $ 1<=c<=10000 $ ).
The next line contains $ n $ integers $ x_{i} $ ( $ 0<=x_{i}<=10^{9} $ , $ x_{1}=0 $ , $ x_{i}&lt;x_{i+1} $ ) — the coordinates of the stops on the bus's route.
The third line contains $ n-1 $ integer $ p_{i} $ ( $ 0<=p_{i}<=100 $ ) — the probability of inspection in percents on the segment between stop $ i $ and stop $ i+1 $ .
Then follow $ m $ lines that describe the bus's passengers. Each line contains exactly two integers $ a_{i} $ and $ b_{i} $ ( $ 1<=a_{i}&lt;b_{i}<=n $ ) — the numbers of stops where the $ i $ -th passenger gets on and off.</div>
<h3>输出格式</h3>
<br />
<div>Print the single real number — the maximum expectation of the conductor's profit. Your answer will be considered correct if its absolute or relative error does not exceed $ 10^{-6} $ .
Namely: let's assume that your answer is $ a $ , and the answer of the jury is $ b $ . The checker program will consider your answer correct, if ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF150C/259203790d90e969d73ec841bd0673c1e8e7d69a.png).</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>3 3 10
0 10 100
100 0
1 2
2 3
1 3
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>90.000000000
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>10 8 187
0 10 30 70 150 310 630 1270 2550 51100
13 87 65 0 100 44 67 3 4
1 10
2 9
3 8
1 5
6 10
2 7
4 10
4 5
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>76859.990000000
</code></pre>
<h2>说明</h2>
<div>A comment to the first sample:
The first and third passengers get tickets from stop $ 1 $ to stop $ 2 $ . The second passenger doesn't get a ticket. There always is inspection on the segment $ 1 $ - $ 2 $ but both passengers have the ticket for it. There never is an inspection on the segment $ 2 $ - $ 3 $ , that's why the second passenger gets away with the cheating. Our total profit is $ (0+90/2+90/2)=90 $ .</div>
</article>
</div>
</div>
</body>
</html>
