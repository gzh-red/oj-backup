<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Minimum path - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573400680:fxoA2HmaE4GoCy0w6cRhZT35gRjm/wPj+XlyOgjJ9HU=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22You%20are%20given%20a%20matrix%20of%20size%20%24%20n%20%5C%5Ctimes%20n%20%24%20filled%20with%20lowercase%20English%20letters.%20You%20can%20change%20no%20more%20than%20%24%20k%20%24%20letters%20in%20this%20matrix.%5Cn%5CnConsider%20all%20paths%20from%20the%20upper%20left%20corner%20to%20the%20lower%20right%20corner%20that%20move%20from%20a%20cell%20to%20its%20neighboring%20cell%20to%20the%20right%20or%20down.%20Each%20path%20is%20associated%20with%20the%20string%20that%20is%20formed%20by%20all%20the%20letters%20in%20the%20cells%20the%20path%20visits.%20Thus%2C%20the%20length%20of%20each%20string%20is%20%24%202n%20-%201%20%24%20.%5Cn%5CnFind%20the%20lexicographically%20smallest%20string%20that%20can%20be%20associated%20with%20a%20path%20after%20changing%20letters%20in%20at%20most%20%24%20k%20%24%20cells%20of%20the%20matrix.%5Cn%5CnA%20string%20%24%20a%20%24%20is%20lexicographically%20smaller%20than%20a%20string%20%24%20b%20%24%20%2C%20if%20the%20first%20different%20letter%20in%20%24%20a%20%24%20and%20%24%20b%20%24%20is%20smaller%20in%20%24%20a%20%24%20.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20two%20integers%20%24%20n%20%24%20and%20%24%20k%20%24%20%28%20%24%201%20%5C%5Cle%20n%20%5C%5Cle%202000%20%24%20%2C%20%24%200%20%5C%5Cle%20k%20%5C%5Cle%20n%5E2%20%24%20%29%20%5Cu2014%20the%20size%20of%20the%20matrix%20and%20the%20number%20of%20letters%20you%20can%20change.%5Cn%5CnEach%20of%20the%20next%20%24%20n%20%24%20lines%20contains%20a%20string%20of%20%24%20n%20%24%20lowercase%20English%20letters%20denoting%20one%20row%20of%20the%20matrix.%22%2C%22outputFormat%22%3A%22Output%20the%20lexicographically%20smallest%20string%20that%20can%20be%20associated%20with%20some%20valid%20path%20after%20changing%20no%20more%20than%20%24%20k%20%24%20letters%20in%20the%20matrix.%22%2C%22samples%22%3A%5B%5B%224%202%5Cnabcd%5Cnbcde%5Cnbcad%5Cnbcde%5Cn%22%2C%22aaabcde%5Cn%22%5D%2C%5B%225%203%5Cnbwwwz%5Cnhrhdh%5Cnsepsp%5Cnsqfaf%5Cnajbvw%5Cn%22%2C%22aaaepfafw%5Cn%22%5D%2C%5B%227%206%5Cnypnxnnp%5Cnpnxonpm%5Cnnxanpou%5Cnxnnpmud%5Cnnhtdudu%5Cnnpmuduh%5Cnpmutsnz%5Cn%22%2C%22aaaaaaadudsnz%5Cn%22%5D%5D%2C%22hint%22%3A%22In%20the%20first%20sample%20test%20case%20it%20is%20possible%20to%20change%20letters%20%27b%27%20in%20cells%20%24%20%282%2C%201%29%20%24%20and%20%24%20%283%2C%201%29%20%24%20to%20%27a%27%2C%20then%20the%20minimum%20path%20contains%20cells%20%24%20%281%2C%201%29%2C%20%282%2C%201%29%2C%20%283%2C%201%29%2C%20%284%2C%201%29%2C%20%284%2C%202%29%2C%20%284%2C%203%29%2C%20%284%2C%204%29%20%24%20.%20The%20first%20coordinate%20corresponds%20to%20the%20row%20and%20the%20second%20coordinate%20corresponds%20to%20the%20column.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1500%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F1031%5C%2FD%22%2C%22id%22%3A%221031D%22%7D%2C%22translation%22%3A%22%23%23%20%5Cu9898%5Cu76ee%5Cu63cf%5Cu8ff0%5Cr%5Cn%5Cu7ed9%5Cu4f60%5Cu4e00%5Cu4e2an%5Cu00d7n%5Cu7684%5Cu5168%5Cu662f%5Cu5c0f%5Cu5199%5Cu5b57%5Cu6bcd%5Cu7684%5Cu77e9%5Cu9635%2C%5Cu4f60%5Cu80fd%5Cu6539%5Cu53d8k%5Cu4e2a%5Cu5b57%5Cu6bcd%5Cr%5Cn%5Cr%5Cn%5Cu4f60%5Cu8981%5Cu4ece%5Cu5de6%5Cu4e0a%5Cu89d2%5Cu8d70%5Cu5230%5Cu53f3%5Cu4e0b%5Cu89d2%2C%5Cu4e14%5Cu6bcf%5Cu6b65%5Cu53ea%5Cu80fd%5Cu79fb%5Cu52a8%5Cu5230%5Cu53f3%5Cu8fb9%5Cu6216%5Cu4e0b%5Cu8fb9%5Cu7684%5Cu5b57%5Cu6bcd%5Cu4e0a%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu5bf9%5Cu4e8e%5Cu6bcf%5Cu4e00%5Cu6761%5Cu8def%5Cu5f84%5Cu90fd%5Cu4f1a%5Cu5f97%5Cu5230%5Cu4e00%5Cu4e2a%5Cu7531%5Cu4f60%5Cu7ecf%5Cu8fc7%5Cu7684%5Cu6240%5Cu6709%5Cu5b57%5Cu6bcd%5Cu7ec4%5Cu6210%5Cu7684%5Cu5b57%5Cu7b26%5Cu4e32%5Cu3002%5Cu5f53%5Cu7136%2C%5Cu4ed6%5Cu7684%5Cu957f%5Cu5ea6%5Cu662f2%5Cu00d7n-1.%5Cr%5Cn%5Cr%5Cn%5Cu5728%5Cu4f60%5Cu6700%5Cu591a%5Cu6539%5Cu52a8k%5Cu4e2a%5Cu5b57%5Cu6bcd%5Cu7684%5Cu60c5%5Cu51b5%5Cu4e0b%2C%5Cu627e%5Cu5230%5Cu4e00%5Cu4e2a%5Cu5f97%5Cu5230%5Cu5b57%5Cu7b26%5Cu4e32%5Cu5b57%5Cu5178%5Cu5e8f%5Cu6700%5Cu5c0f%5Cu7684%5Cu8def%5Cu5f84.%5Cr%5Cn%5Cr%5Cn%5Cu4e00%5Cu4e2a%5Cu5b57%5Cu7b26%5Cu4e32a%5Cu5982%5Cu679c%5Cu5b57%5Cu5178%5Cu5e8f%5Cu6bd4%5Cu5b57%5Cu7b26%5Cu4e32b%5Cu5c0f%2C%5Cu90a3%5Cu4ed6%5Cu4eec%5Cu7b2c%5Cu4e00%5Cu4e2a%5Cu4e0d%5Cu540c%5Cu7684%5Cu5b57%5Cu7b26%5Cu5728a%5Cu4e2d%5Cu5c0f%5Cu4e8eb.%5Cr%5Cn%23%23%20%5Cu8f93%5Cu5165%5Cu8f93%5Cu51fa%5Cu683c%5Cu5f0f%5Cr%5Cn%23%23%23%23%20%5Cu8f93%5Cu5165%5Cu683c%5Cu5f0f%3A%5Cr%5Cn%5Cu7b2c%5Cu4e00%5Cu884c%5Cu5305%5Cu62ec%5Cu4e24%5Cu4e2a%5Cu6574%5Cu6570n%5Cu548ck%281%5Cu2264n%5Cu22642000%2C0%5Cu2264k%5Cu2264n2%29%2C%5Cu77e9%5Cu9635%5Cu7684%5Cu5927%5Cu5c0f%5Cu548c%5Cu4f60%5Cu6700%5Cu591a%5Cu80fd%5Cu6539%5Cu53d8%5Cu7684%5Cu5b57%5Cu6bcd%5Cu6570.%5Cr%5Cn%5Cr%5Cn%5Cu4e0b%5Cu9762n%5Cu884c%2C%5Cu6bcf%5Cu884cn%5Cu4e2a%5Cu5c0f%5Cu5199%5Cu5b57%5Cu6bcd.%5Cr%5Cn%23%23%23%23%20%5Cu8f93%5Cu51fa%5Cu683c%5Cu5f0f%3A%5Cr%5Cn%5Cu5728%5Cu4f60%5Cu6700%5Cu591a%5Cu6539%5Cu52a8k%5Cu4e2a%5Cu5b57%5Cu6bcd%5Cu7684%5Cu60c5%5Cu51b5%5Cu4e0b%2C%5Cu5f97%5Cu5230%5Cu7684%5Cu4e00%5Cu4e2a%5Cu5b57%5Cu7b26%5Cu4e32%5Cu5b57%5Cu5178%5Cu5e8f%5Cu6700%5Cu5c0f%5Cu7684%5Cu8def%5Cu5f84.%22%2C%22tags%22%3A%5B126%2C127%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A93%2C%22totalAccepted%22%3A46%2C%22pid%22%3A%22CF1031D%22%2C%22title%22%3A%22Minimum%20path%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P2824%22%2C%22title%22%3A%22%5BHEOI2016%5C%2FTJOI2016%5D%5Cu6392%5Cu5e8f%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22CF703D%22%2C%22title%22%3A%22Mishka%20and%20Interesting%20sum%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF983C%22%2C%22title%22%3A%22Elevator%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1031C%22%2C%22title%22%3A%22Cram%20Time%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1031B%22%2C%22title%22%3A%22Curiosity%20Has%20No%20Limits%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22CF%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Minimum%20path%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Minimum path</h1>
<h2>题意翻译</h2>
<div>## 题目描述
给你一个n×n的全是小写字母的矩阵,你能改变k个字母
你要从左上角走到右下角,且每步只能移动到右边或下边的字母上。
对于每一条路径都会得到一个由你经过的所有字母组成的字符串。当然,他的长度是2×n-1.
在你最多改动k个字母的情况下,找到一个得到字符串字典序最小的路径.
一个字符串a如果字典序比字符串b小,那他们第一个不同的字符在a中小于b.
## 输入输出格式
#### 输入格式:
第一行包括两个整数n和k(1≤n≤2000,0≤k≤n2),矩阵的大小和你最多能改变的字母数.
下面n行,每行n个小写字母.
#### 输出格式:
在你最多改动k个字母的情况下,得到的一个字符串字典序最小的路径.</div>
<h2>题目描述</h2>
<div>You are given a matrix of size $ n \times n $ filled with lowercase English letters. You can change no more than $ k $ letters in this matrix.
Consider all paths from the upper left corner to the lower right corner that move from a cell to its neighboring cell to the right or down. Each path is associated with the string that is formed by all the letters in the cells the path visits. Thus, the length of each string is $ 2n - 1 $ .
Find the lexicographically smallest string that can be associated with a path after changing letters in at most $ k $ cells of the matrix.
A string $ a $ is lexicographically smaller than a string $ b $ , if the first different letter in $ a $ and $ b $ is smaller in $ a $ .</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains two integers $ n $ and $ k $ ( $ 1 \le n \le 2000 $ , $ 0 \le k \le n^2 $ ) — the size of the matrix and the number of letters you can change.
Each of the next $ n $ lines contains a string of $ n $ lowercase English letters denoting one row of the matrix.</div>
<h3>输出格式</h3>
<br />
<div>Output the lexicographically smallest string that can be associated with some valid path after changing no more than $ k $ letters in the matrix.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>4 2
abcd
bcde
bcad
bcde
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>aaabcde
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>5 3
bwwwz
hrhdh
sepsp
sqfaf
ajbvw
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>aaaepfafw
</code></pre>
<h3>输入样例 #3</h3>
<pre><code>7 6
ypnxnnp
pnxonpm
nxanpou
xnnpmud
nhtdudu
npmuduh
pmutsnz
</code></pre>
<h3>输出样例 #3</h3>
<pre><code>aaaaaaadudsnz
</code></pre>
<h2>说明</h2>
<div>In the first sample test case it is possible to change letters 'b' in cells $ (2, 1) $ and $ (3, 1) $ to 'a', then the minimum path contains cells $ (1, 1), (2, 1), (3, 1), (4, 1), (4, 2), (4, 3), (4, 4) $ . The first coordinate corresponds to the row and the second coordinate corresponds to the column.</div>
</article>
</div>
</div>
</body>
</html>
