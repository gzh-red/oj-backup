<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Fedor and Essay - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573394405:x2aYpkxsBDSwSYQq2lKhSmAgXKPyQjO4lCSfrrv2eAA=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22After%20you%20had%20helped%20Fedor%20to%20find%20friends%20in%20the%20%5Cu00abCall%20of%20Soldiers%203%5Cu00bb%20game%2C%20he%20stopped%20studying%20completely.%20Today%2C%20the%20English%20teacher%20told%20him%20to%20prepare%20an%20essay.%20Fedor%20didn%27t%20want%20to%20prepare%20the%20essay%2C%20so%20he%20asked%20Alex%20for%20help.%20Alex%20came%20to%20help%20and%20wrote%20the%20essay%20for%20Fedor.%20But%20Fedor%20didn%27t%20like%20the%20essay%20at%20all.%20Now%20Fedor%20is%20going%20to%20change%20the%20essay%20using%20the%20synonym%20dictionary%20of%20the%20English%20language.%5Cn%5CnFedor%20does%20not%20want%20to%20change%20the%20meaning%20of%20the%20essay.%20So%20the%20only%20change%20he%20would%20do%3A%20change%20a%20word%20from%20essay%20to%20one%20of%20its%20synonyms%2C%20basing%20on%20a%20replacement%20rule%20from%20the%20dictionary.%20Fedor%20may%20perform%20this%20operation%20any%20number%20of%20times.%5Cn%5CnAs%20a%20result%2C%20Fedor%20wants%20to%20get%20an%20essay%20which%20contains%20as%20little%20letters%20%5Cu00abR%5Cu00bb%20%28the%20case%20doesn%27t%20matter%29%20as%20possible.%20If%20there%20are%20multiple%20essays%20with%20minimum%20number%20of%20%5Cu00abR%5Cu00bbs%20he%20wants%20to%20get%20the%20one%20with%20minimum%20length%20%28length%20of%20essay%20is%20the%20sum%20of%20the%20lengths%20of%20all%20the%20words%20in%20it%29.%20Help%20Fedor%20get%20the%20required%20essay.%5Cn%5CnPlease%20note%20that%20in%20this%20problem%20the%20case%20of%20letters%20doesn%27t%20matter.%20For%20example%2C%20if%20the%20synonym%20dictionary%20says%20that%20word%20cat%20can%20be%20replaced%20with%20word%20DOG%2C%20then%20it%20is%20allowed%20to%20replace%20the%20word%20Cat%20with%20the%20word%20doG.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20a%20single%20integer%20%24%20m%20%24%20%24%20%281%3C%3Dm%3C%3D10%5E%7B5%7D%29%20%24%20%5Cu2014%20the%20number%20of%20words%20in%20the%20initial%20essay.%20The%20second%20line%20contains%20words%20of%20the%20essay.%20The%20words%20are%20separated%20by%20a%20single%20space.%20It%20is%20guaranteed%20that%20the%20total%20length%20of%20the%20words%20won%27t%20exceed%20%24%2010%5E%7B5%7D%20%24%20characters.%5Cn%5CnThe%20next%20line%20contains%20a%20single%20integer%20%24%20n%20%24%20%24%20%280%3C%3Dn%3C%3D10%5E%7B5%7D%29%20%24%20%5Cu2014%20the%20number%20of%20pairs%20of%20words%20in%20synonym%20dictionary.%20The%20%24%20i%20%24%20-th%20of%20the%20next%20%24%20n%20%24%20lines%20contains%20two%20space-separated%20non-empty%20words%20%24%20x_%7Bi%7D%20%24%20and%20%24%20y_%7Bi%7D%20%24%20.%20They%20mean%20that%20word%20%24%20x_%7Bi%7D%20%24%20can%20be%20replaced%20with%20word%20%24%20y_%7Bi%7D%20%24%20%28but%20not%20vise%20versa%29.%20It%20is%20guaranteed%20that%20the%20total%20length%20of%20all%20pairs%20of%20synonyms%20doesn%27t%20exceed%20%24%205%5Cu00b710%5E%7B5%7D%20%24%20characters.%5Cn%5CnAll%20the%20words%20at%20input%20can%20only%20consist%20of%20uppercase%20and%20lowercase%20letters%20of%20the%20English%20alphabet.%22%2C%22outputFormat%22%3A%22Print%20two%20integers%20%5Cu2014%20the%20minimum%20number%20of%20letters%20%5Cu00abR%5Cu00bb%20in%20an%20optimal%20essay%20and%20the%20minimum%20length%20of%20an%20optimal%20essay.%22%2C%22samples%22%3A%5B%5B%223%5CnAbRb%20r%20Zz%5Cn4%5CnxR%20abRb%5CnaA%20xr%5Cnzz%20Z%5Cnxr%20y%5Cn%22%2C%222%206%5Cn%22%5D%2C%5B%222%5CnRuruRu%20fedya%5Cn1%5CnruruRU%20fedor%5Cn%22%2C%221%2010%5Cn%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F467%5C%2FD%22%2C%22id%22%3A%22467D%22%7D%2C%22translation%22%3A%22%5Cu5728%5Cu4f60%5Cu5e2e%5Cu52a9Fedor%5Cu5728%5Cu00abCall%20of%20Soldiers%203%5Cu00bb%5Cu8fd9%5Cu6b3e%5Cu6e38%5Cu620f%5Cu4e2d%5Cu627e%5Cu5230%5Cu670b%5Cu53cb%5Cu4e4b%5Cu540e%5Cuff0c%5Cu4ed6%5Cu5b8c%5Cu5168%5Cu505c%5Cu6b62%5Cu4e86%5Cu5b66%5Cu4e60%5Cu3002%5Cu4eca%5Cu5929%5Cuff0c%5Cu82f1%5Cu8bed%5Cu8001%5Cu5e08%5Cu8ba9%5Cu4ed6%5Cu51c6%5Cu5907%5Cu4e00%5Cu7bc7%5Cu6587%5Cu7ae0%5Cu3002%20Fedor%5Cu5e76%5Cu4e0d%5Cu60f3%5Cu51c6%5Cu5907%5Cu8fd9%5Cu7bc7%5Cu6587%5Cu7ae0%5Cuff0c%5Cu6240%5Cu4ee5%5Cu4ed6%5Cu5411Alex%5Cu5bfb%5Cu6c42%5Cu5e2e%5Cu52a9%5Cu3002Alex%5Cu6765%5Cu5e2e%5Cu5fd9%5Cu5e76%5Cu4e3aFedor%5Cu5199%5Cu4e86%5Cu4e00%5Cu7bc7%5Cu6587%5Cu7ae0%5Cu3002%5Cu4f46Fedor%5Cu6839%5Cu672c%5Cu4e0d%5Cu559c%5Cu6b22%5Cu8fd9%5Cu7bc7%5Cu6587%5Cu7ae0%5Cu3002%5Cu73b0%5Cu5728Fedor%5Cu5c06%5Cu4f7f%5Cu7528%5Cu82f1%5Cu8bed%5Cu540c%5Cu4e49%5Cu8bcd%5Cu8bcd%5Cu5178%5Cu6765%5Cu91cd%5Cu5199%5Cu6587%5Cu7ae0%5Cu3002%5Cr%5Cn%5Cr%5CnFedor%5Cu4e0d%5Cu60f3%5Cu6539%5Cu53d8%5Cu6587%5Cu7ae0%5Cu7684%5Cu542b%5Cu4e49%5Cu3002%5Cu56e0%5Cu6b64%5Cuff0c%5Cu4ed6%5Cu5c06%5Cu505a%5Cu7684%5Cu552f%5Cu4e00%5Cu6539%5Cu53d8%5Cu662f%5Cuff1a%5Cu6839%5Cu636e%5Cu5b57%5Cu5178%5Cu4e2d%5Cu7684%5Cu66ff%5Cu6362%5Cu89c4%5Cu5219%5Cuff0c%5Cu5c06%5Cu4e00%5Cu4e2a%5Cu8bba%5Cu6587%5Cu4e2d%5Cu7684%5Cu5355%5Cu8bcd%5Cu6539%5Cu4e3a%5Cu5b83%5Cu7684%5Cu4e00%5Cu4e2a%5Cu540c%5Cu4e49%5Cu8bcd%5Cu3002%20Fedor%5Cu53ef%5Cu4ee5%5Cu591a%5Cu6b21%5Cu6267%5Cu884c%5Cu6b64%5Cu64cd%5Cu4f5c%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu56e0%5Cu6b64%5Cuff0cFedor%5Cu5e0c%5Cu671b%5Cu5f97%5Cu5230%5Cu4e00%5Cu7bc7%5Cu6587%5Cu7ae0%5Cuff0c%5Cu5176%5Cu4e2d%5Cu5305%5Cu542b%5Cu5c3d%5Cu53ef%5Cu80fd%5Cu5c11%5Cu7684%5Cu5b57%5Cu6bcd%5Cu201cR%5Cu201d%5Cuff08%5Cu6837%5Cu4f8b%5Cu65e0%5Cu5173%5Cuff09%5Cu3002%5Cu5982%5Cu679c%5Cu6709%5Cu591a%5Cu7bc7%5Cu8bba%5Cu6587%5Cu90fd%5Cu6709%5Cu6700%5Cu5c0f%5Cu6570%5Cu91cf%5Cu7684%5Cu201cR%5Cu201d%5Cuff0c%5Cu90a3%5Cu4e48%5Cu4ed6%5Cu5e0c%5Cu671b%5Cu5f97%5Cu5230%5Cu4e00%5Cu4e2a%5Cu6700%5Cu5c0f%5Cu957f%5Cu5ea6%5Cu7684%5Cu8bba%5Cu6587%5Cuff08%5Cu8bba%5Cu6587%5Cu7684%5Cu957f%5Cu5ea6%5Cu662f%5Cu5176%5Cu4e2d%5Cu6240%5Cu6709%5Cu5355%5Cu8bcd%5Cu957f%5Cu5ea6%5Cu7684%5Cu603b%5Cu548c%5Cuff09%5Cu3002%5Cu5e2e%5Cu52a9Fedor%5Cu83b7%5Cu5f97%5Cu6240%5Cu9700%5Cu7684%5Cu8bba%5Cu6587%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu8bf7%5Cu6ce8%5Cu610f%5Cuff0c%5Cu5728%5Cu8fd9%5Cu4e2a%5Cu95ee%5Cu9898%5Cu4e2d%5Cuff0c%5Cu5b57%5Cu6bcd%5Cu7684%5Cu5927%5Cu5c0f%5Cu5199%5Cu60c5%5Cu51b5%5Cu65e0%5Cu5173%5Cu7d27%5Cu8981%5Cu3002%5Cu4f8b%5Cu5982%5Cuff0c%5Cu5982%5Cu679c%5Cu540c%5Cu4e49%5Cu8bcd%5Cu8bcd%5Cu5178%5Cu8bf4%5Cu5355%5Cu8bcdcat%5Cu53ef%5Cu4ee5%5Cu7528%5Cu5355%5Cu8bcdDOG%5Cu66ff%5Cu6362%5Cuff0c%5Cu5219%5Cu5141%5Cu8bb8%5Cu7528%5Cu5355%5Cu8bcddoG%5Cu66ff%5Cu6362%5Cu5355%5Cu8bcdCat%5Cu3002%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A42%2C%22totalAccepted%22%3A21%2C%22pid%22%3A%22CF467D%22%2C%22title%22%3A%22Fedor%20and%20Essay%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Fedor%20and%20Essay%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Fedor and Essay</h1>
<h2>题意翻译</h2>
<div>在你帮助Fedor在«Call of Soldiers 3»这款游戏中找到朋友之后，他完全停止了学习。今天，英语老师让他准备一篇文章。 Fedor并不想准备这篇文章，所以他向Alex寻求帮助。Alex来帮忙并为Fedor写了一篇文章。但Fedor根本不喜欢这篇文章。现在Fedor将使用英语同义词词典来重写文章。
Fedor不想改变文章的含义。因此，他将做的唯一改变是：根据字典中的替换规则，将一个论文中的单词改为它的一个同义词。 Fedor可以多次执行此操作。
因此，Fedor希望得到一篇文章，其中包含尽可能少的字母“R”（样例无关）。如果有多篇论文都有最小数量的“R”，那么他希望得到一个最小长度的论文（论文的长度是其中所有单词长度的总和）。帮助Fedor获得所需的论文。
请注意，在这个问题中，字母的大小写情况无关紧要。例如，如果同义词词典说单词cat可以用单词DOG替换，则允许用单词doG替换单词Cat。</div>
<h2>题目描述</h2>
<div>After you had helped Fedor to find friends in the «Call of Soldiers 3» game, he stopped studying completely. Today, the English teacher told him to prepare an essay. Fedor didn't want to prepare the essay, so he asked Alex for help. Alex came to help and wrote the essay for Fedor. But Fedor didn't like the essay at all. Now Fedor is going to change the essay using the synonym dictionary of the English language.
Fedor does not want to change the meaning of the essay. So the only change he would do: change a word from essay to one of its synonyms, basing on a replacement rule from the dictionary. Fedor may perform this operation any number of times.
As a result, Fedor wants to get an essay which contains as little letters «R» (the case doesn't matter) as possible. If there are multiple essays with minimum number of «R»s he wants to get the one with minimum length (length of essay is the sum of the lengths of all the words in it). Help Fedor get the required essay.
Please note that in this problem the case of letters doesn't matter. For example, if the synonym dictionary says that word cat can be replaced with word DOG, then it is allowed to replace the word Cat with the word doG.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains a single integer $ m $ $ (1<=m<=10^{5}) $ — the number of words in the initial essay. The second line contains words of the essay. The words are separated by a single space. It is guaranteed that the total length of the words won't exceed $ 10^{5} $ characters.
The next line contains a single integer $ n $ $ (0<=n<=10^{5}) $ — the number of pairs of words in synonym dictionary. The $ i $ -th of the next $ n $ lines contains two space-separated non-empty words $ x_{i} $ and $ y_{i} $ . They mean that word $ x_{i} $ can be replaced with word $ y_{i} $ (but not vise versa). It is guaranteed that the total length of all pairs of synonyms doesn't exceed $ 5·10^{5} $ characters.
All the words at input can only consist of uppercase and lowercase letters of the English alphabet.</div>
<h3>输出格式</h3>
<br />
<div>Print two integers — the minimum number of letters «R» in an optimal essay and the minimum length of an optimal essay.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>3
AbRb r Zz
4
xR abRb
aA xr
zz Z
xr y
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>2 6
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>2
RuruRu fedya
1
ruruRU fedor
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>1 10
</code></pre>
</article>
</div>
</div>
</body>
</html>
