<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Tiling Terrace - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573403837:CpBLcpMFA6V8qzEFUYUyPv1fGE1HtjLzzGDsMZsxp1w=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Talia%20has%20just%20bought%20an%20abandoned%20house%20in%20the%20outskirt%20of%20Jakarta.%20The%20house%20has%20a%20nice%20and%20long%20yard%20which%20can%20be%20represented%20as%20a%20one-dimensional%20grid%20containing%20%24%201%20%5C%5Ctimes%20N%20%24%20cells.%20To%20beautify%20the%20house%2C%20Talia%20is%20going%20to%20build%20a%20terrace%20on%20the%20yard%20by%20tiling%20the%20cells.%20Each%20cell%20on%20the%20yard%20contains%20either%20soil%20%28represented%20by%20the%20character%20%27.%27%29%20or%20rock%20%28represented%20by%20the%20character%20%27%5C%5C%23%27%29%2C%20and%20there%20are%20at%20most%20%24%2050%20%24%20cells%20containing%20rocks.%5Cn%5CnBeing%20a%20superstitious%20person%2C%20Talia%20wants%20to%20tile%20the%20terrace%20with%20mystical%20tiles%20that%20have%20the%20power%20to%20repel%20ghosts.%20There%20are%20three%20types%20of%20mystical%20tiles%3A%5Cn%5Cn-%20Type-1%3A%20Covers%20%24%201%20%5C%5Ctimes%201%20%24%20cell%20and%20can%20only%20be%20placed%20on%20a%20soil%20cell%20%28%5C%22.%5C%22%29.%5Cn-%20Type-2%3A%20Covers%20%24%201%20%5C%5Ctimes%202%20%24%20cells%20and%20can%20only%20be%20placed%20on%20two%20consecutive%20soil%20cells%20%28%5C%22..%5C%22%29.%5Cn-%20Type-3%3A%20Covers%20%24%201%20%5C%5Ctimes%203%20%24%20cells%20and%20can%20only%20be%20placed%20on%20consecutive%20soil-rock-soil%20cells%20%28%5C%22.%23.%5C%22%29.%5Cn%5CnEach%20tile%20of%20Type-1%2C%20Type-2%2C%20and%20Type-3%20has%20the%20power%20to%20repel%20%24%20G_1%20%24%20%2C%20%24%20G_2%20%24%20%2C%20and%20%24%20G_3%20%24%20ghosts%20per%20day%2C%20respectively.%20There%20are%20also%20some%20mystical%20rules%20which%20must%20be%20followed%20for%20the%20power%20to%20be%20effective%3A%5Cn%5Cn-%20There%20should%20be%20no%20overlapping%20tiles%2C%20i.e.%20each%20cell%20is%20covered%20by%20at%20most%20one%20tile.%5Cn-%20There%20should%20be%20at%20most%20%24%20K%20%24%20tiles%20of%20Type-1%2C%20while%20there%20are%20no%20limitations%20for%20tiles%20of%20Type-2%20and%20Type-3.%5Cn%5CnTalia%20is%20scared%20of%20ghosts%2C%20thus%2C%20the%20terrace%20%28which%20is%20tiled%20by%20mystical%20tiles%29%20should%20be%20able%20to%20repel%20as%20many%20ghosts%20as%20possible.%20Help%20Talia%20to%20find%20the%20maximum%20number%20of%20ghosts%20that%20can%20be%20repelled%20per%20day%20by%20the%20terrace.%20Note%20that%20Talia%20does%20not%20need%20to%20tile%20all%20the%20cells%20on%20the%20yard%20as%20long%20as%20the%20number%20of%20ghosts%20that%20can%20be%20repelled%20by%20the%20terrace%20is%20maximum.%22%2C%22inputFormat%22%3A%22Input%20begins%20with%20a%20line%20containing%20five%20integers%3A%20%24%20N%20%24%20%24%20K%20%24%20%24%20G_1%20%24%20%24%20G_2%20%24%20%24%20G_3%20%24%20%28%20%24%201%20%5C%5Cle%20N%20%5C%5Cle%20100%5C%5C%2C000%20%24%20%3B%20%24%200%20%5C%5Cle%20K%20%5C%5Cle%20N%20%24%20%3B%20%24%200%20%5C%5Cle%20G_1%2C%20G_2%2C%20G_3%20%5C%5Cle%201000%20%24%20%29%20representing%20the%20number%20of%20cells%2C%20the%20maximum%20number%20of%20tiles%20of%20Type-1%2C%20the%20number%20of%20ghosts%20repelled%20per%20day%20by%20a%20tile%20of%20Type-1%2C%20the%20number%20of%20ghosts%20repelled%20per%20day%20by%20a%20tile%20of%20Type-2%2C%20and%20the%20number%20of%20ghosts%20repelled%20by%20a%20tile%20of%20Type-3%2C%20respectively.%20The%20next%20line%20contains%20a%20string%20of%20%24%20N%20%24%20characters%20representing%20the%20yard.%20Each%20character%20in%20the%20string%20is%20either%20%27.%27%20which%20represents%20a%20soil%20cell%20or%20%27%23%27%20which%20represents%20a%20rock%20cell.%20There%20are%20at%20most%20%24%2050%20%24%20rock%20cells.%22%2C%22outputFormat%22%3A%22Output%20in%20a%20line%20an%20integer%20representing%20the%20maximum%20number%20of%20ghosts%20that%20can%20be%20repelled%20per%20day.%22%2C%22samples%22%3A%5B%5B%22%5Cn6%204%2010%2025%2040%5Cn..%23...%5Cn%22%2C%22%5Cn75%5Cn%22%5D%2C%5B%22%5Cn6%204%2010%20100%2040%5Cn..%23...%5Cn%22%2C%22%5Cn210%5Cn%22%5D%2C%5B%22%5Cn7%202%2030%2010%20100%5Cn..%23...%23%5Cn%22%2C%22%5Cn160%5Cn%22%5D%5D%2C%22hint%22%3A%22Explanation%20for%20the%20sample%20input%5C%2Foutput%20%231%5Cn%5CnLet%20%5C%22A%5C%22%20be%20a%20tile%20of%20Type-1%2C%20%5C%22BB%5C%22%20be%20a%20tile%20of%20Type-2%2C%20and%20%5C%22CCC%5C%22%20be%20a%20tile%20of%20Type-3.%20The%20tiling%20%5C%22ACCCBB%5C%22%20in%20this%20case%20produces%20the%20maximum%20number%20of%20ghosts%20that%20can%20be%20repelled%2C%20i.e.%20%24%2010%20%2B%2040%20%2B%2025%20%3D%2075%20%24%5Cn%5CnExplanation%20for%20the%20sample%20input%5C%2Foutput%20%232%5Cn%5CnThis%20sample%20input%20has%20the%20same%20yard%20with%20the%20previous%20sample%20input%2C%20but%20each%20tile%20of%20Type-2%20can%20repel%20more%20ghosts%20per%20day.%20The%20tiling%20%5C%22BB%23BBA%5C%22%20or%20%5C%22BB%23ABB%5C%22%20produces%20the%20maximum%20number%20of%20ghosts%20that%20can%20be%20repelled%2C%20i.e.%20%24%20100%20%2B%20100%20%2B%2010%20%3D%20210%20%24%20.%20Observe%20that%20the%20third%20cell%20is%20left%20untiled.%5Cn%5CnExplanation%20for%20the%20sample%20input%5C%2Foutput%20%233%5Cn%5CnThe%20tiling%20%5C%22ACCCA.%23%5C%22%2C%20%5C%22ACCC.A%23%5C%22%2C%20or%20%5C%22.CCCAA%23%5C%22%20produces%20the%20maximum%20number%20of%20ghosts%20that%20can%20be%20repelled%2C%20i.e.%20%24%2030%20%2B%20100%20%2B%2030%20%3D%20160%20%24%20.%20Observe%20that%20there%20is%20no%20way%20to%20tile%20the%20last%20cell.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F1252%5C%2FJ%22%2C%22id%22%3A%221252J%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A13%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22CF1252J%22%2C%22title%22%3A%22Tiling%20Terrace%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Tiling%20Terrace%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Tiling Terrace</h1>
<h2>题目描述</h2>
<div>Talia has just bought an abandoned house in the outskirt of Jakarta. The house has a nice and long yard which can be represented as a one-dimensional grid containing $ 1 \times N $ cells. To beautify the house, Talia is going to build a terrace on the yard by tiling the cells. Each cell on the yard contains either soil (represented by the character '.') or rock (represented by the character '\#'), and there are at most $ 50 $ cells containing rocks.
Being a superstitious person, Talia wants to tile the terrace with mystical tiles that have the power to repel ghosts. There are three types of mystical tiles:
- Type-1: Covers $ 1 \times 1 $ cell and can only be placed on a soil cell (".").
- Type-2: Covers $ 1 \times 2 $ cells and can only be placed on two consecutive soil cells ("..").
- Type-3: Covers $ 1 \times 3 $ cells and can only be placed on consecutive soil-rock-soil cells (".#.").
Each tile of Type-1, Type-2, and Type-3 has the power to repel $ G_1 $ , $ G_2 $ , and $ G_3 $ ghosts per day, respectively. There are also some mystical rules which must be followed for the power to be effective:
- There should be no overlapping tiles, i.e. each cell is covered by at most one tile.
- There should be at most $ K $ tiles of Type-1, while there are no limitations for tiles of Type-2 and Type-3.
Talia is scared of ghosts, thus, the terrace (which is tiled by mystical tiles) should be able to repel as many ghosts as possible. Help Talia to find the maximum number of ghosts that can be repelled per day by the terrace. Note that Talia does not need to tile all the cells on the yard as long as the number of ghosts that can be repelled by the terrace is maximum.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>Input begins with a line containing five integers: $ N $ $ K $ $ G_1 $ $ G_2 $ $ G_3 $ ( $ 1 \le N \le 100\,000 $ ; $ 0 \le K \le N $ ; $ 0 \le G_1, G_2, G_3 \le 1000 $ ) representing the number of cells, the maximum number of tiles of Type-1, the number of ghosts repelled per day by a tile of Type-1, the number of ghosts repelled per day by a tile of Type-2, and the number of ghosts repelled by a tile of Type-3, respectively. The next line contains a string of $ N $ characters representing the yard. Each character in the string is either '.' which represents a soil cell or '#' which represents a rock cell. There are at most $ 50 $ rock cells.</div>
<h3>输出格式</h3>
<br />
<div>Output in a line an integer representing the maximum number of ghosts that can be repelled per day.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>
6 4 10 25 40
..#...
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>
75
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>
6 4 10 100 40
..#...
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>
210
</code></pre>
<h3>输入样例 #3</h3>
<pre><code>
7 2 30 10 100
..#...#
</code></pre>
<h3>输出样例 #3</h3>
<pre><code>
160
</code></pre>
<h2>说明</h2>
<div>Explanation for the sample input/output #1
Let "A" be a tile of Type-1, "BB" be a tile of Type-2, and "CCC" be a tile of Type-3. The tiling "ACCCBB" in this case produces the maximum number of ghosts that can be repelled, i.e. $ 10 + 40 + 25 = 75 $
Explanation for the sample input/output #2
This sample input has the same yard with the previous sample input, but each tile of Type-2 can repel more ghosts per day. The tiling "BB#BBA" or "BB#ABB" produces the maximum number of ghosts that can be repelled, i.e. $ 100 + 100 + 10 = 210 $ . Observe that the third cell is left untiled.
Explanation for the sample input/output #3
The tiling "ACCCA.#", "ACCC.A#", or ".CCCAA#" produces the maximum number of ghosts that can be repelled, i.e. $ 30 + 100 + 30 = 160 $ . Observe that there is no way to tile the last cell.</div>
</article>
</div>
</div>
</body>
</html>
