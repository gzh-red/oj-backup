<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Stock Trading - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573393628:0OjqwQGLEPGkw4E1HDXQMjgB71+bproG3wJFNxdH0Xk=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22This%20problem%20consists%20of%20three%20subproblems%3A%20for%20solving%20subproblem%20F1%20you%20will%20receive%208%20points%2C%20for%20solving%20subproblem%20F2%20you%20will%20receive%2015%20points%2C%20and%20for%20solving%20subproblem%20F3%20you%20will%20receive%2010%20points.%5Cn%5CnManao%20has%20developed%20a%20model%20to%20predict%20the%20stock%20price%20of%20a%20company%20over%20the%20next%20%24%20n%20%24%20days%20and%20wants%20to%20design%20a%20profit-maximizing%20trading%20algorithm%20to%20make%20use%20of%20these%20predictions.%20Unfortunately%2C%20Manao%27s%20trading%20account%20has%20the%20following%20restrictions%3A%5Cn%5Cn-%20It%20only%20allows%20owning%20either%20zero%20or%20one%20shares%20of%20stock%20at%20a%20time%3B%5Cn-%20It%20only%20allows%20buying%20or%20selling%20a%20share%20of%20this%20stock%20once%20per%20day%3B%5Cn-%20It%20allows%20a%20maximum%20of%20%24%20k%20%24%20buy%20orders%20over%20the%20next%20%24%20n%20%24%20days%3B%5Cn%5CnFor%20the%20purposes%20of%20this%20problem%2C%20we%20define%20a%20trade%20to%20a%20be%20the%20act%20of%20buying%20one%20share%20of%20stock%20on%20day%20%24%20i%20%24%20%2C%20then%20holding%20the%20stock%20until%20some%20day%20%24%20j%3Ei%20%24%20at%20which%20point%20the%20share%20is%20sold.%20To%20restate%20the%20above%20constraints%2C%20Manao%20is%20permitted%20to%20make%20at%20most%20%24%20k%20%24%20non-overlapping%20trades%20during%20the%20course%20of%20an%20%24%20n%20%24%20-day%20trading%20period%20for%20which%20Manao%27s%20model%20has%20predictions%20about%20the%20stock%20price.%5Cn%5CnEven%20though%20these%20restrictions%20limit%20the%20amount%20of%20profit%20Manao%20can%20make%20compared%20to%20what%20would%20be%20achievable%20with%20an%20unlimited%20number%20of%20trades%20or%20the%20ability%20to%20hold%20more%20than%20one%20share%20at%20a%20time%2C%20Manao%20still%20has%20the%20potential%20to%20make%20a%20lot%20of%20money%20because%20Manao%27s%20model%20perfectly%20predicts%20the%20daily%20price%20of%20the%20stock.%20For%20example%2C%20using%20this%20model%2C%20Manao%20could%20wait%20until%20the%20price%20is%20low%2C%20then%20buy%20one%20share%20and%20hold%20until%20the%20price%20reaches%20a%20high%20value%2C%20then%20sell%20for%20a%20profit%2C%20and%20repeat%20this%20process%20up%20to%20%24%20k%20%24%20times%20until%20%24%20n%20%24%20days%20have%20passed.%5Cn%5CnNevertheless%2C%20Manao%20is%20not%20satisfied%20by%20having%20a%20merely%20good%20trading%20algorithm%2C%20and%20wants%20to%20develop%20an%20optimal%20strategy%20for%20trading%20subject%20to%20these%20constraints.%20Help%20Manao%20achieve%20this%20goal%20by%20writing%20a%20program%20that%20will%20determine%20when%20to%20buy%20and%20sell%20stock%20to%20achieve%20the%20greatest%20possible%20profit%20during%20the%20%24%20n%20%24%20-day%20trading%20period%20subject%20to%20the%20above%20constraints.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20two%20integers%20%24%20n%20%24%20and%20%24%20k%20%24%20%2C%20separated%20by%20a%20single%20space%2C%20with%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF391F3%5C%2Fa5ab9e286898dbcee31794b278fbbece7e35bdf0.png%29.%20The%20%24%20i%20%24%20-th%20of%20the%20following%20%24%20n%20%24%20lines%20contains%20a%20single%20integer%20%24%20p_%7Bi%7D%20%24%20%28%20%24%200%3C%3Dp_%7Bi%7D%3C%3D10%5E%7B12%7D%20%24%20%29%2C%20where%20%24%20p_%7Bi%7D%20%24%20represents%20the%20price%20at%20which%20someone%20can%20either%20buy%20or%20sell%20one%20share%20of%20stock%20on%20day%20%24%20i%20%24%20.%5Cn%5CnThe%20problem%20consists%20of%20three%20subproblems.%20The%20subproblems%20have%20different%20constraints%20on%20the%20input.%20You%20will%20get%20some%20score%20for%20the%20correct%20submission%20of%20the%20subproblem.%20The%20description%20of%20the%20subproblems%20follows.%5Cn%5Cn-%20In%20subproblem%20F1%20%288%20points%29%2C%20%24%20n%20%24%20will%20be%20between%20%24%201%20%24%20and%20%24%203000%20%24%20%2C%20inclusive.%5Cn-%20In%20subproblem%20F2%20%2815%20points%29%2C%20%24%20n%20%24%20will%20be%20between%20%24%201%20%24%20and%20%24%20100000%20%24%20%2C%20inclusive.%5Cn-%20In%20subproblem%20F3%20%2810%20points%29%2C%20%24%20n%20%24%20will%20be%20between%20%24%201%20%24%20and%20%24%204000000%20%24%20%2C%20inclusive.%22%2C%22outputFormat%22%3A%22For%20this%20problem%2C%20the%20program%20will%20only%20report%20the%20amount%20of%20the%20optimal%20profit%2C%20rather%20than%20a%20list%20of%20trades%20that%20can%20achieve%20this%20profit.%5Cn%5CnTherefore%2C%20the%20program%20should%20print%20one%20line%20containing%20a%20single%20integer%2C%20the%20maximum%20profit%20Manao%20can%20achieve%20over%20the%20next%20%24%20n%20%24%20days%20with%20the%20constraints%20of%20starting%20with%20no%20shares%20on%20the%20first%20day%20of%20trading%2C%20always%20owning%20either%20zero%20or%20one%20shares%20of%20stock%2C%20and%20buying%20at%20most%20%24%20k%20%24%20shares%20over%20the%20course%20of%20the%20%24%20n%20%24%20-day%20trading%20period.%22%2C%22samples%22%3A%5B%5B%2210%202%5Cn2%5Cn7%5Cn3%5Cn9%5Cn8%5Cn7%5Cn9%5Cn7%5Cn1%5Cn9%5Cn%22%2C%2215%5Cn%22%5D%2C%5B%2210%205%5Cn2%5Cn7%5Cn3%5Cn9%5Cn8%5Cn7%5Cn9%5Cn7%5Cn1%5Cn9%5Cn%22%2C%2221%5Cn%22%5D%5D%2C%22hint%22%3A%22In%20the%20first%20example%2C%20the%20best%20trade%20overall%20is%20to%20buy%20at%20a%20price%20of%20%24%201%20%24%20on%20day%209%20and%20sell%20at%20a%20price%20of%20%24%209%20%24%20on%20day%2010%20and%20the%20second%20best%20trade%20overall%20is%20to%20buy%20at%20a%20price%20of%20%24%202%20%24%20on%20day%201%20and%20sell%20at%20a%20price%20of%20%24%209%20%24%20on%20day%204.%20Since%20these%20two%20trades%20do%20not%20overlap%2C%20both%20can%20be%20made%20and%20the%20profit%20is%20the%20sum%20of%20the%20profits%20of%20the%20two%20trades.%20Thus%20the%20trade%20strategy%20looks%20like%20this%3A%5Cn%5Cn%60%60%60%5Cn%3Cpre%20class%3D%5C%22verbatim%5C%22%3E%3Cbr%3E%3C%5C%2Fbr%3E2%20%20%20%20%7C%207%20%20%20%20%7C%203%20%20%20%20%7C%209%20%20%20%20%7C%208%20%20%20%20%7C%207%20%20%20%20%7C%209%20%20%20%20%7C%207%20%20%20%20%7C%201%20%20%20%20%7C%209%3Cbr%3E%3C%5C%2Fbr%3Ebuy%20%20%7C%20%20%20%20%20%20%7C%20%20%20%20%20%20%7C%20sell%20%7C%20%20%20%20%20%20%7C%20%20%20%20%20%20%7C%20%20%20%20%20%20%7C%20%20%20%20%20%20%7C%20buy%20%20%7C%20sell%3Cbr%3E%3C%5C%2Fbr%3E%5Cn%60%60%60%5Cn%5CnThe%20total%20profit%20is%20then%20%24%20%289-2%29%2B%289-1%29%3D15%20%24%20.%5Cn%5CnIn%20the%20second%20example%2C%20even%20though%20Manao%20is%20allowed%20up%20to%205%20trades%20there%20are%20only%204%20profitable%20trades%20available.%20Making%20a%20fifth%20trade%20would%20cost%20Manao%20money%20so%20he%20only%20makes%20the%20following%204%3A%5Cn%5Cn%60%60%60%5Cn%3Cpre%20class%3D%5C%22verbatim%5C%22%3E%3Cbr%3E%3C%5C%2Fbr%3E2%20%20%20%20%7C%207%20%20%20%20%7C%203%20%20%20%20%7C%209%20%20%20%20%7C%208%20%20%20%20%7C%207%20%20%20%20%7C%209%20%20%20%20%7C%207%20%20%20%20%7C%201%20%20%20%20%7C%209%3Cbr%3E%3C%5C%2Fbr%3Ebuy%20%20%7C%20sell%20%7C%20buy%20%20%7C%20sell%20%7C%20%20%20%20%20%20%7C%20buy%20%20%7C%20sell%20%7C%20%20%20%20%20%20%7C%20buy%20%20%7C%20sell%3Cbr%3E%3C%5C%2Fbr%3E%5Cn%60%60%60%5Cn%5CnThe%20total%20profit%20is%20then%20%24%20%287-2%29%2B%289-3%29%2B%289-7%29%2B%289-1%29%3D21%20%24%20.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B3000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F391%5C%2FF3%22%2C%22id%22%3A%22391F3%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22CF391F3%22%2C%22title%22%3A%22Stock%20Trading%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Stock%20Trading%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573306449;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Stock Trading</h1>
<h2>题目描述</h2>
<div>This problem consists of three subproblems: for solving subproblem F1 you will receive 8 points, for solving subproblem F2 you will receive 15 points, and for solving subproblem F3 you will receive 10 points.
Manao has developed a model to predict the stock price of a company over the next $ n $ days and wants to design a profit-maximizing trading algorithm to make use of these predictions. Unfortunately, Manao's trading account has the following restrictions:
- It only allows owning either zero or one shares of stock at a time;
- It only allows buying or selling a share of this stock once per day;
- It allows a maximum of $ k $ buy orders over the next $ n $ days;
For the purposes of this problem, we define a trade to a be the act of buying one share of stock on day $ i $ , then holding the stock until some day $ j>i $ at which point the share is sold. To restate the above constraints, Manao is permitted to make at most $ k $ non-overlapping trades during the course of an $ n $ -day trading period for which Manao's model has predictions about the stock price.
Even though these restrictions limit the amount of profit Manao can make compared to what would be achievable with an unlimited number of trades or the ability to hold more than one share at a time, Manao still has the potential to make a lot of money because Manao's model perfectly predicts the daily price of the stock. For example, using this model, Manao could wait until the price is low, then buy one share and hold until the price reaches a high value, then sell for a profit, and repeat this process up to $ k $ times until $ n $ days have passed.
Nevertheless, Manao is not satisfied by having a merely good trading algorithm, and wants to develop an optimal strategy for trading subject to these constraints. Help Manao achieve this goal by writing a program that will determine when to buy and sell stock to achieve the greatest possible profit during the $ n $ -day trading period subject to the above constraints.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains two integers $ n $ and $ k $ , separated by a single space, with ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF391F3/a5ab9e286898dbcee31794b278fbbece7e35bdf0.png). The $ i $ -th of the following $ n $ lines contains a single integer $ p_{i} $ ( $ 0<=p_{i}<=10^{12} $ ), where $ p_{i} $ represents the price at which someone can either buy or sell one share of stock on day $ i $ .
The problem consists of three subproblems. The subproblems have different constraints on the input. You will get some score for the correct submission of the subproblem. The description of the subproblems follows.
- In subproblem F1 (8 points), $ n $ will be between $ 1 $ and $ 3000 $ , inclusive.
- In subproblem F2 (15 points), $ n $ will be between $ 1 $ and $ 100000 $ , inclusive.
- In subproblem F3 (10 points), $ n $ will be between $ 1 $ and $ 4000000 $ , inclusive.</div>
<h3>输出格式</h3>
<br />
<div>For this problem, the program will only report the amount of the optimal profit, rather than a list of trades that can achieve this profit.
Therefore, the program should print one line containing a single integer, the maximum profit Manao can achieve over the next $ n $ days with the constraints of starting with no shares on the first day of trading, always owning either zero or one shares of stock, and buying at most $ k $ shares over the course of the $ n $ -day trading period.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>10 2
2
7
3
9
8
7
9
7
1
9
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>15
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>10 5
2
7
3
9
8
7
9
7
1
9
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>21
</code></pre>
<h2>说明</h2>
<div>In the first example, the best trade overall is to buy at a price of $ 1 $ on day 9 and sell at a price of $ 9 $ on day 10 and the second best trade overall is to buy at a price of $ 2 $ on day 1 and sell at a price of $ 9 $ on day 4. Since these two trades do not overlap, both can be made and the profit is the sum of the profits of the two trades. Thus the trade strategy looks like this:
```
<pre class="verbatim"><br></br>2    | 7    | 3    | 9    | 8    | 7    | 9    | 7    | 1    | 9<br></br>buy  |      |      | sell |      |      |      |      | buy  | sell<br></br>
```

The total profit is then $ (9-2)+(9-1)=15 $ .

In the second example, even though Manao is allowed up to 5 trades there are only 4 profitable trades available. Making a fifth trade would cost Manao money so he only makes the following 4:

```
<pre class="verbatim"><br></br>2    | 7    | 3    | 9    | 8    | 7    | 9    | 7    | 1    | 9<br></br>buy  | sell | buy  | sell |      | buy  | sell |      | buy  | sell<br></br>
```

The total profit is then $ (7-2)+(9-3)+(9-7)+(9-1)=21 $ .</div>
    </article>
    </div>
</div>
<!-- <script src="//www.recaptcha.net/recaptcha/api.js?hl=zh-CN&render=explicit&onload=renderCaptcha" async defer></script> -->
</body>
</html>
