<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>An unavoidable detour for home - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573398214:qucfJUKjMgelpQxlH9YFZAYZ00R/NuwCzn1o7LknsRs=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Those%20unwilling%20to%20return%20home%20from%20a%20long%20journey%2C%20will%20be%20affected%20by%20the%20oddity%20of%20the%20snail%20and%20lose%20their%20way.%20Mayoi%2C%20the%20oddity%27s%20carrier%2C%20wouldn%27t%20like%20this%20to%20happen%2C%20but%20there%27s%20nothing%20to%20do%20with%20this%20before%20a%20cure%20is%20figured%20out.%20For%20now%2C%20she%20would%20only%20like%20to%20know%20the%20enormous%20number%20of%20possibilities%20to%20be%20faced%20with%20if%20someone%20gets%20lost.%5Cn%5CnThere%20are%20%24%20n%20%24%20towns%20in%20the%20region%2C%20numbered%20from%20%24%201%20%24%20to%20%24%20n%20%24%20.%20The%20town%20numbered%20%24%201%20%24%20is%20called%20the%20capital.%20The%20traffic%20network%20is%20formed%20by%20bidirectional%20roads%20connecting%20pairs%20of%20towns.%20No%20two%20roads%20connect%20the%20same%20pair%20of%20towns%2C%20and%20no%20road%20connects%20a%20town%20with%20itself.%20The%20time%20needed%20to%20travel%20through%20each%20of%20the%20roads%20is%20the%20same.%20Lost%20travelers%20will%20not%20be%20able%20to%20find%20out%20how%20the%20towns%20are%20connected%2C%20but%20the%20residents%20can%20help%20them%20by%20providing%20the%20following%20facts%3A%5Cn%5Cn-%20Starting%20from%20each%20town%20other%20than%20the%20capital%2C%20the%20shortest%20path%20%28i.e.%20the%20path%20passing%20through%20the%20minimum%20number%20of%20roads%29%20to%20the%20capital%20exists%2C%20and%20is%20unique%3B%5Cn-%20Let%20%24%20l_%7Bi%7D%20%24%20be%20the%20number%20of%20roads%20on%20the%20shortest%20path%20from%20town%20%24%20i%20%24%20to%20the%20capital%2C%20then%20%24%20l_%7Bi%7D%3E%3Dl_%7Bi-1%7D%20%24%20holds%20for%20all%20%24%202%3C%3Di%3C%3Dn%20%24%20%3B%5Cn-%20For%20town%20%24%20i%20%24%20%2C%20the%20number%20of%20roads%20connected%20to%20it%20is%20denoted%20by%20%24%20d_%7Bi%7D%20%24%20%2C%20which%20equals%20either%20%24%202%20%24%20or%20%24%203%20%24%20.%5Cn%5CnYou%20are%20to%20count%20the%20number%20of%20different%20ways%20in%20which%20the%20towns%20are%20connected%2C%20and%20give%20the%20answer%20modulo%20%24%2010%5E%7B9%7D%2B7%20%24%20.%20Two%20ways%20of%20connecting%20towns%20are%20considered%20different%20if%20a%20pair%20%24%20%28u%2Cv%29%20%24%20%28%20%24%201%3C%3Du%2Cv%3C%3Dn%20%24%20%29%20exists%20such%20there%20is%20a%20road%20between%20towns%20%24%20u%20%24%20and%20%24%20v%20%24%20in%20one%20of%20them%20but%20not%20in%20the%20other.%22%2C%22inputFormat%22%3A%22The%20first%20line%20of%20input%20contains%20a%20positive%20integer%20%24%20n%20%24%20%28%20%24%203%3C%3Dn%3C%3D50%20%24%20%29%20%5Cu2014%20the%20number%20of%20towns.%5Cn%5CnThe%20second%20line%20contains%20%24%20n%20%24%20space-separated%20integers%20%24%20d_%7B1%7D%2Cd_%7B2%7D%2C...%2Cd_%7Bn%7D%20%24%20%28%20%24%202%3C%3Dd_%7Bi%7D%3C%3D3%20%24%20%29%20%5Cu2014%20the%20number%20of%20roads%20connected%20to%20towns%20%24%201%2C2%2C...%2Cn%20%24%20%2C%20respectively.%20It%20is%20guaranteed%20that%20the%20sum%20of%20%24%20d_%7Bi%7D%20%24%20over%20all%20%24%20i%20%24%20is%20even.%22%2C%22outputFormat%22%3A%22Output%20one%20integer%20%5Cu2014%20the%20total%20number%20of%20different%20possible%20ways%20in%20which%20the%20towns%20are%20connected%2C%20modulo%20%24%2010%5E%7B9%7D%2B7%20%24%20.%22%2C%22samples%22%3A%5B%5B%224%5Cn3%202%203%202%5Cn%22%2C%221%5Cn%22%5D%2C%5B%225%5Cn2%203%203%202%202%5Cn%22%2C%222%5Cn%22%5D%2C%5B%225%5Cn2%202%202%202%202%5Cn%22%2C%222%5Cn%22%5D%2C%5B%2220%5Cn2%202%202%202%203%202%203%202%202%202%202%202%202%202%202%202%202%203%203%202%5Cn%22%2C%2282944%5Cn%22%5D%5D%2C%22hint%22%3A%22In%20the%20first%20example%2C%20the%20following%20structure%20is%20the%20only%20one%20to%20satisfy%20the%20constraints%2C%20the%20distances%20from%20towns%20%24%202%2C3%2C4%20%24%20to%20the%20capital%20are%20all%20%24%201%20%24%20.%5Cn%5Cn%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF814E%5C%2F41aec6960c240a1fb09480a0a613ecf71bad9b6b.png%29In%20the%20second%20example%2C%20the%20following%20two%20structures%20satisfy%20the%20constraints.%5Cn%5Cn%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF814E%5C%2F5dfe5b5d19d9938739604a89ad14ef6620891ff1.png%29%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B3000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F814%5C%2FE%22%2C%22id%22%3A%22814E%22%7D%2C%22translation%22%3A%22%5Cu7ed9%5Cu51fa%24n%24%5Cu4e2a%5Cu70b9%5Cuff0c%5Cu548c%5Cu6bcf%5Cu4e2a%5Cu70b9%5Cu7684%5Cu5ea6%5Cu8ba9%5Cu4f60%5Cu6784%5Cu9020%5Cu51fa%5Cu4e00%5Cu5f20%5Cu65e0%5Cu5411%5Cu56fe%5Cu6ee1%5Cu8db3%5Cu4ee5%5Cu4e0b%5Cu4e24%5Cu6761%5Cu6027%5Cu8d28%5Cuff1a%5Cr%5Cn%5Cr%5Cn%3E%201.%5Cu70b9%241%24%5Cu5230%5Cu70b9%24i%24%5Cu4ec5%5Cu6709%2A%2A%5Cu552f%5Cu4e00%2A%2A%5Cu4e00%5Cu6761%5Cu6700%5Cu77ed%5Cu8def%20%20%5Cr%5Cn%5Cr%5Cn%3E%202.%5Cu70b9%241%24%5Cu5230%5Cu70b9%24i%24%5Cu7684%5Cu6700%5Cu77ed%5Cu8def%5Cu957f%5Cu5ea6%5Cu5927%5Cu4e8e%5Cu7b49%5Cu4e8e%5Cu70b9%241%24%5Cu5230%5Cu70b9%24i-1%24%5Cu7684%5Cu6700%5Cu77ed%5Cu8def%5Cu957f%5Cu5ea6%5Cr%5Cn%5Cr%5Cn%5Cu6c42%5Cu80fd%5Cu6784%5Cu6210%5Cu6ee1%5Cu8db3%5Cu6761%5Cu4ef6%5Cu7684%5Cu65e0%5Cu5411%5Cu56fe%5Cu7684%5Cu4e2a%5Cu6570%5Cuff1f%22%2C%22tags%22%3A%5B160%2C318%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A74%2C%22totalAccepted%22%3A40%2C%22pid%22%3A%22CF814E%22%2C%22title%22%3A%22An%20unavoidable%20detour%20for%20home%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P2331%22%2C%22title%22%3A%22%5BSCOI2005%5D%5Cu6700%5Cu5927%5Cu5b50%5Cu77e9%5Cu9635%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22CF522D%22%2C%22title%22%3A%22Closest%20Equals%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF392B%22%2C%22title%22%3A%22Tower%20of%20Hanoi%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1205B%22%2C%22title%22%3A%22Shortest%20Cycle%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1205A%22%2C%22title%22%3A%22Almost%20Equal%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22An%20unavoidable%20detour%20for%20home%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>An unavoidable detour for home</h1>
<h2>题意翻译</h2>
<div>给出$n$个点，和每个点的度让你构造出一张无向图满足以下两条性质：
> 1.点$1$到点$i$仅有**唯一**一条最短路
> 2.点$1$到点$i$的最短路长度大于等于点$1$到点$i-1$的最短路长度
求能构成满足条件的无向图的个数？</div>
<h2>题目描述</h2>
<div>Those unwilling to return home from a long journey, will be affected by the oddity of the snail and lose their way. Mayoi, the oddity's carrier, wouldn't like this to happen, but there's nothing to do with this before a cure is figured out. For now, she would only like to know the enormous number of possibilities to be faced with if someone gets lost.
There are $ n $ towns in the region, numbered from $ 1 $ to $ n $ . The town numbered $ 1 $ is called the capital. The traffic network is formed by bidirectional roads connecting pairs of towns. No two roads connect the same pair of towns, and no road connects a town with itself. The time needed to travel through each of the roads is the same. Lost travelers will not be able to find out how the towns are connected, but the residents can help them by providing the following facts:
- Starting from each town other than the capital, the shortest path (i.e. the path passing through the minimum number of roads) to the capital exists, and is unique;
- Let $ l_{i} $ be the number of roads on the shortest path from town $ i $ to the capital, then $ l_{i}>=l_{i-1} $ holds for all $ 2<=i<=n $ ;
- For town $ i $ , the number of roads connected to it is denoted by $ d_{i} $ , which equals either $ 2 $ or $ 3 $ .
You are to count the number of different ways in which the towns are connected, and give the answer modulo $ 10^{9}+7 $ . Two ways of connecting towns are considered different if a pair $ (u,v) $ ( $ 1<=u,v<=n $ ) exists such there is a road between towns $ u $ and $ v $ in one of them but not in the other.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line of input contains a positive integer $ n $ ( $ 3<=n<=50 $ ) — the number of towns.
The second line contains $ n $ space-separated integers $ d_{1},d_{2},...,d_{n} $ ( $ 2<=d_{i}<=3 $ ) — the number of roads connected to towns $ 1,2,...,n $ , respectively. It is guaranteed that the sum of $ d_{i} $ over all $ i $ is even.</div>
<h3>输出格式</h3>
<br />
<div>Output one integer — the total number of different possible ways in which the towns are connected, modulo $ 10^{9}+7 $ .</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>4
3 2 3 2
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>1
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>5
2 3 3 2 2
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>2
</code></pre>
<h3>输入样例 #3</h3>
<pre><code>5
2 2 2 2 2
</code></pre>
<h3>输出样例 #3</h3>
<pre><code>2
</code></pre>
<h3>输入样例 #4</h3>
<pre><code>20
2 2 2 2 3 2 3 2 2 2 2 2 2 2 2 2 2 3 3 2
</code></pre>
<h3>输出样例 #4</h3>
<pre><code>82944
</code></pre>
<h2>说明</h2>
<div>In the first example, the following structure is the only one to satisfy the constraints, the distances from towns $ 2,3,4 $ to the capital are all $ 1 $ .
![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF814E/41aec6960c240a1fb09480a0a613ecf71bad9b6b.png)In the second example, the following two structures satisfy the constraints.
![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF814E/5dfe5b5d19d9938739604a89ad14ef6620891ff1.png)</div>
</article>
</div>
</div>
</body>
</html>
