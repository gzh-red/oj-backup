<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Parquet Re-laying - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573397789:vY9lykWn9XRzjkUxgq2RxUCqLvs+KVFSOSvX7gU9TdQ=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Peter%20decided%20to%20lay%20a%20parquet%20in%20the%20room%20of%20size%20%24%20n%5Cu00d7m%20%24%20%2C%20the%20parquet%20consists%20of%20tiles%20of%20size%20%24%201%5Cu00d72%20%24%20.%20When%20the%20workers%20laid%20the%20parquet%2C%20it%20became%20clear%20that%20the%20tiles%20pattern%20looks%20not%20like%20Peter%20likes%2C%20and%20workers%20will%20have%20to%20re-lay%20it.%5Cn%5CnThe%20workers%20decided%20that%20removing%20entire%20parquet%20and%20then%20laying%20it%20again%20is%20very%20difficult%20task%2C%20so%20they%20decided%20to%20make%20such%20an%20operation%20every%20hour%3A%20remove%20two%20tiles%2C%20which%20form%20a%20%24%202%5Cu00d72%20%24%20square%2C%20rotate%20them%2090%20degrees%20and%20put%20them%20back%20on%20the%20same%20place.%5Cn%5Cn%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF778D%5C%2F1811845168cb252f82588f73f367e9ae9a88d437.png%29They%20have%20no%20idea%20how%20to%20obtain%20the%20desired%20configuration%20using%20these%20operations%2C%20and%20whether%20it%20is%20possible%20at%20all.%5Cn%5CnHelp%20Peter%20to%20make%20a%20plan%20for%20the%20workers%20or%20tell%20that%20it%20is%20impossible.%20The%20plan%20should%20contain%20at%20most%20%24%20100000%20%24%20commands.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20integer%20%24%20n%20%24%20and%20%24%20m%20%24%20%2C%20size%20of%20the%20room%20%28%20%24%201%3C%3Dn%2Cm%3C%3D50%20%24%20%29.%20At%20least%20one%20of%20them%20is%20even%20number.%5Cn%5CnThe%20following%20%24%20n%20%24%20lines%20contain%20%24%20m%20%24%20characters%20each%2C%20the%20description%20of%20the%20current%20configuration%20of%20the%20parquet%20tiles.%20Each%20character%20represents%20the%20position%20of%20the%20half-tile.%20Characters%20%27L%27%2C%20%27R%27%2C%20%27U%27%20and%20%27D%27%20correspond%20to%20the%20left%2C%20right%2C%20upper%20and%20lower%20halves%2C%20respectively.%5Cn%5CnThe%20following%20%24%20n%20%24%20lines%20contain%20%24%20m%20%24%20characters%20each%2C%20describing%20the%20desired%20configuration%20in%20the%20same%20format.%22%2C%22outputFormat%22%3A%22In%20the%20first%20line%20output%20integer%20%24%20k%20%24%20%2C%20the%20number%20of%20operations.%20In%20the%20next%20%24%20k%20%24%20lines%20output%20description%20of%20operations.%20The%20operation%20is%20specified%20by%20coordinates%20%28row%20and%20column%29%20of%20the%20left%20upper%20half-tile%20on%20which%20the%20operation%20is%20performed.%5Cn%5CnIf%20there%20is%20no%20solution%2C%20output%20-1%20in%20the%20first%20line.%22%2C%22samples%22%3A%5B%5B%222%203%5CnULR%5CnDLR%5CnLRU%5CnLRD%5Cn%22%2C%222%5Cn1%202%5Cn1%201%5Cn%22%5D%2C%5B%224%203%5CnULR%5CnDLR%5CnLRU%5CnLRD%5CnULR%5CnDUU%5CnUDD%5CnDLR%22%2C%223%5Cn3%201%5Cn3%202%5Cn2%202%22%5D%5D%2C%22hint%22%3A%22In%20the%20first%20sample%20test%20first%20operation%20is%20to%20rotate%20two%20rightmost%20tiles%2C%20after%20this%20all%20tiles%20lie%20vertically.%20Second%20operation%20is%20to%20rotate%20two%20leftmost%20tiles%2C%20after%20this%20we%20will%20get%20desired%20configuration.%5Cn%5Cn%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF778D%5C%2F9d6d260b417cb92811d958e022c530df79588168.png%29%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B512000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F778%5C%2FD%22%2C%22id%22%3A%22778D%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A6%2C%22totalAccepted%22%3A4%2C%22pid%22%3A%22CF778D%22%2C%22title%22%3A%22Parquet%20Re-laying%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Parquet%20Re-laying%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Parquet Re-laying</h1>
<h2>题目描述</h2>
<div>Peter decided to lay a parquet in the room of size $ n×m $ , the parquet consists of tiles of size $ 1×2 $ . When the workers laid the parquet, it became clear that the tiles pattern looks not like Peter likes, and workers will have to re-lay it.
The workers decided that removing entire parquet and then laying it again is very difficult task, so they decided to make such an operation every hour: remove two tiles, which form a $ 2×2 $ square, rotate them 90 degrees and put them back on the same place.
![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF778D/1811845168cb252f82588f73f367e9ae9a88d437.png)They have no idea how to obtain the desired configuration using these operations, and whether it is possible at all.
Help Peter to make a plan for the workers or tell that it is impossible. The plan should contain at most $ 100000 $ commands.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains integer $ n $ and $ m $ , size of the room ( $ 1<=n,m<=50 $ ). At least one of them is even number.
The following $ n $ lines contain $ m $ characters each, the description of the current configuration of the parquet tiles. Each character represents the position of the half-tile. Characters 'L', 'R', 'U' and 'D' correspond to the left, right, upper and lower halves, respectively.
The following $ n $ lines contain $ m $ characters each, describing the desired configuration in the same format.</div>
<h3>输出格式</h3>
<br />
<div>In the first line output integer $ k $ , the number of operations. In the next $ k $ lines output description of operations. The operation is specified by coordinates (row and column) of the left upper half-tile on which the operation is performed.
If there is no solution, output -1 in the first line.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>2 3
ULR
DLR
LRU
LRD
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>2
1 2
1 1
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>4 3
ULR
DLR
LRU
LRD
ULR
DUU
UDD
DLR</code></pre>
<h3>输出样例 #2</h3>
<pre><code>3
3 1
3 2
2 2</code></pre>
<h2>说明</h2>
<div>In the first sample test first operation is to rotate two rightmost tiles, after this all tiles lie vertically. Second operation is to rotate two leftmost tiles, after this we will get desired configuration.
![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF778D/9d6d260b417cb92811d958e022c530df79588168.png)</div>
</article>
</div>
</div>
</body>
</html>
