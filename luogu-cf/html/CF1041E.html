<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Tree Reconstruction - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573400878:s2KvwLWGX5nHTdQxnvI+IOFnY1onw9U9kDrXpXx9H0E=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%22%2C%22description%22%3A%22Monocarp%20has%20drawn%20a%20tree%20%28an%20undirected%20connected%20acyclic%20graph%29%20and%20then%20has%20given%20each%20vertex%20an%20index.%20All%20indices%20are%20distinct%20numbers%20from%20%24%201%20%24%20to%20%24%20n%20%24%20.%20For%20every%20edge%20%24%20e%20%24%20of%20this%20tree%2C%20Monocarp%20has%20written%20two%20numbers%3A%20the%20maximum%20indices%20of%20the%20vertices%20of%20the%20two%20components%20formed%20if%20the%20edge%20%24%20e%20%24%20%28and%20only%20this%20edge%29%20is%20erased%20from%20the%20tree.%5Cn%5CnMonocarp%20has%20given%20you%20a%20list%20of%20%24%20n%20-%201%20%24%20pairs%20of%20numbers.%20He%20wants%20you%20to%20provide%20an%20example%20of%20a%20tree%20that%20will%20produce%20the%20said%20list%20if%20this%20tree%20exists.%20If%20such%20tree%20does%20not%20exist%2C%20say%20so.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20one%20integer%20%24%20n%20%24%20%28%20%24%202%20%5C%5Cle%20n%20%5C%5Cle%201%5C%5C%2C000%20%24%20%29%20%5Cu2014%20the%20number%20of%20vertices%20in%20the%20tree.%5Cn%5CnEach%20of%20the%20next%20%24%20n-1%20%24%20lines%20contains%20two%20integers%20%24%20a_i%20%24%20and%20%24%20b_i%20%24%20each%20%28%20%24%201%20%5C%5Cle%20a_i%20%3C%20b_i%20%5C%5Cle%20n%20%24%20%29%20%5Cu2014%20the%20maximal%20indices%20of%20vertices%20in%20the%20components%20formed%20if%20the%20%24%20i%20%24%20-th%20edge%20is%20removed.%22%2C%22outputFormat%22%3A%22If%20there%20is%20no%20such%20tree%20that%20can%20produce%20the%20given%20list%20of%20pairs%2C%20print%20%5C%22NO%5C%22%20%28without%20quotes%29.%5Cn%5CnOtherwise%20print%20%5C%22YES%5C%22%20%28without%20quotes%29%20in%20the%20first%20line%20and%20the%20edges%20of%20the%20tree%20in%20the%20next%20%24%20n%20-%201%20%24%20lines.%20Each%20of%20the%20last%20%24%20n%20-%201%20%24%20lines%20should%20contain%20two%20integers%20%24%20x_i%20%24%20and%20%24%20y_i%20%24%20%28%20%24%201%20%5C%5Cle%20x_i%2C%20y_i%20%5C%5Cle%20n%20%24%20%29%20%5Cu2014%20vertices%20connected%20by%20an%20edge.%5Cn%5CnNote%3A%20The%20numeration%20of%20edges%20doesn%27t%20matter%20for%20this%20task.%20Your%20solution%20will%20be%20considered%20correct%20if%20your%20tree%20produces%20the%20same%20pairs%20as%20given%20in%20the%20input%20file%20%28possibly%20reordered%29.%20That%20means%20that%20you%20can%20print%20the%20edges%20of%20the%20tree%20you%20reconstructed%20in%20any%20order.%22%2C%22samples%22%3A%5B%5B%224%5Cn3%204%5Cn1%204%5Cn3%204%5Cn%22%2C%22YES%5Cn1%203%5Cn3%202%5Cn2%204%5Cn%22%5D%2C%5B%223%5Cn1%203%5Cn1%203%5Cn%22%2C%22NO%5Cn%22%5D%2C%5B%223%5Cn1%202%5Cn2%203%5Cn%22%2C%22NO%5Cn%22%5D%5D%2C%22hint%22%3A%22Possible%20tree%20from%20the%20first%20example.%20Dotted%20lines%20show%20edges%20you%20need%20to%20remove%20to%20get%20appropriate%20pairs.%5Cn%5Cn%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF1041E%5C%2Fe43409cf3b42ae3836668f440853ef93e1fdf9b6.png%29%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F1041%5C%2FE%22%2C%22id%22%3A%221041E%22%7D%2C%22translation%22%3A%22%23%23%23%20%5Cu9898%5Cu76ee%5Cu5927%5Cu610f%5Cuff1a%5Cn%5Cu6709%5Cu4e00%5Cu68f5%5Cu6811%5Cuff0c%5Cu73b0%5Cu5728%5Cu7ed9%5Cu4f60%5Cu6bcf%5Cu6761%5Cu6811%5Cu8fb9%5Cu88ab%5Cu53bb%5Cu6389%5Cu65f6%5Cuff0c%5Cu5f62%5Cu6210%5Cu7684%5Cu4e24%5Cu4e2a%5Cu8054%5Cu901a%5Cu5757%5Cu4e2d%5Cu70b9%5Cu7684%5Cu6700%5Cu5927%5Cu7684%5Cu7f16%5Cu53f7%5Cu5206%5Cu522b%5Cu662f%5Cu591a%5Cu5c11%5Cuff0c%5Cu95ee%5Cu6ee1%5Cu8db3%5Cu6761%5Cu4ef6%5Cu7684%5Cu6811%5Cu5b58%5Cu4e0d%5Cu5b58%5Cu5728%5Cn%5Cn%23%23%23%20%5Cu8f93%5Cu5165%5Cu683c%5Cu5f0f%5Cuff1a%5Cn%5Cu7b2c%5Cu4e00%5Cu884c%5Cu4e00%5Cu4e2a%5Cu6574%5Cu6570%24n%24%5Cn%5Cn%5Cu5f80%5Cu4e0b%24n-1%24%5Cu884c%5Cuff0c%5Cu6bcf%5Cu884c%5Cu4e24%5Cu4e2a%5Cu6574%5Cu6570%5Cuff0c%5Cu8868%5Cu793a%5Cu53bb%5Cu6389%5Cu8fd9%5Cu6761%5Cu8fb9%5Cu540e%5Cu4e24%5Cu4e2a%5Cu8054%5Cu901a%5Cu5757%5Cu4e2d%5Cu70b9%5Cu7684%5Cu6700%5Cu5927%5Cu7684%5Cu7f16%5Cu53f7%5Cu662f%5Cu591a%5Cu5c11%5Cn%5Cn%23%23%23%20%5Cu8f93%5Cu51fa%5Cu683c%5Cu5f0f%5Cuff1a%5Cn%5Cu5982%5Cu679c%5Cu4e0d%5Cu5b58%5Cu5728%5Cu6ee1%5Cu8db3%5Cu6761%5Cu4ef6%5Cu7684%5Cu6811%5Cuff0c%5Cu8f93%5Cu51fa%5C%22NO%5C%22%5Cn%5Cn%5Cu5426%5Cu5219%5Cu8f93%5Cu51fa%5C%22YES%5C%22%5Cuff0c%5Cu4e0b%5Cu9762%24n-1%24%5Cu884c%5Cu6bcf%5Cu884c%5Cu63cf%5Cu8ff0%5Cu4e00%5Cu6761%5Cu6811%5Cu8fb9%5Cuff08%5Cu4e24%5Cu7aef%5Cu70b9%5Cu7684%5Cu7f16%5Cu53f7%5Cuff09%22%2C%22tags%22%3A%5B318%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A147%2C%22totalAccepted%22%3A95%2C%22pid%22%3A%22CF1041E%22%2C%22title%22%3A%22Tree%20Reconstruction%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A65279%2C%22title%22%3A%22%5Cu7ffb%5Cu8bd1%22%2C%22forum%22%3A%7B%22id%22%3A29611%2C%22name%22%3A%22CF1041E%20Tree%20Reconstruction%22%2C%22slug%22%3A%22CF1041E%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P2150%22%2C%22title%22%3A%22%5BNOI2015%5D%5Cu5bff%5Cu53f8%5Cu665a%5Cu5bb4%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22CF813E%22%2C%22title%22%3A%22Army%20Creation%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF293E%22%2C%22title%22%3A%22Close%20Vertices%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1041F%22%2C%22title%22%3A%22Ray%20in%20the%20tube%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1041D%22%2C%22title%22%3A%22Glider%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22CF%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Tree%20Reconstruction%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Tree Reconstruction</h1>
<h2>题意翻译</h2>
<div>### 题目大意：
有一棵树，现在给你每条树边被去掉时，形成的两个联通块中点的最大的编号分别是多少，问满足条件的树存不存在
### 输入格式：
第一行一个整数$n$
往下$n-1$行，每行两个整数，表示去掉这条边后两个联通块中点的最大的编号是多少
### 输出格式：
如果不存在满足条件的树，输出"NO"
否则输出"YES"，下面$n-1$行每行描述一条树边（两端点的编号）</div>
<h2>题目描述</h2>
<div>Monocarp has drawn a tree (an undirected connected acyclic graph) and then has given each vertex an index. All indices are distinct numbers from $ 1 $ to $ n $ . For every edge $ e $ of this tree, Monocarp has written two numbers: the maximum indices of the vertices of the two components formed if the edge $ e $ (and only this edge) is erased from the tree.
Monocarp has given you a list of $ n - 1 $ pairs of numbers. He wants you to provide an example of a tree that will produce the said list if this tree exists. If such tree does not exist, say so.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains one integer $ n $ ( $ 2 \le n \le 1\,000 $ ) — the number of vertices in the tree.
Each of the next $ n-1 $ lines contains two integers $ a_i $ and $ b_i $ each ( $ 1 \le a_i < b_i \le n $ ) — the maximal indices of vertices in the components formed if the $ i $ -th edge is removed.</div>
<h3>输出格式</h3>
<br />
<div>If there is no such tree that can produce the given list of pairs, print "NO" (without quotes).
Otherwise print "YES" (without quotes) in the first line and the edges of the tree in the next $ n - 1 $ lines. Each of the last $ n - 1 $ lines should contain two integers $ x_i $ and $ y_i $ ( $ 1 \le x_i, y_i \le n $ ) — vertices connected by an edge.
Note: The numeration of edges doesn't matter for this task. Your solution will be considered correct if your tree produces the same pairs as given in the input file (possibly reordered). That means that you can print the edges of the tree you reconstructed in any order.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>4
3 4
1 4
3 4
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>YES
1 3
3 2
2 4
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>3
1 3
1 3
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>NO
</code></pre>
<h3>输入样例 #3</h3>
<pre><code>3
1 2
2 3
</code></pre>
<h3>输出样例 #3</h3>
<pre><code>NO
</code></pre>
<h2>说明</h2>
<div>Possible tree from the first example. Dotted lines show edges you need to remove to get appropriate pairs.
![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1041E/e43409cf3b42ae3836668f440853ef93e1fdf9b6.png)</div>
</article>
</div>
</div>
</body>
</html>
