<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Martian Strings - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573391195:S6JokU2XxgJoeQkwv1TCeBZwT6Fe7xvoBA3CyllGtps=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22During%20the%20study%20of%20the%20Martians%20Petya%20clearly%20understood%20that%20the%20Martians%20are%20absolutely%20lazy.%20They%20like%20to%20sleep%20and%20don%27t%20like%20to%20wake%20up.%5Cn%5CnImagine%20a%20Martian%20who%20has%20exactly%20%24%20n%20%24%20eyes%20located%20in%20a%20row%20and%20numbered%20from%20the%20left%20to%20the%20right%20from%20%24%201%20%24%20to%20%24%20n%20%24%20.%20When%20a%20Martian%20sleeps%2C%20he%20puts%20a%20patch%20on%20each%20eye%20%28so%20that%20the%20Martian%20morning%20doesn%27t%20wake%20him%20up%29.%20The%20inner%20side%20of%20each%20patch%20has%20an%20uppercase%20Latin%20letter.%20So%2C%20when%20a%20Martian%20wakes%20up%20and%20opens%20all%20his%20eyes%20he%20sees%20a%20string%20%24%20s%20%24%20consisting%20of%20uppercase%20Latin%20letters.%20The%20string%27s%20length%20is%20%24%20n%20%24%20.%5Cn%5Cn%5C%22Ding%20dong%21%5C%22%20%5Cu2014%20the%20alarm%20goes%20off.%20A%20Martian%20has%20already%20woken%20up%20but%20he%20hasn%27t%20opened%20any%20of%20his%20eyes.%20He%20feels%20that%20today%20is%20going%20to%20be%20a%20hard%20day%2C%20so%20he%20wants%20to%20open%20his%20eyes%20and%20see%20something%20good.%20The%20Martian%20considers%20only%20%24%20m%20%24%20Martian%20words%20beautiful.%20Besides%2C%20it%20is%20hard%20for%20him%20to%20open%20all%20eyes%20at%20once%20so%20early%20in%20the%20morning.%20So%20he%20opens%20two%20non-overlapping%20segments%20of%20consecutive%20eyes.%20More%20formally%2C%20the%20Martian%20chooses%20four%20numbers%20%24%20a%20%24%20%2C%20%24%20b%20%24%20%2C%20%24%20c%20%24%20%2C%20%24%20d%20%24%20%2C%20%28%20%24%201%3C%3Da%3C%3Db%26lt%3Bc%3C%3Dd%3C%3Dn%20%24%20%29%20and%20opens%20all%20eyes%20with%20numbers%20%24%20i%20%24%20such%20that%20%24%20a%3C%3Di%3C%3Db%20%24%20or%20%24%20c%3C%3Di%3C%3Dd%20%24%20.%20After%20the%20Martian%20opens%20the%20eyes%20he%20needs%2C%20he%20reads%20all%20the%20visible%20characters%20from%20the%20left%20to%20the%20right%20and%20thus%2C%20he%20sees%20some%20word.%5Cn%5CnLet%27s%20consider%20all%20different%20words%20the%20Martian%20can%20see%20in%20the%20morning.%20Your%20task%20is%20to%20find%20out%20how%20many%20beautiful%20words%20are%20among%20them.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20a%20non-empty%20string%20%24%20s%20%24%20consisting%20of%20uppercase%20Latin%20letters.%20The%20strings%27%20length%20is%20%24%20n%20%24%20%28%20%24%202%3C%3Dn%3C%3D10%5E%7B5%7D%20%24%20%29.%20The%20second%20line%20contains%20an%20integer%20%24%20m%20%24%20%28%20%24%201%3C%3Dm%3C%3D100%20%24%20%29%20%5Cu2014%20the%20number%20of%20beautiful%20words.%20Next%20%24%20m%20%24%20lines%20contain%20the%20beautiful%20words%20%24%20p_%7Bi%7D%20%24%20%2C%20consisting%20of%20uppercase%20Latin%20letters.%20Their%20length%20is%20from%20%24%201%20%24%20to%20%24%201000%20%24%20.%20All%20beautiful%20strings%20are%20pairwise%20different.%22%2C%22outputFormat%22%3A%22Print%20the%20single%20integer%20%5Cu2014%20the%20number%20of%20different%20beautiful%20strings%20the%20Martian%20can%20see%20this%20morning.%22%2C%22samples%22%3A%5B%5B%22ABCBABA%5Cn2%5CnBAAB%5CnABBA%5Cn%22%2C%221%5Cn%22%5D%5D%2C%22hint%22%3A%22Let%27s%20consider%20the%20sample%20test.%20There%20the%20Martian%20can%20get%20only%20the%20second%20beautiful%20string%20if%20he%20opens%20segments%20of%20eyes%20%24%20a%3D1%2Cb%3D2%20%24%20and%20%24%20c%3D4%2Cd%3D5%20%24%20or%20of%20he%20opens%20segments%20of%20eyes%20%24%20a%3D1%2Cb%3D2%20%24%20and%20%24%20c%3D6%2Cd%3D7%20%24%20.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F149%5C%2FE%22%2C%22id%22%3A%22149E%22%7D%2C%22translation%22%3A%22%5Cu8f93%5Cu5165%5Cu7b2c%5Cu4e00%5Cu884c%5Cu7ed9%5Cu5b9a%5Cu4e00%5Cu4e2a%5Cu957f%5Cu5ea6%5Cu4e3a%20%24n%5C%5C%20%5C%5C%20%281%5C%5Cleq%20n%20%5C%5Cleq%201e5%29%24%20%5Cu7684%5Cu5b57%5Cu7b26%5Cu4e32%20%24s%24%5Cuff0c%5Cu8be5%5Cu4e32%5Cu4ec5%5Cu7531%5Cu5927%5Cu5199%5Cu5b57%5Cu6bcd%5Cu7ec4%5Cu6210%5Cr%5Cn%5Cr%5Cn%5Cu7b2c%5Cu4e8c%5Cu884c%5Cu7ed9%5Cu5b9a%5Cu4e00%5Cu4e2a%5Cu6570%20%24m%5C%5C%20%5C%5C%20%281%20%5C%5Cleq%20m%20%5C%5Cleq%20100%29%24%5Cuff0c%5Cu63a5%5Cu4e0b%5Cu6765%20%24m%24%20%5Cu884c%5Cu8868%5Cu793a%20%24m%24%20%5Cu4e2a%5Cu8be2%5Cu95ee%5Cuff0c%5Cu6bcf%5Cu884c%5Cu4e00%5Cu4e2a%5Cu5b57%5Cu7b26%5Cu4e32%20%24p_i%5C%5C%20%5C%5C%20%281%20%5C%5Cleq%20%7Cp_i%7C%20%5C%5Cleq%201000%29%24%5Cuff0c%5Cu6ee1%5Cu8db3%20%24p_i%24%20%5Cu4e92%5Cu4e0d%5Cu76f8%5Cu540c%5Cr%5Cn%5Cr%5Cn%5Cu4e00%5Cu4e2a%5Cu8be2%5Cu95ee%20%24p_i%24%20%5Cu53ef%5Cu884c%5Cu5f53%5Cu4e14%5Cu4ec5%5Cu5f53%5Cu5b58%5Cu5728%20%24a%2Cb%2Cc%2Cd%24%20%5Cu6ee1%5Cu8db3%241%5C%5Cleq%20a%5C%5Cleq%20b%20%5C%5Clt%20c%20%5C%5Cleq%20d%20%5C%5Cleq%20n%24%20%5Cu4e14%20%24s_as_%7Ba%2B1%7D%5C%5Cdots%20s_%7Bb%7Ds_%7Bc%7Ds_%7Bc%2B1%7D%5C%5Cdots%20s_d%20%3D%20p_i%24%5Cuff0c%5Cu5373%5Cu53ef%5Cu4ee5%5Cu627e%5Cu5230%5Cu4e24%5Cu4e2a%5Cu4e0d%5Cu76f8%5Cu4ea4%5Cu7684%5Cu533a%5Cu95f4%5Cuff0c%5Cu6ee1%5Cu8db3%5Cu8fd9%5Cu4e24%5Cu4e2a%5Cu533a%5Cu95f4%5Cu5bf9%5Cu5e94%5Cu7684%5Cu5b50%5Cu4e32%5Cu62fc%5Cu8d77%5Cu6765%5Cu548c%20%24p_i%24%20%5Cu76f8%5Cu540c%5Cr%5Cn%5Cr%5Cn%5Cu8f93%5Cu51fa%5Cu4e00%5Cu884c%5Cu8868%5Cu793a%5Cu53ef%5Cu884c%5Cu7684%5Cu8be2%5Cu95ee%5Cu7684%5Cu6570%5Cu91cf%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A27%2C%22totalAccepted%22%3A14%2C%22pid%22%3A%22CF149E%22%2C%22title%22%3A%22Martian%20Strings%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Martian%20Strings%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573295103;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Martian Strings</h1>
<h2>题意翻译</h2>
<div>输入第一行给定一个长度为 $n\ \ (1\leq n \leq 1e5)$ 的字符串 $s$，该串仅由大写字母组成
第二行给定一个数 $m\ \ (1 \leq m \leq 100)$，接下来 $m$ 行表示 $m$ 个询问，每行一个字符串 $p_i\ \ (1 \leq |p_i| \leq 1000)$，满足 $p_i$ 互不相同
一个询问 $p_i$ 可行当且仅当存在 $a,b,c,d$ 满足$1\leq a\leq b \lt c \leq d \leq n$ 且 $s_as_{a+1}\dots s_{b}s_{c}s_{c+1}\dots s_d = p_i$，即可以找到两个不相交的区间，满足这两个区间对应的子串拼起来和 $p_i$ 相同
输出一行表示可行的询问的数量</div>
<h2>题目描述</h2>
<div>During the study of the Martians Petya clearly understood that the Martians are absolutely lazy. They like to sleep and don't like to wake up.
Imagine a Martian who has exactly $ n $ eyes located in a row and numbered from the left to the right from $ 1 $ to $ n $ . When a Martian sleeps, he puts a patch on each eye (so that the Martian morning doesn't wake him up). The inner side of each patch has an uppercase Latin letter. So, when a Martian wakes up and opens all his eyes he sees a string $ s $ consisting of uppercase Latin letters. The string's length is $ n $ .
"Ding dong!" — the alarm goes off. A Martian has already woken up but he hasn't opened any of his eyes. He feels that today is going to be a hard day, so he wants to open his eyes and see something good. The Martian considers only $ m $ Martian words beautiful. Besides, it is hard for him to open all eyes at once so early in the morning. So he opens two non-overlapping segments of consecutive eyes. More formally, the Martian chooses four numbers $ a $ , $ b $ , $ c $ , $ d $ , ( $ 1<=a<=b&lt;c<=d<=n $ ) and opens all eyes with numbers $ i $ such that $ a<=i<=b $ or $ c<=i<=d $ . After the Martian opens the eyes he needs, he reads all the visible characters from the left to the right and thus, he sees some word.
Let's consider all different words the Martian can see in the morning. Your task is to find out how many beautiful words are among them.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains a non-empty string $ s $ consisting of uppercase Latin letters. The strings' length is $ n $ ( $ 2<=n<=10^{5} $ ). The second line contains an integer $ m $ ( $ 1<=m<=100 $ ) — the number of beautiful words. Next $ m $ lines contain the beautiful words $ p_{i} $ , consisting of uppercase Latin letters. Their length is from $ 1 $ to $ 1000 $ . All beautiful strings are pairwise different.</div>
<h3>输出格式</h3>
<br />
<div>Print the single integer — the number of different beautiful strings the Martian can see this morning.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>ABCBABA
2
BAAB
ABBA
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>1
</code></pre>
<h2>说明</h2>
<div>Let's consider the sample test. There the Martian can get only the second beautiful string if he opens segments of eyes $ a=1,b=2 $ and $ c=4,d=5 $ or of he opens segments of eyes $ a=1,b=2 $ and $ c=6,d=7 $ .</div>
</article>
</div>
</div>
</body>
</html>
