<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Complete The Graph - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573396995:DOgItw1v8PoU/535uuhPtcB5aoNfcaJYkD/9S/XUrLU=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22ZS%20the%20Coder%20has%20drawn%20an%20undirected%20graph%20of%20%24%20n%20%24%20vertices%20numbered%20from%20%24%200%20%24%20to%20%24%20n-1%20%24%20and%20%24%20m%20%24%20edges%20between%20them.%20Each%20edge%20of%20the%20graph%20is%20weighted%2C%20each%20weight%20is%20a%20positive%20integer.%5Cn%5CnThe%20next%20day%2C%20ZS%20the%20Coder%20realized%20that%20some%20of%20the%20weights%20were%20erased%21%20So%20he%20wants%20to%20reassign%20positive%20integer%20weight%20to%20each%20of%20the%20edges%20which%20weights%20were%20erased%2C%20so%20that%20the%20length%20of%20the%20shortest%20path%20between%20vertices%20%24%20s%20%24%20and%20%24%20t%20%24%20in%20the%20resulting%20graph%20is%20exactly%20%24%20L%20%24%20.%20Can%20you%20help%20him%3F%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20five%20integers%20%24%20n%2Cm%2CL%2Cs%2Ct%20%24%20%28%20%24%202%3C%3Dn%3C%3D1000%2C1%3C%3Dm%3C%3D10000%2C1%3C%3DL%3C%3D10%5E%7B9%7D%2C0%3C%3Ds%2Ct%3C%3Dn-1%2Cs%5Cu2260t%20%24%20%29%20%5Cu2014%20the%20number%20of%20vertices%2C%20number%20of%20edges%2C%20the%20desired%20length%20of%20shortest%20path%2C%20starting%20vertex%20and%20ending%20vertex%20respectively.%5Cn%5CnThen%2C%20%24%20m%20%24%20lines%20describing%20the%20edges%20of%20the%20graph%20follow.%20%24%20i%20%24%20-th%20of%20them%20contains%20three%20integers%2C%20%24%20u_%7Bi%7D%2Cv_%7Bi%7D%2Cw_%7Bi%7D%20%24%20%28%20%24%200%3C%3Du_%7Bi%7D%2Cv_%7Bi%7D%3C%3Dn-1%2Cu_%7Bi%7D%5Cu2260v_%7Bi%7D%2C0%3C%3Dw_%7Bi%7D%3C%3D10%5E%7B9%7D%20%24%20%29.%20%24%20u_%7Bi%7D%20%24%20and%20%24%20v_%7Bi%7D%20%24%20denote%20the%20endpoints%20of%20the%20edge%20and%20%24%20w_%7Bi%7D%20%24%20denotes%20its%20weight.%20If%20%24%20w_%7Bi%7D%20%24%20is%20equal%20to%20%24%200%20%24%20then%20the%20weight%20of%20the%20corresponding%20edge%20was%20erased.%5Cn%5CnIt%20is%20guaranteed%20that%20there%20is%20at%20most%20one%20edge%20between%20any%20pair%20of%20vertices.%22%2C%22outputFormat%22%3A%22Print%20%5C%22NO%5C%22%20%28without%20quotes%29%20in%20the%20only%20line%20if%20it%27s%20not%20possible%20to%20assign%20the%20weights%20in%20a%20required%20way.%5Cn%5CnOtherwise%2C%20print%20%5C%22YES%5C%22%20in%20the%20first%20line.%20Next%20%24%20m%20%24%20lines%20should%20contain%20the%20edges%20of%20the%20resulting%20graph%2C%20with%20weights%20assigned%20to%20edges%20which%20weights%20were%20erased.%20%24%20i%20%24%20-th%20of%20them%20should%20contain%20three%20integers%20%24%20u_%7Bi%7D%20%24%20%2C%20%24%20v_%7Bi%7D%20%24%20and%20%24%20w_%7Bi%7D%20%24%20%2C%20denoting%20an%20edge%20between%20vertices%20%24%20u_%7Bi%7D%20%24%20and%20%24%20v_%7Bi%7D%20%24%20of%20weight%20%24%20w_%7Bi%7D%20%24%20.%20The%20edges%20of%20the%20new%20graph%20must%20coincide%20with%20the%20ones%20in%20the%20graph%20from%20the%20input.%20The%20weights%20that%20were%20not%20erased%20must%20remain%20unchanged%20whereas%20the%20new%20weights%20can%20be%20any%20positive%20integer%20not%20exceeding%20%24%2010%5E%7B18%7D%20%24%20.%5Cn%5CnThe%20order%20of%20the%20edges%20in%20the%20output%20doesn%27t%20matter.%20The%20length%20of%20the%20shortest%20path%20between%20%24%20s%20%24%20and%20%24%20t%20%24%20must%20be%20equal%20to%20%24%20L%20%24%20.%5Cn%5CnIf%20there%20are%20multiple%20solutions%2C%20print%20any%20of%20them.%22%2C%22samples%22%3A%5B%5B%225%205%2013%200%204%5Cn0%201%205%5Cn2%201%202%5Cn3%202%203%5Cn1%204%200%5Cn4%203%204%5Cn%22%2C%22YES%5Cn0%201%205%5Cn2%201%202%5Cn3%202%203%5Cn1%204%208%5Cn4%203%204%5Cn%22%5D%2C%5B%222%201%20123456789%200%201%5Cn0%201%200%5Cn%22%2C%22YES%5Cn0%201%20123456789%5Cn%22%5D%2C%5B%222%201%20999999999%201%200%5Cn0%201%201000000000%5Cn%22%2C%22NO%5Cn%22%5D%5D%2C%22hint%22%3A%22Here%27s%20how%20the%20graph%20in%20the%20first%20sample%20case%20looks%20like%20%3A%5Cn%5Cn%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF715B%5C%2Fc442fd279761bfa74ef367b518cede1e1fa97983.png%29In%20the%20first%20sample%20case%2C%20there%20is%20only%20one%20missing%20edge%20weight.%20Placing%20the%20weight%20of%20%24%208%20%24%20gives%20a%20shortest%20path%20from%20%24%200%20%24%20to%20%24%204%20%24%20of%20length%20%24%2013%20%24%20.%5Cn%5CnIn%20the%20second%20sample%20case%2C%20there%20is%20only%20a%20single%20edge.%20Clearly%2C%20the%20only%20way%20is%20to%20replace%20the%20missing%20weight%20with%20%24%20123456789%20%24%20.%5Cn%5CnIn%20the%20last%20sample%20case%2C%20there%20is%20no%20weights%20to%20assign%20but%20the%20length%20of%20the%20shortest%20path%20doesn%27t%20match%20the%20required%20value%2C%20so%20the%20answer%20is%20%5C%22NO%5C%22.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B4000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F715%5C%2FB%22%2C%22id%22%3A%22715B%22%7D%2C%22translation%22%3A%22%5Cu7ed9n%5Cu70b9m%5Cu8fb9%5Cuff0cL%5Cuff0cs%5Cuff0ct%20%5Cn%5Cu4fee%5Cu6539m%5Cu6761%5Cu8fb9%5Cu4e2d%5Cu8fb9%5Cu4e3a0%5Cu7684%5Cu8fb9%5Cuff0c%20%5Cn%5Cu4f7f%5Cu6ee1%5Cu8db3s%2Ct%5Cu7684%5Cu6700%5Cu77ed%5Cu8def%5Cu957f%5Cu5ea6%5Cu662fL%5Cuff0c%5Cu4e14%5Cu8f93%5Cu51fa%5Cu7b54%5Cu6848%5Cu7684%5Cu65f6%5Cu5019%5Cu8fb9%5Cu4e3a0%5Cu7684%5Cu8fb9%5Cu7684%5Cu6743%5Cu503c%5Cu5fc5%5Cu987b%5Cu5728%5B1%2C1e18%5D%5Cu5185%5Cn%5Cn%5Cu611f%5Cu8c22%40AKIOIAKIOI%20%5Cu63d0%5Cu4f9b%5Cu7684%5Cu7ffb%5Cu8bd1%22%2C%22tags%22%3A%5B111%2C160%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A185%2C%22totalAccepted%22%3A48%2C%22pid%22%3A%22CF715B%22%2C%22title%22%3A%22Complete%20The%20Graph%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A73416%2C%22title%22%3A%22%5Cu6c42%5Cu5927%5Cu4f6c%5Cu6539%5Cu7a0b%5Cu5e8f%5Cuff0c%5Cu7b2c%5Cu5341%5Cu4e2a%5Cu70b9WA%5Cu4e86%22%2C%22forum%22%3A%7B%22id%22%3A9799%2C%22name%22%3A%22CF715B%20Complete%20The%20Graph%22%2C%22slug%22%3A%22CF715B%22%7D%7D%2C%7B%22id%22%3A71302%2C%22title%22%3A%22%5Cu7ffb%5Cu8bd1%22%2C%22forum%22%3A%7B%22id%22%3A9799%2C%22name%22%3A%22CF715B%20Complete%20The%20Graph%22%2C%22slug%22%3A%22CF715B%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22CF715C%22%2C%22title%22%3A%22Digit%20Tree%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22P4620%22%2C%22title%22%3A%22%5BSDOI2018%5D%5Cu8363%5Cu8a89%5Cu79f0%5Cu53f7%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P4899%22%2C%22title%22%3A%22%5BIOI2018%5D%20werewolf%20%5Cu72fc%5Cu4eba%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22CF1198B%22%2C%22title%22%3A%22Welfare%20State%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1198A%22%2C%22title%22%3A%22MP3%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Complete%20The%20Graph%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573306449;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Complete The Graph</h1>
<h2>题意翻译</h2>
<div>给n点m边，L，s，t
修改m条边中边为0的边，
使满足s,t的最短路长度是L，且输出答案的时候边为0的边的权值必须在[1,1e18]内
感谢@AKIOIAKIOI 提供的翻译</div>
<h2>题目描述</h2>
<div>ZS the Coder has drawn an undirected graph of $ n $ vertices numbered from $ 0 $ to $ n-1 $ and $ m $ edges between them. Each edge of the graph is weighted, each weight is a positive integer.
The next day, ZS the Coder realized that some of the weights were erased! So he wants to reassign positive integer weight to each of the edges which weights were erased, so that the length of the shortest path between vertices $ s $ and $ t $ in the resulting graph is exactly $ L $ . Can you help him?</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains five integers $ n,m,L,s,t $ ( $ 2<=n<=1000,1<=m<=10000,1<=L<=10^{9},0<=s,t<=n-1,s≠t $ ) — the number of vertices, number of edges, the desired length of shortest path, starting vertex and ending vertex respectively.
Then, $ m $ lines describing the edges of the graph follow. $ i $ -th of them contains three integers, $ u_{i},v_{i},w_{i} $ ( $ 0<=u_{i},v_{i}<=n-1,u_{i}≠v_{i},0<=w_{i}<=10^{9} $ ). $ u_{i} $ and $ v_{i} $ denote the endpoints of the edge and $ w_{i} $ denotes its weight. If $ w_{i} $ is equal to $ 0 $ then the weight of the corresponding edge was erased.
It is guaranteed that there is at most one edge between any pair of vertices.</div>
<h3>输出格式</h3>
<br />
<div>Print "NO" (without quotes) in the only line if it's not possible to assign the weights in a required way.
Otherwise, print "YES" in the first line. Next $ m $ lines should contain the edges of the resulting graph, with weights assigned to edges which weights were erased. $ i $ -th of them should contain three integers $ u_{i} $ , $ v_{i} $ and $ w_{i} $ , denoting an edge between vertices $ u_{i} $ and $ v_{i} $ of weight $ w_{i} $ . The edges of the new graph must coincide with the ones in the graph from the input. The weights that were not erased must remain unchanged whereas the new weights can be any positive integer not exceeding $ 10^{18} $ .
The order of the edges in the output doesn't matter. The length of the shortest path between $ s $ and $ t $ must be equal to $ L $ .
If there are multiple solutions, print any of them.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>5 5 13 0 4
0 1 5
2 1 2
3 2 3
1 4 0
4 3 4
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>YES
0 1 5
2 1 2
3 2 3
1 4 8
4 3 4
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>2 1 123456789 0 1
0 1 0
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>YES
0 1 123456789
</code></pre>
<h3>输入样例 #3</h3>
<pre><code>2 1 999999999 1 0
0 1 1000000000
</code></pre>
<h3>输出样例 #3</h3>
<pre><code>NO
</code></pre>
<h2>说明</h2>
<div>Here's how the graph in the first sample case looks like :
![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF715B/c442fd279761bfa74ef367b518cede1e1fa97983.png)In the first sample case, there is only one missing edge weight. Placing the weight of $ 8 $ gives a shortest path from $ 0 $ to $ 4 $ of length $ 13 $ .
In the second sample case, there is only a single edge. Clearly, the only way is to replace the missing weight with $ 123456789 $ .
In the last sample case, there is no weights to assign but the length of the shortest path doesn't match the required value, so the answer is "NO".</div>
</article>
</div>
</div>
</body>
</html>
