<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Sasha and One More Name - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573401821:tCSyEdr4ZCuUJsCXXyEpgne9IE3UHqExLQHoUMr+JII=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Reading%20books%20is%20one%20of%20Sasha%27s%20passions.%20Once%20while%20he%20was%20reading%20one%20book%2C%20he%20became%20acquainted%20with%20an%20unusual%20character.%20The%20character%20told%20about%20himself%20like%20that%3A%20%5C%22Many%20are%20my%20names%20in%20many%20countries.%20Mithrandir%20among%20the%20Elves%2C%20Thark%5Cu00fbn%20to%20the%20Dwarves%2C%20Ol%5Cu00f3rin%20I%20was%20in%20my%20youth%20in%20the%20West%20that%20is%20forgotten%2C%20in%20the%20South%20Inc%5Cu00e1nus%2C%20in%20the%20North%20Gandalf%3B%20to%20the%20East%20I%20go%20not.%5C%22%5Cn%5CnAnd%20at%20that%20moment%20Sasha%20thought%2C%20how%20would%20that%20character%20be%20called%20in%20the%20East%3F%20In%20the%20East%20all%20names%20are%20palindromes.%20A%20string%20is%20a%20palindrome%20if%20it%20reads%20the%20same%20backward%20as%20forward.%20For%20example%2C%20such%20strings%20as%20%5C%22kazak%5C%22%2C%20%5C%22oo%5C%22%20and%20%5C%22r%5C%22%20are%20palindromes%2C%20but%20strings%20%5C%22abb%5C%22%20and%20%5C%22ij%5C%22%20are%20not.%5Cn%5CnSasha%20believed%20that%20the%20hero%20would%20be%20named%20after%20one%20of%20the%20gods%20of%20the%20East.%20As%20long%20as%20there%20couldn%27t%20be%20two%20equal%20names%2C%20so%20in%20the%20East%20people%20did%20the%20following%3A%20they%20wrote%20the%20original%20name%20as%20a%20string%20on%20a%20piece%20of%20paper%2C%20then%20cut%20the%20paper%20minimum%20number%20of%20times%20%24%20k%20%24%20%2C%20so%20they%20got%20%24%20k%2B1%20%24%20pieces%20of%20paper%20with%20substrings%20of%20the%20initial%20string%2C%20and%20then%20unite%20those%20pieces%20together%20to%20get%20a%20new%20string.%20Pieces%20couldn%27t%20be%20turned%20over%2C%20they%20could%20be%20shuffled.%5Cn%5CnIn%20this%20way%2C%20it%27s%20possible%20to%20achive%20a%20string%20abcdefg%20from%20the%20string%20f%7Cde%7Cabc%7Cg%20using%20%24%203%20%24%20cuts%20%28by%20swapping%20papers%20with%20substrings%20f%20and%20abc%29.%20The%20string%20cbadefg%20can%27t%20be%20received%20using%20the%20same%20cuts.%5Cn%5CnMore%20formally%2C%20Sasha%20wants%20for%20the%20given%20palindrome%20%24%20s%20%24%20find%20such%20minimum%20%24%20k%20%24%20%2C%20that%20you%20can%20cut%20this%20string%20into%20%24%20k%20%2B%201%20%24%20parts%2C%20and%20then%20unite%20them%20in%20such%20a%20way%20that%20the%20final%20string%20will%20be%20a%20palindrome%20and%20it%20won%27t%20be%20equal%20to%20the%20initial%20string%20%24%20s%20%24%20.%20It%20there%20is%20no%20answer%2C%20then%20print%20%5C%22Impossible%5C%22%20%28without%20quotes%29.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20one%20string%20%24%20s%20%24%20%28%20%24%201%20%5C%5Cle%20%7Cs%7C%20%5C%5Cle%205%5C%5C%2C000%20%24%20%29%20%5Cu2014%20the%20initial%20name%2C%20which%20consists%20only%20of%20lowercase%20Latin%20letters.%20It%20is%20guaranteed%20that%20%24%20s%20%24%20is%20a%20palindrome.%22%2C%22outputFormat%22%3A%22Print%20one%20integer%20%24%20k%20%24%20%5Cu2014%20the%20minimum%20number%20of%20cuts%20needed%20to%20get%20a%20new%20name%2C%20or%20%5C%22Impossible%5C%22%20%28without%20quotes%29.%22%2C%22samples%22%3A%5B%5B%22%5Cnnolon%5Cn%22%2C%22%5Cn2%5Cn%22%5D%2C%5B%22%5Cnotto%5Cn%22%2C%22%5Cn1%5Cn%22%5D%2C%5B%22%5Cnqqqq%5Cn%22%2C%22%5CnImpossible%5Cn%22%5D%2C%5B%22%5Cnkinnikkinnik%5Cn%22%2C%22%5Cn1%5Cn%22%5D%5D%2C%22hint%22%3A%22In%20the%20first%20example%2C%20you%20can%20cut%20the%20string%20in%20those%20positions%3A%20no%7Cl%7Con%2C%20and%20then%20unite%20them%20as%20follows%20on%7Cl%7Cno.%20It%20can%20be%20shown%20that%20there%20is%20no%20solution%20with%20one%20cut.%5Cn%5CnIn%20the%20second%20example%2C%20you%20can%20cut%20the%20string%20right%20in%20the%20middle%2C%20and%20swap%20peaces%2C%20so%20you%20get%20toot.%5Cn%5CnIn%20the%20third%20example%2C%20you%20can%27t%20make%20a%20string%2C%20that%20won%27t%20be%20equal%20to%20the%20initial%20one.%5Cn%5CnIn%20the%20fourth%20example%2C%20you%20can%20cut%20the%20suffix%20nik%20and%20add%20it%20to%20the%20beginning%2C%20so%20you%20get%20nikkinnikkin.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F1109%5C%2FB%22%2C%22id%22%3A%221109B%22%7D%2C%22translation%22%3A%22%23%23%23%23%20%5Cu3010%5Cu9898%5Cu610f%5Cu3011%5Cr%5Cn%5Cu7ed9%5Cu5b9a%5Cu4e00%5Cu4e2a%5Cu56de%5Cu6587%5Cu5b57%5Cu7b26%5Cu4e32%5Cuff0c%5Cu5982%5Cu4eca%5Cu60f3%5Cu5c06%5Cu8fd9%5Cu4e2a%5Cu5b57%5Cu7b26%5Cu4e32%5Cu7528k%5Cu5200%5Cu5207%5Cu6210k%2B1%5Cu4e2a%5Cu90e8%5Cu5206%5Cuff0c%5Cu7136%5Cu540e%5Cu5bf9%5Cu8fd9k%2B1%5Cu4e2a%5Cu5b50%5Cu4e32%5Cu91cd%5Cu65b0%5Cu6392%5Cu5217%5Cuff08%5Cu4e0d%5Cu80fd%5Cu6539%5Cu53d8%5Cu5b50%5Cu4e32%5Cu5185%5Cu90e8%5Cu7684%5Cu5b57%5Cu7b26%5Cu987a%5Cu5e8f%5Cuff09%5Cu4f7f%5Cu5f97%5Cu5f97%5Cu5230%5Cu7684%5Cu65b0%5Cu4e32%5Cu4e5f%5Cu4e3a%5Cu56de%5Cu6587%5Cu4e32%5Cu4e14%5Cu4e0d%5Cu4e0e%5Cu539f%5Cu4e32%5Cu4e00%5Cu6837%5Cu3002%5Cu6c42%5Cu51fa%5Cu8fd9%5Cu4e2a%5Cu6700%5Cu5c0f%5Cu7684%5Cu6570k%5Cu3002%5Cu5982%5Cu679c%5Cu505a%5Cu4e0d%5Cu5230%5Cuff0c%5Cu5219%5Cu8f93%5Cu51fa%5C%22Impossible%5C%22%5Cu3002%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A113%2C%22totalAccepted%22%3A36%2C%22pid%22%3A%22CF1109B%22%2C%22title%22%3A%22Sasha%20and%20One%20More%20Name%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P2210%22%2C%22title%22%3A%22Haywire%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22SP1043%22%2C%22title%22%3A%22GSS1%20-%20Can%20you%20answer%20these%20queries%20I%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22SP%22%7D%2C%7B%22pid%22%3A%22P4238%22%2C%22title%22%3A%22%5Cu3010%5Cu6a21%5Cu677f%5Cu3011%5Cu591a%5Cu9879%5Cu5f0f%5Cu6c42%5Cu9006%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22CF1109D%22%2C%22title%22%3A%22Sasha%20and%20Interesting%20Fact%20from%20Graph%20Theory%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1200D%22%2C%22title%22%3A%22White%20Lines%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Sasha%20and%20One%20More%20Name%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Sasha and One More Name</h1>
<h2>题意翻译</h2>
<div>#### 【题意】
给定一个回文字符串，如今想将这个字符串用k刀切成k+1个部分，然后对这k+1个子串重新排列（不能改变子串内部的字符顺序）使得得到的新串也为回文串且不与原串一样。求出这个最小的数k。如果做不到，则输出"Impossible"。</div>
<h2>题目描述</h2>
<div>Reading books is one of Sasha's passions. Once while he was reading one book, he became acquainted with an unusual character. The character told about himself like that: "Many are my names in many countries. Mithrandir among the Elves, Tharkûn to the Dwarves, Olórin I was in my youth in the West that is forgotten, in the South Incánus, in the North Gandalf; to the East I go not."
And at that moment Sasha thought, how would that character be called in the East? In the East all names are palindromes. A string is a palindrome if it reads the same backward as forward. For example, such strings as "kazak", "oo" and "r" are palindromes, but strings "abb" and "ij" are not.
Sasha believed that the hero would be named after one of the gods of the East. As long as there couldn't be two equal names, so in the East people did the following: they wrote the original name as a string on a piece of paper, then cut the paper minimum number of times $ k $ , so they got $ k+1 $ pieces of paper with substrings of the initial string, and then unite those pieces together to get a new string. Pieces couldn't be turned over, they could be shuffled.
In this way, it's possible to achive a string abcdefg from the string f|de|abc|g using $ 3 $ cuts (by swapping papers with substrings f and abc). The string cbadefg can't be received using the same cuts.
More formally, Sasha wants for the given palindrome $ s $ find such minimum $ k $ , that you can cut this string into $ k + 1 $ parts, and then unite them in such a way that the final string will be a palindrome and it won't be equal to the initial string $ s $ . It there is no answer, then print "Impossible" (without quotes).</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains one string $ s $ ( $ 1 \le |s| \le 5\,000 $ ) — the initial name, which consists only of lowercase Latin letters. It is guaranteed that $ s $ is a palindrome.</div>
<h3>输出格式</h3>
<br />
<div>Print one integer $ k $ — the minimum number of cuts needed to get a new name, or "Impossible" (without quotes).</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>
nolon
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>
2
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>
otto
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>
1
</code></pre>
<h3>输入样例 #3</h3>
<pre><code>
qqqq
</code></pre>
<h3>输出样例 #3</h3>
<pre><code>
Impossible
</code></pre>
<h3>输入样例 #4</h3>
<pre><code>
kinnikkinnik
</code></pre>
<h3>输出样例 #4</h3>
<pre><code>
1
</code></pre>
<h2>说明</h2>
<div>In the first example, you can cut the string in those positions: no|l|on, and then unite them as follows on|l|no. It can be shown that there is no solution with one cut.
In the second example, you can cut the string right in the middle, and swap peaces, so you get toot.
In the third example, you can't make a string, that won't be equal to the initial one.
In the fourth example, you can cut the suffix nik and add it to the beginning, so you get nikkinnikkin.</div>
</article>
</div>
</div>
</body>
</html>
