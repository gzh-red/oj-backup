<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Dating - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573398642:0jByy5Z0HsWw1/eZczSyuasBCMb1Zfa19WWNEOzJ6AE=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22This%20story%20is%20happening%20in%20a%20town%20named%20BubbleLand.%20There%20are%20%24%20n%20%24%20houses%20in%20BubbleLand.%20In%20each%20of%20these%20%24%20n%20%24%20houses%20lives%20a%20boy%20or%20a%20girl.%20People%20there%20really%20love%20numbers%20and%20everyone%20has%20their%20favorite%20number%20%24%20f%20%24%20.%20That%20means%20that%20the%20boy%20or%20girl%20that%20lives%20in%20the%20%24%20i%20%24%20-th%20house%20has%20favorite%20number%20equal%20to%20%24%20f_%7Bi%7D%20%24%20.%5Cn%5CnThe%20houses%20are%20numerated%20with%20numbers%20%24%201%20%24%20to%20%24%20n%20%24%20.%5Cn%5CnThe%20houses%20are%20connected%20with%20%24%20n-1%20%24%20bidirectional%20roads%20and%20you%20can%20travel%20from%20any%20house%20to%20any%20other%20house%20in%20the%20town.%20There%20is%20exactly%20one%20path%20between%20every%20pair%20of%20houses.%5Cn%5CnA%20new%20dating%20had%20agency%20opened%20their%20offices%20in%20this%20mysterious%20town%20and%20the%20citizens%20were%20very%20excited.%20They%20immediately%20sent%20%24%20q%20%24%20questions%20to%20the%20agency%20and%20each%20question%20was%20of%20the%20following%20format%3A%5Cn%5Cn-%20%24%20a%5C%5C%20b%20%24%20%5Cu2014%20asking%20how%20many%20ways%20are%20there%20to%20choose%20a%20couple%20%28boy%20and%20girl%29%20that%20have%20the%20same%20favorite%20number%20and%20live%20in%20one%20of%20the%20houses%20on%20the%20unique%20path%20from%20house%20%24%20a%20%24%20to%20house%20%24%20b%20%24%20.%5Cn%5CnHelp%20the%20dating%20agency%20to%20answer%20the%20questions%20and%20grow%20their%20business.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20an%20integer%20%24%20n%20%24%20%28%20%24%201%3C%3Dn%3C%3D10%5E%7B5%7D%20%24%20%29%2C%20the%20number%20of%20houses%20in%20the%20town.%5Cn%5CnThe%20second%20line%20contains%20%24%20n%20%24%20integers%2C%20where%20the%20%24%20i%20%24%20-th%20number%20is%20%24%201%20%24%20if%20a%20boy%20lives%20in%20the%20%24%20i%20%24%20-th%20house%20or%20%24%200%20%24%20if%20a%20girl%20lives%20in%20%24%20i%20%24%20-th%20house.%5Cn%5CnThe%20third%20line%20contains%20%24%20n%20%24%20integers%2C%20where%20the%20%24%20i%20%24%20-th%20number%20represents%20the%20favorite%20number%20%24%20f_%7Bi%7D%20%24%20%28%20%24%201%3C%3Df_%7Bi%7D%3C%3D10%5E%7B9%7D%20%24%20%29%20of%20the%20girl%20or%20boy%20that%20lives%20in%20the%20%24%20i%20%24%20-th%20house.%5Cn%5CnThe%20next%20%24%20n-1%20%24%20lines%20contain%20information%20about%20the%20roads%20and%20the%20%24%20i%20%24%20-th%20line%20contains%20two%20integers%20%24%20a_%7Bi%7D%20%24%20and%20%24%20b_%7Bi%7D%20%24%20%28%20%24%201%3C%3Da_%7Bi%7D%2Cb_%7Bi%7D%3C%3Dn%20%24%20%29%20which%20means%20that%20there%20exists%20road%20between%20those%20two%20houses.%20It%20is%20guaranteed%20that%20it%27s%20possible%20to%20reach%20any%20house%20from%20any%20other.%5Cn%5CnThe%20following%20line%20contains%20an%20integer%20%24%20q%20%24%20%28%20%24%201%3C%3Dq%3C%3D10%5E%7B5%7D%20%24%20%29%2C%20the%20number%20of%20queries.%5Cn%5CnEach%20of%20the%20following%20%24%20q%20%24%20lines%20represents%20a%20question%20and%20consists%20of%20two%20integers%20%24%20a%20%24%20and%20%24%20b%20%24%20%28%20%24%201%3C%3Da%2Cb%3C%3Dn%20%24%20%29.%22%2C%22outputFormat%22%3A%22For%20each%20of%20the%20%24%20q%20%24%20questions%20output%20a%20single%20number%2C%20the%20answer%20to%20the%20citizens%20question.%22%2C%22samples%22%3A%5B%5B%227%5Cn1%200%200%201%200%201%200%5Cn9%202%209%202%202%209%209%5Cn2%206%5Cn1%202%5Cn4%202%5Cn6%205%5Cn3%206%5Cn7%204%5Cn2%5Cn1%203%5Cn7%205%5Cn%22%2C%222%5Cn3%5Cn%22%5D%5D%2C%22hint%22%3A%22In%20the%20first%20question%20from%20house%20%24%201%20%24%20to%20house%20%24%203%20%24%20%2C%20the%20potential%20couples%20are%20%24%20%281%2C3%29%20%24%20and%20%24%20%286%2C3%29%20%24%20.%5Cn%5CnIn%20the%20second%20question%20from%20house%20%24%207%20%24%20to%20house%20%24%205%20%24%20%2C%20the%20potential%20couples%20are%20%24%20%287%2C6%29%20%24%20%2C%20%24%20%284%2C2%29%20%24%20and%20%24%20%284%2C5%29%20%24%20.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B64000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F852%5C%2FI%22%2C%22id%22%3A%22852I%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A1%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22CF852I%22%2C%22title%22%3A%22Dating%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Dating%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Dating</h1>
<h2>题目描述</h2>
<div>This story is happening in a town named BubbleLand. There are $ n $ houses in BubbleLand. In each of these $ n $ houses lives a boy or a girl. People there really love numbers and everyone has their favorite number $ f $ . That means that the boy or girl that lives in the $ i $ -th house has favorite number equal to $ f_{i} $ .
The houses are numerated with numbers $ 1 $ to $ n $ .
The houses are connected with $ n-1 $ bidirectional roads and you can travel from any house to any other house in the town. There is exactly one path between every pair of houses.
A new dating had agency opened their offices in this mysterious town and the citizens were very excited. They immediately sent $ q $ questions to the agency and each question was of the following format:
- $ a\ b $ — asking how many ways are there to choose a couple (boy and girl) that have the same favorite number and live in one of the houses on the unique path from house $ a $ to house $ b $ .
Help the dating agency to answer the questions and grow their business.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains an integer $ n $ ( $ 1<=n<=10^{5} $ ), the number of houses in the town.
The second line contains $ n $ integers, where the $ i $ -th number is $ 1 $ if a boy lives in the $ i $ -th house or $ 0 $ if a girl lives in $ i $ -th house.
The third line contains $ n $ integers, where the $ i $ -th number represents the favorite number $ f_{i} $ ( $ 1<=f_{i}<=10^{9} $ ) of the girl or boy that lives in the $ i $ -th house.
The next $ n-1 $ lines contain information about the roads and the $ i $ -th line contains two integers $ a_{i} $ and $ b_{i} $ ( $ 1<=a_{i},b_{i}<=n $ ) which means that there exists road between those two houses. It is guaranteed that it's possible to reach any house from any other.
The following line contains an integer $ q $ ( $ 1<=q<=10^{5} $ ), the number of queries.
Each of the following $ q $ lines represents a question and consists of two integers $ a $ and $ b $ ( $ 1<=a,b<=n $ ).</div>
<h3>输出格式</h3>
<br />
<div>For each of the $ q $ questions output a single number, the answer to the citizens question.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>7
1 0 0 1 0 1 0
9 2 9 2 2 9 9
2 6
1 2
4 2
6 5
3 6
7 4
2
1 3
7 5
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>2
3
</code></pre>
<h2>说明</h2>
<div>In the first question from house $ 1 $ to house $ 3 $ , the potential couples are $ (1,3) $ and $ (6,3) $ .
In the second question from house $ 7 $ to house $ 5 $ , the potential couples are $ (7,6) $ , $ (4,2) $ and $ (4,5) $ .</div>
</article>
</div>
</div>
</body>
</html>
