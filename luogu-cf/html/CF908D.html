<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>New Year and Arbitrary Arrangement - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573399242:KnYaAlcDauyAnPCgvVWgyOHQBXnwvoLKGCsOo6gW6So=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%22%2C%22description%22%3A%22You%20are%20given%20three%20integers%20%24%20k%20%24%20%2C%20%24%20p_%7Ba%7D%20%24%20and%20%24%20p_%7Bb%7D%20%24%20.%5Cn%5CnYou%20will%20construct%20a%20sequence%20with%20the%20following%20algorithm%3A%20Initially%2C%20start%20with%20the%20empty%20sequence.%20Each%20second%2C%20you%20do%20the%20following.%20With%20probability%20%24%20p_%7Ba%7D%5C%2F%28p_%7Ba%7D%2Bp_%7Bb%7D%29%20%24%20%2C%20add%20%27a%27%20to%20the%20end%20of%20the%20sequence.%20Otherwise%20%28with%20probability%20%24%20p_%7Bb%7D%5C%2F%28p_%7Ba%7D%2Bp_%7Bb%7D%29%20%24%20%29%2C%20add%20%27b%27%20to%20the%20end%20of%20the%20sequence.%5Cn%5CnYou%20stop%20once%20there%20are%20at%20least%20%24%20k%20%24%20subsequences%20that%20form%20%27ab%27.%20Determine%20the%20expected%20number%20of%20times%20%27ab%27%20is%20a%20subsequence%20in%20the%20resulting%20sequence.%20It%20can%20be%20shown%20that%20this%20can%20be%20represented%20by%20%24%20P%5C%2FQ%20%24%20%2C%20where%20%24%20P%20%24%20and%20%24%20Q%20%24%20are%20coprime%20integers%2C%20and%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF908D%5C%2F250bff4a0d2d6149565f6e795de0dbd59e6a92a3.png%29.%20Print%20the%20value%20of%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF908D%5C%2F962b3e429ab173c8d460f96cc849d01fcd4a9d47.png%29.%22%2C%22inputFormat%22%3A%22The%20first%20line%20will%20contain%20three%20integers%20integer%20%24%20k%2Cp_%7Ba%7D%2Cp_%7Bb%7D%20%24%20%28%20%24%201%3C%3Dk%3C%3D1000%20%24%20%2C%20%24%201%3C%3Dp_%7Ba%7D%2Cp_%7Bb%7D%3C%3D1000000%20%24%20%29.%22%2C%22outputFormat%22%3A%22Print%20a%20single%20integer%2C%20the%20answer%20to%20the%20problem.%22%2C%22samples%22%3A%5B%5B%221%201%201%5Cn%22%2C%222%5Cn%22%5D%2C%5B%223%201%204%5Cn%22%2C%22370000006%5Cn%22%5D%5D%2C%22hint%22%3A%22The%20first%20sample%2C%20we%20will%20keep%20appending%20to%20our%20sequence%20until%20we%20get%20the%20subsequence%20%27ab%27%20at%20least%20once.%20For%20instance%2C%20we%20get%20the%20sequence%20%27ab%27%20with%20probability%201%5C%2F4%2C%20%27bbab%27%20with%20probability%201%5C%2F16%2C%20and%20%27aab%27%20with%20probability%201%5C%2F8.%20Note%2C%20it%27s%20impossible%20for%20us%20to%20end%20with%20a%20sequence%20like%20%27aabab%27%2C%20since%20we%20would%20have%20stopped%20our%20algorithm%20once%20we%20had%20the%20prefix%20%27aab%27.%5Cn%5CnThe%20expected%20amount%20of%20times%20that%20%27ab%27%20will%20occur%20across%20all%20valid%20sequences%20is%202.%5Cn%5CnFor%20the%20second%20sample%2C%20the%20answer%20is%20equal%20to%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF908D%5C%2Fbe8bc2d2b5b20d19237dcaabfc3c3ca4bcb22ac0.png%29.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F908%5C%2FD%22%2C%22id%22%3A%22908D%22%7D%2C%22translation%22%3A%22%5Cu7ed9%5Cu5b9a%5Cu4e09%5Cu4e2a%5Cu6570k%2Cpa%2Cpb%5Cn%5Cu6bcf%5Cu6b21%5Cu6709%24%5C%5Cfrac%7Bpa%7D%7Bpa%2Bpb%7D%24%20%5Cu7684%5Cu6982%5Cu7387%5Cu5f80%5Cu540e%5Cu9762%5Cu6dfb%5Cu52a0%5Cu4e00%5Cu4e2a%27a%27%5Cn%5Cn%5Cu6bcf%5Cu6b21%5Cu6709%24%5C%5Cfrac%7Bpb%7D%7Bpa%2Bpb%7D%24%20%20%5Cu7684%5Cu6982%5Cu7387%5Cu5f80%5Cu540e%5Cu9762%5Cu6dfb%5Cu52a0%5Cu4e00%5Cu4e2a%27b%27%5Cn%5Cn%5Cu5f53%5Cu51fa%5Cu73b0%5Cu4e86k%5Cu4e2a%5Cu5f62%5Cu5982ab%5Cu7684%5Cu5b50%5Cu5e8f%5Cu5217%5Cuff08%5Cu4e0d%5Cu7528%5Cu8fde%5Cu7eed%5Cuff09%5Cu65f6%5Cu505c%5Cu6b62%5Cn%5Cn%5Cu6c42%5Cu6700%5Cu540e%5Cu7684%5Cu4e32%5Cu957f%5Cu7684%5Cu671f%5Cu671b%5Cn%5Cn%5Cu7b54%5Cu6848%5Cu5bf910%5E9%2B7%5Cu53d6%5Cu6a21%5Cn%5CnTranslated%20by%20yybyyb%22%2C%22tags%22%3A%5B3%2C270%2C276%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A175%2C%22totalAccepted%22%3A111%2C%22pid%22%3A%22CF908D%22%2C%22title%22%3A%22New%20Year%20and%20Arbitrary%20Arrangement%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A158416%2C%22title%22%3A%22%5Cu518d%5Cu6b21%5Cu63d0%5Cu9192%5Cu5927%5Cu5bb6%22%2C%22forum%22%3A%7B%22id%22%3A8949%2C%22name%22%3A%22CF908D%20New%20Year%20and%20Arbitrary%20Arrangement%22%2C%22slug%22%3A%22CF908D%22%7D%7D%2C%7B%22id%22%3A147567%2C%22title%22%3A%22%5Cu7ffb%5Cu8bd1%5Cu6709%5Cu8bef%22%2C%22forum%22%3A%7B%22id%22%3A8949%2C%22name%22%3A%22CF908D%20New%20Year%20and%20Arbitrary%20Arrangement%22%2C%22slug%22%3A%22CF908D%22%7D%7D%2C%7B%22id%22%3A32155%2C%22title%22%3A%22%5Cu7ffb%5Cu8bd1%22%2C%22forum%22%3A%7B%22id%22%3A8949%2C%22name%22%3A%22CF908D%20New%20Year%20and%20Arbitrary%20Arrangement%22%2C%22slug%22%3A%22CF908D%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P1654%22%2C%22title%22%3A%22OSU%21%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P3232%22%2C%22title%22%3A%22%5BHNOI2013%5D%5Cu6e38%5Cu8d70%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P3592%22%2C%22title%22%3A%22%5BPOI2015%5DMYJ%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22CF908G%22%2C%22title%22%3A%22New%20Year%20and%20Original%20Order%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22P5056%22%2C%22title%22%3A%22%5Cu3010%5Cu6a21%5Cu677f%5Cu3011%5Cu63d2%5Cu5934dp%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22New%20Year%20and%20Arbitrary%20Arrangement%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>New Year and Arbitrary Arrangement</h1>
<h2>题意翻译</h2>
<div>给定三个数k,pa,pb
每次有$\frac{pa}{pa+pb}$ 的概率往后面添加一个'a'
每次有$\frac{pb}{pa+pb}$ 的概率往后面添加一个'b'
当出现了k个形如ab的子序列（不用连续）时停止
求最后的串长的期望
答案对10^9+7取模
Translated by yybyyb</div>
<h2>题目描述</h2>
<div>You are given three integers $ k $ , $ p_{a} $ and $ p_{b} $ .
You will construct a sequence with the following algorithm: Initially, start with the empty sequence. Each second, you do the following. With probability $ p_{a}/(p_{a}+p_{b}) $ , add 'a' to the end of the sequence. Otherwise (with probability $ p_{b}/(p_{a}+p_{b}) $ ), add 'b' to the end of the sequence.
You stop once there are at least $ k $ subsequences that form 'ab'. Determine the expected number of times 'ab' is a subsequence in the resulting sequence. It can be shown that this can be represented by $ P/Q $ , where $ P $ and $ Q $ are coprime integers, and ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF908D/250bff4a0d2d6149565f6e795de0dbd59e6a92a3.png). Print the value of ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF908D/962b3e429ab173c8d460f96cc849d01fcd4a9d47.png).</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line will contain three integers integer $ k,p_{a},p_{b} $ ( $ 1<=k<=1000 $ , $ 1<=p_{a},p_{b}<=1000000 $ ).</div>
<h3>输出格式</h3>
<br />
<div>Print a single integer, the answer to the problem.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>1 1 1
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>2
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>3 1 4
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>370000006
</code></pre>
<h2>说明</h2>
<div>The first sample, we will keep appending to our sequence until we get the subsequence 'ab' at least once. For instance, we get the sequence 'ab' with probability 1/4, 'bbab' with probability 1/16, and 'aab' with probability 1/8. Note, it's impossible for us to end with a sequence like 'aabab', since we would have stopped our algorithm once we had the prefix 'aab'.
The expected amount of times that 'ab' will occur across all valid sequences is 2.
For the second sample, the answer is equal to ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF908D/be8bc2d2b5b20d19237dcaabfc3c3ca4bcb22ac0.png).</div>
</article>
</div>
</div>
</body>
</html>
