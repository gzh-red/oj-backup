<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Training with Doors - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573395710:9bdopbIec7dmQLYb8KBDRCUR5pn+MAvcsy2cBZkk9PI=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Col.%20Sheffard%20is%20going%20to%20make%20a%20training%20for%20Cpt.%20Plice.%20The%20colonel%20has%20a%20polygon%20containing%20infinite%20number%20of%20closed%20doors%20placed%20one%20by%20one%20in%20a%20row.%20Initially%20Cpt.%20Plice%20stands%20in%20front%20of%20the%20first%20door.%20The%20captain%20is%20able%20to%20perform%20the%20following%20two%20commands%3A%5Cn%5Cn-%20open%20the%20first%20closed%20door%20and%20go%20to%20the%20front%20of%20the%20next%20closed%20door%20%28mark%20this%20command%20as%20%27%28%27%20%29%2C%5Cn-%20go%20to%20the%20front%20of%20the%20last%20of%20currently%20opened%20doors%20and%20close%20it%20%28mark%20this%20command%20as%20%27%29%27%20%29.%5Cn%5CnA%20sequence%20of%20commands%20is%20valid%20if%20the%20following%20conditions%20are%20met%3A%5Cn%5Cn-%20there%20is%20at%20least%20one%20opened%20door%20when%20the%20command%20%27%29%27%20should%20be%20performed%20%28in%20particular%2C%20the%20first%20command%20shouldn%27t%20be%20%27%29%27%29%2C%5Cn-%20all%20the%20doors%20are%20closed%20after%20performing%20all%20commands%20from%20the%20sequence%20%28the%20captain%20stands%20in%20front%20of%20the%20first%20door%29.%5Cn%5CnCol.%20Sheffard%20received%20a%20template%20%5Cu2014%20a%20rectangular%20grid%20with%20%24%20n%20%24%20rows%20and%20%24%20m%20%24%20columns%20where%20each%20cell%20contains%20one%20of%20the%20commands%2C%20i.e.%20%27%28%27%20or%20%27%29%27.%20The%20colonel%20has%20to%20choose%20a%20training%20plan%20for%20the%20captain%20%5Cu2014%20select%20a%20non-empty%20rectangle%20from%20the%20grid%2C%20each%20row%20of%20the%20rectangle%20will%20be%20an%20independent%20training%20for%20the%20captain.%20The%20training%20plan%20is%20valid%2C%20if%20each%20row%20of%20the%20selected%20rectangle%20is%20a%20valid%20sequence%20of%20commands.%5Cn%5CnYou%20are%20to%20find%20the%20number%20of%20ways%20to%20select%20a%20valid%20training%20plan%20for%20a%20given%20grid.%20The%20selected%20rectangle%20should%20be%20continuous%2C%20i.e.%20without%20holes.%20Plans%20are%20different%20if%20they%20have%20different%20positions%20of%20their%20corners%20even%20if%20their%20contents%20are%20the%20same.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20two%20integers%20%24%20n%20%24%20and%20%24%20m%20%24%20%28%20%24%201%3C%3Dn%2Cm%3C%3D50000%20%24%20%29%20%5Cu2014%20number%20of%20rows%20and%20number%20of%20columns%20in%20the%20template%20respectively.%20Each%20of%20the%20following%20%24%20n%20%24%20lines%20contains%20a%20string%20with%20%24%20m%20%24%20symbols%20%27%28%27%20or%20%27%29%27%20%5Cu2014%20commands%20of%20the%20template.%20The%20total%20number%20of%20elements%20in%20the%20template%20doesn%27t%20exceed%20%24%2010%5E%7B6%7D%20%24%20.%22%2C%22outputFormat%22%3A%22Output%20a%20single%20integer%20%5Cu2014%20the%20number%20of%20rectangles%20on%20the%20template%2C%20corresponding%20to%20a%20valid%20training%20plan.%20Two%20rectangles%20with%20equal%20content%20but%20different%20positions%20of%20corners%20should%20be%20counted%20both.%22%2C%22samples%22%3A%5B%5B%221%205%5Cn%28%28%29%28%29%5Cn%22%2C%223%5Cn%22%5D%2C%5B%223%202%5Cn%28%29%5Cn%28%29%5Cn%28%29%5Cn%22%2C%226%5Cn%22%5D%2C%5B%224%204%5Cn%28%29%28%29%5Cn%28%29%28%29%5Cn%29%28%29%28%5Cn%28%29%28%29%5Cn%22%2C%2213%5Cn%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B4000%5D%2C%22memory%22%3A%5B512000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F589%5C%2FE%22%2C%22id%22%3A%22589E%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22CF589E%22%2C%22title%22%3A%22Training%20with%20Doors%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Training%20with%20Doors%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573306449;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Training with Doors</h1>
<h2>题目描述</h2>
<div>Col. Sheffard is going to make a training for Cpt. Plice. The colonel has a polygon containing infinite number of closed doors placed one by one in a row. Initially Cpt. Plice stands in front of the first door. The captain is able to perform the following two commands:
- open the first closed door and go to the front of the next closed door (mark this command as '(' ),
- go to the front of the last of currently opened doors and close it (mark this command as ')' ).
A sequence of commands is valid if the following conditions are met:
- there is at least one opened door when the command ')' should be performed (in particular, the first command shouldn't be ')'),
- all the doors are closed after performing all commands from the sequence (the captain stands in front of the first door).
Col. Sheffard received a template — a rectangular grid with $ n $ rows and $ m $ columns where each cell contains one of the commands, i.e. '(' or ')'. The colonel has to choose a training plan for the captain — select a non-empty rectangle from the grid, each row of the rectangle will be an independent training for the captain. The training plan is valid, if each row of the selected rectangle is a valid sequence of commands.
You are to find the number of ways to select a valid training plan for a given grid. The selected rectangle should be continuous, i.e. without holes. Plans are different if they have different positions of their corners even if their contents are the same.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains two integers $ n $ and $ m $ ( $ 1<=n,m<=50000 $ ) — number of rows and number of columns in the template respectively. Each of the following $ n $ lines contains a string with $ m $ symbols '(' or ')' — commands of the template. The total number of elements in the template doesn't exceed $ 10^{6} $ .</div>
<h3>输出格式</h3>
<br />
<div>Output a single integer — the number of rectangles on the template, corresponding to a valid training plan. Two rectangles with equal content but different positions of corners should be counted both.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>1 5
(()()
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>3
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>3 2
()
()
()
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>6
</code></pre>
<h3>输入样例 #3</h3>
<pre><code>4 4
()()
()()
)()(
()()
</code></pre>
<h3>输出样例 #3</h3>
<pre><code>13
</code></pre>
</article>
</div>
</div>
</body>
</html>
