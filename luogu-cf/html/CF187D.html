<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>BRT Contract - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573391556:XYOsvXlpp3OP7pOHYk7hk/OsnSENIV0OCYkIUhjU/1w=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22In%20the%20last%20war%20of%20PMP%2C%20he%20defeated%20all%20his%20opponents%20and%20advanced%20to%20the%20final%20round.%20But%20after%20the%20end%20of%20semi-final%20round%20evil%20attacked%20him%20from%20behind%20and%20killed%20him%21%20God%20bless%20him.%5Cn%5CnBefore%20his%20death%2C%20PMP%20signed%20a%20contract%20with%20the%20bus%20rapid%20transit%20%28BRT%29%20that%20improves%20public%20transportations%20by%20optimizing%20time%20of%20travel%20estimation.%20You%20should%20help%20PMP%20finish%20his%20last%20contract.%5Cn%5CnEach%20BRT%20line%20is%20straight%20line%20that%20passes%20%24%20n%20%24%20intersecting%20on%20its%20ways.%20At%20each%20intersection%20there%20is%20traffic%20light%20that%20periodically%20cycles%20between%20green%20and%20red.%20It%20starts%20illuminating%20green%20at%20time%20zero.%20During%20the%20green%20phase%20which%20lasts%20for%20%24%20g%20%24%20seconds%2C%20traffic%20is%20allowed%20to%20proceed.%20After%20the%20green%20phase%20the%20light%20changes%20to%20red%20and%20remains%20in%20this%20color%20for%20%24%20r%20%24%20seconds.%20During%20the%20red%20phase%20traffic%20is%20prohibited%20from%20proceeding.%20If%20a%20vehicle%20reaches%20the%20intersection%20exactly%20at%20a%20time%20when%20the%20light%20changes%20to%20red%2C%20it%20should%20stop%2C%20but%20the%20vehicle%20is%20clear%20to%20proceed%20if%20the%20light%20has%20just%20changed%20to%20green.%5Cn%5Cn%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF187D%5C%2F62435a41fe7e90193c8a9b88800f99834c7d7ef9.png%29All%20traffic%20lights%20have%20the%20same%20timing%20and%20are%20synchronized.%20In%20other%20words%20the%20period%20of%20red%20%28and%20green%29%20phase%20is%20the%20same%20for%20all%20of%20traffic%20lights%20and%20they%20all%20start%20illuminating%20green%20at%20time%20zero.%5Cn%5CnThe%20BRT%20Company%20has%20calculated%20the%20time%20that%20a%20bus%20requires%20to%20pass%20each%20road%20segment.%20A%20road%20segment%20is%20the%20distance%20between%20two%20consecutive%20traffic%20lights%20or%20between%20a%20traffic%20light%20and%20source%20%28or%20destination%29%20station.%20More%20precisely%20BRT%20specialists%20provide%20%24%20n%2B1%20%24%20positive%20integers%20%24%20l_%7Bi%7D%20%24%20%2C%20the%20time%20in%20seconds%20that%20a%20bus%20needs%20to%20traverse%20%24%20i%20%24%20-th%20road%20segment%20in%20the%20path%20from%20source%20to%20destination.%20The%20%24%20l_%7B1%7D%20%24%20value%20denotes%20the%20time%20that%20a%20bus%20needs%20to%20pass%20the%20distance%20between%20source%20and%20the%20first%20intersection.%20The%20%24%20l_%7Bn%2B1%7D%20%24%20value%20denotes%20the%20time%20between%20the%20last%20intersection%20and%20destination.%5Cn%5CnIn%20one%20day%20%24%20q%20%24%20buses%20leave%20the%20source%20station.%20The%20%24%20i%20%24%20-th%20bus%20starts%20from%20source%20at%20time%20%24%20t_%7Bi%7D%20%24%20%28in%20seconds%29.%20Decision%20makers%20of%20BRT%20Company%20want%20to%20know%20what%20time%20a%20bus%20gets%20to%20destination%3F%5Cn%5CnThe%20bus%20is%20considered%20as%20point.%20A%20bus%20will%20always%20move%20if%20it%20can.%20The%20buses%20do%20not%20interfere%20with%20each%20other.%22%2C%22inputFormat%22%3A%22The%20first%20line%20of%20input%20contains%20three%20space-separated%20positive%20integers%20%24%20n%2Cg%2Cr%20%24%20%28%20%24%201%3C%3Dn%3C%3D10%5E%7B5%7D%2C2%3C%3Dg%2Br%3C%3D10%5E%7B9%7D%20%24%20%29%20%5Cu2014%20the%20number%20of%20intersections%2C%20duration%20of%20green%20phase%20and%20duration%20of%20red%20phase.%20Next%20line%20contains%20%24%20n%2B1%20%24%20integers%20%24%20l_%7Bi%7D%20%24%20%28%20%24%201%3C%3Dl_%7Bi%7D%3C%3D10%5E%7B9%7D%20%24%20%29%20%5Cu2014%20the%20time%20to%20pass%20the%20%24%20i%20%24%20-th%20road%20segment%20in%20the%20path%20from%20source%20to%20destination.%5Cn%5CnNext%20line%20contains%20a%20single%20integer%20%24%20q%20%24%20%28%20%24%201%3C%3Dq%3C%3D10%5E%7B5%7D%20%24%20%29%20%5Cu2014%20the%20number%20of%20buses%20in%20a%20day.%20The%20%24%20i%20%24%20-th%20of%20next%20%24%20q%20%24%20lines%20contains%20a%20single%20integer%20%24%20t_%7Bi%7D%20%24%20%28%20%24%201%3C%3Dt_%7Bi%7D%3C%3D10%5E%7B9%7D%20%24%20%29%20%5Cu2014%20the%20time%20when%20%24%20i%20%24%20-th%20bus%20leaves%20the%20source%20station.%22%2C%22outputFormat%22%3A%22In%20the%20%24%20i%20%24%20-th%20line%20of%20output%20you%20should%20print%20a%20single%20integer%20%5Cu2014%20the%20time%20that%20%24%20i%20%24%20-th%20bus%20gets%20to%20destination.%5Cn%5CnPlease%20do%20not%20use%20the%20%25lld%20specifier%20to%20read%20or%20write%2064-bit%20integers%20in%20%5Cu0421%2B%2B.%20It%20is%20preferred%20to%20use%20cin%2C%20cout%20streams%20or%20the%20%25I64d%20specifier.%22%2C%22samples%22%3A%5B%5B%221%203%202%5Cn5%202%5Cn5%5Cn1%5Cn2%5Cn3%5Cn4%5Cn5%5Cn%22%2C%228%5Cn9%5Cn12%5Cn12%5Cn12%5Cn%22%5D%2C%5B%225%203%207%5Cn10%201%201%208%20900000005%201000000000%5Cn3%5Cn1%5Cn10%5Cn1000000000%5Cn%22%2C%221900000040%5Cn1900000040%5Cn2900000030%5Cn%22%5D%5D%2C%22hint%22%3A%22In%20the%20first%20sample%2C%20buses%20%231%2C%20%232%20and%20%235%20will%20reach%20the%20destination%20without%20waiting%20behind%20the%20red%20light.%20But%20buses%20%233%20and%20%234%20should%20wait.%5Cn%5CnIn%20the%20second%20sample%2C%20first%20bus%20should%20wait%20at%20third%2C%20fourth%20and%20fifth%20intersections.%20Second%20and%20third%20buses%20should%20wait%20only%20at%20the%20fifth%20intersection.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F187%5C%2FD%22%2C%22id%22%3A%22187D%22%7D%2C%22translation%22%3A%22%5Cu6cf0%5Cu8fea%5Cu6bcf%5Cu5929%5Cu90fd%5Cu8981%5Cu901a%5Cu8fc7%5Cu4e00%5Cu6761%5Cu8def%5Cu4ece%5Cu5bb6%5Cu5230%5Cu5b66%5Cu6821%5Cuff0c%5Cu8fd9%5Cu6761%5Cu8def%5Cu7684%5Cu8d77%5Cu70b9%5Cu662f%5Cu6cf0%5Cu8fea%5Cu5bb6%5Cuff0c%5Cu7ec8%5Cu70b9%5Cu5219%5Cu662f%5Cu5b66%5Cu6821%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu8fd9%5Cu6761%5Cu8def%5Cu4e2d%5Cu95f4%5Cu8fd8%5Cu6709%20%24n%24%20%5Cu4e2a%5Cu8def%5Cu53e3%5Cuff0c%5Cu4ece%5Cu7b2c%20%24i%20-%201%24%20%5Cu4e2a%5Cu8def%5Cu53e3%5Cu8d70%5Cu5230%5Cu7b2c%20%24i%24%20%5Cu4e2a%5Cu8def%5Cu53e3%5Cu9700%5Cu8981%20%24d_i%24%20%5Cu79d2%5Cuff0c%5Cu6bcf%5Cu4e2a%5Cu8def%5Cu53e3%5Cu90fd%5Cu6709%5Cu4e00%5Cu4e2a%5Cu7ea2%5Cu7eff%5Cu706f%5Cu3002%5Cu66f4%5Cu5177%5Cu4f53%5Cu5730%5Cuff0c%5Cu7eff%5Cu706f%5Cu6301%5Cu7eed%5Cu65f6%5Cu95f4%5Cu662f%20%24g%24%20%5Cu79d2%5Cuff0c%5Cu7ea2%5Cu706f%5Cu6301%5Cu7eed%5Cu65f6%5Cu95f4%5Cu662f%20%24r%24%20%5Cu79d2%5Cu3002%5Cu6bcf%5Cu5929%5Cu4ece%5Cu7b2c%20%240%24%20%5Cu79d2%5Cu5f00%5Cu59cb%5Cuff0c%5Cu6240%5Cu6709%5Cu706f%5Cu90fd%5Cu662f%5Cu7eff%5Cu706f%5Cuff0c%5Cu6301%5Cu7eed%20%24g%24%20%5Cu79d2%5Cu4e4b%5Cu540e%5Cu53d8%5Cu4e3a%5Cu7ea2%5Cu706f%5Cuff0c%5Cu518d%5Cu8fc7%20%24r%24%20%5Cu79d2%5Cu53d8%5Cu6210%5Cu7eff%5Cu706f%5Cuff0c%5Cu4ee5%5Cu6b64%5Cu7c7b%5Cu63a8%5Cuff0c%5Cu5e76%5Cu4e14%5Cu540c%5Cu4e00%5Cu65f6%5Cu523b%5Cu6240%5Cu6709%5Cu706f%5Cu90fd%5Cu662f%5Cu76f8%5Cu540c%5Cu72b6%5Cu6001%5Cu3002%5Cu5f53%5Cu6cf0%5Cu8fea%5Cu5230%5Cu8fbe%5Cu4e00%5Cu4e2a%5Cu8def%5Cu53e3%5Cuff0c%5Cu82e5%5Cu662f%5Cu7eff%5Cu706f%5Cu5219%5Cu53ef%5Cu76f4%5Cu63a5%5Cu901a%5Cu8fc7%5Cuff0c%5Cu82e5%5Cu662f%5Cu7ea2%5Cu706f%5Cu5219%5Cu9700%5Cu539f%5Cu5730%5Cu7b49%5Cu5f85%5Cu81f3%5Cu7eff%5Cu706f%5Cu3002%5Cu82e5%5Cu5230%5Cu8fbe%5Cu67d0%5Cu4e00%5Cu8def%5Cu53e3%5Cu65f6%5Cu706f%5Cu7684%5Cu72b6%5Cu6001%5Cu6b63%5Cu597d%5Cu53d1%5Cu751f%5Cu6539%5Cu53d8%5Cuff0c%5Cu5219%5Cu89c6%5Cu5230%5Cu8fbe%5Cu8def%5Cu53e3%5Cu65f6%5Cu706f%5Cu7684%5Cu989c%5Cu8272%5Cu4e3a%5Cu5176%5Cu6539%5Cu53d8%5Cu540e%5Cu7684%5Cu989c%5Cu8272%5Cuff0c%5Cu4f8b%5Cu5982%5Cu7b2c%20%24g%24%20%5Cu79d2%5Cu5230%5Cu8fbe%5Cu4e00%5Cu4e2a%5Cu8def%5Cu53e3%5Cu5219%5Cu89c6%5Cu4e3a%5Cu9047%5Cu5230%5Cu7ea2%5Cu706f%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu73b0%5Cu5728%5Cu6cf0%5Cu8fea%5Cu9884%5Cu8ba1%5Cu4e86%5Cu63a5%5Cu4e0b%5Cu6765%20%24q%24%20%5Cu5929%5Cu4ece%5Cu5bb6%5Cu51fa%5Cu53d1%5Cu7684%5Cu65f6%5Cu95f4%5Cuff0c%5Cu7b2c%20%24j%24%20%5Cu5929%5Cu5c06%5Cu4f1a%5Cu5728%5Cu7b2c%20%24t_j%24%20%5Cu79d2%5Cu4ece%5Cu5bb6%5Cu51fa%5Cu53d1%5Cuff0c%5Cu4ed6%5Cu5e0c%5Cu671b%5Cu4f60%5Cu544a%5Cu8bc9%5Cu4ed6%5Cu6bcf%5Cu5929%5Cu5230%5Cu8fbe%5Cu5b66%5Cu6821%5Cu7684%5Cu6700%5Cu65e9%5Cu65f6%5Cu95f4%5Cu3002%5Cu4f60%5Cu53ef%5Cu4ee5%5Cu5047%5Cu5b9a%5Cu4e00%5Cu5929%5Cu5185%5Cu6cf0%5Cu8fea%5Cu4e00%5Cu5b9a%5Cu53ef%5Cu4ee5%5Cu5230%5Cu8fbe%5Cu5b66%5Cu6821%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu4fdd%5Cu8bc1%20%24n%2C%20q%20%5C%5Cleq%2010%5E5%2C%202%20%5C%5Cleq%20g%2C%20r%20%5C%5Cleq%2010%5E9%2C%20d_i%2C%20t_j%20%5C%5Cleq%2010%5E9%24%5Cu3002%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A10%2C%22totalAccepted%22%3A5%2C%22pid%22%3A%22CF187D%22%2C%22title%22%3A%22BRT%20Contract%20%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22BRT%20Contract%20%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573286098;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>BRT Contract </h1>
<h2>题意翻译</h2>
<div>泰迪每天都要通过一条路从家到学校，这条路的起点是泰迪家，终点则是学校。
这条路中间还有 $n$ 个路口，从第 $i - 1$ 个路口走到第 $i$ 个路口需要 $d_i$ 秒，每个路口都有一个红绿灯。更具体地，绿灯持续时间是 $g$ 秒，红灯持续时间是 $r$ 秒。每天从第 $0$ 秒开始，所有灯都是绿灯，持续 $g$ 秒之后变为红灯，再过 $r$ 秒变成绿灯，以此类推，并且同一时刻所有灯都是相同状态。当泰迪到达一个路口，若是绿灯则可直接通过，若是红灯则需原地等待至绿灯。若到达某一路口时灯的状态正好发生改变，则视到达路口时灯的颜色为其改变后的颜色，例如第 $g$ 秒到达一个路口则视为遇到红灯。
现在泰迪预计了接下来 $q$ 天从家出发的时间，第 $j$ 天将会在第 $t_j$ 秒从家出发，他希望你告诉他每天到达学校的最早时间。你可以假定一天内泰迪一定可以到达学校。
保证 $n, q \leq 10^5, 2 \leq g, r \leq 10^9, d_i, t_j \leq 10^9$。</div>
<h2>题目描述</h2>
<div>In the last war of PMP, he defeated all his opponents and advanced to the final round. But after the end of semi-final round evil attacked him from behind and killed him! God bless him.
Before his death, PMP signed a contract with the bus rapid transit (BRT) that improves public transportations by optimizing time of travel estimation. You should help PMP finish his last contract.
Each BRT line is straight line that passes $ n $ intersecting on its ways. At each intersection there is traffic light that periodically cycles between green and red. It starts illuminating green at time zero. During the green phase which lasts for $ g $ seconds, traffic is allowed to proceed. After the green phase the light changes to red and remains in this color for $ r $ seconds. During the red phase traffic is prohibited from proceeding. If a vehicle reaches the intersection exactly at a time when the light changes to red, it should stop, but the vehicle is clear to proceed if the light has just changed to green.
![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF187D/62435a41fe7e90193c8a9b88800f99834c7d7ef9.png)All traffic lights have the same timing and are synchronized. In other words the period of red (and green) phase is the same for all of traffic lights and they all start illuminating green at time zero.
The BRT Company has calculated the time that a bus requires to pass each road segment. A road segment is the distance between two consecutive traffic lights or between a traffic light and source (or destination) station. More precisely BRT specialists provide $ n+1 $ positive integers $ l_{i} $ , the time in seconds that a bus needs to traverse $ i $ -th road segment in the path from source to destination. The $ l_{1} $ value denotes the time that a bus needs to pass the distance between source and the first intersection. The $ l_{n+1} $ value denotes the time between the last intersection and destination.
In one day $ q $ buses leave the source station. The $ i $ -th bus starts from source at time $ t_{i} $ (in seconds). Decision makers of BRT Company want to know what time a bus gets to destination?
The bus is considered as point. A bus will always move if it can. The buses do not interfere with each other.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line of input contains three space-separated positive integers $ n,g,r $ ( $ 1<=n<=10^{5},2<=g+r<=10^{9} $ ) — the number of intersections, duration of green phase and duration of red phase. Next line contains $ n+1 $ integers $ l_{i} $ ( $ 1<=l_{i}<=10^{9} $ ) — the time to pass the $ i $ -th road segment in the path from source to destination.
Next line contains a single integer $ q $ ( $ 1<=q<=10^{5} $ ) — the number of buses in a day. The $ i $ -th of next $ q $ lines contains a single integer $ t_{i} $ ( $ 1<=t_{i}<=10^{9} $ ) — the time when $ i $ -th bus leaves the source station.</div>
<h3>输出格式</h3>
<br />
<div>In the $ i $ -th line of output you should print a single integer — the time that $ i $ -th bus gets to destination.
Please do not use the %lld specifier to read or write 64-bit integers in С++. It is preferred to use cin, cout streams or the %I64d specifier.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>1 3 2
5 2
5
1
2
3
4
5
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>8
9
12
12
12
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>5 3 7
10 1 1 8 900000005 1000000000
3
1
10
1000000000
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>1900000040
1900000040
2900000030
</code></pre>
<h2>说明</h2>
<div>In the first sample, buses #1, #2 and #5 will reach the destination without waiting behind the red light. But buses #3 and #4 should wait.
In the second sample, first bus should wait at third, fourth and fifth intersections. Second and third buses should wait only at the fifth intersection.</div>
</article>
</div>
</div>
</body>
</html>
