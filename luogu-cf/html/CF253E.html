<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Printer - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573392088:HB2WAv1uqshS9LN4Cf0w6z3KqEXOSLtgbTmd2rxLX2E=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%22%2C%22description%22%3A%22Let%27s%20consider%20a%20network%20printer%20that%20functions%20like%20that.%20It%20starts%20working%20at%20time%200.%20In%20each%20second%20it%20can%20print%20one%20page%20of%20a%20text.%20At%20some%20moments%20of%20time%20the%20printer%20receives%20printing%20tasks.%20We%20know%20that%20a%20printer%20received%20%24%20n%20%24%20tasks.%20Let%27s%20number%20the%20tasks%20by%20consecutive%20integers%20from%201%20to%20%24%20n%20%24%20.%20Then%20the%20task%20number%20%24%20i%20%24%20is%20characterised%20by%20three%20integers%3A%20%24%20t_%7Bi%7D%20%24%20is%20the%20time%20when%20the%20task%20came%2C%20%24%20s_%7Bi%7D%20%24%20is%20the%20task%27s%20volume%20%28in%20pages%29%20and%20%24%20p_%7Bi%7D%20%24%20is%20the%20task%27s%20priority.%20The%20priorities%20of%20all%20tasks%20are%20distinct.%5Cn%5CnWhen%20the%20printer%20receives%20a%20task%2C%20the%20task%20goes%20to%20the%20queue%20and%20remains%20there%20until%20all%20pages%20from%20this%20task%20are%20printed.%20The%20printer%20chooses%20a%20page%20to%20print%20each%20time%20when%20it%20either%20stops%20printing%20some%20page%20or%20when%20it%20is%20free%20and%20receives%20a%20new%20task.%20Among%20all%20tasks%20that%20are%20in%20the%20queue%20at%20this%20moment%2C%20the%20printer%20chooses%20the%20task%20with%20the%20highest%20priority%20and%20next%20second%20prints%20an%20unprinted%20page%20from%20this%20task.%20You%20can%20assume%20that%20a%20task%20goes%20to%20the%20queue%20immediately%2C%20that%27s%20why%20if%20a%20task%20has%20just%20arrived%20by%20time%20%24%20t%20%24%20%2C%20the%20printer%20can%20already%20choose%20it%20for%20printing.%5Cn%5CnYou%20are%20given%20full%20information%20about%20all%20tasks%20except%20for%20one%3A%20you%20don%27t%20know%20this%20task%27s%20priority.%20However%2C%20we%20know%20the%20time%20when%20the%20last%20page%20from%20this%20task%20was%20finished%20printing.%20Given%20this%20information%2C%20find%20the%20unknown%20priority%20value%20and%20determine%20the%20moments%20of%20time%20when%20the%20printer%20finished%20printing%20each%20task.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20integer%20%24%20n%20%24%20%28%20%24%201%3C%3Dn%3C%3D50000%20%24%20%29.%20Next%20%24%20n%20%24%20lines%20describe%20the%20tasks.%20The%20%24%20i%20%24%20-th%20of%20these%20lines%20contains%20three%20integers%20%24%20t_%7Bi%7D%20%24%20%2C%20%24%20s_%7Bi%7D%20%24%20and%20%24%20p_%7Bi%7D%20%24%20%2C%20separated%20by%20single%20spaces%20%28%20%24%200%3C%3Dt_%7Bi%7D%3C%3D10%5E%7B9%7D%2C1%3C%3Ds_%7Bi%7D%2Cp_%7Bi%7D%3C%3D10%5E%7B9%7D%20%24%20%29.%20Exactly%20one%20task%20%28let%27s%20assume%20that%20his%20number%20is%20%24%20x%20%24%20%29%20has%20number%20-1%20written%20instead%20of%20the%20priority.%20All%20priorities%20are%20different.%20The%20last%20line%20contains%20integer%20%24%20T%20%24%20%5Cu2014%20the%20time%20when%20the%20printer%20finished%20printing%20the%20last%20page%20of%20task%20%24%20x%20%24%20%28%20%24%201%3C%3DT%3C%3D10%5E%7B15%7D%20%24%20%29.%20Numbers%20%24%20t_%7Bi%7D%20%24%20are%20not%20necessarily%20distinct.%20The%20tasks%20in%20the%20input%20are%20written%20in%20the%20arbitrary%20order.%22%2C%22outputFormat%22%3A%22In%20the%20first%20line%20print%20integer%20%24%20p_%7Bx%7D%20%24%20%5Cu2014%20the%20priority%20of%20the%20task%20number%20%24%20x%20%24%20%28%20%24%201%3C%3Dp_%7Bx%7D%3C%3D10%5E%7B9%7D%20%24%20%2C%20remember%20that%20all%20priorities%20should%20be%20distinct%29.%20Then%20print%20%24%20n%20%24%20integers%2C%20the%20%24%20i%20%24%20-th%20of%20them%20represents%20the%20moment%20of%20time%20when%20the%20last%20page%20of%20the%20task%20number%20%24%20i%20%24%20finished%20printing.%5Cn%5CnIt%20is%20guaranteed%20that%20at%20least%20one%20solution%20exists.%20If%20there%20are%20multiple%20solutions%2C%20print%20any%20of%20them.%22%2C%22samples%22%3A%5B%5B%223%5Cn4%203%20-1%5Cn0%202%202%5Cn1%203%203%5Cn7%5Cn%22%2C%224%5Cn7%208%204%5Cn%22%5D%2C%5B%223%5Cn3%201%202%5Cn2%203%203%5Cn3%201%20-1%5Cn4%5Cn%22%2C%224%5Cn7%206%204%5Cn%22%5D%5D%2C%22hint%22%3A%22Let%27s%20consider%20the%20first%20test%20case.%20Let%27s%20assume%20that%20the%20unknown%20priority%20equals%204%2C%20then%20the%20printer%27s%20actions%20for%20each%20second%20are%20as%20follows%3A%5Cn%5Cn-%20the%20beginning%20of%20the%201-st%20second%20%28time%200%29.%20The%20queue%20has%20task%202.%20The%20printer%20prints%20the%20first%20page%20of%20this%20task%3B%5Cn-%20the%20beginning%20of%20the%202-nd%20second%20%28time%201%29.%20The%20queue%20has%20tasks%202%20and%203.%20The%20printer%20prints%20the%20first%20page%20of%20task%203%3B%5Cn-%20the%20beginning%20of%20the%203-rd%20second%20%28time%202%29.%20The%20queue%20has%20tasks%202%20and%203.%20The%20printer%20prints%20the%20second%20page%20of%20task%203%3B%5Cn-%20the%20beginning%20of%20the%204-th%20second%20%28time%203%29.%20The%20queue%20has%20tasks%202%20and%203.%20The%20printer%20prints%20the%20third%20%28last%29%20page%20of%20task%203.%20Thus%2C%20by%20the%20end%20of%20the%204-th%20second%20this%20task%20will%20have%20been%20printed%3B%5Cn-%20the%20beginning%20of%20the%205-th%20second%20%28time%204%29.%20The%20queue%20has%20tasks%202%20and%201.%20The%20printer%20prints%20the%20first%20page%20of%20task%201%3B%5Cn-%20the%20beginning%20of%20the%206-th%20second%20%28time%205%29.%20The%20queue%20has%20tasks%202%20and%201.%20The%20printer%20prints%20the%20second%20page%20of%20task%201%3B%5Cn-%20the%20beginning%20of%20the%207-th%20second%20%28time%206%29.%20The%20queue%20has%20tasks%202%20and%201.%20The%20printer%20prints%20the%20third%20%28last%29%20page%20of%20task%201.%20Thus%2C%20by%20the%20end%20of%20the%207-th%20second%20this%20task%20will%20have%20been%20printed%3B%5Cn-%20the%20beginning%20of%20the%208-th%20second%20%28time%207%29.%20The%20queue%20has%20task%202.%20The%20printer%20prints%20the%20second%20%28last%29%20page%20of%20task%202.%20Thus%2C%20by%20the%20end%20of%20the%208-th%20second%20this%20task%20will%20have%20been%20printed.%5Cn%5CnIn%20the%20end%2C%20task%20number%201%20will%20have%20been%20printed%20by%20the%20end%20of%20the%207-th%20second%2C%20as%20was%20required.%20And%20tasks%202%20and%203%20are%20printed%20by%20the%20end%20of%20the%20of%20the%208-th%20and%20the%204-th%20second%20correspondingly.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B4000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F253%5C%2FE%22%2C%22id%22%3A%22253E%22%7D%2C%22translation%22%3A%22%24%20n%24%5Cu4e2a%5Cu4efb%5Cu52a1%5Cuff0c%5Cu6bcf%5Cu4e2a%5Cu4efb%5Cu52a1%5Cu7ed9%5Cu51fa%24%20t_i%2Cs_i%2Cp_i%24%2C%5Cu5206%5Cu522b%5Cu8868%5Cu793a%5Cuff0c%5Cu5f00%5Cu59cb%5Cu65f6%5Cu95f4%5Cuff0c%5Cu6240%5Cu9700%5Cu8017%5Cu65f6%5Cu548c%5Cu4f18%5Cu5148%5Cu7ea7%5Cuff0c%5Cu5176%5Cu4e2d%5Cu4f18%5Cu5148%5Cu7ea7%5Cu5404%5Cu4e0d%5Cu76f8%5Cu540c%20%20%5Cn%5Cu6709%5Cu4e00%5Cu4e2a%5Cu6253%5Cu5370%5Cu673a%5Cuff0c%5Cu6bcf%5Cu4e2a%5Cu65f6%5Cu523b%5Cu4f1a%5Cu4ece%5Cu5df2%5Cu7ecf%5Cu5f00%5Cu59cb%5Cu7684%5Cu4efb%5Cu52a1%5Cu4e2d%5Cu9009%5Cu4e00%5Cu4e2a%5Cu4f18%5Cu5148%5Cu7ea7%5Cu6700%5Cu9ad8%5Cu7684%5Cu4efb%5Cu52a1%5Cu82b1%5Cu8d39%5Cu65f6%5Cu95f4%5Cu5b9e%5Cu73b0%5Cuff0c%5Cu73b0%5Cu5728%5Cu6070%5Cu597d%5Cu6709%5Cu4e00%5Cu4e2a%5Cu4efb%5Cu52a1%5Cu4e0d%5Cu77e5%5Cu9053%5Cu4f18%5Cu5148%5Cu7ea7%5Cuff0c%5Cu4f46%5Cu4f60%5Cu77e5%5Cu9053%5Cu5b8c%5Cu6210%5Cu8fd9%5Cu4e2a%5Cu4efb%5Cu52a1%5Cu7684%5Cu65f6%5Cu523b%5Cuff0c%5Cu6c42%5Cu51fa%5Cu8fd9%5Cu4e2a%5Cu4efb%5Cu52a1%5Cu7684%5Cu4f18%5Cu5148%5Cu7ea7%5Cu548c%5Cu5176%5Cu4ed6%5Cu6240%5Cu6709%5Cu4efb%5Cu52a1%5Cu7684%5Cu5b8c%5Cu6210%5Cu65f6%5Cu95f4%5Cn%5CnTranslated%20by%20Fheiwn%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A31%2C%22totalAccepted%22%3A10%2C%22pid%22%3A%22CF253E%22%2C%22title%22%3A%22Printer%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A32418%2C%22title%22%3A%22%5Cu9898%5Cu610f%22%2C%22forum%22%3A%7B%22id%22%3A11595%2C%22name%22%3A%22CF253E%20Printer%22%2C%22slug%22%3A%22CF253E%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Printer%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573286098;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Printer</h1>
<h2>题意翻译</h2>
<div>$ n$个任务，每个任务给出$ t_i,s_i,p_i$,分别表示，开始时间，所需耗时和优先级，其中优先级各不相同
有一个打印机，每个时刻会从已经开始的任务中选一个优先级最高的任务花费时间实现，现在恰好有一个任务不知道优先级，但你知道完成这个任务的时刻，求出这个任务的优先级和其他所有任务的完成时间
Translated by Fheiwn</div>
<h2>题目描述</h2>
<div>Let's consider a network printer that functions like that. It starts working at time 0. In each second it can print one page of a text. At some moments of time the printer receives printing tasks. We know that a printer received $ n $ tasks. Let's number the tasks by consecutive integers from 1 to $ n $ . Then the task number $ i $ is characterised by three integers: $ t_{i} $ is the time when the task came, $ s_{i} $ is the task's volume (in pages) and $ p_{i} $ is the task's priority. The priorities of all tasks are distinct.
When the printer receives a task, the task goes to the queue and remains there until all pages from this task are printed. The printer chooses a page to print each time when it either stops printing some page or when it is free and receives a new task. Among all tasks that are in the queue at this moment, the printer chooses the task with the highest priority and next second prints an unprinted page from this task. You can assume that a task goes to the queue immediately, that's why if a task has just arrived by time $ t $ , the printer can already choose it for printing.
You are given full information about all tasks except for one: you don't know this task's priority. However, we know the time when the last page from this task was finished printing. Given this information, find the unknown priority value and determine the moments of time when the printer finished printing each task.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains integer $ n $ ( $ 1<=n<=50000 $ ). Next $ n $ lines describe the tasks. The $ i $ -th of these lines contains three integers $ t_{i} $ , $ s_{i} $ and $ p_{i} $ , separated by single spaces ( $ 0<=t_{i}<=10^{9},1<=s_{i},p_{i}<=10^{9} $ ). Exactly one task (let's assume that his number is $ x $ ) has number -1 written instead of the priority. All priorities are different. The last line contains integer $ T $ — the time when the printer finished printing the last page of task $ x $ ( $ 1<=T<=10^{15} $ ). Numbers $ t_{i} $ are not necessarily distinct. The tasks in the input are written in the arbitrary order.</div>
<h3>输出格式</h3>
<br />
<div>In the first line print integer $ p_{x} $ — the priority of the task number $ x $ ( $ 1<=p_{x}<=10^{9} $ , remember that all priorities should be distinct). Then print $ n $ integers, the $ i $ -th of them represents the moment of time when the last page of the task number $ i $ finished printing.
It is guaranteed that at least one solution exists. If there are multiple solutions, print any of them.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>3
4 3 -1
0 2 2
1 3 3
7
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>4
7 8 4
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>3
3 1 2
2 3 3
3 1 -1
4
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>4
7 6 4
</code></pre>
<h2>说明</h2>
<div>Let's consider the first test case. Let's assume that the unknown priority equals 4, then the printer's actions for each second are as follows:
- the beginning of the 1-st second (time 0). The queue has task 2. The printer prints the first page of this task;
- the beginning of the 2-nd second (time 1). The queue has tasks 2 and 3. The printer prints the first page of task 3;
- the beginning of the 3-rd second (time 2). The queue has tasks 2 and 3. The printer prints the second page of task 3;
- the beginning of the 4-th second (time 3). The queue has tasks 2 and 3. The printer prints the third (last) page of task 3. Thus, by the end of the 4-th second this task will have been printed;
- the beginning of the 5-th second (time 4). The queue has tasks 2 and 1. The printer prints the first page of task 1;
- the beginning of the 6-th second (time 5). The queue has tasks 2 and 1. The printer prints the second page of task 1;
- the beginning of the 7-th second (time 6). The queue has tasks 2 and 1. The printer prints the third (last) page of task 1. Thus, by the end of the 7-th second this task will have been printed;
- the beginning of the 8-th second (time 7). The queue has task 2. The printer prints the second (last) page of task 2. Thus, by the end of the 8-th second this task will have been printed.
In the end, task number 1 will have been printed by the end of the 7-th second, as was required. And tasks 2 and 3 are printed by the end of the of the 8-th and the 4-th second correspondingly.</div>
</article>
</div>
</div>
</body>
</html>
