<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Coprime Permutation - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573396792:cxyjn1O6+2EVAhUJZZSNn5ELgtjP1YvcjO1Xt4MMbHk=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Two%20positive%20integers%20are%20coprime%20if%20and%20only%20if%20they%20don%27t%20have%20a%20common%20divisor%20greater%20than%20%24%201%20%24%20.%5Cn%5CnSome%20bear%20doesn%27t%20want%20to%20tell%20Radewoosh%20how%20to%20solve%20some%20algorithmic%20problem.%20So%2C%20Radewoosh%20is%20going%20to%20break%20into%20that%20bear%27s%20safe%20with%20solutions.%20To%20pass%20through%20the%20door%2C%20he%20must%20enter%20a%20permutation%20of%20numbers%20%24%201%20%24%20through%20%24%20n%20%24%20.%20The%20door%20opens%20if%20and%20only%20if%20an%20entered%20permutation%20%24%20p_%7B1%7D%2Cp_%7B2%7D%2C...%2Cp_%7Bn%7D%20%24%20satisfies%3A%5Cn%5Cn%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF698F%5C%2F9d4538a9a97e6652f8a13f246927402ea6472421.png%29In%20other%20words%2C%20two%20different%20elements%20are%20coprime%20if%20and%20only%20if%20their%20indices%20are%20coprime.%5Cn%5CnSome%20elements%20of%20a%20permutation%20may%20be%20already%20fixed.%20In%20how%20many%20ways%20can%20Radewoosh%20fill%20the%20remaining%20gaps%20so%20that%20the%20door%20will%20open%3F%20Print%20the%20answer%20modulo%20%24%2010%5E%7B9%7D%2B7%20%24%20.%22%2C%22inputFormat%22%3A%22The%20first%20line%20of%20the%20input%20contains%20one%20integer%20%24%20n%20%24%20%28%20%24%202%3C%3Dn%3C%3D1000000%20%24%20%29.%5Cn%5CnThe%20second%20line%20contains%20%24%20n%20%24%20integers%20%24%20p_%7B1%7D%2Cp_%7B2%7D%2C...%2Cp_%7Bn%7D%20%24%20%28%20%24%200%3C%3Dp_%7Bi%7D%3C%3Dn%20%24%20%29%20where%20%24%20p_%7Bi%7D%3D0%20%24%20means%20a%20gap%20to%20fill%2C%20and%20%24%20p_%7Bi%7D%3E%3D1%20%24%20means%20a%20fixed%20number.%5Cn%5CnIt%27s%20guaranteed%20that%20if%20%24%20i%5Cu2260j%20%24%20and%20%24%20p_%7Bi%7D%2Cp_%7Bj%7D%3E%3D1%20%24%20then%20%24%20p_%7Bi%7D%5Cu2260p_%7Bj%7D%20%24%20.%22%2C%22outputFormat%22%3A%22Print%20the%20number%20of%20ways%20to%20fill%20the%20gaps%20modulo%20%24%2010%5E%7B9%7D%2B7%20%24%20%28i.e.%20modulo%20%24%201000000007%20%24%20%29.%22%2C%22samples%22%3A%5B%5B%224%5Cn0%200%200%200%5Cn%22%2C%224%5Cn%22%5D%2C%5B%225%5Cn0%200%201%202%200%5Cn%22%2C%222%5Cn%22%5D%2C%5B%226%5Cn0%200%201%202%200%200%5Cn%22%2C%220%5Cn%22%5D%2C%5B%225%5Cn5%203%204%202%201%5Cn%22%2C%220%5Cn%22%5D%5D%2C%22hint%22%3A%22In%20the%20first%20sample%20test%2C%20none%20of%20four%20element%20is%20fixed.%20There%20are%20four%20permutations%20satisfying%20the%20given%20conditions%3A%20%281%2C2%2C3%2C4%29%2C%20%281%2C4%2C3%2C2%29%2C%20%283%2C2%2C1%2C4%29%2C%20%283%2C4%2C1%2C2%29.%5Cn%5CnIn%20the%20second%20sample%20test%2C%20there%20must%20be%20%24%20p_%7B3%7D%3D1%20%24%20and%20%24%20p_%7B4%7D%3D2%20%24%20.%20The%20two%20permutations%20satisfying%20the%20conditions%20are%3A%20%283%2C4%2C1%2C2%2C5%29%2C%20%285%2C4%2C1%2C2%2C3%29.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F698%5C%2FF%22%2C%22id%22%3A%22698F%22%7D%2C%22translation%22%3A%22%5Cr%5Cn%5Cu5f53%5Cu4e14%5Cu4ec5%5Cu5f53%5Cu5b83%5Cu4eec%5Cu6ca1%5Cu6709%5Cu5927%5Cu4e8e%5Cu7684%5Cu516c%5Cu7ea6%5Cu6570%5Cu65f6%5Cuff0c%5Cu4e24%5Cu4e2a%5Cu6b63%5Cu6574%5Cu6570%5Cu624d%5Cu662f%5Cu4e92%5Cu8d28%5Cu7684%201%20.%5Cr%5Cn%5Cr%5Cn%5Cu6709%5Cu4e9b%5Cu718a%5Cu4e0d%5Cu60f3%5Cu544a%5Cu8bc9Radewoosh%5Cu5982%5Cu4f55%5Cu89e3%5Cu51b3%5Cu4e00%5Cu4e9b%5Cu7b97%5Cu6cd5%5Cu95ee%5Cu9898%5Cu3002%5Cu56e0%5Cu6b64%5Cuff0cRadewoosh%5Cu5c06%5Cu901a%5Cu8fc7%5Cu89e3%5Cu51b3%5Cu65b9%5Cu6848%5Cu6253%5Cu7834%5Cu8fd9%5Cu4e2a%5Cu718a%5Cu7684%5Cu5b89%5Cu5168%5Cu3002%5Cu8981%5Cu901a%5Cu8fc7%5Cu95e8%5Cuff0c%5Cu4ed6%5Cu5fc5%5Cu987b%5Cu8f93%5Cu5165%5Cu6570%5Cu5b57%5Cu7684%5Cu6392%5Cu5217%201%20%5Cu5230%20%20n%5Cu3002%5Cu5f53%5Cu4e14%5Cu4ec5%5Cu5f53%5Cu8f93%5Cu5165%5Cu7684%5Cu6392%5Cu5217%5Cu65f6%5Cuff0c%5Cu95e8%5Cu624d%5Cu4f1a%5Cu6253%5Cu5f00%20p%20%5Cr%5Cn1%5Cr%5Cn%5Cu200b%5Ct%20%2Cp%20%5Cr%5Cn2%5Cr%5Cn%5Cu200b%5Ct%20%2C...%2Cp%20%5Cr%5Cnn%5Cr%5Cn%20%20%5Cu6ee1%5Cu8db3%5Cuff1a%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.org%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF698F%5C%2F9d4538a9a97e6652f8a13f246927402ea6472421.png%29%5Cr%5Cn%5Cr%5Cn%5Cu6362%5Cu53e5%5Cu8bdd%5Cu8bf4%5Cuff0c%5Cu5f53%5Cu4e14%5Cu4ec5%5Cu5f53%5Cu5b83%5Cu4eec%5Cu7684%5Cu6307%5Cu6570%5Cu662f%5Cu4e92%5Cu8d28%5Cu7684%5Cu65f6%5Cuff0c%5Cu4e24%5Cu4e2a%5Cu4e0d%5Cu540c%5Cu7684%5Cu5143%5Cu7d20%5Cu662f%5Cu4e92%5Cu8d28%5Cu7684%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu6392%5Cu5217%5Cu7684%5Cu4e00%5Cu4e9b%5Cu5143%5Cu7d20%5Cu53ef%5Cu80fd%5Cu5df2%5Cu7ecf%5Cu88ab%5Cu4fee%5Cu590d%5Cu3002Radewoosh%5Cu5728%5Cu591a%5Cu5c11%5Cu65b9%5Cu9762%5Cu53ef%5Cu4ee5%5Cu586b%5Cu8865%5Cu5269%5Cu4f59%5Cu7684%5Cu7a7a%5Cu9699%5Cuff0c%5Cu4ee5%5Cu4fbf%5Cu95e8%5Cu6253%5Cu5f00%5Cuff1f%5Cu6253%5Cu5370%5Cu7b54%5Cu6848%5Cu6a21%5Cu6570%2010%5E%7B9%7D%2B7%20.%5Cr%5Cn%20%5Cr%5Cn%20%5Cu8f93%5Cu5165%5Cu7684%5Cu7b2c%5Cu4e00%5Cu884c%5Cu5305%5Cu542b%5Cu4e00%5Cu4e2a%5Cu6574%5Cu6570%20n%20%28%202%3C%3Dn%3C%3D1000000%202%3C%3Dn%3C%3D1000000%29%5Cu3002%5Cu7b2c%5Cu4e8c%5Cu884c%5Cu5305%5Cu542bn%5Cu4e2a%5Cu6574%5Cu6570%20p%201%5Cuff0cp%202%2C...%5Cuff0cp%20n%280%20%3C%20%3D%20p%20i%20%3C%20%3D%20n%29%5Cuff0c%5Cu5176%5Cu4e2d%20p%20i%20%3D%200%5Cu8868%5Cu793a%5Cu8981%5Cu586b%5Cu5145%5Cu7684%5Cu95f4%5Cu9699%5Cuff0cp%20i%20%3E%20%3D%201%5Cu8868%5Cu793a%5Cu56fa%5Cu5b9a%5Cu6570%5Cu5b57%5Cu3002%5Cu53ef%5Cu4ee5%5Cu4fdd%5Cu8bc1%5Cuff0c%5Cu5982%5Cu679ci%5Cu2260j%5Cu5e76%5Cu4e14%20p%20i%5Cuff0cp%20j%20%3E%3D%201%5Cuff0c%5Cu5219p%20i%20%5Cu2260p%20j%20%5Cu3002%5Cr%5Cn%20%5Cr%5Cn%20%5Cu6253%5Cu5370%5Cu586b%5Cu5145%5Cu6a21%5Cu6570%5Cu95f4%5Cu9699%5Cu7684%5Cu65b9%5Cu6cd5%5Cu6570%2010%5E%7B9%7D%2B7%5Cuff08%5Cu5373%5Cu8868%5Cu683c%201000000007%201000000007%20%29.%5Cr%5Cn%20%5Cr%5Cn%20%5Cu5728%5Cu7b2c%5Cu4e00%5Cu4e2a%5Cu6837%5Cu672c%5Cu6d4b%5Cu8bd5%5Cu4e2d%5Cuff0c%5Cu6ca1%5Cu6709%5Cu56db%5Cu4e2a%5Cu5143%5Cu7d20%5Cu662f%5Cu56fa%5Cu5b9a%5Cu7684%5Cu3002%5Cu6709%5Cu56db%5Cu79cd%5Cu6392%5Cu5217%5Cu6ee1%5Cu8db3%5Cu7ed9%5Cu5b9a%5Cu6761%5Cu4ef6%5Cuff1a%5Cuff081%2C2%2C3%2C4%5Cuff09%5Cuff0c%5Cuff081%2C4%2C3%2C2%5Cuff09%5Cuff0c%5Cuff083%2C2%2C1%2C4%5Cuff09%5Cuff0c%5Cuff083%2C4%2C1%2C2%5Cuff09%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu5728%5Cu7b2c%5Cu4e8c%5Cu4e2a%5Cu6837%5Cu672c%5Cu6d4b%5Cu8bd5%5Cu4e2d%5Cuff0c%5Cu5fc5%5Cu987b%5Cu6709%20p3%5Cr%5Cn%5Cu200b%5Ct%20%3D1%5Cu548c%20%20p4%5Cr%5Cn%5Cu200b%5Ct%20%3D2%5Cu3002%5Cu6ee1%5Cu8db3%5Cu6761%5Cu4ef6%5Cu7684%5Cu4e24%5Cu4e2a%5Cu6392%5Cu5217%5Cu662f%5Cuff1a%5Cuff083%2C4%2C1%2C2%2C5%5Cuff09%5Cuff0c%5Cuff085%2C4%2C1%2C2%2C3%5Cuff09%5Cu3002%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A1%2C%22totalAccepted%22%3A1%2C%22pid%22%3A%22CF698F%22%2C%22title%22%3A%22Coprime%20Permutation%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Coprime%20Permutation%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573306449;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Coprime Permutation</h1>
<h2>题意翻译</h2>
<div>
当且仅当它们没有大于的公约数时，两个正整数才是互质的 1 .
有些熊不想告诉Radewoosh如何解决一些算法问题。因此，Radewoosh将通过解决方案打破这个熊的安全。要通过门，他必须输入数字的排列 1 到 n。当且仅当输入的排列时，门才会打开 p
1
​ ,p
2
​ ,...,p
n
满足：![](https://cdn.luogu.org/upload/vjudge_pic/CF698F/9d4538a9a97e6652f8a13f246927402ea6472421.png)
换句话说，当且仅当它们的指数是互质的时，两个不同的元素是互质的。
排列的一些元素可能已经被修复。Radewoosh在多少方面可以填补剩余的空隙，以便门打开？打印答案模数 10^{9}+7 .
输入的第一行包含一个整数 n ( 2<=n<=1000000 2<=n<=1000000)。第二行包含n个整数 p 1，p 2,...，p n(0 < = p i < = n)，其中 p i = 0表示要填充的间隙，p i > = 1表示固定数字。可以保证，如果i≠j并且 p i，p j >= 1，则p i ≠p j 。
打印填充模数间隙的方法数 10^{9}+7（即表格 1000000007 1000000007 ).
在第一个样本测试中，没有四个元素是固定的。有四种排列满足给定条件：（1,2,3,4），（1,4,3,2），（3,2,1,4），（3,4,1,2）。
在第二个样本测试中，必须有 p3
​ =1和 p4
​ =2。满足条件的两个排列是：（3,4,1,2,5），（5,4,1,2,3）。</div>
<h2>题目描述</h2>
<div>Two positive integers are coprime if and only if they don't have a common divisor greater than $ 1 $ .
Some bear doesn't want to tell Radewoosh how to solve some algorithmic problem. So, Radewoosh is going to break into that bear's safe with solutions. To pass through the door, he must enter a permutation of numbers $ 1 $ through $ n $ . The door opens if and only if an entered permutation $ p_{1},p_{2},...,p_{n} $ satisfies:
![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF698F/9d4538a9a97e6652f8a13f246927402ea6472421.png)In other words, two different elements are coprime if and only if their indices are coprime.
Some elements of a permutation may be already fixed. In how many ways can Radewoosh fill the remaining gaps so that the door will open? Print the answer modulo $ 10^{9}+7 $ .</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line of the input contains one integer $ n $ ( $ 2<=n<=1000000 $ ).
The second line contains $ n $ integers $ p_{1},p_{2},...,p_{n} $ ( $ 0<=p_{i}<=n $ ) where $ p_{i}=0 $ means a gap to fill, and $ p_{i}>=1 $ means a fixed number.
It's guaranteed that if $ i≠j $ and $ p_{i},p_{j}>=1 $ then $ p_{i}≠p_{j} $ .</div>
<h3>输出格式</h3>
<br />
<div>Print the number of ways to fill the gaps modulo $ 10^{9}+7 $ (i.e. modulo $ 1000000007 $ ).</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>4
0 0 0 0
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>4
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>5
0 0 1 2 0
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>2
</code></pre>
<h3>输入样例 #3</h3>
<pre><code>6
0 0 1 2 0 0
</code></pre>
<h3>输出样例 #3</h3>
<pre><code>0
</code></pre>
<h3>输入样例 #4</h3>
<pre><code>5
5 3 4 2 1
</code></pre>
<h3>输出样例 #4</h3>
<pre><code>0
</code></pre>
<h2>说明</h2>
<div>In the first sample test, none of four element is fixed. There are four permutations satisfying the given conditions: (1,2,3,4), (1,4,3,2), (3,2,1,4), (3,4,1,2).
In the second sample test, there must be $ p_{3}=1 $ and $ p_{4}=2 $ . The two permutations satisfying the conditions are: (3,4,1,2,5), (5,4,1,2,3).</div>
</article>
</div>
</div>
</body>
</html>
