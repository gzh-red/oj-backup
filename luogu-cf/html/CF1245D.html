<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Shichikuji and Power Grid - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573403664:CjdE3hpm7aoxxeg8rooh4lEg6V8x/0rNSzZRMsAC2r0=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Shichikuji%20is%20the%20new%20resident%20deity%20of%20the%20South%20Black%20Snail%20Temple.%20Her%20first%20job%20is%20as%20follows%3A%5Cn%5CnThere%20are%20%24%20n%20%24%20new%20cities%20located%20in%20Prefecture%20X.%20Cities%20are%20numbered%20from%20%24%201%20%24%20to%20%24%20n%20%24%20.%20City%20%24%20i%20%24%20is%20located%20%24%20x_i%20%24%20km%20North%20of%20the%20shrine%20and%20%24%20y_i%20%24%20km%20East%20of%20the%20shrine.%20It%20is%20possible%20that%20%24%20%28x_i%2C%20y_i%29%20%3D%20%28x_j%2C%20y_j%29%20%24%20even%20when%20%24%20i%20%5C%5Cne%20j%20%24%20.%5Cn%5CnShichikuji%20must%20provide%20electricity%20to%20each%20city%20either%20by%20building%20a%20power%20station%20in%20that%20city%2C%20or%20by%20making%20a%20connection%20between%20that%20city%20and%20another%20one%20that%20already%20has%20electricity.%20So%20the%20City%20has%20electricity%20if%20it%20has%20a%20power%20station%20in%20it%20or%20it%20is%20connected%20to%20a%20City%20which%20has%20electricity%20by%20a%20direct%20connection%20or%20via%20a%20chain%20of%20connections.%5Cn%5Cn-%20Building%20a%20power%20station%20in%20City%20%24%20i%20%24%20will%20cost%20%24%20c_i%20%24%20yen%3B%5Cn-%20Making%20a%20connection%20between%20City%20%24%20i%20%24%20and%20City%20%24%20j%20%24%20will%20cost%20%24%20k_i%20%2B%20k_j%20%24%20yen%20per%20km%20of%20wire%20used%20for%20the%20connection.%20However%2C%20wires%20can%20only%20go%20the%20cardinal%20directions%20%28North%2C%20South%2C%20East%2C%20West%29.%20Wires%20can%20cross%20each%20other.%20Each%20wire%20must%20have%20both%20of%20its%20endpoints%20in%20some%20cities.%20If%20City%20%24%20i%20%24%20and%20City%20%24%20j%20%24%20are%20connected%20by%20a%20wire%2C%20the%20wire%20will%20go%20through%20any%20shortest%20path%20from%20City%20%24%20i%20%24%20to%20City%20%24%20j%20%24%20.%20Thus%2C%20the%20length%20of%20the%20wire%20if%20City%20%24%20i%20%24%20and%20City%20%24%20j%20%24%20are%20connected%20is%20%24%20%7Cx_i%20-%20x_j%7C%20%2B%20%7Cy_i%20-%20y_j%7C%20%24%20km.%5Cn%5CnShichikuji%20wants%20to%20do%20this%20job%20spending%20as%20little%20money%20as%20possible%2C%20since%20according%20to%20her%2C%20there%20isn%27t%20really%20anything%20else%20in%20the%20world%20other%20than%20money.%20However%2C%20she%20died%20when%20she%20was%20only%20in%20fifth%20grade%20so%20she%20is%20not%20smart%20enough%20for%20this.%20And%20thus%2C%20the%20new%20resident%20deity%20asks%20for%20your%20help.%5Cn%5CnAnd%20so%2C%20you%20have%20to%20provide%20Shichikuji%20with%20the%20following%20information%3A%20minimum%20amount%20of%20yen%20needed%20to%20provide%20electricity%20to%20all%20cities%2C%20the%20cities%20in%20which%20power%20stations%20will%20be%20built%2C%20and%20the%20connections%20to%20be%20made.%5Cn%5CnIf%20there%20are%20multiple%20ways%20to%20choose%20the%20cities%20and%20the%20connections%20to%20obtain%20the%20construction%20of%20minimum%20price%2C%20then%20print%20any%20of%20them.%22%2C%22inputFormat%22%3A%22First%20line%20of%20input%20contains%20a%20single%20integer%20%24%20n%20%24%20%28%20%24%201%20%5C%5Cleq%20n%20%5C%5Cleq%202000%20%24%20%29%20%5Cu2014%20the%20number%20of%20cities.%5Cn%5CnThen%2C%20%24%20n%20%24%20lines%20follow.%20The%20%24%20i%20%24%20-th%20line%20contains%20two%20space-separated%20integers%20%24%20x_i%20%24%20%28%20%24%201%20%5C%5Cleq%20x_i%20%5C%5Cleq%2010%5E6%20%24%20%29%20and%20%24%20y_i%20%24%20%28%20%24%201%20%5C%5Cleq%20y_i%20%5C%5Cleq%2010%5E6%20%24%20%29%20%5Cu2014%20the%20coordinates%20of%20the%20%24%20i%20%24%20-th%20city.%5Cn%5CnThe%20next%20line%20contains%20%24%20n%20%24%20space-separated%20integers%20%24%20c_1%2C%20c_2%2C%20%5C%5Cdots%2C%20c_n%20%24%20%28%20%24%201%20%5C%5Cleq%20c_i%20%5C%5Cleq%2010%5E9%20%24%20%29%20%5Cu2014%20the%20cost%20of%20building%20a%20power%20station%20in%20the%20%24%20i%20%24%20-th%20city.%5Cn%5CnThe%20last%20line%20contains%20%24%20n%20%24%20space-separated%20integers%20%24%20k_1%2C%20k_2%2C%20%5C%5Cdots%2C%20k_n%20%24%20%28%20%24%201%20%5C%5Cleq%20k_i%20%5C%5Cleq%2010%5E9%20%24%20%29.%22%2C%22outputFormat%22%3A%22In%20the%20first%20line%20print%20a%20single%20integer%2C%20denoting%20the%20minimum%20amount%20of%20yen%20needed.%5Cn%5CnThen%2C%20print%20an%20integer%20%24%20v%20%24%20%5Cu2014%20the%20number%20of%20power%20stations%20to%20be%20built.%5Cn%5CnNext%2C%20print%20%24%20v%20%24%20space-separated%20integers%2C%20denoting%20the%20indices%20of%20cities%20in%20which%20a%20power%20station%20will%20be%20built.%20Each%20number%20should%20be%20from%20%24%201%20%24%20to%20%24%20n%20%24%20and%20all%20numbers%20should%20be%20pairwise%20distinct.%20You%20can%20print%20the%20numbers%20in%20arbitrary%20order.%5Cn%5CnAfter%20that%2C%20print%20an%20integer%20%24%20e%20%24%20%5Cu2014%20the%20number%20of%20connections%20to%20be%20made.%5Cn%5CnFinally%2C%20print%20%24%20e%20%24%20pairs%20of%20integers%20%24%20a%20%24%20and%20%24%20b%20%24%20%28%20%24%201%20%5C%5Cle%20a%2C%20b%20%5C%5Cle%20n%20%24%20%2C%20%24%20a%20%5C%5Cne%20b%20%24%20%29%2C%20denoting%20that%20a%20connection%20between%20City%20%24%20a%20%24%20and%20City%20%24%20b%20%24%20will%20be%20made.%20Each%20unordered%20pair%20of%20cities%20should%20be%20included%20at%20most%20once%20%28for%20each%20%24%20%28a%2C%20b%29%20%24%20there%20should%20be%20no%20more%20%24%20%28a%2C%20b%29%20%24%20or%20%24%20%28b%2C%20a%29%20%24%20pairs%29.%20You%20can%20print%20the%20pairs%20in%20arbitrary%20order.%5Cn%5CnIf%20there%20are%20multiple%20ways%20to%20choose%20the%20cities%20and%20the%20connections%20to%20obtain%20the%20construction%20of%20minimum%20price%2C%20then%20print%20any%20of%20them.%22%2C%22samples%22%3A%5B%5B%22%5Cn3%5Cn2%203%5Cn1%201%5Cn3%202%5Cn3%202%203%5Cn3%202%203%5Cn%22%2C%22%5Cn8%5Cn3%5Cn1%202%203%20%5Cn0%5Cn%22%5D%2C%5B%22%5Cn3%5Cn2%201%5Cn1%202%5Cn3%203%5Cn23%202%2023%5Cn3%202%203%5Cn%22%2C%22%5Cn27%5Cn1%5Cn2%20%5Cn2%5Cn1%202%5Cn2%203%5Cn%22%5D%5D%2C%22hint%22%3A%22For%20the%20answers%20given%20in%20the%20samples%2C%20refer%20to%20the%20following%20diagrams%20%28cities%20with%20power%20stations%20are%20colored%20green%2C%20other%20cities%20are%20colored%20blue%2C%20and%20wires%20are%20colored%20red%29%3A%5Cn%5Cn%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF1245D%5C%2F251d50cda099f4e4be2994b6b01574cc32a17cd3.png%29%5Cn%5CnFor%20the%20first%20example%2C%20the%20cost%20of%20building%20power%20stations%20in%20all%20cities%20is%20%24%203%20%2B%202%20%2B%203%20%3D%208%20%24%20.%20It%20can%20be%20shown%20that%20no%20configuration%20costs%20less%20than%208%20yen.%5Cn%5CnFor%20the%20second%20example%2C%20the%20cost%20of%20building%20a%20power%20station%20in%20City%202%20is%202.%20The%20cost%20of%20connecting%20City%201%20and%20City%202%20is%20%24%202%20%5C%5Ccdot%20%283%20%2B%202%29%20%3D%2010%20%24%20.%20The%20cost%20of%20connecting%20City%202%20and%20City%203%20is%20%24%203%20%5C%5Ccdot%20%282%20%2B%203%29%20%3D%2015%20%24%20.%20Thus%20the%20total%20cost%20is%20%24%202%20%2B%2010%20%2B%2015%20%3D%2027%20%24%20.%20It%20can%20be%20shown%20that%20no%20configuration%20costs%20less%20than%2027%20yen.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F1245%5C%2FD%22%2C%22id%22%3A%221245D%22%7D%2C%22translation%22%3A%22%5Cu5df2%5Cu77e5%5Cu4e00%5Cu4e2a%5Cu5e73%5Cu9762%5Cu4e0a%5Cu6709%20%24n%24%20%5Cu4e2a%5Cu57ce%5Cu5e02%5Cuff0c%5Cu9700%5Cu8981%5Cu4e2a%20%24n%24%20%5Cu4e2a%5Cu57ce%5Cu5e02%5Cu5747%5Cu901a%5Cu4e0a%5Cu7535%5Cr%5Cn%5Cr%5Cn%5Cu4e00%5Cu4e2a%5Cu57ce%5Cu5e02%5Cu6709%5Cu7535%5Cuff0c%5Cu5fc5%5Cu987b%5Cu5728%5Cu8fd9%5Cu4e2a%5Cu57ce%5Cu5e02%5Cu6709%5Cu53d1%5Cu7535%5Cu7ad9%5Cu6216%5Cu8005%5Cu548c%5Cu4e00%5Cu4e2a%5Cu6709%5Cu7535%5Cu7684%5Cu57ce%5Cu5e02%5Cu7528%5Cu7535%5Cu7f06%5Cu76f8%5Cu8fde%5Cr%5Cn%5Cr%5Cn%5Cu5728%5Cu4e00%5Cu4e2a%5Cu57ce%5Cu5e02%5Cu5efa%5Cu9020%5Cu53d1%5Cu7535%5Cu7ad9%5Cu7684%5Cu4ee3%5Cu4ef7%5Cu662f%20%24c%5Bi%5D%24%5Cr%5Cn%5Cr%5Cn%24i%24%20%5Cu548c%20%24j%24%20%5Cu4e24%5Cu4e2a%5Cu57ce%5Cu5e02%5Cu76f8%5Cu8fde%5Cu7684%5Cu4ee3%5Cu4ef7%5Cu662f%20%24k%5Bi%5D%2Bk%5Bj%5D%24%20%5Cu4e58%5Cu4e0a%5Cu4e24%5Cu8005%5Cu7684%5Cu66fc%5Cu54c8%5Cu987f%5Cu8ddd%5Cu79bb%5Cr%5Cn%5Cr%5Cn%5Cu6c42%5Cu6700%5Cu5c0f%5Cu4ee3%5Cu4ef7%5Cu7684%5Cu65b9%5Cu6848%5Cr%5Cn%5Cr%5Cn%5Cu8f93%5Cu5165%3A%5Cr%5Cn%5Cr%5Cn%5Cu7b2c%5Cu4e00%5Cu884c%5Cu4e3a%5Cu57ce%5Cu5e02%5Cu4e2a%5Cu6570%5Cr%5Cn%5Cr%5Cn%5Cu4e0b%5Cu9762%5Cu662f%5Cu6bcf%5Cu4e2a%5Cu57ce%5Cu5e02%5Cu7684%5Cu5750%5Cu6807%5Cr%5Cn%5Cr%5Cn%5Cu4e0b%5Cu9762%5Cu662f%5Cu5efa%5Cu9020%5Cu53d1%5Cu7535%5Cu7ad9%5Cu7684%5Cu4ee3%5Cu4ef7%20%24c%5Bi%5D%24%5Cr%5Cn%5Cr%5Cn%5Cu4e0b%5Cu9762%5Cu662f%5Cu6bcf%5Cu4e2a%5Cu57ce%5Cu5e02%5Cu8fde%5Cu7ebf%5Cu7684%5Cu7cfb%5Cu6570%20%24k%5Bi%5D%24%5Cr%5Cn%5Cr%5Cn%5Cu8f93%5Cu51fa%3A%5Cr%5Cn%5Cr%5Cn%5Cu4e00%5Cu4e2a%5Cu4e3a%5Cu6700%5Cu5c0f%5Cu4ee3%5Cu4ef7%5Cr%5Cn%5Cr%5Cn%5Cu5efa%5Cu9020%5Cu53d1%5Cu7535%5Cu7ad9%5Cu7684%5Cu57ce%5Cu5e02%5Cu6570%5Cuff0c%5Cu548c%5Cu6bcf%5Cu4e2a%5Cu57ce%5Cu5e02%5Cr%5Cn%5Cr%5Cn%5Cu8fde%5Cu7ebf%5Cu7684%5Cu6761%5Cu6570%5Cuff0c%5Cu548c%5Cu6bcf%5Cu6761%5Cu8fde%5Cu7ebf%5Cr%5Cn%5Cr%5Cn%5Cu4efb%5Cu610f%5Cu4e00%5Cu79cd%5Cu5373%5Cu53ef%5Cuff0c%5Cu8f93%5Cu51fa%5Cu987a%5Cu5e8f%5Cu4efb%5Cu610f%5Cr%5Cn%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A144%2C%22totalAccepted%22%3A72%2C%22pid%22%3A%22CF1245D%22%2C%22title%22%3A%22Shichikuji%20and%20Power%20Grid%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A164905%2C%22title%22%3A%22%5Cu6c42%5Cu52a9%5Cu53ea%5Cu8fc7%5Cu4e862%5Cu4e2a%5Cu70b9%22%2C%22forum%22%3A%7B%22id%22%3A42387%2C%22name%22%3A%22CF1245D%20Shichikuji%20and%20Power%20Grid%22%2C%22slug%22%3A%22CF1245D%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P5614%22%2C%22title%22%3A%22%5BMtOI2019%5D%5Cu819cSiyuan%22%2C%22difficulty%22%3A3%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P5613%22%2C%22title%22%3A%22%5BMtOI2019%5D%5Cu9ed1%5Cu868a%5Cu5b50%5Cu591a%22%2C%22difficulty%22%3A1%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22CF1245F%22%2C%22title%22%3A%22Daniel%20and%20Spring%20Cleaning%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1245C%22%2C%22title%22%3A%22Constanze%27s%20Machine%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1245B%22%2C%22title%22%3A%22Restricted%20RPS%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Shichikuji%20and%20Power%20Grid%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Shichikuji and Power Grid</h1>
<h2>题意翻译</h2>
<div>已知一个平面上有 $n$ 个城市，需要个 $n$ 个城市均通上电
一个城市有电，必须在这个城市有发电站或者和一个有电的城市用电缆相连
在一个城市建造发电站的代价是 $c[i]$
$i$ 和 $j$ 两个城市相连的代价是 $k[i]+k[j]$ 乘上两者的曼哈顿距离
求最小代价的方案
输入:
第一行为城市个数
下面是每个城市的坐标
下面是建造发电站的代价 $c[i]$
下面是每个城市连线的系数 $k[i]$
输出:
一个为最小代价
建造发电站的城市数，和每个城市
连线的条数，和每条连线
任意一种即可，输出顺序任意
</div>
<h2>题目描述</h2>
<div>Shichikuji is the new resident deity of the South Black Snail Temple. Her first job is as follows:
There are $ n $ new cities located in Prefecture X. Cities are numbered from $ 1 $ to $ n $ . City $ i $ is located $ x_i $ km North of the shrine and $ y_i $ km East of the shrine. It is possible that $ (x_i, y_i) = (x_j, y_j) $ even when $ i \ne j $ .
Shichikuji must provide electricity to each city either by building a power station in that city, or by making a connection between that city and another one that already has electricity. So the City has electricity if it has a power station in it or it is connected to a City which has electricity by a direct connection or via a chain of connections.
- Building a power station in City $ i $ will cost $ c_i $ yen;
- Making a connection between City $ i $ and City $ j $ will cost $ k_i + k_j $ yen per km of wire used for the connection. However, wires can only go the cardinal directions (North, South, East, West). Wires can cross each other. Each wire must have both of its endpoints in some cities. If City $ i $ and City $ j $ are connected by a wire, the wire will go through any shortest path from City $ i $ to City $ j $ . Thus, the length of the wire if City $ i $ and City $ j $ are connected is $ |x_i - x_j| + |y_i - y_j| $ km.
Shichikuji wants to do this job spending as little money as possible, since according to her, there isn't really anything else in the world other than money. However, she died when she was only in fifth grade so she is not smart enough for this. And thus, the new resident deity asks for your help.
And so, you have to provide Shichikuji with the following information: minimum amount of yen needed to provide electricity to all cities, the cities in which power stations will be built, and the connections to be made.
If there are multiple ways to choose the cities and the connections to obtain the construction of minimum price, then print any of them.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>First line of input contains a single integer $ n $ ( $ 1 \leq n \leq 2000 $ ) — the number of cities.
Then, $ n $ lines follow. The $ i $ -th line contains two space-separated integers $ x_i $ ( $ 1 \leq x_i \leq 10^6 $ ) and $ y_i $ ( $ 1 \leq y_i \leq 10^6 $ ) — the coordinates of the $ i $ -th city.
The next line contains $ n $ space-separated integers $ c_1, c_2, \dots, c_n $ ( $ 1 \leq c_i \leq 10^9 $ ) — the cost of building a power station in the $ i $ -th city.
The last line contains $ n $ space-separated integers $ k_1, k_2, \dots, k_n $ ( $ 1 \leq k_i \leq 10^9 $ ).</div>
<h3>输出格式</h3>
<br />
<div>In the first line print a single integer, denoting the minimum amount of yen needed.
Then, print an integer $ v $ — the number of power stations to be built.
Next, print $ v $ space-separated integers, denoting the indices of cities in which a power station will be built. Each number should be from $ 1 $ to $ n $ and all numbers should be pairwise distinct. You can print the numbers in arbitrary order.
After that, print an integer $ e $ — the number of connections to be made.
Finally, print $ e $ pairs of integers $ a $ and $ b $ ( $ 1 \le a, b \le n $ , $ a \ne b $ ), denoting that a connection between City $ a $ and City $ b $ will be made. Each unordered pair of cities should be included at most once (for each $ (a, b) $ there should be no more $ (a, b) $ or $ (b, a) $ pairs). You can print the pairs in arbitrary order.
If there are multiple ways to choose the cities and the connections to obtain the construction of minimum price, then print any of them.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>
3
2 3
1 1
3 2
3 2 3
3 2 3
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>
8
3
1 2 3 
0
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>
3
2 1
1 2
3 3
23 2 23
3 2 3
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>
27
1
2 
2
1 2
2 3
</code></pre>
<h2>说明</h2>
<div>For the answers given in the samples, refer to the following diagrams (cities with power stations are colored green, other cities are colored blue, and wires are colored red):
![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1245D/251d50cda099f4e4be2994b6b01574cc32a17cd3.png)
For the first example, the cost of building power stations in all cities is $ 3 + 2 + 3 = 8 $ . It can be shown that no configuration costs less than 8 yen.
For the second example, the cost of building a power station in City 2 is 2. The cost of connecting City 1 and City 2 is $ 2 \cdot (3 + 2) = 10 $ . The cost of connecting City 2 and City 3 is $ 3 \cdot (2 + 3) = 15 $ . Thus the total cost is $ 2 + 10 + 15 = 27 $ . It can be shown that no configuration costs less than 27 yen.</div>
</article>
</div>
</div>
</body>
</html>
