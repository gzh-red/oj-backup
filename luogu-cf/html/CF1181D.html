<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Irrigation - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573402692:M/4asDg3APd8hm8N8BFcFQm+cyPZwniVQ2ynOrCdUhw=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%22%2C%22description%22%3A%22Misha%20was%20interested%20in%20water%20delivery%20from%20childhood.%20That%27s%20why%20his%20mother%20sent%20him%20to%20the%20annual%20Innovative%20Olympiad%20in%20Irrigation%20%28IOI%29.%20Pupils%20from%20all%20Berland%20compete%20there%20demonstrating%20their%20skills%20in%20watering.%20It%20is%20extremely%20expensive%20to%20host%20such%20an%20olympiad%2C%20so%20after%20the%20first%20%24%20n%20%24%20olympiads%20the%20organizers%20introduced%20the%20following%20rule%20of%20the%20host%20city%20selection.%5Cn%5CnThe%20host%20cities%20of%20the%20olympiads%20are%20selected%20in%20the%20following%20way.%20There%20are%20%24%20m%20%24%20cities%20in%20Berland%20wishing%20to%20host%20the%20olympiad%2C%20they%20are%20numbered%20from%20%24%201%20%24%20to%20%24%20m%20%24%20.%20The%20host%20city%20of%20each%20next%20olympiad%20is%20determined%20as%20the%20city%20that%20hosted%20the%20olympiad%20the%20smallest%20number%20of%20times%20before.%20If%20there%20are%20several%20such%20cities%2C%20the%20city%20with%20the%20smallest%20index%20is%20selected%20among%20them.%5Cn%5CnMisha%27s%20mother%20is%20interested%20where%20the%20olympiad%20will%20be%20held%20in%20some%20specific%20years.%20The%20only%20information%20she%20knows%20is%20the%20above%20selection%20rule%20and%20the%20host%20cities%20of%20the%20first%20%24%20n%20%24%20olympiads.%20Help%20her%20and%20if%20you%20succeed%2C%20she%20will%20ask%20Misha%20to%20avoid%20flooding%20your%20house.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20three%20integers%20%24%20n%20%24%20%2C%20%24%20m%20%24%20and%20%24%20q%20%24%20%28%20%24%201%20%5C%5Cleq%20n%2C%20m%2C%20q%20%5C%5Cleq%20500%5C%5C%2C000%20%24%20%29%20%5Cu2014%20the%20number%20of%20olympiads%20before%20the%20rule%20was%20introduced%2C%20the%20number%20of%20cities%20in%20Berland%20wishing%20to%20host%20the%20olympiad%2C%20and%20the%20number%20of%20years%20Misha%27s%20mother%20is%20interested%20in%2C%20respectively.%5Cn%5CnThe%20next%20line%20contains%20%24%20n%20%24%20integers%20%24%20a_1%2C%20a_2%2C%20%5C%5Cldots%2C%20a_n%20%24%20%28%20%24%201%20%5C%5Cleq%20a_i%20%5C%5Cleq%20m%20%24%20%29%2C%20where%20%24%20a_i%20%24%20denotes%20the%20city%20which%20hosted%20the%20olympiad%20in%20the%20%24%20i%20%24%20-th%20year.%20Note%20that%20before%20the%20rule%20was%20introduced%20the%20host%20city%20was%20chosen%20arbitrarily.%5Cn%5CnEach%20of%20the%20next%20%24%20q%20%24%20lines%20contains%20an%20integer%20%24%20k_i%20%24%20%28%20%24%20n%20%2B%201%20%5C%5Cleq%20k_i%20%5C%5Cleq%2010%5E%7B18%7D%20%24%20%29%20%5Cu2014%20the%20year%20number%20Misha%27s%20mother%20is%20interested%20in%20host%20city%20in.%22%2C%22outputFormat%22%3A%22Print%20%24%20q%20%24%20integers.%20The%20%24%20i%20%24%20-th%20of%20them%20should%20be%20the%20city%20the%20olympiad%20will%20be%20hosted%20in%20the%20year%20%24%20k_i%20%24%20.%22%2C%22samples%22%3A%5B%5B%226%204%2010%5Cn3%201%201%201%202%202%5Cn7%5Cn8%5Cn9%5Cn10%5Cn11%5Cn12%5Cn13%5Cn14%5Cn15%5Cn16%5Cn%22%2C%224%5Cn3%5Cn4%5Cn2%5Cn3%5Cn4%5Cn1%5Cn2%5Cn3%5Cn4%5Cn%22%5D%2C%5B%224%205%204%5Cn4%204%205%201%5Cn15%5Cn9%5Cn13%5Cn6%5Cn%22%2C%225%5Cn3%5Cn3%5Cn3%5Cn%22%5D%5D%2C%22hint%22%3A%22In%20the%20first%20example%20Misha%27s%20mother%20is%20interested%20in%20the%20first%20%24%2010%20%24%20years%20after%20the%20rule%20was%20introduced.%20The%20host%20cities%20these%20years%20are%204%2C%203%2C%204%2C%202%2C%203%2C%204%2C%201%2C%202%2C%203%2C%204.%5Cn%5CnIn%20the%20second%20example%20the%20host%20cities%20after%20the%20new%20city%20is%20introduced%20are%202%2C%203%2C%201%2C%202%2C%203%2C%205%2C%201%2C%202%2C%203%2C%204%2C%205%2C%201.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2500%5D%2C%22memory%22%3A%5B512000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F1181%5C%2FD%22%2C%22id%22%3A%221181D%22%7D%2C%22translation%22%3A%22%5Cu7ed9%5Cu5b9a%20%24M%24%20%5Cu4e2a%5Cu57ce%5Cu5e02%5Cuff0c%5Cu6bcf%5Cu5e74%5Cu4f1a%5Cu9009%5Cu51fa%5Cu4e00%5Cu4e2a%5Cu57ce%5Cu5e02%5Cu4e3e%5Cu529e%5Cu6bd4%5Cu8d5b%5Cuff0c%5Cu73b0%5Cu7ed9%5Cu51fa%5Cu524d%20%24N%24%20%5Cu5e74%5Cu57ce%5Cu5e02%5Cu4e3e%5Cu529e%5Cu6bd4%5Cu8d5b%5Cu7684%5Cu60c5%5Cu51b5%5Cu3002%5Cu5728%5Cu63a5%5Cu4e0b%5Cu6765%5Cu7684%5Cu5e74%5Cu4efd%5Cu4e2d%5Cuff0c%5Cu6bcf%5Cu5e74%5Cu7684%5Cu6bd4%5Cu8d5b%5Cu4f1a%5Cu5728%5Cu4e3e%5Cu529e%5Cu6bd4%5Cu8d5b%5Cu6b21%5Cu6570%5Cu6700%5Cu5c0f%5Cu7684%5Cu57ce%5Cu5e02%5Cu4e3e%5Cu529e%5Cuff0c%5Cu5982%5Cu679c%5Cu6709%5Cu5f88%5Cu591a%5Cu57ce%5Cu5e02%5Cu4e3e%5Cu529e%5Cu6b21%5Cu6570%5Cu5747%5Cu4e3a%5Cu6700%5Cu5c0f%5Cu503c%5Cuff0c%5Cu5219%5Cu5728%5Cu7f16%5Cu53f7%5Cu6700%5Cu5c0f%5Cu7684%5Cu57ce%5Cu5e02%5Cu4e3e%5Cu529e%5Cu6bd4%5Cu8d5b%5Cu3002%5Cu73b0%5Cu7ed9%5Cu51fa%20%24Q%24%20%5Cu4e2a%5Cu8be2%5Cu95ee%5Cuff0c%5Cu6bcf%5Cu6b21%5Cu8be2%5Cu95ee%5Cu7b2c%20%24K%24%20%5Cu5e74%5Cu5728%5Cu54ea%5Cu4e2a%5Cu57ce%5Cu5e02%5Cu4e3e%5Cu529e%5Cu6bd4%5Cu8d5b%5Cu3002%5Cn%24N%2B1%20%5C%5Cle%20K%20%5C%5Cle%201e18%2C%201%5C%5Cle%20M%2CN%2CQ%20%5C%5Cle%205e5%24%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A133%2C%22totalAccepted%22%3A64%2C%22pid%22%3A%22CF1181D%22%2C%22title%22%3A%22Irrigation%22%2C%22difficulty%22%3A4%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A144134%2C%22title%22%3A%22T%5Cu4e86%5Cuff01%5Cuff01%5Cuff01%22%2C%22forum%22%3A%7B%22id%22%3A37256%2C%22name%22%3A%22CF1181D%20Irrigation%22%2C%22slug%22%3A%22CF1181D%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P5431%22%2C%22title%22%3A%22%5Cu3010%5Cu6a21%5Cu677f%5Cu3011%5Cu4e58%5Cu6cd5%5Cu9006%5Cu51432%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22CF1181C%22%2C%22title%22%3A%22Flag%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1181B%22%2C%22title%22%3A%22Split%20a%20Number%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1207F%22%2C%22title%22%3A%22Remainder%20Problem%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1207D%22%2C%22title%22%3A%22Number%20Of%20Permutations%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Irrigation%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Irrigation</h1>
<h2>题意翻译</h2>
<div>给定 $M$ 个城市，每年会选出一个城市举办比赛，现给出前 $N$ 年城市举办比赛的情况。在接下来的年份中，每年的比赛会在举办比赛次数最小的城市举办，如果有很多城市举办次数均为最小值，则在编号最小的城市举办比赛。现给出 $Q$ 个询问，每次询问第 $K$ 年在哪个城市举办比赛。
$N+1 \le K \le 1e18, 1\le M,N,Q \le 5e5$</div>
<h2>题目描述</h2>
<div>Misha was interested in water delivery from childhood. That's why his mother sent him to the annual Innovative Olympiad in Irrigation (IOI). Pupils from all Berland compete there demonstrating their skills in watering. It is extremely expensive to host such an olympiad, so after the first $ n $ olympiads the organizers introduced the following rule of the host city selection.
The host cities of the olympiads are selected in the following way. There are $ m $ cities in Berland wishing to host the olympiad, they are numbered from $ 1 $ to $ m $ . The host city of each next olympiad is determined as the city that hosted the olympiad the smallest number of times before. If there are several such cities, the city with the smallest index is selected among them.
Misha's mother is interested where the olympiad will be held in some specific years. The only information she knows is the above selection rule and the host cities of the first $ n $ olympiads. Help her and if you succeed, she will ask Misha to avoid flooding your house.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains three integers $ n $ , $ m $ and $ q $ ( $ 1 \leq n, m, q \leq 500\,000 $ ) — the number of olympiads before the rule was introduced, the number of cities in Berland wishing to host the olympiad, and the number of years Misha's mother is interested in, respectively.
The next line contains $ n $ integers $ a_1, a_2, \ldots, a_n $ ( $ 1 \leq a_i \leq m $ ), where $ a_i $ denotes the city which hosted the olympiad in the $ i $ -th year. Note that before the rule was introduced the host city was chosen arbitrarily.
Each of the next $ q $ lines contains an integer $ k_i $ ( $ n + 1 \leq k_i \leq 10^{18} $ ) — the year number Misha's mother is interested in host city in.</div>
<h3>输出格式</h3>
<br />
<div>Print $ q $ integers. The $ i $ -th of them should be the city the olympiad will be hosted in the year $ k_i $ .</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>6 4 10
3 1 1 1 2 2
7
8
9
10
11
12
13
14
15
16
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>4
3
4
2
3
4
1
2
3
4
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>4 5 4
4 4 5 1
15
9
13
6
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>5
3
3
3
</code></pre>
<h2>说明</h2>
<div>In the first example Misha's mother is interested in the first $ 10 $ years after the rule was introduced. The host cities these years are 4, 3, 4, 2, 3, 4, 1, 2, 3, 4.
In the second example the host cities after the new city is introduced are 2, 3, 1, 2, 3, 5, 1, 2, 3, 4, 5, 1.</div>
</article>
</div>
</div>
</body>
</html>
