<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Counting Rectangles is Fun - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573393362:znJfKuvIAElCFzgCFiHFKaryjT/gpAixrh4qYvSWiz4=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%22%2C%22description%22%3A%22There%20is%20an%20%24%20n%5Cu00d7m%20%24%20rectangular%20grid%2C%20each%20cell%20of%20the%20grid%20contains%20a%20single%20integer%3A%20zero%20or%20one.%20Let%27s%20call%20the%20cell%20on%20the%20%24%20i%20%24%20-th%20row%20and%20the%20%24%20j%20%24%20-th%20column%20as%20%24%20%28i%2Cj%29%20%24%20.%5Cn%5CnLet%27s%20define%20a%20%5C%22rectangle%5C%22%20as%20four%20integers%20%24%20a%2Cb%2Cc%2Cd%20%24%20%24%20%281%3C%3Da%3C%3Dc%3C%3Dn%3B%5Cu00a01%3C%3Db%3C%3Dd%3C%3Dm%29%20%24%20.%20Rectangle%20denotes%20a%20set%20of%20cells%20of%20the%20grid%20%24%20%7B%28x%2Cy%29%5Cu00a0%3A%5Cu00a0a%3C%3Dx%3C%3Dc%2Cb%3C%3Dy%3C%3Dd%7D%20%24%20.%20Let%27s%20define%20a%20%5C%22good%20rectangle%5C%22%20as%20a%20rectangle%20that%20includes%20only%20the%20cells%20with%20zeros.%5Cn%5CnYou%20should%20answer%20the%20following%20%24%20q%20%24%20queries%3A%20calculate%20the%20number%20of%20good%20rectangles%20all%20of%20which%20cells%20are%20in%20the%20given%20rectangle.%22%2C%22inputFormat%22%3A%22There%20are%20three%20integers%20in%20the%20first%20line%3A%20%24%20n%20%24%20%2C%20%24%20m%20%24%20and%20%24%20q%20%24%20%28%20%24%201%3C%3Dn%2Cm%3C%3D40%2C1%3C%3Dq%3C%3D3%5Cu00b710%5E%7B5%7D%20%24%20%29.%20Each%20of%20the%20next%20%24%20n%20%24%20lines%20contains%20%24%20m%20%24%20characters%20%5Cu2014%20the%20grid.%20Consider%20grid%20rows%20are%20numbered%20from%20top%20to%20bottom%2C%20and%20grid%20columns%20are%20numbered%20from%20left%20to%20right.%20Both%20columns%20and%20rows%20are%20numbered%20starting%20from%201.%5Cn%5CnEach%20of%20the%20next%20%24%20q%20%24%20lines%20contains%20a%20query%20%5Cu2014%20four%20integers%20that%20describe%20the%20current%20rectangle%2C%20%24%20a%20%24%20%2C%20%24%20b%20%24%20%2C%20%24%20c%20%24%20%2C%20%24%20d%20%24%20%24%20%281%3C%3Da%3C%3Dc%3C%3Dn%3B%5Cu00a01%3C%3Db%3C%3Dd%3C%3Dm%29%20%24%20.%22%2C%22outputFormat%22%3A%22For%20each%20query%20output%20an%20answer%20%5Cu2014%20a%20single%20integer%20in%20a%20separate%20line.%22%2C%22samples%22%3A%5B%5B%225%205%205%5Cn00101%5Cn00000%5Cn00001%5Cn01000%5Cn00001%5Cn1%202%202%204%5Cn4%205%204%205%5Cn1%202%205%202%5Cn2%202%204%205%5Cn4%202%205%203%5Cn%22%2C%2210%5Cn1%5Cn7%5Cn34%5Cn5%5Cn%22%5D%2C%5B%224%207%205%5Cn0000100%5Cn0000010%5Cn0011000%5Cn0000000%5Cn1%207%202%207%5Cn3%201%203%201%5Cn2%203%204%205%5Cn1%202%202%207%5Cn2%202%204%207%5Cn%22%2C%223%5Cn1%5Cn16%5Cn27%5Cn52%5Cn%22%5D%5D%2C%22hint%22%3A%22For%20the%20first%20example%2C%20there%20is%20a%20%24%205%5Cu00d75%20%24%20rectangular%20grid%2C%20and%20the%20first%2C%20the%20second%2C%20and%20the%20third%20queries%20are%20represented%20in%20the%20following%20image.%5Cn%5Cn%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF372B%5C%2F0be5a72c343f046641485221a9bc1240a20fee54.png%29-%20For%20the%20first%20query%2C%20there%20are%20%24%2010%20%24%20good%20rectangles%2C%20five%20%24%201%5Cu00d71%20%24%20%2C%20two%20%24%202%5Cu00d71%20%24%20%2C%20two%20%24%201%5Cu00d72%20%24%20%2C%20and%20one%20%24%201%5Cu00d73%20%24%20.%5Cn-%20For%20the%20second%20query%2C%20there%20is%20only%20one%20%24%201%5Cu00d71%20%24%20good%20rectangle.%5Cn-%20For%20the%20third%20query%2C%20there%20are%20%24%207%20%24%20good%20rectangles%2C%20four%20%24%201%5Cu00d71%20%24%20%2C%20two%20%24%202%5Cu00d71%20%24%20%2C%20and%20one%20%24%203%5Cu00d71%20%24%20.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B4000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F372%5C%2FB%22%2C%22id%22%3A%22372B%22%7D%2C%22translation%22%3A%22%23%23%23%20%5Cu9898%5Cu76ee%5Cu63cf%5Cu8ff0%5Cn%5Cn%5Cu7ed9%5Cu5b9a%5Cu4e00%5Cu4e2a%24%7Bn%20%2A%20m%7D%24%5Cu768401%5Cu77e9%5Cu9635%2C%20q%5Cu6b21%5Cu8be2%5Cu95ee%2C%20%5Cu6bcf%5Cu6b21%5Cu8be2%5Cu95ee%5Cu6307%5Cu5b9a%5Cu4e00%5Cu4e2a%5Cu5b50%5Cu77e9%5Cu5f62%2C%20%5Cu6c42%5Cu8be5%5Cu5b50%5Cu77e9%5Cu5f62%5Cu79cd%5Cu6709%5Cu591a%5Cu5c11%5Cu4e2a%5Cu53ea%5Cu5305%5Cu542b0%5Cu7684%5Cu5b50%5Cu77e9%5Cu9635.%5Cn%5Cn%5Cu77e9%5Cu9635%5Cu4ece%5Cu4e0a%5Cu5230%5Cu4e0b%5Cu7f16%5Cu53f71~n%2C%20%5Cu4ece%5Cu5de6%5Cu5230%5Cu53f3%5Cu7f16%5Cu53f71~m.%5Cn%5Cn%23%23%23%20%5Cu8f93%5Cu5165%5Cu683c%5Cu5f0f%5Cn%5Cn%5Cu7b2c%5Cu4e00%5Cu884c%5Cu4e09%5Cu4e2a%5Cu6574%5Cu6570n%2Cm%2Cq.%5Cn%5Cu63a5%5Cu4e0b%5Cu6765n%5Cu884c%2C%20%5Cu6bcf%5Cu884cm%5Cu4e2a%5Cu6574%5Cu6570%5Cu63cf%5Cu8ff0%5Cu8be5%5Cu77e9%5Cu9635.%5Cn%5Cu63a5%5Cu4e0b%5Cu6765q%5Cu884c%2C%20%5Cu6bcf%5Cu884c%5Cu56db%5Cu4e2a%5Cu6574%5Cu6570a%2Cb%2Cc%2Cd%5Cu8868%5Cu793a%5Cu8be2%5Cu95ee%5Cu7684%5Cu5b50%5Cu77e9%5Cu9635%5Cu5de6%5Cu4e0a%5Cu89d2%5Cu4e3a%28a%2Cb%29%2C%20%5Cu53f3%5Cu4e0b%5Cu89d2%5Cu4e3a%28c%2Cd%29.%5Cn%5Cn%23%23%23%20%5Cu8f93%5Cu51fa%5Cu683c%5Cu5f0f%5Cn%5Cn%5Cu5bf9%5Cu4e8e%5Cu6bcf%5Cu4e2a%5Cu8be2%5Cu95ee%2C%20%5Cu8f93%5Cu51fa%5Cu4e00%5Cu4e2a%5Cu6574%5Cu6570%5Cu8868%5Cu793a%5Cu7b54%5Cu6848.%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A38%2C%22totalAccepted%22%3A28%2C%22pid%22%3A%22CF372B%22%2C%22title%22%3A%22Counting%20Rectangles%20is%20Fun%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A66868%2C%22title%22%3A%22%5Cu7ffb%5Cu8bd1%22%2C%22forum%22%3A%7B%22id%22%3A11147%2C%22name%22%3A%22CF372B%20Counting%20Rectangles%20is%20Fun%22%2C%22slug%22%3A%22CF372B%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Counting%20Rectangles%20is%20Fun%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573306449;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Counting Rectangles is Fun</h1>
<h2>题意翻译</h2>
<div>### 题目描述
给定一个${n * m}$的01矩阵, q次询问, 每次询问指定一个子矩形, 求该子矩形种有多少个只包含0的子矩阵.
矩阵从上到下编号1~n, 从左到右编号1~m.
### 输入格式
第一行三个整数n,m,q.
接下来n行, 每行m个整数描述该矩阵.
接下来q行, 每行四个整数a,b,c,d表示询问的子矩阵左上角为(a,b), 右下角为(c,d).
### 输出格式
对于每个询问, 输出一个整数表示答案.</div>
<h2>题目描述</h2>
<div>There is an $ n×m $ rectangular grid, each cell of the grid contains a single integer: zero or one. Let's call the cell on the $ i $ -th row and the $ j $ -th column as $ (i,j) $ .
Let's define a "rectangle" as four integers $ a,b,c,d $ $ (1<=a<=c<=n; 1<=b<=d<=m) $ . Rectangle denotes a set of cells of the grid $ {(x,y) : a<=x<=c,b<=y<=d} $ . Let's define a "good rectangle" as a rectangle that includes only the cells with zeros.
You should answer the following $ q $ queries: calculate the number of good rectangles all of which cells are in the given rectangle.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>There are three integers in the first line: $ n $ , $ m $ and $ q $ ( $ 1<=n,m<=40,1<=q<=3·10^{5} $ ). Each of the next $ n $ lines contains $ m $ characters — the grid. Consider grid rows are numbered from top to bottom, and grid columns are numbered from left to right. Both columns and rows are numbered starting from 1.
Each of the next $ q $ lines contains a query — four integers that describe the current rectangle, $ a $ , $ b $ , $ c $ , $ d $ $ (1<=a<=c<=n; 1<=b<=d<=m) $ .</div>
<h3>输出格式</h3>
<br />
<div>For each query output an answer — a single integer in a separate line.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>5 5 5
00101
00000
00001
01000
00001
1 2 2 4
4 5 4 5
1 2 5 2
2 2 4 5
4 2 5 3
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>10
1
7
34
5
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>4 7 5
0000100
0000010
0011000
0000000
1 7 2 7
3 1 3 1
2 3 4 5
1 2 2 7
2 2 4 7
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>3
1
16
27
52
</code></pre>
<h2>说明</h2>
<div>For the first example, there is a $ 5×5 $ rectangular grid, and the first, the second, and the third queries are represented in the following image.
![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF372B/0be5a72c343f046641485221a9bc1240a20fee54.png)- For the first query, there are $ 10 $ good rectangles, five $ 1×1 $ , two $ 2×1 $ , two $ 1×2 $ , and one $ 1×3 $ .
- For the second query, there is only one $ 1×1 $ good rectangle.
- For the third query, there are $ 7 $ good rectangles, four $ 1×1 $ , two $ 2×1 $ , and one $ 3×1 $ .</div>
</article>
</div>
</div>
</body>
</html>
