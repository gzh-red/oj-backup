<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>String Problem - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573390125:wzVFSsuElJcL+wywPDfN4WjlS0SJ/JcZ77Rd/EWkmiQ=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%22%2C%22description%22%3A%22Boy%20Valera%20likes%20strings.%20And%20even%20more%20he%20likes%20them%2C%20when%20they%20are%20identical.%20That%27s%20why%20in%20his%20spare%20time%20Valera%20plays%20the%20following%20game.%20He%20takes%20any%20two%20strings%2C%20consisting%20of%20lower%20case%20Latin%20letters%2C%20and%20tries%20to%20make%20them%20identical.%20According%20to%20the%20game%20rules%2C%20with%20each%20move%20Valera%20can%20change%20one%20arbitrary%20character%20%24%20A_%7Bi%7D%20%24%20in%20one%20of%20the%20strings%20into%20arbitrary%20character%20%24%20B_%7Bi%7D%20%24%20%2C%20but%20he%20has%20to%20pay%20for%20every%20move%20a%20particular%20sum%20of%20money%2C%20equal%20to%20%24%20W_%7Bi%7D%20%24%20.%20He%20is%20allowed%20to%20make%20as%20many%20moves%20as%20he%20needs.%20Since%20Valera%20is%20a%20very%20economical%20boy%20and%20never%20wastes%20his%20money%2C%20he%20asked%20you%2C%20an%20experienced%20programmer%2C%20to%20help%20him%20answer%20the%20question%3A%20what%20minimum%20amount%20of%20money%20should%20Valera%20have%20to%20get%20identical%20strings.%22%2C%22inputFormat%22%3A%22The%20first%20input%20line%20contains%20two%20initial%20non-empty%20strings%20%24%20s%20%24%20and%20%24%20t%20%24%20%2C%20consisting%20of%20lower%20case%20Latin%20letters.%20The%20length%20of%20each%20string%20doesn%27t%20exceed%20%24%2010%5E%7B5%7D%20%24%20.%20The%20following%20line%20contains%20integer%20%24%20n%20%24%20%28%20%24%200%3C%3Dn%3C%3D500%20%24%20%29%20%5Cu2014%20amount%20of%20possible%20changings.%20Then%20follow%20%24%20n%20%24%20lines%2C%20each%20containing%20characters%20%24%20A_%7Bi%7D%20%24%20and%20%24%20B_%7Bi%7D%20%24%20%28lower%20case%20Latin%20letters%29%20and%20integer%20%24%20W_%7Bi%7D%20%24%20%28%20%24%200%3C%3DW_%7Bi%7D%3C%3D100%20%24%20%29%2C%20saying%20that%20it%27s%20allowed%20to%20change%20character%20%24%20A_%7Bi%7D%20%24%20into%20character%20%24%20B_%7Bi%7D%20%24%20in%20any%20of%20the%20strings%20and%20spend%20sum%20of%20money%20%24%20W_%7Bi%7D%20%24%20.%22%2C%22outputFormat%22%3A%22If%20the%20answer%20exists%2C%20output%20the%20answer%20to%20the%20problem%2C%20and%20the%20resulting%20string.%20Otherwise%20output%20-1%20in%20the%20only%20line.%20If%20the%20answer%20is%20not%20unique%2C%20output%20any.%22%2C%22samples%22%3A%5B%5B%22uayd%5Cnuxxd%5Cn3%5Cna%20x%208%5Cnx%20y%2013%5Cnd%20c%203%5Cn%22%2C%2221%5Cnuxyd%5Cn%22%5D%2C%5B%22a%5Cnb%5Cn3%5Cna%20b%202%5Cna%20b%203%5Cnb%20a%205%5Cn%22%2C%222%5Cnb%5Cn%22%5D%2C%5B%22abc%5Cnab%5Cn6%5Cna%20b%204%5Cna%20b%207%5Cnb%20a%208%5Cnc%20b%2011%5Cnc%20a%203%5Cna%20c%200%5Cn%22%2C%22-1%5Cn%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F33%5C%2FB%22%2C%22id%22%3A%2233B%22%7D%2C%22translation%22%3A%22%5Cu5c0f%5Cu7537%5Cu5b69Valera%5Cu559c%5Cu6b22%5Cu5b57%5Cu7b26%5Cu4e32%5Cu3002%5Cu5f53%5Cu5b83%5Cu4eec%5Cu662f%5Cu76f8%5Cu540c%5Cu7684%5Cu65f6%5Cu5019%5Cuff0c%5Cu4ed6%5Cu4f1a%5Cu66f4%5Cu559c%5Cu6b22%5Cu5b83%5Cu4eec%5Cu3002%5Cu8fd9%5Cu5c31%5Cu662f%5Cu4e3a%5Cu4ec0%5Cu4e48Valera%5Cu4f1a%5Cu5728%5Cu7a7a%5Cu95f2%5Cu65f6%5Cu95f4%5Cu73a9%5Cu4e0b%5Cu9762%5Cu8fd9%5Cu4e2a%5Cu6e38%5Cu620f%5Cu3002%5Cn%5Cu4ed6%5Cu6709%5Cu4e24%5Cu4e2a%5Cu7531%5Cu5c0f%5Cu5199%5Cu5b57%5Cu6bcd%5Cu7ec4%5Cu6210%5Cu7684%5Cu5b57%5Cu7b26%5Cu4e32%5Cuff0c%5Cu6839%5Cu636e%5Cu6e38%5Cu620f%5Cu89c4%5Cu5219%5Cuff0cValera%5Cu6bcf%5Cu6b21%5Cu53ef%5Cu4ee5%5Cu5c06%5Cu5176%5Cu4e2d%5Cu4e00%5Cu4e2a%5Cu5b57%5Cu7b26%5Cu4e32%5Cu4e2d%5Cu7684%5Cu4efb%5Cu4f55%5Cu4e00%5Cu4e2a%5Cu5b57%5Cu6bcd%20%24A_i%24%20%5Cu53d8%5Cu4e3a%24B_i%24%20%5Cuff0c%5Cu4f46%5Cu8981%5Cu652f%5Cu4ed8%24W_i%24%20%5Cu7684%5Cu4ee3%5Cu4ef7%5Cu3002%5Cu8bf7%5Cu4f60%5Cu8f93%5Cu51fa%5Cu8ba9%5Cu4e24%5Cu4e2a%5Cu5b57%5Cu7b26%5Cu4e32%5Cu76f8%5Cu540c%5Cu7684%5Cu6700%5Cu5c0f%5Cu4ee3%5Cu4ef7%5Cuff0c%5Cu65e0%5Cu89e3%5Cu8f93%5Cu51fa-1%5Cu3002%5Cn%5Cn%23%23%23%20%5Cu8f93%5Cu5165%5Cu683c%5Cu5f0f%5Cn%5Cn%5Cu7b2c1%5Cu30012%5Cu884c%5Cu4e24%5Cu4e2a%5Cu5b57%5Cu7b26%5Cu4e32%5Cu3002%5Cn%5Cu7b2c3%5Cu884c%5Cu4e00%5Cu4e2a%5Cu6574%5Cu6570n%5Cuff0c%5Cu8868%5Cu793a%5Cu53ef%5Cu80fd%5Cu7684%5Cu53d8%5Cu5316%5Cu7684%5Cu4e2a%5Cu6570%5Cu3002%5Cn%5Cu63a5%5Cu4e0b%5Cu6765n%5Cu884c%5Cuff0c%5Cu6bcf%5Cu884c%5Cu4e24%5Cu4e2a%5Cu5b57%5Cu7b26%5Cu4e00%5Cu4e2a%5Cu6574%5Cu6570%5Cu5206%5Cu522b%5Cu8868%5Cu793a%24A_i%24%20%5Cuff0c%24B_i%24%20%5Cuff0c%5Cu4e0e%24W_i%24%20%5Cu3002%5Cn%5Cn%23%23%23%20%5Cu8f93%5Cu51fa%5Cu683c%5Cu5f0f%5Cn%5Cn%5Cu65e0%5Cu89e3%5Cu8f93%5Cu51fa-1%5Cu3002%5Cn%5Cu6709%5Cu89e3%5Cu4e00%5Cu51712%5Cu884c%5Cuff0c%5Cu7b2c1%5Cu884c%5Cu4e00%5Cu4e2a%5Cu6574%5Cu6570%5Cu8868%5Cu793a%5Cu6700%5Cu5c0f%5Cu4ee3%5Cu4ef7%5Cuff1b%5Cu7b2c2%5Cu884c%5Cu4e00%5Cu4e2a%5Cu5b57%5Cu7b26%5Cu4e32%5Cu8868%5Cu793a%5Cu6700%5Cu540e%5Cu76f8%5Cu540c%5Cu7684%5Cu4e32%5Cu3002%5Cn%5Cn%5Cu611f%5Cu8c22MloVtry%20%5Cu63d0%5Cu4f9b%5Cu7684%5Cu7ffb%5Cu8bd1%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A265%2C%22totalAccepted%22%3A58%2C%22pid%22%3A%22CF33B%22%2C%22title%22%3A%22String%20Problem%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A156850%2C%22title%22%3A%22%5Cu6c42%5Cu52a9%5Cuff01%22%2C%22forum%22%3A%7B%22id%22%3A12557%2C%22name%22%3A%22CF33B%20String%20Problem%22%2C%22slug%22%3A%22CF33B%22%7D%7D%2C%7B%22id%22%3A32701%2C%22title%22%3A%22%5Cu7ffb%5Cu8bd1%22%2C%22forum%22%3A%7B%22id%22%3A12557%2C%22name%22%3A%22CF33B%20String%20Problem%22%2C%22slug%22%3A%22CF33B%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P3385%22%2C%22title%22%3A%22%5Cu3010%5Cu6a21%5Cu677f%5Cu3011%5Cu8d1f%5Cu73af%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22CF771A%22%2C%22title%22%3A%22Bear%20and%20Friendship%20Condition%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF95C%22%2C%22title%22%3A%22Volleyball%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF33C%22%2C%22title%22%3A%22Wonderful%20Randomized%20Sum%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF25C%22%2C%22title%22%3A%22Roads%20in%20Berland%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22CF%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22String%20Problem%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>String Problem</h1>
<h2>题意翻译</h2>
<div>小男孩Valera喜欢字符串。当它们是相同的时候，他会更喜欢它们。这就是为什么Valera会在空闲时间玩下面这个游戏。
他有两个由小写字母组成的字符串，根据游戏规则，Valera每次可以将其中一个字符串中的任何一个字母 $A_i$ 变为$B_i$ ，但要支付$W_i$ 的代价。请你输出让两个字符串相同的最小代价，无解输出-1。
### 输入格式
第1、2行两个字符串。
第3行一个整数n，表示可能的变化的个数。
接下来n行，每行两个字符一个整数分别表示$A_i$ ，$B_i$ ，与$W_i$ 。
### 输出格式
无解输出-1。
有解一共2行，第1行一个整数表示最小代价；第2行一个字符串表示最后相同的串。
感谢MloVtry 提供的翻译</div>
<h2>题目描述</h2>
<div>Boy Valera likes strings. And even more he likes them, when they are identical. That's why in his spare time Valera plays the following game. He takes any two strings, consisting of lower case Latin letters, and tries to make them identical. According to the game rules, with each move Valera can change one arbitrary character $ A_{i} $ in one of the strings into arbitrary character $ B_{i} $ , but he has to pay for every move a particular sum of money, equal to $ W_{i} $ . He is allowed to make as many moves as he needs. Since Valera is a very economical boy and never wastes his money, he asked you, an experienced programmer, to help him answer the question: what minimum amount of money should Valera have to get identical strings.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first input line contains two initial non-empty strings $ s $ and $ t $ , consisting of lower case Latin letters. The length of each string doesn't exceed $ 10^{5} $ . The following line contains integer $ n $ ( $ 0<=n<=500 $ ) — amount of possible changings. Then follow $ n $ lines, each containing characters $ A_{i} $ and $ B_{i} $ (lower case Latin letters) and integer $ W_{i} $ ( $ 0<=W_{i}<=100 $ ), saying that it's allowed to change character $ A_{i} $ into character $ B_{i} $ in any of the strings and spend sum of money $ W_{i} $ .</div>
<h3>输出格式</h3>
<br />
<div>If the answer exists, output the answer to the problem, and the resulting string. Otherwise output -1 in the only line. If the answer is not unique, output any.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>uayd
uxxd
3
a x 8
x y 13
d c 3
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>21
uxyd
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>a
b
3
a b 2
a b 3
b a 5
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>2
b
</code></pre>
<h3>输入样例 #3</h3>
<pre><code>abc
ab
6
a b 4
a b 7
b a 8
c b 11
c a 3
a c 0
</code></pre>
<h3>输出样例 #3</h3>
<pre><code>-1
</code></pre>
</article>
</div>
</div>
</body>
</html>
