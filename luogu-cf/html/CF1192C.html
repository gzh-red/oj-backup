<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Cubeword - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573402881:n5gbvgR7iknEGSzYLbJ6DtzOFLqLsRifBtxZn0TyGzo=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22A%20cubeword%20is%20a%20special%20type%20of%20a%20crossword.%20When%20building%20a%20cubeword%2C%20you%20start%20by%20choosing%20a%20positive%20integer%20%24%20a%20%24%20%3A%20the%20side%20length%20of%20the%20cube.%20Then%2C%20you%20build%20a%20big%20cube%20consisting%20of%20%24%20a%20%5C%5Ctimes%20a%20%5C%5Ctimes%20a%20%24%20unit%20cubes.%20This%20big%20cube%20has%2012%20edges.%20Then%2C%20you%20discard%20all%20unit%20cubes%20that%20do%20not%20touch%20the%20edges%20of%20the%20big%20cube.%20The%20figure%20below%20shows%20the%20object%20you%20will%20get%20for%20%24%20a%3D6%20%24%20.%5Cn%5Cn%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF1192C%5C%2Fa0e96dd13d6681a558f1021dc0e785cc5ce2afe1.png%29Finally%2C%20you%20assign%20a%20letter%20to%20each%20of%20the%20unit%20cubes%20in%20the%20object.%20You%20must%20get%20a%20meaningful%20word%20along%20each%20edge%20of%20the%20big%20cube.%20Each%20edge%20can%20be%20read%20in%20either%20direction%2C%20and%20it%20is%20sufficient%20if%20one%20of%20the%20two%20directions%20of%20reading%20gives%20a%20meaningful%20word.%5Cn%5CnThe%20figure%20below%20shows%20the%20object%20for%20%24%20a%3D6%20%24%20in%20which%20some%20unit%20cubes%20already%20have%20assigned%20letters.%20You%20can%20already%20read%20the%20words%20%27SUBMIT%27%2C%20%27ACCEPT%27%20and%20%27TURING%27%20along%20three%20edges%20of%20the%20big%20cube.%5Cn%5Cn%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF1192C%5C%2F77981496816d7f5aeed8003b9d41c46904dc5517.png%29You%20are%20given%20a%20list%20of%20valid%20words.%20Each%20word%20from%20the%20wordlist%20may%20appear%20on%20arbitrarily%20many%20edges%20of%20a%20valid%20cubeword.%20Find%20and%20report%20the%20number%20of%20different%20cubewords%20that%20can%20be%20constructed%2C%20modulo%20%24%20998%2C244%2C353%20%24%20.%5Cn%5CnIf%20one%20cubeword%20can%20be%20obtained%20from%20another%20by%20rotation%20or%20mirroring%2C%20they%20are%20considered%20distinct.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20a%20single%20integer%20%24%20n%20%24%20%28%20%24%201%20%5C%5Cleq%20n%20%5C%5Cleq%20100%2C000%20%24%20%29%20%5Cu2013%20the%20number%20of%20words.%5Cn%5CnThen%2C%20%24%20n%20%24%20lines%20follow.%20Each%20of%20these%20lines%20contains%20one%20word%20that%20can%20appear%20on%20the%20edges%20of%20the%20big%20cube.%20The%20length%20of%20each%20word%20is%20between%203%20and%2010%2C%20inclusive.%5Cn%5CnIt%20is%20guaranteed%20that%20all%20words%20are%20different.%22%2C%22outputFormat%22%3A%22Output%20a%20single%20integer%2C%20the%20number%20of%20distinct%20cubewords%20for%20the%20given%20list%20of%20valid%20words%20modulo%20%24%20998%2C244%2C353%20%24%20.%5Cn%5CnScoring%5Cn%5CnSubtask%201%20%2821%20points%29%3A%20the%20words%20consist%20only%20of%20letters%20%27a%27%20-%20%27f%27%20%28lowercase%29%5Cn%5CnSubtask%202%20%2829%20points%29%3A%20the%20words%20consist%20only%20of%20letters%20%27a%27%20-%20%27p%27%20%28lowercase%29%5Cn%5CnSubtask%203%20%2834%20points%29%3A%20the%20words%20consist%20of%20letters%20%27a%27%20-%20%27p%27%20%28lowercase%29%20and%20%27A%27%20-%20%27P%27%20%28uppercase%29%5Cn%5CnSubtask%204%20%2816%20points%29%3A%20the%20words%20consist%20of%20letters%20%27a%27%20-%20%27z%27%20%28lowercase%29%2C%20%27A%27%20-%20%27Z%27%20%28uppercase%29%20and%20digits%20%270%27%20-%20%279%27%22%2C%22samples%22%3A%5B%5B%22%5Cn1%5Cnradar%5Cn%22%2C%22%5Cn1%5Cn%22%5D%2C%5B%22%5Cn1%5Cnrobot%5Cn%22%2C%22%5Cn2%5Cn%22%5D%2C%5B%22%5Cn2%5CnFLOW%5CnWOLF%5Cn%22%2C%22%5Cn2%5Cn%22%5D%2C%5B%22%5Cn2%5Cnbaobab%5Cnbob%5Cn%22%2C%22%5Cn4097%5Cn%22%5D%2C%5B%22%5Cn3%5CnTURING%5CnSUBMIT%5CnACCEPT%5Cn%22%2C%22%5Cn162%5Cn%22%5D%2C%5B%22%5Cn3%5CnMAN1LA%5CnMAN6OS%5CnAN4NAS%5Cn%22%2C%22%5Cn114%5Cn%22%5D%5D%2C%22hint%22%3A%22In%20the%20first%20sample%2C%20the%20only%20possibility%20is%20for%20the%20word%20%5C%22radar%5C%22%20to%20be%20on%20each%20edge%20of%20the%20cube.%5Cn%5CnIn%20the%20second%20sample%2C%20there%20are%20two%20cubes%2C%20which%20are%20just%20rotations%20of%20each%20other%20%5Cu2013%20the%20word%20%5C%22robot%5C%22%20is%20on%20every%20edge%2C%20and%20the%20difference%20between%20the%20two%20cubes%20is%20whether%20the%20lower%20left%20front%20corner%20contains%20%27r%27%20or%20%27t%27.%5Cn%5CnThe%20third%20sample%20is%20similar%20to%20the%20second%20one.%20The%20fact%20that%20we%20can%20read%20the%20word%20on%20each%20edge%20in%20both%20directions%20does%20not%20affect%20the%20answer.%5Cn%5CnIn%20the%20fourth%20sample%2C%20there%20is%20one%20cube%20with%20the%20word%20%5C%22bob%5C%22%20on%20each%20edge.%20There%20are%20also%20%24%202%5E%7B12%7D%20%3D%204096%20%24%20cubes%20with%20the%20word%20%5C%22baobab%5C%22%20on%20each%20edge.%20%28For%20each%20of%20the%2012%20edges%2C%20we%20have%20two%20possible%20directions%20in%20which%20the%20word%20%5C%22baobab%5C%22%20can%20appear.%29%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1700%5D%2C%22memory%22%3A%5B1024000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F1192%5C%2FC%22%2C%22id%22%3A%221192C%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A19%2C%22totalAccepted%22%3A10%2C%22pid%22%3A%22CF1192C%22%2C%22title%22%3A%22Cubeword%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Cubeword%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Cubeword</h1>
<h2>题目描述</h2>
<div>A cubeword is a special type of a crossword. When building a cubeword, you start by choosing a positive integer $ a $ : the side length of the cube. Then, you build a big cube consisting of $ a \times a \times a $ unit cubes. This big cube has 12 edges. Then, you discard all unit cubes that do not touch the edges of the big cube. The figure below shows the object you will get for $ a=6 $ .
![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1192C/a0e96dd13d6681a558f1021dc0e785cc5ce2afe1.png)Finally, you assign a letter to each of the unit cubes in the object. You must get a meaningful word along each edge of the big cube. Each edge can be read in either direction, and it is sufficient if one of the two directions of reading gives a meaningful word.
The figure below shows the object for $ a=6 $ in which some unit cubes already have assigned letters. You can already read the words 'SUBMIT', 'ACCEPT' and 'TURING' along three edges of the big cube.
![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1192C/77981496816d7f5aeed8003b9d41c46904dc5517.png)You are given a list of valid words. Each word from the wordlist may appear on arbitrarily many edges of a valid cubeword. Find and report the number of different cubewords that can be constructed, modulo $ 998,244,353 $ .
If one cubeword can be obtained from another by rotation or mirroring, they are considered distinct.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains a single integer $ n $ ( $ 1 \leq n \leq 100,000 $ ) – the number of words.
Then, $ n $ lines follow. Each of these lines contains one word that can appear on the edges of the big cube. The length of each word is between 3 and 10, inclusive.
It is guaranteed that all words are different.</div>
<h3>输出格式</h3>
<br />
<div>Output a single integer, the number of distinct cubewords for the given list of valid words modulo $ 998,244,353 $ .
Scoring
Subtask 1 (21 points): the words consist only of letters 'a' - 'f' (lowercase)
Subtask 2 (29 points): the words consist only of letters 'a' - 'p' (lowercase)
Subtask 3 (34 points): the words consist of letters 'a' - 'p' (lowercase) and 'A' - 'P' (uppercase)
Subtask 4 (16 points): the words consist of letters 'a' - 'z' (lowercase), 'A' - 'Z' (uppercase) and digits '0' - '9'</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>
1
radar
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>
1
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>
1
robot
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>
2
</code></pre>
<h3>输入样例 #3</h3>
<pre><code>
2
FLOW
WOLF
</code></pre>
<h3>输出样例 #3</h3>
<pre><code>
2
</code></pre>
<h3>输入样例 #4</h3>
<pre><code>
2
baobab
bob
</code></pre>
<h3>输出样例 #4</h3>
<pre><code>
4097
</code></pre>
<h3>输入样例 #5</h3>
<pre><code>
3
TURING
SUBMIT
ACCEPT
</code></pre>
<h3>输出样例 #5</h3>
<pre><code>
162
</code></pre>
<h3>输入样例 #6</h3>
<pre><code>
3
MAN1LA
MAN6OS
AN4NAS
</code></pre>
<h3>输出样例 #6</h3>
<pre><code>
114
</code></pre>
<h2>说明</h2>
<div>In the first sample, the only possibility is for the word "radar" to be on each edge of the cube.
In the second sample, there are two cubes, which are just rotations of each other – the word "robot" is on every edge, and the difference between the two cubes is whether the lower left front corner contains 'r' or 't'.
The third sample is similar to the second one. The fact that we can read the word on each edge in both directions does not affect the answer.
In the fourth sample, there is one cube with the word "bob" on each edge. There are also $ 2^{12} = 4096 $ cubes with the word "baobab" on each edge. (For each of the 12 edges, we have two possible directions in which the word "baobab" can appear.)</div>
</article>
</div>
</div>
</body>
</html>
