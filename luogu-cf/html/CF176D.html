<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Hyper String - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573391429:EI3Zu1Jbet6ghI+7ShgHffn/O0Qihpkkw6hqBuHzZDo=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Paul%20Erd%5Cu0151s%27s%20prediction%20came%20true.%20Finally%20an%20alien%20force%20landed%20on%20the%20Earth.%20In%20contrary%20to%20our%20expectation%20they%20didn%27t%20asked%20the%20humans%20to%20compute%20the%20value%20of%20a%20Ramsey%20number%20%28maybe%20they%20had%20solved%20it%20themselves%29.%20They%20asked%20another%20question%20which%20seemed%20as%20hard%20as%20calculating%20Ramsey%20numbers.%20Aliens%20threatened%20that%20if%20humans%20don%27t%20solve%20this%20problem%20in%20less%20than%202%20hours%20they%20will%20destroy%20the%20Earth.%5Cn%5CnBefore%20telling%20the%20problem%20they%20introduced%20the%20concept%20of%20Hyper%20Strings.%20A%20Hyper%20String%20is%20made%20by%20concatenation%20of%20some%20base%20strings.%20Suppose%20you%20are%20given%20a%20list%20of%20base%20strings%20%24%20b_%7B1%7D%2Cb_%7B2%7D%2C...%2Cb_%7Bn%7D%20%24%20.%20Now%20the%20Hyper%20String%20made%20from%20indices%20list%20%24%20i_%7B1%7D%2Ci_%7B2%7D%2C...%2Ci_%7Bm%7D%20%24%20is%20concatenation%20of%20base%20strings%20%24%20b_%7Bi1%7D%2Cb_%7Bi2%7D%2C...%2Cb_%7Bim%7D%20%24%20.%20A%20Hyper%20String%20can%20be%20very%20large%20and%20doing%20operations%20on%20it%20is%20very%20costly%20for%20computers.%5Cn%5CnThe%20aliens%20asked%20humans%20to%20compute%20the%20length%20of%20the%20longest%20common%20sub-sequence%20of%20a%20Hyper%20String%20%24%20t%20%24%20with%20a%20string%20%24%20s%20%24%20.%22%2C%22inputFormat%22%3A%22The%20first%20line%20of%20input%20contains%20the%20single%20integer%20%24%20n%20%24%20%28%20%24%201%3C%3Dn%3C%3D2000%20%24%20%29%20%5Cu2014%20the%20number%20of%20base%20strings.%5Cn%5CnThe%20next%20%24%20n%20%24%20lines%20contains%20values%20of%20base%20strings.%20Each%20base%20string%20is%20made%20of%20lowercase%20Latin%20letters.%20A%20base%20string%20cannot%20be%20empty%20string%20and%20the%20sum%20of%20lengths%20of%20all%20%24%20n%20%24%20base%20strings%20doesn%27t%20exceed%20%24%2010%5E%7B6%7D%20%24%20.%5Cn%5CnThe%20next%20line%20contains%20the%20single%20integer%20%24%20m%20%24%20%28%20%24%201%3C%3Dm%3C%3D2000%20%24%20%29%20%5Cu2014%20the%20number%20of%20base%20strings%20in%20the%20given%20Hyper%20String%20%24%20t%20%24%20.%5Cn%5CnThe%20next%20line%20contains%20%24%20m%20%24%20space-separated%20integer%20numbers%20%24%20i_%7B1%7D%2Ci_%7B2%7D%2C...%2Ci_%7Bm%7D%20%24%20%28%20%24%201%3C%3Di_%7Bj%7D%3C%3Dn%20%24%20%29%20%5Cu2014%20the%20indices%20of%20base%20strings%20in%20the%20Hyper%20String%20%24%20t%20%24%20.%5Cn%5CnThe%20last%20line%20contains%20a%20non-empty%20string%20%24%20s%20%24%20.%20String%20%24%20s%20%24%20is%20made%20of%20lowercase%20Latin%20letters%20and%20its%20length%20is%20no%20more%20than%20%24%202000%20%24%20characters.%22%2C%22outputFormat%22%3A%22Print%20the%20length%20of%20longest%20common%20sub-sequence%20of%20Hyper%20String%20%24%20t%20%24%20and%20string%20%24%20s%20%24%20.%20If%20there%20is%20no%20common%20sub-sequence%20print%200.%22%2C%22samples%22%3A%5B%5B%222%5Cncba%5Cndgh%5Cn2%5Cn1%202%5Cnaedfhr%5Cn%22%2C%223%5Cn%22%5D%2C%5B%222%5Cnb%5Cna%5Cn5%5Cn1%202%201%202%201%5Cnaaa%5Cn%22%2C%222%5Cn%22%5D%5D%2C%22hint%22%3A%22The%20length%20of%20string%20%24%20s%20%24%20is%20the%20number%20of%20characters%20in%20it.%20If%20the%20length%20of%20string%20%24%20s%20%24%20is%20marked%20as%20%24%20%7Cs%7C%20%24%20%2C%20then%20string%20%24%20s%20%24%20can%20be%20represented%20as%20%24%20s%3Ds_%7B1%7Ds_%7B2%7D...%5C%5C%20s_%7B%7Cs%7C%7D%20%24%20.%5Cn%5CnA%20non-empty%20string%20%24%20y%3Ds%5Bp_%7B1%7Dp_%7B2%7D...%5C%5C%20p_%7B%7Cy%7C%7D%5D%3Ds_%7Bp1%7Ds_%7Bp2%7D...%5C%5C%20s_%7Bp%7Cy%7C%7D%20%24%20%28%20%24%201%3C%3Dp_%7B1%7D%26lt%3Bp_%7B2%7D%26lt%3B...%26lt%3Bp_%7B%7Cy%7C%7D%3C%3D%7Cs%7C%20%24%20%29%20is%20a%20subsequence%20of%20string%20%24%20s%20%24%20.%20For%20example%2C%20%5C%22coders%5C%22%20is%20a%20subsequence%20of%20%5C%22codeforces%5C%22.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F176%5C%2FD%22%2C%22id%22%3A%22176D%22%7D%2C%22translation%22%3A%22%5Cu7ed9%5Cu5b9a%24N%28N%20%5C%5Cle%202000%29%24%5Cu4e2a%5Cu5c0f%5Cu5199%5Cu82f1%5Cu6587%5Cu5b57%5Cu6bcd%5Cu7ec4%5Cu6210%5Cu7684%5Cu5b57%5Cu7b26%5Cu4e32%24%7Ba_i%7D%24%5Cuff0c%5Cu603b%5Cu957f%5Cu5ea6%5Cu4e0d%5Cu8d85%5Cu8fc7%2410%20%5E%206%24%5Cu3002%5Cu518d%5Cu7ed9%5Cu5b9a%5Cu4e00%5Cu4e2a%5Cu957f%5Cu5ea6%5Cu4e3a%24M%28M%20%5C%5Cle%202000%29%24%5Cu7684%5Cu6b63%5Cu6574%5Cu6570%5Cu5e8f%5Cu5217%24%7Bb_i%7D%281%20%5C%5Cle%20b_i%20%5C%5Cle%20N%29%24%5Cuff0c%5Cu5b9a%5Cu4e49%24A%20%3D%20a_%7Bb_1%7D%20%2B%20a_%7Bb_2%7D%20%2B%20...%20%2B%20a_%7Bb_M%7D%24%5Cuff0c%5Cu5176%5Cu4e2d%24%2B%24%5Cu8868%5Cu793a%5Cu5b57%5Cu7b26%5Cu4e32%5Cu7684%5Cu8fde%5Cu63a5%5Cu3002%5Cu6700%5Cu540e%5Cu7ed9%5Cu5b9a%5Cu4e00%5Cu4e2a%5Cu5c0f%5Cu5199%5Cu82f1%5Cu6587%5Cu5b57%5Cu6bcd%5Cu7ec4%5Cu6210%5Cu7684%5Cu5b57%5Cu7b26%5Cu4e32%24B%28%7CB%7C%20%5C%5Cle%202000%29%24%5Cuff0c%5Cu6c42%24A%24%5Cu548c%24B%24%5Cu7684%5Cu6700%5Cu957f%5Cu516c%5Cu5171%5Cu5b50%5Cu5e8f%5Cu5217%5Cu957f%5Cu5ea6%5Cu3002%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A9%2C%22totalAccepted%22%3A3%2C%22pid%22%3A%22CF176D%22%2C%22title%22%3A%22Hyper%20String%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Hyper%20String%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573295103;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Hyper String</h1>
<h2>题意翻译</h2>
<div>给定$N(N \le 2000)$个小写英文字母组成的字符串${a_i}$，总长度不超过$10 ^ 6$。再给定一个长度为$M(M \le 2000)$的正整数序列${b_i}(1 \le b_i \le N)$，定义$A = a_{b_1} + a_{b_2} + ... + a_{b_M}$，其中$+$表示字符串的连接。最后给定一个小写英文字母组成的字符串$B(|B| \le 2000)$，求$A$和$B$的最长公共子序列长度。</div>
<h2>题目描述</h2>
<div>Paul Erdős's prediction came true. Finally an alien force landed on the Earth. In contrary to our expectation they didn't asked the humans to compute the value of a Ramsey number (maybe they had solved it themselves). They asked another question which seemed as hard as calculating Ramsey numbers. Aliens threatened that if humans don't solve this problem in less than 2 hours they will destroy the Earth.
Before telling the problem they introduced the concept of Hyper Strings. A Hyper String is made by concatenation of some base strings. Suppose you are given a list of base strings $ b_{1},b_{2},...,b_{n} $ . Now the Hyper String made from indices list $ i_{1},i_{2},...,i_{m} $ is concatenation of base strings $ b_{i1},b_{i2},...,b_{im} $ . A Hyper String can be very large and doing operations on it is very costly for computers.
The aliens asked humans to compute the length of the longest common sub-sequence of a Hyper String $ t $ with a string $ s $ .</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line of input contains the single integer $ n $ ( $ 1<=n<=2000 $ ) — the number of base strings.
The next $ n $ lines contains values of base strings. Each base string is made of lowercase Latin letters. A base string cannot be empty string and the sum of lengths of all $ n $ base strings doesn't exceed $ 10^{6} $ .
The next line contains the single integer $ m $ ( $ 1<=m<=2000 $ ) — the number of base strings in the given Hyper String $ t $ .
The next line contains $ m $ space-separated integer numbers $ i_{1},i_{2},...,i_{m} $ ( $ 1<=i_{j}<=n $ ) — the indices of base strings in the Hyper String $ t $ .
The last line contains a non-empty string $ s $ . String $ s $ is made of lowercase Latin letters and its length is no more than $ 2000 $ characters.</div>
<h3>输出格式</h3>
<br />
<div>Print the length of longest common sub-sequence of Hyper String $ t $ and string $ s $ . If there is no common sub-sequence print 0.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>2
cba
dgh
2
1 2
aedfhr
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>3
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>2
b
a
5
1 2 1 2 1
aaa
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>2
</code></pre>
<h2>说明</h2>
<div>The length of string $ s $ is the number of characters in it. If the length of string $ s $ is marked as $ |s| $ , then string $ s $ can be represented as $ s=s_{1}s_{2}...\ s_{|s|} $ .
A non-empty string $ y=s[p_{1}p_{2}...\ p_{|y|}]=s_{p1}s_{p2}...\ s_{p|y|} $ ( $ 1<=p_{1}&lt;p_{2}&lt;...&lt;p_{|y|}<=|s| $ ) is a subsequence of string $ s $ . For example, "coders" is a subsequence of "codeforces".</div>
</article>
</div>
</div>
</body>
</html>
