<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Mashmokh and Reverse Operation - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573393856:r8UNga//j0wNH3LNRr4CLXwHOJL2bKZV/JDaLgyRFow=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Mashmokh%27s%20boss%2C%20Bimokh%2C%20didn%27t%20like%20Mashmokh.%20So%20he%20fired%20him.%20Mashmokh%20decided%20to%20go%20to%20university%20and%20participate%20in%20ACM%20instead%20of%20finding%20a%20new%20job.%20He%20wants%20to%20become%20a%20member%20of%20Bamokh%27s%20team.%20In%20order%20to%20join%20he%20was%20given%20some%20programming%20tasks%20and%20one%20week%20to%20solve%20them.%20Mashmokh%20is%20not%20a%20very%20experienced%20programmer.%20Actually%20he%20is%20not%20a%20programmer%20at%20all.%20So%20he%20wasn%27t%20able%20to%20solve%20them.%20That%27s%20why%20he%20asked%20you%20to%20help%20him%20with%20these%20tasks.%20One%20of%20these%20tasks%20is%20the%20following.%5Cn%5CnYou%20have%20an%20array%20%24%20a%20%24%20of%20length%20%24%202%5E%7Bn%7D%20%24%20and%20%24%20m%20%24%20queries%20on%20it.%20The%20%24%20i%20%24%20-th%20query%20is%20described%20by%20an%20integer%20%24%20q_%7Bi%7D%20%24%20.%20In%20order%20to%20perform%20the%20%24%20i%20%24%20-th%20query%20you%20must%3A%5Cn%5Cn-%20split%20the%20array%20into%20%24%202%5E%7Bn-q_%7Bi%7D%7D%20%24%20parts%2C%20where%20each%20part%20is%20a%20subarray%20consisting%20of%20%24%202%5E%7Bq_%7Bi%7D%7D%20%24%20numbers%3B%20the%20%24%20j%20%24%20-th%20subarray%20%24%20%281%3C%3Dj%3C%3D2%5E%7Bn-q_%7Bi%7D%7D%29%20%24%20should%20contain%20the%20elements%20%24%20a%5B%28j-1%29%5Cu00b72%5E%7Bq_%7Bi%7D%7D%2B1%5D%2Ca%5B%28j-1%29%5Cu00b72%5E%7Bq_%7Bi%7D%7D%2B2%5D%2C...%2Ca%5B%28j-1%29%5Cu00b72%5E%7Bq_%7Bi%7D%7D%2B2%5E%7Bq_%7Bi%7D%7D%5D%20%24%20%3B%5Cn-%20reverse%20each%20of%20the%20subarrays%3B%5Cn-%20join%20them%20into%20a%20single%20array%20in%20the%20same%20order%20%28this%20array%20becomes%20new%20array%20%24%20a%20%24%20%29%3B%5Cn-%20output%20the%20number%20of%20inversions%20in%20the%20new%20%24%20a%20%24%20.%5Cn%5CnGiven%20initial%20array%20%24%20a%20%24%20and%20all%20the%20queries.%20Answer%20all%20the%20queries.%20Please%2C%20note%20that%20the%20changes%20from%20some%20query%20is%20saved%20for%20further%20queries.%22%2C%22inputFormat%22%3A%22The%20first%20line%20of%20input%20contains%20a%20single%20integer%20%24%20n%5Cu00a0%280%3C%3Dn%3C%3D20%29%20%24%20.%5Cn%5CnThe%20second%20line%20of%20input%20contains%20%24%202%5E%7Bn%7D%20%24%20space-separated%20integers%20%24%20a%5B1%5D%2Ca%5B2%5D%2C...%2Ca%5B2%5E%7Bn%7D%5D%5Cu00a0%281%3C%3Da%5Bi%5D%3C%3D10%5E%7B9%7D%29%20%24%20%2C%20the%20initial%20array.%5Cn%5CnThe%20third%20line%20of%20input%20contains%20a%20single%20integer%20%24%20m%5Cu00a0%281%3C%3Dm%3C%3D10%5E%7B6%7D%29%20%24%20.%5Cn%5CnThe%20fourth%20line%20of%20input%20contains%20%24%20m%20%24%20space-separated%20integers%20%24%20q_%7B1%7D%2Cq_%7B2%7D%2C...%2Cq_%7Bm%7D%5Cu00a0%280%3C%3Dq_%7Bi%7D%3C%3Dn%29%20%24%20%2C%20the%20queries.%5Cn%5CnNote%3A%20since%20the%20size%20of%20the%20input%20and%20output%20could%20be%20very%20large%2C%20don%27t%20use%20slow%20output%20techniques%20in%20your%20language.%20For%20example%2C%20do%20not%20use%20input%20and%20output%20streams%20%28cin%2C%20cout%29%20in%20C%2B%2B.%22%2C%22outputFormat%22%3A%22Output%20%24%20m%20%24%20lines.%20In%20the%20%24%20i%20%24%20-th%20line%20print%20the%20answer%20%28the%20number%20of%20inversions%29%20for%20the%20%24%20i%20%24%20-th%20query.%22%2C%22samples%22%3A%5B%5B%222%5Cn2%201%204%203%5Cn4%5Cn1%202%200%202%5Cn%22%2C%220%5Cn6%5Cn6%5Cn0%5Cn%22%5D%2C%5B%221%5Cn1%202%5Cn3%5Cn0%201%201%5Cn%22%2C%220%5Cn1%5Cn0%5Cn%22%5D%5D%2C%22hint%22%3A%22If%20we%20reverse%20an%20array%20%24%20x%5B1%5D%2Cx%5B2%5D%2C...%2Cx%5Bn%5D%20%24%20it%20becomes%20new%20array%20%24%20y%5B1%5D%2Cy%5B2%5D%2C...%2Cy%5Bn%5D%20%24%20%2C%20where%20%24%20y%5Bi%5D%3Dx%5Bn-i%2B1%5D%20%24%20for%20each%20%24%20i%20%24%20.%5Cn%5CnThe%20number%20of%20inversions%20of%20an%20array%20%24%20x%5B1%5D%2Cx%5B2%5D%2C...%2Cx%5Bn%5D%20%24%20is%20the%20number%20of%20pairs%20of%20indices%20%24%20i%2Cj%20%24%20such%20that%3A%20%24%20i%26lt%3Bj%20%24%20and%20%24%20x%5Bi%5D%26gt%3Bx%5Bj%5D%20%24%20.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B4000%5D%2C%22memory%22%3A%5B512000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F414%5C%2FC%22%2C%22id%22%3A%22414C%22%7D%2C%22translation%22%3A%22%5Cu7ed9%5Cu51fa%5Cu4e00%5Cu4e2a%5Cu957f%5Cu5ea6%5Cu4e3a2%5En%5Cu7684%5Cu5e8f%5Cu5217%5Cuff0cm%5Cu6b21%5Cu64cd%5Cu4f5c%5Cuff0c%5Cu6bcf%5Cu6b21%5Cu64cd%5Cu4f5c%5Cu7ed9%5Cu51fa%5Cu4e00%5Cu6574%5Cu6570q%5Cuff0c%5Cu628a%5Cu8be5%5Cu5e8f%5Cu5217%5Cu5206%5Cu6210%5Cu8fde%5Cu7eed%5Cu7684%5Cu957f%5Cu5ea6%5Cu5747%5Cu4e3a2%5Eq%5Cu76842%5E%28n-q%29%5Cu6bb5%5Cu540e%5Cuff0c%5Cu628a%5Cu6bcf%5Cu6bb5%5Cu53cd%5Cu8f6c%5Cuff0c%5Cu5e76%5Cu67e5%5Cu8be2%5Cu53cd%5Cu8f6c%5Cu540e%5Cu7684%5Cu9006%5Cu5e8f%5Cu5bf9%20%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A50%2C%22totalAccepted%22%3A16%2C%22pid%22%3A%22CF414C%22%2C%22title%22%3A%22Mashmokh%20and%20Reverse%20Operation%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P3960%22%2C%22title%22%3A%22%5Cu5217%5Cu961f%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P3835%22%2C%22title%22%3A%22%5Cu3010%5Cu6a21%5Cu677f%5Cu3011%5Cu53ef%5Cu6301%5Cu4e45%5Cu5316%5Cu5e73%5Cu8861%5Cu6811%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P4929%22%2C%22title%22%3A%22%5Cu3010%5Cu6a21%5Cu677f%5Cu3011%5Cu821e%5Cu8e48%5Cu94fe%5Cuff08DLX%5Cuff09%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22CF1238B%22%2C%22title%22%3A%22Kill%20%27Em%20All%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1238A%22%2C%22title%22%3A%22Prime%20Subtraction%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Mashmokh%20and%20Reverse%20Operation%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573306449;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Mashmokh and Reverse Operation</h1>
<h2>题意翻译</h2>
<div>给出一个长度为2^n的序列，m次操作，每次操作给出一整数q，把该序列分成连续的长度均为2^q的2^(n-q)段后，把每段反转，并查询反转后的逆序对 </div>
<h2>题目描述</h2>
<div>Mashmokh's boss, Bimokh, didn't like Mashmokh. So he fired him. Mashmokh decided to go to university and participate in ACM instead of finding a new job. He wants to become a member of Bamokh's team. In order to join he was given some programming tasks and one week to solve them. Mashmokh is not a very experienced programmer. Actually he is not a programmer at all. So he wasn't able to solve them. That's why he asked you to help him with these tasks. One of these tasks is the following.
You have an array $ a $ of length $ 2^{n} $ and $ m $ queries on it. The $ i $ -th query is described by an integer $ q_{i} $ . In order to perform the $ i $ -th query you must:
- split the array into $ 2^{n-q_{i}} $ parts, where each part is a subarray consisting of $ 2^{q_{i}} $ numbers; the $ j $ -th subarray $ (1<=j<=2^{n-q_{i}}) $ should contain the elements $ a[(j-1)·2^{q_{i}}+1],a[(j-1)·2^{q_{i}}+2],...,a[(j-1)·2^{q_{i}}+2^{q_{i}}] $ ;
- reverse each of the subarrays;
- join them into a single array in the same order (this array becomes new array $ a $ );
- output the number of inversions in the new $ a $ .
Given initial array $ a $ and all the queries. Answer all the queries. Please, note that the changes from some query is saved for further queries.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line of input contains a single integer $ n (0<=n<=20) $ .
The second line of input contains $ 2^{n} $ space-separated integers $ a[1],a[2],...,a[2^{n}] (1<=a[i]<=10^{9}) $ , the initial array.
The third line of input contains a single integer $ m (1<=m<=10^{6}) $ .
The fourth line of input contains $ m $ space-separated integers $ q_{1},q_{2},...,q_{m} (0<=q_{i}<=n) $ , the queries.
Note: since the size of the input and output could be very large, don't use slow output techniques in your language. For example, do not use input and output streams (cin, cout) in C++.</div>
<h3>输出格式</h3>
<br />
<div>Output $ m $ lines. In the $ i $ -th line print the answer (the number of inversions) for the $ i $ -th query.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>2
2 1 4 3
4
1 2 0 2
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>0
6
6
0
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>1
1 2
3
0 1 1
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>0
1
0
</code></pre>
<h2>说明</h2>
<div>If we reverse an array $ x[1],x[2],...,x[n] $ it becomes new array $ y[1],y[2],...,y[n] $ , where $ y[i]=x[n-i+1] $ for each $ i $ .
The number of inversions of an array $ x[1],x[2],...,x[n] $ is the number of pairs of indices $ i,j $ such that: $ i&lt;j $ and $ x[i]&gt;x[j] $ .</div>
</article>
</div>
</div>
</body>
</html>
