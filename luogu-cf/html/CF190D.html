<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Non-Secret Cypher - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573391584:AYZiQcGAbTCQGESoPsadG7SHOnuAQJGLsCWnZZnPQF4=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Berland%20starts%20to%20seize%20the%20initiative%20on%20the%20war%20with%20Flatland.%20To%20drive%20the%20enemy%20from%20their%20native%20land%2C%20the%20berlanders%20need%20to%20know%20exactly%20how%20many%20more%20flatland%20soldiers%20are%20left%20in%20the%20enemy%27s%20reserve.%20Fortunately%2C%20the%20scouts%20captured%20an%20enemy%20in%20the%20morning%2C%20who%20had%20a%20secret%20encrypted%20message%20with%20the%20information%20the%20berlanders%20needed%20so%20much.%5Cn%5CnThe%20captured%20enemy%20had%20an%20array%20of%20positive%20integers.%20Berland%20intelligence%20have%20long%20been%20aware%20of%20the%20flatland%20code%3A%20to%20convey%20the%20message%2C%20which%20contained%20a%20number%20%24%20m%20%24%20%2C%20the%20enemies%20use%20an%20array%20of%20integers%20%24%20a%20%24%20.%20The%20number%20of%20its%20subarrays%2C%20in%20which%20there%20are%20at%20least%20%24%20k%20%24%20equal%20numbers%2C%20equals%20%24%20m%20%24%20.%20The%20number%20%24%20k%20%24%20has%20long%20been%20known%20in%20the%20Berland%20army%20so%20General%20Touristov%20has%20once%20again%20asked%20Corporal%20Vasya%20to%20perform%20a%20simple%20task%3A%20to%20decipher%20the%20flatlanders%27%20message.%5Cn%5CnHelp%20Vasya%2C%20given%20an%20array%20of%20integers%20%24%20a%20%24%20and%20number%20%24%20k%20%24%20%2C%20find%20the%20number%20of%20subarrays%20of%20the%20array%20of%20numbers%20%24%20a%20%24%20%2C%20which%20has%20at%20least%20%24%20k%20%24%20equal%20numbers.%5Cn%5CnSubarray%20%24%20a%5Bi...%5C%5C%20j%5D%5Cu00a0%281%3C%3Di%3C%3Dj%3C%3Dn%29%20%24%20of%20array%20%24%20a%3D%28a_%7B1%7D%2Ca_%7B2%7D%2C...%2Ca_%7Bn%7D%29%20%24%20is%20an%20array%2C%20made%20from%20its%20consecutive%20elements%2C%20starting%20from%20the%20%24%20i%20%24%20-th%20one%20and%20ending%20with%20the%20%24%20j%20%24%20-th%20one%3A%20%24%20a%5Bi...%5C%5C%20j%5D%3D%28a_%7Bi%7D%2Ca_%7Bi%2B1%7D%2C...%2Ca_%7Bj%7D%29%20%24%20.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20two%20space-separated%20integers%20%24%20n%20%24%20%2C%20%24%20k%20%24%20%24%20%281%3C%3Dk%3C%3Dn%3C%3D4%5Cu00b710%5E%7B5%7D%29%20%24%20%2C%20showing%20how%20many%20numbers%20an%20array%20has%20and%20how%20many%20equal%20numbers%20the%20subarrays%20are%20required%20to%20have%2C%20correspondingly.%5Cn%5CnThe%20second%20line%20contains%20%24%20n%20%24%20space-separated%20integers%20%24%20a_%7Bi%7D%20%24%20%28%20%24%201%3C%3Da_%7Bi%7D%3C%3D10%5E%7B9%7D%20%24%20%29%20%5Cu2014%20elements%20of%20the%20array.%22%2C%22outputFormat%22%3A%22Print%20the%20single%20number%20%5Cu2014%20the%20number%20of%20such%20subarrays%20of%20array%20%24%20a%20%24%20%2C%20that%20they%20have%20at%20least%20%24%20k%20%24%20equal%20integers.%5Cn%5CnPlease%20do%20not%20use%20the%20%25lld%20specifier%20to%20read%20or%20write%2064-bit%20integers%20in%20%5Cu0421%2B%2B.%20In%20is%20preferred%20to%20use%20the%20cin%2C%20cout%20streams%20or%20the%20%25I64d%20specifier.%22%2C%22samples%22%3A%5B%5B%224%202%5Cn1%202%201%202%5Cn%22%2C%223%22%5D%2C%5B%225%203%5Cn1%202%201%201%203%5Cn%22%2C%222%22%5D%2C%5B%223%201%5Cn1%201%201%5Cn%22%2C%226%22%5D%5D%2C%22hint%22%3A%22In%20the%20first%20sample%20are%20three%20subarrays%2C%20containing%20at%20least%20two%20equal%20numbers%3A%20%281%2C2%2C1%29%2C%20%282%2C1%2C2%29%20and%20%281%2C2%2C1%2C2%29.%5Cn%5CnIn%20the%20second%20sample%20are%20two%20subarrays%2C%20containing%20three%20equal%20numbers%3A%20%281%2C2%2C1%2C1%2C3%29%20and%20%281%2C2%2C1%2C1%29.%5Cn%5CnIn%20the%20third%20sample%20any%20subarray%20contains%20at%20least%20one%201%20number.%20Overall%20they%20are%206%3A%20%281%29%2C%20%281%29%2C%20%281%29%2C%20%281%2C1%29%2C%20%281%2C1%29%20and%20%281%2C1%2C1%29.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B3000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F190%5C%2FD%22%2C%22id%22%3A%22190D%22%7D%2C%22translation%22%3A%22%5Cu7ed9%5Cu5b9aN%5Cu4e2a%5Cu6570.%5C%5C%5Cr%5Cn%5Cu95ee%5Cu6709%5Cu591a%5Cu5c11%5Cu8fde%5Cu7eed%5Cu5b50%5Cu6bb5%5Cu6ee1%5Cu8db3%5Cuff0c%5Cu8fd9%5Cu4e00%5Cu6bb5%5Cu5185%5Cu7684%5Cu6570%5Cu4e2d%5Cuff0c%5Cu51fa%5Cu73b0%5Cu6b21%5Cu6570%5Cu6700%5Cu591a%5Cu7684%5Cu4e00%5Cu4e2a%5Cu6570%5Cu7684%5Cu51fa%5Cu73b0%5Cu6b21%5Cu6570%3E%3DK.%5Cr%5Cn%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A4%2C%22totalAccepted%22%3A2%2C%22pid%22%3A%22CF190D%22%2C%22title%22%3A%22Non-Secret%20Cypher%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Non-Secret%20Cypher%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Non-Secret Cypher</h1>
<h2>题意翻译</h2>
<div>给定N个数.\
问有多少连续子段满足，这一段内的数中，出现次数最多的一个数的出现次数>=K.
</div>
<h2>题目描述</h2>
<div>Berland starts to seize the initiative on the war with Flatland. To drive the enemy from their native land, the berlanders need to know exactly how many more flatland soldiers are left in the enemy's reserve. Fortunately, the scouts captured an enemy in the morning, who had a secret encrypted message with the information the berlanders needed so much.
The captured enemy had an array of positive integers. Berland intelligence have long been aware of the flatland code: to convey the message, which contained a number $ m $ , the enemies use an array of integers $ a $ . The number of its subarrays, in which there are at least $ k $ equal numbers, equals $ m $ . The number $ k $ has long been known in the Berland army so General Touristov has once again asked Corporal Vasya to perform a simple task: to decipher the flatlanders' message.
Help Vasya, given an array of integers $ a $ and number $ k $ , find the number of subarrays of the array of numbers $ a $ , which has at least $ k $ equal numbers.
Subarray $ a[i...\ j] (1<=i<=j<=n) $ of array $ a=(a_{1},a_{2},...,a_{n}) $ is an array, made from its consecutive elements, starting from the $ i $ -th one and ending with the $ j $ -th one: $ a[i...\ j]=(a_{i},a_{i+1},...,a_{j}) $ .</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains two space-separated integers $ n $ , $ k $ $ (1<=k<=n<=4·10^{5}) $ , showing how many numbers an array has and how many equal numbers the subarrays are required to have, correspondingly.
The second line contains $ n $ space-separated integers $ a_{i} $ ( $ 1<=a_{i}<=10^{9} $ ) — elements of the array.</div>
<h3>输出格式</h3>
<br />
<div>Print the single number — the number of such subarrays of array $ a $ , that they have at least $ k $ equal integers.
Please do not use the %lld specifier to read or write 64-bit integers in С++. In is preferred to use the cin, cout streams or the %I64d specifier.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>4 2
1 2 1 2
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>3</code></pre>
<h3>输入样例 #2</h3>
<pre><code>5 3
1 2 1 1 3
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>2</code></pre>
<h3>输入样例 #3</h3>
<pre><code>3 1
1 1 1
</code></pre>
<h3>输出样例 #3</h3>
<pre><code>6</code></pre>
<h2>说明</h2>
<div>In the first sample are three subarrays, containing at least two equal numbers: (1,2,1), (2,1,2) and (1,2,1,2).
In the second sample are two subarrays, containing three equal numbers: (1,2,1,1,3) and (1,2,1,1).
In the third sample any subarray contains at least one 1 number. Overall they are 6: (1), (1), (1), (1,1), (1,1) and (1,1,1).</div>
</article>
</div>
</div>
</body>
</html>
