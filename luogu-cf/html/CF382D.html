<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Ksenia and Pawns - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573393497:iuRw8dHtVn4SvuiZT+I6liCF3mjApKipLmO4s69okWQ=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Ksenia%20has%20a%20chessboard%20of%20size%20%24%20n%5Cu00d7m%20%24%20.%20Each%20cell%20of%20the%20chessboard%20contains%20one%20of%20the%20characters%3A%20%5C%22%3C%5C%22%2C%20%5C%22%3E%5C%22%2C%20%5C%22%5E%5C%22%2C%20%5C%22v%5C%22%2C%20%5C%22%5C%5C%23%5C%22.%20The%20cells%20that%20contain%20character%20%5C%22%5C%5C%23%5C%22%20are%20blocked.%20We%20know%20that%20all%20chessboard%20cells%20that%20touch%20the%20border%20are%20blocked.%5Cn%5CnKsenia%20is%20playing%20with%20two%20pawns%20on%20this%20chessboard.%20Initially%2C%20she%20puts%20the%20pawns%20on%20the%20chessboard.%20One%20cell%20of%20the%20chessboard%20can%20contain%20two%20pawns%20if%20and%20only%20if%20the%20cell%20is%20blocked.%20In%20other%20cases%20two%20pawns%20can%20not%20stand%20in%20one%20cell.%20The%20game%20begins%20when%20Ksenia%20put%20pawns%20on%20the%20board.%20In%20one%20move%2C%20Ksenia%20moves%20each%20pawn%20to%20a%20side%20adjacent%20cell%20in%20the%20direction%20of%20arrows%20painted%20on%20the%20cell%20on%20which%20the%20corresponding%20pawn%20sits%20%28if%20the%20pawn%20sits%20on%20%5C%22%5C%5C%23%5C%22%2C%20it%20does%20not%20move%29.%20Assume%20that%20Ksenia%20moves%20pawns%20simultaneously%20%28see%20the%20second%20test%20case%29.%5Cn%5CnOf%20course%2C%20Ksenia%20plays%20for%20points.%20How%20can%20one%20calculate%20the%20points%20per%20game%3F%20Very%20simply%21%20Let%27s%20count%20how%20many%20movements%20the%20first%20pawn%20made%20and%20how%20many%20movements%20the%20second%20pawn%20made%2C%20sum%20these%20two%20numbers%20%5Cu2014%20it%20will%20be%20the%20resulting%20score%20of%20the%20game.%5Cn%5CnKsenia%20wonders%3A%20what%20is%20the%20maximum%20number%20of%20points%20she%20can%20earn%20%28for%20that%2C%20she%20should%20place%20the%20pawns%20optimally%20well%20early%20in%20the%20game%29.%20Help%20her%20and%20find%20that%20number.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20two%20integers%2C%20%24%20n%20%24%20and%20%24%20m%20%24%20%24%20%281%3C%3Dn%2Cm%3C%3D2000%29%20%24%20%5Cu2014%20the%20sizes%20of%20the%20board.%20Each%20of%20the%20following%20%24%20n%20%24%20lines%20contains%20%24%20m%20%24%20characters%20%5Cu2013%20the%20board%27s%20description.%20Each%20character%20is%20one%20of%20the%20characters%3A%20%5C%22%3C%5C%22%2C%20%5C%22%3E%5C%22%2C%20%5C%22%5E%5C%22%2C%20%5C%22v%5C%22%2C%20%5C%22%5C%5C%23%5C%22.%5Cn%5CnIt%20is%20guaranteed%20that%20the%20border%20cells%20of%20the%20table%20are%20blocked%20cells%20%28with%20character%20%5C%22%5C%5C%23%5C%22%29.%22%2C%22outputFormat%22%3A%22If%20Ksenia%20can%20get%20infinitely%20many%20points%2C%20print%20-1.%20Otherwise%2C%20print%20the%20maximum%20number%20of%20points%20she%20can%20get.%22%2C%22samples%22%3A%5B%5B%221%201%5Cn%23%5Cn%22%2C%220%5Cn%22%5D%2C%5B%223%204%5Cn%23%23%23%23%5Cn%23%26gt%3B%5E%7B%7D%23%5Cn%23%23%23%23%5Cn%22%2C%223%22%5D%2C%5B%223%204%5Cn%23%23%23%23%5Cn%23%26gt%3B%26lt%3B%23%5Cn%23%23%23%23%5Cn%22%2C%22-1%22%5D%2C%5B%227%205%5Cn%23%23%23%23%23%5Cn%23%23v%23%23%5Cn%23%23v%23%23%5Cn%23%23%23%23%23%5Cn%23%23%5E%7B%7D%23%23%5Cn%23%23%5E%7B%7D%23%23%5Cn%23%23%23%23%23%5Cn%22%2C%224%22%5D%2C%5B%227%205%5Cn%23%23%23%23%23%5Cn%23%23v%23%23%5Cn%23%23v%23%23%5Cn%23%23%26lt%3B%23%23%5Cn%23%23%5E%7B%7D%23%23%5Cn%23%23%5E%7B%7D%23%23%5Cn%23%23%23%23%23%22%2C%225%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F382%5C%2FD%22%2C%22id%22%3A%22382D%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A1%2C%22totalAccepted%22%3A1%2C%22pid%22%3A%22CF382D%22%2C%22title%22%3A%22Ksenia%20and%20Pawns%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Ksenia%20and%20Pawns%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573295103;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Ksenia and Pawns</h1>
<h2>题目描述</h2>
<div>Ksenia has a chessboard of size $ n×m $ . Each cell of the chessboard contains one of the characters: "<", ">", "^", "v", "\#". The cells that contain character "\#" are blocked. We know that all chessboard cells that touch the border are blocked.
Ksenia is playing with two pawns on this chessboard. Initially, she puts the pawns on the chessboard. One cell of the chessboard can contain two pawns if and only if the cell is blocked. In other cases two pawns can not stand in one cell. The game begins when Ksenia put pawns on the board. In one move, Ksenia moves each pawn to a side adjacent cell in the direction of arrows painted on the cell on which the corresponding pawn sits (if the pawn sits on "\#", it does not move). Assume that Ksenia moves pawns simultaneously (see the second test case).
Of course, Ksenia plays for points. How can one calculate the points per game? Very simply! Let's count how many movements the first pawn made and how many movements the second pawn made, sum these two numbers — it will be the resulting score of the game.
Ksenia wonders: what is the maximum number of points she can earn (for that, she should place the pawns optimally well early in the game). Help her and find that number.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains two integers, $ n $ and $ m $ $ (1<=n,m<=2000) $ — the sizes of the board. Each of the following $ n $ lines contains $ m $ characters – the board's description. Each character is one of the characters: "<", ">", "^", "v", "\#".
It is guaranteed that the border cells of the table are blocked cells (with character "\#").</div>
<h3>输出格式</h3>
<br />
<div>If Ksenia can get infinitely many points, print -1. Otherwise, print the maximum number of points she can get.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>1 1
#
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>0
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>3 4
####
#&amp;gt;^{}#
####
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>3</code></pre>
<h3>输入样例 #3</h3>
<pre><code>3 4
####
#&amp;gt;&amp;lt;#
####
</code></pre>
<h3>输出样例 #3</h3>
<pre><code>-1</code></pre>
<h3>输入样例 #4</h3>
<pre><code>7 5
#####
##v##
##v##
#####
##^{}##
##^{}##
#####
</code></pre>
<h3>输出样例 #4</h3>
<pre><code>4</code></pre>
<h3>输入样例 #5</h3>
<pre><code>7 5
#####
##v##
##v##
##&amp;lt;##
##^{}##
##^{}##
#####</code></pre>
<h3>输出样例 #5</h3>
<pre><code>5</code></pre>
</article>
</div>
</div>
</body>
</html>
