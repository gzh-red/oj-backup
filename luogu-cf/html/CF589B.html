<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Layer Cake - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573395698:xvJOjA/Ctp2zB3dNpTo6FhshNdKM9nADYTQgOCKK2oI=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Dasha%20decided%20to%20bake%20a%20big%20and%20tasty%20layer%20cake.%20In%20order%20to%20do%20that%20she%20went%20shopping%20and%20bought%20%24%20n%20%24%20rectangular%20cake%20layers.%20The%20length%20and%20the%20width%20of%20the%20%24%20i%20%24%20-th%20cake%20layer%20were%20%24%20a_%7Bi%7D%20%24%20and%20%24%20b_%7Bi%7D%20%24%20respectively%2C%20while%20the%20height%20of%20each%20cake%20layer%20was%20equal%20to%20one.%5Cn%5CnFrom%20a%20cooking%20book%20Dasha%20learned%20that%20a%20cake%20must%20have%20a%20form%20of%20a%20rectangular%20parallelepiped%20constructed%20from%20cake%20layers%20of%20the%20same%20sizes.%5Cn%5CnDasha%20decided%20to%20bake%20the%20biggest%20possible%20cake%20from%20the%20bought%20cake%20layers%20%28possibly%2C%20using%20only%20some%20of%20them%29.%20It%20means%20that%20she%20wants%20the%20volume%20of%20the%20cake%20to%20be%20as%20big%20as%20possible.%20To%20reach%20this%20goal%2C%20Dasha%20can%20cut%20rectangular%20pieces%20out%20of%20the%20bought%20cake%20layers.%20She%20always%20cuts%20cake%20layers%20in%20such%20a%20way%20that%20cutting%20lines%20are%20parallel%20to%20the%20edges%20of%20that%20cake%20layer.%20Dasha%20isn%27t%20very%20good%20at%20geometry%2C%20so%20after%20cutting%20out%20a%20piece%20from%20the%20original%20cake%20layer%2C%20she%20throws%20away%20the%20remaining%20part%20of%20it.%20Also%20she%20can%20rotate%20a%20cake%20layer%20in%20the%20horizontal%20plane%20%28swap%20its%20width%20and%20length%29.%5Cn%5CnDasha%20wants%20her%20cake%20to%20be%20constructed%20as%20a%20stack%20of%20cake%20layers%20of%20the%20same%20sizes.%20Each%20layer%20of%20the%20resulting%20cake%20should%20be%20made%20out%20of%20only%20one%20cake%20layer%20%28the%20original%20one%20or%20cut%20out%20from%20the%20original%20cake%20layer%29.%5Cn%5CnHelp%20Dasha%20to%20calculate%20the%20maximum%20possible%20volume%20of%20the%20cake%20she%20can%20bake%20using%20given%20cake%20layers.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20an%20integer%20%24%20n%20%24%20%24%20%281%3C%3Dn%3C%3D4000%29%20%24%20%5Cu2014%20the%20number%20of%20cake%20layers%20that%20Dasha%20can%20use.%5Cn%5CnEach%20of%20the%20following%20%24%20n%20%24%20lines%20contains%20two%20integer%20numbers%20%24%20a_%7Bi%7D%20%24%20and%20%24%20b_%7Bi%7D%20%24%20%24%20%281%3C%3Da_%7Bi%7D%2Cb_%7Bi%7D%3C%3D10%5E%7B6%7D%29%20%24%20%5Cu2014%20the%20length%20and%20the%20width%20of%20%24%20i%20%24%20-th%20cake%20layer%20respectively.%22%2C%22outputFormat%22%3A%22The%20first%20line%20of%20the%20output%20should%20contain%20the%20maximum%20volume%20of%20cake%20that%20can%20be%20baked%20using%20given%20layers.%5Cn%5CnThe%20second%20line%20of%20the%20output%20should%20contain%20the%20length%20and%20the%20width%20of%20the%20resulting%20cake.%20If%20there%20are%20many%20solutions%20with%20maximum%20possible%20volume%2C%20print%20any%20of%20them.%22%2C%22samples%22%3A%5B%5B%225%5Cn5%2012%5Cn1%201%5Cn4%206%5Cn6%204%5Cn4%206%5Cn%22%2C%2296%5Cn6%204%5Cn%22%5D%2C%5B%222%5Cn100001%20900000%5Cn900001%20100000%5Cn%22%2C%22180000000000%5Cn900000%20100000%5Cn%22%5D%5D%2C%22hint%22%3A%22In%20the%20first%20example%20Dasha%20doesn%27t%20use%20the%20second%20cake%20layer.%20She%20cuts%20%24%204%5Cu00d76%20%24%20rectangle%20from%20the%20first%20cake%20layer%20and%20she%20uses%20other%20cake%20layers%20as%20is.%5Cn%5CnIn%20the%20second%20example%20Dasha%20cuts%20off%20slightly%20from%20the%20both%20cake%20layers.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B6000%5D%2C%22memory%22%3A%5B512000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F589%5C%2FB%22%2C%22id%22%3A%22589B%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22CF589B%22%2C%22title%22%3A%22Layer%20Cake%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Layer%20Cake%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573306449;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Layer Cake</h1>
<h2>题目描述</h2>
<div>Dasha decided to bake a big and tasty layer cake. In order to do that she went shopping and bought $ n $ rectangular cake layers. The length and the width of the $ i $ -th cake layer were $ a_{i} $ and $ b_{i} $ respectively, while the height of each cake layer was equal to one.
From a cooking book Dasha learned that a cake must have a form of a rectangular parallelepiped constructed from cake layers of the same sizes.
Dasha decided to bake the biggest possible cake from the bought cake layers (possibly, using only some of them). It means that she wants the volume of the cake to be as big as possible. To reach this goal, Dasha can cut rectangular pieces out of the bought cake layers. She always cuts cake layers in such a way that cutting lines are parallel to the edges of that cake layer. Dasha isn't very good at geometry, so after cutting out a piece from the original cake layer, she throws away the remaining part of it. Also she can rotate a cake layer in the horizontal plane (swap its width and length).
Dasha wants her cake to be constructed as a stack of cake layers of the same sizes. Each layer of the resulting cake should be made out of only one cake layer (the original one or cut out from the original cake layer).
Help Dasha to calculate the maximum possible volume of the cake she can bake using given cake layers.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains an integer $ n $ $ (1<=n<=4000) $ — the number of cake layers that Dasha can use.
Each of the following $ n $ lines contains two integer numbers $ a_{i} $ and $ b_{i} $ $ (1<=a_{i},b_{i}<=10^{6}) $ — the length and the width of $ i $ -th cake layer respectively.</div>
<h3>输出格式</h3>
<br />
<div>The first line of the output should contain the maximum volume of cake that can be baked using given layers.
The second line of the output should contain the length and the width of the resulting cake. If there are many solutions with maximum possible volume, print any of them.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>5
5 12
1 1
4 6
6 4
4 6
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>96
6 4
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>2
100001 900000
900001 100000
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>180000000000
900000 100000
</code></pre>
<h2>说明</h2>
<div>In the first example Dasha doesn't use the second cake layer. She cuts $ 4×6 $ rectangle from the first cake layer and she uses other cake layers as is.
In the second example Dasha cuts off slightly from the both cake layers.</div>
</article>
</div>
</div>
</body>
</html>
