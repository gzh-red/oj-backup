<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Naughty Stone Piles - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573391875:Ll/C58KGxEbtbWJ5pzxm6semWHDIB4f1/XpA1MEd3tg=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22There%20are%20%24%20n%20%24%20piles%20of%20stones%20of%20sizes%20%24%20a_%7B1%7D%2Ca_%7B2%7D%2C...%2Ca_%7Bn%7D%20%24%20lying%20on%20the%20table%20in%20front%20of%20you.%5Cn%5CnDuring%20one%20move%20you%20can%20take%20one%20pile%20and%20add%20it%20to%20the%20other.%20As%20you%20add%20pile%20%24%20i%20%24%20to%20pile%20%24%20j%20%24%20%2C%20the%20size%20of%20pile%20%24%20j%20%24%20increases%20by%20the%20current%20size%20of%20pile%20%24%20i%20%24%20%2C%20and%20pile%20%24%20i%20%24%20stops%20existing.%20The%20cost%20of%20the%20adding%20operation%20equals%20the%20size%20of%20the%20added%20pile.%5Cn%5CnYour%20task%20is%20to%20determine%20the%20minimum%20cost%20at%20which%20you%20can%20gather%20all%20stones%20in%20one%20pile.%5Cn%5CnTo%20add%20some%20challenge%2C%20the%20stone%20piles%20built%20up%20conspiracy%20and%20decided%20that%20each%20pile%20will%20let%20you%20add%20to%20it%20not%20more%20than%20%24%20k%20%24%20times%20%28after%20that%20it%20can%20only%20be%20added%20to%20another%20pile%29.%5Cn%5CnMoreover%2C%20the%20piles%20decided%20to%20puzzle%20you%20completely%20and%20told%20you%20%24%20q%20%24%20variants%20%28not%20necessarily%20distinct%29%20of%20what%20%24%20k%20%24%20might%20equal.%5Cn%5CnYour%20task%20is%20to%20find%20the%20minimum%20cost%20for%20each%20of%20%24%20q%20%24%20variants.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20integer%20%24%20n%20%24%20%24%20%281%3C%3Dn%3C%3D10%5E%7B5%7D%29%20%24%20%5Cu2014%20the%20number%20of%20stone%20piles.%20The%20second%20line%20contains%20%24%20n%20%24%20space-separated%20integers%3A%20%24%20a_%7B1%7D%2Ca_%7B2%7D%2C...%2Ca_%7Bn%7D%20%24%20%24%20%281%3C%3Da_%7Bi%7D%3C%3D10%5E%7B9%7D%29%20%24%20%5Cu2014%20the%20initial%20sizes%20of%20the%20stone%20piles.%5Cn%5CnThe%20third%20line%20contains%20integer%20%24%20q%20%24%20%24%20%281%3C%3Dq%3C%3D10%5E%7B5%7D%29%20%24%20%5Cu2014%20the%20number%20of%20queries.%20The%20last%20line%20contains%20%24%20q%20%24%20space-separated%20integers%20%24%20k_%7B1%7D%2Ck_%7B2%7D%2C...%2Ck_%7Bq%7D%20%24%20%24%20%281%3C%3Dk_%7Bi%7D%3C%3D10%5E%7B5%7D%29%20%24%20%5Cu2014%20the%20values%20of%20number%20%24%20k%20%24%20for%20distinct%20queries.%20Note%20that%20numbers%20%24%20k_%7Bi%7D%20%24%20can%20repeat.%22%2C%22outputFormat%22%3A%22Print%20%24%20q%20%24%20whitespace-separated%20integers%20%5Cu2014%20the%20answers%20to%20the%20queries%20in%20the%20order%2C%20in%20which%20the%20queries%20are%20given%20in%20the%20input.%5Cn%5CnPlease%2C%20do%20not%20use%20the%20%25lld%20specifier%20to%20read%20or%20write%2064-bit%20integers%20in%20C%2B%2B.%20It%20is%20preferred%20to%20use%20the%20cin%2C%20cout%20streams%20or%20the%20%25I64d%20specifier.%22%2C%22samples%22%3A%5B%5B%225%5Cn2%203%204%201%201%5Cn2%5Cn2%203%5Cn%22%2C%229%208%20%22%5D%5D%2C%22hint%22%3A%22In%20the%20first%20sample%20one%20way%20to%20get%20the%20optimal%20answer%20goes%20like%20this%3A%20we%20add%20in%20turns%20the%20%24%204%20%24%20-th%20and%20the%20%24%205%20%24%20-th%20piles%20to%20the%20%24%202%20%24%20-nd%20one%3B%20then%20we%20add%20the%20%24%201%20%24%20-st%20pile%20to%20the%20%24%203%20%24%20-rd%20one%3B%20we%20add%20the%20%24%202%20%24%20-nd%20pile%20to%20the%20%24%203%20%24%20-rd%20one.%20The%20first%20two%20operations%20cost%20%24%201%20%24%20each%3B%20the%20third%20one%20costs%20%24%202%20%24%20%2C%20the%20fourth%20one%20costs%20%24%205%20%24%20%28the%20size%20of%20the%20%24%202%20%24%20-nd%20pile%20after%20the%20first%20two%20operations%20is%20not%20%24%203%20%24%20%2C%20it%20already%20is%20%24%205%20%24%20%29.%5Cn%5CnIn%20the%20second%20sample%20you%20can%20add%20the%20%24%202%20%24%20-nd%20pile%20to%20the%20%24%203%20%24%20-rd%20one%20%28the%20operations%20costs%20%24%203%20%24%20%29%3B%20then%20the%20%24%201%20%24%20-st%20one%20to%20the%20%24%203%20%24%20-th%20one%20%28the%20cost%20is%20%24%202%20%24%20%29%3B%20then%20the%20%24%205%20%24%20-th%20one%20to%20the%20%24%204%20%24%20-th%20one%20%28the%20costs%20is%20%24%201%20%24%20%29%3B%20and%20at%20last%2C%20the%20%24%204%20%24%20-th%20one%20to%20the%20%24%203%20%24%20-rd%20one%20%28the%20cost%20is%20%24%202%20%24%20%29.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F226%5C%2FB%22%2C%22id%22%3A%22226B%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A1%2C%22totalAccepted%22%3A1%2C%22pid%22%3A%22CF226B%22%2C%22title%22%3A%22Naughty%20Stone%20Piles%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Naughty%20Stone%20Piles%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573286098;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Naughty Stone Piles</h1>
<h2>题目描述</h2>
<div>There are $ n $ piles of stones of sizes $ a_{1},a_{2},...,a_{n} $ lying on the table in front of you.
During one move you can take one pile and add it to the other. As you add pile $ i $ to pile $ j $ , the size of pile $ j $ increases by the current size of pile $ i $ , and pile $ i $ stops existing. The cost of the adding operation equals the size of the added pile.
Your task is to determine the minimum cost at which you can gather all stones in one pile.
To add some challenge, the stone piles built up conspiracy and decided that each pile will let you add to it not more than $ k $ times (after that it can only be added to another pile).
Moreover, the piles decided to puzzle you completely and told you $ q $ variants (not necessarily distinct) of what $ k $ might equal.
Your task is to find the minimum cost for each of $ q $ variants.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains integer $ n $ $ (1<=n<=10^{5}) $ — the number of stone piles. The second line contains $ n $ space-separated integers: $ a_{1},a_{2},...,a_{n} $ $ (1<=a_{i}<=10^{9}) $ — the initial sizes of the stone piles.
The third line contains integer $ q $ $ (1<=q<=10^{5}) $ — the number of queries. The last line contains $ q $ space-separated integers $ k_{1},k_{2},...,k_{q} $ $ (1<=k_{i}<=10^{5}) $ — the values of number $ k $ for distinct queries. Note that numbers $ k_{i} $ can repeat.</div>
<h3>输出格式</h3>
<br />
<div>Print $ q $ whitespace-separated integers — the answers to the queries in the order, in which the queries are given in the input.
Please, do not use the %lld specifier to read or write 64-bit integers in C++. It is preferred to use the cin, cout streams or the %I64d specifier.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>5
2 3 4 1 1
2
2 3
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>9 8 </code></pre>
<h2>说明</h2>
<div>In the first sample one way to get the optimal answer goes like this: we add in turns the $ 4 $ -th and the $ 5 $ -th piles to the $ 2 $ -nd one; then we add the $ 1 $ -st pile to the $ 3 $ -rd one; we add the $ 2 $ -nd pile to the $ 3 $ -rd one. The first two operations cost $ 1 $ each; the third one costs $ 2 $ , the fourth one costs $ 5 $ (the size of the $ 2 $ -nd pile after the first two operations is not $ 3 $ , it already is $ 5 $ ).
In the second sample you can add the $ 2 $ -nd pile to the $ 3 $ -rd one (the operations costs $ 3 $ ); then the $ 1 $ -st one to the $ 3 $ -th one (the cost is $ 2 $ ); then the $ 5 $ -th one to the $ 4 $ -th one (the costs is $ 1 $ ); and at last, the $ 4 $ -th one to the $ 3 $ -rd one (the cost is $ 2 $ ).</div>
</article>
</div>
</div>
</body>
</html>
