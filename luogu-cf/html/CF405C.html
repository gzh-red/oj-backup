<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Unusual Product - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573393762:fldRL96WA5RajqjZLhB+fEkcmuHOCN7uvZmFFwzBm48=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Little%20Chris%20is%20a%20huge%20fan%20of%20linear%20algebra.%20This%20time%20he%20has%20been%20given%20a%20homework%20about%20the%20unusual%20square%20of%20a%20square%20matrix.%5Cn%5CnThe%20dot%20product%20of%20two%20integer%20number%20vectors%20%24%20x%20%24%20and%20%24%20y%20%24%20of%20size%20%24%20n%20%24%20is%20the%20sum%20of%20the%20products%20of%20the%20corresponding%20components%20of%20the%20vectors.%20The%20unusual%20square%20of%20an%20%24%20n%5Cu00d7n%20%24%20square%20matrix%20%24%20A%20%24%20is%20defined%20as%20the%20sum%20of%20%24%20n%20%24%20dot%20products.%20The%20%24%20i%20%24%20-th%20of%20them%20is%20the%20dot%20product%20of%20the%20%24%20i%20%24%20-th%20row%20vector%20and%20the%20%24%20i%20%24%20-th%20column%20vector%20in%20the%20matrix%20%24%20A%20%24%20.%5Cn%5CnFortunately%20for%20Chris%2C%20he%20has%20to%20work%20only%20in%20%24%20GF%282%29%20%24%20%21%20This%20means%20that%20all%20operations%20%28addition%2C%20multiplication%29%20are%20calculated%20modulo%202.%20In%20fact%2C%20the%20matrix%20%24%20A%20%24%20is%20binary%3A%20each%20element%20of%20%24%20A%20%24%20is%20either%200%20or%201.%20For%20example%2C%20consider%20the%20following%20matrix%20%24%20A%20%24%20%3A%5Cn%5Cn%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF405C%5C%2F097f29d1003281620afd851d4fbf370e4162e70a.png%29The%20unusual%20square%20of%20%24%20A%20%24%20is%20equal%20to%20%24%20%281%5Cu00b71%2B1%5Cu00b70%2B1%5Cu00b71%29%2B%280%5Cu00b71%2B1%5Cu00b71%2B1%5Cu00b70%29%2B%281%5Cu00b71%2B0%5Cu00b71%2B0%5Cu00b70%29%3D0%2B1%2B1%3D0%20%24%20.%5Cn%5CnHowever%2C%20there%20is%20much%20more%20to%20the%20homework.%20Chris%20has%20to%20process%20%24%20q%20%24%20queries%3B%20each%20query%20can%20be%20one%20of%20the%20following%3A%5Cn%5Cn1.%20given%20a%20row%20index%20%24%20i%20%24%20%2C%20flip%20all%20the%20values%20in%20the%20%24%20i%20%24%20-th%20row%20in%20%24%20A%20%24%20%3B%5Cn2.%20given%20a%20column%20index%20%24%20i%20%24%20%2C%20flip%20all%20the%20values%20in%20the%20%24%20i%20%24%20-th%20column%20in%20%24%20A%20%24%20%3B%5Cn3.%20find%20the%20unusual%20square%20of%20%24%20A%20%24%20.%5Cn%5CnTo%20flip%20a%20bit%20value%20%24%20w%20%24%20means%20to%20change%20it%20to%20%24%201-w%20%24%20%2C%20i.e.%2C%201%20changes%20to%200%20and%200%20changes%20to%201.%5Cn%5CnGiven%20the%20initial%20matrix%20%24%20A%20%24%20%2C%20output%20the%20answers%20for%20each%20query%20of%20the%20third%20type%21%20Can%20you%20solve%20Chris%27s%20homework%3F%22%2C%22inputFormat%22%3A%22The%20first%20line%20of%20input%20contains%20an%20integer%20%24%20n%20%24%20%28%20%24%201%3C%3Dn%3C%3D1000%20%24%20%29%2C%20the%20number%20of%20rows%20and%20the%20number%20of%20columns%20in%20the%20matrix%20%24%20A%20%24%20.%20The%20next%20%24%20n%20%24%20lines%20describe%20the%20matrix%3A%20the%20%24%20i%20%24%20-th%20line%20contains%20%24%20n%20%24%20space-separated%20bits%20and%20describes%20the%20%24%20i%20%24%20-th%20row%20of%20%24%20A%20%24%20.%20The%20%24%20j%20%24%20-th%20number%20of%20the%20%24%20i%20%24%20-th%20line%20%24%20a_%7Bij%7D%20%24%20%28%20%24%200%3C%3Da_%7Bij%7D%3C%3D1%20%24%20%29%20is%20the%20element%20on%20the%20intersection%20of%20the%20%24%20i%20%24%20-th%20row%20and%20the%20%24%20j%20%24%20-th%20column%20of%20%24%20A%20%24%20.%5Cn%5CnThe%20next%20line%20of%20input%20contains%20an%20integer%20%24%20q%20%24%20%28%20%24%201%3C%3Dq%3C%3D10%5E%7B6%7D%20%24%20%29%2C%20the%20number%20of%20queries.%20Each%20of%20the%20next%20%24%20q%20%24%20lines%20describes%20a%20single%20query%2C%20which%20can%20be%20one%20of%20the%20following%3A%5Cn%5Cn-%201%20%24%20i%20%24%20%5Cu2014%20flip%20the%20values%20of%20the%20%24%20i%20%24%20-th%20row%3B%5Cn-%202%20%24%20i%20%24%20%5Cu2014%20flip%20the%20values%20of%20the%20%24%20i%20%24%20-th%20column%3B%5Cn-%203%20%5Cu2014%20output%20the%20unusual%20square%20of%20%24%20A%20%24%20.%5Cn%5CnNote%3A%20since%20the%20size%20of%20the%20input%20and%20output%20could%20be%20very%20large%2C%20don%27t%20use%20slow%20output%20techniques%20in%20your%20language.%20For%20example%2C%20do%20not%20use%20input%20and%20output%20streams%20%28cin%2C%20cout%29%20in%20C%2B%2B.%22%2C%22outputFormat%22%3A%22Let%20the%20number%20of%20the%203rd%20type%20queries%20in%20the%20input%20be%20%24%20m%20%24%20.%20Output%20a%20single%20string%20%24%20s%20%24%20of%20length%20%24%20m%20%24%20%2C%20where%20the%20%24%20i%20%24%20-th%20symbol%20of%20%24%20s%20%24%20is%20the%20value%20of%20the%20unusual%20square%20of%20%24%20A%20%24%20for%20the%20%24%20i%20%24%20-th%20query%20of%20the%203rd%20type%20as%20it%20appears%20in%20the%20input.%22%2C%22samples%22%3A%5B%5B%223%5Cn1%201%201%5Cn0%201%201%5Cn1%200%200%5Cn12%5Cn3%5Cn2%203%5Cn3%5Cn2%202%5Cn2%202%5Cn1%203%5Cn3%5Cn3%5Cn1%202%5Cn2%201%5Cn1%201%5Cn3%5Cn%22%2C%2201001%5Cn%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F405%5C%2FC%22%2C%22id%22%3A%22405C%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A5%2C%22totalAccepted%22%3A5%2C%22pid%22%3A%22CF405C%22%2C%22title%22%3A%22Unusual%20Product%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Unusual%20Product%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573306449;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Unusual Product</h1>
<h2>题目描述</h2>
<div>Little Chris is a huge fan of linear algebra. This time he has been given a homework about the unusual square of a square matrix.
The dot product of two integer number vectors $ x $ and $ y $ of size $ n $ is the sum of the products of the corresponding components of the vectors. The unusual square of an $ n×n $ square matrix $ A $ is defined as the sum of $ n $ dot products. The $ i $ -th of them is the dot product of the $ i $ -th row vector and the $ i $ -th column vector in the matrix $ A $ .
Fortunately for Chris, he has to work only in $ GF(2) $ ! This means that all operations (addition, multiplication) are calculated modulo 2. In fact, the matrix $ A $ is binary: each element of $ A $ is either 0 or 1. For example, consider the following matrix $ A $ :
![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF405C/097f29d1003281620afd851d4fbf370e4162e70a.png)The unusual square of $ A $ is equal to $ (1·1+1·0+1·1)+(0·1+1·1+1·0)+(1·1+0·1+0·0)=0+1+1=0 $ .
However, there is much more to the homework. Chris has to process $ q $ queries; each query can be one of the following:
1. given a row index $ i $ , flip all the values in the $ i $ -th row in $ A $ ;
2. given a column index $ i $ , flip all the values in the $ i $ -th column in $ A $ ;
3. find the unusual square of $ A $ .
To flip a bit value $ w $ means to change it to $ 1-w $ , i.e., 1 changes to 0 and 0 changes to 1.
Given the initial matrix $ A $ , output the answers for each query of the third type! Can you solve Chris's homework?</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line of input contains an integer $ n $ ( $ 1<=n<=1000 $ ), the number of rows and the number of columns in the matrix $ A $ . The next $ n $ lines describe the matrix: the $ i $ -th line contains $ n $ space-separated bits and describes the $ i $ -th row of $ A $ . The $ j $ -th number of the $ i $ -th line $ a_{ij} $ ( $ 0<=a_{ij}<=1 $ ) is the element on the intersection of the $ i $ -th row and the $ j $ -th column of $ A $ .
The next line of input contains an integer $ q $ ( $ 1<=q<=10^{6} $ ), the number of queries. Each of the next $ q $ lines describes a single query, which can be one of the following:
- 1 $ i $ — flip the values of the $ i $ -th row;
- 2 $ i $ — flip the values of the $ i $ -th column;
- 3 — output the unusual square of $ A $ .
Note: since the size of the input and output could be very large, don't use slow output techniques in your language. For example, do not use input and output streams (cin, cout) in C++.</div>
<h3>输出格式</h3>
<br />
<div>Let the number of the 3rd type queries in the input be $ m $ . Output a single string $ s $ of length $ m $ , where the $ i $ -th symbol of $ s $ is the value of the unusual square of $ A $ for the $ i $ -th query of the 3rd type as it appears in the input.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>3
1 1 1
0 1 1
1 0 0
12
3
2 3
3
2 2
2 2
1 3
3
3
1 2
2 1
1 1
3
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>01001
</code></pre>
</article>
</div>
</div>
</body>
</html>
