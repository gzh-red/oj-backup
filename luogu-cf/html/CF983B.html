<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>XOR-pyramid - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573400067:JGefvr089jGJUhw83QpUKPbvOcKWrsLWI/8LameQWXQ=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22For%20an%20array%20%24%20b%20%24%20of%20length%20%24%20m%20%24%20we%20define%20the%20function%20%24%20f%20%24%20as%5Cn%5Cn%20%24%20%20f%28b%29%20%3D%20%5C%5Cbegin%7Bcases%7D%20b%5B1%5D%20%26%20%5C%5Cquad%20%5C%5Ctext%7Bif%20%7D%20m%20%3D%201%20%5C%5C%5C%5C%20f%28b%5B1%5D%20%5C%5Coplus%20b%5B2%5D%2Cb%5B2%5D%20%5C%5Coplus%20b%5B3%5D%2C%5C%5Cdots%2Cb%5Bm-1%5D%20%5C%5Coplus%20b%5Bm%5D%29%20%26%20%5C%5Cquad%20%5C%5Ctext%7Botherwise%2C%7D%20%5C%5Cend%7Bcases%7D%20%20%24%20where%20%24%20%5C%5Coplus%20%24%20is%20%5Bbitwise%20exclusive%20OR%5D%28https%3A%5C%2F%5C%2Fen.wikipedia.org%5C%2Fwiki%5C%2FBitwise_operation%23XOR%29.%5Cn%5CnFor%20example%2C%20%24%20f%281%2C2%2C4%2C8%29%3Df%281%5C%5Coplus2%2C2%5C%5Coplus4%2C4%5C%5Coplus8%29%3Df%283%2C6%2C12%29%3Df%283%5C%5Coplus6%2C6%5C%5Coplus12%29%3Df%285%2C10%29%3Df%285%5C%5Coplus10%29%3Df%2815%29%3D15%20%24%5Cn%5CnYou%20are%20given%20an%20array%20%24%20a%20%24%20and%20a%20few%20queries.%20Each%20query%20is%20represented%20as%20two%20integers%20%24%20l%20%24%20and%20%24%20r%20%24%20.%20The%20answer%20is%20the%20maximum%20value%20of%20%24%20f%20%24%20on%20all%20continuous%20subsegments%20of%20the%20array%20%24%20a_l%2C%20a_%7Bl%2B1%7D%2C%20%5C%5Cldots%2C%20a_r%20%24%20.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20a%20single%20integer%20%24%20n%20%24%20%28%20%24%201%20%5C%5Cle%20n%20%5C%5Cle%205000%20%24%20%29%20%5Cu2014%20the%20length%20of%20%24%20a%20%24%20.%5Cn%5CnThe%20second%20line%20contains%20%24%20n%20%24%20integers%20%24%20a_1%2C%20a_2%2C%20%5C%5Cdots%2C%20a_n%20%24%20%28%20%24%200%20%5C%5Cle%20a_i%20%5C%5Cle%202%5E%7B30%7D-1%20%24%20%29%20%5Cu2014%20the%20elements%20of%20the%20array.%5Cn%5CnThe%20third%20line%20contains%20a%20single%20integer%20%24%20q%20%24%20%28%20%24%201%20%5C%5Cle%20q%20%5C%5Cle%20100%5C%5C%2C000%20%24%20%29%20%5Cu2014%20the%20number%20of%20queries.%5Cn%5CnEach%20of%20the%20next%20%24%20q%20%24%20lines%20contains%20a%20query%20represented%20as%20two%20integers%20%24%20l%20%24%20%2C%20%24%20r%20%24%20%28%20%24%201%20%5C%5Cle%20l%20%5C%5Cle%20r%20%5C%5Cle%20n%20%24%20%29.%22%2C%22outputFormat%22%3A%22Print%20%24%20q%20%24%20lines%20%5Cu2014%20the%20answers%20for%20the%20queries.%22%2C%22samples%22%3A%5B%5B%223%5Cn8%204%201%5Cn2%5Cn2%203%5Cn1%202%5Cn%22%2C%225%5Cn12%5Cn%22%5D%2C%5B%226%5Cn1%202%204%208%2016%2032%5Cn4%5Cn1%206%5Cn2%205%5Cn3%204%5Cn1%202%5Cn%22%2C%2260%5Cn30%5Cn12%5Cn3%5Cn%22%5D%5D%2C%22hint%22%3A%22In%20first%20sample%20in%20both%20queries%20the%20maximum%20value%20of%20the%20function%20is%20reached%20on%20the%20subsegment%20that%20is%20equal%20to%20the%20whole%20segment.%5Cn%5CnIn%20second%20sample%2C%20optimal%20segment%20for%20first%20query%20are%20%24%20%5B3%2C6%5D%20%24%20%2C%20for%20second%20query%20%5Cu2014%20%24%20%5B2%2C5%5D%20%24%20%2C%20for%20third%20%5Cu2014%20%24%20%5B3%2C4%5D%20%24%20%2C%20for%20fourth%20%5Cu2014%20%24%20%5B1%2C2%5D%20%24%20.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B512000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F983%5C%2FB%22%2C%22id%22%3A%22983B%22%7D%2C%22tags%22%3A%5B3%2C12%2C54%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A177%2C%22totalAccepted%22%3A109%2C%22pid%22%3A%22CF983B%22%2C%22title%22%3A%22XOR-pyramid%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A43629%2C%22title%22%3A%22DP%5Cu849f%5Cu84bb%5Cu6c42%5Cu52a9%22%2C%22forum%22%3A%7B%22id%22%3A25887%2C%22name%22%3A%22CF983B%20XOR-pyramid%22%2C%22slug%22%3A%22CF983B%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22CF983C%22%2C%22title%22%3A%22Elevator%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF983A%22%2C%22title%22%3A%22Finite%20or%20not%3F%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF981D%22%2C%22title%22%3A%22Bookshelves%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1059E%22%2C%22title%22%3A%22Split%20the%20Tree%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1144D%22%2C%22title%22%3A%22Equalize%20Them%20All%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22CF%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22XOR-pyramid%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>XOR-pyramid</h1>
<h2>题目描述</h2>
<div>For an array $ b $ of length $ m $ we define the function $ f $ as
$ f(b) = \begin{cases} b[1] & \quad \text{if } m = 1 \\ f(b[1] \oplus b[2],b[2] \oplus b[3],\dots,b[m-1] \oplus b[m]) & \quad \text{otherwise,} \end{cases} $ where $ \oplus $ is [bitwise exclusive OR](https://en.wikipedia.org/wiki/Bitwise_operation#XOR).
For example, $ f(1,2,4,8)=f(1\oplus2,2\oplus4,4\oplus8)=f(3,6,12)=f(3\oplus6,6\oplus12)=f(5,10)=f(5\oplus10)=f(15)=15 $
You are given an array $ a $ and a few queries. Each query is represented as two integers $ l $ and $ r $ . The answer is the maximum value of $ f $ on all continuous subsegments of the array $ a_l, a_{l+1}, \ldots, a_r $ .</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains a single integer $ n $ ( $ 1 \le n \le 5000 $ ) — the length of $ a $ .
The second line contains $ n $ integers $ a_1, a_2, \dots, a_n $ ( $ 0 \le a_i \le 2^{30}-1 $ ) — the elements of the array.
The third line contains a single integer $ q $ ( $ 1 \le q \le 100\,000 $ ) — the number of queries.
Each of the next $ q $ lines contains a query represented as two integers $ l $ , $ r $ ( $ 1 \le l \le r \le n $ ).</div>
<h3>输出格式</h3>
<br />
<div>Print $ q $ lines — the answers for the queries.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>3
8 4 1
2
2 3
1 2
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>5
12
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>6
1 2 4 8 16 32
4
1 6
2 5
3 4
1 2
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>60
30
12
3
</code></pre>
<h2>说明</h2>
<div>In first sample in both queries the maximum value of the function is reached on the subsegment that is equal to the whole segment.
In second sample, optimal segment for first query are $ [3,6] $ , for second query — $ [2,5] $ , for third — $ [3,4] $ , for fourth — $ [1,2] $ .</div>
</article>
</div>
</div>
</body>
</html>
