<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Crossword Expert - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573402917:XbrDaHLUl55JigwVPCb2NTDzpV10mmls2VGg560zR8s=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Today%20Adilbek%20is%20taking%20his%20probability%20theory%20test.%20Unfortunately%2C%20when%20Adilbek%20arrived%20at%20the%20university%2C%20there%20had%20already%20been%20a%20long%20queue%20of%20students%20wanting%20to%20take%20the%20same%20test.%20Adilbek%20has%20estimated%20that%20he%20will%20be%20able%20to%20start%20the%20test%20only%20%24%20T%20%24%20seconds%20after%20coming.%5Cn%5CnFortunately%2C%20Adilbek%20can%20spend%20time%20without%20revising%20any%20boring%20theorems%20or%20formulas.%20He%20has%20an%20app%20on%20this%20smartphone%20which%20contains%20%24%20n%20%24%20Japanese%20crosswords%20to%20solve.%20Adilbek%20has%20decided%20to%20solve%20them%20all%20one%20by%20one%20in%20the%20order%20they%20are%20listed%20in%20the%20app%2C%20without%20skipping%20any%20crossword.%20For%20each%20crossword%2C%20a%20number%20%24%20t_i%20%24%20is%20given%20that%20represents%20the%20time%20it%20takes%20an%20average%20crossword%20expert%20to%20solve%20this%20crossword%20%28the%20time%20is%20given%20in%20seconds%29.%5Cn%5CnAdilbek%20is%20a%20true%20crossword%20expert%2C%20but%2C%20unfortunately%2C%20he%20is%20sometimes%20unlucky%20in%20choosing%20the%20way%20to%20solve%20the%20crossword.%20So%2C%20it%20takes%20him%20either%20%24%20t_i%20%24%20seconds%20or%20%24%20t_i%20%2B%201%20%24%20seconds%20to%20solve%20the%20%24%20i%20%24%20-th%20crossword%2C%20equiprobably%20%28with%20probability%20%24%20%5C%5Cfrac%7B1%7D%7B2%7D%20%24%20he%20solves%20the%20crossword%20in%20exactly%20%24%20t_i%20%24%20seconds%2C%20and%20with%20probability%20%24%20%5C%5Cfrac%7B1%7D%7B2%7D%20%24%20he%20has%20to%20spend%20an%20additional%20second%20to%20finish%20the%20crossword%29.%20All%20these%20events%20are%20independent.%5Cn%5CnAfter%20%24%20T%20%24%20seconds%20pass%20%28or%20after%20solving%20the%20last%20crossword%2C%20if%20he%20manages%20to%20do%20it%20in%20less%20than%20%24%20T%20%24%20seconds%29%2C%20Adilbek%20closes%20the%20app%20%28if%20he%20finishes%20some%20crossword%20at%20the%20same%20moment%2C%20that%20crossword%20is%20considered%20solved%3B%20otherwise%20Adilbek%20does%20not%20finish%20solving%20the%20current%20crossword%20at%20all%29.%20He%20thinks%20it%20would%20be%20an%20interesting%20probability%20theory%20problem%20to%20calculate%20%24%20E%20%24%20%5Cu2014%20the%20expected%20number%20of%20crosswords%20he%20will%20be%20able%20to%20solve%20completely.%20Can%20you%20calculate%20it%3F%5Cn%5CnRecall%20that%20the%20expected%20value%20of%20a%20discrete%20random%20variable%20is%20the%20probability-weighted%20average%20of%20all%20possible%20values%20%5Cu2014%20in%20this%20problem%20it%20means%20that%20the%20expected%20value%20of%20the%20number%20of%20solved%20crosswords%20can%20be%20calculated%20as%20%24%20E%20%3D%20%5C%5Csum%20%5C%5Climits_%7Bi%20%3D%200%7D%5E%7Bn%7D%20i%20p_i%20%24%20%2C%20where%20%24%20p_i%20%24%20is%20the%20probability%20that%20Adilbek%20will%20solve%20exactly%20%24%20i%20%24%20crosswords.%5Cn%5CnWe%20can%20represent%20%24%20E%20%24%20as%20rational%20fraction%20%24%20%5C%5Cfrac%7BP%7D%7BQ%7D%20%24%20with%20%24%20Q%20%3E%200%20%24%20.%20To%20give%20the%20answer%2C%20you%20should%20print%20%24%20P%20%5C%5Ccdot%20Q%5E%7B-1%7D%20%5C%5Cbmod%20%2810%5E9%20%2B%207%29%20%24%20.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20two%20integers%20%24%20n%20%24%20and%20%24%20T%20%24%20%28%20%24%201%20%5C%5Cle%20n%20%5C%5Cle%202%20%5C%5Ccdot%2010%5E5%20%24%20%2C%20%24%201%20%5C%5Cle%20T%20%5C%5Cle%202%20%5C%5Ccdot%2010%5E%7B14%7D%20%24%20%29%20%5Cu2014%20the%20number%20of%20crosswords%20and%20the%20time%20Adilbek%20has%20to%20spend%2C%20respectively.%5Cn%5CnThe%20second%20line%20contains%20%24%20n%20%24%20integers%20%24%20t_1%2C%20t_2%2C%20%5C%5Cdots%2C%20t_n%20%24%20%28%20%24%201%20%5C%5Cle%20t_i%20%5C%5Cle%2010%5E9%20%24%20%29%2C%20where%20%24%20t_i%20%24%20is%20the%20time%20it%20takes%20a%20crossword%20expert%20to%20solve%20the%20%24%20i%20%24%20-th%20crossword.%5Cn%5CnNote%20that%20Adilbek%20solves%20the%20crosswords%20in%20the%20order%20they%20are%20given%20in%20the%20input%20without%20skipping%20any%20of%20them.%22%2C%22outputFormat%22%3A%22Print%20one%20integer%20%5Cu2014%20the%20expected%20value%20of%20the%20number%20of%20crosswords%20Adilbek%20solves%20in%20%24%20T%20%24%20seconds%2C%20expressed%20in%20the%20form%20of%20%24%20P%20%5C%5Ccdot%20Q%5E%7B-1%7D%20%5C%5Cbmod%20%2810%5E9%20%2B%207%29%20%24%20.%22%2C%22samples%22%3A%5B%5B%22%5Cn3%205%5Cn2%202%202%5Cn%22%2C%22%5Cn750000007%5Cn%22%5D%2C%5B%22%5Cn3%205%5Cn2%201%202%5Cn%22%2C%22%5Cn125000003%5Cn%22%5D%5D%2C%22hint%22%3A%22The%20answer%20for%20the%20first%20sample%20is%20equal%20to%20%24%20%5C%5Cfrac%7B14%7D%7B8%7D%20%24%20.%5Cn%5CnThe%20answer%20for%20the%20second%20sample%20is%20equal%20to%20%24%20%5C%5Cfrac%7B17%7D%7B8%7D%20%24%20.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F1194%5C%2FF%22%2C%22id%22%3A%221194F%22%7D%2C%22translation%22%3A%22%5Cu4f60%5Cu6709n%5Cu4e2a%5Cu9898%5Cu76eeT%5Cu79d2%5Cu65f6%5Cu95f4%5Cuff0c%5Cu6bcf%5Cu4e2a%5Cu9898%5Cu76ee%5Cu9700%5Cu8981%5Cu6d88%5Cu8017%5Cu65f6%5Cu95f4%24t_i%24%5Cu79d2%20%5Cu3002%5Cr%5Cn%5Cu4f46%5Cu6bcf%5Cu9898%5Cu670950%25%5Cu7684%5Cu6982%5Cu7387%5Cu6d88%5Cu8017%5Cu591a1%5Cu79d2%5Cuff0c%5Cu95eeT%5Cu79d2%5Cu65f6%5Cu505a%5Cu51fa%5Cu9898%5Cu76ee%5Cu6570%5Cu76ee%5Cu7684%5Cu671f%5Cu671b%5Cu503c%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cuff08%5Cu5728T%5Cu79d2%5Cu65f6%5Cu521a%5Cu597d%5Cu5b8c%5Cu6210%5Cu7684%5Cu9898%5Cu76ee%5Cu7b97%5Cu5b8c%5Cu6210%5Cuff09%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A39%2C%22totalAccepted%22%3A22%2C%22pid%22%3A%22CF1194F%22%2C%22title%22%3A%22Crossword%20Expert%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Crossword%20Expert%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Crossword Expert</h1>
<h2>题意翻译</h2>
<div>你有n个题目T秒时间，每个题目需要消耗时间$t_i$秒 。
但每题有50%的概率消耗多1秒，问T秒时做出题目数目的期望值。
（在T秒时刚好完成的题目算完成）</div>
<h2>题目描述</h2>
<div>Today Adilbek is taking his probability theory test. Unfortunately, when Adilbek arrived at the university, there had already been a long queue of students wanting to take the same test. Adilbek has estimated that he will be able to start the test only $ T $ seconds after coming.
Fortunately, Adilbek can spend time without revising any boring theorems or formulas. He has an app on this smartphone which contains $ n $ Japanese crosswords to solve. Adilbek has decided to solve them all one by one in the order they are listed in the app, without skipping any crossword. For each crossword, a number $ t_i $ is given that represents the time it takes an average crossword expert to solve this crossword (the time is given in seconds).
Adilbek is a true crossword expert, but, unfortunately, he is sometimes unlucky in choosing the way to solve the crossword. So, it takes him either $ t_i $ seconds or $ t_i + 1 $ seconds to solve the $ i $ -th crossword, equiprobably (with probability $ \frac{1}{2} $ he solves the crossword in exactly $ t_i $ seconds, and with probability $ \frac{1}{2} $ he has to spend an additional second to finish the crossword). All these events are independent.
After $ T $ seconds pass (or after solving the last crossword, if he manages to do it in less than $ T $ seconds), Adilbek closes the app (if he finishes some crossword at the same moment, that crossword is considered solved; otherwise Adilbek does not finish solving the current crossword at all). He thinks it would be an interesting probability theory problem to calculate $ E $ — the expected number of crosswords he will be able to solve completely. Can you calculate it?
Recall that the expected value of a discrete random variable is the probability-weighted average of all possible values — in this problem it means that the expected value of the number of solved crosswords can be calculated as $ E = \sum \limits_{i = 0}^{n} i p_i $ , where $ p_i $ is the probability that Adilbek will solve exactly $ i $ crosswords.
We can represent $ E $ as rational fraction $ \frac{P}{Q} $ with $ Q > 0 $ . To give the answer, you should print $ P \cdot Q^{-1} \bmod (10^9 + 7) $ .</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains two integers $ n $ and $ T $ ( $ 1 \le n \le 2 \cdot 10^5 $ , $ 1 \le T \le 2 \cdot 10^{14} $ ) — the number of crosswords and the time Adilbek has to spend, respectively.
The second line contains $ n $ integers $ t_1, t_2, \dots, t_n $ ( $ 1 \le t_i \le 10^9 $ ), where $ t_i $ is the time it takes a crossword expert to solve the $ i $ -th crossword.
Note that Adilbek solves the crosswords in the order they are given in the input without skipping any of them.</div>
<h3>输出格式</h3>
<br />
<div>Print one integer — the expected value of the number of crosswords Adilbek solves in $ T $ seconds, expressed in the form of $ P \cdot Q^{-1} \bmod (10^9 + 7) $ .</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>
3 5
2 2 2
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>
750000007
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>
3 5
2 1 2
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>
125000003
</code></pre>
<h2>说明</h2>
<div>The answer for the first sample is equal to $ \frac{14}{8} $ .
The answer for the second sample is equal to $ \frac{17}{8} $ .</div>
</article>
</div>
</div>
</body>
</html>
