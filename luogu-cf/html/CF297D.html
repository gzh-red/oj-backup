<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Color the Carpet - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573392442:sUkpagtqx+dXcx5wS22eUP+FYFVRaVNQaFc10MUIpes=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Even%20polar%20bears%20feel%20cold%20when%20lying%20on%20the%20ice.%20Therefore%2C%20a%20polar%20bear%20Alice%20is%20going%20to%20make%20a%20carpet.%20The%20carpet%20can%20be%20viewed%20as%20a%20grid%20with%20height%20%24%20h%20%24%20and%20width%20%24%20w%20%24%20.%20Then%20the%20grid%20is%20divided%20into%20%24%20h%5Cu00d7w%20%24%20squares.%20Alice%20is%20going%20to%20assign%20one%20of%20%24%20k%20%24%20different%20colors%20to%20each%20square.%20The%20colors%20are%20numbered%20from%201%20to%20%24%20k%20%24%20.%20She%20may%20choose%20not%20to%20use%20all%20of%20the%20colors.%5Cn%5CnHowever%2C%20there%20are%20some%20restrictions.%20For%20every%20two%20adjacent%20squares%20%28squares%20that%20shares%20an%20edge%29%20%24%20x%20%24%20and%20%24%20y%20%24%20%2C%20there%20is%20a%20color%20constraint%20in%20one%20of%20the%20forms%3A%5Cn%5Cn-%20%24%20color%28x%29%3Dcolor%28y%29%20%24%20%2C%20or%5Cn-%20%24%20color%28x%29%5Cu2260color%28y%29%20%24%20.%5Cn%5CnExample%20of%20the%20color%20constraints%3A%5Cn%5Cn%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF297D%5C%2F535d1d4ec9a1bcb4f1f5ac12060cde0f65471360.png%29Ideally%2C%20Alice%20wants%20to%20satisfy%20all%20color%20constraints.%20But%20again%2C%20life%20in%20the%20Arctic%20is%20hard.%20It%20is%20not%20always%20possible%20to%20satisfy%20all%20color%20constraints.%20Fortunately%2C%20she%20will%20still%20be%20happy%20if%20at%20least%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF297D%5C%2Fc7b5e8f543c3882ba6f2a662e01781b4de30f8c7.png%29%20of%20the%20color%20constraints%20are%20satisfied.%5Cn%5CnIf%20she%20has%20%24%204%20%24%20colors%20she%20can%20color%20the%20carpet%20in%20the%20following%20way%3A%5Cn%5Cn%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF297D%5C%2F84535e9e280c4fb80d9cbe6a8b779a69a879098d.png%29And%20she%20is%20happy%20because%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF297D%5C%2F050547ba0080dee4ce4e2010a283122ee46b002c.png%29%20of%20the%20color%20constraints%20are%20satisfied%2C%20and%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF297D%5C%2F93a2fe0ea2a5cac28f71987aac7a9527d1566697.png%29.%20Your%20task%20is%20to%20help%20her%20color%20the%20carpet.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20three%20integers%20%24%20h%2Cw%2Ck%20%24%20%24%20%282%3C%3Dh%2Cw%3C%3D1000%2C1%3C%3Dk%3C%3Dw%5Cu00b7h%29%20%24%20.%5Cn%5CnThe%20next%20%24%202h-1%20%24%20lines%20describe%20the%20color%20constraints%20from%20top%20to%20bottom%2C%20left%20to%20right.%20They%20contain%20%24%20w-1%2Cw%2Cw-1%2Cw%2C...%2Cw-1%20%24%20characters%20respectively.%20Each%20color%20constraint%20is%20represented%20by%20a%20character%20%5C%22E%5C%22%20or%20%5C%22N%5C%22%2C%20where%20%5C%22E%5C%22%20means%20%5C%22%20%24%20%3D%20%24%20%5C%22%20and%20%5C%22N%5C%22%20means%20%5C%22%20%24%20%5Cu2260%20%24%20%5C%22.%5Cn%5CnThe%20color%20constraints%20listed%20in%20the%20order%20they%20are%20depicted%20on%20the%20picture.%22%2C%22outputFormat%22%3A%22If%20there%20is%20a%20coloring%20that%20satisfies%20at%20least%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF297D%5C%2Fc7b5e8f543c3882ba6f2a662e01781b4de30f8c7.png%29%20of%20the%20color%20constraints%2C%20print%20%5C%22YES%5C%22%20%28without%20quotes%29%20in%20the%20first%20line.%20In%20each%20of%20the%20next%20%24%20h%20%24%20lines%2C%20print%20%24%20w%20%24%20integers%20describing%20the%20coloring.%5Cn%5CnOtherwise%2C%20print%20%5C%22NO%5C%22%20%28without%20quotes%29.%22%2C%22samples%22%3A%5B%5B%223%204%204%5CnENE%5CnNNEE%5CnNEE%5CnENEN%5CnENN%5Cn%22%2C%22YES%5Cn1%201%202%202%5Cn3%204%201%201%5Cn3%203%202%204%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F297%5C%2FD%22%2C%22id%22%3A%22297D%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A7%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22CF297D%22%2C%22title%22%3A%22Color%20the%20Carpet%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Color%20the%20Carpet%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573295103;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Color the Carpet</h1>
<h2>题目描述</h2>
<div>Even polar bears feel cold when lying on the ice. Therefore, a polar bear Alice is going to make a carpet. The carpet can be viewed as a grid with height $ h $ and width $ w $ . Then the grid is divided into $ h×w $ squares. Alice is going to assign one of $ k $ different colors to each square. The colors are numbered from 1 to $ k $ . She may choose not to use all of the colors.
However, there are some restrictions. For every two adjacent squares (squares that shares an edge) $ x $ and $ y $ , there is a color constraint in one of the forms:
- $ color(x)=color(y) $ , or
- $ color(x)≠color(y) $ .
Example of the color constraints:
![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF297D/535d1d4ec9a1bcb4f1f5ac12060cde0f65471360.png)Ideally, Alice wants to satisfy all color constraints. But again, life in the Arctic is hard. It is not always possible to satisfy all color constraints. Fortunately, she will still be happy if at least ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF297D/c7b5e8f543c3882ba6f2a662e01781b4de30f8c7.png) of the color constraints are satisfied.
If she has $ 4 $ colors she can color the carpet in the following way:
![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF297D/84535e9e280c4fb80d9cbe6a8b779a69a879098d.png)And she is happy because ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF297D/050547ba0080dee4ce4e2010a283122ee46b002c.png) of the color constraints are satisfied, and ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF297D/93a2fe0ea2a5cac28f71987aac7a9527d1566697.png). Your task is to help her color the carpet.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains three integers $ h,w,k $ $ (2<=h,w<=1000,1<=k<=w·h) $ .
The next $ 2h-1 $ lines describe the color constraints from top to bottom, left to right. They contain $ w-1,w,w-1,w,...,w-1 $ characters respectively. Each color constraint is represented by a character "E" or "N", where "E" means " $ = $ " and "N" means " $ ≠ $ ".
The color constraints listed in the order they are depicted on the picture.</div>
<h3>输出格式</h3>
<br />
<div>If there is a coloring that satisfies at least ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF297D/c7b5e8f543c3882ba6f2a662e01781b4de30f8c7.png) of the color constraints, print "YES" (without quotes) in the first line. In each of the next $ h $ lines, print $ w $ integers describing the coloring.
Otherwise, print "NO" (without quotes).</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>3 4 4
ENE
NNEE
NEE
ENEN
ENN
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>YES
1 1 2 2
3 4 1 1
3 3 2 4</code></pre>
</article>
</div>
</div>
</body>
</html>
