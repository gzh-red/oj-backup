<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Cactus - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573391920:XnHkTiB7A4ydgmNc9f6vxlmBXOOMdBTzMquKRj0CEK4=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22A%20connected%20undirected%20graph%20is%20called%20a%20vertex%20cactus%2C%20if%20each%20vertex%20of%20this%20graph%20belongs%20to%20at%20most%20one%20simple%20cycle.%5Cn%5CnA%20simple%20cycle%20in%20a%20undirected%20graph%20is%20a%20sequence%20of%20distinct%20vertices%20%24%20v_%7B1%7D%2Cv_%7B2%7D%2C...%2Cv_%7Bt%7D%20%24%20%24%20%28t%26gt%3B2%29%20%24%20%2C%20such%20that%20for%20any%20%24%20i%20%24%20%24%20%281%3C%3Di%26lt%3Bt%29%20%24%20exists%20an%20edge%20between%20vertices%20%24%20v_%7Bi%7D%20%24%20and%20%24%20v_%7Bi%2B1%7D%20%24%20%2C%20and%20also%20exists%20an%20edge%20between%20vertices%20%24%20v_%7B1%7D%20%24%20and%20%24%20v_%7Bt%7D%20%24%20.%5Cn%5CnA%20simple%20path%20in%20a%20undirected%20graph%20is%20a%20sequence%20of%20not%20necessarily%20distinct%20vertices%20%24%20v_%7B1%7D%2Cv_%7B2%7D%2C...%2Cv_%7Bt%7D%20%24%20%24%20%28t%26gt%3B0%29%20%24%20%2C%20such%20that%20for%20any%20%24%20i%20%24%20%24%20%281%3C%3Di%26lt%3Bt%29%20%24%20exists%20an%20edge%20between%20vertices%20%24%20v_%7Bi%7D%20%24%20and%20%24%20v_%7Bi%2B1%7D%20%24%20and%20furthermore%20each%20edge%20occurs%20no%20more%20than%20once.%20We%27ll%20say%20that%20a%20simple%20path%20%24%20v_%7B1%7D%2Cv_%7B2%7D%2C...%2Cv_%7Bt%7D%20%24%20starts%20at%20vertex%20%24%20v_%7B1%7D%20%24%20and%20ends%20at%20vertex%20%24%20v_%7Bt%7D%20%24%20.%5Cn%5CnYou%27ve%20got%20a%20graph%20consisting%20of%20%24%20n%20%24%20vertices%20and%20%24%20m%20%24%20edges%2C%20that%20is%20a%20vertex%20cactus.%20Also%2C%20you%27ve%20got%20a%20list%20of%20%24%20k%20%24%20pairs%20of%20interesting%20vertices%20%24%20x_%7Bi%7D%2Cy_%7Bi%7D%20%24%20%2C%20for%20which%20you%20want%20to%20know%20the%20following%20information%20%5Cu2014%20the%20number%20of%20distinct%20simple%20paths%20that%20start%20at%20vertex%20%24%20x_%7Bi%7D%20%24%20and%20end%20at%20vertex%20%24%20y_%7Bi%7D%20%24%20.%20We%20will%20consider%20two%20simple%20paths%20distinct%20if%20the%20sets%20of%20edges%20of%20the%20paths%20are%20distinct.%5Cn%5CnFor%20each%20pair%20of%20interesting%20vertices%20count%20the%20number%20of%20distinct%20simple%20paths%20between%20them.%20As%20this%20number%20can%20be%20rather%20large%2C%20you%20should%20calculate%20it%20modulo%20%24%201000000007%20%24%20%28%20%24%2010%5E%7B9%7D%2B7%20%24%20%29.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20two%20space-separated%20integers%20%24%20n%2Cm%20%24%20%24%20%282%3C%3Dn%3C%3D10%5E%7B5%7D%3B%5Cu00a01%3C%3Dm%3C%3D10%5E%7B5%7D%29%20%24%20%5Cu2014%20the%20number%20of%20vertices%20and%20edges%20in%20the%20graph%2C%20correspondingly.%20Next%20%24%20m%20%24%20lines%20contain%20the%20description%20of%20the%20edges%3A%20the%20%24%20i%20%24%20-th%20line%20contains%20two%20space-separated%20integers%20%24%20a_%7Bi%7D%2Cb_%7Bi%7D%20%24%20%24%20%281%3C%3Da_%7Bi%7D%2Cb_%7Bi%7D%3C%3Dn%29%20%24%20%5Cu2014%20the%20indexes%20of%20the%20vertices%20connected%20by%20the%20%24%20i%20%24%20-th%20edge.%5Cn%5CnThe%20next%20line%20contains%20a%20single%20integer%20%24%20k%20%24%20%24%20%281%3C%3Dk%3C%3D10%5E%7B5%7D%29%20%24%20%5Cu2014%20the%20number%20of%20pairs%20of%20interesting%20vertices.%20Next%20%24%20k%20%24%20lines%20contain%20the%20list%20of%20pairs%20of%20interesting%20vertices%3A%20the%20%24%20i%20%24%20-th%20line%20contains%20two%20space-separated%20numbers%20%24%20x_%7Bi%7D%20%24%20%2C%20%24%20y_%7Bi%7D%20%24%20%24%20%281%3C%3Dx_%7Bi%7D%2Cy_%7Bi%7D%3C%3Dn%3B%5Cu00a0x_%7Bi%7D%5Cu2260y_%7Bi%7D%29%20%24%20%5Cu2014%20the%20indexes%20of%20interesting%20vertices%20in%20the%20%24%20i%20%24%20-th%20pair.%5Cn%5CnIt%20is%20guaranteed%20that%20the%20given%20graph%20is%20a%20vertex%20cactus.%20It%20is%20guaranteed%20that%20the%20graph%20contains%20no%20loops%20or%20multiple%20edges.%20Consider%20the%20graph%20vertices%20are%20numbered%20from%201%20to%20%24%20n%20%24%20.%22%2C%22outputFormat%22%3A%22Print%20%24%20k%20%24%20lines%3A%20in%20the%20%24%20i%20%24%20-th%20line%20print%20a%20single%20integer%20%5Cu2014%20the%20number%20of%20distinct%20simple%20ways%2C%20starting%20at%20%24%20x_%7Bi%7D%20%24%20and%20ending%20at%20%24%20y_%7Bi%7D%20%24%20%2C%20modulo%20%24%201000000007%20%24%20%28%20%24%2010%5E%7B9%7D%2B7%20%24%20%29.%22%2C%22samples%22%3A%5B%5B%2210%2011%5Cn1%202%5Cn2%203%5Cn3%204%5Cn1%204%5Cn3%205%5Cn5%206%5Cn8%206%5Cn8%207%5Cn7%206%5Cn7%209%5Cn9%2010%5Cn6%5Cn1%202%5Cn3%205%5Cn6%209%5Cn9%202%5Cn9%203%5Cn9%2010%5Cn%22%2C%222%5Cn2%5Cn2%5Cn4%5Cn4%5Cn1%5Cn%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F231%5C%2FE%22%2C%22id%22%3A%22231E%22%7D%2C%22translation%22%3A%22%5Cu7ed9%5Cu4e00%5Cu4e2a%5Cu70b9%5Cu6570%5Cu4e3a%24n%24%5Cuff0c%5Cu8fb9%5Cu6570%5Cu4e3a%24m%24%5Cuff0c%5Cu7684%5Cu70b9%5Cu4ed9%5Cu4eba%5Cu638c%5Cr%5Cn%5Cr%5Cn%5Cu70b9%5Cu4ed9%5Cu4eba%5Cu638c%5Cu5b9a%5Cu4e49%5Cuff1a%5Cu5728%5Cu7b80%5Cu5355%5Cu8fde%5Cu901a%5Cu56fe%5Cu4e2d%5Cuff0c%5Cu6bcf%5Cu4e2a%5Cu70b9%5Cu6700%5Cu591a%5Cu5c5e%5Cu4e8e%5Cu4e00%5Cu4e2a%5Cu7b80%5Cu5355%5Cu73af%5Cr%5Cn%5Cr%5Cn%24q%24%5Cu6b21%5Cu8be2%5Cu95ee%5Cu4ece%24x%24%5Cu5f00%5Cu59cb%24y%24%5Cu7ed3%5Cu675f%5Cu6709%5Cu591a%5Cu5c11%5Cu6761%5Cu7b80%5Cu5355%5Cu8def%5Cu5f84%5Cuff0c%5Cu6a21%241000000007%24%5Cr%5Cn%5Cr%5Cn%5Cu7b80%5Cu5355%5Cu73af%5Cu5b9a%5Cu4e49%5Cuff1a%24v_1%2Cv_2%2Cv_3%2C%5C%5Cdots%2Cv_t%24%5Cr%5Cn%5Cr%5Cn%24v_i%24%5Cu548c%24v_%7Bi%2B1%7D%24%5Cu4e4b%5Cu95f4%5Cu5b58%5Cu5728%5Cu4e00%5Cu6761%5Cu8fb9%5Cuff0c%5Cu4e14%24v_t%24%5Cu548c%24v_1%24%5Cu4e4b%5Cu95f4%5Cu5b58%5Cu5728%5Cu4e00%5Cu6761%5Cu8fb9%5Cr%5Cn%5Cr%5Cn%5Cu7b80%5Cu5355%5Cu8def%5Cu5f84%5Cu5b9a%5Cu4e49%5Cuff1a%24v_1%2Cv_2%2Cv_3%2C%5C%5Cdots%2Cv_t%24%5Cr%5Cn%5Cr%5Cn%24v_i%24%5Cu548c%24v_%7Bi%2B1%7D%24%5Cu4e4b%5Cu95f4%5Cu5b58%5Cu5728%5Cu4e00%5Cu6761%5Cu8fb9%5Cu4e14%5Cu6240%5Cu9009%5Cu7684%5Cu8fb9%5Cu4e0d%5Cu80fd%5Cu91cd%5Cu590d%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A38%2C%22totalAccepted%22%3A14%2C%22pid%22%3A%22CF231E%22%2C%22title%22%3A%22Cactus%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A72606%2C%22title%22%3A%22%5Cu7ffb%5Cu8bd1%22%2C%22forum%22%3A%7B%22id%22%3A11687%2C%22name%22%3A%22CF231E%20Cactus%22%2C%22slug%22%3A%22CF231E%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Cactus%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573286098;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Cactus</h1>
<h2>题意翻译</h2>
<div>给一个点数为$n$，边数为$m$，的点仙人掌
点仙人掌定义：在简单连通图中，每个点最多属于一个简单环
$q$次询问从$x$开始$y$结束有多少条简单路径，模$1000000007$
简单环定义：$v_1,v_2,v_3,\dots,v_t$
$v_i$和$v_{i+1}$之间存在一条边，且$v_t$和$v_1$之间存在一条边
简单路径定义：$v_1,v_2,v_3,\dots,v_t$
$v_i$和$v_{i+1}$之间存在一条边且所选的边不能重复</div>
<h2>题目描述</h2>
<div>A connected undirected graph is called a vertex cactus, if each vertex of this graph belongs to at most one simple cycle.
A simple cycle in a undirected graph is a sequence of distinct vertices $ v_{1},v_{2},...,v_{t} $ $ (t&gt;2) $ , such that for any $ i $ $ (1<=i&lt;t) $ exists an edge between vertices $ v_{i} $ and $ v_{i+1} $ , and also exists an edge between vertices $ v_{1} $ and $ v_{t} $ .
A simple path in a undirected graph is a sequence of not necessarily distinct vertices $ v_{1},v_{2},...,v_{t} $ $ (t&gt;0) $ , such that for any $ i $ $ (1<=i&lt;t) $ exists an edge between vertices $ v_{i} $ and $ v_{i+1} $ and furthermore each edge occurs no more than once. We'll say that a simple path $ v_{1},v_{2},...,v_{t} $ starts at vertex $ v_{1} $ and ends at vertex $ v_{t} $ .
You've got a graph consisting of $ n $ vertices and $ m $ edges, that is a vertex cactus. Also, you've got a list of $ k $ pairs of interesting vertices $ x_{i},y_{i} $ , for which you want to know the following information — the number of distinct simple paths that start at vertex $ x_{i} $ and end at vertex $ y_{i} $ . We will consider two simple paths distinct if the sets of edges of the paths are distinct.
For each pair of interesting vertices count the number of distinct simple paths between them. As this number can be rather large, you should calculate it modulo $ 1000000007 $ ( $ 10^{9}+7 $ ).</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains two space-separated integers $ n,m $ $ (2<=n<=10^{5}; 1<=m<=10^{5}) $ — the number of vertices and edges in the graph, correspondingly. Next $ m $ lines contain the description of the edges: the $ i $ -th line contains two space-separated integers $ a_{i},b_{i} $ $ (1<=a_{i},b_{i}<=n) $ — the indexes of the vertices connected by the $ i $ -th edge.
The next line contains a single integer $ k $ $ (1<=k<=10^{5}) $ — the number of pairs of interesting vertices. Next $ k $ lines contain the list of pairs of interesting vertices: the $ i $ -th line contains two space-separated numbers $ x_{i} $ , $ y_{i} $ $ (1<=x_{i},y_{i}<=n; x_{i}≠y_{i}) $ — the indexes of interesting vertices in the $ i $ -th pair.
It is guaranteed that the given graph is a vertex cactus. It is guaranteed that the graph contains no loops or multiple edges. Consider the graph vertices are numbered from 1 to $ n $ .</div>
<h3>输出格式</h3>
<br />
<div>Print $ k $ lines: in the $ i $ -th line print a single integer — the number of distinct simple ways, starting at $ x_{i} $ and ending at $ y_{i} $ , modulo $ 1000000007 $ ( $ 10^{9}+7 $ ).</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>10 11
1 2
2 3
3 4
1 4
3 5
5 6
8 6
8 7
7 6
7 9
9 10
6
1 2
3 5
6 9
9 2
9 3
9 10
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>2
2
2
4
4
1
</code></pre>
</article>
</div>
</div>
</body>
</html>
