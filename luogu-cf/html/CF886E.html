<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Maximum Element - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573399017:uOnzKJugqVO0KJJGu1ymhqezWN2N7mV65XqaWg72VWo=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22One%20day%20Petya%20was%20solving%20a%20very%20interesting%20problem.%20But%20although%20he%20used%20many%20optimization%20techniques%2C%20his%20solution%20still%20got%20Time%20limit%20exceeded%20verdict.%20Petya%20conducted%20a%20thorough%20analysis%20of%20his%20program%20and%20found%20out%20that%20his%20function%20for%20finding%20maximum%20element%20in%20an%20array%20of%20%24%20n%20%24%20positive%20integers%20was%20too%20slow.%20Desperate%2C%20Petya%20decided%20to%20use%20a%20somewhat%20unexpected%20optimization%20using%20parameter%20%24%20k%20%24%20%2C%20so%20now%20his%20function%20contains%20the%20following%20code%3A%5Cn%5Cn%60%3Cbr%3E%3C%5C%2Fbr%3Eint%20fast_max%28int%20n%2C%20int%20a%5B%5D%29%20%7B%20%3Cbr%3E%3C%5C%2Fbr%3E%20%20%20%20int%20ans%20%3D%200%3B%3Cbr%3E%3C%5C%2Fbr%3E%20%20%20%20int%20offset%20%3D%200%3B%3Cbr%3E%3C%5C%2Fbr%3E%20%20%20%20for%20%28int%20i%20%3D%200%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%3Cbr%3E%3C%5C%2Fbr%3E%20%20%20%20%20%20%20%20if%20%28ans%20%3C%20a%5Bi%5D%29%20%7B%3Cbr%3E%3C%5C%2Fbr%3E%20%20%20%20%20%20%20%20%20%20%20%20ans%20%3D%20a%5Bi%5D%3B%3Cbr%3E%3C%5C%2Fbr%3E%20%20%20%20%20%20%20%20%20%20%20%20offset%20%3D%200%3B%3Cbr%3E%3C%5C%2Fbr%3E%20%20%20%20%20%20%20%20%7D%20else%20%7B%3Cbr%3E%3C%5C%2Fbr%3E%20%20%20%20%20%20%20%20%20%20%20%20offset%20%3D%20offset%20%2B%201%3B%3Cbr%3E%3C%5C%2Fbr%3E%20%20%20%20%20%20%20%20%20%20%20%20if%20%28offset%20%3D%3D%20k%29%3Cbr%3E%3C%5C%2Fbr%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20ans%3B%3Cbr%3E%3C%5C%2Fbr%3E%20%20%20%20%20%20%20%20%7D%3Cbr%3E%3C%5C%2Fbr%3E%20%20%20%20return%20ans%3B%3Cbr%3E%3C%5C%2Fbr%3E%7D%3Cbr%3E%3C%5C%2Fbr%3E%60That%20way%20the%20function%20iteratively%20checks%20array%20elements%2C%20storing%20the%20intermediate%20maximum%2C%20and%20if%20after%20%24%20k%20%24%20consecutive%20iterations%20that%20maximum%20has%20not%20changed%2C%20it%20is%20returned%20as%20the%20answer.%5Cn%5CnNow%20Petya%20is%20interested%20in%20fault%20rate%20of%20his%20function.%20He%20asked%20you%20to%20find%20the%20number%20of%20permutations%20of%20integers%20from%20%24%201%20%24%20to%20%24%20n%20%24%20such%20that%20the%20return%20value%20of%20his%20function%20on%20those%20permutations%20is%20not%20equal%20to%20%24%20n%20%24%20.%20Since%20this%20number%20could%20be%20very%20big%2C%20output%20the%20answer%20modulo%20%24%2010%5E%7B9%7D%2B7%20%24%20.%22%2C%22inputFormat%22%3A%22The%20only%20line%20contains%20two%20integers%20%24%20n%20%24%20and%20%24%20k%20%24%20%28%20%24%201%3C%3Dn%2Ck%3C%3D10%5E%7B6%7D%20%24%20%29%2C%20separated%20by%20a%20space%20%5Cu2014%20the%20length%20of%20the%20permutations%20and%20the%20parameter%20%24%20k%20%24%20.%22%2C%22outputFormat%22%3A%22Output%20the%20answer%20to%20the%20problem%20modulo%20%24%2010%5E%7B9%7D%2B7%20%24%20.%22%2C%22samples%22%3A%5B%5B%225%202%5Cn%22%2C%2222%5Cn%22%5D%2C%5B%225%203%5Cn%22%2C%226%5Cn%22%5D%2C%5B%226%203%5Cn%22%2C%2284%5Cn%22%5D%5D%2C%22hint%22%3A%22Permutations%20from%20second%20example%3A%5Cn%5Cn%20%24%20%5B4%2C1%2C2%2C3%2C5%5D%20%24%20%2C%20%24%20%5B4%2C1%2C3%2C2%2C5%5D%20%24%20%2C%20%24%20%5B4%2C2%2C1%2C3%2C5%5D%20%24%20%2C%20%24%20%5B4%2C2%2C3%2C1%2C5%5D%20%24%20%2C%20%24%20%5B4%2C3%2C1%2C2%2C5%5D%20%24%20%2C%20%24%20%5B4%2C3%2C2%2C1%2C5%5D%20%24%20.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F886%5C%2FE%22%2C%22id%22%3A%22886E%22%7D%2C%22translation%22%3A%22%23%23%20%5Cu9898%5Cu76ee%5Cu63cf%5Cu8ff0%5Cr%5Cn%5Cr%5Cn%5Cu4ece%5Cu524d%5Cu6709%5Cu4e00%5Cu4e2a%5Cu53eb%24Petya%24%5Cu7684%5Cu795e%5Cu4ed9%5Cuff0c%5Cu5acc%5Cu81ea%5Cu5df1%5Cu7684%5Cu5e8f%5Cu5217%5Cu6c42max%5Cu592a%5Cu6162%5Cu4e86%5Cuff0c%5Cu4e8e%5Cu662f%5Cu5c06%5Cu5e8f%5Cu5217%5Cu6c42max%5Cu7684%5Cu4ee3%5Cu7801%5Cu6539%5Cu6210%5Cu4e86%5Cu4e0b%5Cu9762%5Cu8fd9%5Cu4e2a%5Cu6837%5Cu5b50%5Cuff1a%5Cr%5Cn%5Cr%5Cn%60%60%60cpp%5Cr%5Cnint%20fast_max%28int%20n%2Cint%20a%5B%5D%29%5Cr%5Cn%7B%5Cr%5Cn%5Ctint%20ans%3D0%3B%5Cr%5Cn%5Ctint%20offset%3D0%3B%5Cr%5Cn%5Ctfor%28int%20i%3D0%3Bi%3Cn%3B%2B%2Bi%29%5Cr%5Cn%5Ct%7B%5Cr%5Cn%5Ct%5Ctif%28ans%3Ca%5Bi%5D%29%5Cr%5Cn%5Ct%5Ct%7B%5Cr%5Cn%5Ct%5Ct%5Ctans%3Da%5Bi%5D%3B%5Cr%5Cn%5Ct%5Ct%5Ctoffset%3D0%3B%5Cr%5Cn%5Ct%5Ct%7D%5Cr%5Cn%5Ct%5Ctelse%5Cr%5Cn%5Ct%5Ct%7B%5Cr%5Cn%5Ct%5Ct%5Ctoffset%2B%2B%3B%5Cr%5Cn%5Ct%5Ct%5Ctif%28offset%3D%3Dk%29return%20ans%3B%5Cr%5Cn%5Ct%5Ct%7D%5Cr%5Cn%5Ct%7D%5Cr%5Cn%5Ctreturn%20ans%3B%5Cr%5Cn%7D%5Cr%5Cn%5C%2F%5C%2F%5Cu5927%5Cu62ec%5Cu53f7%5Cu6362%5Cu884c%5Cuff0c%5Cu65e0%5Cu591a%5Cu4f59%5Cu7a7a%5Cu683c%5Cuff0cby%20wucstdio%5Cr%5Cn%60%60%60%5Cr%5Cn%5Cr%5Cn%5Cu8fd9%5Cu4e2a%5Cu51fd%5Cu6570%5Cu7684%5Cu539f%5Cu7406%5Cu662f%5Cuff0c%5Cu5982%5Cu679c%5Cu78b0%5Cu5230%5Cu4e00%5Cu4e2a%5Cu6570%5Cu540e%5Cu9762%5Cu8fde%5Cu7eed%5Cu7684%24k%24%5Cu4e2a%5Cu6570%5Cu90fd%5Cu6bd4%5Cu5b83%5Cu5c0f%5Cuff0c%5Cu90a3%5Cu4e48%5Cu5c31%5Cu628a%5Cu8fd9%5Cu4e2a%5Cu6570%5Cu5f53%5Cu505a%5Cu5e8f%5Cu5217%5Cu7684%5Cu6700%5Cu5927%5Cu503c%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu7136%5Cu800c%5Cu5f88%5Cu663e%5Cu7136%5Cuff0c%5Cu8fd9%5Cu4efd%5Cu4ee3%5Cu7801%5Cu662f%5Cu9519%5Cu7684%5Cu3002%5Cu8fd9%5Cu4f4d%24Petya%24%5Cu795e%5Cu4ed9%5Cu5bf9%5Cu5b83%5Cu51fa%5Cu9519%5Cu7684%5Cu60c5%5Cu51b5%5Cu5f88%5Cu611f%5Cu5174%5Cu8da3%5Cu3002%5Cu4e8e%5Cu662f%5Cu4ed6%5Cu627e%5Cu5230%5Cu4e86%5Cu540c%5Cu4e3a%5Cu795e%5Cu4ed9%5Cu7684%5Cu4f60%5Cuff0c%5Cu8ba9%5Cu4f60%5Cu6c42%5Cu6709%5Cu591a%5Cu5c11%5Cu957f%5Cu5ea6%5Cu4e3a%24n%24%5Cu7684%5Cu6392%5Cu5217%5Cuff0c%5Cu8fd9%5Cu4e2a%5Cu51fd%5Cu6570%5Cu4f1a%5Cu8fd4%5Cu56de%5Cu9519%5Cu8bef%5Cu7684%5Cu7ed3%5Cu679c%5Cuff0c%5Cu5373%5Cu8fd4%5Cu56de%5Cu503c%5Cu4e0d%5Cu662f%24n%24%5Cu3002%5Cu7531%5Cu4e8e%5Cu7b54%5Cu6848%5Cu8fc7%5Cu5927%5Cuff0c%5Cu4f60%5Cu53ea%5Cu9700%5Cu8981%5Cu8f93%5Cu51fa%5Cu8fd9%5Cu4e2a%5Cu6570%5Cu5bf9%2410%5E9%2B7%24%5Cu53d6%5Cu6a21%5Cu7684%5Cu7ed3%5Cu679c%5Cu3002%5Cr%5Cn%5Cr%5Cn%23%23%20%5Cu8f93%5Cu5165%5Cu8f93%5Cu51fa%5Cu683c%5Cu5f0f%5Cr%5Cn%5Cr%5Cn%23%23%23%20%5Cu8f93%5Cu5165%5Cu683c%5Cu5f0f%5Cr%5Cn%5Cr%5Cn%5Cu4e00%5Cu884c%5Cu4e24%5Cu4e2a%5Cu6b63%5Cu6574%5Cu6570%24n%24%5Cu548c%24k%24%5Cuff0c%5Cu8868%5Cu793a%5Cu6392%5Cu5217%5Cu7684%5Cu957f%5Cu5ea6%5Cu548c%5Cu4e0a%5Cu9762%5Cu90a3%5Cu4efd%5Cu4ee3%5Cu7801%5Cu91cc%5Cu7684%24k%24%5Cu3002%5Cr%5Cn%5Cr%5Cn%23%23%23%20%5Cu8f93%5Cu51fa%5Cu683c%5Cu5f0f%5Cr%5Cn%5Cr%5Cn%5Cu4e00%5Cu884c%5Cu4e00%5Cu4e2a%5Cu6574%5Cu6570%5Cuff0c%5Cu8868%5Cu793a%5Cu7b54%5Cu6848%5Cu5bf9%2410%5E9%2B7%24%5Cu53d6%5Cu6a21%5Cu540e%5Cu7684%5Cu503c%5Cu3002%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A72%2C%22totalAccepted%22%3A42%2C%22pid%22%3A%22CF886E%22%2C%22title%22%3A%22Maximum%20Element%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A38775%2C%22title%22%3A%22CF886E%5Cu7ffb%5Cu8bd1%22%2C%22forum%22%3A%7B%22id%22%3A9036%2C%22name%22%3A%22CF886E%20Maximum%20Element%22%2C%22slug%22%3A%22CF886E%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P4081%22%2C%22title%22%3A%22%5BUSACO17DEC%5DStanding%20Out%20from%20the%20Herd%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22CF161D%22%2C%22title%22%3A%22Distance%20in%20Tree%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1043F%22%2C%22title%22%3A%22Make%20It%20One%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1096E%22%2C%22title%22%3A%22The%20Top%20Scorer%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1096D%22%2C%22title%22%3A%22Easy%20Problem%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22CF%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Maximum%20Element%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Maximum Element</h1>
<h2>题意翻译</h2>
<div>## 题目描述
从前有一个叫$Petya$的神仙，嫌自己的序列求max太慢了，于是将序列求max的代码改成了下面这个样子：
```cpp
int fast_max(int n,int a[])
{
int ans=0;
int offset=0;
for(int i=0;i<n;++i) { if(ans<a[i]) { ans=a[i]; offset=0; } else { offset++; if(offset==k)return ans; } } return ans; } //大括号换行，无多余空格，by wucstdio ``` 这个函数的原理是，如果碰到一个数后面连续的$k$个数都比它小，那么就把这个数当做序列的最大值。 然而很显然，这份代码是错的。这位$Petya$神仙对它出错的情况很感兴趣。于是他找到了同为神仙的你，让你求有多少长度为$n$的排列，这个函数会返回错误的结果，即返回值不是$n$。由于答案过大，你只需要输出这个数对$10^9+7$取模的结果。 ## 输入输出格式 ### 输入格式 一行两个正整数$n$和$k$，表示排列的长度和上面那份代码里的$k$。 ### 输出格式 一行一个整数，表示答案对$10^9+7$取模后的值。</div>
<h2>题目描述</h2>
<div>One day Petya was solving a very interesting problem. But although he used many optimization techniques, his solution still got Time limit exceeded verdict. Petya conducted a thorough analysis of his program and found out that his function for finding maximum element in an array of $ n $ positive integers was too slow. Desperate, Petya decided to use a somewhat unexpected optimization using parameter $ k $ , so now his function contains the following code:
`<br></br>int fast_max(int n, int a[]) { <br></br> int ans = 0;<br></br> int offset = 0;<br></br> for (int i = 0; i < n; ++i)<br></br> if (ans < a[i]) {<br></br> ans = a[i];<br></br> offset = 0;<br></br> } else {<br></br> offset = offset + 1;<br></br> if (offset == k)<br></br> return ans;<br></br> }<br></br> return ans;<br></br>}<br></br>`That way the function iteratively checks array elements, storing the intermediate maximum, and if after $ k $ consecutive iterations that maximum has not changed, it is returned as the answer.
Now Petya is interested in fault rate of his function. He asked you to find the number of permutations of integers from $ 1 $ to $ n $ such that the return value of his function on those permutations is not equal to $ n $ . Since this number could be very big, output the answer modulo $ 10^{9}+7 $ .</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The only line contains two integers $ n $ and $ k $ ( $ 1<=n,k<=10^{6} $ ), separated by a space — the length of the permutations and the parameter $ k $ .</div>
<h3>输出格式</h3>
<br />
<div>Output the answer to the problem modulo $ 10^{9}+7 $ .</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>5 2
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>22
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>5 3
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>6
</code></pre>
<h3>输入样例 #3</h3>
<pre><code>6 3
</code></pre>
<h3>输出样例 #3</h3>
<pre><code>84
</code></pre>
<h2>说明</h2>
<div>Permutations from second example:
$ [4,1,2,3,5] $ , $ [4,1,3,2,5] $ , $ [4,2,1,3,5] $ , $ [4,2,3,1,5] $ , $ [4,3,1,2,5] $ , $ [4,3,2,1,5] $ .</div>
</article>
</div>
</div>
</body>
</html>
