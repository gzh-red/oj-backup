<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Abandoning Roads - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573402297:FCHlS6hB/M9B1UkmTMbFpZtjQOn2Xk9GToGLjU01hbA=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Codefortia%20is%20a%20small%20island%20country%20located%20somewhere%20in%20the%20West%20Pacific.%20It%20consists%20of%20%24%20n%20%24%20settlements%20connected%20by%20%24%20m%20%24%20bidirectional%20gravel%20roads.%20Curiously%20enough%2C%20the%20beliefs%20of%20the%20inhabitants%20require%20the%20time%20needed%20to%20pass%20each%20road%20to%20be%20equal%20either%20to%20%24%20a%20%24%20or%20%24%20b%20%24%20seconds.%20It%27s%20guaranteed%20that%20one%20can%20go%20between%20any%20pair%20of%20settlements%20by%20following%20a%20sequence%20of%20roads.%5Cn%5CnCodefortia%20was%20recently%20struck%20by%20the%20financial%20crisis.%20Therefore%2C%20the%20king%20decided%20to%20abandon%20some%20of%20the%20roads%20so%20that%3A%5Cn%5Cn-%20it%20will%20be%20possible%20to%20travel%20between%20each%20pair%20of%20cities%20using%20the%20remaining%20roads%20only%2C%5Cn-%20the%20sum%20of%20times%20required%20to%20pass%20each%20remaining%20road%20will%20be%20minimum%20possible%20%28in%20other%20words%2C%20remaining%20roads%20must%20form%20minimum%20spanning%20tree%2C%20using%20the%20time%20to%20pass%20the%20road%20as%20its%20weight%29%2C%5Cn-%20among%20all%20the%20plans%20minimizing%20the%20sum%20of%20times%20above%2C%20the%20time%20required%20to%20travel%20between%20the%20king%27s%20residence%20%28in%20settlement%20%24%201%20%24%20%29%20and%20the%20parliament%20house%20%28in%20settlement%20%24%20p%20%24%20%29%20using%20the%20remaining%20roads%20only%20will%20be%20minimum%20possible.%5Cn%5CnThe%20king%2C%20however%2C%20forgot%20where%20the%20parliament%20house%20was.%20For%20each%20settlement%20%24%20p%20%3D%201%2C%202%2C%20%5C%5Cdots%2C%20n%20%24%20%2C%20can%20you%20tell%20what%20is%20the%20minimum%20time%20required%20to%20travel%20between%20the%20king%27s%20residence%20and%20the%20parliament%20house%20%28located%20in%20settlement%20%24%20p%20%24%20%29%20after%20some%20roads%20are%20abandoned%3F%22%2C%22inputFormat%22%3A%22The%20first%20line%20of%20the%20input%20contains%20four%20integers%20%24%20n%20%24%20%2C%20%24%20m%20%24%20%2C%20%24%20a%20%24%20and%20%24%20b%20%24%20%28%20%24%202%20%5C%5Cleq%20n%20%5C%5Cleq%2070%20%24%20%2C%20%24%20n%20-%201%20%5C%5Cleq%20m%20%5C%5Cleq%20200%20%24%20%2C%20%24%201%20%5C%5Cleq%20a%20%3C%20b%20%5C%5Cleq%2010%5E7%20%24%20%29%20%5Cu2014%20the%20number%20of%20settlements%20and%20gravel%20roads%20in%20Codefortia%2C%20and%20two%20possible%20travel%20times.%20Each%20of%20the%20following%20lines%20contains%20three%20integers%20%24%20u%2C%20v%2C%20c%20%24%20%28%20%24%201%20%5C%5Cleq%20u%2C%20v%20%5C%5Cleq%20n%20%24%20%2C%20%24%20u%20%5C%5Cneq%20v%20%24%20%2C%20%24%20c%20%5C%5Cin%20%5C%5C%7Ba%2C%20b%5C%5C%7D%20%24%20%29%20denoting%20a%20single%20gravel%20road%20between%20the%20settlements%20%24%20u%20%24%20and%20%24%20v%20%24%20%2C%20which%20requires%20%24%20c%20%24%20minutes%20to%20travel.%5Cn%5CnYou%20can%20assume%20that%20the%20road%20network%20is%20connected%20and%20has%20no%20loops%20or%20multiedges.%22%2C%22outputFormat%22%3A%22Output%20a%20single%20line%20containing%20%24%20n%20%24%20integers.%20The%20%24%20p%20%24%20-th%20of%20them%20should%20denote%20the%20minimum%20possible%20time%20required%20to%20travel%20from%20%24%201%20%24%20to%20%24%20p%20%24%20after%20the%20selected%20roads%20are%20abandoned.%20Note%20that%20for%20each%20%24%20p%20%24%20you%20can%20abandon%20a%20different%20set%20of%20roads.%22%2C%22samples%22%3A%5B%5B%22%5Cn5%205%2020%2025%5Cn1%202%2025%5Cn2%203%2025%5Cn3%204%2020%5Cn4%205%2020%5Cn5%201%2020%5Cn%22%2C%22%5Cn0%2025%2060%2040%2020%5Cn%22%5D%2C%5B%22%5Cn6%207%2013%2022%5Cn1%202%2013%5Cn2%203%2013%5Cn1%204%2022%5Cn3%204%2013%5Cn4%205%2013%5Cn5%206%2013%5Cn6%201%2013%5Cn%22%2C%22%5Cn0%2013%2026%2039%2026%2013%5Cn%22%5D%5D%2C%22hint%22%3A%22The%20minimum%20possible%20sum%20of%20times%20required%20to%20pass%20each%20road%20in%20the%20first%20example%20is%20%24%2085%20%24%20%5Cu2014%20exactly%20one%20of%20the%20roads%20with%20passing%20time%20%24%2025%20%24%20must%20be%20abandoned.%20Note%20that%20after%20one%20of%20these%20roads%20is%20abandoned%2C%20it%27s%20now%20impossible%20to%20travel%20between%20settlements%20%24%201%20%24%20and%20%24%203%20%24%20in%20time%20%24%2050%20%24%20.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B5000%5D%2C%22memory%22%3A%5B512000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F1149%5C%2FD%22%2C%22id%22%3A%221149D%22%7D%2C%22translation%22%3A%22%5Cu4e00%5Cu5f20n%5Cu4e2a%5Cu70b9m%5Cu6761%5Cu8fb9%5Cu7684%5Cu65e0%5Cu5411%5Cu56fe%5Cuff0c%5Cu53ea%5Cu6709a%2Cb%5Cu4e24%5Cu79cd%5Cu8fb9%5Cu6743%28a%3Cb%29%5Cuff0c%5Cu5bf9%5Cu4e8e%5Cu6bcf%5Cu4e2ai%5Cuff0c%5Cu6c42%5Cu56fe%5Cu4e2d%5Cu6240%5Cu6709%5Cu7684%5Cu6700%5Cu5c0f%5Cu751f%5Cu6210%5Cu6811%5Cu4e2d%5Cuff0c%5Cu4ece1%5Cu5230i%5Cu8ddd%5Cu79bb%5Cu7684%5Cu6700%5Cu5c0f%5Cu503c%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A126%2C%22totalAccepted%22%3A40%2C%22pid%22%3A%22CF1149D%22%2C%22title%22%3A%22Abandoning%20Roads%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P1269%22%2C%22title%22%3A%22%5Cu4fe1%5Cu53f7%5Cu653e%5Cu5927%5Cu5668%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P1273%22%2C%22title%22%3A%22%5Cu6709%5Cu7ebf%5Cu7535%5Cu89c6%5Cu7f51%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P5158%22%2C%22title%22%3A%22%5Cu3010%5Cu6a21%5Cu677f%5Cu3011%5Cu591a%5Cu9879%5Cu5f0f%5Cu5feb%5Cu901f%5Cu63d2%5Cu503c%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P5327%22%2C%22title%22%3A%22%5BZJOI2019%5D%5Cu8bed%5Cu8a00%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22CF1149C%22%2C%22title%22%3A%22Tree%20Generator%5Cu2122%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Abandoning%20Roads%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Abandoning Roads</h1>
<h2>题意翻译</h2>
<div>一张n个点m条边的无向图，只有a,b两种边权(a<b)，对于每个i，求图中所有的最小生成树中，从1到i距离的最小值</div>
<h2>题目描述</h2>
<div>Codefortia is a small island country located somewhere in the West Pacific. It consists of $ n $ settlements connected by $ m $ bidirectional gravel roads. Curiously enough, the beliefs of the inhabitants require the time needed to pass each road to be equal either to $ a $ or $ b $ seconds. It's guaranteed that one can go between any pair of settlements by following a sequence of roads.
Codefortia was recently struck by the financial crisis. Therefore, the king decided to abandon some of the roads so that:
- it will be possible to travel between each pair of cities using the remaining roads only,
- the sum of times required to pass each remaining road will be minimum possible (in other words, remaining roads must form minimum spanning tree, using the time to pass the road as its weight),
- among all the plans minimizing the sum of times above, the time required to travel between the king's residence (in settlement $ 1 $ ) and the parliament house (in settlement $ p $ ) using the remaining roads only will be minimum possible.
The king, however, forgot where the parliament house was. For each settlement $ p = 1, 2, \dots, n $ , can you tell what is the minimum time required to travel between the king's residence and the parliament house (located in settlement $ p $ ) after some roads are abandoned?</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line of the input contains four integers $ n $ , $ m $ , $ a $ and $ b $ ( $ 2 \leq n \leq 70 $ , $ n - 1 \leq m \leq 200 $ , $ 1 \leq a < b \leq 10^7 $ ) — the number of settlements and gravel roads in Codefortia, and two possible travel times. Each of the following lines contains three integers $ u, v, c $ ( $ 1 \leq u, v \leq n $ , $ u \neq v $ , $ c \in \{a, b\} $ ) denoting a single gravel road between the settlements $ u $ and $ v $ , which requires $ c $ minutes to travel.
You can assume that the road network is connected and has no loops or multiedges.</div>
<h3>输出格式</h3>
<br />
<div>Output a single line containing $ n $ integers. The $ p $ -th of them should denote the minimum possible time required to travel from $ 1 $ to $ p $ after the selected roads are abandoned. Note that for each $ p $ you can abandon a different set of roads.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>
5 5 20 25
1 2 25
2 3 25
3 4 20
4 5 20
5 1 20
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>
0 25 60 40 20
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>
6 7 13 22
1 2 13
2 3 13
1 4 22
3 4 13
4 5 13
5 6 13
6 1 13
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>
0 13 26 39 26 13
</code></pre>
<h2>说明</h2>
<div>The minimum possible sum of times required to pass each road in the first example is $ 85 $ — exactly one of the roads with passing time $ 25 $ must be abandoned. Note that after one of these roads is abandoned, it's now impossible to travel between settlements $ 1 $ and $ 3 $ in time $ 50 $ .</div>
</article>
</div>
</div>
</body>
</html>
