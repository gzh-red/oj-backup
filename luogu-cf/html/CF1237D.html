<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Balanced Playlist - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573403546:N3LtbtrnQVErcGM0IuwIr7QlhMo0BRiolBuh/2bfAkU=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Your%20favorite%20music%20streaming%20platform%20has%20formed%20a%20perfectly%20balanced%20playlist%20exclusively%20for%20you.%20The%20playlist%20consists%20of%20%24%20n%20%24%20tracks%20numbered%20from%20%24%201%20%24%20to%20%24%20n%20%24%20.%20The%20playlist%20is%20automatic%20and%20cyclic%3A%20whenever%20track%20%24%20i%20%24%20finishes%20playing%2C%20track%20%24%20i%2B1%20%24%20starts%20playing%20automatically%3B%20after%20track%20%24%20n%20%24%20goes%20track%20%24%201%20%24%20.%5Cn%5CnFor%20each%20track%20%24%20i%20%24%20%2C%20you%20have%20estimated%20its%20coolness%20%24%20a_i%20%24%20.%20The%20higher%20%24%20a_i%20%24%20is%2C%20the%20cooler%20track%20%24%20i%20%24%20is.%5Cn%5CnEvery%20morning%2C%20you%20choose%20a%20track.%20The%20playlist%20then%20starts%20playing%20from%20this%20track%20in%20its%20usual%20cyclic%20fashion.%20At%20any%20moment%2C%20you%20remember%20the%20maximum%20coolness%20%24%20x%20%24%20of%20already%20played%20tracks.%20Once%20you%20hear%20that%20a%20track%20with%20coolness%20strictly%20less%20than%20%24%20%5C%5Cfrac%7Bx%7D%7B2%7D%20%24%20%28no%20rounding%29%20starts%20playing%2C%20you%20turn%20off%20the%20music%20immediately%20to%20keep%20yourself%20in%20a%20good%20mood.%5Cn%5CnFor%20each%20track%20%24%20i%20%24%20%2C%20find%20out%20how%20many%20tracks%20you%20will%20listen%20to%20before%20turning%20off%20the%20music%20if%20you%20start%20your%20morning%20with%20track%20%24%20i%20%24%20%2C%20or%20determine%20that%20you%20will%20never%20turn%20the%20music%20off.%20Note%20that%20if%20you%20listen%20to%20the%20same%20track%20several%20times%2C%20every%20time%20must%20be%20counted.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20a%20single%20integer%20%24%20n%20%24%20%28%20%24%202%20%5C%5Cle%20n%20%5C%5Cle%2010%5E5%20%24%20%29%2C%20denoting%20the%20number%20of%20tracks%20in%20the%20playlist.%5Cn%5CnThe%20second%20line%20contains%20%24%20n%20%24%20integers%20%24%20a_1%2C%20a_2%2C%20%5C%5Cldots%2C%20a_n%20%24%20%28%20%24%201%20%5C%5Cle%20a_i%20%5C%5Cle%2010%5E9%20%24%20%29%2C%20denoting%20coolnesses%20of%20the%20tracks.%22%2C%22outputFormat%22%3A%22Output%20%24%20n%20%24%20integers%20%24%20c_1%2C%20c_2%2C%20%5C%5Cldots%2C%20c_n%20%24%20%2C%20where%20%24%20c_i%20%24%20is%20either%20the%20number%20of%20tracks%20you%20will%20listen%20to%20if%20you%20start%20listening%20from%20track%20%24%20i%20%24%20or%20%24%20-1%20%24%20if%20you%20will%20be%20listening%20to%20music%20indefinitely.%22%2C%22samples%22%3A%5B%5B%22%5Cn4%5Cn11%205%202%207%5Cn%22%2C%22%5Cn1%201%203%202%5Cn%22%5D%2C%5B%22%5Cn4%5Cn3%202%205%203%5Cn%22%2C%22%5Cn5%204%203%206%5Cn%22%5D%2C%5B%22%5Cn3%5Cn4%203%206%5Cn%22%2C%22%5Cn-1%20-1%20-1%5Cn%22%5D%5D%2C%22hint%22%3A%22In%20the%20first%20example%2C%20here%20is%20what%20will%20happen%20if%20you%20start%20with...%5Cn%5Cn-%20track%20%24%201%20%24%20%3A%20listen%20to%20track%20%24%201%20%24%20%2C%20stop%20as%20%24%20a_2%20%3C%20%5C%5Cfrac%7Ba_1%7D%7B2%7D%20%24%20.%5Cn-%20track%20%24%202%20%24%20%3A%20listen%20to%20track%20%24%202%20%24%20%2C%20stop%20as%20%24%20a_3%20%3C%20%5C%5Cfrac%7Ba_2%7D%7B2%7D%20%24%20.%5Cn-%20track%20%24%203%20%24%20%3A%20listen%20to%20track%20%24%203%20%24%20%2C%20listen%20to%20track%20%24%204%20%24%20%2C%20listen%20to%20track%20%24%201%20%24%20%2C%20stop%20as%20%24%20a_2%20%3C%20%5C%5Cfrac%7B%5C%5Cmax%28a_3%2C%20a_4%2C%20a_1%29%7D%7B2%7D%20%24%20.%5Cn-%20track%20%24%204%20%24%20%3A%20listen%20to%20track%20%24%204%20%24%20%2C%20listen%20to%20track%20%24%201%20%24%20%2C%20stop%20as%20%24%20a_2%20%3C%20%5C%5Cfrac%7B%5C%5Cmax%28a_4%2C%20a_1%29%7D%7B2%7D%20%24%20.%5Cn%5CnIn%20the%20second%20example%2C%20if%20you%20start%20with%20track%20%24%204%20%24%20%2C%20you%20will%20listen%20to%20track%20%24%204%20%24%20%2C%20listen%20to%20track%20%24%201%20%24%20%2C%20listen%20to%20track%20%24%202%20%24%20%2C%20listen%20to%20track%20%24%203%20%24%20%2C%20listen%20to%20track%20%24%204%20%24%20again%2C%20listen%20to%20track%20%24%201%20%24%20again%2C%20and%20stop%20as%20%24%20a_2%20%3C%20%5C%5Cfrac%7Bmax%28a_4%2C%20a_1%2C%20a_2%2C%20a_3%2C%20a_4%2C%20a_1%29%7D%7B2%7D%20%24%20.%20Note%20that%20both%20track%20%24%201%20%24%20and%20track%20%24%204%20%24%20are%20counted%20twice%20towards%20the%20result.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B512000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F1237%5C%2FD%22%2C%22id%22%3A%221237D%22%7D%2C%22translation%22%3A%22%23%23%20%5Cu9898%5Cu76ee%5Cu63cf%5Cu8ff0%5Cr%5Cn%5Cr%5Cn%5Cu60a8%5Cu6700%5Cu7231%5Cu7684%5Cu97f3%5Cu4e50%5Cu5e73%5Cu53f0%20Imakf%20%5Cu4e3a%5Cu60a8%5Cu4e13%5Cu95e8%5Cu63a8%5Cu51fa%5Cu4e86%5Cu4e00%5Cu4efd%5Cu5b8c%5Cu7f8e%5Cu5e73%5Cu8861%5Cu7684%5Cu6b4c%5Cu5355%5Cuff0c%5Cu5171%20%24n%24%20%5Cu9996%5Cu66f2%5Cu5b50%5Cuff0c%5Cu7f16%5Cu53f7%5Cu4ece%20%241%24%20%5Cu5230%20%24n%24%5Cu3002%5Cu60a8%5Cu542c%5Cu6b4c%5Cu662f%5Cu5217%5Cu8868%5Cu5faa%5Cu73af%5Cu7684%5Cuff0c%5Cu6240%5Cu4ee5%5Cu8bf4%5Cu60a8%5Cu542c%5Cu5b8c%5Cu7b2c%20%24i%24%20%5Cu9996%5Cu6b4c%5Cu540e%5Cuff0c%5Cu4e0b%5Cu4e00%5Cu9996%5Cu4f1a%5Cu64ad%5Cu653e%5Cu7b2c%20%24i%20%2B%201%24%20%5Cu9996%5Cu6b4c%5Cuff0c%5Cu542c%5Cu5b8c%5Cu6700%5Cu540e%5Cu4e00%5Cu9996%5Cu6b4c%5Cu540e%5Cu5c06%5Cu4f1a%5Cu4ece%5Cu5934%5Cu64ad%5Cu653e%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu60a8%5Cu6839%5Cu636e%5Cu81ea%5Cu5df1%5Cu7684%5Cu611f%5Cu89c9%5Cuff0c%5Cu4e3a%5Cu6bcf%5Cu9996%5Cu6b4c%5Cu4f30%5Cu8ba1%5Cu4e86%5Cu4e00%5Cu4e2a%2A%2AKUN%5Cu503c%2A%2A%5Cuff0c%5Cu7b2c%20%24i%24%20%5Cu9996%5Cu6b4c%5Cu7684KUN%5Cu503c%5Cu662f%20%24a_i%24.%5Cr%5Cn%5Cr%5Cn%5Cu6bcf%5Cu5929%5Cu65e9%5Cu4e0a%5Cu60a8%5Cu90fd%5Cu4f1a%5Cu4ece%5Cu4e00%5Cu9996%5Cu6b4c%5Cu5f00%5Cu59cb%5Cu542c%5Cuff0c%5Cu542c%5Cu7684%5Cu8fc7%5Cu7a0b%5Cu4e2d%5Cuff0c%5Cu60a8%5Cu5c31%5Cu4f1a%5Cu8bb0%5Cu4f4f%5Cu60a8%5Cu5df2%5Cu7ecf%5Cu542c%5Cu7684%5Cu6b4c%5Cu4e2d%5Cu6700%5Cu5927%5Cu7684KUN%5Cu503c%5Cu662f%5Cu591a%5Cu5c11%5Cuff0c%5Cu8bb0%5Cu4e3a%20%24x%24%5Cu3002%5Cu5f53%5Cu60a8%5Cu542c%5Cu5230%5Cu4e00%5Cu9996KUN%5Cu503c%5Cu4e25%5Cu683c%5Cu5c0f%5Cu4e8e%20%24%5C%5Cdfrac%7Bx%7D%7B2%7D%24%20%5Cu7684%5Cu6b4c%5Cu66f2%5Cu65f6%5Cuff0c%5Cu60a8%5Cu4f1a%5Cu7acb%5Cu523b%5Cu7838%5Cu6389%5Cu64ad%5Cu653e%5Cu5668%5Cuff0c%5Cu4ee5%5Cu4fdd%5Cu6301%5Cu6bcf%5Cu5929%5Cu7684%5Cu597d%5Cu5fc3%5Cu60c5%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu4e45%5Cu800c%5Cu4e45%5Cu4e4b%5Cuff0c%5Cu60a8%5Cu5c31%5Cu60f3%5Cu77e5%5Cu9053%5Cu5bf9%5Cu4e8e%5Cu6bcf%5Cu4e00%5Cu9996%5Cu6b4c%20%24i%24%20%5Cuff0c%5Cu5982%5Cu679c%5Cu4ece%5Cu5b83%5Cu5f00%5Cu59cb%5Cu542c%5Cuff0c%5Cu5230%5Cu505c%5Cu6b62%5Cu64ad%5Cu653e%5Cu4e4b%5Cu524d%5Cu4e00%5Cu5171%5Cu53ef%5Cu4ee5%5Cu542c%5Cu591a%5Cu5c11%5Cu9996%5Cu6b4c%5Cuff1f%5Cu4e00%5Cu9996%5Cu6b4c%5Cu5982%5Cu679c%5Cu88ab%5Cu91cd%5Cu590d%5Cu64ad%5Cu653e%5Cuff0c%5Cu90a3%5Cu6bcf%5Cu4e00%5Cu6b21%5Cu90fd%5Cu8981%5Cu7edf%5Cu8ba1%5Cu3002%5Cr%5Cn%5Cr%5Cn%23%23%20%5Cu8f93%5Cu5165%5Cu683c%5Cu5f0f%5Cr%5Cn%5Cr%5Cn%5Cu7b2c%5Cu4e00%5Cu884c%20%24n%20%282%5C%5Cle%20n%20%5C%5Cle%2010%5E5%29%24%5Cuff0c%5Cu8868%5Cu793a%5Cu6b4c%5Cu5355%5Cu4e2d%5Cu7684%5Cu6b4c%5Cu66f2%5Cu6570%5Cu91cf%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu7b2c%5Cu4e8c%5Cu884c%5Cu5171%20%24n%24%20%5Cu4e2a%5Cu6574%5Cu6570%20%24a_1%2Ca_2%2C...%2Ca_n%24%20%5Cu8868%5Cu793a%5Cu6bcf%5Cu4e00%5Cu9996%5Cu6b4c%5Cu7684KUN%5Cu503c%5Cu3002%5Cr%5Cn%5Cr%5Cn%23%23%20%5Cu8f93%5Cu51fa%5Cu683c%5Cu5f0f%5Cr%5Cn%5Cr%5Cn%5Cu4e00%5Cu884c%5Cu5171%20%24n%24%20%5Cu4e2a%5Cu6574%5Cu6570%5Cuff0c%5Cu7b2c%20%24i%24%20%5Cu4e2a%5Cu6574%5Cu6570%5Cu8868%5Cu793a%5Cu4ece%5Cu7b2c%20%24i%24%20%5Cu9996%5Cu6b4c%5Cu5f00%5Cu59cb%5Cu542c%5Cuff0c%5Cu5230%5Cu505c%5Cu6b62%5Cu64ad%5Cu653e%5Cu4e4b%5Cu524d%5Cu4e00%5Cu5171%5Cu53ef%5Cu4ee5%5Cu542c%5Cu591a%5Cu5c11%5Cu9996%5Cu6b4c%5Cu3002%5Cr%5Cn%5Cr%5Cn%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A109%2C%22totalAccepted%22%3A66%2C%22pid%22%3A%22CF1237D%22%2C%22title%22%3A%22Balanced%20Playlist%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P3948%22%2C%22title%22%3A%22%5Cu6570%5Cu636e%5Cu7ed3%5Cu6784%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22CF280B%22%2C%22title%22%3A%22Maximum%20Xor%20Secondary%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1061D%22%2C%22title%22%3A%22TV%20Shows%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1200D%22%2C%22title%22%3A%22White%20Lines%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1236A%22%2C%22title%22%3A%22Stones%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Balanced%20Playlist%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Balanced Playlist</h1>
<h2>题意翻译</h2>
<div>## 题目描述
您最爱的音乐平台 Imakf 为您专门推出了一份完美平衡的歌单，共 $n$ 首曲子，编号从 $1$ 到 $n$。您听歌是列表循环的，所以说您听完第 $i$ 首歌后，下一首会播放第 $i + 1$ 首歌，听完最后一首歌后将会从头播放。
您根据自己的感觉，为每首歌估计了一个**KUN值**，第 $i$ 首歌的KUN值是 $a_i$.
每天早上您都会从一首歌开始听，听的过程中，您就会记住您已经听的歌中最大的KUN值是多少，记为 $x$。当您听到一首KUN值严格小于 $\dfrac{x}{2}$ 的歌曲时，您会立刻砸掉播放器，以保持每天的好心情。
久而久之，您就想知道对于每一首歌 $i$ ，如果从它开始听，到停止播放之前一共可以听多少首歌？一首歌如果被重复播放，那每一次都要统计。
## 输入格式
第一行 $n (2\le n \le 10^5)$，表示歌单中的歌曲数量。
第二行共 $n$ 个整数 $a_1,a_2,...,a_n$ 表示每一首歌的KUN值。
## 输出格式
一行共 $n$ 个整数，第 $i$ 个整数表示从第 $i$ 首歌开始听，到停止播放之前一共可以听多少首歌。
</div>
<h2>题目描述</h2>
<div>Your favorite music streaming platform has formed a perfectly balanced playlist exclusively for you. The playlist consists of $ n $ tracks numbered from $ 1 $ to $ n $ . The playlist is automatic and cyclic: whenever track $ i $ finishes playing, track $ i+1 $ starts playing automatically; after track $ n $ goes track $ 1 $ .
For each track $ i $ , you have estimated its coolness $ a_i $ . The higher $ a_i $ is, the cooler track $ i $ is.
Every morning, you choose a track. The playlist then starts playing from this track in its usual cyclic fashion. At any moment, you remember the maximum coolness $ x $ of already played tracks. Once you hear that a track with coolness strictly less than $ \frac{x}{2} $ (no rounding) starts playing, you turn off the music immediately to keep yourself in a good mood.
For each track $ i $ , find out how many tracks you will listen to before turning off the music if you start your morning with track $ i $ , or determine that you will never turn the music off. Note that if you listen to the same track several times, every time must be counted.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains a single integer $ n $ ( $ 2 \le n \le 10^5 $ ), denoting the number of tracks in the playlist.
The second line contains $ n $ integers $ a_1, a_2, \ldots, a_n $ ( $ 1 \le a_i \le 10^9 $ ), denoting coolnesses of the tracks.</div>
<h3>输出格式</h3>
<br />
<div>Output $ n $ integers $ c_1, c_2, \ldots, c_n $ , where $ c_i $ is either the number of tracks you will listen to if you start listening from track $ i $ or $ -1 $ if you will be listening to music indefinitely.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>
4
11 5 2 7
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>
1 1 3 2
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>
4
3 2 5 3
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>
5 4 3 6
</code></pre>
<h3>输入样例 #3</h3>
<pre><code>
3
4 3 6
</code></pre>
<h3>输出样例 #3</h3>
<pre><code>
-1 -1 -1
</code></pre>
<h2>说明</h2>
<div>In the first example, here is what will happen if you start with...
- track $ 1 $ : listen to track $ 1 $ , stop as $ a_2 < \frac{a_1}{2} $ .
- track $ 2 $ : listen to track $ 2 $ , stop as $ a_3 < \frac{a_2}{2} $ .
- track $ 3 $ : listen to track $ 3 $ , listen to track $ 4 $ , listen to track $ 1 $ , stop as $ a_2 < \frac{\max(a_3, a_4, a_1)}{2} $ .
- track $ 4 $ : listen to track $ 4 $ , listen to track $ 1 $ , stop as $ a_2 < \frac{\max(a_4, a_1)}{2} $ .
In the second example, if you start with track $ 4 $ , you will listen to track $ 4 $ , listen to track $ 1 $ , listen to track $ 2 $ , listen to track $ 3 $ , listen to track $ 4 $ again, listen to track $ 1 $ again, and stop as $ a_2 < \frac{max(a_4, a_1, a_2, a_3, a_4, a_1)}{2} $ . Note that both track $ 1 $ and track $ 4 $ are counted twice towards the result.</div>
</article>
</div>
</div>
</body>
</html>
