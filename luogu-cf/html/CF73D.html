<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>FreeDiv - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573390566:8R2UMzQqLQbwJ+Cz57KCW3GLIMPvavnlTO0dJcNcW7o=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Vasya%20plays%20FreeDiv.%20In%20this%20game%20he%20manages%20a%20huge%20state%2C%20which%20has%20%24%20n%20%24%20cities%20and%20%24%20m%20%24%20two-way%20roads%20between%20them.%20Unfortunately%2C%20not%20from%20every%20city%20you%20can%20reach%20any%20other%20one%20moving%20along%20these%20roads.%20Therefore%20Vasya%20decided%20to%20divide%20the%20state%20into%20provinces%20so%20that%20in%20every%20province%2C%20one%20could%20reach%20from%20every%20city%20all%20the%20cities%20of%20the%20province%2C%20but%20there%20are%20no%20roads%20between%20provinces.%5Cn%5CnUnlike%20other%20turn-based%20strategies%2C%20in%20FreeDiv%20a%20player%20has%20the%20opportunity%20to%20build%20tunnels%20between%20cities.%20The%20tunnels%20are%20two-way%20roads%20along%20which%20one%20can%20move%20armies%20undetected%20by%20the%20enemy.%20However%2C%20no%20more%20than%20one%20tunnel%20can%20be%20connected%20to%20each%20city.%20As%20for%20Vasya%2C%20he%20wants%20to%20build%20a%20network%20of%20tunnels%20so%20that%20any%20pair%20of%20cities%20in%20his%20state%20were%20reachable%20by%20some%20path%20consisting%20of%20roads%20and%20a%20tunnels.%20But%20at%20that%20no%20more%20than%20%24%20k%20%24%20tunnels%20are%20connected%20to%20each%20province%20%28otherwise%2C%20the%20province%20will%20be%20difficult%20to%20keep%20in%20case%20other%20provinces%20are%20captured%20by%20enemy%20armies%29.%5Cn%5CnVasya%20discovered%20that%20maybe%20he%20will%20not%20be%20able%20to%20build%20such%20a%20network%20for%20the%20current%20condition%20of%20the%20state.%20Maybe%20he%27ll%20have%20first%20to%20build%20several%20roads%20between%20cities%20in%20different%20provinces%20to%20merge%20the%20provinces.%20Your%20task%20is%20to%20determine%20the%20minimum%20number%20of%20roads%20Vasya%20needs%20to%20build%20so%20that%20it%20was%20possible%20to%20build%20the%20required%20network%20of%20tunnels%20in%20the%20resulting%20state.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20three%20integers%20%24%20n%20%24%20%2C%20%24%20m%20%24%20and%20%24%20k%20%24%20%28%20%24%201%3C%3Dn%2Ck%3C%3D10%5E%7B6%7D%2C0%3C%3Dm%3C%3D10%5E%7B6%7D%20%24%20%29.%20Each%20of%20the%20next%20%24%20m%20%24%20lines%20contains%20two%20integers.%20They%20are%20the%20numbers%20of%20cities%20connected%20by%20a%20corresponding%20road.%20No%20road%20connects%20city%20to%20itself%20and%20there%20is%20at%20most%20one%20road%20between%20each%20pair%20of%20cities.%22%2C%22outputFormat%22%3A%22Print%20a%20single%20number%2C%20the%20minimum%20number%20of%20additional%20roads.%22%2C%22samples%22%3A%5B%5B%223%203%202%5Cn1%202%5Cn2%203%5Cn3%201%5Cn%22%2C%220%22%5D%2C%5B%224%202%202%5Cn1%202%5Cn3%204%5Cn%22%2C%220%22%5D%2C%5B%224%200%202%5Cn%22%2C%221%22%5D%5D%2C%22hint%22%3A%22In%20the%20first%20example%20only%20one%20province%20exists%2C%20so%20it%20is%20not%20necessary%20to%20build%20any%20tunnels%20or%20roads.%5Cn%5CnIn%20the%20second%20example%20two%20provinces%20exist.%20It%20is%20possible%20to%20merge%20the%20provinces%20by%20building%20a%20tunnel%20between%20cities%201%20and%203.%5Cn%5CnIn%20the%20third%20example%20at%20least%20one%20additional%20road%20is%20necessary.%20For%20example%20it%20is%20possible%20to%20build%20additional%20road%20between%20cities%201%20and%202%20and%20build%20two%20tunnels%20between%20cities%201%20and%203%2C%202%20and%204%20after%20that.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B5000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F73%5C%2FD%22%2C%22id%22%3A%2273D%22%7D%2C%22translation%22%3A%22%5Cu6709n%5Cu4e2a%5Cu9876%5Cu70b9m%5Cu6761%5Cu8fb9%5Cuff0c%5Cu6bcf%5Cu4e2a%5Cu9876%5Cu70b9%5Cu53ea%5Cu80fd%5Cu8fde%5Cu63a51%5Cu4e2a%5Cu65e0%5Cu9700%5Cu82b1%5Cu8d39%5Cu7684%5Cu8fb9%5Cuff0c%5Cu65e0%5Cu6570%5Cu4e2a%5Cu4ee3%5Cu4ef7%5Cu552f1%5Cu7684%5Cu8fb9%5Cuff0c%5Cu6bcf%5Cu4e2a%5Cu8fde%5Cu901a%5Cu5206%5Cu91cf%5Cu53ea%5Cu80fd%5Cu8fde%5Cu63a5k%5Cu4e2a%5Cu65e0%5Cu9700%5Cu82b1%5Cu8d39%5Cu7684%5Cu8fb9%5Cuff0c%5Cu65e0%5Cu6570%5Cu4e2a%5Cu4ee3%5Cu4ef7%5Cu552f1%5Cu7684%5Cu8fb9%5Cu3002ps%5Cuff1a%5Cu5df2%5Cu7ed9%5Cu5b9a%5Cu7684%5Cu8fb9%5Cu9664%5Cu5916%5Cr%5Cn%23%23%23%20%5Cu8f93%5Cu5165%5Cr%5Cnnmk%5Cr%5Cn%5Cu6bcf%5Cu6761%5Cu8fb9%5Cu7684%5Cu4e24%5Cu4e2a%5Cu9876%5Cu70b9%5Cr%5Cn%23%23%23%20%5Cu8f93%5Cu51fa%5Cr%5Cn%5Cu6700%5Cu5c0f%5Cu7684%5Cu82b1%5Cu8d39%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A28%2C%22totalAccepted%22%3A13%2C%22pid%22%3A%22CF73D%22%2C%22title%22%3A%22FreeDiv%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22FreeDiv%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573286098;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>FreeDiv</h1>
<h2>题意翻译</h2>
<div>有n个顶点m条边，每个顶点只能连接1个无需花费的边，无数个代价唯1的边，每个连通分量只能连接k个无需花费的边，无数个代价唯1的边。ps：已给定的边除外
### 输入
nmk
每条边的两个顶点
### 输出
最小的花费</div>
<h2>题目描述</h2>
<div>Vasya plays FreeDiv. In this game he manages a huge state, which has $ n $ cities and $ m $ two-way roads between them. Unfortunately, not from every city you can reach any other one moving along these roads. Therefore Vasya decided to divide the state into provinces so that in every province, one could reach from every city all the cities of the province, but there are no roads between provinces.
Unlike other turn-based strategies, in FreeDiv a player has the opportunity to build tunnels between cities. The tunnels are two-way roads along which one can move armies undetected by the enemy. However, no more than one tunnel can be connected to each city. As for Vasya, he wants to build a network of tunnels so that any pair of cities in his state were reachable by some path consisting of roads and a tunnels. But at that no more than $ k $ tunnels are connected to each province (otherwise, the province will be difficult to keep in case other provinces are captured by enemy armies).
Vasya discovered that maybe he will not be able to build such a network for the current condition of the state. Maybe he'll have first to build several roads between cities in different provinces to merge the provinces. Your task is to determine the minimum number of roads Vasya needs to build so that it was possible to build the required network of tunnels in the resulting state.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains three integers $ n $ , $ m $ and $ k $ ( $ 1<=n,k<=10^{6},0<=m<=10^{6} $ ). Each of the next $ m $ lines contains two integers. They are the numbers of cities connected by a corresponding road. No road connects city to itself and there is at most one road between each pair of cities.</div>
<h3>输出格式</h3>
<br />
<div>Print a single number, the minimum number of additional roads.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>3 3 2
1 2
2 3
3 1
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>0</code></pre>
<h3>输入样例 #2</h3>
<pre><code>4 2 2
1 2
3 4
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>0</code></pre>
<h3>输入样例 #3</h3>
<pre><code>4 0 2
</code></pre>
<h3>输出样例 #3</h3>
<pre><code>1</code></pre>
<h2>说明</h2>
<div>In the first example only one province exists, so it is not necessary to build any tunnels or roads.
In the second example two provinces exist. It is possible to merge the provinces by building a tunnel between cities 1 and 3.
In the third example at least one additional road is necessary. For example it is possible to build additional road between cities 1 and 2 and build two tunnels between cities 1 and 3, 2 and 4 after that.</div>
</article>
</div>
</div>
</body>
</html>
