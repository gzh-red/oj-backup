<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>The Neutral Zone - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573400523:193ap+nAmQs+AiBaJ0PP13GZY/J4a5z4b8Dbk5YPGsk=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Notice%3A%20unusual%20memory%20limit%21%5Cn%5CnAfter%20the%20war%2C%20destroyed%20cities%20in%20the%20neutral%20zone%20were%20restored.%20And%20children%20went%20back%20to%20school.%5Cn%5CnThe%20war%20changed%20the%20world%2C%20as%20well%20as%20education.%20In%20those%20hard%20days%2C%20a%20new%20math%20concept%20was%20created.%5Cn%5CnAs%20we%20all%20know%2C%20logarithm%20function%20can%20be%20described%20as%3A%20%24%20%24%24%24%20%5C%5Clog%28p_1%5E%7Ba_1%7Dp_2%5E%7Ba_2%7D...p_k%5E%7Ba_2%7D%29%20%3D%20a_1%20%5C%5Clog%20p_1%20%2B%20a_2%20%5C%5Clog%20p_2%20%2B%20...%20%2B%20a_k%20%5C%5Clog%20p_k%20%20%24%20%24%20%20Where%20%20%24%20p%5C%5C_1%5E%7Ba%5C%5C_1%7Dp%5C%5C_2%5E%7Ba%5C%5C_2%7D...p%5C%5C_k%5E%7Ba%5C%5C_2%7D%20%24%20%20is%20the%20prime%20factorization%20of%20a%20integer.%20A%20problem%20is%20that%20the%20function%20uses%20itself%20in%20the%20definition.%20That%20is%20why%20it%20is%20hard%20to%20calculate.%3C%5C%2Fp%3E%3Cp%3ESo%2C%20the%20mathematicians%20from%20the%20neutral%20zone%20invented%20this%3A%20%20%24%20%24%20%20%5C%5Ctext%7Bexlog%7D_f%28p_1%5E%7Ba_1%7Dp_2%5E%7Ba_2%7D...p_k%5E%7Ba_2%7D%29%20%3D%20a_1%20f%28p_1%29%20%2B%20a_2%20f%28p_2%29%20%2B%20...%20%2B%20a_k%20f%28p_k%29%20%20%24%20%24%20%3C%5C%2Fp%3E%3Cp%3ENotice%20that%20%20%24%20%5C%5C%5C%5Ctext%7Bexlog%7D%5C%5C_f%281%29%20%24%20%20is%20always%20equal%20to%20%20%24%200%20%24%20.%3C%5C%2Fp%3E%3Cp%3EThis%20concept%20for%20any%20function%20%20%24%20f%20%24%20%20was%20too%20hard%20for%20children.%20So%20teachers%20told%20them%20that%20%20%24%20f%20%24%20%20can%20only%20be%20a%20polynomial%20of%20degree%20no%20more%20than%20%20%24%203%20%24%20%20in%20daily%20uses%20%28i.e.%2C%20%20%24%20f%28x%29%20%3D%20Ax%5E3%2BBx%5E2%2BCx%2BD%20%24%20%29.%3C%5C%2Fp%3E%3Cp%3E%5C%22Class%20is%20over%21%20Don%27t%20forget%20to%20do%20your%20homework%21%5C%22%20Here%20it%20is%3A%20%20%24%20%24%20%20%5C%5Csum_%7Bi%3D1%7D%5En%20%5C%5Ctext%7Bexlog%7D_f%28i%29%20%20%24%20%24%20%3C%5C%2Fp%3E%3Cp%3EHelp%20children%20to%20do%20their%20homework.%20Since%20the%20value%20can%20be%20very%20big%2C%20you%20need%20to%20find%20the%20answer%20modulo%20%20%24%202%5E%7B32%7D%24%24%24.%22%2C%22inputFormat%22%3A%22The%20only%20line%20contains%20five%20integers%20%24%20n%20%24%20%2C%20%24%20A%20%24%20%2C%20%24%20B%20%24%20%2C%20%24%20C%20%24%20%2C%20and%20%24%20D%20%24%20%28%20%24%201%20%5C%5Cle%20n%20%5C%5Cle%203%20%5C%5Ccdot%2010%5E8%20%24%20%2C%20%24%200%20%5C%5Cle%20A%2CB%2CC%2CD%20%5C%5Cle%2010%5E6%20%24%20%29.%22%2C%22outputFormat%22%3A%22Print%20the%20answer%20modulo%20%24%202%5E%7B32%7D%20%24%20.%22%2C%22samples%22%3A%5B%5B%2212%200%200%201%200%5Cn%22%2C%2263%5Cn%22%5D%2C%5B%224%201%202%203%204%5Cn%22%2C%22136%5Cn%22%5D%5D%2C%22hint%22%3A%22In%20the%20first%20sample%3A%5Cn%5Cn%20%24%20%5C%5Ctext%7Bexlog%7D_f%281%29%20%3D%200%20%24%5Cn%5Cn%20%24%20%5C%5Ctext%7Bexlog%7D_f%282%29%20%3D%202%20%24%5Cn%5Cn%20%24%20%5C%5Ctext%7Bexlog%7D_f%283%29%20%3D%203%20%24%5Cn%5Cn%20%24%20%5C%5Ctext%7Bexlog%7D_f%284%29%20%3D%202%20%2B%202%20%3D%204%20%24%5Cn%5Cn%20%24%20%5C%5Ctext%7Bexlog%7D_f%285%29%20%3D%205%20%24%5Cn%5Cn%20%24%20%5C%5Ctext%7Bexlog%7D_f%286%29%20%3D%202%20%2B%203%20%3D%205%20%24%5Cn%5Cn%20%24%20%5C%5Ctext%7Bexlog%7D_f%287%29%20%3D%207%20%24%5Cn%5Cn%20%24%20%5C%5Ctext%7Bexlog%7D_f%288%29%20%3D%202%20%2B%202%20%2B%202%20%3D%206%20%24%5Cn%5Cn%20%24%20%5C%5Ctext%7Bexlog%7D_f%289%29%20%3D%203%20%2B%203%20%3D%206%20%24%5Cn%5Cn%20%24%20%5C%5Ctext%7Bexlog%7D_f%2810%29%20%3D%202%20%2B%205%20%3D%207%20%24%5Cn%5Cn%20%24%20%5C%5Ctext%7Bexlog%7D_f%2811%29%20%3D%2011%20%24%5Cn%5Cn%20%24%20%5C%5Ctext%7Bexlog%7D_f%2812%29%20%3D%202%20%2B%202%20%2B%203%20%3D%207%20%24%5Cn%5Cn%20%24%20%20%5C%5Csum_%7Bi%3D1%7D%5E%7B12%7D%20%5C%5Ctext%7Bexlog%7D_f%28i%29%3D63%20%20%24%5Cn%5CnIn%20the%20second%20sample%3A%5Cn%5Cn%20%24%20%5C%5Ctext%7Bexlog%7D_f%281%29%20%3D%200%20%24%5Cn%5Cn%20%24%20%5C%5Ctext%7Bexlog%7D_f%282%29%20%3D%20%281%20%5C%5Ctimes%202%5E3%20%2B%202%20%5C%5Ctimes%202%5E2%20%2B%203%20%5C%5Ctimes%202%20%2B%204%29%20%3D%2026%20%24%5Cn%5Cn%20%24%20%5C%5Ctext%7Bexlog%7D_f%283%29%20%3D%20%281%20%5C%5Ctimes%203%5E3%20%2B%202%20%5C%5Ctimes%203%5E2%20%2B%203%20%5C%5Ctimes%203%20%2B%204%29%20%3D%2058%20%24%5Cn%5Cn%20%24%20%5C%5Ctext%7Bexlog%7D_f%284%29%20%3D%202%20%5C%5Ctimes%20%5C%5Ctext%7Bexlog%7D_f%282%29%20%3D%2052%20%24%5Cn%5Cn%20%24%20%20%5C%5Csum_%7Bi%3D1%7D%5E4%20%5C%5Ctext%7Bexlog%7D_f%28i%29%3D0%2B26%2B58%2B52%3D136%20%20%24%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B5000%5D%2C%22memory%22%3A%5B16000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F1017%5C%2FF%22%2C%22id%22%3A%221017F%22%7D%2C%22translation%22%3A%22%5Cu5b9a%5Cu4e49%20%24%5C%5Ctext%7Bexlog%7D%20_%20f%28p%20_%201%5E%7Ba%20_%201%7Dp%20_%202%5E%7Ba%20_%202%7D...p%20_%20k%5E%7Ba%20_%202%7D%29%20%3D%20a%20_%201%20f%28p%20_%201%29%20%2B%20a%20_%202%20f%28p%20_%202%29%20%2B%20...%20%2B%20a%20_%20k%20f%28p%20_%20k%29%24%5Cuff0c%5Cu5176%5Cu4e2d%20%24f%28x%29%3DAx%5E3%2BBx%5E2%2BCx%2BD%24%20%5Cuff0c%5Cu6c42%20%24%5C%5Csum%20_%20%7Bi%3D1%7D%20%5E%20n%20%5C%5Ctext%7Bexlog%7D%20_%20f%28i%29%24%5Cr%5Cn%5Cr%5Cn%241%20%5C%5Cle%20n%20%5C%5Cle%203%20%5C%5Ctimes%2010%20%5E%208%2C0%20%5C%5Cle%20A%2CB%2CC%2CD%20%5C%5Cle%2010%20%5E%206%24%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A19%2C%22totalAccepted%22%3A11%2C%22pid%22%3A%22CF1017F%22%2C%22title%22%3A%22The%20Neutral%20Zone%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A65680%2C%22title%22%3A%22%5Cu9898%5Cu610f%22%2C%22forum%22%3A%7B%22id%22%3A28259%2C%22name%22%3A%22CF1017F%20The%20Neutral%20Zone%22%2C%22slug%22%3A%22CF1017F%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22The%20Neutral%20Zone%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>The Neutral Zone</h1>
<h2>题意翻译</h2>
<div>定义 $\text{exlog} _ f(p _ 1^{a _ 1}p _ 2^{a _ 2}...p _ k^{a _ 2}) = a _ 1 f(p _ 1) + a _ 2 f(p _ 2) + ... + a _ k f(p _ k)$，其中 $f(x)=Ax^3+Bx^2+Cx+D$ ，求 $\sum _ {i=1} ^ n \text{exlog} _ f(i)$
$1 \le n \le 3 \times 10 ^ 8,0 \le A,B,C,D \le 10 ^ 6$</div>
<h2>题目描述</h2>
<div>Notice: unusual memory limit!
After the war, destroyed cities in the neutral zone were restored. And children went back to school.
The war changed the world, as well as education. In those hard days, a new math concept was created.
As we all know, logarithm function can be described as: $ $$$ \log(p_1^{a_1}p_2^{a_2}...p_k^{a_2}) = a_1 \log p_1 + a_2 \log p_2 + ... + a_k \log p_k $ $ Where $ p\_1^{a\_1}p\_2^{a\_2}...p\_k^{a\_2} $ is the prime factorization of a integer. A problem is that the function uses itself in the definition. That is why it is hard to calculate.</p><p>So, the mathematicians from the neutral zone invented this: $ $ \text{exlog}_f(p_1^{a_1}p_2^{a_2}...p_k^{a_2}) = a_1 f(p_1) + a_2 f(p_2) + ... + a_k f(p_k) $ $ </p><p>Notice that $ \\text{exlog}\_f(1) $ is always equal to $ 0 $ .</p><p>This concept for any function $ f $ was too hard for children. So teachers told them that $ f $ can only be a polynomial of degree no more than $ 3 $ in daily uses (i.e., $ f(x) = Ax^3+Bx^2+Cx+D $ ).</p><p>"Class is over! Don't forget to do your homework!" Here it is: $ $ \sum_{i=1}^n \text{exlog}_f(i) $ $ </p><p>Help children to do their homework. Since the value can be very big, you need to find the answer modulo $ 2^{32}$$$.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The only line contains five integers $ n $ , $ A $ , $ B $ , $ C $ , and $ D $ ( $ 1 \le n \le 3 \cdot 10^8 $ , $ 0 \le A,B,C,D \le 10^6 $ ).</div>
<h3>输出格式</h3>
<br />
<div>Print the answer modulo $ 2^{32} $ .</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>12 0 0 1 0
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>63
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>4 1 2 3 4
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>136
</code></pre>
<h2>说明</h2>
<div>In the first sample:
$ \text{exlog}_f(1) = 0 $
$ \text{exlog}_f(2) = 2 $
$ \text{exlog}_f(3) = 3 $
$ \text{exlog}_f(4) = 2 + 2 = 4 $
$ \text{exlog}_f(5) = 5 $
$ \text{exlog}_f(6) = 2 + 3 = 5 $
$ \text{exlog}_f(7) = 7 $
$ \text{exlog}_f(8) = 2 + 2 + 2 = 6 $
$ \text{exlog}_f(9) = 3 + 3 = 6 $
$ \text{exlog}_f(10) = 2 + 5 = 7 $
$ \text{exlog}_f(11) = 11 $
$ \text{exlog}_f(12) = 2 + 2 + 3 = 7 $
$ \sum_{i=1}^{12} \text{exlog}_f(i)=63 $
In the second sample:
$ \text{exlog}_f(1) = 0 $
$ \text{exlog}_f(2) = (1 \times 2^3 + 2 \times 2^2 + 3 \times 2 + 4) = 26 $
$ \text{exlog}_f(3) = (1 \times 3^3 + 2 \times 3^2 + 3 \times 3 + 4) = 58 $
$ \text{exlog}_f(4) = 2 \times \text{exlog}_f(2) = 52 $
$ \sum_{i=1}^4 \text{exlog}_f(i)=0+26+58+52=136 $</div>
</article>
</div>
</div>
</body>
</html>
