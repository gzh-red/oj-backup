<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Teams Formation - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573398939:wKetlsIKe0J977Pw1t/QEDhz3bETZKpuCE4IPCDcEaY=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%22%2C%22description%22%3A%22This%20time%20the%20Berland%20Team%20Olympiad%20in%20Informatics%20is%20held%20in%20a%20remote%20city%20that%20can%20only%20be%20reached%20by%20one%20small%20bus.%20Bus%20has%20%24%20n%20%24%20passenger%20seats%2C%20seat%20%24%20i%20%24%20can%20be%20occupied%20only%20by%20a%20participant%20from%20the%20city%20%24%20a_%7Bi%7D%20%24%20.%5Cn%5CnToday%20the%20bus%20has%20completed%20%24%20m%20%24%20trips%2C%20each%20time%20bringing%20%24%20n%20%24%20participants.%20The%20participants%20were%20then%20aligned%20in%20one%20line%20in%20the%20order%20they%20arrived%2C%20with%20people%20from%20the%20same%20bus%20standing%20in%20the%20order%20of%20their%20seats%20%28i.%20e.%20if%20we%20write%20down%20the%20cities%20where%20the%20participants%20came%20from%2C%20we%20get%20the%20sequence%20%24%20a_%7B1%7D%2Ca_%7B2%7D%2C...%2Ca_%7Bn%7D%20%24%20repeated%20%24%20m%20%24%20times%29.%5Cn%5CnAfter%20that%20some%20teams%20were%20formed%2C%20each%20consisting%20of%20%24%20k%20%24%20participants%20form%20the%20same%20city%20standing%20next%20to%20each%20other%20in%20the%20line.%20Once%20formed%2C%20teams%20left%20the%20line.%20The%20teams%20were%20formed%20until%20there%20were%20no%20%24%20k%20%24%20neighboring%20participants%20from%20the%20same%20city.%5Cn%5CnHelp%20the%20organizers%20determine%20how%20many%20participants%20have%20left%20in%20the%20line%20after%20that%20process%20ended.%20We%20can%20prove%20that%20answer%20doesn%27t%20depend%20on%20the%20order%20in%20which%20teams%20were%20selected.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20three%20integers%20%24%20n%2Ck%20%24%20and%20%24%20m%20%24%20%28%20%24%201%3C%3Dn%3C%3D10%5E%7B5%7D%20%24%20%2C%20%24%202%3C%3Dk%3C%3D10%5E%7B9%7D%20%24%20%2C%20%24%201%3C%3Dm%3C%3D10%5E%7B9%7D%20%24%20%29.%5Cn%5CnThe%20second%20line%20contains%20%24%20n%20%24%20integers%20%24%20a_%7B1%7D%2Ca_%7B2%7D%2C...%2Ca_%7Bn%7D%20%24%20%28%20%24%201%3C%3Da_%7Bi%7D%3C%3D10%5E%7B5%7D%20%24%20%29%2C%20where%20%24%20a_%7Bi%7D%20%24%20is%20the%20number%20of%20city%2C%20person%20from%20which%20must%20take%20seat%20%24%20i%20%24%20in%20the%20bus.%22%2C%22outputFormat%22%3A%22Output%20the%20number%20of%20remaining%20participants%20in%20the%20line.%22%2C%22samples%22%3A%5B%5B%224%202%205%5Cn1%202%203%201%5Cn%22%2C%2212%5Cn%22%5D%2C%5B%221%209%2010%5Cn1%5Cn%22%2C%221%5Cn%22%5D%2C%5B%223%202%2010%5Cn1%202%201%5Cn%22%2C%220%5Cn%22%5D%5D%2C%22hint%22%3A%22In%20the%20second%20example%2C%20the%20line%20consists%20of%20ten%20participants%20from%20the%20same%20city.%20Nine%20of%20them%20will%20form%20a%20team.%20At%20the%20end%2C%20only%20one%20participant%20will%20stay%20in%20the%20line.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F878%5C%2FB%22%2C%22id%22%3A%22878B%22%7D%2C%22translation%22%3A%22%2A%2ACF878B%20Teams%20Formation%2A%2A%20%20%5Cn%2A%2A%5Cu9898%5Cu76ee%3A%2A%2A%20%20%5Cn%20%20%20%20%5Cu957f%5Cu5ea6%5Cu4e3a%20%24n%24%20%20%5Cu7684%5Cu6570%5Cu5217%20%24a_i%24%20%2C%20%5Cu91cd%5Cu590d%20%24m%24%20%20%5Cu6b21%5Cu5f62%5Cu6210%5Cu4e00%5Cu4e2a%5Cu5e8f%5Cu5217%2C%5Cu6bcf%5Cu6b21%5Cu52a8%5Cu6001%5Cu6d88%5Cu53bb%20%24k%24%20%20%5Cu4e2a%5Cu76f8%5Cu540c%5Cu7684%5Cu6570%2C%5Cu76f4%5Cu5230%5Cu4e0d%5Cu80fd%5Cu6d88%5Cu53bb%5Cu4e3a%5Cu6b62%2C%5Cu6c42%5Cu6700%5Cu540e%5Cu5269%5Cu4f59%5Cu591a%5Cu5c11%5Cu4e2a%5Cu6570.%20%20%5Cn%2A%2A%5Cu8f93%5Cu5165%3A%2A%2A%20%20%20%5Cn%20%20%20%20%5Cu7b2c%5Cu4e00%5Cu884c%5Cu4e09%5Cu4e2a%5Cu6574%5Cu6570%20%24n%2Ck%2Cm%281%3C%3Dn%3C%3D10%5E%7B5%7D%2C2%3C%3Dk%3C%3D10%5E%7B9%7D%2C1%3C%3Dm%3C%3D10%5E%7B9%7D%29%24%20.%20%20%5Cn%20%20%20%20%5Cu7b2c%5Cu4e8c%5Cu884c%20%24n%24%20%20%5Cu4e2a%5Cu6574%5Cu6570%20%24a_i%281%3C%3Da_i%3C%3D10%5E%7B5%7D%29%24%20.%20%20%5Cn%2A%2A%5Cu8f93%5Cu51fa%3A%2A%2A%20%20%5Cu5269%5Cu4f59%5Cu6570%5Cu5217%5Cu7684%5Cu957f%5Cu5ea6.%20%20%5Cn%5CnBy%20%40%5Cu51cc%5Cu5e7d%20%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A12%2C%22totalAccepted%22%3A5%2C%22pid%22%3A%22CF878B%22%2C%22title%22%3A%22Teams%20Formation%22%2C%22difficulty%22%3A3%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A34982%2C%22title%22%3A%22%5Cu9898%5Cu76ee%5Cu5927%5Cu610f%22%2C%22forum%22%3A%7B%22id%22%3A9061%2C%22name%22%3A%22CF878B%20Teams%20Formation%22%2C%22slug%22%3A%22CF878B%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Teams%20Formation%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Teams Formation</h1>
<h2>题意翻译</h2>
<div>**CF878B Teams Formation**
**题目:**
长度为 $n$ 的数列 $a_i$ , 重复 $m$ 次形成一个序列,每次动态消去 $k$ 个相同的数,直到不能消去为止,求最后剩余多少个数.
**输入:**
第一行三个整数 $n,k,m(1<=n<=10^{5},2<=k<=10^{9},1<=m<=10^{9})$ .
第二行 $n$ 个整数 $a_i(1<=a_i<=10^{5})$ .
**输出:** 剩余数列的长度.
By @凌幽 </div>
<h2>题目描述</h2>
<div>This time the Berland Team Olympiad in Informatics is held in a remote city that can only be reached by one small bus. Bus has $ n $ passenger seats, seat $ i $ can be occupied only by a participant from the city $ a_{i} $ .
Today the bus has completed $ m $ trips, each time bringing $ n $ participants. The participants were then aligned in one line in the order they arrived, with people from the same bus standing in the order of their seats (i. e. if we write down the cities where the participants came from, we get the sequence $ a_{1},a_{2},...,a_{n} $ repeated $ m $ times).
After that some teams were formed, each consisting of $ k $ participants form the same city standing next to each other in the line. Once formed, teams left the line. The teams were formed until there were no $ k $ neighboring participants from the same city.
Help the organizers determine how many participants have left in the line after that process ended. We can prove that answer doesn't depend on the order in which teams were selected.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains three integers $ n,k $ and $ m $ ( $ 1<=n<=10^{5} $ , $ 2<=k<=10^{9} $ , $ 1<=m<=10^{9} $ ).
The second line contains $ n $ integers $ a_{1},a_{2},...,a_{n} $ ( $ 1<=a_{i}<=10^{5} $ ), where $ a_{i} $ is the number of city, person from which must take seat $ i $ in the bus.</div>
<h3>输出格式</h3>
<br />
<div>Output the number of remaining participants in the line.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>4 2 5
1 2 3 1
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>12
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>1 9 10
1
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>1
</code></pre>
<h3>输入样例 #3</h3>
<pre><code>3 2 10
1 2 1
</code></pre>
<h3>输出样例 #3</h3>
<pre><code>0
</code></pre>
<h2>说明</h2>
<div>In the second example, the line consists of ten participants from the same city. Nine of them will form a team. At the end, only one participant will stay in the line.</div>
</article>
</div>
</div>
</body>
</html>
