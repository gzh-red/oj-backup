<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Opening Portals - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573391633:/BT8FIOngOGgWErai8iitorZhZbQYtgncQzyTmXG3RE=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Pavel%20plays%20a%20famous%20computer%20game.%20A%20player%20is%20responsible%20for%20a%20whole%20country%20and%20he%20can%20travel%20there%20freely%2C%20complete%20quests%20and%20earn%20experience.%5Cn%5CnThis%20country%20has%20%24%20n%20%24%20cities%20connected%20by%20%24%20m%20%24%20bidirectional%20roads%20of%20different%20lengths%20so%20that%20it%20is%20possible%20to%20get%20from%20any%20city%20to%20any%20other%20one.%20There%20are%20portals%20in%20%24%20k%20%24%20of%20these%20cities.%20At%20the%20beginning%20of%20the%20game%20all%20portals%20are%20closed.%20When%20a%20player%20visits%20a%20portal%20city%2C%20the%20portal%20opens.%20Strange%20as%20it%20is%2C%20one%20can%20teleport%20from%20an%20open%20portal%20to%20an%20open%20one.%20The%20teleportation%20takes%20no%20time%20and%20that%20enables%20the%20player%20to%20travel%20quickly%20between%20rather%20remote%20regions%20of%20the%20country.%5Cn%5CnAt%20the%20beginning%20of%20the%20game%20Pavel%20is%20in%20city%20number%20%24%201%20%24%20.%20He%20wants%20to%20open%20all%20portals%20as%20quickly%20as%20possible.%20How%20much%20time%20will%20he%20need%20for%20that%3F%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20two%20space-separated%20integers%20%24%20n%20%24%20and%20%24%20m%20%24%20%28%20%24%201%3C%3Dn%3C%3D10%5E%7B5%7D%20%24%20%2C%20%24%200%3C%3Dm%3C%3D10%5E%7B5%7D%20%24%20%29%20that%20show%20how%20many%20cities%20and%20roads%20are%20in%20the%20game.%5Cn%5CnEach%20of%20the%20next%20%24%20m%20%24%20lines%20contains%20the%20description%20of%20a%20road%20as%20three%20space-separated%20integers%20%24%20x_%7Bi%7D%20%24%20%2C%20%24%20y_%7Bi%7D%20%24%20%2C%20%24%20w_%7Bi%7D%20%24%20%28%20%24%201%3C%3Dx_%7Bi%7D%2Cy_%7Bi%7D%3C%3Dn%20%24%20%2C%20%24%20x_%7Bi%7D%5Cu2260y_%7Bi%7D%20%24%20%2C%20%24%201%3C%3Dw_%7Bi%7D%3C%3D10%5E%7B9%7D%20%24%20%29%20%5Cu2014%20the%20numbers%20of%20the%20cities%20connected%20by%20the%20%24%20i%20%24%20-th%20road%20and%20the%20time%20needed%20to%20go%20from%20one%20city%20to%20the%20other%20one%20by%20this%20road.%20Any%20two%20cities%20are%20connected%20by%20no%20more%20than%20one%20road.%20It%20is%20guaranteed%20that%20we%20can%20get%20from%20any%20city%20to%20any%20other%20one%2C%20moving%20along%20the%20roads%20of%20the%20country.%5Cn%5CnThe%20next%20line%20contains%20integer%20%24%20k%20%24%20%28%20%24%201%3C%3Dk%3C%3Dn%20%24%20%29%20%5Cu2014%20the%20number%20of%20portals.%5Cn%5CnThe%20next%20line%20contains%20%24%20k%20%24%20space-separated%20integers%20%24%20p_%7B1%7D%20%24%20%2C%20%24%20p_%7B2%7D%20%24%20%2C%20...%2C%20%24%20p_%7Bk%7D%20%24%20%5Cu2014%20numbers%20of%20the%20cities%20with%20installed%20portals.%20Each%20city%20has%20no%20more%20than%20one%20portal.%22%2C%22outputFormat%22%3A%22Print%20a%20single%20number%20%5Cu2014%20the%20minimum%20time%20a%20player%20needs%20to%20open%20all%20portals.%5Cn%5CnPlease%2C%20do%20not%20use%20the%20%25lld%20specifier%20to%20read%20or%20write%2064-bit%20integers%20in%20C%2B%2B.%20It%20is%20preferred%20to%20use%20the%20cin%2C%20cout%20streams%20or%20the%20%25I64d%20specifier.%22%2C%22samples%22%3A%5B%5B%223%203%5Cn1%202%201%5Cn1%203%201%5Cn2%203%201%5Cn3%5Cn1%202%203%5Cn%22%2C%222%5Cn%22%5D%2C%5B%224%203%5Cn1%202%201%5Cn2%203%205%5Cn2%204%2010%5Cn3%5Cn2%203%204%5Cn%22%2C%2216%5Cn%22%5D%2C%5B%224%203%5Cn1%202%201000000000%5Cn2%203%201000000000%5Cn3%204%201000000000%5Cn4%5Cn1%202%203%204%5Cn%22%2C%223000000000%5Cn%22%5D%5D%2C%22hint%22%3A%22In%20the%20second%20sample%20the%20player%20has%20to%20come%20to%20city%20%24%202%20%24%20%2C%20open%20a%20portal%20there%2C%20then%20go%20to%20city%20%24%203%20%24%20%2C%20open%20a%20portal%20there%2C%20teleport%20back%20to%20city%20%24%202%20%24%20and%20finally%20finish%20the%20journey%20in%20city%20%24%204%20%24%20.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F196%5C%2FE%22%2C%22id%22%3A%22196E%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A4%2C%22totalAccepted%22%3A1%2C%22pid%22%3A%22CF196E%22%2C%22title%22%3A%22Opening%20Portals%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Opening%20Portals%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Opening Portals</h1>
<h2>题目描述</h2>
<div>Pavel plays a famous computer game. A player is responsible for a whole country and he can travel there freely, complete quests and earn experience.
This country has $ n $ cities connected by $ m $ bidirectional roads of different lengths so that it is possible to get from any city to any other one. There are portals in $ k $ of these cities. At the beginning of the game all portals are closed. When a player visits a portal city, the portal opens. Strange as it is, one can teleport from an open portal to an open one. The teleportation takes no time and that enables the player to travel quickly between rather remote regions of the country.
At the beginning of the game Pavel is in city number $ 1 $ . He wants to open all portals as quickly as possible. How much time will he need for that?</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains two space-separated integers $ n $ and $ m $ ( $ 1<=n<=10^{5} $ , $ 0<=m<=10^{5} $ ) that show how many cities and roads are in the game.
Each of the next $ m $ lines contains the description of a road as three space-separated integers $ x_{i} $ , $ y_{i} $ , $ w_{i} $ ( $ 1<=x_{i},y_{i}<=n $ , $ x_{i}≠y_{i} $ , $ 1<=w_{i}<=10^{9} $ ) — the numbers of the cities connected by the $ i $ -th road and the time needed to go from one city to the other one by this road. Any two cities are connected by no more than one road. It is guaranteed that we can get from any city to any other one, moving along the roads of the country.
The next line contains integer $ k $ ( $ 1<=k<=n $ ) — the number of portals.
The next line contains $ k $ space-separated integers $ p_{1} $ , $ p_{2} $ , ..., $ p_{k} $ — numbers of the cities with installed portals. Each city has no more than one portal.</div>
<h3>输出格式</h3>
<br />
<div>Print a single number — the minimum time a player needs to open all portals.
Please, do not use the %lld specifier to read or write 64-bit integers in C++. It is preferred to use the cin, cout streams or the %I64d specifier.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>3 3
1 2 1
1 3 1
2 3 1
3
1 2 3
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>2
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>4 3
1 2 1
2 3 5
2 4 10
3
2 3 4
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>16
</code></pre>
<h3>输入样例 #3</h3>
<pre><code>4 3
1 2 1000000000
2 3 1000000000
3 4 1000000000
4
1 2 3 4
</code></pre>
<h3>输出样例 #3</h3>
<pre><code>3000000000
</code></pre>
<h2>说明</h2>
<div>In the second sample the player has to come to city $ 2 $ , open a portal there, then go to city $ 3 $ , open a portal there, teleport back to city $ 2 $ and finally finish the journey in city $ 4 $ .</div>
</article>
</div>
</div>
</body>
</html>
