<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Epidemic in Monstropolis - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573397227:Xkn54RXC5Ibrm3V4lcFnkbxWIlpZv3JVEfjGMgJkuu0=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22There%20was%20an%20epidemic%20in%20Monstropolis%20and%20all%20monsters%20became%20sick.%20To%20recover%2C%20all%20monsters%20lined%20up%20in%20queue%20for%20an%20appointment%20to%20the%20only%20doctor%20in%20the%20city.%5Cn%5CnSoon%2C%20monsters%20became%20hungry%20and%20began%20to%20eat%20each%20other.%5Cn%5CnOne%20monster%20can%20eat%20other%20monster%20if%20its%20weight%20is%20strictly%20greater%20than%20the%20weight%20of%20the%20monster%20being%20eaten%2C%20and%20they%20stand%20in%20the%20queue%20next%20to%20each%20other.%20Monsters%20eat%20each%20other%20instantly.%20There%20are%20no%20monsters%20which%20are%20being%20eaten%20at%20the%20same%20moment.%20After%20the%20monster%20%24%20A%20%24%20eats%20the%20monster%20%24%20B%20%24%20%2C%20the%20weight%20of%20the%20monster%20%24%20A%20%24%20increases%20by%20the%20weight%20of%20the%20eaten%20monster%20%24%20B%20%24%20.%20In%20result%20of%20such%20eating%20the%20length%20of%20the%20queue%20decreases%20by%20one%2C%20all%20monsters%20after%20the%20eaten%20one%20step%20forward%20so%20that%20there%20is%20no%20empty%20places%20in%20the%20queue%20again.%20A%20monster%20can%20eat%20several%20monsters%20one%20after%20another.%20Initially%20there%20were%20%24%20n%20%24%20monsters%20in%20the%20queue%2C%20the%20%24%20i%20%24%20-th%20of%20which%20had%20weight%20%24%20a_%7Bi%7D%20%24%20.%5Cn%5CnFor%20example%2C%20if%20weights%20are%20%24%20%5B1%2C2%2C2%2C2%2C1%2C2%5D%20%24%20%28in%20order%20of%20queue%2C%20monsters%20are%20numbered%20from%20%24%201%20%24%20to%20%24%206%20%24%20from%20left%20to%20right%29%20then%20some%20of%20the%20options%20are%3A%5Cn%5Cn1.%20the%20first%20monster%20can%27t%20eat%20the%20second%20monster%20because%20%24%20a_%7B1%7D%3D1%20%24%20is%20not%20greater%20than%20%24%20a_%7B2%7D%3D2%20%24%20%3B%5Cn2.%20the%20second%20monster%20can%27t%20eat%20the%20third%20monster%20because%20%24%20a_%7B2%7D%3D2%20%24%20is%20not%20greater%20than%20%24%20a_%7B3%7D%3D2%20%24%20%3B%5Cn3.%20the%20second%20monster%20can%27t%20eat%20the%20fifth%20monster%20because%20they%20are%20not%20neighbors%3B%5Cn4.%20the%20second%20monster%20can%20eat%20the%20first%20monster%2C%20the%20queue%20will%20be%20transformed%20to%20%24%20%5B3%2C2%2C2%2C1%2C2%5D%20%24%20.%5Cn%5CnAfter%20some%20time%2C%20someone%20said%20a%20good%20joke%20and%20all%20monsters%20recovered.%20At%20that%20moment%20there%20were%20%24%20k%20%24%20%28%20%24%20k%3C%3Dn%20%24%20%29%20monsters%20in%20the%20queue%2C%20the%20%24%20j%20%24%20-th%20of%20which%20had%20weight%20%24%20b_%7Bj%7D%20%24%20.%20Both%20sequences%20%28%20%24%20a%20%24%20and%20%24%20b%20%24%20%29%20contain%20the%20weights%20of%20the%20monsters%20in%20the%20order%20from%20the%20first%20to%20the%20last.%5Cn%5CnYou%20are%20required%20to%20provide%20one%20of%20the%20possible%20orders%20of%20eating%20monsters%20which%20led%20to%20the%20current%20queue%2C%20or%20to%20determine%20that%20this%20could%20not%20happen.%20Assume%20that%20the%20doctor%20didn%27t%20make%20any%20appointments%20while%20monsters%20were%20eating%20each%20other.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20single%20integer%20%24%20n%20%24%20%28%20%24%201%3C%3Dn%3C%3D500%20%24%20%29%20%5Cu2014%20the%20number%20of%20monsters%20in%20the%20initial%20queue.%5Cn%5CnThe%20second%20line%20contains%20%24%20n%20%24%20integers%20%24%20a_%7B1%7D%2Ca_%7B2%7D%2C...%2Ca_%7Bn%7D%20%24%20%28%20%24%201%3C%3Da_%7Bi%7D%3C%3D10%5E%7B6%7D%20%24%20%29%20%5Cu2014%20the%20initial%20weights%20of%20the%20monsters.%5Cn%5CnThe%20third%20line%20contains%20single%20integer%20%24%20k%20%24%20%28%20%24%201%3C%3Dk%3C%3Dn%20%24%20%29%20%5Cu2014%20the%20number%20of%20monsters%20in%20the%20queue%20after%20the%20joke.%5Cn%5CnThe%20fourth%20line%20contains%20%24%20k%20%24%20integers%20%24%20b_%7B1%7D%2Cb_%7B2%7D%2C...%2Cb_%7Bk%7D%20%24%20%28%20%24%201%3C%3Db_%7Bj%7D%3C%3D5%5Cu00b710%5E%7B8%7D%20%24%20%29%20%5Cu2014%20the%20weights%20of%20the%20monsters%20after%20the%20joke.%5Cn%5CnMonsters%20are%20listed%20in%20the%20order%20from%20the%20beginning%20of%20the%20queue%20to%20the%20end.%22%2C%22outputFormat%22%3A%22In%20case%20if%20no%20actions%20could%20lead%20to%20the%20final%20queue%2C%20print%20%5C%22NO%5C%22%20%28without%20quotes%29%20in%20the%20only%20line.%5Cn%5CnOtherwise%20print%20%5C%22YES%5C%22%20%28without%20quotes%29%20in%20the%20first%20line.%20In%20the%20next%20%24%20n-k%20%24%20lines%20print%20actions%20in%20the%20chronological%20order.%20In%20each%20line%20print%20%24%20x%20%24%20%5Cu2014%20the%20index%20number%20of%20the%20monster%20in%20the%20current%20queue%20which%20eats%20and%2C%20separated%20by%20space%2C%20the%20symbol%20%27L%27%20if%20the%20monster%20which%20stays%20the%20%24%20x%20%24%20-th%20in%20the%20queue%20eats%20the%20monster%20in%20front%20of%20him%2C%20or%20%27R%27%20if%20the%20monster%20which%20stays%20the%20%24%20x%20%24%20-th%20in%20the%20queue%20eats%20the%20monster%20behind%20him.%20After%20each%20eating%20the%20queue%20is%20enumerated%20again.%5Cn%5CnWhen%20one%20monster%20eats%20another%20the%20queue%20decreases.%20If%20there%20are%20several%20answers%2C%20print%20any%20of%20them.%22%2C%22samples%22%3A%5B%5B%226%5Cn1%202%202%202%201%202%5Cn2%5Cn5%205%5Cn%22%2C%22YES%5Cn2%20L%5Cn1%20R%5Cn4%20L%5Cn3%20L%5Cn%22%5D%2C%5B%225%5Cn1%202%203%204%205%5Cn1%5Cn15%5Cn%22%2C%22YES%5Cn5%20L%5Cn4%20L%5Cn3%20L%5Cn2%20L%5Cn%22%5D%2C%5B%225%5Cn1%201%201%203%203%5Cn3%5Cn2%201%206%5Cn%22%2C%22NO%22%5D%5D%2C%22hint%22%3A%22In%20the%20first%20example%2C%20initially%20there%20were%20%24%20n%3D6%20%24%20monsters%2C%20their%20weights%20are%20%24%20%5B1%2C2%2C2%2C2%2C1%2C2%5D%20%24%20%28in%20order%20of%20queue%20from%20the%20first%20monster%20to%20the%20last%20monster%29.%20The%20final%20queue%20should%20be%20%24%20%5B5%2C5%5D%20%24%20.%20The%20following%20sequence%20of%20eatings%20leads%20to%20the%20final%20queue%3A%5Cn%5Cn-%20the%20second%20monster%20eats%20the%20monster%20to%20the%20left%20%28i.e.%20the%20first%20monster%29%2C%20queue%20becomes%20%24%20%5B3%2C2%2C2%2C1%2C2%5D%20%24%20%3B%5Cn-%20the%20first%20monster%20%28note%2C%20it%20was%20the%20second%20on%20the%20previous%20step%29%20eats%20the%20monster%20to%20the%20right%20%28i.e.%20the%20second%20monster%29%2C%20queue%20becomes%20%24%20%5B5%2C2%2C1%2C2%5D%20%24%20%3B%5Cn-%20the%20fourth%20monster%20eats%20the%20mosnter%20to%20the%20left%20%28i.e.%20the%20third%20monster%29%2C%20queue%20becomes%20%24%20%5B5%2C2%2C3%5D%20%24%20%3B%5Cn-%20the%20finally%2C%20the%20third%20monster%20eats%20the%20monster%20to%20the%20left%20%28i.e.%20the%20second%20monster%29%2C%20queue%20becomes%20%24%20%5B5%2C5%5D%20%24%20.%5Cn%5CnNote%20that%20for%20each%20step%20the%20output%20contains%20numbers%20of%20the%20monsters%20in%20their%20current%20order%20in%20the%20queue.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F733%5C%2FC%22%2C%22id%22%3A%22733C%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A5%2C%22totalAccepted%22%3A3%2C%22pid%22%3A%22CF733C%22%2C%22title%22%3A%22Epidemic%20in%20Monstropolis%22%2C%22difficulty%22%3A3%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Epidemic%20in%20Monstropolis%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Epidemic in Monstropolis</h1>
<h2>题目描述</h2>
<div>There was an epidemic in Monstropolis and all monsters became sick. To recover, all monsters lined up in queue for an appointment to the only doctor in the city.
Soon, monsters became hungry and began to eat each other.
One monster can eat other monster if its weight is strictly greater than the weight of the monster being eaten, and they stand in the queue next to each other. Monsters eat each other instantly. There are no monsters which are being eaten at the same moment. After the monster $ A $ eats the monster $ B $ , the weight of the monster $ A $ increases by the weight of the eaten monster $ B $ . In result of such eating the length of the queue decreases by one, all monsters after the eaten one step forward so that there is no empty places in the queue again. A monster can eat several monsters one after another. Initially there were $ n $ monsters in the queue, the $ i $ -th of which had weight $ a_{i} $ .
For example, if weights are $ [1,2,2,2,1,2] $ (in order of queue, monsters are numbered from $ 1 $ to $ 6 $ from left to right) then some of the options are:
1. the first monster can't eat the second monster because $ a_{1}=1 $ is not greater than $ a_{2}=2 $ ;
2. the second monster can't eat the third monster because $ a_{2}=2 $ is not greater than $ a_{3}=2 $ ;
3. the second monster can't eat the fifth monster because they are not neighbors;
4. the second monster can eat the first monster, the queue will be transformed to $ [3,2,2,1,2] $ .
After some time, someone said a good joke and all monsters recovered. At that moment there were $ k $ ( $ k<=n $ ) monsters in the queue, the $ j $ -th of which had weight $ b_{j} $ . Both sequences ( $ a $ and $ b $ ) contain the weights of the monsters in the order from the first to the last.
You are required to provide one of the possible orders of eating monsters which led to the current queue, or to determine that this could not happen. Assume that the doctor didn't make any appointments while monsters were eating each other.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains single integer $ n $ ( $ 1<=n<=500 $ ) — the number of monsters in the initial queue.
The second line contains $ n $ integers $ a_{1},a_{2},...,a_{n} $ ( $ 1<=a_{i}<=10^{6} $ ) — the initial weights of the monsters.
The third line contains single integer $ k $ ( $ 1<=k<=n $ ) — the number of monsters in the queue after the joke.
The fourth line contains $ k $ integers $ b_{1},b_{2},...,b_{k} $ ( $ 1<=b_{j}<=5·10^{8} $ ) — the weights of the monsters after the joke.
Monsters are listed in the order from the beginning of the queue to the end.</div>
<h3>输出格式</h3>
<br />
<div>In case if no actions could lead to the final queue, print "NO" (without quotes) in the only line.
Otherwise print "YES" (without quotes) in the first line. In the next $ n-k $ lines print actions in the chronological order. In each line print $ x $ — the index number of the monster in the current queue which eats and, separated by space, the symbol 'L' if the monster which stays the $ x $ -th in the queue eats the monster in front of him, or 'R' if the monster which stays the $ x $ -th in the queue eats the monster behind him. After each eating the queue is enumerated again.
When one monster eats another the queue decreases. If there are several answers, print any of them.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>6
1 2 2 2 1 2
2
5 5
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>YES
2 L
1 R
4 L
3 L
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>5
1 2 3 4 5
1
15
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>YES
5 L
4 L
3 L
2 L
</code></pre>
<h3>输入样例 #3</h3>
<pre><code>5
1 1 1 3 3
3
2 1 6
</code></pre>
<h3>输出样例 #3</h3>
<pre><code>NO</code></pre>
<h2>说明</h2>
<div>In the first example, initially there were $ n=6 $ monsters, their weights are $ [1,2,2,2,1,2] $ (in order of queue from the first monster to the last monster). The final queue should be $ [5,5] $ . The following sequence of eatings leads to the final queue:
- the second monster eats the monster to the left (i.e. the first monster), queue becomes $ [3,2,2,1,2] $ ;
- the first monster (note, it was the second on the previous step) eats the monster to the right (i.e. the second monster), queue becomes $ [5,2,1,2] $ ;
- the fourth monster eats the mosnter to the left (i.e. the third monster), queue becomes $ [5,2,3] $ ;
- the finally, the third monster eats the monster to the left (i.e. the second monster), queue becomes $ [5,5] $ .
Note that for each step the output contains numbers of the monsters in their current order in the queue.</div>
</article>
</div>
</div>
</body>
</html>
