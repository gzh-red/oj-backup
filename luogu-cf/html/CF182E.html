<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Wooden Fence - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573391525:Q8ZC70PwhE9pj5UiaauXnUQkBGqOmkb4s5qCRzIaN8w=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Vasya%20has%20recently%20bought%20some%20land%20and%20decided%20to%20surround%20it%20with%20a%20wooden%20fence.%5Cn%5CnHe%20went%20to%20a%20company%20called%20%5C%22Wooden%20board%5C%22%20that%20produces%20wooden%20boards%20for%20fences.%20Vasya%20read%20in%20the%20catalog%20of%20products%20that%20the%20company%20has%20at%20its%20disposal%20%24%20n%20%24%20different%20types%20of%20wood.%20The%20company%20uses%20the%20%24%20i%20%24%20-th%20type%20of%20wood%20to%20produce%20a%20board%20of%20this%20type%20that%20is%20a%20rectangular%20%24%20a_%7Bi%7D%20%24%20by%20%24%20b_%7Bi%7D%20%24%20block.%5Cn%5CnVasya%20decided%20to%20order%20boards%20in%20this%20company%20and%20build%20a%20fence%20from%20them.%20It%20turned%20out%20that%20the%20storehouse%20of%20the%20company%20is%20so%20large%20that%20Vasya%20can%20order%20arbitrary%20number%20of%20boards%20of%20every%20type.%20Note%20that%20Vasya%20is%20allowed%20to%20turn%20the%20boards%20as%20he%20builds%20the%20fence.%20However%2C%20Vasya%20cannot%20turn%20square%20boards.%5Cn%5CnVasya%20is%20required%20to%20construct%20a%20fence%20of%20length%20%24%20l%20%24%20%2C%20however%2C%20an%20arbitrary%20fence%20won%27t%20do.%20Vasya%20wants%20his%20fence%20to%20look%20beautiful.%20We%27ll%20say%20that%20a%20fence%20is%20beautiful%20if%20and%20only%20if%20the%20following%20two%20conditions%20are%20fulfilled%3A%5Cn%5Cn-%20there%20are%20no%20two%20successive%20boards%20of%20the%20same%20type%5Cn-%20the%20first%20board%20of%20the%20fence%20has%20an%20arbitrary%20length%2C%20and%20the%20length%20of%20each%20subsequent%20board%20equals%20the%20width%20of%20the%20previous%20one%5Cn%5CnIn%20other%20words%2C%20the%20fence%20is%20considered%20beautiful%2C%20if%20the%20type%20of%20the%20%24%20i%20%24%20-th%20board%20in%20the%20fence%20is%20different%20from%20the%20%24%20i-1%20%24%20-th%20board%27s%20type%3B%20besides%2C%20the%20%24%20i%20%24%20-th%20board%27s%20length%20is%20equal%20to%20the%20%24%20i-1%20%24%20-th%20board%27s%20width%20%28for%20all%20%24%20i%20%24%20%2C%20starting%20from%202%29.%5Cn%5CnNow%20Vasya%20wonders%2C%20how%20many%20variants%20of%20arranging%20a%20fence%20for%20his%20land%20exist.%20Your%20task%20is%20to%20count%20the%20number%20of%20different%20beautiful%20fences%20of%20length%20%24%20l%20%24%20.%5Cn%5CnTwo%20fences%20will%20be%20considered%20the%20same%20if%20the%20corresponding%20sequences%20of%20fence%20boards%20types%20and%20rotations%20are%20the%20same%2C%20otherwise%20the%20fences%20are%20different.%20Since%20the%20sought%20number%20can%20be%20large%20enough%2C%20you%20need%20to%20calculate%20the%20answer%20modulo%20%24%201000000007%20%24%20%24%20%2810%5E%7B9%7D%2B7%29%20%24%20.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20two%20integers%20%24%20n%20%24%20and%20%24%20l%20%24%20%28%20%24%201%3C%3Dn%3C%3D100%2C1%3C%3Dl%3C%3D3000%20%24%20%29%20%5Cu2014%20the%20number%20of%20different%20board%20types%20and%20the%20fence%20length%2C%20correspondingly.%20Next%20%24%20n%20%24%20lines%20contain%20descriptions%20of%20board%20types%3A%20the%20%24%20i%20%24%20-th%20line%20contains%20two%20integers%20%24%20a_%7Bi%7D%20%24%20and%20%24%20b_%7Bi%7D%20%24%20%28%20%24%201%3C%3Da_%7Bi%7D%2Cb_%7Bi%7D%3C%3D100%20%24%20%29%20%5Cu2014%20the%20sizes%20of%20the%20board%20of%20the%20%24%20i%20%24%20-th%20type.%20All%20numbers%20on%20the%20lines%20are%20separated%20by%20spaces.%22%2C%22outputFormat%22%3A%22Print%20a%20single%20integer%20%5Cu2014%20the%20sought%20number%20of%20variants%20modulo%20%24%201000000007%20%24%20%28%20%24%2010%5E%7B9%7D%2B7%20%24%20%29.%22%2C%22samples%22%3A%5B%5B%222%203%5Cn1%202%5Cn2%203%5Cn%22%2C%222%5Cn%22%5D%2C%5B%221%202%5Cn2%202%5Cn%22%2C%221%5Cn%22%5D%2C%5B%226%206%5Cn2%201%5Cn3%202%5Cn2%205%5Cn3%203%5Cn5%201%5Cn2%201%5Cn%22%2C%2220%5Cn%22%5D%5D%2C%22hint%22%3A%22In%20the%20first%20sample%20there%20are%20exactly%20two%20variants%20of%20arranging%20a%20beautiful%20fence%20of%20length%203%3A%5Cn%5Cn-%20As%20the%20first%20fence%20board%20use%20the%20board%20of%20the%20first%20type%20of%20length%201%20and%20width%202.%20As%20the%20second%20board%20use%20board%20of%20the%20second%20type%20of%20length%202%20and%20width%203.%5Cn-%20Use%20one%20board%20of%20the%20second%20type%20after%20you%20turn%20it.%20That%20makes%20its%20length%20equal%203%2C%20and%20width%20%5Cu2014%202.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B3000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F182%5C%2FE%22%2C%22id%22%3A%22182E%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22CF182E%22%2C%22title%22%3A%22Wooden%20Fence%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Wooden%20Fence%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573286098;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Wooden Fence</h1>
<h2>题目描述</h2>
<div>Vasya has recently bought some land and decided to surround it with a wooden fence.
He went to a company called "Wooden board" that produces wooden boards for fences. Vasya read in the catalog of products that the company has at its disposal $ n $ different types of wood. The company uses the $ i $ -th type of wood to produce a board of this type that is a rectangular $ a_{i} $ by $ b_{i} $ block.
Vasya decided to order boards in this company and build a fence from them. It turned out that the storehouse of the company is so large that Vasya can order arbitrary number of boards of every type. Note that Vasya is allowed to turn the boards as he builds the fence. However, Vasya cannot turn square boards.
Vasya is required to construct a fence of length $ l $ , however, an arbitrary fence won't do. Vasya wants his fence to look beautiful. We'll say that a fence is beautiful if and only if the following two conditions are fulfilled:
- there are no two successive boards of the same type
- the first board of the fence has an arbitrary length, and the length of each subsequent board equals the width of the previous one
In other words, the fence is considered beautiful, if the type of the $ i $ -th board in the fence is different from the $ i-1 $ -th board's type; besides, the $ i $ -th board's length is equal to the $ i-1 $ -th board's width (for all $ i $ , starting from 2).
Now Vasya wonders, how many variants of arranging a fence for his land exist. Your task is to count the number of different beautiful fences of length $ l $ .
Two fences will be considered the same if the corresponding sequences of fence boards types and rotations are the same, otherwise the fences are different. Since the sought number can be large enough, you need to calculate the answer modulo $ 1000000007 $ $ (10^{9}+7) $ .</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains two integers $ n $ and $ l $ ( $ 1<=n<=100,1<=l<=3000 $ ) — the number of different board types and the fence length, correspondingly. Next $ n $ lines contain descriptions of board types: the $ i $ -th line contains two integers $ a_{i} $ and $ b_{i} $ ( $ 1<=a_{i},b_{i}<=100 $ ) — the sizes of the board of the $ i $ -th type. All numbers on the lines are separated by spaces.</div>
<h3>输出格式</h3>
<br />
<div>Print a single integer — the sought number of variants modulo $ 1000000007 $ ( $ 10^{9}+7 $ ).</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>2 3
1 2
2 3
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>2
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>1 2
2 2
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>1
</code></pre>
<h3>输入样例 #3</h3>
<pre><code>6 6
2 1
3 2
2 5
3 3
5 1
2 1
</code></pre>
<h3>输出样例 #3</h3>
<pre><code>20
</code></pre>
<h2>说明</h2>
<div>In the first sample there are exactly two variants of arranging a beautiful fence of length 3:
- As the first fence board use the board of the first type of length 1 and width 2. As the second board use board of the second type of length 2 and width 3.
- Use one board of the second type after you turn it. That makes its length equal 3, and width — 2.</div>
</article>
</div>
</div>
</body>
</html>
