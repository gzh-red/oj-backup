<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Dima and Kicks - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573393197:hMlbLiYp5qI+Eud3ecLpCfVRWmSTtaO4oinXFp4jyJI=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Dima%20is%20a%20good%20person.%20In%20fact%2C%20he%27s%20great.%20But%20all%20good%20things%20come%20to%20an%20end...%5Cn%5CnSeryozha%20is%20going%20to%20kick%20Dima%20just%20few%20times..%20For%20this%20reason%20he%20divides%20the%20room%20into%20unit%20squares.%20Now%20the%20room%20is%20a%20rectangle%20%24%20n%5Cu00d7m%20%24%20consisting%20of%20unit%20squares.%5Cn%5CnFor%20the%20beginning%2C%20Seryozha%20put%20Dima%20in%20a%20center%20of%20some%20square.%20Then%20he%20started%20to%20kick%20Dima%20%28it%20is%20known%2C%20that%20he%20kicks%20Dima%20at%20least%20once%29.%20Each%20time%20when%20Dima%20is%20kicked%20he%20flyes%20up%20and%20moves%20into%20one%20of%20four%20directions%20%28up%2C%20left%2C%20right%2C%20down%29.%20On%20each%20move%20Dima%20passes%20%24%20k%20%24%20%24%20%28k%26gt%3B1%29%20%24%20unit%20of%20the%20length%20in%20the%20corresponding%20direction.%20Seryozha%20is%20really%20kind%2C%20so%20he%20kicks%20Dima%20in%20such%20way%20that%20Dima%20never%20meets%20the%20walls%20%28in%20other%20words%2C%20Dima%20never%20leave%20the%20room%27s%20space%29.%20Seryozha%20is%20also%20dynamic%20character%20so%20Dima%20never%20flies%20above%20the%20same%20segment%2C%20connecting%20a%20pair%20of%20adjacent%20squares%2C%20twice.%5Cn%5CnSeryozha%20kicks%20Dima%20for%20a%20long%20time%2C%20but%20Dima%20is%20not%20vindictive%20%5Cu2014%20Dima%20writes.%20Dima%20marked%20all%20squares%20in%20which%20he%20was%20staying%20or%20above%20which%20he%20was%20flying.%20Thanks%20to%20kicks%2C%20Dima%20does%20not%20remember%20the%20%24%20k%20%24%20value%2C%20so%20he%20asks%20you%20to%20find%20all%20possible%20values%20which%20matches%20to%20the%20Dima%27s%20records.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20%24%20n%20%24%20and%20%24%20m%20%24%20%24%20%281%3C%3Dn%2Cm%3C%3D10%5E%7B3%7D%29%20%24%20%5Cu2014%20size%20of%20the%20room.%5Cn%5CnNext%20%24%20n%20%24%20lines%20goes%2C%20each%20contains%20%24%20m%20%24%20numbers%20%24%20a_%7Bij%7D%20%24%20%5Cu2014%20Dima%27s%20notes%3A%20%24%20a_%7Bij%7D%3D1%20%24%20%2C%20if%20Dima%20was%20staying%20in%20the%20square%20%24%20%28i%2Cj%29%20%24%20or%20was%20flying%20above%20it.%20Otherwise%20%24%20a_%7Bij%7D%3D0%20%24%20.%5Cn%5CnAt%20least%20one%20%24%20a_%7Bij%7D%20%24%20equals%20%24%201%20%24%20.%22%2C%22outputFormat%22%3A%22In%20a%20single%20line%20in%20accending%20order%20print%20all%20%24%20k%20%24%20%24%20%28k%26gt%3B1%29%20%24%20%2C%20which%20matches%20the%20Dima%27s%20notes.%20If%20there%20are%20no%20such%20%24%20k%20%24%20and%20Dima%20invented%20this%20story%20with%20kicks%2C%20print%20-%20%24%201%20%24%20.%22%2C%22samples%22%3A%5B%5B%225%205%5Cn1%201%201%201%201%5Cn1%200%200%200%201%5Cn1%200%200%200%201%5Cn1%200%200%200%201%5Cn1%201%201%201%201%5Cn%22%2C%222%204%5Cn%22%5D%2C%5B%227%207%5Cn0%200%201%201%201%200%200%5Cn0%200%201%200%201%200%200%5Cn1%201%201%201%201%201%201%5Cn1%200%201%200%201%200%201%5Cn1%201%201%201%201%201%201%5Cn0%200%201%200%201%200%200%5Cn0%200%201%201%201%200%200%5Cn%22%2C%222%5Cn%22%5D%2C%5B%223%203%5Cn1%201%201%5Cn1%201%201%5Cn1%201%201%5Cn%22%2C%22-1%5Cn%22%5D%2C%5B%224%204%5Cn1%201%201%201%5Cn0%200%200%200%5Cn0%200%200%200%5Cn0%200%200%200%5Cn%22%2C%223%5Cn%22%5D%2C%5B%225%205%5Cn0%200%201%200%200%5Cn0%200%201%200%200%5Cn1%201%201%201%201%5Cn0%200%201%200%200%5Cn0%200%201%200%200%5Cn%22%2C%22-1%5Cn%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F358%5C%2FE%22%2C%22id%22%3A%22358E%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A4%2C%22totalAccepted%22%3A2%2C%22pid%22%3A%22CF358E%22%2C%22title%22%3A%22Dima%20and%20Kicks%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Dima%20and%20Kicks%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573295103;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Dima and Kicks</h1>
<h2>题目描述</h2>
<div>Dima is a good person. In fact, he's great. But all good things come to an end...
Seryozha is going to kick Dima just few times.. For this reason he divides the room into unit squares. Now the room is a rectangle $ n×m $ consisting of unit squares.
For the beginning, Seryozha put Dima in a center of some square. Then he started to kick Dima (it is known, that he kicks Dima at least once). Each time when Dima is kicked he flyes up and moves into one of four directions (up, left, right, down). On each move Dima passes $ k $ $ (k&gt;1) $ unit of the length in the corresponding direction. Seryozha is really kind, so he kicks Dima in such way that Dima never meets the walls (in other words, Dima never leave the room's space). Seryozha is also dynamic character so Dima never flies above the same segment, connecting a pair of adjacent squares, twice.
Seryozha kicks Dima for a long time, but Dima is not vindictive — Dima writes. Dima marked all squares in which he was staying or above which he was flying. Thanks to kicks, Dima does not remember the $ k $ value, so he asks you to find all possible values which matches to the Dima's records.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains $ n $ and $ m $ $ (1<=n,m<=10^{3}) $ — size of the room.
Next $ n $ lines goes, each contains $ m $ numbers $ a_{ij} $ — Dima's notes: $ a_{ij}=1 $ , if Dima was staying in the square $ (i,j) $ or was flying above it. Otherwise $ a_{ij}=0 $ .
At least one $ a_{ij} $ equals $ 1 $ .</div>
<h3>输出格式</h3>
<br />
<div>In a single line in accending order print all $ k $ $ (k&gt;1) $ , which matches the Dima's notes. If there are no such $ k $ and Dima invented this story with kicks, print - $ 1 $ .</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>5 5
1 1 1 1 1
1 0 0 0 1
1 0 0 0 1
1 0 0 0 1
1 1 1 1 1
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>2 4
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>7 7
0 0 1 1 1 0 0
0 0 1 0 1 0 0
1 1 1 1 1 1 1
1 0 1 0 1 0 1
1 1 1 1 1 1 1
0 0 1 0 1 0 0
0 0 1 1 1 0 0
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>2
</code></pre>
<h3>输入样例 #3</h3>
<pre><code>3 3
1 1 1
1 1 1
1 1 1
</code></pre>
<h3>输出样例 #3</h3>
<pre><code>-1
</code></pre>
<h3>输入样例 #4</h3>
<pre><code>4 4
1 1 1 1
0 0 0 0
0 0 0 0
0 0 0 0
</code></pre>
<h3>输出样例 #4</h3>
<pre><code>3
</code></pre>
<h3>输入样例 #5</h3>
<pre><code>5 5
0 0 1 0 0
0 0 1 0 0
1 1 1 1 1
0 0 1 0 0
0 0 1 0 0
</code></pre>
<h3>输出样例 #5</h3>
<pre><code>-1
</code></pre>
</article>
</div>
</div>
</body>
</html>
