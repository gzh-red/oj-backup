<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Drivers Dissatisfaction - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573397232:1koF/KMk6/IUFAlhTwKtYa0Ge6b034Um0Aw4GPbaFLc=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%22%2C%22description%22%3A%22In%20one%20kingdom%20there%20are%20%24%20n%20%24%20cities%20and%20%24%20m%20%24%20two-way%20roads.%20Each%20road%20connects%20a%20pair%20of%20cities%2C%20and%20for%20each%20road%20we%20know%20the%20level%20of%20drivers%20dissatisfaction%20%5Cu2014%20the%20value%20%24%20w_%7Bi%7D%20%24%20.%5Cn%5CnFor%20each%20road%20we%20know%20the%20value%20%24%20c_%7Bi%7D%20%24%20%5Cu2014%20how%20many%20lamziks%20we%20should%20spend%20to%20reduce%20the%20level%20of%20dissatisfaction%20with%20this%20road%20by%20one.%20Thus%2C%20to%20reduce%20the%20dissatisfaction%20with%20the%20%24%20i%20%24%20-th%20road%20by%20%24%20k%20%24%20%2C%20we%20should%20spend%20%24%20k%5Cu00b7c_%7Bi%7D%20%24%20lamziks.%20And%20it%20is%20allowed%20for%20the%20dissatisfaction%20to%20become%20zero%20or%20even%20negative.%5Cn%5CnIn%20accordance%20with%20the%20king%27s%20order%2C%20we%20need%20to%20choose%20%24%20n-1%20%24%20roads%20and%20make%20them%20the%20main%20roads.%20An%20important%20condition%20must%20hold%3A%20it%20should%20be%20possible%20to%20travel%20from%20any%20city%20to%20any%20other%20by%20the%20main%20roads.%5Cn%5CnThe%20road%20ministry%20has%20a%20budget%20of%20%24%20S%20%24%20lamziks%20for%20the%20reform.%20The%20ministry%20is%20going%20to%20spend%20this%20budget%20for%20repair%20of%20some%20roads%20%28to%20reduce%20the%20dissatisfaction%20with%20them%29%2C%20and%20then%20to%20choose%20the%20%24%20n-1%20%24%20main%20roads.%5Cn%5CnHelp%20to%20spend%20the%20budget%20in%20such%20a%20way%20and%20then%20to%20choose%20the%20main%20roads%20so%20that%20the%20total%20dissatisfaction%20with%20the%20main%20roads%20will%20be%20as%20small%20as%20possible.%20The%20dissatisfaction%20with%20some%20roads%20can%20become%20negative.%20It%20is%20not%20necessary%20to%20spend%20whole%20budget%20%24%20S%20%24%20.%5Cn%5CnIt%20is%20guaranteed%20that%20it%20is%20possible%20to%20travel%20from%20any%20city%20to%20any%20other%20using%20existing%20roads.%20Each%20road%20in%20the%20kingdom%20is%20a%20two-way%20road.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20two%20integers%20%24%20n%20%24%20and%20%24%20m%20%24%20%28%20%24%202%3C%3Dn%3C%3D2%5Cu00b710%5E%7B5%7D%20%24%20%2C%20%24%20n-1%3C%3Dm%3C%3D2%5Cu00b710%5E%7B5%7D%20%24%20%29%20%5Cu2014%20the%20number%20of%20cities%20and%20the%20number%20of%20roads%20in%20the%20kingdom%2C%20respectively.%5Cn%5CnThe%20second%20line%20contains%20%24%20m%20%24%20integers%20%24%20w_%7B1%7D%2Cw_%7B2%7D%2C...%2Cw_%7Bm%7D%20%24%20%28%20%24%201%3C%3Dw_%7Bi%7D%3C%3D10%5E%7B9%7D%20%24%20%29%2C%20where%20%24%20w_%7Bi%7D%20%24%20is%20the%20drivers%20dissatisfaction%20with%20the%20%24%20i%20%24%20-th%20road.%5Cn%5CnThe%20third%20line%20contains%20%24%20m%20%24%20integers%20%24%20c_%7B1%7D%2Cc_%7B2%7D%2C...%2Cc_%7Bm%7D%20%24%20%28%20%24%201%3C%3Dc_%7Bi%7D%3C%3D10%5E%7B9%7D%20%24%20%29%2C%20where%20%24%20c_%7Bi%7D%20%24%20is%20the%20cost%20%28in%20lamziks%29%20of%20reducing%20the%20dissatisfaction%20with%20the%20%24%20i%20%24%20-th%20road%20by%20one.%5Cn%5CnThe%20next%20%24%20m%20%24%20lines%20contain%20the%20description%20of%20the%20roads.%20The%20%24%20i%20%24%20-th%20of%20this%20lines%20contain%20a%20pair%20of%20integers%20%24%20a_%7Bi%7D%20%24%20and%20%24%20b_%7Bi%7D%20%24%20%28%20%24%201%3C%3Da_%7Bi%7D%2Cb_%7Bi%7D%3C%3Dn%20%24%20%2C%20%24%20a_%7Bi%7D%5Cu2260b_%7Bi%7D%20%24%20%29%20which%20mean%20that%20the%20%24%20i%20%24%20-th%20road%20connects%20cities%20%24%20a_%7Bi%7D%20%24%20and%20%24%20b_%7Bi%7D%20%24%20.%20All%20roads%20are%20two-way%20oriented%20so%20it%20is%20possible%20to%20move%20by%20the%20%24%20i%20%24%20-th%20road%20from%20%24%20a_%7Bi%7D%20%24%20to%20%24%20b_%7Bi%7D%20%24%20%2C%20and%20vice%20versa.%20It%20is%20allowed%20that%20a%20pair%20of%20cities%20is%20connected%20by%20more%20than%20one%20road.%5Cn%5CnThe%20last%20line%20contains%20one%20integer%20%24%20S%20%24%20%28%20%24%200%3C%3DS%3C%3D10%5E%7B9%7D%20%24%20%29%20%5Cu2014%20the%20number%20of%20lamziks%20which%20we%20can%20spend%20for%20reforms.%22%2C%22outputFormat%22%3A%22In%20the%20first%20line%20print%20%24%20K%20%24%20%5Cu2014%20the%20minimum%20possible%20total%20dissatisfaction%20with%20main%20roads.%5Cn%5CnIn%20each%20of%20the%20next%20%24%20n-1%20%24%20lines%20print%20two%20integers%20%24%20x%2Cv_%7Bx%7D%20%24%20%2C%20which%20mean%20that%20the%20road%20%24%20x%20%24%20is%20among%20main%20roads%20and%20the%20road%20%24%20x%20%24%20%2C%20after%20the%20reform%2C%20has%20the%20level%20of%20dissatisfaction%20%24%20v_%7Bx%7D%20%24%20.%5Cn%5CnConsider%20that%20roads%20are%20numbered%20from%20%24%201%20%24%20to%20%24%20m%20%24%20in%20the%20order%20as%20they%20are%20given%20in%20the%20input%20data.%20The%20edges%20can%20be%20printed%20in%20arbitrary%20order.%20If%20there%20are%20several%20answers%2C%20print%20any%20of%20them.%22%2C%22samples%22%3A%5B%5B%226%209%5Cn1%203%201%201%203%201%202%202%202%5Cn4%201%204%202%202%205%203%201%206%5Cn1%202%5Cn1%203%5Cn2%203%5Cn2%204%5Cn2%205%5Cn3%205%5Cn3%206%5Cn4%205%5Cn5%206%5Cn7%5Cn%22%2C%220%5Cn1%201%5Cn3%201%5Cn6%201%5Cn7%202%5Cn8%20-5%5Cn%22%5D%2C%5B%223%203%5Cn9%205%201%5Cn7%207%202%5Cn2%201%5Cn3%201%5Cn3%202%5Cn2%5Cn%22%2C%225%5Cn3%200%5Cn2%205%5Cn%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B4000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F733%5C%2FF%22%2C%22id%22%3A%22733F%22%7D%2C%22translation%22%3A%22%5Cu3010%5Cu95ee%5Cu9898%5Cu63cf%5Cu8ff0%5Cu3011%20%5Cu7ed9%5Cu51fa%5Cu4e00%5Cu5f20%20n%20%5Cu4e2a%5Cu70b9%20m%20%5Cu6761%5Cu8fb9%5Cu7684%5Cu65e0%5Cu5411%5Cu56fe%5Cuff0c%5Cu6bcf%5Cu6761%5Cu8fb9%28ai%2Cbi%29%5Cu6709%5Cu4e00%5Cu4e2a%5Cu6743%5Cu503c%20wi%20%5Cu548c%5Cu8d39%5Cu7528%20ci%5Cuff0c%5Cu8868%5Cu793a%5Cu8fd9%5Cu6761%5Cu8fb9%20%5Cu6bcf%5Cu964d%5Cu4f4e%201%20%5Cu7684%5Cu6743%5Cu503c%5Cu9700%5Cu8981%20ci%20%5Cu7684%5Cu82b1%5Cu8d39%5Cu3002%5Cu73b0%5Cu5728%5Cu4e00%5Cu5171%5Cu6709%20S%20%5Cu8d39%5Cu7528%5Cu53ef%5Cu4ee5%5Cu7528%5Cu6765%5Cu964d%5Cu4f4e%5Cu67d0%5Cu4e9b%5Cu8fb9%5Cu7684%5Cu6743%5Cu503c%5Cuff08%5Cu53ef%5Cu4ee5%5Cu964d%5Cu5230%20%5Cu8d1f%5Cu6570%5Cuff09%5Cuff0c%5Cu6c42%5Cu56fe%5Cu4e2d%5Cu7684%5Cu4e00%5Cu68f5%5Cu6743%5Cu503c%5Cu548c%5Cu6700%5Cu5c0f%5Cu7684%5Cu751f%5Cu6210%5Cu6811%5Cu5e76%5Cu8f93%5Cu51fa%5Cu65b9%5Cu6848%5Cu3002%5Cn%5Cn%5Cu3010%5Cu8f93%5Cu5165%5Cu63cf%5Cu8ff0%5Cu3011%20%5Cu7b2c%5Cu4e00%5Cu884c%5Cu4e24%5Cu4e2a%5Cu6574%5Cu6570%20n%5Cuff0cm%5Cu3002%20%5Cu7b2c%5Cu4e8c%5Cu884c%20m%20%5Cu4e2a%5Cu6574%5Cu6570%20wi%5Cuff0c%5Cu8868%5Cu793a%5Cu6bcf%5Cu6761%5Cu8fb9%5Cu7684%5Cu6743%5Cu503c%5Cu3002%20%5Cu7b2c%5Cu4e09%5Cu884c%20m%20%5Cu4e2a%5Cu6574%5Cu6570%20ci%5Cuff0c%5Cu8868%5Cu793a%5Cu8fd9%5Cu6761%5Cu8fb9%5Cu6bcf%5Cu964d%5Cu4f4e%201%20%5Cu7684%5Cu6743%5Cu503c%5Cu9700%5Cu8981%20ci%20%5Cu7684%5Cu82b1%5Cu8d39%20%5Cu63a5%5Cu4e0b%5Cu6765%20m%20%5Cu884c%5Cuff0c%5Cu6bcf%5Cu884c%5Cu4e24%5Cu4e2a%5Cu6574%5Cu6570%20ai%2Cbi%5Cuff0c%5Cu8868%5Cu793a%20ai%20%5Cu5230%20bi%20%5Cu6709%5Cu8fb9%20%5Cu6700%5Cu540e%5Cu4e00%5Cu884c%5Cu4e00%5Cu4e2a%5Cu6574%5Cu6570%20S%5Cn%5Cn%5Cu3010%5Cu8f93%5Cu51fa%5Cu63cf%5Cu8ff0%5Cu3011%20%5Cu6c42%5Cu5728%5Cu4ee3%5Cu4ef7%5Cu4e0d%5Cu8d85%5Cu8fc7%20S%20%5Cu7684%5Cu60c5%5Cu51b5%5Cu4e0b%5Cuff0c%5Cu6700%5Cu7ec8%5Cu56fe%5Cu4e2d%5Cu6700%5Cu5c0f%5Cu751f%5Cu6210%5Cu6811%5Cu6743%5Cu503c%5Cu548c%5Cu6700%5Cu5c0f%5Cu662f%5Cu591a%5Cu5c11%5Cu3002%20%5Cu8f93%5Cu51fa%5Cu6700%5Cu7ec8%5Cu5728%5Cu6700%5Cu5c0f%5Cu751f%5Cu6210%5Cu6811%5Cu4e2d%5Cu7684%5Cu8fb9%5Cu7684%5Cu7f16%5Cu53f7%5Cuff0c%5Cu4ee5%5Cu53ca%5Cu6bcf%5Cu6761%5Cu8fb9%5Cu7684%5Cu6743%5Cu503c%5Cu3002%5Cn%5Cn%5Cu611f%5Cu8c22%40durex_com%20%5Cu63d0%5Cu4f9b%5Cu7684%5Cu7ffb%5Cu8bd1%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A197%2C%22totalAccepted%22%3A50%2C%22pid%22%3A%22CF733F%22%2C%22title%22%3A%22Drivers%20Dissatisfaction%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A38781%2C%22title%22%3A%22CF733F%20%5Cu9898%5Cu76ee%5Cu7ffb%5Cu8bd1%22%2C%22forum%22%3A%7B%22id%22%3A9683%2C%22name%22%3A%22CF733F%20Drivers%20Dissatisfaction%22%2C%22slug%22%3A%22CF733F%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22CF901C%22%2C%22title%22%3A%22Bipartite%20Segments%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF860E%22%2C%22title%22%3A%22Arkady%20and%20a%20Nobody-men%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF594D%22%2C%22title%22%3A%22REQ%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF383C%22%2C%22title%22%3A%22Propagating%20tree%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF960E%22%2C%22title%22%3A%22Alternating%20Tree%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Drivers%20Dissatisfaction%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Drivers Dissatisfaction</h1>
<h2>题意翻译</h2>
<div>【问题描述】 给出一张 n 个点 m 条边的无向图，每条边(ai,bi)有一个权值 wi 和费用 ci，表示这条边 每降低 1 的权值需要 ci 的花费。现在一共有 S 费用可以用来降低某些边的权值（可以降到 负数），求图中的一棵权值和最小的生成树并输出方案。
【输入描述】 第一行两个整数 n，m。 第二行 m 个整数 wi，表示每条边的权值。 第三行 m 个整数 ci，表示这条边每降低 1 的权值需要 ci 的花费 接下来 m 行，每行两个整数 ai,bi，表示 ai 到 bi 有边 最后一行一个整数 S
【输出描述】 求在代价不超过 S 的情况下，最终图中最小生成树权值和最小是多少。 输出最终在最小生成树中的边的编号，以及每条边的权值。
感谢@durex_com 提供的翻译</div>
<h2>题目描述</h2>
<div>In one kingdom there are $ n $ cities and $ m $ two-way roads. Each road connects a pair of cities, and for each road we know the level of drivers dissatisfaction — the value $ w_{i} $ .
For each road we know the value $ c_{i} $ — how many lamziks we should spend to reduce the level of dissatisfaction with this road by one. Thus, to reduce the dissatisfaction with the $ i $ -th road by $ k $ , we should spend $ k·c_{i} $ lamziks. And it is allowed for the dissatisfaction to become zero or even negative.
In accordance with the king's order, we need to choose $ n-1 $ roads and make them the main roads. An important condition must hold: it should be possible to travel from any city to any other by the main roads.
The road ministry has a budget of $ S $ lamziks for the reform. The ministry is going to spend this budget for repair of some roads (to reduce the dissatisfaction with them), and then to choose the $ n-1 $ main roads.
Help to spend the budget in such a way and then to choose the main roads so that the total dissatisfaction with the main roads will be as small as possible. The dissatisfaction with some roads can become negative. It is not necessary to spend whole budget $ S $ .
It is guaranteed that it is possible to travel from any city to any other using existing roads. Each road in the kingdom is a two-way road.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains two integers $ n $ and $ m $ ( $ 2<=n<=2·10^{5} $ , $ n-1<=m<=2·10^{5} $ ) — the number of cities and the number of roads in the kingdom, respectively.
The second line contains $ m $ integers $ w_{1},w_{2},...,w_{m} $ ( $ 1<=w_{i}<=10^{9} $ ), where $ w_{i} $ is the drivers dissatisfaction with the $ i $ -th road.
The third line contains $ m $ integers $ c_{1},c_{2},...,c_{m} $ ( $ 1<=c_{i}<=10^{9} $ ), where $ c_{i} $ is the cost (in lamziks) of reducing the dissatisfaction with the $ i $ -th road by one.
The next $ m $ lines contain the description of the roads. The $ i $ -th of this lines contain a pair of integers $ a_{i} $ and $ b_{i} $ ( $ 1<=a_{i},b_{i}<=n $ , $ a_{i}≠b_{i} $ ) which mean that the $ i $ -th road connects cities $ a_{i} $ and $ b_{i} $ . All roads are two-way oriented so it is possible to move by the $ i $ -th road from $ a_{i} $ to $ b_{i} $ , and vice versa. It is allowed that a pair of cities is connected by more than one road.
The last line contains one integer $ S $ ( $ 0<=S<=10^{9} $ ) — the number of lamziks which we can spend for reforms.</div>
<h3>输出格式</h3>
<br />
<div>In the first line print $ K $ — the minimum possible total dissatisfaction with main roads.
In each of the next $ n-1 $ lines print two integers $ x,v_{x} $ , which mean that the road $ x $ is among main roads and the road $ x $ , after the reform, has the level of dissatisfaction $ v_{x} $ .
Consider that roads are numbered from $ 1 $ to $ m $ in the order as they are given in the input data. The edges can be printed in arbitrary order. If there are several answers, print any of them.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>6 9
1 3 1 1 3 1 2 2 2
4 1 4 2 2 5 3 1 6
1 2
1 3
2 3
2 4
2 5
3 5
3 6
4 5
5 6
7
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>0
1 1
3 1
6 1
7 2
8 -5
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>3 3
9 5 1
7 7 2
2 1
3 1
3 2
2
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>5
3 0
2 5
</code></pre>
</article>
</div>
</div>
</body>
</html>
