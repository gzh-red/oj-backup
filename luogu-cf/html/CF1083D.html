<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>The Fair Nut&#039;s getting crazy - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573401387:LUhjtmNxn+AselU6bpdbuJyaaFNSu2NjBsJj9XMcWDU=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22The%20Fair%20Nut%20has%20found%20an%20array%20%24%20a%20%24%20of%20%24%20n%20%24%20integers.%20We%20call%20subarray%20%24%20l%20%5C%5Cldots%20r%20%24%20a%20sequence%20of%20consecutive%20elements%20of%20an%20array%20with%20indexes%20from%20%24%20l%20%24%20to%20%24%20r%20%24%20%2C%20i.e.%20%24%20a_l%2C%20a_%7Bl%2B1%7D%2C%20a_%7Bl%2B2%7D%2C%20%5C%5Cldots%2C%20a_%7Br-1%7D%2C%20a_%7Br%7D%20%24%20.%5Cn%5CnNo%20one%20knows%20the%20reason%2C%20but%20he%20calls%20a%20pair%20of%20subsegments%20good%20if%20and%20only%20if%20the%20following%20conditions%20are%20satisfied%3A%5Cn%5Cn1.%20These%20subsegments%20should%20not%20be%20nested.%20That%20is%2C%20each%20of%20the%20subsegments%20should%20contain%20an%20element%20%28as%20an%20index%29%20that%20does%20not%20belong%20to%20another%20subsegment.%5Cn2.%20Subsegments%20intersect%20and%20each%20element%20that%20belongs%20to%20the%20intersection%20belongs%20each%20of%20segments%20only%20once.%5Cn%5CnFor%20example%20%24%20a%3D%5B1%2C%202%2C%203%2C%205%2C%205%5D%20%24%20.%20Pairs%20%24%20%281%20%5C%5Cldots%203%3B%202%20%5C%5Cldots%205%29%20%24%20and%20%24%20%281%20%5C%5Cldots%202%3B%202%20%5C%5Cldots%203%29%20%24%20%29%20%5Cu2014%20are%20good%2C%20but%20%24%20%281%20%5C%5Cdots%203%3B%202%20%5C%5Cldots%203%29%20%24%20and%20%24%20%283%20%5C%5Cldots%204%3B%204%20%5C%5Cldots%205%29%20%24%20%5Cu2014%20are%20not%20%28subsegment%20%24%201%20%5C%5Cldots%203%20%24%20contains%20subsegment%20%24%202%20%5C%5Cldots%203%20%24%20%2C%20integer%20%24%205%20%24%20belongs%20both%20segments%2C%20but%20occurs%20twice%20in%20subsegment%20%24%204%20%5C%5Cldots%205%20%24%20%29.%5Cn%5CnHelp%20the%20Fair%20Nut%20to%20find%20out%20the%20number%20of%20pairs%20of%20good%20subsegments%21%20The%20answer%20can%20be%20rather%20big%20so%20print%20it%20modulo%20%24%2010%5E9%2B7%20%24%20.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20a%20single%20integer%20%24%20n%20%24%20%28%20%24%201%20%5C%5Cle%20n%20%5C%5Cle%2010%5E5%20%24%20%29%20%5Cu2014%20the%20length%20of%20array%20%24%20a%20%24%20.%5Cn%5CnThe%20second%20line%20contains%20%24%20n%20%24%20integers%20%24%20a_1%2C%20a_2%2C%20%5C%5Cldots%2C%20a_n%20%24%20%28%20%24%20-10%5E9%20%5C%5Cle%20a_i%20%5C%5Cle%2010%5E9%20%24%20%29%20%5Cu2014%20the%20array%20elements.%22%2C%22outputFormat%22%3A%22Print%20single%20integer%20%5Cu2014%20the%20number%20of%20pairs%20of%20good%20subsegments%20modulo%20%24%2010%5E9%2B7%20%24%20.%22%2C%22samples%22%3A%5B%5B%223%5Cn1%202%203%5Cn%22%2C%221%5Cn%22%5D%2C%5B%225%5Cn1%202%201%202%203%5Cn%22%2C%224%5Cn%22%5D%5D%2C%22hint%22%3A%22In%20the%20first%20example%2C%20there%20is%20only%20one%20pair%20of%20good%20subsegments%3A%20%24%20%281%20%5C%5Cldots%202%2C%202%20%5C%5Cldots%203%29%20%24%20.%5Cn%5CnIn%20the%20second%20example%2C%20there%20are%20four%20pairs%20of%20good%20subsegments%3A%5Cn%5Cn-%20%24%20%281%20%5C%5Cldots%202%2C%202%20%5C%5Cldots%203%29%20%24%5Cn-%20%24%20%282%20%5C%5Cldots%203%2C%203%20%5C%5Cldots%204%29%20%24%5Cn-%20%24%20%282%20%5C%5Cldots%203%2C%203%20%5C%5Cldots%205%29%20%24%5Cn-%20%24%20%283%20%5C%5Cldots%204%2C%204%20%5C%5Cldots%205%29%20%24%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B4000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F1083%5C%2FD%22%2C%22id%22%3A%221083D%22%7D%2C%22translation%22%3A%22%5Cu7ed9%5Cu5b9a%5Cu4e00%5Cu4e2a%5Cu957f%5Cu5ea6%5Cu4e3a%20%24n%24%20%5Cu7684%5Cu5e8f%5Cu5217%20%24%5C%5C%7Ba_i%5C%5C%7D%24%5Cu3002%5Cu4f60%5Cu9700%5Cu8981%5Cu4ece%5Cu8be5%5Cu5e8f%5Cu5217%5Cu4e2d%5Cu9009%5Cu51fa%5Cu4e24%5Cu4e2a%5Cu975e%5Cu7a7a%5Cu7684%5Cu5b50%5Cu6bb5%5Cuff0c%5Cu8fd9%5Cu4e24%5Cu4e2a%5Cu5b50%5Cu6bb5%5Cu6ee1%5Cu8db3%5Cuff1a%5Cr%5Cn%5Cr%5Cn-%20%5Cu4e24%5Cu4e2a%5Cu5b50%5Cu6bb5%5Cu975e%5Cu5305%5Cu542b%5Cu5173%5Cu7cfb%5Cu3002%5Cr%5Cn-%20%5Cu4e24%5Cu4e2a%5Cu5b50%5Cu6bb5%5Cu5b58%5Cu5728%5Cu4ea4%5Cu3002%5Cr%5Cn-%20%5Cu4f4d%5Cu4e8e%5Cu4e24%5Cu4e2a%5Cu5b50%5Cu6bb5%5Cu4ea4%5Cu4e2d%5Cu7684%5Cu5143%5Cu7d20%5Cu5728%5Cu6bcf%5Cu4e2a%5Cu5b50%5Cu6bb5%5Cu4e2d%5Cu53ea%5Cu80fd%5Cu51fa%5Cu73b0%5Cu4e00%5Cu6b21%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu6c42%5Cu5171%5Cu6709%5Cu591a%5Cu5c11%5Cu79cd%5Cu4e0d%5Cu540c%5Cu7684%5Cu5b50%5Cu6bb5%5Cu9009%5Cu62e9%5Cu65b9%5Cu6848%5Cu3002%5Cu8f93%5Cu51fa%5Cu603b%5Cu65b9%5Cu6848%5Cu6570%5Cu5bf9%20%2410%5E9%20%2B%207%24%20%5Cu53d6%5Cu6a21%5Cu540e%5Cu7684%5Cu7ed3%5Cu679c%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu9700%5Cu8981%5Cu6ce8%5Cu610f%5Cu7684%5Cu662f%5Cuff0c%5Cu9009%5Cu62e9%5Cu5b50%5Cu6bb5%20%24%5Ba%2C%20b%5D%24%5Cu3001%24%5Bc%2C%20d%5D%24%20%5Cu4e0e%5Cu9009%5Cu62e9%5Cu5b50%5Cu6bb5%20%24%5Bc%2C%20d%5D%24%5Cu3001%24%5Ba%2C%20b%5D%24%20%5Cu88ab%5Cu89c6%5Cu4e3a%5Cu662f%5Cu76f8%5Cu540c%5Cu7684%5Cu4e24%5Cu79cd%5Cu65b9%5Cu6848%5Cu3002%5Cr%5Cn%5Cr%5Cn%241%20%5C%5Cleq%20n%20%5C%5Cleq%2010%5E5%2C%20-10%5E9%20%5C%5Cleq%20a_i%20%5C%5Cleq%2010%5E9%24%5Cu3002%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A8%2C%22totalAccepted%22%3A6%2C%22pid%22%3A%22CF1083D%22%2C%22title%22%3A%22The%20Fair%20Nut%27s%20getting%20crazy%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A93607%2C%22title%22%3A%22%5Cu7ffb%5Cu8bd1%22%2C%22forum%22%3A%7B%22id%22%3A33476%2C%22name%22%3A%22CF1083D%20The%20Fair%20Nut%27s%20getting%20crazy%22%2C%22slug%22%3A%22CF1083D%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22The%20Fair%20Nut%27s%20getting%20crazy%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>The Fair Nut&#039;s getting crazy</h1>
<h2>题意翻译</h2>
<div>给定一个长度为 $n$ 的序列 $\{a_i\}$。你需要从该序列中选出两个非空的子段，这两个子段满足：
- 两个子段非包含关系。
- 两个子段存在交。
- 位于两个子段交中的元素在每个子段中只能出现一次。
求共有多少种不同的子段选择方案。输出总方案数对 $10^9 + 7$ 取模后的结果。
需要注意的是，选择子段 $[a, b]$、$[c, d]$ 与选择子段 $[c, d]$、$[a, b]$ 被视为是相同的两种方案。
$1 \leq n \leq 10^5, -10^9 \leq a_i \leq 10^9$。</div>
<h2>题目描述</h2>
<div>The Fair Nut has found an array $ a $ of $ n $ integers. We call subarray $ l \ldots r $ a sequence of consecutive elements of an array with indexes from $ l $ to $ r $ , i.e. $ a_l, a_{l+1}, a_{l+2}, \ldots, a_{r-1}, a_{r} $ .
No one knows the reason, but he calls a pair of subsegments good if and only if the following conditions are satisfied:
1. These subsegments should not be nested. That is, each of the subsegments should contain an element (as an index) that does not belong to another subsegment.
2. Subsegments intersect and each element that belongs to the intersection belongs each of segments only once.
For example $ a=[1, 2, 3, 5, 5] $ . Pairs $ (1 \ldots 3; 2 \ldots 5) $ and $ (1 \ldots 2; 2 \ldots 3) $ ) — are good, but $ (1 \dots 3; 2 \ldots 3) $ and $ (3 \ldots 4; 4 \ldots 5) $ — are not (subsegment $ 1 \ldots 3 $ contains subsegment $ 2 \ldots 3 $ , integer $ 5 $ belongs both segments, but occurs twice in subsegment $ 4 \ldots 5 $ ).
Help the Fair Nut to find out the number of pairs of good subsegments! The answer can be rather big so print it modulo $ 10^9+7 $ .</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains a single integer $ n $ ( $ 1 \le n \le 10^5 $ ) — the length of array $ a $ .
The second line contains $ n $ integers $ a_1, a_2, \ldots, a_n $ ( $ -10^9 \le a_i \le 10^9 $ ) — the array elements.</div>
<h3>输出格式</h3>
<br />
<div>Print single integer — the number of pairs of good subsegments modulo $ 10^9+7 $ .</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>3
1 2 3
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>1
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>5
1 2 1 2 3
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>4
</code></pre>
<h2>说明</h2>
<div>In the first example, there is only one pair of good subsegments: $ (1 \ldots 2, 2 \ldots 3) $ .
In the second example, there are four pairs of good subsegments:
- $ (1 \ldots 2, 2 \ldots 3) $
- $ (2 \ldots 3, 3 \ldots 4) $
- $ (2 \ldots 3, 3 \ldots 5) $
- $ (3 \ldots 4, 4 \ldots 5) $</div>
</article>
</div>
</div>
</body>
</html>
