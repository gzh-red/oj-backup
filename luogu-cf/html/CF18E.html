<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Flag 2 - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573389991:H1law/5YFqokYmkMakAfdUzOS9o+yDUAQy3mk2nnnFU=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%22%2C%22description%22%3A%22According%20to%20a%20new%20ISO%20standard%2C%20a%20flag%20of%20every%20country%20should%20have%2C%20strangely%20enough%2C%20a%20chequered%20field%20%24%20n%5Cu00d7m%20%24%20%2C%20each%20square%20should%20be%20wholly%20painted%20one%20of%2026%20colours.%20The%20following%20restrictions%20are%20set%3A%5Cn%5Cn-%20In%20each%20row%20at%20most%20two%20different%20colours%20can%20be%20used.%5Cn-%20No%20two%20adjacent%20squares%20can%20be%20painted%20the%20same%20colour.%5Cn%5CnPay%20attention%2C%20please%2C%20that%20in%20one%20column%20more%20than%20two%20different%20colours%20can%20be%20used.%5Cn%5CnBerland%27s%20government%20took%20a%20decision%20to%20introduce%20changes%20into%20their%20country%27s%20flag%20in%20accordance%20with%20the%20new%20standard%2C%20at%20the%20same%20time%20they%20want%20these%20changes%20to%20be%20minimal.%20By%20the%20given%20description%20of%20Berland%27s%20flag%20you%20should%20find%20out%20the%20minimum%20amount%20of%20squares%20that%20need%20to%20be%20painted%20different%20colour%20to%20make%20the%20flag%20meet%20the%20new%20ISO%20standard.%20You%20are%20as%20well%20to%20build%20one%20of%20the%20possible%20variants%20of%20the%20new%20Berland%27s%20flag.%22%2C%22inputFormat%22%3A%22The%20first%20input%20line%20contains%202%20integers%20%24%20n%20%24%20and%20%24%20m%20%24%20%28%20%24%201%3C%3Dn%2Cm%3C%3D500%20%24%20%29%20%5Cu2014%20amount%20of%20rows%20and%20columns%20in%20Berland%27s%20flag%20respectively.%20Then%20there%20follows%20the%20flag%27s%20description%3A%20each%20of%20the%20following%20%24%20n%20%24%20lines%20contains%20%24%20m%20%24%20characters.%20Each%20character%20is%20a%20letter%20from%20a%20to%20z%2C%20and%20it%20stands%20for%20the%20colour%20of%20the%20corresponding%20square.%22%2C%22outputFormat%22%3A%22In%20the%20first%20line%20output%20the%20minimum%20amount%20of%20squares%20that%20need%20to%20be%20repainted%20to%20make%20the%20flag%20meet%20the%20new%20ISO%20standard.%20The%20following%20%24%20n%20%24%20lines%20should%20contain%20one%20of%20the%20possible%20variants%20of%20the%20new%20flag.%20Don%27t%20forget%20that%20the%20variant%20of%20the%20flag%2C%20proposed%20by%20you%2C%20should%20be%20derived%20from%20the%20old%20flag%20with%20the%20minimum%20amount%20of%20repainted%20squares.%20If%20the%20answer%20isn%27t%20unique%2C%20output%20any.%22%2C%22samples%22%3A%5B%5B%223%204%5Cnaaaa%5Cnbbbb%5Cncccc%5Cn%22%2C%226%5Cnabab%5Cnbaba%5Cnacac%5Cn%22%5D%2C%5B%223%203%5Cnaba%5Cnaba%5Cnzzz%5Cn%22%2C%224%5Cnaba%5Cnbab%5Cnzbz%5Cn%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B128000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F18%5C%2FE%22%2C%22id%22%3A%2218E%22%7D%2C%22translation%22%3A%22%5Cu9898%5Cu76ee%5Cu63cf%5Cu8ff0%3A%5Cn%5Cn%5Cu6839%5Cu636e%5Cu4e00%5Cu9879%5Cu65b0%5Cu7684ISO%5Cu6807%5Cu51c6%5Cuff0c%5Cu6bcf%5Cu4e00%5Cu4e2a%5Cu56fd%5Cu5bb6%5Cu90fd%5Cu5e94%5Cu8be5%5Cu6709%5Cu56fd%5Cu65d7%5Cuff0c%5Cu5c06%5Cu4e00%5Cu4e2a%5Cu56fd%5Cu65d7%5Cu6bd4%5Cu4f5c%5Cu4e00%5Cu4e2a%5Cu683c%5Cu70b9%5Cu7f51n%5Cu00d7m%5Cuff0c%5Cu6bcf%5Cu4e2a%5Cu5c0f%5Cu683c%5Cu90fd%5Cu8981%5Cu753b%5Cu621026%5Cu4e2a%5Cu989c%5Cu8272%5Cu4e4b%5Cu4e00%5Cu3002ISO%5Cu6807%5Cu51c6%5Cu8bbe%5Cu7f6e%5Cu4e86%5Cu4ee5%5Cu4e0b%5Cu9650%5Cu5236%5Cuff1a%5Cn%5Cn%5Cu6bcf%5Cu884c%5Cu6700%5Cu591a%5Cu53ef%5Cu4f7f%5Cu7528%5Cu4e24%5Cu79cd%5Cu4e0d%5Cu540c%5Cu7684%5Cu989c%5Cu8272%5Cu3002%5Cn%5Cu76f8%5Cu90bb%5Cu7684%5Cu5c0f%5Cu683c%5Cu4e0d%5Cu80fd%5Cu662f%5Cu540c%5Cu4e00%5Cu79cd%5Cu989c%5Cu8272%5Cu3002%20%5Cu8bf7%5Cu6ce8%5Cu610f%5Cuff0c%5Cu5728%5Cu4e00%5Cu5217%5Cu4e2d%5Cu53ef%5Cu4ee5%5Cu4f7f%5Cu7528%5Cu591a%5Cu4e8e%5Cu4e24%5Cu79cd%5Cu4e0d%5Cu540c%5Cu7684%5Cu989c%5Cu8272%5Cu3002%5Cn%5Cu4f2f%5Cu5170%5Cu653f%5Cu5e9c%5Cu51b3%5Cu5b9a%5Cu6539%5Cu53d8%5Cu4ed6%5Cu4eec%5Cu56fd%5Cu5bb6%5Cu7684%5Cu56fd%5Cu65d7%5Cu4ee5%5Cu6309%5Cu7167%5Cu65b0%5Cu7684%5Cu6807%5Cu51c6%5Cuff0c%5Cu540c%5Cu65f6%5Cu4ed6%5Cu4eec%5Cu5e0c%5Cu671b%5Cu4f7f%5Cu53d8%5Cu5316%5Cu6700%5Cu5c0f%5Cu3002%5Cn%5Cn%5Cu8f93%5Cu5165%5Cu8f93%5Cu51fa%5Cu683c%5Cu5f0f%20%5Cn%5Cu8f93%5Cu5165%5Cu683c%5Cu5f0f%5Cuff1a%20%5Cn%5Cu8f93%5Cu5165%5Cu7684%5Cu7b2c%5Cu4e00%5Cu884c%5Cu5305%5Cu542b2%5Cu4e2a%5Cu6574%5Cu6570n%5Cu548cm%28%201%3C%3Dn%2Cm%3C%3D500%201%3C%3Dn%2Cm%3C%3D500%20%29%5Cu5206%5Cu522b%5Cu4e3a%5Cu4f2f%5Cu5170%5Cu653f%5Cu5e9c%5Cu7684%5Cu56fd%5Cu65d7%5Cu7684%5Cu884c%5Cu6570%5Cu548c%5Cu5217%5Cu6570%5Cu3002%20%5Cu4f2f%5Cu5170%5Cu653f%5Cu5e9c%5Cu7ed9%5Cu51fa%5Cu7684%5Cu56fd%5Cu65d7%5Cuff0c%5Cu4e3a%5Cu4e00%5Cu4e2an%2Am%5Cu7684%5Cu5b57%5Cu7b26%5Cu77e9%5Cu9635%5Cu3002%5Cu5bf9%5Cu4e8e%5Cu6bcf%5Cu4e00%5Cu4e2a%5Cu5c0f%5Cu683c%5Cu7684%5Cu989c%5Cu8272%5Cu90fd%5Cu752826%5Cu4e2a%5Cu5b57%5Cu6bcd%5Cu8868%5Cu793a%5Cu3002%20%5Cn%5Cn%5Cu8f93%5Cu51fa%5Cu683c%5Cu5f0f%5Cuff1a%20%5Cn%5Cu7b2c%5Cu4e00%5Cu884c%5Cuff1a%5Cu9700%5Cu8981%5Cu6539%5Cu53d8%5Cu7684%5Cu5c0f%5Cu683c%5Cu989c%5Cu8272%5Cu6700%5Cu5c11%5Cu6570%5Cu76ee%5Cu4f7f%5Cu5f97%5Cu65b0%5Cu56fd%5Cu65d7%5Cu7b26%5Cu5408ISO%5Cu6807%5Cu51c6%5Cu3002%20%5Cu63a5%5Cu4e0b%5Cu6765%5Cu7ed9%5Cu51fa%5Cu4e00%5Cu4e2an%2Am%5Cu7684%5Cu77e9%5Cu9635%5Cu63cf%5Cu7ed8%5Cu56fd%5Cu65d7%5Cu3002%5Cu6ce8%5Cu610f%5Cuff0c%5Cu60a8%5Cu7ed9%5Cu51fa%5Cu7684%5Cu4e3a%5Cu7b26%5Cu5408%5Cu65b0ISO%5Cu6807%5Cu51c6%5Cu7684%5Cu6700%5Cu5c0f%5Cu53d8%5Cu5316%5Cu5f62%5Cu5f0f%5Cu3002%5Cn%5CnTranslated%20by%20%40Douglas%20%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A13%2C%22totalAccepted%22%3A9%2C%22pid%22%3A%22CF18E%22%2C%22title%22%3A%22Flag%202%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A32730%2C%22title%22%3A%22%5Cu3010%5Cu7ffb%5Cu8bd1%5Cu3011%22%2C%22forum%22%3A%7B%22id%22%3A12626%2C%22name%22%3A%22CF18E%20Flag%202%22%2C%22slug%22%3A%22CF18E%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Flag%202%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573295103;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Flag 2</h1>
<h2>题意翻译</h2>
<div>题目描述:
根据一项新的ISO标准，每一个国家都应该有国旗，将一个国旗比作一个格点网n×m，每个小格都要画成26个颜色之一。ISO标准设置了以下限制：
每行最多可使用两种不同的颜色。
相邻的小格不能是同一种颜色。 请注意，在一列中可以使用多于两种不同的颜色。
伯兰政府决定改变他们国家的国旗以按照新的标准，同时他们希望使变化最小。
输入输出格式
输入格式：
输入的第一行包含2个整数n和m( 1<=n,m<=500 1<=n,m<=500 )分别为伯兰政府的国旗的行数和列数。 伯兰政府给出的国旗，为一个n*m的字符矩阵。对于每一个小格的颜色都用26个字母表示。
输出格式：
第一行：需要改变的小格颜色最少数目使得新国旗符合ISO标准。 接下来给出一个n*m的矩阵描绘国旗。注意，您给出的为符合新ISO标准的最小变化形式。
Translated by @Douglas </div>
<h2>题目描述</h2>
<div>According to a new ISO standard, a flag of every country should have, strangely enough, a chequered field $ n×m $ , each square should be wholly painted one of 26 colours. The following restrictions are set:
- In each row at most two different colours can be used.
- No two adjacent squares can be painted the same colour.
Pay attention, please, that in one column more than two different colours can be used.
Berland's government took a decision to introduce changes into their country's flag in accordance with the new standard, at the same time they want these changes to be minimal. By the given description of Berland's flag you should find out the minimum amount of squares that need to be painted different colour to make the flag meet the new ISO standard. You are as well to build one of the possible variants of the new Berland's flag.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first input line contains 2 integers $ n $ and $ m $ ( $ 1<=n,m<=500 $ ) — amount of rows and columns in Berland's flag respectively. Then there follows the flag's description: each of the following $ n $ lines contains $ m $ characters. Each character is a letter from a to z, and it stands for the colour of the corresponding square.</div>
<h3>输出格式</h3>
<br />
<div>In the first line output the minimum amount of squares that need to be repainted to make the flag meet the new ISO standard. The following $ n $ lines should contain one of the possible variants of the new flag. Don't forget that the variant of the flag, proposed by you, should be derived from the old flag with the minimum amount of repainted squares. If the answer isn't unique, output any.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>3 4
aaaa
bbbb
cccc
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>6
abab
baba
acac
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>3 3
aba
aba
zzz
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>4
aba
bab
zbz
</code></pre>
</article>
</div>
</div>
</body>
</html>
