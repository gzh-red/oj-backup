<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>The Fair Nut and Strings - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573401380:Mzr1vwfraD2DVphMuxd+Snzn5OwSfBQ2wn8lFb+K6Wg=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Recently%2C%20the%20Fair%20Nut%20has%20written%20%24%20k%20%24%20strings%20of%20length%20%24%20n%20%24%20%2C%20consisting%20of%20letters%20%5C%22a%5C%22%20and%20%5C%22b%5C%22.%20He%20calculated%20%24%20c%20%24%20%5Cu2014%20the%20number%20of%20strings%20that%20are%20prefixes%20of%20at%20least%20one%20of%20the%20written%20strings.%20Every%20string%20was%20counted%20only%20one%20time.%5Cn%5CnThen%2C%20he%20lost%20his%20sheet%20with%20strings.%20He%20remembers%20that%20all%20written%20strings%20were%20lexicographically%20not%20smaller%20than%20string%20%24%20s%20%24%20and%20not%20bigger%20than%20string%20%24%20t%20%24%20.%20He%20is%20interested%3A%20what%20is%20the%20maximum%20value%20of%20%24%20c%20%24%20that%20he%20could%20get.%5Cn%5CnA%20string%20%24%20a%20%24%20is%20lexicographically%20smaller%20than%20a%20string%20%24%20b%20%24%20if%20and%20only%20if%20one%20of%20the%20following%20holds%3A%5Cn%5Cn-%20%24%20a%20%24%20is%20a%20prefix%20of%20%24%20b%20%24%20%2C%20but%20%24%20a%20%5C%5Cne%20b%20%24%20%3B%5Cn-%20in%20the%20first%20position%20where%20%24%20a%20%24%20and%20%24%20b%20%24%20differ%2C%20the%20string%20%24%20a%20%24%20has%20a%20letter%20that%20appears%20earlier%20in%20the%20alphabet%20than%20the%20corresponding%20letter%20in%20%24%20b%20%24%20.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20two%20integers%20%24%20n%20%24%20and%20%24%20k%20%24%20%28%20%24%201%20%5C%5Cleq%20n%20%5C%5Cleq%205%20%5C%5Ccdot%2010%5E5%20%24%20%2C%20%24%201%20%5C%5Cleq%20k%20%5C%5Cleq%2010%5E9%20%24%20%29.%5Cn%5CnThe%20second%20line%20contains%20a%20string%20%24%20s%20%24%20%28%20%24%20%7Cs%7C%20%3D%20n%20%24%20%29%20%5Cu2014%20the%20string%20consisting%20of%20letters%20%5C%22a%5C%22%20and%20%5C%22b.%5Cn%5CnThe%20third%20line%20contains%20a%20string%20%24%20t%20%24%20%28%20%24%20%7Ct%7C%20%3D%20n%20%24%20%29%20%5Cu2014%20the%20string%20consisting%20of%20letters%20%5C%22a%5C%22%20and%20%5C%22b.%5Cn%5CnIt%20is%20guaranteed%20that%20string%20%24%20s%20%24%20is%20lexicographically%20not%20bigger%20than%20%24%20t%20%24%20.%22%2C%22outputFormat%22%3A%22Print%20one%20number%20%5Cu2014%20maximal%20value%20of%20%24%20c%20%24%20.%22%2C%22samples%22%3A%5B%5B%22%5Cn2%204%5Cnaa%5Cnbb%5Cn%22%2C%22%5Cn6%5Cn%22%5D%2C%5B%22%5Cn3%203%5Cnaba%5Cnbba%5Cn%22%2C%22%5Cn8%5Cn%22%5D%2C%5B%22%5Cn4%205%5Cnabbb%5Cnbaaa%5Cn%22%2C%22%5Cn8%5Cn%22%5D%5D%2C%22hint%22%3A%22In%20the%20first%20example%2C%20Nut%20could%20write%20strings%20%5C%22aa%5C%22%2C%20%5C%22ab%5C%22%2C%20%5C%22ba%5C%22%2C%20%5C%22bb%5C%22.%20These%20%24%204%20%24%20strings%20are%20prefixes%20of%20at%20least%20one%20of%20the%20written%20strings%2C%20as%20well%20as%20%5C%22a%5C%22%20and%20%5C%22b%5C%22.%20Totally%2C%20%24%206%20%24%20strings.%5Cn%5CnIn%20the%20second%20example%2C%20Nut%20could%20write%20strings%20%5C%22aba%5C%22%2C%20%5C%22baa%5C%22%2C%20%5C%22bba%5C%22.%5Cn%5CnIn%20the%20third%20example%2C%20there%20are%20only%20two%20different%20strings%20that%20Nut%20could%20write.%20If%20both%20of%20them%20are%20written%2C%20%24%20c%3D8%20%24%20.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F1083%5C%2FB%22%2C%22id%22%3A%221083B%22%7D%2C%22translation%22%3A%22%23%23%20Description%5Cr%5Cn%5Cr%5Cn%5Cu6709%20%24k%24%20%5Cu4e2a%5Cu957f%5Cu5ea6%5Cu4e3a%20%24n%24%20%5Cu7684%5Cu53ea%5Cu542b%20%24a%24%20%5Cu6216%20%24b%24%20%5Cu5b57%5Cu7b26%5Cu4e32%5Cuff0c%5Cu5e76%5Cu4e0d%5Cu77e5%5Cu9053%5Cu5b83%5Cu4eec%5Cu5177%5Cu4f53%5Cu662f%5Cu591a%5Cu5c11%5Cuff0c%5Cu53ea%5Cu77e5%5Cu9053%5Cu5b83%5Cu4eec%5Cu7684%5Cu5b57%5Cu5178%5Cu5e8f%5Cu4e0d%5Cu5c0f%5Cu4e8e%5Cu5b57%5Cu7b26%5Cu4e32%20%24A%24%5Cuff0c%5Cu540c%5Cu65f6%5Cu4e0d%5Cu5927%5Cu4e8e%5Cu5b57%5Cu7b26%5Cu4e32%20%24B%24%5Cu3002%5Cu5b9a%5Cu4e49%5Cu4e00%5Cu4e2a%5Cu5b57%5Cu7b26%5Cu4e32%5Cu662f%5Cu5408%5Cu6cd5%5Cu7684%5Cu5f53%5Cu4e14%5Cu4ec5%5Cu5f53%5Cu5b83%5Cu662f%5Cu8fd9%20%24k%24%20%5Cu4e2a%5Cu5b57%5Cu7b26%5Cu4e32%5Cu4e4b%5Cu4e00%5Cu7684%5Cu524d%5Cu7f00%5Cuff08%5Cu5982%5Cu679c%5Cu5b83%5Cu662f%5Cu591a%5Cu4e2a%5Cu4e32%5Cu7684%5Cu524d%5Cu7f00%5Cu90a3%5Cu4e48%5Cu53ea%5Cu8ba1%5Cu7b97%5Cu4e00%5Cu6b21%5Cuff09%5Cu3002%5Cu6c42%5Cu5408%5Cu6cd5%5Cu7684%5Cu5b57%5Cu7b26%5Cu4e32%5Cu6700%5Cu5927%5Cu53ef%5Cu80fd%5Cu662f%5Cu591a%5Cu5c11%5Cr%5Cn%5Cr%5Cn%23%23%20Input%5Cr%5Cn%5Cr%5Cn%5Cu7b2c%5Cu4e00%5Cu884c%5Cu662f%5Cu4e24%5Cu4e2a%5Cu6574%5Cu6570%20%24n%24%20%5Cu548c%20%24k%24%5Cr%5Cn%5Cr%5Cn%5Cu4e0b%5Cu9762%5Cu4e24%5Cu884c%5Cuff0c%5Cu7b2c%5Cu4e00%5Cu884c%5Cu662f%5Cu957f%5Cu5ea6%5Cu4e3a%20%24n%24%20%5Cu7684%5Cu5b57%5Cu7b26%5Cu4e32%20%24A%24%5Cuff0c%5Cu7b2c%5Cu4e8c%5Cu884c%5Cu662f%5Cu957f%5Cu5ea6%5Cu4e3a%20%24n%24%20%5Cu7684%5Cu5b57%5Cu7b26%5Cu4e32%20%24B%24%5Cr%5Cn%5Cr%5Cn%23%23%20Output%5Cr%5Cn%5Cr%5Cn%5Cu8f93%5Cu51fa%5Cu4e00%5Cu4e2a%5Cu6570%5Cu4ee3%5Cu8868%5Cu7b54%5Cu6848%5Cu3002%5Cr%5Cn%5Cr%5Cn%23%23%20Hint%5Cr%5Cn%5Cr%5Cn%241~%5C%5Cleq~n~%5C%5Cleq~5~%5C%5Ctimes~10%5E5~%2C~1~%5C%5Cleq~k~%5C%5Cleq~10%5E9%24%5Cr%5Cn%5Cr%5CnTranslated%20by%20%40%5Cu4e00%5Cu6276%5Cu82cf%5Cu4e00%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A79%2C%22totalAccepted%22%3A44%2C%22pid%22%3A%22CF1083B%22%2C%22title%22%3A%22The%20Fair%20Nut%20and%20Strings%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A93605%2C%22title%22%3A%22%5Cu7ffb%5Cu8bd1%22%2C%22forum%22%3A%7B%22id%22%3A33478%2C%22name%22%3A%22CF1083B%20The%20Fair%20Nut%20and%20Strings%22%2C%22slug%22%3A%22CF1083B%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P1852%22%2C%22title%22%3A%22%5B%5Cu56fd%5Cu5bb6%5Cu96c6%5Cu8bad%5Cu961f%5D%5Cu8df3%5Cu8df3%5Cu68cb%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P2000%22%2C%22title%22%3A%22%5Cu62ef%5Cu6551%5Cu4e16%5Cu754c%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P4175%22%2C%22title%22%3A%22%5BCTSC2008%5D%5Cu7f51%5Cu7edc%5Cu7ba1%5Cu7406%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P5162%22%2C%22title%22%3A%22WD%5Cu4e0e%5Cu79ef%5Cu6728%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22CF1083C%22%2C%22title%22%3A%22Max%20Mex%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22The%20Fair%20Nut%20and%20Strings%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>The Fair Nut and Strings</h1>
<h2>题意翻译</h2>
<div>## Description
有 $k$ 个长度为 $n$ 的只含 $a$ 或 $b$ 字符串，并不知道它们具体是多少，只知道它们的字典序不小于字符串 $A$，同时不大于字符串 $B$。定义一个字符串是合法的当且仅当它是这 $k$ 个字符串之一的前缀（如果它是多个串的前缀那么只计算一次）。求合法的字符串最大可能是多少
## Input
第一行是两个整数 $n$ 和 $k$
下面两行，第一行是长度为 $n$ 的字符串 $A$，第二行是长度为 $n$ 的字符串 $B$
## Output
输出一个数代表答案。
## Hint
$1~\leq~n~\leq~5~\times~10^5~,~1~\leq~k~\leq~10^9$
Translated by @一扶苏一</div>
<h2>题目描述</h2>
<div>Recently, the Fair Nut has written $ k $ strings of length $ n $ , consisting of letters "a" and "b". He calculated $ c $ — the number of strings that are prefixes of at least one of the written strings. Every string was counted only one time.
Then, he lost his sheet with strings. He remembers that all written strings were lexicographically not smaller than string $ s $ and not bigger than string $ t $ . He is interested: what is the maximum value of $ c $ that he could get.
A string $ a $ is lexicographically smaller than a string $ b $ if and only if one of the following holds:
- $ a $ is a prefix of $ b $ , but $ a \ne b $ ;
- in the first position where $ a $ and $ b $ differ, the string $ a $ has a letter that appears earlier in the alphabet than the corresponding letter in $ b $ .</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains two integers $ n $ and $ k $ ( $ 1 \leq n \leq 5 \cdot 10^5 $ , $ 1 \leq k \leq 10^9 $ ).
The second line contains a string $ s $ ( $ |s| = n $ ) — the string consisting of letters "a" and "b.
The third line contains a string $ t $ ( $ |t| = n $ ) — the string consisting of letters "a" and "b.
It is guaranteed that string $ s $ is lexicographically not bigger than $ t $ .</div>
<h3>输出格式</h3>
<br />
<div>Print one number — maximal value of $ c $ .</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>
2 4
aa
bb
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>
6
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>
3 3
aba
bba
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>
8
</code></pre>
<h3>输入样例 #3</h3>
<pre><code>
4 5
abbb
baaa
</code></pre>
<h3>输出样例 #3</h3>
<pre><code>
8
</code></pre>
<h2>说明</h2>
<div>In the first example, Nut could write strings "aa", "ab", "ba", "bb". These $ 4 $ strings are prefixes of at least one of the written strings, as well as "a" and "b". Totally, $ 6 $ strings.
In the second example, Nut could write strings "aba", "baa", "bba".
In the third example, there are only two different strings that Nut could write. If both of them are written, $ c=8 $ .</div>
</article>
</div>
</div>
</body>
</html>
