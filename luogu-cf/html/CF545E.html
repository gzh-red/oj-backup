<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Paths and Trees - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573395284:KRKUI8K5STSb3c83EEt0ajOdRnJx2YDh8Cv2/UsLp/Y=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%22%2C%22description%22%3A%22Little%20girl%20Susie%20accidentally%20found%20her%20elder%20brother%27s%20notebook.%20She%20has%20many%20things%20to%20do%2C%20more%20important%20than%20solving%20problems%2C%20but%20she%20found%20this%20problem%20too%20interesting%2C%20so%20she%20wanted%20to%20know%20its%20solution%20and%20decided%20to%20ask%20you%20about%20it.%20So%2C%20the%20problem%20statement%20is%20as%20follows.%5Cn%5CnLet%27s%20assume%20that%20we%20are%20given%20a%20connected%20weighted%20undirected%20graph%20%24%20G%3D%28V%2CE%29%20%24%20%28here%20%24%20V%20%24%20is%20the%20set%20of%20vertices%2C%20%24%20E%20%24%20is%20the%20set%20of%20edges%29.%20The%20shortest-path%20tree%20from%20vertex%20%24%20u%20%24%20is%20such%20graph%20%24%20G_%7B1%7D%3D%28V%2CE_%7B1%7D%29%20%24%20that%20is%20a%20tree%20with%20the%20set%20of%20edges%20%24%20E_%7B1%7D%20%24%20that%20is%20the%20subset%20of%20the%20set%20of%20edges%20of%20the%20initial%20graph%20%24%20E%20%24%20%2C%20and%20the%20lengths%20of%20the%20shortest%20paths%20from%20%24%20u%20%24%20to%20any%20vertex%20to%20%24%20G%20%24%20and%20to%20%24%20G_%7B1%7D%20%24%20are%20the%20same.%5Cn%5CnYou%20are%20given%20a%20connected%20weighted%20undirected%20graph%20%24%20G%20%24%20and%20vertex%20%24%20u%20%24%20.%20Your%20task%20is%20to%20find%20the%20shortest-path%20tree%20of%20the%20given%20graph%20from%20vertex%20%24%20u%20%24%20%2C%20the%20total%20weight%20of%20whose%20edges%20is%20minimum%20possible.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20two%20numbers%2C%20%24%20n%20%24%20and%20%24%20m%20%24%20%28%20%24%201%3C%3Dn%3C%3D3%5Cu00b710%5E%7B5%7D%20%24%20%2C%20%24%200%3C%3Dm%3C%3D3%5Cu00b710%5E%7B5%7D%20%24%20%29%20%5Cu2014%20the%20number%20of%20vertices%20and%20edges%20of%20the%20graph%2C%20respectively.%5Cn%5CnNext%20%24%20m%20%24%20lines%20contain%20three%20integers%20each%2C%20representing%20an%20edge%20%5Cu2014%20%24%20u_%7Bi%7D%2Cv_%7Bi%7D%2Cw_%7Bi%7D%20%24%20%5Cu2014%20the%20numbers%20of%20vertices%20connected%20by%20an%20edge%20and%20the%20weight%20of%20the%20edge%20%28%20%24%20u_%7Bi%7D%5Cu2260v_%7Bi%7D%2C1%3C%3Dw_%7Bi%7D%3C%3D10%5E%7B9%7D%20%24%20%29.%20It%20is%20guaranteed%20that%20graph%20is%20connected%20and%20that%20there%20is%20no%20more%20than%20one%20edge%20between%20any%20pair%20of%20vertices.%5Cn%5CnThe%20last%20line%20of%20the%20input%20contains%20integer%20%24%20u%20%24%20%28%20%24%201%3C%3Du%3C%3Dn%20%24%20%29%20%5Cu2014%20the%20number%20of%20the%20start%20vertex.%22%2C%22outputFormat%22%3A%22In%20the%20first%20line%20print%20the%20minimum%20total%20weight%20of%20the%20edges%20of%20the%20tree.%5Cn%5CnIn%20the%20next%20line%20print%20the%20indices%20of%20the%20edges%20that%20are%20included%20in%20the%20tree%2C%20separated%20by%20spaces.%20The%20edges%20are%20numbered%20starting%20from%20%24%201%20%24%20in%20the%20order%20they%20follow%20in%20the%20input.%20You%20may%20print%20the%20numbers%20of%20the%20edges%20in%20any%20order.%5Cn%5CnIf%20there%20are%20multiple%20answers%2C%20print%20any%20of%20them.%22%2C%22samples%22%3A%5B%5B%223%203%5Cn1%202%201%5Cn2%203%201%5Cn1%203%202%5Cn3%5Cn%22%2C%222%5Cn1%202%20%5Cn%22%5D%2C%5B%224%204%5Cn1%202%201%5Cn2%203%201%5Cn3%204%201%5Cn4%201%202%5Cn4%5Cn%22%2C%224%5Cn2%203%204%20%5Cn%22%5D%5D%2C%22hint%22%3A%22In%20the%20first%20sample%20there%20are%20two%20possible%20shortest%20path%20trees%3A%5Cn%5Cn-%20with%20edges%20%24%201%5Cu20133%20%24%20and%20%24%202%5Cu20133%20%24%20%28the%20total%20weight%20is%20%24%203%20%24%20%29%3B%5Cn-%20with%20edges%20%24%201%5Cu20132%20%24%20and%20%24%202%5Cu20133%20%24%20%28the%20total%20weight%20is%20%24%202%20%24%20%29%3B%5Cn%5CnAnd%2C%20for%20example%2C%20a%20tree%20with%20edges%20%24%201%5Cu20132%20%24%20and%20%24%201%5Cu20133%20%24%20won%27t%20be%20a%20shortest%20path%20tree%20for%20vertex%20%24%203%20%24%20%2C%20because%20the%20distance%20from%20vertex%20%24%203%20%24%20to%20vertex%20%24%202%20%24%20in%20this%20tree%20equals%20%24%203%20%24%20%2C%20and%20in%20the%20original%20graph%20it%20is%20%24%201%20%24%20.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B3000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F545%5C%2FE%22%2C%22id%22%3A%22545E%22%7D%2C%22translation%22%3A%22%5Cn%5Cn%5Cu7ed9%5Cu5b9a%5Cu4e00%5Cu5f20%5Cu5e26%5Cu6b63%5Cu6743%5Cu7684%5Cu65e0%5Cu5411%5Cu56fe%5Cu548c%5Cu4e00%5Cu4e2a%5Cu6e90%5Cu70b9%5Cuff0c%5Cu6c42%5Cu8fb9%5Cu6743%5Cu548c%5Cu6700%5Cu5c0f%5Cu7684%5Cu6700%5Cu77ed%5Cu8def%5Cu5f84%5Cu6811%5Cu3002%5Cn%5Cnn%2Cm%3C%3D3%2A10%5E5%5Cn%5Cn%5Cu611f%5Cu8c22%40%5Cu9ad8%5Cu98de%20%5Cu63d0%5Cu4f9b%5Cu7684%5Cu7ffb%5Cu8bd1%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A132%2C%22totalAccepted%22%3A46%2C%22pid%22%3A%22CF545E%22%2C%22title%22%3A%22Paths%20and%20Trees%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A74076%2C%22title%22%3A%22%5Cu6700%5Cu77ed%5Cu8def%5Cu5f84%5Cu6811%5Cu548c%5Cu6700%5Cu5c0f%5Cu751f%5Cu6210%5Cu6811%5Cu6709%5Cu4ec0%5Cu4e48%5Cu533a%5Cu522b%22%2C%22forum%22%3A%7B%22id%22%3A10486%2C%22name%22%3A%22CF545E%20Paths%20and%20Trees%22%2C%22slug%22%3A%22CF545E%22%7D%7D%2C%7B%22id%22%3A33556%2C%22title%22%3A%22%5Cu7ffb%5Cu8bd1%22%2C%22forum%22%3A%7B%22id%22%3A10486%2C%22name%22%3A%22CF545E%20Paths%20and%20Trees%22%2C%22slug%22%3A%22CF545E%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22CF900D%22%2C%22title%22%3A%22Unusual%20Sequences%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF796E%22%2C%22title%22%3A%22Exam%20Cheating%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF698A%22%2C%22title%22%3A%22Vacations%22%2C%22difficulty%22%3A3%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22SP2916%22%2C%22title%22%3A%22GSS5%20-%20Can%20you%20answer%20these%20queries%20V%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22SP%22%7D%2C%7B%22pid%22%3A%22CF999E%22%2C%22title%22%3A%22Reachability%20from%20the%20Capital%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Paths%20and%20Trees%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573306449;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Paths and Trees</h1>
<h2>题意翻译</h2>
<div>
给定一张带正权的无向图和一个源点，求边权和最小的最短路径树。
n,m<=3*10^5
感谢@高飞 提供的翻译</div>
<h2>题目描述</h2>
<div>Little girl Susie accidentally found her elder brother's notebook. She has many things to do, more important than solving problems, but she found this problem too interesting, so she wanted to know its solution and decided to ask you about it. So, the problem statement is as follows.
Let's assume that we are given a connected weighted undirected graph $ G=(V,E) $ (here $ V $ is the set of vertices, $ E $ is the set of edges). The shortest-path tree from vertex $ u $ is such graph $ G_{1}=(V,E_{1}) $ that is a tree with the set of edges $ E_{1} $ that is the subset of the set of edges of the initial graph $ E $ , and the lengths of the shortest paths from $ u $ to any vertex to $ G $ and to $ G_{1} $ are the same.
You are given a connected weighted undirected graph $ G $ and vertex $ u $ . Your task is to find the shortest-path tree of the given graph from vertex $ u $ , the total weight of whose edges is minimum possible.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains two numbers, $ n $ and $ m $ ( $ 1<=n<=3·10^{5} $ , $ 0<=m<=3·10^{5} $ ) — the number of vertices and edges of the graph, respectively.
Next $ m $ lines contain three integers each, representing an edge — $ u_{i},v_{i},w_{i} $ — the numbers of vertices connected by an edge and the weight of the edge ( $ u_{i}≠v_{i},1<=w_{i}<=10^{9} $ ). It is guaranteed that graph is connected and that there is no more than one edge between any pair of vertices.
The last line of the input contains integer $ u $ ( $ 1<=u<=n $ ) — the number of the start vertex.</div>
<h3>输出格式</h3>
<br />
<div>In the first line print the minimum total weight of the edges of the tree.
In the next line print the indices of the edges that are included in the tree, separated by spaces. The edges are numbered starting from $ 1 $ in the order they follow in the input. You may print the numbers of the edges in any order.
If there are multiple answers, print any of them.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>3 3
1 2 1
2 3 1
1 3 2
3
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>2
1 2 
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>4 4
1 2 1
2 3 1
3 4 1
4 1 2
4
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>4
2 3 4 
</code></pre>
<h2>说明</h2>
<div>In the first sample there are two possible shortest path trees:
- with edges $ 1–3 $ and $ 2–3 $ (the total weight is $ 3 $ );
- with edges $ 1–2 $ and $ 2–3 $ (the total weight is $ 2 $ );
And, for example, a tree with edges $ 1–2 $ and $ 1–3 $ won't be a shortest path tree for vertex $ 3 $ , because the distance from vertex $ 3 $ to vertex $ 2 $ in this tree equals $ 3 $ , and in the original graph it is $ 1 $ .</div>
</article>
</div>
</div>
</body>
</html>
