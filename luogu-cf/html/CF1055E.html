<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Segments on the Line - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573401032:pAn4p1u4JgNQSRd3t5dbtkmugNOAcueJTCA90bUm+qU=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22You%20are%20a%20given%20a%20list%20of%20integers%20%24%20a_1%2C%20a_2%2C%20%5C%5Cldots%2C%20a_n%20%24%20and%20%24%20s%20%24%20of%20its%20segments%20%24%20%5Bl_j%3B%20r_j%5D%20%24%20%28where%20%24%201%20%5C%5Cle%20l_j%20%5C%5Cle%20r_j%20%5C%5Cle%20n%20%24%20%29.%5Cn%5CnYou%20need%20to%20select%20exactly%20%24%20m%20%24%20segments%20in%20such%20a%20way%20that%20the%20%24%20k%20%24%20-th%20order%20statistic%20of%20the%20multiset%20of%20%24%20a_i%20%24%20%2C%20where%20%24%20i%20%24%20is%20contained%20in%20at%20least%20one%20segment%2C%20is%20the%20smallest%20possible.%20If%20it%27s%20impossible%20to%20select%20a%20set%20of%20%24%20m%20%24%20segments%20in%20such%20a%20way%20that%20the%20multiset%20contains%20at%20least%20%24%20k%20%24%20elements%2C%20print%20-1.%5Cn%5CnThe%20%24%20k%20%24%20-th%20order%20statistic%20of%20a%20multiset%20is%20the%20value%20of%20the%20%24%20k%20%24%20-th%20element%20after%20sorting%20the%20multiset%20in%20non-descending%20order.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20four%20integers%20%24%20n%20%24%20%2C%20%24%20s%20%24%20%2C%20%24%20m%20%24%20and%20%24%20k%20%24%20%28%20%24%201%20%5C%5Cle%20m%20%5C%5Cle%20s%20%5C%5Cle%201500%20%24%20%2C%20%24%201%20%5C%5Cle%20k%20%5C%5Cle%20n%20%5C%5Cle%201500%20%24%20%29%20%5Cu2014%20the%20size%20of%20the%20list%2C%20the%20number%20of%20segments%2C%20the%20number%20of%20segments%20to%20choose%20and%20the%20statistic%20number.%5Cn%5CnThe%20second%20line%20contains%20%24%20n%20%24%20integers%20%24%20a_i%20%24%20%28%20%24%201%20%5C%5Cle%20a_i%20%5C%5Cle%2010%5E9%20%24%20%29%20%5Cu2014%20the%20values%20of%20the%20numbers%20in%20the%20list.%5Cn%5CnEach%20of%20the%20next%20%24%20s%20%24%20lines%20contains%20two%20integers%20%24%20l_i%20%24%20and%20%24%20r_i%20%24%20%28%20%24%201%20%5C%5Cle%20l_i%20%5C%5Cle%20r_i%20%5C%5Cle%20n%20%24%20%29%20%5Cu2014%20the%20endpoints%20of%20the%20segments.%5Cn%5CnIt%20is%20possible%20that%20some%20segments%20coincide.%22%2C%22outputFormat%22%3A%22Print%20exactly%20one%20integer%20%5Cu2014%20the%20smallest%20possible%20%24%20k%20%24%20-th%20order%20statistic%2C%20or%20-1%20if%20it%27s%20impossible%20to%20choose%20segments%20in%20a%20way%20that%20the%20multiset%20contains%20at%20least%20%24%20k%20%24%20elements.%22%2C%22samples%22%3A%5B%5B%224%203%202%202%5Cn3%201%203%202%5Cn1%202%5Cn2%203%5Cn4%204%5Cn%22%2C%222%5Cn%22%5D%2C%5B%225%202%201%201%5Cn1%202%203%204%205%5Cn2%204%5Cn1%205%5Cn%22%2C%221%5Cn%22%5D%2C%5B%225%203%203%205%5Cn5%205%202%201%201%5Cn1%202%5Cn2%203%5Cn3%204%5Cn%22%2C%22-1%5Cn%22%5D%5D%2C%22hint%22%3A%22In%20the%20first%20example%2C%20one%20possible%20solution%20is%20to%20choose%20the%20first%20and%20the%20third%20segment.%20Together%20they%20will%20cover%20three%20elements%20of%20the%20list%20%28all%2C%20except%20for%20the%20third%20one%29.%20This%20way%20the%20%24%202%20%24%20-nd%20order%20statistic%20for%20the%20covered%20elements%20is%20%24%202%20%24%20.%5Cn%5Cn%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF1055E%5C%2Fbe333fc67d60280dc550835545d694b9e06ec26a.png%29%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F1055%5C%2FE%22%2C%22id%22%3A%221055E%22%7D%2C%22translation%22%3A%22%5Cu7ed9%5Cu5b9a%5Cu7ed9n%5Cu4e2a%5Cu70b9%5Cuff0c%5Cu4ee5%5Cu53cam%5Cu6761%5Cu7ebf%5Cu6bb5%5Cuff0c%5Cu9009%5Cu62e9s%5Cu6761%5Cu7ebf%5Cu6bb5%5Cuff0c%5Cu4f7f%5Cu5f97%5Cu81f3%5Cu5c11%5Cu88ab%5Cu4e00%5Cu4e2a%5Cu7ebf%5Cu6bb5%5Cu8986%5Cu76d6%5Cu7684%5Cu70b9%5Cu7684%5Cu5750%5Cu6807%5Cu4ece%5Cu5c0f%5Cu5230%5Cu5927%5Cu6392%5Cu5e8f%5Cu540e%5Cuff0c%5Cu7b2ck%5Cu5927%5Cu6700%5Cu5c0f%5Cuff0c%5Cu6ca1%5Cu6709%5Cu5219%5Cu8f93%5Cu51fa-1%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu8f93%5Cu5165%3A%5Cr%5Cn%5Cr%5Cn%5Cu7b2c1%5Cu884c%5Cu56db%5Cu4e2a%5Cu6570%5Cuff1an%2Cm%2Cs%2Ck%3B%5Cr%5Cn%5Cr%5Cn%5Cu7b2c2%5Cu884c%20n%5Cu4e2a%5Cu6570%5Cu8868%5Cu793a%5Cu70b9%5Cu7684%5Cu5750%5Cu6807%5Cr%5Cn%5Cr%5Cn%5Cu7b2c3%5Cu884c%5Cu5230m%2B2%5Cu884c%5Cu6bcf%5Cu884c%5Cu4e24%5Cu4e2a%5Cu6570%5Cu8868%5Cu793a%5Cu6bcf%5Cu6761%5Cu7ebf%5Cu6bb5%5Cu7684%5Cu5de6%5Cu53f3%5Cu7aef%5Cu70b9%5Cu3002%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A6%2C%22totalAccepted%22%3A5%2C%22pid%22%3A%22CF1055E%22%2C%22title%22%3A%22Segments%20on%20the%20Line%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Segments%20on%20the%20Line%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Segments on the Line</h1>
<h2>题意翻译</h2>
<div>给定给n个点，以及m条线段，选择s条线段，使得至少被一个线段覆盖的点的坐标从小到大排序后，第k大最小，没有则输出-1。
输入:
第1行四个数：n,m,s,k;
第2行 n个数表示点的坐标
第3行到m+2行每行两个数表示每条线段的左右端点。</div>
<h2>题目描述</h2>
<div>You are a given a list of integers $ a_1, a_2, \ldots, a_n $ and $ s $ of its segments $ [l_j; r_j] $ (where $ 1 \le l_j \le r_j \le n $ ).
You need to select exactly $ m $ segments in such a way that the $ k $ -th order statistic of the multiset of $ a_i $ , where $ i $ is contained in at least one segment, is the smallest possible. If it's impossible to select a set of $ m $ segments in such a way that the multiset contains at least $ k $ elements, print -1.
The $ k $ -th order statistic of a multiset is the value of the $ k $ -th element after sorting the multiset in non-descending order.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains four integers $ n $ , $ s $ , $ m $ and $ k $ ( $ 1 \le m \le s \le 1500 $ , $ 1 \le k \le n \le 1500 $ ) — the size of the list, the number of segments, the number of segments to choose and the statistic number.
The second line contains $ n $ integers $ a_i $ ( $ 1 \le a_i \le 10^9 $ ) — the values of the numbers in the list.
Each of the next $ s $ lines contains two integers $ l_i $ and $ r_i $ ( $ 1 \le l_i \le r_i \le n $ ) — the endpoints of the segments.
It is possible that some segments coincide.</div>
<h3>输出格式</h3>
<br />
<div>Print exactly one integer — the smallest possible $ k $ -th order statistic, or -1 if it's impossible to choose segments in a way that the multiset contains at least $ k $ elements.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>4 3 2 2
3 1 3 2
1 2
2 3
4 4
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>2
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>5 2 1 1
1 2 3 4 5
2 4
1 5
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>1
</code></pre>
<h3>输入样例 #3</h3>
<pre><code>5 3 3 5
5 5 2 1 1
1 2
2 3
3 4
</code></pre>
<h3>输出样例 #3</h3>
<pre><code>-1
</code></pre>
<h2>说明</h2>
<div>In the first example, one possible solution is to choose the first and the third segment. Together they will cover three elements of the list (all, except for the third one). This way the $ 2 $ -nd order statistic for the covered elements is $ 2 $ .
![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1055E/be333fc67d60280dc550835545d694b9e06ec26a.png)</div>
</article>
</div>
</div>
</body>
</html>
