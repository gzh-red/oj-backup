<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Problem for Nazar - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573402317:pNxvbA9zQhfO+ufeLaaLqJiG1Cox788Z6//wx7EH+0U=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Nazar%2C%20a%20student%20of%20the%20scientific%20lyceum%20of%20the%20Kingdom%20of%20Kremland%2C%20is%20known%20for%20his%20outstanding%20mathematical%20abilities.%20Today%20a%20math%20teacher%20gave%20him%20a%20very%20difficult%20task.%5Cn%5CnConsider%20two%20infinite%20sets%20of%20numbers.%20The%20first%20set%20consists%20of%20odd%20positive%20numbers%20%28%20%24%201%2C%203%2C%205%2C%207%2C%20%5C%5Cldots%20%24%20%29%2C%20and%20the%20second%20set%20consists%20of%20even%20positive%20numbers%20%28%20%24%202%2C%204%2C%206%2C%208%2C%20%5C%5Cldots%20%24%20%29.%20At%20the%20first%20stage%2C%20the%20teacher%20writes%20the%20first%20number%20on%20the%20endless%20blackboard%20from%20the%20first%20set%2C%20in%20the%20second%20stage%20%5Cu2014%20the%20first%20two%20numbers%20from%20the%20second%20set%2C%20on%20the%20third%20stage%20%5Cu2014%20the%20next%20four%20numbers%20from%20the%20first%20set%2C%20on%20the%20fourth%20%5Cu2014%20the%20next%20eight%20numbers%20from%20the%20second%20set%20and%20so%20on.%20In%20other%20words%2C%20at%20each%20stage%2C%20starting%20from%20the%20second%2C%20he%20writes%20out%20two%20times%20more%20numbers%20than%20at%20the%20previous%20one%2C%20and%20also%20changes%20the%20set%20from%20which%20these%20numbers%20are%20written%20out%20to%20another.%5Cn%5CnThe%20ten%20first%20written%20numbers%3A%20%24%201%2C%202%2C%204%2C%203%2C%205%2C%207%2C%209%2C%206%2C%208%2C%2010%20%24%20.%20Let%27s%20number%20the%20numbers%20written%2C%20starting%20with%20one.%5Cn%5CnThe%20task%20is%20to%20find%20the%20sum%20of%20numbers%20with%20numbers%20from%20%24%20l%20%24%20to%20%24%20r%20%24%20for%20given%20integers%20%24%20l%20%24%20and%20%24%20r%20%24%20.%20The%20answer%20may%20be%20big%2C%20so%20you%20need%20to%20find%20the%20remainder%20of%20the%20division%20by%20%24%201000000007%20%24%20%28%20%24%2010%5E9%2B7%20%24%20%29.%5Cn%5CnNazar%20thought%20about%20this%20problem%20for%20a%20long%20time%2C%20but%20didn%27t%20come%20up%20with%20a%20solution.%20Help%20him%20solve%20this%20problem.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20two%20integers%20%24%20l%20%24%20and%20%24%20r%20%24%20%28%20%24%201%20%5C%5Cleq%20l%20%5C%5Cleq%20r%20%5C%5Cleq%2010%5E%7B18%7D%20%24%20%29%20%5Cu2014%20the%20range%20in%20which%20you%20need%20to%20find%20the%20sum.%22%2C%22outputFormat%22%3A%22Print%20a%20single%20integer%20%5Cu2014%20the%20answer%20modulo%20%24%201000000007%20%24%20%28%20%24%2010%5E9%2B7%20%24%20%29.%22%2C%22samples%22%3A%5B%5B%22%5Cn1%203%5Cn%22%2C%22%5Cn7%22%5D%2C%5B%22%5Cn5%2014%5Cn%22%2C%22%5Cn105%22%5D%2C%5B%22%5Cn88005553535%2099999999999%5Cn%22%2C%22%5Cn761141116%22%5D%5D%2C%22hint%22%3A%22In%20the%20first%20example%2C%20the%20answer%20is%20the%20sum%20of%20the%20first%20three%20numbers%20written%20out%20%28%20%24%201%20%2B%202%20%2B%204%20%3D%207%20%24%20%29.%5Cn%5CnIn%20the%20second%20example%2C%20the%20numbers%20with%20numbers%20from%20%24%205%20%24%20to%20%24%2014%20%24%20%3A%20%24%205%2C%207%2C%209%2C%206%2C%208%2C%2010%2C%2012%2C%2014%2C%2016%2C%2018%20%24%20.%20Their%20sum%20is%20%24%20105%20%24%20.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F1151%5C%2FC%22%2C%22id%22%3A%221151C%22%7D%2C%22translation%22%3A%22%5Cu8bbe%5Cu6b63%5Cu5947%5Cu6570%5Cu96c6%5Cu5408%5Cu4e3a%24%5C%5Cmathrm%7BA%7D%24%5Cuff0c%5Cu6b63%5Cu5076%5Cu6570%5Cu96c6%5Cu5408%5Cu4e3a%24%5C%5Cmathrm%7BB%7D%24%5Cuff0c%5Cu8fd9%5Cu4e24%5Cu4e2a%5Cu96c6%5Cu5408%5Cu662f%5Cu65e0%5Cu9650%5Cu96c6%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu5728%5Cu9ed1%5Cu677f%5Cu4e0a%5Cu5199%5Cu4e86%5Cu65e0%5Cu6570%5Cu8f6e%5Cu6570%5Cuff0c%5Cu7b2c%24i%24%5Cu8f6e%5Cu5199%5Cu4e0b%5Cu4e86%242%5E%7B%28i-1%29%7D%24%5Cu4e2a%5Cu6570.%5Cr%5Cn%5Cr%5Cn%5Cu5f53%24i%24%5Cu4e3a%5Cu5947%5Cu6570%5Cu65f6%5Cuff0c%5Cu4ece%5Cu96c6%5Cu5408%24%5C%5Cmathrm%7BA%7D%24%5Cu4e2d%5Cu5411%5Cu540e%5Cu53d6%5Cu6570%5Cuff0c%5Cu5f53%24i%24%5Cu4e3a%5Cu5076%5Cu6570%5Cu65f6%5Cuff0c%5Cu4ece%5Cu96c6%5Cu5408%24%5C%5Cmathrm%7BB%7D%24%5Cu4e2d%5Cu5411%5Cu540e%5Cu53d6%5Cu6570%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu6c42%5Cu9ed1%5Cu677f%5Cu4e0a%5Cu7b2c%24l%24%5Cu4e2a%5Cu6570%5Cu5230%5Cu7b2c%24r%24%5Cu4e2a%5Cu6570%5Cu7684%5Cu548c%5Cuff0c%5Cu6a21%24%5C%5Cmathrm%7B1000000007%7D%24%5Cuff08%2410%5E9%2B7%24%5Cuff09%5Cu3002%5Cr%5Cn%5Cr%5Cn%241%20%5C%5Cle%20l%2Cr%20%5C%5Cle%2010%5E%7B18%7D%24%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A63%2C%22totalAccepted%22%3A39%2C%22pid%22%3A%22CF1151C%22%2C%22title%22%3A%22Problem%20for%20Nazar%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22CF1151F%22%2C%22title%22%3A%22Sonya%20and%20Informatics%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1151E%22%2C%22title%22%3A%22Number%20of%20Components%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1151D%22%2C%22title%22%3A%22Stas%20and%20the%20Queue%20at%20the%20Buffet%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1151B%22%2C%22title%22%3A%22Dima%20and%20a%20Bad%20XOR%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22P5323%22%2C%22title%22%3A%22%5BBJOI2019%5D%5Cu5149%5Cu7ebf%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Problem%20for%20Nazar%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Problem for Nazar</h1>
<h2>题意翻译</h2>
<div>设正奇数集合为$\mathrm{A}$，正偶数集合为$\mathrm{B}$，这两个集合是无限集。
在黑板上写了无数轮数，第$i$轮写下了$2^{(i-1)}$个数.
当$i$为奇数时，从集合$\mathrm{A}$中向后取数，当$i$为偶数时，从集合$\mathrm{B}$中向后取数。
求黑板上第$l$个数到第$r$个数的和，模$\mathrm{1000000007}$（$10^9+7$）。
$1 \le l,r \le 10^{18}$</div>
<h2>题目描述</h2>
<div>Nazar, a student of the scientific lyceum of the Kingdom of Kremland, is known for his outstanding mathematical abilities. Today a math teacher gave him a very difficult task.
Consider two infinite sets of numbers. The first set consists of odd positive numbers ( $ 1, 3, 5, 7, \ldots $ ), and the second set consists of even positive numbers ( $ 2, 4, 6, 8, \ldots $ ). At the first stage, the teacher writes the first number on the endless blackboard from the first set, in the second stage — the first two numbers from the second set, on the third stage — the next four numbers from the first set, on the fourth — the next eight numbers from the second set and so on. In other words, at each stage, starting from the second, he writes out two times more numbers than at the previous one, and also changes the set from which these numbers are written out to another.
The ten first written numbers: $ 1, 2, 4, 3, 5, 7, 9, 6, 8, 10 $ . Let's number the numbers written, starting with one.
The task is to find the sum of numbers with numbers from $ l $ to $ r $ for given integers $ l $ and $ r $ . The answer may be big, so you need to find the remainder of the division by $ 1000000007 $ ( $ 10^9+7 $ ).
Nazar thought about this problem for a long time, but didn't come up with a solution. Help him solve this problem.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains two integers $ l $ and $ r $ ( $ 1 \leq l \leq r \leq 10^{18} $ ) — the range in which you need to find the sum.</div>
<h3>输出格式</h3>
<br />
<div>Print a single integer — the answer modulo $ 1000000007 $ ( $ 10^9+7 $ ).</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>
1 3
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>
7</code></pre>
<h3>输入样例 #2</h3>
<pre><code>
5 14
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>
105</code></pre>
<h3>输入样例 #3</h3>
<pre><code>
88005553535 99999999999
</code></pre>
<h3>输出样例 #3</h3>
<pre><code>
761141116</code></pre>
<h2>说明</h2>
<div>In the first example, the answer is the sum of the first three numbers written out ( $ 1 + 2 + 4 = 7 $ ).
In the second example, the numbers with numbers from $ 5 $ to $ 14 $ : $ 5, 7, 9, 6, 8, 10, 12, 14, 16, 18 $ . Their sum is $ 105 $ .</div>
</article>
</div>
</div>
</body>
</html>
