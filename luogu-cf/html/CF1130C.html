<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Connect - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573402008:WE0tQQf5iHTHpAMX9lo/liSNvr4lU1lcDoWXxim4/rA=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Alice%20lives%20on%20a%20flat%20planet%20that%20can%20be%20modeled%20as%20a%20square%20grid%20of%20size%20%24%20n%20%5C%5Ctimes%20n%20%24%20%2C%20with%20rows%20and%20columns%20enumerated%20from%20%24%201%20%24%20to%20%24%20n%20%24%20.%20We%20represent%20the%20cell%20at%20the%20intersection%20of%20row%20%24%20r%20%24%20and%20column%20%24%20c%20%24%20with%20ordered%20pair%20%24%20%28r%2C%20c%29%20%24%20.%20Each%20cell%20in%20the%20grid%20is%20either%20land%20or%20water.%5Cn%5Cn%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF1130C%5C%2Fb5659671b82592e81ced0ea1b88b58d8fa94b02e.png%29An%20example%20planet%20with%20%24%20n%20%3D%205%20%24%20.%20It%20also%20appears%20in%20the%20first%20sample%20test.Alice%20resides%20in%20land%20cell%20%24%20%28r_1%2C%20c_1%29%20%24%20.%20She%20wishes%20to%20travel%20to%20land%20cell%20%24%20%28r_2%2C%20c_2%29%20%24%20.%20At%20any%20moment%2C%20she%20may%20move%20to%20one%20of%20the%20cells%20adjacent%20to%20where%20she%20is%5Cu2014in%20one%20of%20the%20four%20directions%20%28i.e.%2C%20up%2C%20down%2C%20left%2C%20or%20right%29.%5Cn%5CnUnfortunately%2C%20Alice%20cannot%20swim%2C%20and%20there%20is%20no%20viable%20transportation%20means%20other%20than%20by%20foot%20%28i.e.%2C%20she%20can%20walk%20only%20on%20land%29.%20As%20a%20result%2C%20Alice%27s%20trip%20may%20be%20impossible.%5Cn%5CnTo%20help%20Alice%2C%20you%20plan%20to%20create%20at%20most%20one%20tunnel%20between%20some%20two%20land%20cells.%20The%20tunnel%20will%20allow%20Alice%20to%20freely%20travel%20between%20the%20two%20endpoints.%20Indeed%2C%20creating%20a%20tunnel%20is%20a%20lot%20of%20effort%3A%20the%20cost%20of%20creating%20a%20tunnel%20between%20cells%20%24%20%28r_s%2C%20c_s%29%20%24%20and%20%24%20%28r_t%2C%20c_t%29%20%24%20is%20%24%20%28r_s-r_t%29%5E2%20%2B%20%28c_s-c_t%29%5E2%20%24%20.%5Cn%5CnFor%20now%2C%20your%20task%20is%20to%20find%20the%20minimum%20possible%20cost%20of%20creating%20at%20most%20one%20tunnel%20so%20that%20Alice%20could%20travel%20from%20%24%20%28r_1%2C%20c_1%29%20%24%20to%20%24%20%28r_2%2C%20c_2%29%20%24%20.%20If%20no%20tunnel%20needs%20to%20be%20created%2C%20the%20cost%20is%20%24%200%20%24%20.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20one%20integer%20%24%20n%20%24%20%28%20%24%201%20%5C%5Cleq%20n%20%5C%5Cleq%2050%20%24%20%29%20%5Cu2014%20the%20width%20of%20the%20square%20grid.%5Cn%5CnThe%20second%20line%20contains%20two%20space-separated%20integers%20%24%20r_1%20%24%20and%20%24%20c_1%20%24%20%28%20%24%201%20%5C%5Cleq%20r_1%2C%20c_1%20%5C%5Cleq%20n%20%24%20%29%20%5Cu2014%20denoting%20the%20cell%20where%20Alice%20resides.%5Cn%5CnThe%20third%20line%20contains%20two%20space-separated%20integers%20%24%20r_2%20%24%20and%20%24%20c_2%20%24%20%28%20%24%201%20%5C%5Cleq%20r_2%2C%20c_2%20%5C%5Cleq%20n%20%24%20%29%20%5Cu2014%20denoting%20the%20cell%20to%20which%20Alice%20wishes%20to%20travel.%5Cn%5CnEach%20of%20the%20following%20%24%20n%20%24%20lines%20contains%20a%20string%20of%20%24%20n%20%24%20characters.%20The%20%24%20j%20%24%20-th%20character%20of%20the%20%24%20i%20%24%20-th%20such%20line%20%28%20%24%201%20%5C%5Cleq%20i%2C%20j%20%5C%5Cleq%20n%20%24%20%29%20is%200%20if%20%24%20%28i%2C%20j%29%20%24%20is%20land%20or%201%20if%20%24%20%28i%2C%20j%29%20%24%20is%20water.%5Cn%5CnIt%20is%20guaranteed%20that%20%24%20%28r_1%2C%20c_1%29%20%24%20and%20%24%20%28r_2%2C%20c_2%29%20%24%20are%20land.%22%2C%22outputFormat%22%3A%22Print%20an%20integer%20that%20is%20the%20minimum%20possible%20cost%20of%20creating%20at%20most%20one%20tunnel%20so%20that%20Alice%20could%20travel%20from%20%24%20%28r_1%2C%20c_1%29%20%24%20to%20%24%20%28r_2%2C%20c_2%29%20%24%20.%22%2C%22samples%22%3A%5B%5B%22%5Cn5%5Cn1%201%5Cn5%205%5Cn00001%5Cn11111%5Cn00111%5Cn00110%5Cn00110%5Cn%22%2C%22%5Cn10%5Cn%22%5D%2C%5B%22%5Cn3%5Cn1%203%5Cn3%201%5Cn010%5Cn101%5Cn010%5Cn%22%2C%22%5Cn8%5Cn%22%5D%5D%2C%22hint%22%3A%22In%20the%20first%20sample%2C%20a%20tunnel%20between%20cells%20%24%20%281%2C%204%29%20%24%20and%20%24%20%284%2C%205%29%20%24%20should%20be%20created.%20The%20cost%20of%20doing%20so%20is%20%24%20%281-4%29%5E2%20%2B%20%284-5%29%5E2%20%3D%2010%20%24%20%2C%20which%20is%20optimal.%20This%20way%2C%20Alice%20could%20walk%20from%20%24%20%281%2C%201%29%20%24%20to%20%24%20%281%2C%204%29%20%24%20%2C%20use%20the%20tunnel%20from%20%24%20%281%2C%204%29%20%24%20to%20%24%20%284%2C%205%29%20%24%20%2C%20and%20lastly%20walk%20from%20%24%20%284%2C%205%29%20%24%20to%20%24%20%285%2C%205%29%20%24%20.%5Cn%5CnIn%20the%20second%20sample%2C%20clearly%20a%20tunnel%20between%20cells%20%24%20%281%2C%203%29%20%24%20and%20%24%20%283%2C%201%29%20%24%20needs%20to%20be%20created.%20The%20cost%20of%20doing%20so%20is%20%24%20%281-3%29%5E2%20%2B%20%283-1%29%5E2%20%3D%208%20%24%20.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F1130%5C%2FC%22%2C%22id%22%3A%221130C%22%7D%2C%22translation%22%3A%22%5Cu7b80%5Cu5316%5Cu7248%5Cu9898%5Cu76ee%5Cu63cf%5Cu8ff0%3A%5Cr%5Cn%5Cu7ed9%5Cu5b9a%5Cu4e00%5Cu4e2a50%20%2A%2050%5Cu768401%5Cu77e9%5Cu9635%2C%5Cu8d77%5Cu70b9%5Cu5750%5Cu6807%5Cu4e0e%5Cu7ec8%5Cu70b9%5Cu5750%5Cu6807.%5Cr%5Cn%5Cr%5Cn%270%27%5Cu4ee3%5Cu8868%5Cu9646%5Cu5730%2C%271%27%5Cu4ee3%5Cu8868%5Cu6cb3%5Cu6d41%2C%5Cu8d77%5Cu70b9%5Cu4e0e%5Cu7ec8%5Cu70b9%5Cu5fc5%5Cu5b9a%5Cu662f%5Cu9646%5Cu5730.%5Cu4f60%5Cu53ef%5Cu4ee5%5Cu5728%5Cu4efb%5Cu610f%5Cu4e24%5Cu5757%5Cu9646%5Cu5730%5Cu4e0a%5Cu5efa%5Cu7acb%5Cu4f20%5Cu9001%5Cu4eea%2C%5Cu82b1%5Cu8d39%5Cu662f%5Cu4e24%5Cu70b9%5Cu95f4%5Cu6a2a%5Cu5750%5Cu6807%5C%2F%5Cu7eb5%5Cu5750%5Cu6807%5Cu7684%5Cu5dee%5Cu7684%5Cu5e73%5Cu65b9%5Cu548c.%5Cu4e00%5Cu4e2a%5Cu4f20%5Cu9001%5Cu4eea%5Cu53ef%5Cu4ee5%5Cu4f7f%5Cu4e24%5Cu70b9%5Cu76f8%5Cu4e92%5Cu53ef%5Cu8fbe%5Cu4e14%5Cu6709%5Cu4e14%5Cu53ea%5Cu80fd%5Cu5efa%5Cu9020%5Cu4e00%5Cu4e2a.%5Cr%5Cn%5Cr%5Cn%5Cu6734%5Cu7d20%5Cu5730%2A%2A%5Cu5728%5Cu9646%5Cu5730%5Cu4e0a%2A%2A%28~~%5Cu4e0d%5Cu80fd%5Cu53bb%5Cu6c34%5Cu91cc~~%29%5Cu79fb%5Cu52a8%5Cu65e0%5Cu82b1%5Cu8d39.%5Cr%5Cn%5Cr%5Cn%5Cu6c42%5Cu8d77%5Cu70b9%5Cu5230%5Cu7ec8%5Cu70b9%5Cu7684%5Cu6700%5Cu5c0f%5Cu82b1%5Cu8d39%5Cr%5Cn%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A89%2C%22totalAccepted%22%3A48%2C%22pid%22%3A%22CF1130C%22%2C%22title%22%3A%22Connect%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P2384%22%2C%22title%22%3A%22%5Cu6700%5Cu77ed%5Cu8def%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P3905%22%2C%22title%22%3A%22%5Cu9053%5Cu8def%5Cu91cd%5Cu5efa%22%2C%22difficulty%22%3A3%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P3956%22%2C%22title%22%3A%22%5Cu68cb%5Cu76d8%22%2C%22difficulty%22%3A3%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22CF510B%22%2C%22title%22%3A%22Fox%20And%20Two%20Dots%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1129B%22%2C%22title%22%3A%22Wrong%20Answer%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Connect%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Connect</h1>
<h2>题意翻译</h2>
<div>简化版题目描述:
给定一个50 * 50的01矩阵,起点坐标与终点坐标.
'0'代表陆地,'1'代表河流,起点与终点必定是陆地.你可以在任意两块陆地上建立传送仪,花费是两点间横坐标/纵坐标的差的平方和.一个传送仪可以使两点相互可达且有且只能建造一个.
朴素地**在陆地上**(~~不能去水里~~)移动无花费.
求起点到终点的最小花费
</div>
<h2>题目描述</h2>
<div>Alice lives on a flat planet that can be modeled as a square grid of size $ n \times n $ , with rows and columns enumerated from $ 1 $ to $ n $ . We represent the cell at the intersection of row $ r $ and column $ c $ with ordered pair $ (r, c) $ . Each cell in the grid is either land or water.
![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1130C/b5659671b82592e81ced0ea1b88b58d8fa94b02e.png)An example planet with $ n = 5 $ . It also appears in the first sample test.Alice resides in land cell $ (r_1, c_1) $ . She wishes to travel to land cell $ (r_2, c_2) $ . At any moment, she may move to one of the cells adjacent to where she is—in one of the four directions (i.e., up, down, left, or right).
Unfortunately, Alice cannot swim, and there is no viable transportation means other than by foot (i.e., she can walk only on land). As a result, Alice's trip may be impossible.
To help Alice, you plan to create at most one tunnel between some two land cells. The tunnel will allow Alice to freely travel between the two endpoints. Indeed, creating a tunnel is a lot of effort: the cost of creating a tunnel between cells $ (r_s, c_s) $ and $ (r_t, c_t) $ is $ (r_s-r_t)^2 + (c_s-c_t)^2 $ .
For now, your task is to find the minimum possible cost of creating at most one tunnel so that Alice could travel from $ (r_1, c_1) $ to $ (r_2, c_2) $ . If no tunnel needs to be created, the cost is $ 0 $ .</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains one integer $ n $ ( $ 1 \leq n \leq 50 $ ) — the width of the square grid.
The second line contains two space-separated integers $ r_1 $ and $ c_1 $ ( $ 1 \leq r_1, c_1 \leq n $ ) — denoting the cell where Alice resides.
The third line contains two space-separated integers $ r_2 $ and $ c_2 $ ( $ 1 \leq r_2, c_2 \leq n $ ) — denoting the cell to which Alice wishes to travel.
Each of the following $ n $ lines contains a string of $ n $ characters. The $ j $ -th character of the $ i $ -th such line ( $ 1 \leq i, j \leq n $ ) is 0 if $ (i, j) $ is land or 1 if $ (i, j) $ is water.
It is guaranteed that $ (r_1, c_1) $ and $ (r_2, c_2) $ are land.</div>
<h3>输出格式</h3>
<br />
<div>Print an integer that is the minimum possible cost of creating at most one tunnel so that Alice could travel from $ (r_1, c_1) $ to $ (r_2, c_2) $ .</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>
5
1 1
5 5
00001
11111
00111
00110
00110
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>
10
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>
3
1 3
3 1
010
101
010
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>
8
</code></pre>
<h2>说明</h2>
<div>In the first sample, a tunnel between cells $ (1, 4) $ and $ (4, 5) $ should be created. The cost of doing so is $ (1-4)^2 + (4-5)^2 = 10 $ , which is optimal. This way, Alice could walk from $ (1, 1) $ to $ (1, 4) $ , use the tunnel from $ (1, 4) $ to $ (4, 5) $ , and lastly walk from $ (4, 5) $ to $ (5, 5) $ .
In the second sample, clearly a tunnel between cells $ (1, 3) $ and $ (3, 1) $ needs to be created. The cost of doing so is $ (1-3)^2 + (3-1)^2 = 8 $ .</div>
</article>
</div>
</div>
</body>
</html>
