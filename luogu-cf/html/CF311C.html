<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Fetch the Treasure - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573392543:aaMW0VEcgtjuwfu0ScnBPJMdtM56oCzKX/4kN5vaeyg=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Rainbow%20built%20%24%20h%20%24%20cells%20in%20a%20row%20that%20are%20numbered%20from%201%20to%20%24%20h%20%24%20from%20left%20to%20right.%20There%20are%20%24%20n%20%24%20cells%20with%20treasure.%20We%20call%20each%20of%20these%20%24%20n%20%24%20cells%20%5C%22Treasure%20Cell%5C%22.%20The%20%24%20i%20%24%20-th%20%5C%22Treasure%20Cell%5C%22%20is%20the%20%24%20a_%7Bi%7D%20%24%20-th%20cell%20and%20the%20value%20of%20treasure%20in%20it%20is%20%24%20c_%7Bi%7D%20%24%20dollars.%5Cn%5CnThen%2C%20Freda%20went%20in%20the%20first%20cell.%20For%20now%2C%20she%20can%20go%20just%20%24%20k%20%24%20cells%20forward%2C%20or%20return%20to%20the%20first%20cell.%20That%20means%20Freda%20was%20able%20to%20reach%20the%201st%2C%20%28%20%24%20k%2B1%20%24%20%29-th%2C%20%28%20%24%202%5Cu00b7k%2B1%20%24%20%29-th%2C%20%28%20%24%203%5Cu00b7k%2B1%20%24%20%29-th%20cells%20and%20so%20on.%5Cn%5CnThen%20Rainbow%20gave%20Freda%20%24%20m%20%24%20operations.%20Each%20operation%20is%20one%20of%20the%20following%20three%20types%3A%5Cn%5Cn1.%20Add%20another%20method%20%24%20x%20%24%20%3A%20she%20can%20also%20go%20just%20%24%20x%20%24%20cells%20forward%20at%20any%20moment.%20For%20example%2C%20initially%20she%20has%20only%20one%20method%20%24%20k%20%24%20.%20If%20at%20some%20moment%20she%20has%20methods%20%24%20a_%7B1%7D%2Ca_%7B2%7D%2C...%2Ca_%7Br%7D%20%24%20then%20she%20can%20reach%20all%20the%20cells%20with%20number%20in%20form%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF311C%5C%2F098e382b3b8846367b54760ca19a29ffa8e34102.png%29%2C%20where%20%24%20v_%7Bi%7D%20%24%20%5Cu2014%20some%20non-negative%20integer.%5Cn2.%20Reduce%20the%20value%20of%20the%20treasure%20in%20the%20%24%20x%20%24%20-th%20%5C%22Treasure%20Cell%5C%22%20by%20%24%20y%20%24%20dollars.%20In%20other%20words%2C%20to%20apply%20assignment%20%24%20c_%7Bx%7D%3Dc_%7Bx%7D-y%20%24%20.%5Cn3.%20Ask%20the%20value%20of%20the%20most%20valuable%20treasure%20among%20the%20cells%20Freda%20can%20reach.%20If%20Freda%20cannot%20reach%20any%20cell%20with%20the%20treasure%20then%20consider%20the%20value%20of%20the%20most%20valuable%20treasure%20equal%20to%200%2C%20and%20do%20nothing.%20Otherwise%20take%20the%20most%20valuable%20treasure%20away.%20If%20several%20%5C%22Treasure%20Cells%5C%22%20have%20the%20most%20valuable%20treasure%2C%20take%20the%20%5C%22Treasure%20Cell%5C%22%20with%20the%20minimum%20number%20%28not%20necessarily%20with%20the%20minimum%20number%20of%20cell%29.%20After%20that%20the%20total%20number%20of%20cells%20with%20a%20treasure%20is%20decreased%20by%20one.%5Cn%5CnAs%20a%20programmer%2C%20you%20are%20asked%20by%20Freda%20to%20write%20a%20program%20to%20answer%20each%20query.%22%2C%22inputFormat%22%3A%22The%20first%20line%20of%20the%20input%20contains%20four%20integers%3A%20%24%20h%5Cu00a0%281%3C%3Dh%3C%3D10%5E%7B18%7D%29%2Cn%2Cm%5Cu00a0%281%3C%3Dn%2Cm%3C%3D10%5E%7B5%7D%29%20%24%20and%20%24%20k%5Cu00a0%281%3C%3Dk%3C%3D10%5E%7B4%7D%29%20%24%20.%5Cn%5CnEach%20of%20the%20next%20%24%20n%20%24%20lines%20contains%20two%20integers%3A%20%24%20a_%7Bi%7D%5Cu00a0%281%3C%3Da_%7Bi%7D%3C%3Dh%29%2Cc_%7Bi%7D%5Cu00a0%281%3C%3Dc_%7Bi%7D%3C%3D10%5E%7B9%7D%29%20%24%20.%20That%20means%20the%20%24%20i%20%24%20-th%20%5C%22Treasure%20Cell%5C%22%20is%20the%20%24%20a_%7Bi%7D%20%24%20-th%20cell%20and%20cost%20of%20the%20treasure%20in%20that%20cell%20is%20%24%20c_%7Bi%7D%20%24%20dollars.%20All%20the%20%24%20a_%7Bi%7D%20%24%20are%20distinct.%5Cn%5CnEach%20of%20the%20next%20%24%20m%20%24%20lines%20is%20in%20one%20of%20the%20three%20following%20formats%3A%5Cn%5Cn-%20%5C%221%20%24%20x%20%24%20%5C%22%20%5Cu2014%20an%20operation%20of%20type%201%2C%20%24%201%3C%3Dx%3C%3Dh%20%24%20%3B%5Cn-%20%5C%222%20%24%20x%20%24%20%24%20y%20%24%20%5C%22%20%5Cu2014%20an%20operation%20of%20type%202%2C%20%24%201%3C%3Dx%3C%3Dn%2C0%3C%3Dy%26lt%3Bc_%7Bx%7D%20%24%20%3B%5Cn-%20%5C%223%5C%22%20%5Cu2014%20an%20operation%20of%20type%203.%5Cn%5CnThere%20are%20at%20most%2020%20operations%20of%20type%201.%20It%27s%20guaranteed%20that%20at%20any%20moment%20treasure%20in%20each%20cell%20has%20positive%20value.%20It%27s%20guaranteed%20that%20all%20operations%20is%20correct%20%28no%20operation%20can%20decrease%20the%20value%20of%20the%20taken%20tresure%29.%5Cn%5CnPlease%2C%20do%20not%20use%20the%20%25lld%20specifier%20to%20read%2064-bit%20integers%20in%20%5Cu0421%2B%2B.%20It%20is%20preferred%20to%20use%20the%20cin%2C%20cout%20streams%20or%20the%20%25I64d%20specifier.%22%2C%22outputFormat%22%3A%22For%20each%20operation%20of%20type%203%2C%20output%20an%20integer%20indicates%20the%20value%20%28in%20dollars%29%20of%20the%20most%20valuable%20treasure%20among%20the%20%5C%22Treasure%20Cells%5C%22%20Freda%20can%20reach.%20If%20there%20is%20no%20such%20treasure%2C%20output%200.%22%2C%22samples%22%3A%5B%5B%2210%203%205%202%5Cn5%2050%5Cn7%2060%5Cn8%20100%5Cn2%202%205%5Cn3%5Cn1%203%5Cn3%5Cn3%5Cn%22%2C%2255%5Cn100%5Cn50%5Cn%22%5D%5D%2C%22hint%22%3A%22In%20the%20sample%2C%20there%20are%2010%20cells%20and%203%20%5C%22Treasure%20Cells%5C%22.%20The%20first%20%5C%22Treasure%20Cell%5C%22%20is%20cell%205%2C%20having%2050%20dollars%20tresure%20in%20it.%20The%20second%20%5C%22Treasure%20Cell%5C%22%20is%20cell%207%2C%20having%2060%20dollars%20tresure%20in%20it.%20The%20third%20%5C%22Treasure%20Cell%5C%22%20is%20cell%208%2C%20having%20100%20dollars%20tresure%20in%20it.%5Cn%5CnAt%20first%2C%20Freda%20can%20only%20reach%20cell%201%2C%203%2C%205%2C%207%20and%209.%20In%20the%20first%20operation%2C%20we%20reduce%20the%20value%20in%20the%20second%20%5C%22Treasure%20Cell%5C%22%20from%2060%20to%2055.%20Then%20the%20most%20valuable%20treasure%20among%20the%20%5C%22Treasure%20Cells%5C%22%20she%20can%20reach%20is%20max%2850%2C%2055%29%20%3D%2055.%20After%20the%20third%20operation%2C%20she%20can%20also%20go%203%20cells%20forward%20each%20step%2C%20being%20able%20to%20reach%20cell%201%2C%203%2C%204%2C%205%2C%206%2C%207%2C%208%2C%209%2C%2010.%20So%20the%20most%20valuable%20tresure%20is%20100.%5Cn%5CnNoticed%20that%20she%20took%20the%2055%20dollars%20and%20100%20dollars%20treasure%20away%2C%20so%20the%20last%20answer%20is%2050.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B3000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F311%5C%2FC%22%2C%22id%22%3A%22311C%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A5%2C%22totalAccepted%22%3A2%2C%22pid%22%3A%22CF311C%22%2C%22title%22%3A%22Fetch%20the%20Treasure%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Fetch%20the%20Treasure%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Fetch the Treasure</h1>
<h2>题目描述</h2>
<div>Rainbow built $ h $ cells in a row that are numbered from 1 to $ h $ from left to right. There are $ n $ cells with treasure. We call each of these $ n $ cells "Treasure Cell". The $ i $ -th "Treasure Cell" is the $ a_{i} $ -th cell and the value of treasure in it is $ c_{i} $ dollars.
Then, Freda went in the first cell. For now, she can go just $ k $ cells forward, or return to the first cell. That means Freda was able to reach the 1st, ( $ k+1 $ )-th, ( $ 2·k+1 $ )-th, ( $ 3·k+1 $ )-th cells and so on.
Then Rainbow gave Freda $ m $ operations. Each operation is one of the following three types:
1. Add another method $ x $ : she can also go just $ x $ cells forward at any moment. For example, initially she has only one method $ k $ . If at some moment she has methods $ a_{1},a_{2},...,a_{r} $ then she can reach all the cells with number in form ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF311C/098e382b3b8846367b54760ca19a29ffa8e34102.png), where $ v_{i} $ — some non-negative integer.
2. Reduce the value of the treasure in the $ x $ -th "Treasure Cell" by $ y $ dollars. In other words, to apply assignment $ c_{x}=c_{x}-y $ .
3. Ask the value of the most valuable treasure among the cells Freda can reach. If Freda cannot reach any cell with the treasure then consider the value of the most valuable treasure equal to 0, and do nothing. Otherwise take the most valuable treasure away. If several "Treasure Cells" have the most valuable treasure, take the "Treasure Cell" with the minimum number (not necessarily with the minimum number of cell). After that the total number of cells with a treasure is decreased by one.
As a programmer, you are asked by Freda to write a program to answer each query.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line of the input contains four integers: $ h (1<=h<=10^{18}),n,m (1<=n,m<=10^{5}) $ and $ k (1<=k<=10^{4}) $ .
Each of the next $ n $ lines contains two integers: $ a_{i} (1<=a_{i}<=h),c_{i} (1<=c_{i}<=10^{9}) $ . That means the $ i $ -th "Treasure Cell" is the $ a_{i} $ -th cell and cost of the treasure in that cell is $ c_{i} $ dollars. All the $ a_{i} $ are distinct.
Each of the next $ m $ lines is in one of the three following formats:
- "1 $ x $ " — an operation of type 1, $ 1<=x<=h $ ;
- "2 $ x $ $ y $ " — an operation of type 2, $ 1<=x<=n,0<=y&lt;c_{x} $ ;
- "3" — an operation of type 3.
There are at most 20 operations of type 1. It's guaranteed that at any moment treasure in each cell has positive value. It's guaranteed that all operations is correct (no operation can decrease the value of the taken tresure).
Please, do not use the %lld specifier to read 64-bit integers in С++. It is preferred to use the cin, cout streams or the %I64d specifier.</div>
<h3>输出格式</h3>
<br />
<div>For each operation of type 3, output an integer indicates the value (in dollars) of the most valuable treasure among the "Treasure Cells" Freda can reach. If there is no such treasure, output 0.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>10 3 5 2
5 50
7 60
8 100
2 2 5
3
1 3
3
3
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>55
100
50
</code></pre>
<h2>说明</h2>
<div>In the sample, there are 10 cells and 3 "Treasure Cells". The first "Treasure Cell" is cell 5, having 50 dollars tresure in it. The second "Treasure Cell" is cell 7, having 60 dollars tresure in it. The third "Treasure Cell" is cell 8, having 100 dollars tresure in it.
At first, Freda can only reach cell 1, 3, 5, 7 and 9. In the first operation, we reduce the value in the second "Treasure Cell" from 60 to 55. Then the most valuable treasure among the "Treasure Cells" she can reach is max(50, 55) = 55. After the third operation, she can also go 3 cells forward each step, being able to reach cell 1, 3, 4, 5, 6, 7, 8, 9, 10. So the most valuable tresure is 100.
Noticed that she took the 55 dollars and 100 dollars treasure away, so the last answer is 50.</div>
</article>
</div>
</div>
</body>
</html>
