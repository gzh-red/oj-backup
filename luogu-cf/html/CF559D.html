<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Randomizer - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573395419:l3xNHTVhdH3ObYN9XrtPMZtEGMm622rycriuf1s/ro8=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Gerald%20got%20tired%20of%20playing%20board%20games%20with%20the%20usual%20six-sided%20die%2C%20and%20he%20bought%20a%20toy%20called%20Randomizer.%20It%20functions%20as%20follows.%5Cn%5CnA%20Randomizer%20has%20its%20own%20coordinate%20plane%20on%20which%20a%20strictly%20convex%20polygon%20is%20painted%2C%20the%20polygon%20is%20called%20a%20basic%20polygon.%20If%20you%20shake%20a%20Randomizer%2C%20it%20draws%20some%20nondegenerate%20%28i.e.%20having%20a%20non-zero%20area%29%20convex%20polygon%20with%20vertices%20at%20some%20vertices%20of%20the%20basic%20polygon.%20The%20result%20of%20the%20roll%20%28more%20precisely%2C%20the%20result%20of%20the%20shaking%29%20is%20considered%20to%20be%20the%20number%20of%20points%20with%20integer%20coordinates%2C%20which%20were%20strictly%20inside%20%28the%20points%20on%20the%20border%20are%20not%20considered%29%20the%20selected%20polygon.%20Now%20Gerald%20is%20wondering%3A%20what%20is%20the%20expected%20result%20of%20shaking%20the%20Randomizer%3F%5Cn%5CnDuring%20the%20shaking%20the%20Randomizer%20considers%20all%20the%20possible%20non-degenerate%20convex%20polygons%20with%20vertices%20at%20the%20vertices%20of%20the%20basic%20polygon.%20Let%27s%20assume%20that%20there%20are%20%24%20k%20%24%20versions%20of%20the%20polygons.%20Then%20the%20Randomizer%20chooses%20each%20of%20them%20with%20probability%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF559D%5C%2Fc9da31f8c8033753f5308fd004cfbd8168d1a574.png%29.%22%2C%22inputFormat%22%3A%22The%20first%20line%20of%20the%20input%20contains%20a%20single%20integer%20%24%20n%20%24%20%28%20%24%203%3C%3Dn%3C%3D100000%20%24%20%29%20%5Cu2014%20the%20number%20of%20vertices%20of%20the%20basic%20polygon.%5Cn%5CnNext%20%24%20n%20%24%20lines%20contain%20the%20coordinates%20of%20the%20vertices%20of%20the%20basic%20polygon.%20The%20%24%20i%20%24%20-th%20of%20these%20lines%20contain%20two%20integers%20%24%20x_%7Bi%7D%20%24%20and%20%24%20y_%7Bi%7D%20%24%20%28%20%24%20-10%5E%7B9%7D%3C%3Dx_%7Bi%7D%2Cy_%7Bi%7D%3C%3D10%5E%7B9%7D%20%24%20%29%20%5Cu2014%20the%20coordinates%20of%20the%20%24%20i%20%24%20-th%20vertex%20of%20the%20polygon.%20The%20vertices%20are%20given%20in%20the%20counter-clockwise%20order.%22%2C%22outputFormat%22%3A%22Print%20the%20sought%20expected%20value%20with%20absolute%20or%20relative%20error%20at%20most%20%24%2010%5E%7B-9%7D%20%24%20.%22%2C%22samples%22%3A%5B%5B%224%5Cn0%200%5Cn2%200%5Cn2%202%5Cn0%202%5Cn%22%2C%220.2%5Cn%22%5D%2C%5B%225%5Cn0%200%5Cn2%200%5Cn2%202%5Cn1%203%5Cn0%202%5Cn%22%2C%220.8125%5Cn%22%5D%5D%2C%22hint%22%3A%22A%20polygon%20is%20called%20strictly%20convex%20if%20it%20is%20convex%20and%20no%20its%20vertices%20lie%20on%20the%20same%20line.%5Cn%5CnLet%27s%20assume%20that%20a%20random%20variable%20takes%20values%20%24%20x_%7B1%7D%2C...%2Cx_%7Bn%7D%20%24%20with%20probabilities%20%24%20p_%7B1%7D%2C...%2Cp_%7Bn%7D%20%24%20%2C%20correspondingly.%20Then%20the%20expected%20value%20of%20this%20variable%20equals%20to%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF559D%5C%2Ff1a68c52683f379ee85c1225699ddf4672b65039.png%29.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2500%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F559%5C%2FD%22%2C%22id%22%3A%22559D%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A20%2C%22totalAccepted%22%3A7%2C%22pid%22%3A%22CF559D%22%2C%22title%22%3A%22Randomizer%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Randomizer%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573306449;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Randomizer</h1>
<h2>题目描述</h2>
<div>Gerald got tired of playing board games with the usual six-sided die, and he bought a toy called Randomizer. It functions as follows.
A Randomizer has its own coordinate plane on which a strictly convex polygon is painted, the polygon is called a basic polygon. If you shake a Randomizer, it draws some nondegenerate (i.e. having a non-zero area) convex polygon with vertices at some vertices of the basic polygon. The result of the roll (more precisely, the result of the shaking) is considered to be the number of points with integer coordinates, which were strictly inside (the points on the border are not considered) the selected polygon. Now Gerald is wondering: what is the expected result of shaking the Randomizer?
During the shaking the Randomizer considers all the possible non-degenerate convex polygons with vertices at the vertices of the basic polygon. Let's assume that there are $ k $ versions of the polygons. Then the Randomizer chooses each of them with probability ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF559D/c9da31f8c8033753f5308fd004cfbd8168d1a574.png).</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line of the input contains a single integer $ n $ ( $ 3<=n<=100000 $ ) — the number of vertices of the basic polygon.
Next $ n $ lines contain the coordinates of the vertices of the basic polygon. The $ i $ -th of these lines contain two integers $ x_{i} $ and $ y_{i} $ ( $ -10^{9}<=x_{i},y_{i}<=10^{9} $ ) — the coordinates of the $ i $ -th vertex of the polygon. The vertices are given in the counter-clockwise order.</div>
<h3>输出格式</h3>
<br />
<div>Print the sought expected value with absolute or relative error at most $ 10^{-9} $ .</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>4
0 0
2 0
2 2
0 2
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>0.2
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>5
0 0
2 0
2 2
1 3
0 2
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>0.8125
</code></pre>
<h2>说明</h2>
<div>A polygon is called strictly convex if it is convex and no its vertices lie on the same line.
Let's assume that a random variable takes values $ x_{1},...,x_{n} $ with probabilities $ p_{1},...,p_{n} $ , correspondingly. Then the expected value of this variable equals to ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF559D/f1a68c52683f379ee85c1225699ddf4672b65039.png).</div>
</article>
</div>
</div>
</body>
</html>
