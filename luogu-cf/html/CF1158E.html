<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Strange device - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573402437:cjNiXncXamC2klxOMD1qQrZN422TBzQ5IAuOskR5g6A=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22It%20is%20an%20interactive%20problem.%5Cn%5CnVasya%20enjoys%20solving%20quizzes.%20He%20found%20a%20strange%20device%20and%20wants%20to%20know%20how%20it%20works.%5Cn%5CnThis%20device%20encrypted%20with%20the%20tree%20%28connected%20undirected%20graph%20without%20cycles%29%20with%20%24%20n%20%24%20vertices%2C%20numbered%20with%20integers%20from%20%24%201%20%24%20to%20%24%20n%20%24%20.%20To%20solve%20this%20quiz%20you%20should%20guess%20this%20tree.%5Cn%5CnFortunately%2C%20this%20device%20can%20make%20one%20operation%2C%20using%20which%20you%20should%20guess%20the%20cipher.%20You%20can%20give%20the%20device%20an%20array%20%24%20d_1%2C%20d_2%2C%20%5C%5Cldots%2C%20d_n%20%24%20of%20non-negative%20integers.%20On%20the%20device%2C%20there%20are%20%24%20n%20%24%20lamps%2C%20%24%20i%20%24%20-th%20of%20them%20is%20connected%20with%20%24%20i%20%24%20-th%20vertex%20of%20the%20tree.%20For%20all%20%24%20i%20%24%20the%20light%20will%20turn%20on%20the%20%24%20i%20%24%20-th%20lamp%2C%20if%20there%20exist%20such%20vertex%20of%20the%20tree%20with%20number%20%24%20j%20%5C%5Cneq%20i%20%24%20that%20%24%20dist%28i%2C%20j%29%20%5C%5Cleq%20d_j%20%24%20.%20Let%27s%20define%20%24%20dist%28i%2C%20j%29%20%24%20as%20the%20distance%20between%20vertices%20%24%20i%20%24%20and%20%24%20j%20%24%20in%20tree%20or%20number%20of%20edges%20on%20the%20simple%20path%20between%20vertices%20%24%20i%20%24%20and%20%24%20j%20%24%20.%5Cn%5CnVasya%20wants%20to%20solve%20this%20quiz%20using%20%24%20%5C%5Cleq%2080%20%24%20operations%20with%20the%20device%20and%20guess%20the%20tree.%20Help%20him%21%22%2C%22inputFormat%22%3A%22%22%2C%22outputFormat%22%3A%22In%20the%20beginning%2C%20your%20program%20should%20read%20one%20integer%20%24%20n%20%24%20%5Cu2014%20the%20number%20of%20vertices%20of%20the%20tree%20which%20encrypts%20the%20device%20%28%20%24%202%20%5C%5Cleq%20n%20%5C%5Cleq%201000%20%24%20%29.%5Cn%5CnAfter%20that%2C%20you%20can%20make%20several%20operations%20in%20the%20following%20format.%20To%20do%20operation%20print%20a%20symbol%5C%22%3F%5C%22%20%28without%20quotes%29%20and%20%24%20n%20%24%20integers%20%24%20d_1%2C%20d_2%2C%20%5C%5Cldots%2C%20d_n%20%24%20%2C%20separated%20by%20spaces%20after%20it.%20Please%20note%2C%20that%20for%20all%20%24%20i%20%24%20you%20can%20only%20use%20the%20numbers%2C%20satisfying%20the%20inequality%20%24%200%20%5C%5Cleq%20d_i%20%3C%20n%20%24%20.%20After%20that%2C%20you%20should%20read%20a%20string%20%24%20s%20%24%20with%20length%20%24%20n%20%24%20%2C%20consisting%20of%20symbols%20%5C%220%5C%22%20and%20%5C%221%5C%22%20%28without%20quotes%29.%20For%20all%20%24%20i%20%24%20the%20symbol%20%24%20s_i%20%24%20is%20equal%20to%20%5C%220%5C%22%2C%20if%20the%20lamp%20on%20the%20device%2C%20connected%20with%20%24%20i%20%24%20-th%20vertex%20of%20the%20tree%20is%20switched%20off%20and%20%5C%221%5C%22%20otherwise.%5Cn%5CnAfter%20several%20operations%2C%20you%20should%20print%20guessed%20tree.%20To%20do%20it%20print%20the%20only%20symbol%20%5C%22%21%5C%22%20%28without%20quotes%29.%20In%20the%20next%20%24%20n-1%20%24%20lines%20print%20%24%202%20%24%20integers%20%24%20a_i%20%24%20%2C%20%24%20b_i%20%24%20%5Cu2014%20indexes%20of%20the%20vertices%20connected%20by%20%24%20i%20%24%20-th%20edge%20of%20the%20tree.%20This%20numbers%20should%20satisfy%20the%20conditions%20%24%201%20%5C%5Cleq%20a_i%2C%20b_i%20%5C%5Cleq%20n%20%24%20and%20%24%20a_i%20%5C%5Cneq%20b_i%20%24%20.%20This%20edges%20should%20form%20a%20tree%2C%20which%20is%20equal%20to%20the%20hidden%20tree.%20After%20that%2C%20your%20program%20should%20terminate.%5Cn%5CnIt%20is%20guaranteed%2C%20that%20in%20each%20test%20the%20tree%20is%20fixed%20before%20and%20won%27t%20change%20depending%20on%20your%20program%27s%20operations.%5Cn%5CnYour%20program%20can%20make%20from%20%24%200%20%24%20to%20%24%2080%20%24%20operations%20with%20the%20device%20and%20after%20that%20guess%20the%20tree%20equal%20with%20the%20hidden.%5Cn%5CnIf%20your%20program%20will%20make%20more%20than%20%24%2080%20%24%20operations%20it%20can%20get%20any%20verdict%2C%20because%20it%20will%20continue%20reading%20from%20closed%20input.%20If%20your%20program%20will%20make%20operation%20or%20print%20the%20answer%20in%20the%20incorrect%20format%2C%20it%20can%20get%20any%20verdict%20too.%20Be%20careful.%5Cn%5CnDon%27t%20forget%20to%20flush%20the%20output%20after%20printing%20questions%20and%20answers.%5Cn%5CnTo%20flush%20the%20output%2C%20you%20can%20use%3A%5Cn%5Cn-%20fflush%28stdout%29%20in%20C%2B%2B.%5Cn-%20System.out.flush%28%29%20in%20Java.%5Cn-%20stdout.flush%28%29%20in%20Python.%5Cn-%20flush%28output%29%20in%20Pascal.%5Cn-%20See%20the%20documentation%20for%20other%20languages.%5Cn%5CnHacks%3A%5Cn%5CnThe%20first%20line%20should%20contain%20one%20integer%20%24%20n%20%24%20%5Cu2014%20the%20number%20of%20vertices%20in%20the%20tree%20%28%20%24%202%20%5C%5Cleq%20n%20%5C%5Cleq%201000%20%24%20%29.%20Next%20%24%20n-1%20%24%20lines%20should%20contain%20%24%202%20%24%20integers%20%24%20a_i%20%24%20%2C%20%24%20b_i%20%24%20%5Cu2014%20indexes%20of%20the%20vertices%20connected%20by%20%24%20i%20%24%20-th%20edge%20of%20the%20tree%20%28%20%24%201%20%5C%5Cleq%20a_i%2C%20b_i%20%5C%5Cleq%20n%20%24%20%2C%20%24%20a_i%20%5C%5Cneq%20b_i%20%24%20%29.%20All%20edges%20should%20form%20a%20tree.%20Be%20careful%2C%20extra%20spaces%20or%20line%20breaks%20are%20not%20allowed.%22%2C%22samples%22%3A%5B%5B%22%5Cn5%5Cn00000%5Cn11011%5Cn11100%5Cn10010%5Cn%22%2C%22%5Cn%3F%200%200%200%200%200%5Cn%3F%201%201%202%200%202%5Cn%3F%200%200%200%201%200%5Cn%3F%200%201%200%200%201%5Cn%21%5Cn4%202%5Cn1%205%5Cn3%204%5Cn4%201%5Cn%22%5D%5D%2C%22hint%22%3A%22It%20is%20a%20picture%20of%20the%20tree%20which%20encrypt%20the%20device%20from%20the%20first%20test%3A%5Cn%5Cn%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF1158E%5C%2F49feda26c6ab42ad6bf8ea93464afdde9148e9e4.png%29It%20is%20a%20table%20of%20pairwise%20distances%20between%20vertices%20in%20this%20tree%3A%5Cn%5Cn%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF1158E%5C%2F505c2c0eeb02493edd124bbe23dc1c6a78b0e062.png%29-%20If%20you%20make%20operation%20where%20%24%20d%20%3D%20%5B0%2C%200%2C%200%2C%200%2C%200%5D%20%24%20%2C%20no%20lamp%20will%20switch%20on%2C%20because%20%24%20dist%28i%2C%20j%29%20%3E%200%20%24%20for%20all%20%24%20i%20%5C%5Cneq%20j%20%24%20.%5Cn-%20If%20you%20make%20operation%20where%20%24%20d%20%3D%20%5B1%2C%201%2C%202%2C%200%2C%202%5D%20%24%20%2C%20all%20lamps%20except%20the%20lamp%20connected%20with%20the%20%24%203%20%24%20-rd%20vertex%20will%20switch%20on.%20For%20example%2C%20lamp%20connected%20with%20the%20%24%201%20%24%20-st%20vertex%20will%20switch%20on%2C%20because%20%24%20dist%281%2C%205%29%20%3D%201%20%5C%5Cleq%202%20%3D%20d_5%20%24%20.%5Cn-%20If%20you%20make%20operation%20where%20%24%20d%20%3D%20%5B0%2C%200%2C%200%2C%201%2C%200%5D%20%24%20%2C%20all%20lamps%20except%20lamps%20connected%20with%20the%20%24%204%20%24%20-th%20and%20%24%205%20%24%20-th%20vertices%20will%20switch%20on.%5Cn-%20If%20you%20make%20operation%20where%20%24%20d%20%3D%20%5B0%2C%201%2C%200%2C%200%2C%201%5D%20%24%20%2C%20only%20lamps%20connected%20with%20the%20%24%201%20%24%20-st%20and%20%24%204%20%24%20-th%20vertices%20will%20switch%20on.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F1158%5C%2FE%22%2C%22id%22%3A%221158E%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A6%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22CF1158E%22%2C%22title%22%3A%22Strange%20device%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Strange%20device%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Strange device</h1>
<h2>题目描述</h2>
<div>It is an interactive problem.
Vasya enjoys solving quizzes. He found a strange device and wants to know how it works.
This device encrypted with the tree (connected undirected graph without cycles) with $ n $ vertices, numbered with integers from $ 1 $ to $ n $ . To solve this quiz you should guess this tree.
Fortunately, this device can make one operation, using which you should guess the cipher. You can give the device an array $ d_1, d_2, \ldots, d_n $ of non-negative integers. On the device, there are $ n $ lamps, $ i $ -th of them is connected with $ i $ -th vertex of the tree. For all $ i $ the light will turn on the $ i $ -th lamp, if there exist such vertex of the tree with number $ j \neq i $ that $ dist(i, j) \leq d_j $ . Let's define $ dist(i, j) $ as the distance between vertices $ i $ and $ j $ in tree or number of edges on the simple path between vertices $ i $ and $ j $ .
Vasya wants to solve this quiz using $ \leq 80 $ operations with the device and guess the tree. Help him!</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div></div>
<h3>输出格式</h3>
<br />
<div>In the beginning, your program should read one integer $ n $ — the number of vertices of the tree which encrypts the device ( $ 2 \leq n \leq 1000 $ ).
After that, you can make several operations in the following format. To do operation print a symbol"?" (without quotes) and $ n $ integers $ d_1, d_2, \ldots, d_n $ , separated by spaces after it. Please note, that for all $ i $ you can only use the numbers, satisfying the inequality $ 0 \leq d_i < n $ . After that, you should read a string $ s $ with length $ n $ , consisting of symbols "0" and "1" (without quotes). For all $ i $ the symbol $ s_i $ is equal to "0", if the lamp on the device, connected with $ i $ -th vertex of the tree is switched off and "1" otherwise.
After several operations, you should print guessed tree. To do it print the only symbol "!" (without quotes). In the next $ n-1 $ lines print $ 2 $ integers $ a_i $ , $ b_i $ — indexes of the vertices connected by $ i $ -th edge of the tree. This numbers should satisfy the conditions $ 1 \leq a_i, b_i \leq n $ and $ a_i \neq b_i $ . This edges should form a tree, which is equal to the hidden tree. After that, your program should terminate.
It is guaranteed, that in each test the tree is fixed before and won't change depending on your program's operations.
Your program can make from $ 0 $ to $ 80 $ operations with the device and after that guess the tree equal with the hidden.
If your program will make more than $ 80 $ operations it can get any verdict, because it will continue reading from closed input. If your program will make operation or print the answer in the incorrect format, it can get any verdict too. Be careful.
Don't forget to flush the output after printing questions and answers.
To flush the output, you can use:
- fflush(stdout) in C++.
- System.out.flush() in Java.
- stdout.flush() in Python.
- flush(output) in Pascal.
- See the documentation for other languages.
Hacks:
The first line should contain one integer $ n $ — the number of vertices in the tree ( $ 2 \leq n \leq 1000 $ ). Next $ n-1 $ lines should contain $ 2 $ integers $ a_i $ , $ b_i $ — indexes of the vertices connected by $ i $ -th edge of the tree ( $ 1 \leq a_i, b_i \leq n $ , $ a_i \neq b_i $ ). All edges should form a tree. Be careful, extra spaces or line breaks are not allowed.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>
5
00000
11011
11100
10010
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>
? 0 0 0 0 0
? 1 1 2 0 2
? 0 0 0 1 0
? 0 1 0 0 1
!
4 2
1 5
3 4
4 1
</code></pre>
<h2>说明</h2>
<div>It is a picture of the tree which encrypt the device from the first test:
![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1158E/49feda26c6ab42ad6bf8ea93464afdde9148e9e4.png)It is a table of pairwise distances between vertices in this tree:
![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1158E/505c2c0eeb02493edd124bbe23dc1c6a78b0e062.png)- If you make operation where $ d = [0, 0, 0, 0, 0] $ , no lamp will switch on, because $ dist(i, j) > 0 $ for all $ i \neq j $ .
- If you make operation where $ d = [1, 1, 2, 0, 2] $ , all lamps except the lamp connected with the $ 3 $ -rd vertex will switch on. For example, lamp connected with the $ 1 $ -st vertex will switch on, because $ dist(1, 5) = 1 \leq 2 = d_5 $ .
- If you make operation where $ d = [0, 0, 0, 1, 0] $ , all lamps except lamps connected with the $ 4 $ -th and $ 5 $ -th vertices will switch on.
- If you make operation where $ d = [0, 1, 0, 0, 1] $ , only lamps connected with the $ 1 $ -st and $ 4 $ -th vertices will switch on.</div>
</article>
</div>
</div>
</body>
</html>
