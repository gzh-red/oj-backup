<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Mahmoud and a Dictionary - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573397624:CTu3W/HzzXwC7fC36PSDiOUZOgZmQak0/aEEgZTeA+o=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Mahmoud%20wants%20to%20write%20a%20new%20dictionary%20that%20contains%20%24%20n%20%24%20words%20and%20relations%20between%20them.%20There%20are%20two%20types%20of%20relations%3A%20synonymy%20%28i.%20e.%20the%20two%20words%20mean%20the%20same%29%20and%20antonymy%20%28i.%20e.%20the%20two%20words%20mean%20the%20opposite%29.%20From%20time%20to%20time%20he%20discovers%20a%20new%20relation%20between%20two%20words.%5Cn%5CnHe%20know%20that%20if%20two%20words%20have%20a%20relation%20between%20them%2C%20then%20each%20of%20them%20has%20relations%20with%20the%20words%20that%20has%20relations%20with%20the%20other.%20For%20example%2C%20if%20like%20means%20love%20and%20love%20is%20the%20opposite%20of%20hate%2C%20then%20like%20is%20also%20the%20opposite%20of%20hate.%20One%20more%20example%3A%20if%20love%20is%20the%20opposite%20of%20hate%20and%20hate%20is%20the%20opposite%20of%20like%2C%20then%20love%20means%20like%2C%20and%20so%20on.%5Cn%5CnSometimes%20Mahmoud%20discovers%20a%20wrong%20relation.%20A%20wrong%20relation%20is%20a%20relation%20that%20makes%20two%20words%20equal%20and%20opposite%20at%20the%20same%20time.%20For%20example%20if%20he%20knows%20that%20love%20means%20like%20and%20like%20is%20the%20opposite%20of%20hate%2C%20and%20then%20he%20figures%20out%20that%20hate%20means%20like%2C%20the%20last%20relation%20is%20absolutely%20wrong%20because%20it%20makes%20hate%20and%20like%20opposite%20and%20have%20the%20same%20meaning%20at%20the%20same%20time.%5Cn%5CnAfter%20Mahmoud%20figured%20out%20many%20relations%2C%20he%20was%20worried%20that%20some%20of%20them%20were%20wrong%20so%20that%20they%20will%20make%20other%20relations%20also%20wrong%2C%20so%20he%20decided%20to%20tell%20every%20relation%20he%20figured%20out%20to%20his%20coder%20friend%20Ehab%20and%20for%20every%20relation%20he%20wanted%20to%20know%20is%20it%20correct%20or%20wrong%2C%20basing%20on%20the%20previously%20discovered%20relations.%20If%20it%20is%20wrong%20he%20ignores%20it%2C%20and%20doesn%27t%20check%20with%20following%20relations.%5Cn%5CnAfter%20adding%20all%20relations%2C%20Mahmoud%20asked%20Ehab%20about%20relations%20between%20some%20words%20based%20on%20the%20information%20he%20had%20given%20to%20him.%20Ehab%20is%20busy%20making%20a%20Codeforces%20round%20so%20he%20asked%20you%20for%20help.%22%2C%22inputFormat%22%3A%22The%20first%20line%20of%20input%20contains%20three%20integers%20%24%20n%20%24%20%2C%20%24%20m%20%24%20and%20%24%20q%20%24%20%28%20%24%202%3C%3Dn%3C%3D10%5E%7B5%7D%20%24%20%2C%20%24%201%3C%3Dm%2Cq%3C%3D10%5E%7B5%7D%20%24%20%29%20where%20%24%20n%20%24%20is%20the%20number%20of%20words%20in%20the%20dictionary%2C%20%24%20m%20%24%20is%20the%20number%20of%20relations%20Mahmoud%20figured%20out%20and%20%24%20q%20%24%20is%20the%20number%20of%20questions%20Mahmoud%20asked%20after%20telling%20all%20relations.%5Cn%5CnThe%20second%20line%20contains%20%24%20n%20%24%20distinct%20words%20%24%20a_%7B1%7D%2Ca_%7B2%7D%2C...%2Ca_%7Bn%7D%20%24%20consisting%20of%20small%20English%20letters%20with%20length%20not%20exceeding%20%24%2020%20%24%20%2C%20which%20are%20the%20words%20in%20the%20dictionary.%5Cn%5CnThen%20%24%20m%20%24%20lines%20follow%2C%20each%20of%20them%20contains%20an%20integer%20%24%20t%20%24%20%28%20%24%201%3C%3Dt%3C%3D2%20%24%20%29%20followed%20by%20two%20different%20words%20%24%20x_%7Bi%7D%20%24%20and%20%24%20y_%7Bi%7D%20%24%20which%20has%20appeared%20in%20the%20dictionary%20words.%20If%20%24%20t%3D1%20%24%20%2C%20that%20means%20%24%20x_%7Bi%7D%20%24%20has%20a%20synonymy%20relation%20with%20%24%20y_%7Bi%7D%20%24%20%2C%20otherwise%20%24%20x_%7Bi%7D%20%24%20has%20an%20antonymy%20relation%20with%20%24%20y_%7Bi%7D%20%24%20.%5Cn%5CnThen%20%24%20q%20%24%20lines%20follow%2C%20each%20of%20them%20contains%20two%20different%20words%20which%20has%20appeared%20in%20the%20dictionary.%20That%20are%20the%20pairs%20of%20words%20Mahmoud%20wants%20to%20know%20the%20relation%20between%20basing%20on%20the%20relations%20he%20had%20discovered.%5Cn%5CnAll%20words%20in%20input%20contain%20only%20lowercase%20English%20letters%20and%20their%20lengths%20don%27t%20exceed%20%24%2020%20%24%20characters.%20In%20all%20relations%20and%20in%20all%20questions%20the%20two%20words%20are%20different.%22%2C%22outputFormat%22%3A%22First%2C%20print%20%24%20m%20%24%20lines%2C%20one%20per%20each%20relation.%20If%20some%20relation%20is%20wrong%20%28makes%20two%20words%20opposite%20and%20have%20the%20same%20meaning%20at%20the%20same%20time%29%20you%20should%20print%20%5C%22NO%5C%22%20%28without%20quotes%29%20and%20ignore%20it%2C%20otherwise%20print%20%5C%22YES%5C%22%20%28without%20quotes%29.%5Cn%5CnAfter%20that%20print%20%24%20q%20%24%20lines%2C%20one%20per%20each%20question.%20If%20the%20two%20words%20have%20the%20same%20meaning%2C%20output%20%24%201%20%24%20.%20If%20they%20are%20opposites%2C%20output%20%24%202%20%24%20.%20If%20there%20is%20no%20relation%20between%20them%2C%20output%20%24%203%20%24%20.%5Cn%5CnSee%20the%20samples%20for%20better%20understanding.%22%2C%22samples%22%3A%5B%5B%223%203%204%5Cnhate%20love%20like%5Cn1%20love%20like%5Cn2%20love%20hate%5Cn1%20hate%20like%5Cnlove%20like%5Cnlove%20hate%5Cnlike%20hate%5Cnhate%20like%5Cn%22%2C%22YES%5CnYES%5CnNO%5Cn1%5Cn2%5Cn2%5Cn2%5Cn%22%5D%2C%5B%228%206%205%5Cnhi%20welcome%20hello%20ihateyou%20goaway%20dog%20cat%20rat%5Cn1%20hi%20welcome%5Cn1%20ihateyou%20goaway%5Cn2%20hello%20ihateyou%5Cn2%20hi%20goaway%5Cn2%20hi%20hello%5Cn1%20hi%20hello%5Cndog%20cat%5Cndog%20hi%5Cnhi%20hello%5Cnihateyou%20goaway%5Cnwelcome%20ihateyou%5Cn%22%2C%22YES%5CnYES%5CnYES%5CnYES%5CnNO%5CnYES%5Cn3%5Cn3%5Cn1%5Cn1%5Cn2%5Cn%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B4000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F766%5C%2FD%22%2C%22id%22%3A%22766D%22%7D%2C%22translation%22%3A%22%5Cr%5Cn%5Cu7ed9%5Cu4e00%5Cu4e9b%5Cu5355%5Cu8bcd%5Cuff0c%5Cu5b83%5Cu4eec%5Cu53ef%5Cu80fd%5Cu662f%5Cu540c%5Cu4e49%5Cu6216%5Cu8005%5Cu53cd%5Cu4e49%5Cuff0c%5Cu7ed9%5Cu51fa%5Cu4e00%5Cu4e9b%5Cu5173%5Cu7cfb%5Cu5b9a%5Cu4e49%5Cuff0c%5Cu4ece%5Cu524d%5Cu9762%5Cu7684%5Cu5b9a%5Cu4e49%5Cu5f00%5Cu59cb%5Cu5efa%5Cu7acb%5Cu5173%5Cu7cfb%5Cuff0c%5Cu5982%5Cu679c%5Cu6709%5Cu7684%5Cu5173%5Cu7cfb%5Cu5b9a%5Cu4e49%5Cu548c%5Cu4e4b%5Cu524d%5Cu7684%5Cu51b2%5Cu7a81%5Cu8f93%5Cu51faNO%2C%5Cu5426%5Cu5219%5Cu8f93%5Cu51faYES%5Cu3002%5Cu7136%5Cu540e%5Cu67e5%5Cu8be2q%5Cu6b21%5Cu5355%5Cu8bcdx%5Cu548c%5Cu5355%5Cu8bcdy%5Cu7684%5Cu5173%5Cu7cfb%5Cu3002%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A58%2C%22totalAccepted%22%3A28%2C%22pid%22%3A%22CF766D%22%2C%22title%22%3A%22Mahmoud%20and%20a%20Dictionary%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P2607%22%2C%22title%22%3A%22%5BZJOI2008%5D%5Cu9a91%5Cu58eb%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P4015%22%2C%22title%22%3A%22%5Cu8fd0%5Cu8f93%5Cu95ee%5Cu9898%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22CF901C%22%2C%22title%22%3A%22Bipartite%20Segments%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF734F%22%2C%22title%22%3A%22Anton%20and%20School%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22UVA1185%22%2C%22title%22%3A%22Big%20Number%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22UVA%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Mahmoud%20and%20a%20Dictionary%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573306449;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Mahmoud and a Dictionary</h1>
<h2>题意翻译</h2>
<div>
给一些单词，它们可能是同义或者反义，给出一些关系定义，从前面的定义开始建立关系，如果有的关系定义和之前的冲突输出NO,否则输出YES。然后查询q次单词x和单词y的关系。</div>
<h2>题目描述</h2>
<div>Mahmoud wants to write a new dictionary that contains $ n $ words and relations between them. There are two types of relations: synonymy (i. e. the two words mean the same) and antonymy (i. e. the two words mean the opposite). From time to time he discovers a new relation between two words.
He know that if two words have a relation between them, then each of them has relations with the words that has relations with the other. For example, if like means love and love is the opposite of hate, then like is also the opposite of hate. One more example: if love is the opposite of hate and hate is the opposite of like, then love means like, and so on.
Sometimes Mahmoud discovers a wrong relation. A wrong relation is a relation that makes two words equal and opposite at the same time. For example if he knows that love means like and like is the opposite of hate, and then he figures out that hate means like, the last relation is absolutely wrong because it makes hate and like opposite and have the same meaning at the same time.
After Mahmoud figured out many relations, he was worried that some of them were wrong so that they will make other relations also wrong, so he decided to tell every relation he figured out to his coder friend Ehab and for every relation he wanted to know is it correct or wrong, basing on the previously discovered relations. If it is wrong he ignores it, and doesn't check with following relations.
After adding all relations, Mahmoud asked Ehab about relations between some words based on the information he had given to him. Ehab is busy making a Codeforces round so he asked you for help.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line of input contains three integers $ n $ , $ m $ and $ q $ ( $ 2<=n<=10^{5} $ , $ 1<=m,q<=10^{5} $ ) where $ n $ is the number of words in the dictionary, $ m $ is the number of relations Mahmoud figured out and $ q $ is the number of questions Mahmoud asked after telling all relations.
The second line contains $ n $ distinct words $ a_{1},a_{2},...,a_{n} $ consisting of small English letters with length not exceeding $ 20 $ , which are the words in the dictionary.
Then $ m $ lines follow, each of them contains an integer $ t $ ( $ 1<=t<=2 $ ) followed by two different words $ x_{i} $ and $ y_{i} $ which has appeared in the dictionary words. If $ t=1 $ , that means $ x_{i} $ has a synonymy relation with $ y_{i} $ , otherwise $ x_{i} $ has an antonymy relation with $ y_{i} $ .
Then $ q $ lines follow, each of them contains two different words which has appeared in the dictionary. That are the pairs of words Mahmoud wants to know the relation between basing on the relations he had discovered.
All words in input contain only lowercase English letters and their lengths don't exceed $ 20 $ characters. In all relations and in all questions the two words are different.</div>
<h3>输出格式</h3>
<br />
<div>First, print $ m $ lines, one per each relation. If some relation is wrong (makes two words opposite and have the same meaning at the same time) you should print "NO" (without quotes) and ignore it, otherwise print "YES" (without quotes).
After that print $ q $ lines, one per each question. If the two words have the same meaning, output $ 1 $ . If they are opposites, output $ 2 $ . If there is no relation between them, output $ 3 $ .
See the samples for better understanding.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>3 3 4
hate love like
1 love like
2 love hate
1 hate like
love like
love hate
like hate
hate like
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>YES
YES
NO
1
2
2
2
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>8 6 5
hi welcome hello ihateyou goaway dog cat rat
1 hi welcome
1 ihateyou goaway
2 hello ihateyou
2 hi goaway
2 hi hello
1 hi hello
dog cat
dog hi
hi hello
ihateyou goaway
welcome ihateyou
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>YES
YES
YES
YES
NO
YES
3
3
1
1
2
</code></pre>
</article>
</div>
</div>
</body>
</html>
