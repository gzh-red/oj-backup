<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Lightsabers (hard) - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573399804:AayvAbRM595Ll1lPc2FqLA49xCudC2iPTQH+sj8xDf4=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22There%20used%20to%20be%20unrest%20in%20the%20Galactic%20Senate.%20Several%20thousand%20solar%20systems%20had%20declared%20their%20intentions%20to%20leave%20the%20Republic.%20But%20fear%20not%21%20Master%20Heidi%20was%20able%20to%20successfully%20select%20the%20Jedi%20Knights%20that%20have%20restored%20peace%20in%20the%20galaxy.%20However%2C%20she%20knows%20that%20evil%20never%20sleeps%20and%20a%20time%20may%20come%20when%20she%20will%20need%20to%20pick%20another%20group%20of%20Jedi%20Knights.%20She%20wants%20to%20be%20sure%20she%20has%20enough%20options%20to%20do%20so.%5Cn%5CnThere%20are%20%24%20n%20%24%20Jedi%20Knights%2C%20each%20of%20them%20with%20a%20lightsaber%20of%20one%20of%20%24%20m%20%24%20colors.%20Given%20a%20number%20%24%20k%20%24%20%2C%20compute%20the%20number%20of%20differently%20colored%20collections%20of%20%24%20k%20%24%20lightsabers%20that%20some%20%24%20k%20%24%20Jedi%20Knights%20might%20have.%20Jedi%20Knights%20with%20lightsabers%20of%20the%20same%20color%20are%20indistinguishable%20%28it%27s%20not%20the%20person%2C%20it%27s%20the%20lightsaber%20color%20that%20matters%21%29%2C%20and%20their%20order%20does%20not%20matter%3B%20that%20is%2C%20we%20consider%20two%20collections%20of%20Jedi%20Knights%20to%20be%20different%20if%20and%20only%20if%20their%20vectors%20of%20counts%20of%20lightsabers%20of%20each%20color%20%28like%20what%20you%20were%20given%20in%20the%20easy%20and%20the%20medium%20versions%29%20are%20different.%20We%20count%20all%20subsets%2C%20not%20only%20contiguous%20subsegments%20of%20the%20input%20sequence.%20Output%20the%20answer%20modulo%20%24%201009%20%24%20.%22%2C%22inputFormat%22%3A%22The%20first%20line%20of%20the%20input%20contains%20%24%20n%20%24%20%28%20%24%201%3C%3Dn%3C%3D2%5Cu00b710%5E%7B5%7D%20%24%20%29%2C%20%24%20m%20%24%20%28%20%24%201%3C%3Dm%3C%3Dn%20%24%20%29%20and%20%24%20k%20%24%20%28%20%24%201%3C%3Dk%3C%3Dn%20%24%20%29.%20The%20second%20line%20contains%20%24%20n%20%24%20integers%20in%20the%20range%20%24%20%7B1%2C2%2C...%2Cm%7D%20%24%20representing%20colors%20of%20the%20lightsabers%20of%20subsequent%20Jedi%20Knights.%22%2C%22outputFormat%22%3A%22Output%20one%20number%3A%20the%20number%20of%20differently%20colored%20collections%20of%20%24%20k%20%24%20lightsabers%20modulo%20%24%201009%20%24%20.%22%2C%22samples%22%3A%5B%5B%224%203%202%5Cn1%202%203%202%5Cn%22%2C%224%5Cn%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B4000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F958%5C%2FF3%22%2C%22id%22%3A%22958F3%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22CF958F3%22%2C%22title%22%3A%22Lightsabers%20%28hard%29%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Lightsabers%20%28hard%29%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Lightsabers (hard)</h1>
<h2>题目描述</h2>
<div>There used to be unrest in the Galactic Senate. Several thousand solar systems had declared their intentions to leave the Republic. But fear not! Master Heidi was able to successfully select the Jedi Knights that have restored peace in the galaxy. However, she knows that evil never sleeps and a time may come when she will need to pick another group of Jedi Knights. She wants to be sure she has enough options to do so.
There are $ n $ Jedi Knights, each of them with a lightsaber of one of $ m $ colors. Given a number $ k $ , compute the number of differently colored collections of $ k $ lightsabers that some $ k $ Jedi Knights might have. Jedi Knights with lightsabers of the same color are indistinguishable (it's not the person, it's the lightsaber color that matters!), and their order does not matter; that is, we consider two collections of Jedi Knights to be different if and only if their vectors of counts of lightsabers of each color (like what you were given in the easy and the medium versions) are different. We count all subsets, not only contiguous subsegments of the input sequence. Output the answer modulo $ 1009 $ .</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line of the input contains $ n $ ( $ 1<=n<=2·10^{5} $ ), $ m $ ( $ 1<=m<=n $ ) and $ k $ ( $ 1<=k<=n $ ). The second line contains $ n $ integers in the range $ {1,2,...,m} $ representing colors of the lightsabers of subsequent Jedi Knights.</div>
<h3>输出格式</h3>
<br />
<div>Output one number: the number of differently colored collections of $ k $ lightsabers modulo $ 1009 $ .</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>4 3 2
1 2 3 2
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>4
</code></pre>
</article>
</div>
</div>
</body>
</html>
