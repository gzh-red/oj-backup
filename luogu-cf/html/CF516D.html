<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Drazil and Morning Exercise - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573394983:nf1Hp0zYSHY8QrMr1r6GZzh4IYAODf0TyhBau9bxiOA=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Drazil%20and%20Varda%20are%20the%20earthworm%20couple.%20They%20want%20to%20find%20a%20good%20place%20to%20bring%20up%20their%20children.%20They%20found%20a%20good%20ground%20containing%20nature%20hole.%20The%20hole%20contains%20many%20rooms%2C%20some%20pairs%20of%20rooms%20are%20connected%20by%20small%20tunnels%20such%20that%20earthworm%20can%20move%20between%20them.%5Cn%5CnLet%27s%20consider%20rooms%20and%20small%20tunnels%20as%20the%20vertices%20and%20edges%20in%20a%20graph.%20This%20graph%20is%20a%20tree.%20In%20the%20other%20words%2C%20any%20pair%20of%20vertices%20has%20an%20unique%20path%20between%20them.%5Cn%5CnEach%20room%20that%20is%20leaf%20in%20the%20graph%20is%20connected%20with%20a%20ground%20by%20a%20vertical%20tunnel.%20Here%2C%20leaf%20is%20a%20vertex%20that%20has%20only%20one%20outgoing%20edge%20in%20the%20graph.%5Cn%5CnEach%20room%20is%20large%20enough%20only%20to%20fit%20one%20earthworm%20living%20in%20it.%20Earthworm%20can%27t%20live%20in%20a%20tunnel.%5Cn%5CnDrazil%20and%20Varda%20have%20a%20plan%20to%20educate%20their%20children.%20They%20want%20all%20their%20children%20to%20do%20morning%20exercises%20immediately%20after%20getting%20up%21%5Cn%5CnWhen%20the%20morning%20is%20coming%2C%20all%20earthworm%20children%20get%20up%20in%20the%20same%20time%2C%20then%20each%20of%20them%20chooses%20the%20farthest%20path%20to%20the%20ground%20for%20gathering%20with%20others%20%28these%20children%20are%20lazy%2C%20so%20they%20all%20want%20to%20do%20exercises%20as%20late%20as%20possible%29.%5Cn%5CnDrazil%20and%20Varda%20want%20the%20difference%20between%20the%20time%20first%20earthworm%20child%20arrives%20outside%20and%20the%20time%20the%20last%20earthworm%20child%20arrives%20outside%20to%20be%20not%20larger%20than%20%24%20l%20%24%20%28otherwise%20children%20will%20spread%20around%20the%20ground%20and%20it%20will%20be%20hard%20to%20keep%20them%20exercising%20together%29.%5Cn%5CnAlso%2C%20The%20rooms%20that%20are%20occupied%20by%20their%20children%20should%20form%20a%20connected%20set.%20In%20the%20other%20words%2C%20for%20any%20two%20rooms%20that%20are%20occupied%20with%20earthworm%20children%2C%20all%20rooms%20that%20lie%20on%20the%20path%20between%20them%20should%20be%20occupied%20with%20earthworm%20children%20too.%5Cn%5CnHow%20many%20children%20Drazil%20and%20Varda%20may%20have%20at%20most%20in%20order%20to%20satisfy%20all%20conditions%20above%3F%20Drazil%20and%20Varda%20want%20to%20know%20the%20answer%20for%20many%20different%20choices%20of%20%24%20l%20%24%20.%5Cn%5Cn%28Drazil%20and%20Varda%20don%27t%20live%20in%20the%20hole%20with%20their%20children%29%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20one%20integer%20%24%20n%20%24%20denoting%20how%20many%20rooms%20there%20are%20in%20the%20hole%20%28%20%24%202%3C%3Dn%3C%3D10%5E%7B5%7D%20%24%20%29.%5Cn%5CnThen%20there%20are%20%24%20n-1%20%24%20lines%20following.%20Each%20of%20these%20lines%20contains%20three%20integers%20%24%20x%20%24%20%2C%20%24%20y%20%24%20%2C%20%24%20v%20%24%20%28%20%24%201%3C%3Dx%2Cy%3C%3Dn%20%24%20%2C%20%24%201%3C%3Dv%3C%3D10%5E%7B6%7D%20%24%20%29%20denoting%20there%20is%20a%20small%20tunnel%20between%20room%20%24%20x%20%24%20and%20room%20%24%20y%20%24%20that%20takes%20time%20%24%20v%20%24%20to%20pass.%5Cn%5CnSuppose%20that%20the%20time%20for%20an%20earthworm%20to%20get%20out%20to%20the%20ground%20from%20any%20leaf%20room%20is%20the%20same.%5Cn%5CnThe%20next%20line%20contains%20an%20integer%20%24%20q%20%24%20%28%20%24%201%3C%3Dq%3C%3D50%20%24%20%29%2C%20denoting%20the%20number%20of%20different%20value%20of%20%24%20l%20%24%20you%20need%20to%20process.%5Cn%5CnThe%20last%20line%20contains%20%24%20q%20%24%20numbers%2C%20each%20number%20denoting%20a%20value%20of%20%24%20l%20%24%20%28%20%24%201%3C%3Dl%3C%3D10%5E%7B11%7D%20%24%20%29.%22%2C%22outputFormat%22%3A%22You%20should%20print%20%24%20q%20%24%20lines.%20Each%20line%20should%20contain%20one%20integer%20denoting%20the%20answer%20for%20a%20corresponding%20value%20of%20%24%20l%20%24%20.%22%2C%22samples%22%3A%5B%5B%225%5Cn1%202%203%5Cn2%203%204%5Cn4%205%203%5Cn3%204%202%5Cn5%5Cn1%202%203%204%205%5Cn%22%2C%221%5Cn3%5Cn3%5Cn3%5Cn5%5Cn%22%5D%2C%5B%2212%5Cn5%209%203%5Cn2%201%207%5Cn11%207%202%5Cn6%205%205%5Cn2%205%203%5Cn6%207%202%5Cn1%204%204%5Cn8%205%207%5Cn1%203%208%5Cn11%2012%203%5Cn10%208%202%5Cn10%5Cn13%2014%2014%2013%2013%204%206%207%202%201%5Cn%22%2C%2210%5Cn10%5Cn10%5Cn10%5Cn10%5Cn3%5Cn3%5Cn5%5Cn2%5Cn1%5Cn%22%5D%5D%2C%22hint%22%3A%22For%20the%20first%20sample%20the%20hole%20looks%20like%20the%20following.%20Rooms%201%20and%205%20are%20leaves%2C%20so%20they%20contain%20a%20vertical%20tunnel%20connecting%20them%20to%20the%20ground.%20The%20lengths%20of%20farthest%20path%20from%20rooms%20%24%201%5Cu20135%20%24%20to%20the%20ground%20are%20%24%2012%2C9%2C7%2C9%2C12%20%24%20respectively.%5Cn%5CnIf%20l%20%3D%201%2C%20we%20may%20only%20choose%20any%20single%20room.%5Cn%5CnIf%20l%20%3D%202..4%2C%20we%20may%20choose%20rooms%202%2C%203%2C%20and%204%20as%20the%20answer.%5Cn%5CnIf%20l%20%3D%205%2C%20we%20may%20choose%20all%20rooms.%5Cn%5Cn%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF516D%5C%2F7e38d1221e5eee1b5e202db37a2fe92e264256df.png%29%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B3500%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F516%5C%2FD%22%2C%22id%22%3A%22516D%22%7D%2C%22translation%22%3A%22%5Cu7ed9%5Cu51fa%5Cu4e00%5Cu68f5n%5Cu4e2a%5Cu70b9%5Cu7684%5Cu6811%5Cuff0c%5Cu7ed9%5Cu51fan-1%5Cu6761x%5Cu548cy%5Cu4e4b%5Cu95f4%5Cu7684%5Cu8fb9%5Cuff0c%5Cu6bcf%5Cu6761%5Cu8fb9%5Cu6709%5Cu4e00%5Cu4e2a%5Cu957f%5Cu5ea6v%5Cuff0c%5Cu8be2%5Cu95eeq%5Cu6b21%5Cuff0c%5Cu6bcf%5Cu6b21%5Cu8be2%5Cu95ee%5Cu7ed9%5Cu51fa%5Cu4e00%5Cu4e2aL%5Cuff0c%5Cu8bf7%5Cu9009%5Cu62e9%5Cu4e00%5Cu4e2a%5Cu7b26%5Cu5408%5Cu8981%5Cu6c42%5Cu7684%5Cu6700%5Cu5927%5Cu8054%5Cu901a%5Cu5757%5Cuff0c%5Cu8981%5Cu6c42%5Cu8be5%5Cu8054%5Cu901a%5Cu5757%5Cu4e2d%5Cu6240%5Cu6709%5Cu70b9%5Cu5230%5Cu6811%5Cu4e0a%5Cu79bb%5Cu5b83%5Cu6700%5Cu8fdc%5Cu7684%5Cu70b9%5Cu7684%5Cu8ddd%5Cu79bb%5Cu7684%5Cu6700%5Cu5927%5Cu503c%5Cu4e0e%5Cu6700%5Cu5c0f%5Cu503c%5Cu4e4b%5Cu5dee%5Cu5c0f%5Cu4e8e%5Cu7b49%5Cu4e8eL%5Cuff0c%5Cu8f93%5Cu51fa%5Cu8054%5Cu901a%5Cu5757%5Cu7684%5Cu6700%5Cu5927%5Cu5927%5Cu5c0f%5Cu3002%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A51%2C%22totalAccepted%22%3A26%2C%22pid%22%3A%22CF516D%22%2C%22title%22%3A%22Drazil%20and%20Morning%20Exercise%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22CF576D%22%2C%22title%22%3A%22Flights%20for%20Regular%20Customers%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF521D%22%2C%22title%22%3A%22Shop%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22AT2705%22%2C%22title%22%3A%22Yes%20or%20No%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22AT%22%7D%2C%7B%22pid%22%3A%22P4707%22%2C%22title%22%3A%22%5Cu91cd%5Cu8fd4%5Cu73b0%5Cu4e16%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22CF1215E%22%2C%22title%22%3A%22Marbles%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Drazil%20and%20Morning%20Exercise%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573306449;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Drazil and Morning Exercise</h1>
<h2>题意翻译</h2>
<div>给出一棵n个点的树，给出n-1条x和y之间的边，每条边有一个长度v，询问q次，每次询问给出一个L，请选择一个符合要求的最大联通块，要求该联通块中所有点到树上离它最远的点的距离的最大值与最小值之差小于等于L，输出联通块的最大大小。</div>
<h2>题目描述</h2>
<div>Drazil and Varda are the earthworm couple. They want to find a good place to bring up their children. They found a good ground containing nature hole. The hole contains many rooms, some pairs of rooms are connected by small tunnels such that earthworm can move between them.
Let's consider rooms and small tunnels as the vertices and edges in a graph. This graph is a tree. In the other words, any pair of vertices has an unique path between them.
Each room that is leaf in the graph is connected with a ground by a vertical tunnel. Here, leaf is a vertex that has only one outgoing edge in the graph.
Each room is large enough only to fit one earthworm living in it. Earthworm can't live in a tunnel.
Drazil and Varda have a plan to educate their children. They want all their children to do morning exercises immediately after getting up!
When the morning is coming, all earthworm children get up in the same time, then each of them chooses the farthest path to the ground for gathering with others (these children are lazy, so they all want to do exercises as late as possible).
Drazil and Varda want the difference between the time first earthworm child arrives outside and the time the last earthworm child arrives outside to be not larger than $ l $ (otherwise children will spread around the ground and it will be hard to keep them exercising together).
Also, The rooms that are occupied by their children should form a connected set. In the other words, for any two rooms that are occupied with earthworm children, all rooms that lie on the path between them should be occupied with earthworm children too.
How many children Drazil and Varda may have at most in order to satisfy all conditions above? Drazil and Varda want to know the answer for many different choices of $ l $ .
(Drazil and Varda don't live in the hole with their children)</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains one integer $ n $ denoting how many rooms there are in the hole ( $ 2<=n<=10^{5} $ ).
Then there are $ n-1 $ lines following. Each of these lines contains three integers $ x $ , $ y $ , $ v $ ( $ 1<=x,y<=n $ , $ 1<=v<=10^{6} $ ) denoting there is a small tunnel between room $ x $ and room $ y $ that takes time $ v $ to pass.
Suppose that the time for an earthworm to get out to the ground from any leaf room is the same.
The next line contains an integer $ q $ ( $ 1<=q<=50 $ ), denoting the number of different value of $ l $ you need to process.
The last line contains $ q $ numbers, each number denoting a value of $ l $ ( $ 1<=l<=10^{11} $ ).</div>
<h3>输出格式</h3>
<br />
<div>You should print $ q $ lines. Each line should contain one integer denoting the answer for a corresponding value of $ l $ .</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>5
1 2 3
2 3 4
4 5 3
3 4 2
5
1 2 3 4 5
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>1
3
3
3
5
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>12
5 9 3
2 1 7
11 7 2
6 5 5
2 5 3
6 7 2
1 4 4
8 5 7
1 3 8
11 12 3
10 8 2
10
13 14 14 13 13 4 6 7 2 1
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>10
10
10
10
10
3
3
5
2
1
</code></pre>
<h2>说明</h2>
<div>For the first sample the hole looks like the following. Rooms 1 and 5 are leaves, so they contain a vertical tunnel connecting them to the ground. The lengths of farthest path from rooms $ 1–5 $ to the ground are $ 12,9,7,9,12 $ respectively.
If l = 1, we may only choose any single room.
If l = 2..4, we may choose rooms 2, 3, and 4 as the answer.
If l = 5, we may choose all rooms.
![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF516D/7e38d1221e5eee1b5e202db37a2fe92e264256df.png)</div>
</article>
</div>
</div>
</body>
</html>
