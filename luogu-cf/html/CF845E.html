<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Fire in the City - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573398531:GeFF+MvZhK+5S6uVJufF56thsucjsCmeVblwRWaQF+U=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22The%20capital%20of%20Berland%20looks%20like%20a%20rectangle%20of%20size%20%24%20n%5Cu00d7m%20%24%20of%20the%20square%20blocks%20of%20same%20size.%5Cn%5CnFire%21%5Cn%5CnIt%20is%20known%20that%20%24%20k%2B1%20%24%20blocks%20got%20caught%20on%20fire%20%28%20%24%20k%2B1%3C%3Dn%5Cu00b7m%20%24%20%29.%20Those%20blocks%20are%20centers%20of%20ignition.%20Moreover%20positions%20of%20%24%20k%20%24%20of%20these%20centers%20are%20known%20and%20one%20of%20these%20stays%20unknown.%20All%20%24%20k%2B1%20%24%20positions%20are%20distinct.%5Cn%5CnThe%20fire%20goes%20the%20following%20way%3A%20during%20the%20zero%20minute%20of%20fire%20only%20these%20%24%20k%2B1%20%24%20centers%20of%20ignition%20are%20burning.%20Every%20next%20minute%20the%20fire%20goes%20to%20all%20neighbouring%20blocks%20to%20the%20one%20which%20is%20burning.%20You%20can%20consider%20blocks%20to%20burn%20for%20so%20long%20that%20this%20time%20exceeds%20the%20time%20taken%20in%20the%20problem.%20The%20neighbouring%20blocks%20are%20those%20that%20touch%20the%20current%20block%20by%20a%20side%20or%20by%20a%20corner.%5Cn%5CnBerland%20Fire%20Deparment%20wants%20to%20estimate%20the%20minimal%20time%20it%20takes%20the%20fire%20to%20lighten%20up%20the%20whole%20city.%20Remember%20that%20the%20positions%20of%20%24%20k%20%24%20blocks%20%28centers%20of%20ignition%29%20are%20known%20and%20%28%20%24%20k%2B1%20%24%20%29-th%20can%20be%20positioned%20in%20any%20other%20block.%5Cn%5CnHelp%20Berland%20Fire%20Department%20to%20estimate%20the%20minimal%20time%20it%20takes%20the%20fire%20to%20lighten%20up%20the%20whole%20city.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20three%20integers%20%24%20n%20%24%20%2C%20%24%20m%20%24%20and%20%24%20k%20%24%20%28%20%24%201%3C%3Dn%2Cm%3C%3D10%5E%7B9%7D%20%24%20%2C%20%24%201%3C%3Dk%3C%3D500%20%24%20%29.%5Cn%5CnEach%20of%20the%20next%20%24%20k%20%24%20lines%20contain%20two%20integers%20%24%20x_%7Bi%7D%20%24%20and%20%24%20y_%7Bi%7D%20%24%20%28%20%24%201%3C%3Dx_%7Bi%7D%3C%3Dn%20%24%20%2C%20%24%201%3C%3Dy_%7Bi%7D%3C%3Dm%20%24%20%29%20%5Cu2014%20coordinates%20of%20the%20%24%20i%20%24%20-th%20center%20of%20ignition.%20It%20is%20guaranteed%20that%20the%20locations%20of%20all%20centers%20of%20ignition%20are%20distinct.%22%2C%22outputFormat%22%3A%22Print%20the%20minimal%20time%20it%20takes%20the%20fire%20to%20lighten%20up%20the%20whole%20city%20%28in%20minutes%29.%22%2C%22samples%22%3A%5B%5B%227%207%203%5Cn1%202%5Cn2%201%5Cn5%205%5Cn%22%2C%223%5Cn%22%5D%2C%5B%2210%205%201%5Cn3%203%5Cn%22%2C%222%5Cn%22%5D%5D%2C%22hint%22%3A%22In%20the%20first%20example%20the%20last%20block%20can%20have%20coordinates%20%24%20%284%2C4%29%20%24%20.%5Cn%5CnIn%20the%20second%20example%20the%20last%20block%20can%20have%20coordinates%20%24%20%288%2C3%29%20%24%20.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F845%5C%2FE%22%2C%22id%22%3A%22845E%22%7D%2C%22translation%22%3A%22%5Cu6709%5Cu4e00%5Cu4e2a%20%24n%24%20%5Cu884c%20%24m%24%20%5Cu5217%5Cu7684%5Cu7f51%5Cu683c%5Cu3002%5Cu5176%5Cu4e2d%5Cu6709%20%24k%2B1%24%20%5Cu4e2a%5Cu683c%5Cu5b50%5Cu7740%5Cu706b%5Cu4e86%5Cu3002%5Cu6bcf%5Cu4e2a%5Cu65f6%5Cu523b%5Cuff0c%5Cu706b%5Cu4f1a%5Cu8513%5Cu5ef6%5Cu81f3%5Cu76f8%5Cu90bb%5Cu7684%5Cu683c%5Cu5b50%5Cuff08%5Cu516b%5Cu8054%5Cu901a%5Cuff09%5Cu3002%5Cu73b0%5Cu5728%5Cu7ed9%5Cu51fa%5Cu5176%5Cu4e2d%20%24k%24%20%5Cu4e2a%5Cu7740%5Cu706b%5Cu7684%5Cu683c%5Cu5b50%5Cuff0c%5Cu8bf7%5Cu786e%5Cu5b9a%5Cu7b2c%20%24k%2B1%24%20%5Cu683c%5Cu5b50%5Cuff0c%5Cu4f7f%5Cu5f97%5Cu7f51%5Cu683c%5Cu88ab%5Cu70e7%5Cu5b8c%5Cu7684%5Cu7528%5Cu65f6%5Cu6700%5Cu77ed%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu4f60%5Cu53ea%5Cu9700%5Cu8981%5Cu8f93%5Cu51fa%5Cu6700%5Cu77ed%5Cu7528%5Cu65f6%5Cu3002%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A26%2C%22totalAccepted%22%3A10%2C%22pid%22%3A%22CF845E%22%2C%22title%22%3A%22Fire%20in%20the%20City%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Fire%20in%20the%20City%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Fire in the City</h1>
<h2>题意翻译</h2>
<div>有一个 $n$ 行 $m$ 列的网格。其中有 $k+1$ 个格子着火了。每个时刻，火会蔓延至相邻的格子（八联通）。现在给出其中 $k$ 个着火的格子，请确定第 $k+1$ 格子，使得网格被烧完的用时最短。
你只需要输出最短用时。</div>
<h2>题目描述</h2>
<div>The capital of Berland looks like a rectangle of size $ n×m $ of the square blocks of same size.
Fire!
It is known that $ k+1 $ blocks got caught on fire ( $ k+1<=n·m $ ). Those blocks are centers of ignition. Moreover positions of $ k $ of these centers are known and one of these stays unknown. All $ k+1 $ positions are distinct.
The fire goes the following way: during the zero minute of fire only these $ k+1 $ centers of ignition are burning. Every next minute the fire goes to all neighbouring blocks to the one which is burning. You can consider blocks to burn for so long that this time exceeds the time taken in the problem. The neighbouring blocks are those that touch the current block by a side or by a corner.
Berland Fire Deparment wants to estimate the minimal time it takes the fire to lighten up the whole city. Remember that the positions of $ k $ blocks (centers of ignition) are known and ( $ k+1 $ )-th can be positioned in any other block.
Help Berland Fire Department to estimate the minimal time it takes the fire to lighten up the whole city.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains three integers $ n $ , $ m $ and $ k $ ( $ 1<=n,m<=10^{9} $ , $ 1<=k<=500 $ ).
Each of the next $ k $ lines contain two integers $ x_{i} $ and $ y_{i} $ ( $ 1<=x_{i}<=n $ , $ 1<=y_{i}<=m $ ) — coordinates of the $ i $ -th center of ignition. It is guaranteed that the locations of all centers of ignition are distinct.</div>
<h3>输出格式</h3>
<br />
<div>Print the minimal time it takes the fire to lighten up the whole city (in minutes).</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>7 7 3
1 2
2 1
5 5
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>3
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>10 5 1
3 3
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>2
</code></pre>
<h2>说明</h2>
<div>In the first example the last block can have coordinates $ (4,4) $ .
In the second example the last block can have coordinates $ (8,3) $ .</div>
</article>
</div>
</div>
</body>
</html>
