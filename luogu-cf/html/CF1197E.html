<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Culture Code - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573402967:ERvgMxS5esn1LR9tgKJjMkD4Evc58zaM2gInykcsn3g=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22There%20are%20famous%20Russian%20nesting%20dolls%20named%20matryoshkas%20sold%20in%20one%20of%20the%20souvenir%20stores%20nearby%2C%20and%20you%27d%20like%20to%20buy%20several%20of%20them.%20The%20store%20has%20%24%20n%20%24%20different%20matryoshkas.%20Any%20matryoshka%20is%20a%20figure%20of%20volume%20%24%20out_i%20%24%20with%20an%20empty%20space%20inside%20of%20volume%20%24%20in_i%20%24%20%28of%20course%2C%20%24%20out_i%20%3E%20in_i%20%24%20%29.%5Cn%5CnYou%20don%27t%20have%20much%20free%20space%20inside%20your%20bag%2C%20but%2C%20fortunately%2C%20you%20know%20that%20matryoshkas%20can%20be%20nested%20one%20inside%20another.%20Formally%2C%20let%27s%20call%20a%20set%20of%20matryoshkas%20nested%20if%20we%20can%20rearrange%20dolls%20in%20such%20a%20way%2C%20that%20the%20first%20doll%20can%20be%20nested%20inside%20the%20second%20one%2C%20the%20second%20doll%20%5Cu2014%20inside%20the%20third%20one%20and%20so%20on.%20Matryoshka%20%24%20i%20%24%20can%20be%20nested%20inside%20matryoshka%20%24%20j%20%24%20if%20%24%20out_i%20%5C%5Cle%20in_j%20%24%20.%20So%20only%20the%20last%20doll%20will%20take%20space%20inside%20your%20bag.%5Cn%5CnLet%27s%20call%20extra%20space%20of%20a%20nested%20set%20of%20dolls%20as%20a%20total%20volume%20of%20empty%20space%20inside%20this%20structure.%20Obviously%2C%20it%27s%20equal%20to%20%24%20in_%7Bi_1%7D%20%2B%20%28in_%7Bi_2%7D%20-%20out_%7Bi_1%7D%29%20%2B%20%28in_%7Bi_3%7D%20-%20out_%7Bi_2%7D%29%20%2B%20%5C%5Cdots%20%2B%20%28in_%7Bi_k%7D%20-%20out_%7Bi_%7Bk-1%7D%7D%29%20%24%20%2C%20where%20%24%20i_1%20%24%20%2C%20%24%20i_2%20%24%20%2C%20...%2C%20%24%20i_k%20%24%20are%20the%20indices%20of%20the%20chosen%20dolls%20in%20the%20order%20they%20are%20nested%20in%20each%20other.%5Cn%5CnFinally%2C%20let%27s%20call%20a%20nested%20subset%20of%20the%20given%20sequence%20as%20big%20enough%20if%20there%20isn%27t%20any%20doll%20from%20the%20sequence%20that%20can%20be%20added%20to%20the%20nested%20subset%20without%20breaking%20its%20nested%20property.%5Cn%5CnYou%20want%20to%20buy%20many%20matryoshkas%2C%20so%20you%20should%20choose%20a%20big%20enough%20nested%20subset%20to%20buy%20it.%20But%20you%20will%20be%20disappointed%20if%20too%20much%20space%20in%20your%20bag%20will%20be%20wasted%2C%20so%20you%20want%20to%20choose%20a%20big%20enough%20subset%20so%20that%20its%20extra%20space%20is%20minimum%20possible%20among%20all%20big%20enough%20subsets.%20Now%20you%20wonder%2C%20how%20many%20different%20nested%20subsets%20meet%20these%20conditions%20%28they%20are%20big%20enough%2C%20and%20there%20is%20no%20big%20enough%20subset%20such%20that%20its%20extra%20space%20is%20less%20than%20the%20extra%20space%20of%20the%20chosen%20subset%29.%20Two%20subsets%20are%20considered%20different%20if%20there%20exists%20at%20least%20one%20index%20%24%20i%20%24%20such%20that%20one%20of%20the%20subsets%20contains%20the%20%24%20i%20%24%20-th%20doll%2C%20and%20another%20subset%20doesn%27t.%5Cn%5CnSince%20the%20answer%20can%20be%20large%2C%20print%20it%20modulo%20%24%2010%5E9%20%2B%207%20%24%20.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20a%20single%20integer%20%24%20n%20%24%20%28%20%24%201%20%5C%5Cle%20n%20%5C%5Cle%202%20%5C%5Ccdot%2010%5E5%20%24%20%29%20%5Cu2014%20the%20number%20of%20matryoshkas.%5Cn%5CnThe%20next%20%24%20n%20%24%20lines%20contain%20a%20description%20of%20each%20doll%3A%20two%20integers%20%24%20out_i%20%24%20and%20%24%20in_i%20%24%20%28%20%24%201%20%5C%5Cle%20in_i%20%3C%20out_i%20%5C%5Cle%2010%5E9%20%24%20%29%20%5Cu2014%20the%20outer%20and%20inners%20volumes%20of%20the%20%24%20i%20%24%20-th%20matryoshka.%22%2C%22outputFormat%22%3A%22Print%20one%20integer%20%5Cu2014%20the%20number%20of%20big%20enough%20nested%20subsets%20such%20that%20extra%20space%20of%20each%20of%20these%20subsets%20is%20minimum%20possible.%20Since%20the%20answer%20can%20be%20large%2C%20print%20it%20modulo%20%24%2010%5E9%20%2B%207%20%24%20.%22%2C%22samples%22%3A%5B%5B%22%5Cn7%5Cn4%201%5Cn4%202%5Cn4%202%5Cn2%201%5Cn5%204%5Cn6%204%5Cn3%202%5Cn%22%2C%22%5Cn6%5Cn%22%5D%5D%2C%22hint%22%3A%22There%20are%20%24%206%20%24%20big%20enough%20nested%20subsets%20with%20minimum%20possible%20extra%20space%20in%20the%20example%3A%5Cn%5Cn-%20%24%20%5C%5C%7B1%2C%205%5C%5C%7D%20%24%20%3A%20we%20can%27t%20add%20any%20other%20matryoshka%20and%20keep%20it%20nested%3B%20it%27s%20extra%20space%20is%20%24%201%20%24%20%3B%5Cn-%20%24%20%5C%5C%7B1%2C%206%5C%5C%7D%20%24%20%3B%5Cn-%20%24%20%5C%5C%7B2%2C%204%2C%205%5C%5C%7D%20%24%20%3B%5Cn-%20%24%20%5C%5C%7B2%2C%204%2C%206%5C%5C%7D%20%24%20%3B%5Cn-%20%24%20%5C%5C%7B3%2C%204%2C%205%5C%5C%7D%20%24%20%3B%5Cn-%20%24%20%5C%5C%7B3%2C%204%2C%206%5C%5C%7D%20%24%20.%5Cn%5CnThere%20are%20no%20more%20%5C%22good%5C%22%20subsets%20because%2C%20for%20example%2C%20subset%20%24%20%5C%5C%7B6%2C%207%5C%5C%7D%20%24%20is%20not%20big%20enough%20%28we%20can%20add%20the%20%24%204%20%24%20-th%20matryoshka%20to%20it%29%20or%20subset%20%24%20%5C%5C%7B4%2C%206%2C%207%5C%5C%7D%20%24%20has%20extra%20space%20equal%20to%20%24%202%20%24%20.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F1197%5C%2FE%22%2C%22id%22%3A%221197E%22%7D%2C%22translation%22%3A%22%5Cu6709%5Cu4e00%5Cu4e9b%5Cu4fc4%5Cu7f57%5Cu65af%5Cu5957%5Cu5a03%5Cuff0c%5Cu7b2c%20%24i%24%20%5Cu4e2a%5Cu5957%5Cu5a03%5Cu4ece%5Cu5916%5Cu90e8%5Cu770b%5Cu4f53%5Cu79ef%5Cu4e3a%20%24out_i%24%5Cuff0c%5Cu5185%5Cu90e8%5Cu7a7a%5Cu5fc3%5Cu4f53%5Cu79ef%5Cu4e3a%20%24in_i%24%5Cuff0c%5Cu663e%5Cu7136%20%24in_i%3Cout_i%24%5Cr%5Cn%5Cr%5Cn%5Cu4f60%5Cu60f3%5Cu628a%5Cu4e00%5Cu4e9b%5Cu5957%5Cu5a03%5Cu653e%5Cu8fdb%5Cu5305%5Cu91cc%5Cuff0c%5Cu5e78%5Cu8fd0%5Cu7684%5Cu662f%5Cu4f60%5Cu53ef%5Cu4ee5%5Cu628a%5Cu5b83%5Cu4eec%5Cu5957%5Cu8d77%5Cu6765%5Cu5e26%5Cu8d70%5Cuff0c%5Cu5177%5Cu4f53%5Cu5730%5Cuff0c%5Cu82e5%20%24out_i%5C%5Cle%20in_j%24%5Cuff0c%5Cu4f60%5Cu53ef%5Cu4ee5%5Cu628a%5Cu5957%5Cu5a03%20%24i%24%20%5Cu5957%5Cu5728%5Cu5957%5Cu5a03%20%24j%24%20%5Cu91cc%5Cu9762%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu73b0%5Cu5728%5Cu4f60%5Cu5957%5Cu4e86%5Cu4e00%5Cu4e9b%5Cu5957%5Cu5a03%5Cuff0c%5Cu8bbe%5Cu8fd9%5Cu4e9b%5Cu5957%5Cu5a03%5Cu7f16%5Cu53f7%5Cu4e3a%20%24i_1%2C%20i_2%2C%20%5C%5Ccdots%2C%20i_k%24%5Cuff0c%5Cu5219%5Cu5269%5Cu4f59%5Cu7a7a%5Cu95f4%5Cu4e3a%20%24in_%7Bi_1%7D%2B%28in_%7Bi_2%7D-out_%7Bi_1%7D%29%2B%5C%5Ccdots%2B%28in_%7Bi_k%7D-out_%7Bi_k-1%7D%29%24%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu8bb0%5Cu6240%5Cu6709%5Cu65b9%5Cu6848%5Cu4e2d%5Cu5269%5Cu4f59%5Cu7a7a%5Cu95f4%5Cu7684%5Cu6700%5Cu5c0f%5Cu503c%5Cu4e3a%20%24m%24%5Cuff0c%5Cu4f60%5Cu9700%5Cu8981%5Cu8f93%5Cu51fa%5Cu5269%5Cu4f59%5Cu7a7a%5Cu95f4%5Cu7b49%5Cu4e8e%20%24m%24%20%5Cu7684%5Cu65b9%5Cu6848%5Cu7684%5Cu4e2a%5Cu6570%5Cuff0c%5Cu56e0%5Cu4e3a%20Aiming_High%20%5Cu592a%5Cu5f3a%5Cu4e86%5Cuff0c%5Cu6240%5Cu4ee5%5Cu7b54%5Cu6848%5Cu5bf9%20%2410%5E9%2B7%24%20%5Cu53d6%5Cu6a21%5Cu3002%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A132%2C%22totalAccepted%22%3A73%2C%22pid%22%3A%22CF1197E%22%2C%22title%22%3A%22Culture%20Code%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22CF1196F%22%2C%22title%22%3A%22K-th%20Path%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1196E%22%2C%22title%22%3A%22Connected%20Component%20on%20a%20Chessboard%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1196B%22%2C%22title%22%3A%22Odd%20Sum%20Segments%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1195D1%22%2C%22title%22%3A%22Submarine%20in%20the%20Rybinsk%20Sea%20%28easy%20edition%29%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1214E%22%2C%22title%22%3A%22Petya%20and%20Construction%20Set%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Culture%20Code%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Culture Code</h1>
<h2>题意翻译</h2>
<div>有一些俄罗斯套娃，第 $i$ 个套娃从外部看体积为 $out_i$，内部空心体积为 $in_i$，显然 $in_i<out_i$ 你想把一些套娃放进包里，幸运的是你可以把它们套起来带走，具体地，若 $out_i\le in_j$，你可以把套娃 $i$ 套在套娃 $j$ 里面。 现在你套了一些套娃，设这些套娃编号为 $i_1, i_2, \cdots, i_k$，则剩余空间为 $in_{i_1}+(in_{i_2}-out_{i_1})+\cdots+(in_{i_k}-out_{i_k-1})$。 记所有方案中剩余空间的最小值为 $m$，你需要输出剩余空间等于 $m$ 的方案的个数，因为 Aiming_High 太强了，所以答案对 $10^9+7$ 取模。</div>
<h2>题目描述</h2>
<div>There are famous Russian nesting dolls named matryoshkas sold in one of the souvenir stores nearby, and you'd like to buy several of them. The store has $ n $ different matryoshkas. Any matryoshka is a figure of volume $ out_i $ with an empty space inside of volume $ in_i $ (of course, $ out_i > in_i $ ).
You don't have much free space inside your bag, but, fortunately, you know that matryoshkas can be nested one inside another. Formally, let's call a set of matryoshkas nested if we can rearrange dolls in such a way, that the first doll can be nested inside the second one, the second doll — inside the third one and so on. Matryoshka $ i $ can be nested inside matryoshka $ j $ if $ out_i \le in_j $ . So only the last doll will take space inside your bag.
Let's call extra space of a nested set of dolls as a total volume of empty space inside this structure. Obviously, it's equal to $ in_{i_1} + (in_{i_2} - out_{i_1}) + (in_{i_3} - out_{i_2}) + \dots + (in_{i_k} - out_{i_{k-1}}) $ , where $ i_1 $ , $ i_2 $ , ..., $ i_k $ are the indices of the chosen dolls in the order they are nested in each other.
Finally, let's call a nested subset of the given sequence as big enough if there isn't any doll from the sequence that can be added to the nested subset without breaking its nested property.
You want to buy many matryoshkas, so you should choose a big enough nested subset to buy it. But you will be disappointed if too much space in your bag will be wasted, so you want to choose a big enough subset so that its extra space is minimum possible among all big enough subsets. Now you wonder, how many different nested subsets meet these conditions (they are big enough, and there is no big enough subset such that its extra space is less than the extra space of the chosen subset). Two subsets are considered different if there exists at least one index $ i $ such that one of the subsets contains the $ i $ -th doll, and another subset doesn't.
Since the answer can be large, print it modulo $ 10^9 + 7 $ .</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains a single integer $ n $ ( $ 1 \le n \le 2 \cdot 10^5 $ ) — the number of matryoshkas.
The next $ n $ lines contain a description of each doll: two integers $ out_i $ and $ in_i $ ( $ 1 \le in_i < out_i \le 10^9 $ ) — the outer and inners volumes of the $ i $ -th matryoshka.</div>
<h3>输出格式</h3>
<br />
<div>Print one integer — the number of big enough nested subsets such that extra space of each of these subsets is minimum possible. Since the answer can be large, print it modulo $ 10^9 + 7 $ .</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>
7
4 1
4 2
4 2
2 1
5 4
6 4
3 2
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>
6
</code></pre>
<h2>说明</h2>
<div>There are $ 6 $ big enough nested subsets with minimum possible extra space in the example:
- $ \{1, 5\} $ : we can't add any other matryoshka and keep it nested; it's extra space is $ 1 $ ;
- $ \{1, 6\} $ ;
- $ \{2, 4, 5\} $ ;
- $ \{2, 4, 6\} $ ;
- $ \{3, 4, 5\} $ ;
- $ \{3, 4, 6\} $ .
There are no more "good" subsets because, for example, subset $ \{6, 7\} $ is not big enough (we can add the $ 4 $ -th matryoshka to it) or subset $ \{4, 6, 7\} $ has extra space equal to $ 2 $ .</div>
</article>
</div>
</div>
</body>
</html>
