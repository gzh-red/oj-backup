<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Maze 2D - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573393849:BSl4iqKI1lAzbedyXQJEKdmaqnpr3BjvCAiEtdPcit0=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22The%20last%20product%20of%20the%20R2%20company%20in%20the%202D%20games%27%20field%20is%20a%20new%20revolutionary%20algorithm%20of%20searching%20for%20the%20shortest%20path%20in%20a%20%24%202%5Cu00d7n%20%24%20maze.%5Cn%5CnImagine%20a%20maze%20that%20looks%20like%20a%20%24%202%5Cu00d7n%20%24%20rectangle%2C%20divided%20into%20unit%20squares.%20Each%20unit%20square%20is%20either%20an%20empty%20cell%20or%20an%20obstacle.%20In%20one%20unit%20of%20time%2C%20a%20person%20can%20move%20from%20an%20empty%20cell%20of%20the%20maze%20to%20any%20side-adjacent%20empty%20cell.%20The%20shortest%20path%20problem%20is%20formulated%20as%20follows.%20Given%20two%20free%20maze%20cells%2C%20you%20need%20to%20determine%20the%20minimum%20time%20required%20to%20go%20from%20one%20cell%20to%20the%20other.%5Cn%5CnUnfortunately%2C%20the%20developed%20algorithm%20works%20well%20for%20only%20one%20request%20for%20finding%20the%20shortest%20path%2C%20in%20practice%20such%20requests%20occur%20quite%20often.%20You%2C%20as%20the%20chief%20R2%20programmer%2C%20are%20commissioned%20to%20optimize%20the%20algorithm%20to%20find%20the%20shortest%20path.%20Write%20a%20program%20that%20will%20effectively%20respond%20to%20multiple%20requests%20to%20find%20the%20shortest%20path%20in%20a%20%24%202%5Cu00d7n%20%24%20maze.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20two%20integers%2C%20%24%20n%20%24%20and%20%24%20m%20%24%20%24%20%281%3C%3Dn%3C%3D2%5Cu00b710%5E%7B5%7D%3B%5Cu00a01%3C%3Dm%3C%3D2%5Cu00b710%5E%7B5%7D%29%20%24%20%5Cu2014%20the%20width%20of%20the%20maze%20and%20the%20number%20of%20queries%2C%20correspondingly.%20Next%20two%20lines%20contain%20the%20maze.%20Each%20line%20contains%20%24%20n%20%24%20characters%2C%20each%20character%20equals%20either%20%27.%27%20%28empty%20cell%29%2C%20or%20%27X%27%20%28obstacle%29.%5Cn%5CnEach%20of%20the%20next%20%24%20m%20%24%20lines%20contains%20two%20integers%20%24%20v_%7Bi%7D%20%24%20and%20%24%20u_%7Bi%7D%20%24%20%24%20%281%3C%3Dv_%7Bi%7D%2Cu_%7Bi%7D%3C%3D2n%29%20%24%20%5Cu2014%20the%20description%20of%20the%20%24%20i%20%24%20-th%20request.%20Numbers%20%24%20v_%7Bi%7D%20%24%20%2C%20%24%20u_%7Bi%7D%20%24%20mean%20that%20you%20need%20to%20print%20the%20value%20of%20the%20shortest%20path%20from%20the%20cell%20of%20the%20maze%20number%20%24%20v_%7Bi%7D%20%24%20to%20the%20cell%20number%20%24%20u_%7Bi%7D%20%24%20.%20We%20assume%20that%20the%20cells%20of%20the%20first%20line%20of%20the%20maze%20are%20numbered%20from%20%24%201%20%24%20to%20%24%20n%20%24%20%2C%20from%20left%20to%20right%2C%20and%20the%20cells%20of%20the%20second%20line%20are%20numbered%20from%20%24%20n%2B1%20%24%20to%20%24%202n%20%24%20from%20left%20to%20right.%20It%20is%20guaranteed%20that%20both%20given%20cells%20are%20empty.%22%2C%22outputFormat%22%3A%22Print%20%24%20m%20%24%20lines.%20In%20the%20%24%20i%20%24%20-th%20line%20print%20the%20answer%20to%20the%20%24%20i%20%24%20-th%20request%20%5Cu2014%20either%20the%20size%20of%20the%20shortest%20path%20or%20-1%2C%20if%20we%20can%27t%20reach%20the%20second%20cell%20from%20the%20first%20one.%22%2C%22samples%22%3A%5B%5B%224%207%5Cn.X..%5Cn...X%5Cn5%201%5Cn1%203%5Cn7%207%5Cn1%204%5Cn6%201%5Cn4%207%5Cn5%207%5Cn%22%2C%221%5Cn4%5Cn0%5Cn5%5Cn2%5Cn2%5Cn2%5Cn%22%5D%2C%5B%2210%203%5CnX...X..X..%5Cn..X...X..X%5Cn11%207%5Cn7%2018%5Cn18%2010%5Cn%22%2C%229%5Cn-1%5Cn3%5Cn%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F413%5C%2FE%22%2C%22id%22%3A%22413E%22%7D%2C%22translation%22%3A%22%5Cu7ed9%5Cu4e00%5Cu4e2a2%2An%20%5Cu7684%5Cu5730%5Cu56fe%5Cuff0c%5Cu6709%5Cu4e00%5Cu4e9bX%5Cu4e0d%5Cu80fd%5Cu8d70%5Cuff0c%5Cu6ca1%5Cu6709%5Cu4fee%5Cu6539%5Cuff0c%5Cu95ee%5Cu4e00%5Cu4e2a%5Cu70b9%5Cu5230%5Cu53e6%5Cu4e00%5Cu4e2a%5Cu70b9%5Cu7684%5Cu6700%5Cu77ed%5Cu8ddd%5Cu79bb%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A81%2C%22totalAccepted%22%3A34%2C%22pid%22%3A%22CF413E%22%2C%22title%22%3A%22Maze%202D%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A123121%2C%22title%22%3A%22%5Cu6c42%5Cu52a9%5Cu7ebf%5Cu6bb5%5Cu6811%5Cu6302%5Cu4e86%22%2C%22forum%22%3A%7B%22id%22%3A10986%2C%22name%22%3A%22CF413E%20Maze%202D%22%2C%22slug%22%3A%22CF413E%22%7D%7D%2C%7B%22id%22%3A45521%2C%22title%22%3A%22%5Cu7ffb%5Cu8bd1%22%2C%22forum%22%3A%7B%22id%22%3A10986%2C%22name%22%3A%22CF413E%20Maze%202D%22%2C%22slug%22%3A%22CF413E%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P1903%22%2C%22title%22%3A%22%5B%5Cu56fd%5Cu5bb6%5Cu96c6%5Cu8bad%5Cu961f%5D%5Cu6570%5Cu989c%5Cu8272%20%5C%2F%20%5Cu7ef4%5Cu62a4%5Cu961f%5Cu5217%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P3597%22%2C%22title%22%3A%22%5BPOI2015%5DWYC%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22CF490F%22%2C%22title%22%3A%22Treeland%20Tour%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF264B%22%2C%22title%22%3A%22Good%20Sequences%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22P5283%22%2C%22title%22%3A%22%5B%5Cu5341%5Cu4e8c%5Cu7701%5Cu8054%5Cu80032019%5D%5Cu5f02%5Cu6216%5Cu7cbd%5Cu5b50%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Maze%202D%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Maze 2D</h1>
<h2>题意翻译</h2>
<div>给一个2*n 的地图，有一些X不能走，没有修改，问一个点到另一个点的最短距离</div>
<h2>题目描述</h2>
<div>The last product of the R2 company in the 2D games' field is a new revolutionary algorithm of searching for the shortest path in a $ 2×n $ maze.
Imagine a maze that looks like a $ 2×n $ rectangle, divided into unit squares. Each unit square is either an empty cell or an obstacle. In one unit of time, a person can move from an empty cell of the maze to any side-adjacent empty cell. The shortest path problem is formulated as follows. Given two free maze cells, you need to determine the minimum time required to go from one cell to the other.
Unfortunately, the developed algorithm works well for only one request for finding the shortest path, in practice such requests occur quite often. You, as the chief R2 programmer, are commissioned to optimize the algorithm to find the shortest path. Write a program that will effectively respond to multiple requests to find the shortest path in a $ 2×n $ maze.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains two integers, $ n $ and $ m $ $ (1<=n<=2·10^{5}; 1<=m<=2·10^{5}) $ — the width of the maze and the number of queries, correspondingly. Next two lines contain the maze. Each line contains $ n $ characters, each character equals either '.' (empty cell), or 'X' (obstacle).
Each of the next $ m $ lines contains two integers $ v_{i} $ and $ u_{i} $ $ (1<=v_{i},u_{i}<=2n) $ — the description of the $ i $ -th request. Numbers $ v_{i} $ , $ u_{i} $ mean that you need to print the value of the shortest path from the cell of the maze number $ v_{i} $ to the cell number $ u_{i} $ . We assume that the cells of the first line of the maze are numbered from $ 1 $ to $ n $ , from left to right, and the cells of the second line are numbered from $ n+1 $ to $ 2n $ from left to right. It is guaranteed that both given cells are empty.</div>
<h3>输出格式</h3>
<br />
<div>Print $ m $ lines. In the $ i $ -th line print the answer to the $ i $ -th request — either the size of the shortest path or -1, if we can't reach the second cell from the first one.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>4 7
.X..
...X
5 1
1 3
7 7
1 4
6 1
4 7
5 7
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>1
4
0
5
2
2
2
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>10 3
X...X..X..
..X...X..X
11 7
7 18
18 10
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>9
-1
3
</code></pre>
</article>
</div>
</div>
</body>
</html>
