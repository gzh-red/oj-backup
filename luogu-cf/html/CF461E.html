<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Appleman and a Game - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573394348:E1ExzeOg+Rx4DuuotkeJF7+/z6iEuJ9BMQ7suW5Osds=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Appleman%20and%20Toastman%20like%20games.%20Today%20they%20play%20a%20game%20with%20strings%20with%20the%20following%20rules.%20Firstly%20Toastman%20tells%20Appleman%20two%20strings%20%24%20s%20%24%20and%20%24%20t%20%24%20both%20consisting%20only%20of%20letters%20%27A%27%2C%20%27B%27%2C%20%27C%27%2C%20%27D%27.%20Then%20Appleman%20must%20build%20string%20%24%20s%20%24%20as%20quickly%20as%20possible.%20Initially%20he%20has%20empty%20string%2C%20and%20in%20one%20second%20he%20can%20append%20to%20end%20of%20the%20current%20string%20any%20contiguous%20substring%20of%20%24%20t%20%24%20.%5Cn%5CnNow%2C%20Toastman%20and%20Appleman%20are%20beginning%20to%20play%20the%20game.%20Toastman%20has%20already%20told%20string%20%24%20t%20%24%20to%20Appleman%2C%20but%20he%20hasn%27t%20come%20up%20with%20string%20%24%20s%20%24%20yet.%20Toastman%20only%20thinks%2C%20that%20he%20should%20choose%20string%20%24%20s%20%24%20consisting%20of%20%24%20n%20%24%20characters.%20Of%20course%2C%20he%20wants%20to%20find%20the%20worst%20string%20for%20Appleman%20%28such%20string%2C%20that%20Appleman%20will%20spend%20as%20much%20time%20as%20possible%20during%20the%20game%29.%20Tell%20Toastman%2C%20how%20much%20time%20will%20Appleman%20spend%20during%20the%20game%20if%20Toastman%20finds%20the%20worst%20string%20for%20him.%20You%20can%20assume%20that%20Appleman%20plays%20optimally%2C%20therefore%20he%20builds%20any%20string%20%24%20s%20%24%20in%20minimal%20possible%20time.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20an%20integer%20%24%20n%20%24%20%28%20%24%201%3C%3Dn%3C%3D10%5E%7B18%7D%20%24%20%29.%20The%20second%20line%20contains%20string%20%24%20t%20%24%20%28%20%24%201%3C%3D%7Ct%7C%3C%3D10%5E%7B5%7D%20%24%20%29.%20String%20%24%20t%20%24%20consists%20of%20only%20letters%20%27A%27%2C%20%27B%27%2C%20%27C%27%2C%20%27D%27.%20Each%20letter%20appears%20at%20least%20once%20in%20string%20%24%20t%20%24%20.%22%2C%22outputFormat%22%3A%22Print%20a%20single%20integer%20%5Cu2014%20the%20largest%20possible%20time%20Appleman%20needs.%22%2C%22samples%22%3A%5B%5B%225%5CnABCCAD%5Cn%22%2C%225%5Cn%22%5D%2C%5B%225%5CnAAABACADBABBBCBDCACBCCCDDDBDCDD%5Cn%22%2C%224%5Cn%22%5D%5D%2C%22hint%22%3A%22In%20the%20first%20example%2C%20Toastman%20can%20choose%20%24%20s%20%24%20equal%20to%20%5C%22AAAAA%5C%22.%5Cn%5CnIn%20the%20second%20example%2C%20Toastman%20can%20choose%20%24%20s%20%24%20equal%20to%20%5C%22DADDA%5C%22.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F461%5C%2FE%22%2C%22id%22%3A%22461E%22%7D%2C%22translation%22%3A%22%23%23%20%5Cu9898%5Cu76ee%5Cu63cf%5Cu8ff0%5Cr%5CnAppleman%20%5Cu548c%20Toastman%20%5Cu559c%5Cu6b22%5Cu6e38%5Cu620f%5Cu3002%5Cu4ed6%5Cu4eec%5Cu4eca%5Cu5929%5Cu73a9%5Cu4e86%5Cu4e00%5Cu4e2a%5Cu8ddf%5Cu5b57%5Cu7b26%5Cu4e32%5Cu6709%5Cu5173%5Cu7684%5Cu6e38%5Cu620f%5Cuff0c%5Cu5176%5Cu89c4%5Cu5219%5Cu5982%5Cu4e0b%5Cuff1a%5Cr%5Cn%5Cu9996%5Cu5148%20Toastman%20%5Cu7ed9%5Cu51fa%5Cu4e24%5Cu4e2a%5Cu5b57%5Cu7b26%5Cu4e32%20%2A%2As%2A%2A%20%5Cu548c%20%2A%2At%2A%2A%20%28%20%5Cu4ec5%5Cu7531%20%27A%27%20%2C%20%27B%27%20%2C%20%27C%27%20%2C%20%27D%27%20%5Cu6784%5Cu6210%20%29%20%5Cuff0c%5Cu7136%5Cu540e%20Appleman%20%5Cu5fc5%5Cu987b%5Cu5c3d%5Cu53ef%5Cu80fd%5Cu5feb%5Cu5730%5Cu7528%20%2A%2At%2A%2A%20%5Cu7684%5Cu5b50%5Cu4e32%5Cu6784%5Cu6210%20%2A%2As%2A%2A%20%5Cu3002%5Cu5f00%5Cu59cb%5Cu65f6%20Appleman%20%5Cu6709%5Cu4e00%5Cu4e2a%5Cu7a7a%5Cu5b57%5Cu7b26%5Cu4e32%5Cuff0c%5Cu4ed6%5Cu6bcf%5Cu79d2%5Cu949f%5Cu53ef%5Cu4ee5%5Cu5c06%20%2A%2At%2A%2A%20%5Cu7684%5Cu4e00%5Cu4e2a%5Cu5b50%5Cu4e32%5Cu63a5%5Cu5728%5Cu8fd9%5Cu4e2a%5Cu5b57%5Cu7b26%5Cu4e32%5Cu7684%5Cu540e%5Cu9762%5Cu3002%5Cr%5Cn%5Cu73b0%5Cu5728%5Cu6e38%5Cu620f%5Cu5f00%5Cu59cb%5Cu4e86%5Cuff0c%20Toastman%20%5Cu5df2%5Cu7ecf%5Cu7ed9%5Cu51fa%5Cu4e86%20%2A%2At%2A%2A%20%5Cuff0c%5Cu4f46%5Cu4ed6%5Cu8fd8%5Cu6ca1%5Cu60f3%5Cu597d%20%2A%2As%2A%2A%20%5Cuff0c%20Toastman%20%5Cu60f3%5Cu7ed9%5Cu51fa%5Cu4e00%5Cu4e2a%5Cu957f%5Cu5ea6%5Cu4e3a%20%2A%2An%2A%2A%20%5Cuff0c%5Cu5e76%5Cu4e14%5Cu4f7f%5Cu5f97%20Appleman%20%5Cu7528%5Cu65f6%5Cu6700%5Cu957f%5Cu7684%20%2A%2As%2A%2A%20%5Cu3002%5Cu8bf7%5Cu4f60%5Cu544a%5Cu8bc9%20Toastman%20%5Cuff0c%5Cu5bf9%5Cu4e8e%5Cu8fd9%5Cu6837%5Cu7684%20%2A%2As%2A%2A%20%5Cuff0c%20Appleman%20%5Cu7684%5Cu6700%5Cu77ed%5Cu7528%5Cu65f6%5Cu662f%5Cu591a%5Cu4e45%5Cu3002%5Cr%5Cn%23%23%20%5Cu8f93%5Cu5165%5Cu8f93%5Cu51fa%5Cu683c%5Cu5f0f%5Cr%5Cn%23%23%23%20%5Cu8f93%5Cu5165%5Cu683c%5Cu5f0f%5Cr%5Cn%5Cu5171%5Cu4e24%5Cu884c%5Cu3002%5Cr%5Cn%5Cu7b2c%5Cu4e00%5Cu884c%5Cu6709%5Cu4e00%5Cu4e2a%5Cu6b63%5Cu6574%5Cu6570%20%2A%2An%2A%2A%20%28%20%2A%2An%2A%2A%20%3C%3D10%5E18%20%29%20%5Cuff0c%5Cr%5Cn%5Cu7b2c%5Cu4e8c%5Cu884c%5Cu6709%5Cu4e00%5Cu4e2a%5Cu5b57%5Cu7b26%5Cu4e32%20%2A%2At%2A%2A%20%28%20%7C%20%2A%2At%2A%2A%20%7C%3C%3D10%5E5%5Cu4e14%5Cu6bcf%5Cu4e2a%5Cu5b57%5Cu7b26%5Cu81f3%5Cu5c11%5Cu51fa%5Cu73b0%5Cu4e00%5Cu6b21%20%29%20%5Cu3002%5Cr%5Cn%23%23%23%20%5Cu8f93%5Cu51fa%5Cu683c%5Cu5f0f%5Cr%5Cn%5Cu4e00%5Cu884c%5Cu4e00%5Cu4e2a%5Cu6574%5Cu6570%5Cuff0c%5Cu4e3a%20Appleman%20%5Cu7684%5Cu6700%5Cu77ed%5Cu7528%5Cu65f6%5Cu3002%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A47%2C%22totalAccepted%22%3A23%2C%22pid%22%3A%22CF461E%22%2C%22title%22%3A%22Appleman%20and%20a%20Game%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A93011%2C%22title%22%3A%22%5Cu9898%5Cu76ee%5Cu5927%5Cu610f%22%2C%22forum%22%3A%7B%22id%22%3A10808%2C%22name%22%3A%22CF461E%20Appleman%20and%20a%20Game%22%2C%22slug%22%3A%22CF461E%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Appleman%20and%20a%20Game%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573306449;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Appleman and a Game</h1>
<h2>题意翻译</h2>
<div>## 题目描述
Appleman 和 Toastman 喜欢游戏。他们今天玩了一个跟字符串有关的游戏，其规则如下：
首先 Toastman 给出两个字符串 **s** 和 **t** ( 仅由 'A' , 'B' , 'C' , 'D' 构成 ) ，然后 Appleman 必须尽可能快地用 **t** 的子串构成 **s** 。开始时 Appleman 有一个空字符串，他每秒钟可以将 **t** 的一个子串接在这个字符串的后面。
现在游戏开始了， Toastman 已经给出了 **t** ，但他还没想好 **s** ， Toastman 想给出一个长度为 **n** ，并且使得 Appleman 用时最长的 **s** 。请你告诉 Toastman ，对于这样的 **s** ， Appleman 的最短用时是多久。
## 输入输出格式
### 输入格式
共两行。
第一行有一个正整数 **n** ( **n** <=10^18 ) ，
第二行有一个字符串 **t** ( | **t** |<=10^5且每个字符至少出现一次 ) 。
### 输出格式
一行一个整数，为 Appleman 的最短用时。</div>
<h2>题目描述</h2>
<div>Appleman and Toastman like games. Today they play a game with strings with the following rules. Firstly Toastman tells Appleman two strings $ s $ and $ t $ both consisting only of letters 'A', 'B', 'C', 'D'. Then Appleman must build string $ s $ as quickly as possible. Initially he has empty string, and in one second he can append to end of the current string any contiguous substring of $ t $ .
Now, Toastman and Appleman are beginning to play the game. Toastman has already told string $ t $ to Appleman, but he hasn't come up with string $ s $ yet. Toastman only thinks, that he should choose string $ s $ consisting of $ n $ characters. Of course, he wants to find the worst string for Appleman (such string, that Appleman will spend as much time as possible during the game). Tell Toastman, how much time will Appleman spend during the game if Toastman finds the worst string for him. You can assume that Appleman plays optimally, therefore he builds any string $ s $ in minimal possible time.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains an integer $ n $ ( $ 1<=n<=10^{18} $ ). The second line contains string $ t $ ( $ 1<=|t|<=10^{5} $ ). String $ t $ consists of only letters 'A', 'B', 'C', 'D'. Each letter appears at least once in string $ t $ .</div>
<h3>输出格式</h3>
<br />
<div>Print a single integer — the largest possible time Appleman needs.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>5
ABCCAD
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>5
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>5
AAABACADBABBBCBDCACBCCCDDDBDCDD
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>4
</code></pre>
<h2>说明</h2>
<div>In the first example, Toastman can choose $ s $ equal to "AAAAA".
In the second example, Toastman can choose $ s $ equal to "DADDA".</div>
</article>
</div>
</div>
</body>
</html>
