<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Conveyor Belts - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573394608:JBt7PHV9OYXBl5Du/LMqHWE/ZN8Imexs/zPJfswAtdY=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%22%2C%22description%22%3A%22Automatic%20Bakery%20of%20Cyberland%20%28ABC%29%20recently%20bought%20an%20%24%20n%5Cu00d7m%20%24%20rectangle%20table.%20To%20serve%20the%20diners%2C%20ABC%20placed%20seats%20around%20the%20table.%20The%20size%20of%20each%20seat%20is%20equal%20to%20a%20unit%20square%2C%20so%20there%20are%20%24%202%28n%2Bm%29%20%24%20seats%20in%20total.%5Cn%5CnABC%20placed%20conveyor%20belts%20on%20each%20unit%20square%20on%20the%20table.%20There%20are%20three%20types%20of%20conveyor%20belts%3A%20%5C%22%5E%5C%22%2C%20%5C%22%3C%5C%22%20and%20%5C%22%3E%5C%22.%20A%20%5C%22%5E%5C%22%20belt%20can%20bring%20things%20upwards.%20%5C%22%3C%5C%22%20can%20bring%20leftwards%20and%20%5C%22%3E%5C%22%20can%20bring%20rightwards.%5Cn%5CnLet%27s%20number%20the%20rows%20with%20%24%201%20%24%20to%20%24%20n%20%24%20from%20top%20to%20bottom%2C%20the%20columns%20with%20%24%201%20%24%20to%20%24%20m%20%24%20from%20left%20to%20right.%20We%20consider%20the%20seats%20above%20and%20below%20the%20top%20of%20the%20table%20are%20rows%20%24%200%20%24%20and%20%24%20n%2B1%20%24%20respectively.%20Also%20we%20define%20seats%20to%20the%20left%20of%20the%20table%20and%20to%20the%20right%20of%20the%20table%20to%20be%20column%20%24%200%20%24%20and%20%24%20m%2B1%20%24%20.%20Due%20to%20the%20conveyor%20belts%20direction%20restriction%20there%20are%20currently%20no%20way%20for%20a%20diner%20sitting%20in%20the%20row%20%24%20n%2B1%20%24%20to%20be%20served.%5Cn%5CnGiven%20the%20initial%20table%2C%20there%20will%20be%20%24%20q%20%24%20events%20in%20order.%20There%20are%20two%20types%20of%20events%3A%5Cn%5Cn-%20%5C%22A%20%24%20x%20%24%20%24%20y%20%24%20%5C%22%20means%2C%20a%20piece%20of%20bread%20will%20appear%20at%20row%20%24%20x%20%24%20and%20column%20%24%20y%20%24%20%28we%20will%20denote%20such%20position%20as%20%24%20%28x%2Cy%29%20%24%20%29.%20The%20bread%20will%20follow%20the%20conveyor%20belt%2C%20until%20arriving%20at%20a%20seat%20of%20a%20diner.%20It%20is%20possible%20that%20the%20bread%20gets%20stuck%20in%20an%20infinite%20loop.%20Your%20task%20is%20to%20simulate%20the%20process%2C%20and%20output%20the%20final%20position%20of%20the%20bread%2C%20or%20determine%20that%20there%20will%20be%20an%20infinite%20loop.%5Cn-%20%5C%22C%20%24%20x%20%24%20%24%20y%20%24%20%24%20c%20%24%20%5C%22%20means%20that%20the%20type%20of%20the%20conveyor%20belt%20at%20%24%20%28x%2Cy%29%20%24%20is%20changed%20to%20%24%20c%20%24%20.%5Cn%5CnQueries%20are%20performed%20separately%20meaning%20that%20even%20if%20the%20bread%20got%20stuck%20in%20an%20infinite%20loop%2C%20it%20won%27t%20affect%20further%20queries.%22%2C%22inputFormat%22%3A%22The%20first%20line%20of%20input%20contains%20three%20integers%20%24%20n%20%24%20%2C%20%24%20m%20%24%20and%20%24%20q%20%24%20%28%20%24%201%3C%3Dn%3C%3D10%5E%7B5%7D%2C1%3C%3Dm%3C%3D10%2C1%3C%3Dq%3C%3D10%5E%7B5%7D%20%24%20%29%2C%20separated%20by%20a%20space.%5Cn%5CnNext%20%24%20n%20%24%20lines%2C%20each%20line%20contains%20%24%20m%20%24%20characters%2C%20describing%20the%20table.%20The%20characters%20can%20only%20be%20one%20of%20%5C%22%3C%5E%3E%5C%22.%5Cn%5CnNext%20%24%20q%20%24%20lines%2C%20each%20line%20describes%20an%20event.%20The%20format%20is%20%5C%22C%20x%20y%20c%5C%22%20or%20%5C%22A%20x%20y%5C%22%20%28Consecutive%20elements%20are%20separated%20by%20a%20space%29.%20It%27s%20guaranteed%20that%20%24%201%3C%3Dx%3C%3Dn%2C1%3C%3Dy%3C%3Dm%20%24%20.%20%24%20c%20%24%20is%20a%20character%20from%20the%20set%20%5C%22%3C%5E%3E%5C%22.%5Cn%5CnThere%20are%20at%20most%20%24%2010000%20%24%20queries%20of%20%5C%22C%5C%22%20type.%22%2C%22outputFormat%22%3A%22For%20each%20event%20of%20type%20%5C%22A%5C%22%2C%20output%20two%20integers%20%24%20tx%20%24%20%2C%20%24%20ty%20%24%20in%20a%20line%2C%20separated%20by%20a%20space%2C%20denoting%20the%20destination%20of%20%24%20%28x%2Cy%29%20%24%20is%20%24%20%28tx%2Cty%29%20%24%20.%5Cn%5CnIf%20there%20is%20an%20infinite%20loop%2C%20you%20should%20output%20%24%20tx%3Dty%3D-1%20%24%20.%22%2C%22samples%22%3A%5B%5B%222%202%203%5Cn%3E%3E%5Cn%5E%5E%5CnA%202%201%5CnC%201%202%20%3C%5CnA%202%201%22%2C%221%203%5Cn-1%20-1%5Cn%22%5D%2C%5B%224%205%207%5Cn%3E%3C%3C%5E%3C%5Cn%5E%3C%5E%5E%3E%5Cn%3E%3E%3E%5E%3E%5Cn%3E%5E%3E%3E%5E%5CnA%203%201%5CnA%202%202%5CnC%201%204%20%3C%5CnA%203%201%5CnC%201%202%20%5E%5CnA%203%201%5CnA%202%202%22%2C%220%204%5Cn-1%20-1%5Cn-1%20-1%5Cn0%202%5Cn0%202%5Cn%22%5D%5D%2C%22hint%22%3A%22For%20the%20first%20sample%3A%5Cn%5CnIf%20the%20bread%20goes%20from%20%24%20%282%2C1%29%20%24%20%2C%20it%20will%20go%20out%20of%20the%20table%20at%20%24%20%281%2C3%29%20%24%20.%5Cn%5CnAfter%20changing%20the%20conveyor%20belt%20of%20%24%20%281%2C2%29%20%24%20to%20%5C%22%3C%5C%22%2C%20when%20the%20bread%20goes%20from%20%24%20%282%2C1%29%20%24%20again%2C%20it%20will%20get%20stuck%20at%20%5C%22%3E%3C%5C%22%2C%20so%20output%20is%20%24%20%28-1%2C-1%29%20%24%20.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B3000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F487%5C%2FD%22%2C%22id%22%3A%22487D%22%7D%2C%22translation%22%3A%22%5Cu6709%5Cu4e00%5Cu4e2a%24%20n%5Cu00d7m%20%24%5Cu7684%5Cu5730%5Cu56fe%5Cuff0c%5Cu4e0a%5Cu9762%5Cu6709%5Cu4e09%5Cu79cd%5Cu7b26%5Cu53f7%27%3C%5E%3E%27%20%5Cu5206%5Cu522b%5Cu8868%5Cu793a%5Cu5411%5Cu5de6%5Cuff0c%5Cu5411%5Cu4e0a%5Cuff0c%5Cu5411%5Cu53f3%5Cn%5Cn%5Cu6709%5Cu4e24%5Cu79cd%5Cu64cd%5Cu4f5c%5Cuff0cA%20X%20Y%5Cu8be2%5Cu95ee%5Cu4ece%5Cu4e00%5Cu4e2a%5Cu70b9%5Cuff08X%5Cuff0cY%5Cuff09%5Cu5f00%5Cu59cb%5Cu6700%5Cu7ec8%5Cu4f1a%5Cu8d70%5Cu5230%5Cu54ea%5Cu4e2a%5Cu70b9%5Cu6216%5Cu8005%5Cu6b7b%5Cu5faa%5Cu73af%20%5Cuff0c%20C%20X%20Y%20ch%20%5Cu8868%5Cu793a%5Cu5c06%5Cu5730%5Cu56fe%5Cu4e0a%5Cuff08X%5Cuff0cY%5Cuff09%5Cu7684%5Cu7b26%5Cu53f7%5Cu6362%5Cu6210ch%5Cn%5Cn%5Cu6570%5Cu636e%5Cu8303%5Cu56f4%24%201%20%5C%5Cleq%20n%20%5C%5Cleq%2010%5E5%20%24%5Cuff0c%24%201%20%5C%5Cleq%20m%20%5C%5Cleq%2010%20%24%5Cuff0cC%5Cu64cd%5Cu4f5c%5Cu6700%5Cu591a%24%2010000%20%24%5Cu6b21%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A25%2C%22totalAccepted%22%3A13%2C%22pid%22%3A%22CF487D%22%2C%22title%22%3A%22Conveyor%20Belts%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Conveyor%20Belts%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Conveyor Belts</h1>
<h2>题意翻译</h2>
<div>有一个$ n×m $的地图，上面有三种符号'<^>' 分别表示向左，向上，向右
有两种操作，A X Y询问从一个点（X，Y）开始最终会走到哪个点或者死循环 ， C X Y ch 表示将地图上（X，Y）的符号换成ch
数据范围$ 1 \leq n \leq 10^5 $，$ 1 \leq m \leq 10 $，C操作最多$ 10000 $次</div>
<h2>题目描述</h2>
<div>Automatic Bakery of Cyberland (ABC) recently bought an $ n×m $ rectangle table. To serve the diners, ABC placed seats around the table. The size of each seat is equal to a unit square, so there are $ 2(n+m) $ seats in total.
ABC placed conveyor belts on each unit square on the table. There are three types of conveyor belts: "^", "<" and ">". A "^" belt can bring things upwards. "<" can bring leftwards and ">" can bring rightwards.
Let's number the rows with $ 1 $ to $ n $ from top to bottom, the columns with $ 1 $ to $ m $ from left to right. We consider the seats above and below the top of the table are rows $ 0 $ and $ n+1 $ respectively. Also we define seats to the left of the table and to the right of the table to be column $ 0 $ and $ m+1 $ . Due to the conveyor belts direction restriction there are currently no way for a diner sitting in the row $ n+1 $ to be served.
Given the initial table, there will be $ q $ events in order. There are two types of events:
- "A $ x $ $ y $ " means, a piece of bread will appear at row $ x $ and column $ y $ (we will denote such position as $ (x,y) $ ). The bread will follow the conveyor belt, until arriving at a seat of a diner. It is possible that the bread gets stuck in an infinite loop. Your task is to simulate the process, and output the final position of the bread, or determine that there will be an infinite loop.
- "C $ x $ $ y $ $ c $ " means that the type of the conveyor belt at $ (x,y) $ is changed to $ c $ .
Queries are performed separately meaning that even if the bread got stuck in an infinite loop, it won't affect further queries.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line of input contains three integers $ n $ , $ m $ and $ q $ ( $ 1<=n<=10^{5},1<=m<=10,1<=q<=10^{5} $ ), separated by a space.
Next $ n $ lines, each line contains $ m $ characters, describing the table. The characters can only be one of "<^>".
Next $ q $ lines, each line describes an event. The format is "C x y c" or "A x y" (Consecutive elements are separated by a space). It's guaranteed that $ 1<=x<=n,1<=y<=m $ . $ c $ is a character from the set "<^>".
There are at most $ 10000 $ queries of "C" type.</div>
<h3>输出格式</h3>
<br />
<div>For each event of type "A", output two integers $ tx $ , $ ty $ in a line, separated by a space, denoting the destination of $ (x,y) $ is $ (tx,ty) $ .
If there is an infinite loop, you should output $ tx=ty=-1 $ .</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>2 2 3
&gt;&gt;
^^
A 2 1
C 1 2 &lt;
A 2 1</code></pre>
<h3>输出样例 #1</h3>
<pre><code>1 3
-1 -1
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>4 5 7
&gt;&lt;&lt;^&lt;
^&lt;^^&gt;
&gt;&gt;&gt;^&gt;
&gt;^&gt;&gt;^
A 3 1
A 2 2
C 1 4 &lt;
A 3 1
C 1 2 ^
A 3 1
A 2 2</code></pre>
<h3>输出样例 #2</h3>
<pre><code>0 4
-1 -1
-1 -1
0 2
0 2
</code></pre>
<h2>说明</h2>
<div>For the first sample:
If the bread goes from $ (2,1) $ , it will go out of the table at $ (1,3) $ .
After changing the conveyor belt of $ (1,2) $ to "<", when the bread goes from $ (2,1) $ again, it will get stuck at "><", so output is $ (-1,-1) $ .</div>
</article>
</div>
</div>
</body>
</html>
