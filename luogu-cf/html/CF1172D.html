<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Nauuo and Portals - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573402564:8/q2tZ8Q2ua419qkVpFAijHcUJl7LFh9vCzibZzZCVg=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Nauuo%20is%20a%20girl%20who%20loves%20playing%20games%20related%20to%20portals.%5Cn%5CnOne%20day%20she%20was%20playing%20a%20game%20as%20follows.%5Cn%5CnIn%20an%20%24%20n%5C%5Ctimes%20n%20%24%20grid%2C%20the%20rows%20are%20numbered%20from%20%24%201%20%24%20to%20%24%20n%20%24%20from%20top%20to%20bottom%2C%20the%20columns%20are%20numbered%20from%20%24%201%20%24%20to%20%24%20n%20%24%20from%20left%20to%20right.%20We%20denote%20a%20cell%20on%20the%20intersection%20of%20the%20%24%20r%20%24%20-th%20row%20and%20%24%20c%20%24%20-th%20column%20as%20%24%20%28r%2Cc%29%20%24%20.%5Cn%5CnA%20portal%20is%20a%20pair%20of%20doors.%20You%20can%20travel%20from%20one%20of%20them%20to%20another%20without%20changing%20your%20direction.%20More%20formally%2C%20if%20you%20walk%20into%20a%20cell%20with%20a%20door%2C%20you%20will%20teleport%20to%20the%20cell%20with%20the%20other%20door%20of%20the%20same%20portal%20and%20then%20walk%20into%20the%20next%20cell%20facing%20the%20original%20direction.%20There%20can%20not%20be%20more%20than%20one%20doors%20in%20a%20single%20cell.%5Cn%5CnThe%20%5C%22next%20cell%5C%22%20is%20the%20nearest%20cell%20in%20the%20direction%20you%20are%20facing.%20For%20example%2C%20if%20you%20are%20facing%20bottom%2C%20the%20next%20cell%20of%20%24%20%282%2C5%29%20%24%20is%20%24%20%283%2C5%29%20%24%20.%5Cn%5CnIf%20you%20walk%20into%20a%20cell%20without%20a%20door%2C%20you%20must%20walk%20into%20the%20next%20cell%20after%20that%20without%20changing%20the%20direction.%20If%20the%20next%20cell%20does%20not%20exist%2C%20you%20must%20exit%20the%20grid.%5Cn%5CnYou%20have%20to%20set%20some%20%28possibly%20zero%29%20portals%20in%20the%20grid%2C%20so%20that%20if%20you%20walk%20into%20%24%20%28i%2C1%29%20%24%20facing%20right%2C%20you%20will%20eventually%20exit%20the%20grid%20from%20%24%20%28r_i%2Cn%29%20%24%20%2C%20if%20you%20walk%20into%20%24%20%281%2C%20i%29%20%24%20facing%20bottom%2C%20you%20will%20exit%20the%20grid%20from%20%24%20%28n%2Cc_i%29%20%24%20.%5Cn%5CnIt%20is%20guaranteed%20that%20both%20%24%20r_%7B1..n%7D%20%24%20and%20%24%20c_%7B1..n%7D%20%24%20are%20permutations%20of%20%24%20n%20%24%20elements.%20A%20permutation%20of%20%24%20n%20%24%20elements%20is%20a%20sequence%20of%20numbers%20%24%20p_1%2Cp_2%2C%5C%5Cldots%2Cp_n%20%24%20in%20which%20every%20integer%20from%20%24%201%20%24%20to%20%24%20n%20%24%20appears%20exactly%20once.%5Cn%5CnShe%20got%20confused%20while%20playing%20the%20game%2C%20can%20you%20help%20her%20to%20find%20a%20solution%3F%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20a%20single%20integer%20%24%20n%20%24%20%28%20%24%201%5C%5Cle%20n%5C%5Cle%201000%20%24%20%29%20%5Cu2014%20the%20side%20length%20of%20the%20grid.%5Cn%5CnThe%20second%20line%20contains%20%24%20n%20%24%20integers%20%24%20r_1%2Cr_2%2C%5C%5Cldots%2Cr_n%20%24%20%28%20%24%201%5C%5Cle%20r_i%5C%5Cle%20n%20%24%20%29%20%5Cu2014%20if%20you%20walk%20into%20%24%20%28i%2C1%29%20%24%20facing%20right%2C%20you%20should%20exit%20the%20grid%20from%20%24%20%28r_i%2Cn%29%20%24%20.%20It%20is%20guaranteed%20that%20%24%20r_%7B1..n%7D%20%24%20is%20a%20permutation%20of%20%24%20n%20%24%20elements.%5Cn%5CnThe%20third%20line%20contains%20%24%20n%20%24%20integers%20%24%20c_1%2Cc_2%2C%5C%5Cldots%2Cc_n%20%24%20%28%20%24%201%5C%5Cle%20c_i%5C%5Cle%20n%20%24%20%29%20%5Cu2014%20if%20you%20walk%20into%20%24%20%281%2Ci%29%20%24%20facing%20bottom%2C%20you%20should%20exit%20the%20grid%20from%20%24%20%28n%2Cc_i%29%20%24%20.%20It%20is%20guaranteed%20that%20%24%20c_%7B1..n%7D%20%24%20is%20a%20permutation%20of%20%24%20n%20%24%20elements.%22%2C%22outputFormat%22%3A%22If%20it%20is%20impossible%20to%20satisfy%20the%20rule%2C%20print%20the%20only%20number%20%24%20-1%20%24%20.%5Cn%5CnOtherwise%20the%20first%20line%20should%20contain%20a%20single%20integer%20%24%20m%20%24%20%28%20%24%200%5C%5Cle%20m%5C%5Cle%5C%5Cfrac%7Bn%5E2%7D2%20%24%20%29%20%5Cu2014%20the%20number%20of%20portals%20you%20set.%5Cn%5CnIn%20the%20following%20%24%20m%20%24%20lines%2C%20each%20line%20should%20contain%20four%20integers%20%24%20x_1%2Cy_1%2Cx_2%2Cy_2%20%24%20%2C%20represents%20that%20you%20set%20a%20portal%20consisting%20of%20two%20doors%20in%20%24%20%28x_1%2Cy_1%29%20%24%20and%20%24%20%28x_2%2Cy_2%29%20%24%20.%5Cn%5CnIf%20there%20are%20multiple%20answers%2C%20print%20any.%20You%20do%20not%20have%20to%20minimize%20%24%20m%20%24%20.%22%2C%22samples%22%3A%5B%5B%22%5Cn3%5Cn1%203%202%5Cn3%201%202%5Cn%22%2C%22%5Cn2%5Cn1%201%201%203%5Cn2%202%203%201%22%5D%2C%5B%22%5Cn5%5Cn3%201%205%204%202%5Cn4%202%201%203%205%5Cn%22%2C%22%5Cn3%5Cn1%201%203%204%5Cn2%202%203%202%5Cn2%203%205%201%5Cn%22%5D%5D%2C%22hint%22%3A%22Example%201%5Cn%5CnThe%20cells%20with%20the%20same%20letter%20are%20a%20portal.%20You%20can%20set%20portals%20in%20this%20way%3A%5Cn%5Cn%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF1172D%5C%2Fde3b611b4d4e6cd05ce6ba2b1f72d4389000aa30.png%29%5Cn%5CnIt%20satisfies%20the%20rule%2C%20because%3A%5Cn%5Cn%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF1172D%5C%2F49650c112ee3bd1b70e4b7de2986ac0cdfbc6ade.png%29%5Cn%5CnExample%202%5Cn%5CnYou%20can%20set%20portals%20in%20this%20way%3A%5Cn%5Cn%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF1172D%5C%2Fa92305b6c403f6d70c71ef63077c9a38589be5ff.png%29%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F1172%5C%2FD%22%2C%22id%22%3A%221172D%22%7D%2C%22translation%22%3A%22%5Cu5b9a%5Cu4e49%2A%2A%5Cu4e00%5Cu5bf9%2A%2A%5Cu4f20%5Cu9001%5Cu95e8%20%24%28A%2CB%29%24%20%5Cu4e3a%5Cu4ece%20%24A%24%20%5Cu95e8%5Cu8fdb%5Cu5165%5Cu4f1a%5Cu4ece%20%24B%24%20%5Cu95e8%5Cu51fa%5Cu6765%5Cuff0c%5Cu4e14%5Cu4fdd%5Cu6301%5Cu8fdb%5Cu5165%20%24A%24%20%5Cu95e8%5Cu7684%5Cu65b9%5Cu5411%5Cuff08%5Cu4ece%20%24B%24%20%5Cu8fdb%5Cu53bb%5Cu540c%5Cu7406%5Cuff09%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu7ed9%5Cu51fa%5Cu4e00%5Cu4e2a%20%24n%5C%5Ctimes%20n%24%20%5Cu7684%5Cu77e9%5Cu5f62%5Cu548c%20%242n%24%20%5Cu4e2a%5Cu8981%5Cu6c42%5Cuff0c%5Cu5176%5Cu4e2d%5Cu524d%20%24n%24%20%5Cu4e2a%5Cu8981%5Cu6c42%5Cu7684%5Cu5f62%5Cu5f0f%5Cu4e3a%20%24%28r_i%2Cn%29%24%5Cuff0c%5Cu4ee3%5Cu8868%20%24%5C%5Ctexttt%7BNauuo%7D%24%20%5Cu4ece%20%24%28i%2C1%29%24%20%5Cu8fd9%5Cu4e2a%5Cu683c%5Cu5b50%5Cu51fa%5Cu53d1%2A%2A%5Cu4e00%5Cu76f4%5Cu5411%5Cu53f3%5Cu8d70%2A%2A%5Cuff0c%5Cu7ecf%5Cu8fc7%5Cu82e5%5Cu5e72%5Cu5bf9%5Cu4f20%5Cu9001%5Cu95e8%5Cuff08%5Cu6216%5Cu8005%5Cu4e0d%5Cu7ecf%5Cu8fc7%5Cu4f20%5Cu9001%5Cu95e8%5Cuff09%5Cu540e%5Cu4ece%20%24%28r_i%2Cn%29%24%20%5Cu8fd9%5Cu4e2a%5Cu683c%5Cu5b50%2A%2A%5Cu8d70%5Cu51fa%2A%2A%5Cu77e9%5Cu5f62%5Cuff1b%5Cu540e%20nnn%20%5Cu4e2a%5Cu8981%5Cu6c42%5Cu7684%5Cu5f62%5Cu5f0f%5Cu4e3a%20%24%28n%2Cc_i%29%24%5Cuff0c%5Cu4ee3%5Cu8868%20%24%5C%5Ctexttt%7BNauuo%7D%24%20%5Cu4ece%20%24%281%2Ci%29%24%20%5Cu8fd9%5Cu4e2a%5Cu683c%5Cu5b50%5Cu51fa%5Cu53d1%2A%2A%5Cu4e00%5Cu76f4%5Cu5411%5Cu4e0b%5Cu8d70%2A%2A%5Cuff0c%5Cu7ecf%5Cu8fc7%5Cu82e5%5Cu5e72%5Cu5bf9%5Cu4f20%5Cu9001%5Cu95e8%5Cuff08%5Cu6216%5Cu8005%5Cu4e0d%5Cu7ecf%5Cu8fc7%5Cu4f20%5Cu9001%5Cu95e8%5Cuff09%5Cu540e%5Cu4ece%20%24%28n%2Cc_i%29%24%20%5Cu8fd9%5Cu4e2a%5Cu683c%5Cu5b50%2A%2A%5Cu8d70%5Cu51fa%2A%2A%5Cu77e9%5Cu5f62%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu8bf7%5Cu4f60%5Cu5728%5Cu8fd9%5Cu4e2a%20%24n%5C%5Ctimes%20n%24%20%5Cu7684%5Cu77e9%5Cu5f62%5Cu4e2d%5Cu653e%5Cu7f6e%5Cu82e5%5Cu5e72%5Cu5bf9%5Cu4f20%5Cu9001%5Cu95e8%5Cuff0c%5Cu4f7f%5Cu5f97%5Cu8fd9%20%242n%24%20%5Cu4e2a%5Cu8bf7%5Cu6c42%5Cu53ef%5Cu4ee5%5Cu540c%5Cu65f6%5Cu6ee1%5Cu8db3%5Cu3002%5Cu8f93%5Cu51fa%5Cu4f20%5Cu9001%5Cu95e8%5Cu7684%2A%2A%5Cu5bf9%5Cu6570%2A%2A%5Cu548c%2A%2A%5Cu6bcf%5Cu5bf9%5Cu4f20%5Cu9001%5Cu95e8%5Cu4e24%5Cu4e2a%5Cu95e8%5Cu5404%5Cu81ea%5Cu7684%5Cu5750%5Cu6807%2A%2A%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu65e0%5Cu89e3%5Cu65f6%5Cu8f93%5Cu51fa%20%24-1%24%5Cu3002%5Cr%5Cn%5Cr%5Cn%2A%2A%5Cu6ce8%5Cu610f%5Cuff1a%5Cu4f60%5Cu4e0d%5Cu9700%5Cu8981%5Cu627e%5Cu5230%5Cu4f7f%5Cu7528%5Cu4f20%5Cu9001%5Cu95e8%5Cu6700%5Cu5c11%5Cu7684%5Cu65b9%5Cu6848%5Cu6570%5Cuff0c%5Cu53ea%5Cu9700%5Cu8981%5Cu8ba9%5Cu4f60%5Cu7ed9%5Cu51fa%5Cu7684%5Cu65b9%5Cu6848%5Cu53ef%5Cu4ee5%5Cu6ee1%5Cu8db3%5Cu9898%5Cu76ee%5Cu4e2d%5Cu7ed9%5Cu51fa%5Cu7684%5Cu8981%5Cu6c42%5Cu3002%2A%2A%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A55%2C%22totalAccepted%22%3A26%2C%22pid%22%3A%22CF1172D%22%2C%22title%22%3A%22Nauuo%20and%20Portals%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A118328%2C%22title%22%3A%22%5Cu6ce8%5Cu610f%5Cu9898%5Cu76ee%5Cu4fdd%5Cu8bc1ri%5Cu548cci%5Cu5747%5Cu4e3a%5Cu6392%5Cu5217%22%2C%22forum%22%3A%7B%22id%22%3A37086%2C%22name%22%3A%22CF1172D%20Nauuo%20and%20Portals%22%2C%22slug%22%3A%22CF1172D%22%7D%7D%2C%7B%22id%22%3A118285%2C%22title%22%3A%22%5Cu7ffb%5Cu8bd1%5Cu6709%5Cu70b9%5Cu5c0f%5Cu95ee%5Cu9898%22%2C%22forum%22%3A%7B%22id%22%3A37086%2C%22name%22%3A%22CF1172D%20Nauuo%20and%20Portals%22%2C%22slug%22%3A%22CF1172D%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P3791%22%2C%22title%22%3A%22%5Cu666e%5Cu901a%5Cu6570%5Cu5b66%5Cu9898%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22CF896C%22%2C%22title%22%3A%22Willem%2C%20Chtholly%20and%20Seniorious%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22P5158%22%2C%22title%22%3A%22%5Cu3010%5Cu6a21%5Cu677f%5Cu3011%5Cu591a%5Cu9879%5Cu5f0f%5Cu5feb%5Cu901f%5Cu63d2%5Cu503c%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22CF1172B%22%2C%22title%22%3A%22Nauuo%20and%20Circle%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1228D%22%2C%22title%22%3A%22Complete%20Tripartite%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Nauuo%20and%20Portals%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Nauuo and Portals</h1>
<h2>题意翻译</h2>
<div>定义**一对**传送门 $(A,B)$ 为从 $A$ 门进入会从 $B$ 门出来，且保持进入 $A$ 门的方向（从 $B$ 进去同理）。
给出一个 $n\times n$ 的矩形和 $2n$ 个要求，其中前 $n$ 个要求的形式为 $(r_i,n)$，代表 $\texttt{Nauuo}$ 从 $(i,1)$ 这个格子出发**一直向右走**，经过若干对传送门（或者不经过传送门）后从 $(r_i,n)$ 这个格子**走出**矩形；后 nnn 个要求的形式为 $(n,c_i)$，代表 $\texttt{Nauuo}$ 从 $(1,i)$ 这个格子出发**一直向下走**，经过若干对传送门（或者不经过传送门）后从 $(n,c_i)$ 这个格子**走出**矩形。
请你在这个 $n\times n$ 的矩形中放置若干对传送门，使得这 $2n$ 个请求可以同时满足。输出传送门的**对数**和**每对传送门两个门各自的坐标**。
无解时输出 $-1$。
**注意：你不需要找到使用传送门最少的方案数，只需要让你给出的方案可以满足题目中给出的要求。**</div>
<h2>题目描述</h2>
<div>Nauuo is a girl who loves playing games related to portals.
One day she was playing a game as follows.
In an $ n\times n $ grid, the rows are numbered from $ 1 $ to $ n $ from top to bottom, the columns are numbered from $ 1 $ to $ n $ from left to right. We denote a cell on the intersection of the $ r $ -th row and $ c $ -th column as $ (r,c) $ .
A portal is a pair of doors. You can travel from one of them to another without changing your direction. More formally, if you walk into a cell with a door, you will teleport to the cell with the other door of the same portal and then walk into the next cell facing the original direction. There can not be more than one doors in a single cell.
The "next cell" is the nearest cell in the direction you are facing. For example, if you are facing bottom, the next cell of $ (2,5) $ is $ (3,5) $ .
If you walk into a cell without a door, you must walk into the next cell after that without changing the direction. If the next cell does not exist, you must exit the grid.
You have to set some (possibly zero) portals in the grid, so that if you walk into $ (i,1) $ facing right, you will eventually exit the grid from $ (r_i,n) $ , if you walk into $ (1, i) $ facing bottom, you will exit the grid from $ (n,c_i) $ .
It is guaranteed that both $ r_{1..n} $ and $ c_{1..n} $ are permutations of $ n $ elements. A permutation of $ n $ elements is a sequence of numbers $ p_1,p_2,\ldots,p_n $ in which every integer from $ 1 $ to $ n $ appears exactly once.
She got confused while playing the game, can you help her to find a solution?</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains a single integer $ n $ ( $ 1\le n\le 1000 $ ) — the side length of the grid.
The second line contains $ n $ integers $ r_1,r_2,\ldots,r_n $ ( $ 1\le r_i\le n $ ) — if you walk into $ (i,1) $ facing right, you should exit the grid from $ (r_i,n) $ . It is guaranteed that $ r_{1..n} $ is a permutation of $ n $ elements.
The third line contains $ n $ integers $ c_1,c_2,\ldots,c_n $ ( $ 1\le c_i\le n $ ) — if you walk into $ (1,i) $ facing bottom, you should exit the grid from $ (n,c_i) $ . It is guaranteed that $ c_{1..n} $ is a permutation of $ n $ elements.</div>
<h3>输出格式</h3>
<br />
<div>If it is impossible to satisfy the rule, print the only number $ -1 $ .
Otherwise the first line should contain a single integer $ m $ ( $ 0\le m\le\frac{n^2}2 $ ) — the number of portals you set.
In the following $ m $ lines, each line should contain four integers $ x_1,y_1,x_2,y_2 $ , represents that you set a portal consisting of two doors in $ (x_1,y_1) $ and $ (x_2,y_2) $ .
If there are multiple answers, print any. You do not have to minimize $ m $ .</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>
3
1 3 2
3 1 2
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>
2
1 1 1 3
2 2 3 1</code></pre>
<h3>输入样例 #2</h3>
<pre><code>
5
3 1 5 4 2
4 2 1 3 5
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>
3
1 1 3 4
2 2 3 2
2 3 5 1
</code></pre>
<h2>说明</h2>
<div>Example 1
The cells with the same letter are a portal. You can set portals in this way:
![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1172D/de3b611b4d4e6cd05ce6ba2b1f72d4389000aa30.png)
It satisfies the rule, because:
![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1172D/49650c112ee3bd1b70e4b7de2986ac0cdfbc6ade.png)
Example 2
You can set portals in this way:
![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1172D/a92305b6c403f6d70c71ef63077c9a38589be5ff.png)</div>
</article>
</div>
</div>
</body>
</html>
