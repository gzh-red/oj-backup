<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Tavas and Malekas - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573395203:cDP7srmniFfqcfwkA2e8oOShyBCxKP9IWndtb9u8efI=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Tavas%20is%20a%20strange%20creature.%20Usually%20%5C%22zzz%5C%22%20comes%20out%20of%20people%27s%20mouth%20while%20sleeping%2C%20but%20string%20%24%20s%20%24%20of%20length%20%24%20n%20%24%20comes%20out%20from%20Tavas%27%20mouth%20instead.%5Cn%5Cn%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF535D%5C%2Fedec2eae8d180d77009c457fa18d1007b3d9ea05.png%29Today%20Tavas%20fell%20asleep%20in%20Malekas%27%20place.%20While%20he%20was%20sleeping%2C%20Malekas%20did%20a%20little%20process%20on%20%24%20s%20%24%20.%20Malekas%20has%20a%20favorite%20string%20%24%20p%20%24%20.%20He%20determined%20all%20positions%20%24%20x_%7B1%7D%26lt%3Bx_%7B2%7D%26lt%3B...%26lt%3Bx_%7Bk%7D%20%24%20where%20%24%20p%20%24%20matches%20%24%20s%20%24%20.%20More%20formally%2C%20for%20each%20%24%20x_%7Bi%7D%20%24%20%28%20%24%201%3C%3Di%3C%3Dk%20%24%20%29%20he%20condition%20%24%20s_%7Bxi%7Ds_%7Bxi%7D%2B1...%5C%5C%20s_%7Bxi%7D%2B%7Cp%7C-1%3Dp%20%24%20is%20fullfilled.%5Cn%5CnThen%20Malekas%20wrote%20down%20one%20of%20subsequences%20of%20%24%20x_%7B1%7D%2Cx_%7B2%7D%2C...%5C%5C%20x_%7Bk%7D%20%24%20%28possibly%2C%20he%20didn%27t%20write%20anything%29%20on%20a%20piece%20of%20paper.%20Here%20a%20sequence%20%24%20b%20%24%20is%20a%20subsequence%20of%20sequence%20%24%20a%20%24%20if%20and%20only%20if%20we%20can%20turn%20%24%20a%20%24%20into%20%24%20b%20%24%20by%20removing%20some%20of%20its%20elements%20%28maybe%20no%20one%20of%20them%20or%20all%29.%5Cn%5CnAfter%20Tavas%20woke%20up%2C%20Malekas%20told%20him%20everything.%20He%20couldn%27t%20remember%20string%20%24%20s%20%24%20%2C%20but%20he%20knew%20that%20both%20%24%20p%20%24%20and%20%24%20s%20%24%20only%20contains%20lowercase%20English%20letters%20and%20also%20he%20had%20the%20subsequence%20he%20had%20written%20on%20that%20piece%20of%20paper.%5Cn%5CnTavas%20wonders%2C%20what%20is%20the%20number%20of%20possible%20values%20of%20%24%20s%20%24%20%3F%20He%20asked%20SaDDas%2C%20but%20he%20wasn%27t%20smart%20enough%20to%20solve%20this.%20So%2C%20Tavas%20asked%20you%20to%20calculate%20this%20number%20for%20him.%5Cn%5CnAnswer%20can%20be%20very%20large%2C%20so%20Tavas%20wants%20you%20to%20print%20the%20answer%20modulo%20%24%2010%5E%7B9%7D%2B7%20%24%20.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20two%20integers%20%24%20n%20%24%20and%20%24%20m%20%24%20%2C%20the%20length%20of%20%24%20s%20%24%20and%20the%20length%20of%20the%20subsequence%20Malekas%20wrote%20down%20%28%20%24%201%3C%3Dn%3C%3D10%5E%7B6%7D%20%24%20and%20%24%200%3C%3Dm%3C%3Dn-%7Cp%7C%2B1%20%24%20%29.%5Cn%5CnThe%20second%20line%20contains%20string%20%24%20p%20%24%20%28%20%24%201%3C%3D%7Cp%7C%3C%3Dn%20%24%20%29.%5Cn%5CnThe%20next%20line%20contains%20%24%20m%20%24%20space%20separated%20integers%20%24%20y_%7B1%7D%2Cy_%7B2%7D%2C...%2Cy_%7Bm%7D%20%24%20%2C%20Malekas%27%20subsequence%20%28%20%24%201%3C%3Dy_%7B1%7D%26lt%3By_%7B2%7D%26lt%3B...%26lt%3By_%7Bm%7D%3C%3Dn-%7Cp%7C%2B1%20%24%20%29.%22%2C%22outputFormat%22%3A%22In%20a%20single%20line%20print%20the%20answer%20modulo%20%24%201000000007%20%24%20.%22%2C%22samples%22%3A%5B%5B%226%202%5Cnioi%5Cn1%203%5Cn%22%2C%2226%5Cn%22%5D%2C%5B%225%202%5Cnioi%5Cn1%202%5Cn%22%2C%220%5Cn%22%5D%5D%2C%22hint%22%3A%22In%20the%20first%20sample%20test%20all%20strings%20of%20form%20%5C%22ioioi%3F%5C%22%20where%20the%20question%20mark%20replaces%20arbitrary%20English%20letter%20satisfy.%5Cn%5CnHere%20%24%20%7Cx%7C%20%24%20denotes%20the%20length%20of%20string%20x.%5Cn%5CnPlease%20note%20that%20it%27s%20possible%20that%20there%20is%20no%20such%20string%20%28answer%20is%200%29.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F535%5C%2FD%22%2C%22id%22%3A%22535D%22%7D%2C%22translation%22%3A%22%5Cu7ed9%5Cu4f60%5Cu4e00%5Cu4e2a%24n%24%5Cuff0c%5Cu6709%24m%24%5Cu4e2a%5Cu6570%24a_%7Bi%7D%24%5Cuff0c%5Cu8fd8%5Cu6709%5Cu4e00%5Cu4e2a%5Cu5b57%5Cu7b26%5Cu4e32%5Cuff0c%5Cu95ee%5Cu662f%5Cu5426%5Cu80fd%5Cu6784%5Cu9020%5Cu51fa%5Cu5728%24a_%7Bi%7D%24%5Cu8fd9%5Cu4e2a%5Cu4f4d%5Cu7f6e%5Cu63d2%5Cu5165%5Cu8fd9%5Cu4e9b%5Cu5b57%5Cu7b26%5Cu4e32%5Cuff0c%5Cu7136%5Cu540e%5Cu6c42%5Cu6784%5Cu9020%5Cu7684%5Cu65b9%5Cu6cd5%5Cu6709%5Cu591a%5Cu5c11%5Cu79cd%5Cu3002%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A189%2C%22totalAccepted%22%3A71%2C%22pid%22%3A%22CF535D%22%2C%22title%22%3A%22Tavas%20and%20Malekas%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P2414%22%2C%22title%22%3A%22%5BNOI2011%5D%5Cu963f%5Cu72f8%5Cu7684%5Cu6253%5Cu5b57%5Cu673a%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22CF706D%22%2C%22title%22%3A%22Vasiliy%27s%20Multiset%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF633C%22%2C%22title%22%3A%22Spy%20Syndrome%202%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22P4824%22%2C%22title%22%3A%22%5BUSACO15FEB%5DCensoring%20%28Silver%29%20%5Cu5ba1%5Cu67e5%28%5Cu94f6%29%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22CF1120C%22%2C%22title%22%3A%22Compress%20String%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Tavas%20and%20Malekas%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Tavas and Malekas</h1>
<h2>题意翻译</h2>
<div>给你一个$n$，有$m$个数$a_{i}$，还有一个字符串，问是否能构造出在$a_{i}$这个位置插入这些字符串，然后求构造的方法有多少种。</div>
<h2>题目描述</h2>
<div>Tavas is a strange creature. Usually "zzz" comes out of people's mouth while sleeping, but string $ s $ of length $ n $ comes out from Tavas' mouth instead.
![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF535D/edec2eae8d180d77009c457fa18d1007b3d9ea05.png)Today Tavas fell asleep in Malekas' place. While he was sleeping, Malekas did a little process on $ s $ . Malekas has a favorite string $ p $ . He determined all positions $ x_{1}&lt;x_{2}&lt;...&lt;x_{k} $ where $ p $ matches $ s $ . More formally, for each $ x_{i} $ ( $ 1<=i<=k $ ) he condition $ s_{xi}s_{xi}+1...\ s_{xi}+|p|-1=p $ is fullfilled.
Then Malekas wrote down one of subsequences of $ x_{1},x_{2},...\ x_{k} $ (possibly, he didn't write anything) on a piece of paper. Here a sequence $ b $ is a subsequence of sequence $ a $ if and only if we can turn $ a $ into $ b $ by removing some of its elements (maybe no one of them or all).
After Tavas woke up, Malekas told him everything. He couldn't remember string $ s $ , but he knew that both $ p $ and $ s $ only contains lowercase English letters and also he had the subsequence he had written on that piece of paper.
Tavas wonders, what is the number of possible values of $ s $ ? He asked SaDDas, but he wasn't smart enough to solve this. So, Tavas asked you to calculate this number for him.
Answer can be very large, so Tavas wants you to print the answer modulo $ 10^{9}+7 $ .</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains two integers $ n $ and $ m $ , the length of $ s $ and the length of the subsequence Malekas wrote down ( $ 1<=n<=10^{6} $ and $ 0<=m<=n-|p|+1 $ ).
The second line contains string $ p $ ( $ 1<=|p|<=n $ ).
The next line contains $ m $ space separated integers $ y_{1},y_{2},...,y_{m} $ , Malekas' subsequence ( $ 1<=y_{1}&lt;y_{2}&lt;...&lt;y_{m}<=n-|p|+1 $ ).</div>
<h3>输出格式</h3>
<br />
<div>In a single line print the answer modulo $ 1000000007 $ .</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>6 2
ioi
1 3
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>26
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>5 2
ioi
1 2
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>0
</code></pre>
<h2>说明</h2>
<div>In the first sample test all strings of form "ioioi?" where the question mark replaces arbitrary English letter satisfy.
Here $ |x| $ denotes the length of string x.
Please note that it's possible that there is no such string (answer is 0).</div>
</article>
</div>
</div>
</body>
</html>
