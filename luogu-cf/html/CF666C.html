<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Codeword - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573396513:fM6uhVoE+VnCmorC1eVWbQnkpkDd4xM+JF1IGyGDYAs=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22The%20famous%20sculptor%20Cicasso%20is%20a%20Reberlandian%20spy%21%5Cn%5CnThese%20is%20breaking%20news%20in%20Berlandian%20papers%20today.%20And%20now%20the%20sculptor%20is%20hiding.%20This%20time%20you%20give%20the%20shelter%20to%20the%20maestro.%20You%20have%20a%20protected%20bunker%20and%20you%20provide%20it%20to%20your%20friend.%20You%20set%20the%20security%20system%20in%20such%20way%20that%20only%20you%20can%20open%20the%20bunker.%20To%20open%20it%20one%20should%20solve%20the%20problem%20which%20is%20hard%20for%20others%20but%20is%20simple%20for%20you.%5Cn%5CnEvery%20day%20the%20bunker%20generates%20a%20codeword%20%24%20s%20%24%20.%20Every%20time%20someone%20wants%20to%20enter%20the%20bunker%2C%20integer%20%24%20n%20%24%20appears%20on%20the%20screen.%20As%20the%20answer%20one%20should%20enter%20another%20integer%20%5Cu2014%20the%20residue%20modulo%20%24%2010%5E%7B9%7D%2B7%20%24%20of%20the%20number%20of%20strings%20of%20length%20%24%20n%20%24%20that%20consist%20only%20of%20lowercase%20English%20letters%20and%20contain%20the%20string%20%24%20s%20%24%20as%20the%20subsequence.%5Cn%5CnThe%20subsequence%20of%20string%20%24%20a%20%24%20is%20a%20string%20%24%20b%20%24%20that%20can%20be%20derived%20from%20the%20string%20%24%20a%20%24%20by%20removing%20some%20symbols%20from%20it%20%28maybe%20none%20or%20all%20of%20them%29.%20In%20particular%20any%20string%20is%20the%20subsequence%20of%20itself.%20For%20example%2C%20the%20string%20%5C%22cfo%5C%22%20is%20the%20subsequence%20of%20the%20string%20%5C%22codeforces%5C%22.%5Cn%5CnYou%20haven%27t%20implemented%20the%20algorithm%20that%20calculates%20the%20correct%20answers%20yet%20and%20you%20should%20do%20that%20ASAP.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20integer%20%24%20m%20%24%20%28%20%24%201%3C%3Dm%3C%3D10%5E%7B5%7D%20%24%20%29%20%5Cu2014%20the%20number%20of%20the%20events%20in%20the%20test%20case.%5Cn%5CnThe%20second%20line%20contains%20nonempty%20string%20%24%20s%20%24%20%5Cu2014%20the%20string%20generated%20by%20the%20bunker%20for%20the%20current%20day.%5Cn%5CnThe%20next%20%24%20m%20%24%20lines%20contain%20the%20description%20of%20the%20events.%20The%20description%20starts%20from%20integer%20%24%20t%20%24%20%5Cu2014%20the%20type%20of%20the%20event.%5Cn%5CnIf%20%24%20t%3D1%20%24%20consider%20a%20new%20day%20has%20come%20and%20now%20a%20new%20string%20%24%20s%20%24%20is%20used.%20In%20that%20case%20the%20same%20line%20contains%20a%20new%20value%20of%20the%20string%20%24%20s%20%24%20.%5Cn%5CnIf%20%24%20t%3D2%20%24%20integer%20%24%20n%20%24%20is%20given%20%24%20%281%3C%3Dn%3C%3D10%5E%7B5%7D%20%24%20%29.%20This%20event%20means%20that%20it%27s%20needed%20to%20find%20the%20answer%20for%20the%20current%20string%20%24%20s%20%24%20and%20the%20value%20%24%20n%20%24%20.%5Cn%5CnThe%20sum%20of%20lengths%20of%20all%20generated%20strings%20doesn%27t%20exceed%20%24%2010%5E%7B5%7D%20%24%20.%20All%20of%20the%20given%20strings%20consist%20only%20of%20lowercase%20English%20letters.%22%2C%22outputFormat%22%3A%22For%20each%20query%20of%20the%20type%20%24%202%20%24%20print%20the%20answer%20modulo%20%24%2010%5E%7B9%7D%2B7%20%24%20on%20the%20separate%20line.%22%2C%22samples%22%3A%5B%5B%223%5Cna%5Cn2%202%5Cn1%20bc%5Cn2%205%5Cn%22%2C%2251%5Cn162626%5Cn%22%5D%5D%2C%22hint%22%3A%22In%20the%20first%20event%20words%20of%20the%20form%20%5C%22a%3F%5C%22%20and%20%5C%22%3Fa%5C%22%20are%20counted%2C%20where%20%3F%20is%20an%20arbitrary%20symbol.%20There%20are%20%24%2026%20%24%20words%20of%20each%20of%20these%20types%2C%20but%20the%20word%20%5C%22aa%5C%22%20satisfies%20both%20patterns%2C%20so%20the%20answer%20is%20%24%2051%20%24%20.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B6000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F666%5C%2FC%22%2C%22id%22%3A%22666C%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A21%2C%22totalAccepted%22%3A9%2C%22pid%22%3A%22CF666C%22%2C%22title%22%3A%22Codeword%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Codeword%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573306449;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Codeword</h1>
<h2>题目描述</h2>
<div>The famous sculptor Cicasso is a Reberlandian spy!
These is breaking news in Berlandian papers today. And now the sculptor is hiding. This time you give the shelter to the maestro. You have a protected bunker and you provide it to your friend. You set the security system in such way that only you can open the bunker. To open it one should solve the problem which is hard for others but is simple for you.
Every day the bunker generates a codeword $ s $ . Every time someone wants to enter the bunker, integer $ n $ appears on the screen. As the answer one should enter another integer — the residue modulo $ 10^{9}+7 $ of the number of strings of length $ n $ that consist only of lowercase English letters and contain the string $ s $ as the subsequence.
The subsequence of string $ a $ is a string $ b $ that can be derived from the string $ a $ by removing some symbols from it (maybe none or all of them). In particular any string is the subsequence of itself. For example, the string "cfo" is the subsequence of the string "codeforces".
You haven't implemented the algorithm that calculates the correct answers yet and you should do that ASAP.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains integer $ m $ ( $ 1<=m<=10^{5} $ ) — the number of the events in the test case.
The second line contains nonempty string $ s $ — the string generated by the bunker for the current day.
The next $ m $ lines contain the description of the events. The description starts from integer $ t $ — the type of the event.
If $ t=1 $ consider a new day has come and now a new string $ s $ is used. In that case the same line contains a new value of the string $ s $ .
If $ t=2 $ integer $ n $ is given $ (1<=n<=10^{5} $ ). This event means that it's needed to find the answer for the current string $ s $ and the value $ n $ .
The sum of lengths of all generated strings doesn't exceed $ 10^{5} $ . All of the given strings consist only of lowercase English letters.</div>
<h3>输出格式</h3>
<br />
<div>For each query of the type $ 2 $ print the answer modulo $ 10^{9}+7 $ on the separate line.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>3
a
2 2
1 bc
2 5
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>51
162626
</code></pre>
<h2>说明</h2>
<div>In the first event words of the form "a?" and "?a" are counted, where ? is an arbitrary symbol. There are $ 26 $ words of each of these types, but the word "aa" satisfies both patterns, so the answer is $ 51 $ .</div>
</article>
</div>
</div>
</body>
</html>
