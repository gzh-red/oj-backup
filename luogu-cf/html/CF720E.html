<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Cipher - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573397057:CJPrfNURJItlHEAukbpT30/bMaXKpm+pnhrJuYVfcZ8=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Borya%20has%20recently%20found%20a%20big%20electronic%20display.%20The%20computer%20that%20manages%20the%20display%20stores%20some%20integer%20number.%20The%20number%20has%20%24%20n%20%24%20decimal%20digits%2C%20the%20display%20shows%20the%20encoded%20version%20of%20the%20number%2C%20where%20each%20digit%20is%20shown%20using%20some%20lowercase%20letter%20of%20the%20English%20alphabet.%5Cn%5CnThere%20is%20a%20legend%20near%20the%20display%2C%20that%20describes%20how%20the%20number%20is%20encoded.%20For%20each%20digit%20position%20%24%20i%20%24%20and%20each%20digit%20%24%20j%20%24%20the%20character%20%24%20c%20%24%20is%20known%2C%20that%20encodes%20this%20digit%20at%20this%20position.%20Different%20digits%20can%20have%20the%20same%20code%20characters.%5Cn%5CnEach%20second%20the%20number%20is%20increased%20by%201.%20And%20one%20second%20after%20a%20moment%20when%20the%20number%20reaches%20the%20value%20that%20is%20represented%20as%20%24%20n%20%24%209-s%20in%20decimal%20notation%2C%20the%20loud%20beep%20sounds.%5Cn%5CnAndrew%20knows%20the%20number%20that%20is%20stored%20in%20the%20computer.%20Now%20he%20wants%20to%20know%20how%20many%20seconds%20must%20pass%20until%20Borya%20can%20definitely%20tell%20what%20was%20the%20original%20number%20encoded%20by%20the%20display.%20Assume%20that%20Borya%20can%20precisely%20measure%20time%2C%20and%20that%20the%20encoded%20number%20will%20first%20be%20increased%20exactly%20one%20second%20after%20Borya%20started%20watching%20at%20the%20display.%22%2C%22inputFormat%22%3A%22Input%20data%20contains%20multiple%20test%20cases.%20The%20first%20line%20of%20input%20contains%20%24%20t%20%24%20%28%20%24%201%3C%3Dt%3C%3D100%20%24%20%29%20%5Cu2014%20the%20number%20of%20test%20cases.%5Cn%5CnEach%20test%20case%20is%20described%20as%20follows.%20The%20first%20line%20of%20the%20description%20contains%20%24%20n%20%24%20%28%20%24%201%3C%3Dn%3C%3D18%20%24%20%29%20%5Cu2014%20the%20number%20of%20digits%20in%20the%20number.%20The%20second%20line%20contains%20%24%20n%20%24%20decimal%20digits%20without%20spaces%20%28but%20possibly%20with%20leading%20zeroes%29%20%5Cu2014%20the%20number%20initially%20stored%20in%20the%20display%20computer.%20The%20following%20%24%20n%20%24%20lines%20contain%2010%20characters%20each.%20The%20%24%20j%20%24%20-th%20character%20of%20the%20%24%20i%20%24%20-th%20of%20these%20lines%20is%20the%20code%20character%20for%20a%20digit%20%24%20j-1%20%24%20in%20position%20%24%20i%20%24%20%2C%20most%20significant%20digit%20positions%20are%20described%20first.%22%2C%22outputFormat%22%3A%22For%20each%20test%20case%20print%20an%20integer%3A%20the%20number%20of%20seconds%20until%20Borya%20definitely%20knows%20what%20was%20the%20initial%20number%20stored%20on%20the%20display%20of%20the%20computer.%20Do%20not%20print%20leading%20zeroes.%22%2C%22samples%22%3A%5B%5B%223%5Cn2%5Cn42%5Cnabcdefghij%5Cnjihgfedcba%5Cn2%5Cn42%5Cnaaaaaaaaaa%5Cnaaaaaaaaaa%5Cn1%5Cn2%5Cnabcdabcdff%5Cn%22%2C%220%5Cn58%5Cn2%5Cn%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F720%5C%2FE%22%2C%22id%22%3A%22720E%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22CF720E%22%2C%22title%22%3A%22Cipher%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Cipher%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Cipher</h1>
<h2>题目描述</h2>
<div>Borya has recently found a big electronic display. The computer that manages the display stores some integer number. The number has $ n $ decimal digits, the display shows the encoded version of the number, where each digit is shown using some lowercase letter of the English alphabet.
There is a legend near the display, that describes how the number is encoded. For each digit position $ i $ and each digit $ j $ the character $ c $ is known, that encodes this digit at this position. Different digits can have the same code characters.
Each second the number is increased by 1. And one second after a moment when the number reaches the value that is represented as $ n $ 9-s in decimal notation, the loud beep sounds.
Andrew knows the number that is stored in the computer. Now he wants to know how many seconds must pass until Borya can definitely tell what was the original number encoded by the display. Assume that Borya can precisely measure time, and that the encoded number will first be increased exactly one second after Borya started watching at the display.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>Input data contains multiple test cases. The first line of input contains $ t $ ( $ 1<=t<=100 $ ) — the number of test cases.
Each test case is described as follows. The first line of the description contains $ n $ ( $ 1<=n<=18 $ ) — the number of digits in the number. The second line contains $ n $ decimal digits without spaces (but possibly with leading zeroes) — the number initially stored in the display computer. The following $ n $ lines contain 10 characters each. The $ j $ -th character of the $ i $ -th of these lines is the code character for a digit $ j-1 $ in position $ i $ , most significant digit positions are described first.</div>
<h3>输出格式</h3>
<br />
<div>For each test case print an integer: the number of seconds until Borya definitely knows what was the initial number stored on the display of the computer. Do not print leading zeroes.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>3
2
42
abcdefghij
jihgfedcba
2
42
aaaaaaaaaa
aaaaaaaaaa
1
2
abcdabcdff
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>0
58
2
</code></pre>
</article>
</div>
</div>
</body>
</html>
