<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Tree Generator™ - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573402294:vehC4rdtXAZ7XI5GRMnDES2vBRrmoKQ/eKiSoJ70Q+Y=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Owl%20Pacino%20has%20always%20been%20into%20trees%20%5Cu2014%20unweighted%20rooted%20trees%20in%20particular.%20He%20loves%20determining%20the%20diameter%20of%20every%20tree%20he%20sees%20%5Cu2014%20that%20is%2C%20the%20maximum%20length%20of%20any%20simple%20path%20in%20the%20tree.%5Cn%5CnOwl%20Pacino%27s%20owl%20friends%20decided%20to%20present%20him%20the%20Tree%20Generator%5Cu2122%20%5Cu2014%20a%20powerful%20machine%20creating%20rooted%20trees%20from%20their%20descriptions.%20An%20%24%20n%20%24%20-vertex%20rooted%20tree%20can%20be%20described%20by%20a%20bracket%20sequence%20of%20length%20%24%202%28n%20-%201%29%20%24%20in%20the%20following%20way%3A%20find%20any%20walk%20starting%20and%20finishing%20in%20the%20root%20that%20traverses%20each%20edge%20exactly%20twice%20%5Cu2014%20once%20down%20the%20tree%2C%20and%20later%20up%20the%20tree.%20Then%20follow%20the%20path%20and%20write%20down%20%5C%22%28%5C%22%20%28an%20opening%20parenthesis%29%20if%20an%20edge%20is%20followed%20down%20the%20tree%2C%20and%20%5C%22%29%5C%22%20%28a%20closing%20parenthesis%29%20otherwise.%5Cn%5CnThe%20following%20figure%20shows%20sample%20rooted%20trees%20and%20their%20descriptions%3A%5Cn%5Cn%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF1149C%5C%2Fa9818ec6abf351ce6c6a0eaa115c2729c37577f5.png%29Owl%20wrote%20down%20the%20description%20of%20an%20%24%20n%20%24%20-vertex%20rooted%20tree.%20Then%2C%20he%20rewrote%20the%20description%20%24%20q%20%24%20times.%20However%2C%20each%20time%20he%20wrote%20a%20new%20description%2C%20he%20picked%20two%20different%20characters%20in%20the%20description%20he%20wrote%20the%20last%20time%2C%20swapped%20them%20and%20wrote%20down%20the%20resulting%20string.%20He%20always%20made%20sure%20that%20each%20written%20string%20was%20the%20description%20of%20a%20rooted%20tree.%5Cn%5CnPacino%20then%20used%20Tree%20Generator%5Cu2122%20for%20each%20description%20he%20wrote%20down.%20What%20is%20the%20diameter%20of%20each%20constructed%20tree%3F%22%2C%22inputFormat%22%3A%22The%20first%20line%20of%20the%20input%20contains%20two%20integers%20%24%20n%2C%20q%20%24%20%28%20%24%203%20%5C%5Cle%20n%20%5C%5Cle%20100%5C%5C%2C000%20%24%20%2C%20%24%201%20%5C%5Cle%20q%20%5C%5Cle%20100%5C%5C%2C000%20%24%20%29%20%5Cu2014%20the%20number%20of%20vertices%20in%20the%20tree%20and%20the%20number%20of%20changes%20to%20the%20tree%20description.%20The%20following%20line%20contains%20a%20description%20of%20the%20initial%20tree%20%5Cu2014%20a%20string%20of%20length%20%24%202%28n-1%29%20%24%20consisting%20of%20opening%20and%20closing%20parentheses.%5Cn%5CnEach%20of%20the%20following%20%24%20q%20%24%20lines%20describes%20a%20single%20change%20to%20the%20description%20and%20contains%20two%20space-separated%20integers%20%24%20a_i%2C%20b_i%20%24%20%28%20%24%202%20%5C%5Cleq%20a_i%2C%20b_i%20%5C%5Cleq%202n-3%20%24%20%29%20which%20identify%20the%20indices%20of%20two%20brackets%20to%20be%20swapped.%20You%20can%20assume%20that%20the%20description%20will%20change%20after%20each%20query%2C%20and%20that%20after%20each%20change%20a%20tree%20can%20be%20constructed%20from%20the%20description.%22%2C%22outputFormat%22%3A%22Output%20%24%20q%20%2B%201%20%24%20integers%20%5Cu2014%20the%20diameter%20of%20each%20constructed%20tree%2C%20in%20the%20order%20their%20descriptions%20have%20been%20written%20down.%22%2C%22samples%22%3A%5B%5B%22%5Cn5%205%5Cn%28%28%28%28%29%29%29%29%5Cn4%205%5Cn3%204%5Cn5%206%5Cn3%206%5Cn2%205%5Cn%22%2C%22%5Cn4%5Cn3%5Cn3%5Cn2%5Cn4%5Cn4%5Cn%22%5D%2C%5B%22%5Cn6%204%5Cn%28%28%28%28%29%29%28%29%29%29%5Cn6%207%5Cn5%204%5Cn6%204%5Cn7%204%5Cn%22%2C%22%5Cn4%5Cn4%5Cn4%5Cn5%5Cn3%5Cn%22%5D%5D%2C%22hint%22%3A%22The%20following%20figure%20shows%20each%20constructed%20tree%20and%20its%20description%20in%20the%20first%20example%20test%3A%5Cn%5Cn%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF1149C%5C%2F285660de836d4f0c8cc3430ffe028ede0245c7ef.png%29%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F1149%5C%2FC%22%2C%22id%22%3A%221149C%22%7D%2C%22translation%22%3A%22%24n%24%5Cu4e2a%5Cu70b9%5Cuff0c%24m%24%5Cu4e2a%5Cu8be2%5Cu95ee%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu7ed9%5Cu4f60%5Cu4e00%5Cu68f5%5Cu6811%5Cu7684%5Cu62ec%5Cu53f7%5Cu5e8f%5Cu5217%5Cuff0c%5Cu8f93%5Cu51fa%5Cu5b83%5Cu7684%5Cu76f4%5Cu5f84%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu6709%24m%24%5Cu6b21%5Cu8be2%5Cu95ee%5Cuff0c%5Cu6bcf%5Cu6b21%5Cu8be2%5Cu95ee%5Cu8868%5Cu793a%5Cu4ea4%5Cu6362%5Cu4e24%5Cu4e2a%5Cu62ec%5Cu53f7%5Cuff0c%5Cu8f93%5Cu51fa%5Cu4ea4%5Cu6362%5Cu4e24%5Cu4e2a%5Cu62ec%5Cu53f7%5Cu540e%5Cu7684%5Cu76f4%5Cu5f84%5Cuff08%5Cu4fdd%5Cu8bc1%5Cu6bcf%5Cu6b21%5Cu64cd%5Cu4f5c%5Cu540e%5Cu90fd%5Cu4e3a%5Cu4e00%5Cu68f5%5Cu6811%5Cuff09%5Cr%5Cn%5Cr%5Cn%5Cu8f93%5Cu51fa%5Cu5171%24m%2B1%24%5Cu884c%5Cu3002%5Cr%5Cn%5Cr%5Cn%243%20%5C%5Cle%20n%20%5C%5Cle%20100%5C%5C%2C000%2C1%20%5C%5Cle%20q%20%5C%5Cle%20100%5C%5C%2C000%24%20%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A94%2C%22totalAccepted%22%3A41%2C%22pid%22%3A%22CF1149C%22%2C%22title%22%3A%22Tree%20Generator%5Cu2122%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P5327%22%2C%22title%22%3A%22%5BZJOI2019%5D%5Cu8bed%5Cu8a00%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22CF1149D%22%2C%22title%22%3A%22Abandoning%20Roads%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1149B%22%2C%22title%22%3A%22Three%20Religions%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1149A%22%2C%22title%22%3A%22Prefix%20Sum%20Primes%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1147C%22%2C%22title%22%3A%22Thanos%20Nim%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Tree%20Generator%5Cu2122%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Tree Generator™</h1>
<h2>题意翻译</h2>
<div>$n$个点，$m$个询问。
给你一棵树的括号序列，输出它的直径。
有$m$次询问，每次询问表示交换两个括号，输出交换两个括号后的直径（保证每次操作后都为一棵树）
输出共$m+1$行。
$3 \le n \le 100\,000,1 \le q \le 100\,000$ </div>
<h2>题目描述</h2>
<div>Owl Pacino has always been into trees — unweighted rooted trees in particular. He loves determining the diameter of every tree he sees — that is, the maximum length of any simple path in the tree.
Owl Pacino's owl friends decided to present him the Tree Generator™ — a powerful machine creating rooted trees from their descriptions. An $ n $ -vertex rooted tree can be described by a bracket sequence of length $ 2(n - 1) $ in the following way: find any walk starting and finishing in the root that traverses each edge exactly twice — once down the tree, and later up the tree. Then follow the path and write down "(" (an opening parenthesis) if an edge is followed down the tree, and ")" (a closing parenthesis) otherwise.
The following figure shows sample rooted trees and their descriptions:
![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1149C/a9818ec6abf351ce6c6a0eaa115c2729c37577f5.png)Owl wrote down the description of an $ n $ -vertex rooted tree. Then, he rewrote the description $ q $ times. However, each time he wrote a new description, he picked two different characters in the description he wrote the last time, swapped them and wrote down the resulting string. He always made sure that each written string was the description of a rooted tree.
Pacino then used Tree Generator™ for each description he wrote down. What is the diameter of each constructed tree?</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line of the input contains two integers $ n, q $ ( $ 3 \le n \le 100\,000 $ , $ 1 \le q \le 100\,000 $ ) — the number of vertices in the tree and the number of changes to the tree description. The following line contains a description of the initial tree — a string of length $ 2(n-1) $ consisting of opening and closing parentheses.
Each of the following $ q $ lines describes a single change to the description and contains two space-separated integers $ a_i, b_i $ ( $ 2 \leq a_i, b_i \leq 2n-3 $ ) which identify the indices of two brackets to be swapped. You can assume that the description will change after each query, and that after each change a tree can be constructed from the description.</div>
<h3>输出格式</h3>
<br />
<div>Output $ q + 1 $ integers — the diameter of each constructed tree, in the order their descriptions have been written down.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>
5 5
(((())))
4 5
3 4
5 6
3 6
2 5
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>
4
3
3
2
4
4
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>
6 4
(((())()))
6 7
5 4
6 4
7 4
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>
4
4
4
5
3
</code></pre>
<h2>说明</h2>
<div>The following figure shows each constructed tree and its description in the first example test:
![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1149C/285660de836d4f0c8cc3430ffe028ede0245c7ef.png)</div>
</article>
</div>
</div>
</body>
</html>
