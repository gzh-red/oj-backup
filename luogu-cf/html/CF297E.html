<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Mystic Carvings - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573392444:AddzOHb6t60nv6yax8H5mo5g4rvx7NqYD52p4LmR0XE=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22The%20polar%20bears%20have%20discovered%20a%20gigantic%20circular%20piece%20of%20floating%20ice%20with%20some%20mystic%20carvings%20on%20it.%20There%20are%20%24%20n%20%24%20lines%20carved%20on%20the%20ice.%20Each%20line%20connects%20two%20points%20on%20the%20boundary%20of%20the%20ice%20%28we%20call%20these%20points%20endpoints%29.%20The%20endpoints%20are%20numbered%20%24%201%2C2%2C...%2C2n%20%24%20counter-clockwise%20along%20the%20circumference.%20No%20two%20lines%20share%20an%20endpoint.%5Cn%5CnNow%20a%20group%20of%206%20polar%20bears%20%28Alice%2C%20Bob%2C%20Carol%2C%20Dave%2C%20Eve%2C%20Frank%29%20are%20going%20to%20build%20caves%20on%20the%20endpoints.%20Each%20polar%20bear%20would%20build%20a%20cave%20and%20live%20in%20it.%20No%20two%20polar%20bears%20can%20build%20a%20cave%20on%20the%20same%20endpoints.%20Alice%20and%20Bob%20is%20a%20pair%20of%20superstitious%20lovers.%20They%20believe%20the%20lines%20are%20carved%20by%20aliens%20%28or%20humans%2C%20which%20are%20pretty%20much%20the%20same%20thing%20to%20polar%20bears%29%2C%20and%20have%20certain%20spiritual%20power.%20Therefore%20they%20want%20to%20build%20their%20caves%20on%20two%20endpoints%20which%20are%20connected%20by%20a%20line.%20The%20same%20for%20Carol%20and%20Dave%2C%20Eve%20and%20Frank.%5Cn%5CnThe%20distance%20between%20two%20caves%20X%20and%20Y%20is%20defined%20as%20one%20plus%20minimum%20number%20of%20other%20caves%20one%20need%20to%20pass%20through%20in%20order%20to%20travel%20from%20X%20to%20Y%20along%20the%20boundary%20of%20the%20ice%20%28endpoints%20without%20caves%20are%20not%20counted%29.%5Cn%5CnTo%20ensure%20fairness%2C%20the%20distances%20between%20the%20three%20pairs%20of%20lovers%20have%20to%20be%20the%20same%20%28that%20is%2C%20the%20distance%20between%20Alice%20and%20Bob%2C%20the%20distance%20between%20Carol%20and%20Dave%2C%20and%20the%20distance%20between%20Eve%20and%20Frank%20are%20the%20same%29.%5Cn%5CnThe%20figures%20below%20show%20two%20different%20configurations%2C%20where%20the%20dots%20on%20the%20circle%20are%20the%20endpoints.%20The%20configuration%20on%20the%20left%20is%20not%20valid.%20Although%20each%20pair%20of%20lovers%20%28A%20and%20B%2C%20C%20and%20D%2C%20E%20and%20F%29%20is%20connected%20a%20line%2C%20the%20distance%20requirement%20is%20not%20satisfied.%20The%20distance%20between%20A%20and%20B%20is%202%20%28one%20can%20go%20from%20A%20to%20B%20in%20the%20clockwise%20direction%20passing%20through%20F%29.%20The%20distance%20between%20E%20and%20F%20is%20also%202.%20However%2C%20the%20distance%20between%20C%20and%20D%20is%201%20%28one%20can%20go%20from%20C%20to%20D%20in%20the%20counter-clockwise%20direction%20without%20passing%20through%20any%20other%20caves%29.%20The%20configuration%20on%20the%20right%20is%20valid.%20All%20three%20pairs%20have%20the%20same%20distance%201.%5Cn%5Cn%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF297E%5C%2Fd4294009e1edf87a8acd5f07b8b6190c53a3334c.png%29Count%20the%20number%20of%20ways%20to%20build%20the%20caves%20under%20the%20requirements.%20Two%20configurations%20are%20considered%20the%20same%20if%20the%20same%20set%20of%206%20endpoints%20are%20used.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20integer%20%24%20n%20%24%20%28%20%24%203%3C%3Dn%3C%3D10%5E%7B5%7D%20%24%20%29%20%5Cu2014%20the%20number%20of%20lines.%5Cn%5CnEach%20of%20the%20following%20%24%20n%20%24%20lines%20contains%20two%20integers%20%24%20a_%7Bi%7D%2Cb_%7Bi%7D%20%24%20%28%20%24%201%3C%3Da_%7Bi%7D%2Cb_%7Bi%7D%3C%3D2n%20%24%20%29%2C%20which%20means%20that%20there%20is%20a%20line%20carved%20on%20the%20ice%20connecting%20the%20%24%20a_%7Bi%7D%20%24%20%5Cu2013th%20and%20%24%20b_%7Bi%7D%20%24%20%5Cu2013th%20endpoint.%5Cn%5CnIt%27s%20guaranteed%20that%20each%20endpoints%20touches%20exactly%20one%20line.%22%2C%22outputFormat%22%3A%22Print%20the%20number%20of%20ways%20to%20build%20the%20caves.%5Cn%5CnPlease%2C%20do%20not%20write%20the%20%25lld%20specifier%20to%20read%20or%20write%2064-bit%20integers%20in%20%5Cu0421%2B%2B.%20It%20is%20preferred%20to%20use%20the%20cin%2C%20cout%20streams%20or%20the%20%25I64d%20specifier.%22%2C%22samples%22%3A%5B%5B%224%5Cn5%204%5Cn1%202%5Cn6%207%5Cn8%203%5Cn%22%2C%222%5Cn%22%5D%2C%5B%228%5Cn1%207%5Cn2%204%5Cn3%209%5Cn5%2011%5Cn6%208%5Cn10%2016%5Cn13%2015%5Cn14%2012%5Cn%22%2C%226%5Cn%22%5D%5D%2C%22hint%22%3A%22The%20second%20sample%20corresponds%20to%20the%20figure%20in%20the%20problem%20statement.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B3000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F297%5C%2FE%22%2C%22id%22%3A%22297E%22%7D%2C%22translation%22%3A%22%5Cu4e00%5Cu4e2a%5Cu73af%5Cu4e0a%5Cu6709%5Cu6807%5Cu53f7%5Cu4e3a%241%24%5Cu5230%242n%24%5Cu7684%5Cu9876%5Cu70b9%5Cuff0c%5Cu6bcf%5Cu4e2a%5Cu9876%5Cu70b9%5Cu8fde%5Cu63a5%5Cu4e00%5Cu6761%5Cu65e0%5Cu5411%5Cu8fb9%5Cu3002%5Cu8981%5Cu6c42%5Cu9009%5Cu62e9%243%24%5Cu6761%5Cu4e0d%5Cu91cd%5Cu590d%5Cu7684%5Cu8fb9%5Cu5728%5Cu9876%5Cu70b9%5Cu5904%5Cu5efa%5Cu718a%5Cu6d1e%5Cuff08%5Cu5171%246%24%5Cu4e2a%5Cuff09%5Cuff0c%5Cu4e14%5Cu6bcf%5Cu6761%5Cu8fb9%5Cu7684%5Cu4e24%5Cu4e2a%5Cu9876%5Cu70b9%5Cu7684%5Cu8ddd%5Cu79bb%5Cu76f8%5Cu540c%5Cuff0c%5Cu8be2%5Cu95ee%5Cu5176%5Cu65b9%5Cu6848%5Cu6570%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu8ddd%5Cu79bb%5Cu5b9a%5Cu4e49%5Cu4e3a%5Cu5728%5Cu73af%5Cu4e0a%5Cu4ece%5Cu4e00%5Cu4e2a%5Cu9876%5Cu70b9%5Cu5230%5Cu53e6%5Cu4e00%5Cu4e2a%5Cu9876%5Cu70b9%5Cu6240%5Cu7ecf%5Cu8fc7%5Cu7684%5Cu6700%5Cu5c11%5Cu718a%5Cu6d1e%5Cu6570%5Cu91cf-1%5Cu3002%5Cr%5Cn%5Cr%5Cn%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A22%2C%22totalAccepted%22%3A12%2C%22pid%22%3A%22CF297E%22%2C%22title%22%3A%22Mystic%20Carvings%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Mystic%20Carvings%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Mystic Carvings</h1>
<h2>题意翻译</h2>
<div>一个环上有标号为$1$到$2n$的顶点，每个顶点连接一条无向边。要求选择$3$条不重复的边在顶点处建熊洞（共$6$个），且每条边的两个顶点的距离相同，询问其方案数。
距离定义为在环上从一个顶点到另一个顶点所经过的最少熊洞数量-1。
</div>
<h2>题目描述</h2>
<div>The polar bears have discovered a gigantic circular piece of floating ice with some mystic carvings on it. There are $ n $ lines carved on the ice. Each line connects two points on the boundary of the ice (we call these points endpoints). The endpoints are numbered $ 1,2,...,2n $ counter-clockwise along the circumference. No two lines share an endpoint.
Now a group of 6 polar bears (Alice, Bob, Carol, Dave, Eve, Frank) are going to build caves on the endpoints. Each polar bear would build a cave and live in it. No two polar bears can build a cave on the same endpoints. Alice and Bob is a pair of superstitious lovers. They believe the lines are carved by aliens (or humans, which are pretty much the same thing to polar bears), and have certain spiritual power. Therefore they want to build their caves on two endpoints which are connected by a line. The same for Carol and Dave, Eve and Frank.
The distance between two caves X and Y is defined as one plus minimum number of other caves one need to pass through in order to travel from X to Y along the boundary of the ice (endpoints without caves are not counted).
To ensure fairness, the distances between the three pairs of lovers have to be the same (that is, the distance between Alice and Bob, the distance between Carol and Dave, and the distance between Eve and Frank are the same).
The figures below show two different configurations, where the dots on the circle are the endpoints. The configuration on the left is not valid. Although each pair of lovers (A and B, C and D, E and F) is connected a line, the distance requirement is not satisfied. The distance between A and B is 2 (one can go from A to B in the clockwise direction passing through F). The distance between E and F is also 2. However, the distance between C and D is 1 (one can go from C to D in the counter-clockwise direction without passing through any other caves). The configuration on the right is valid. All three pairs have the same distance 1.
![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF297E/d4294009e1edf87a8acd5f07b8b6190c53a3334c.png)Count the number of ways to build the caves under the requirements. Two configurations are considered the same if the same set of 6 endpoints are used.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains integer $ n $ ( $ 3<=n<=10^{5} $ ) — the number of lines.
Each of the following $ n $ lines contains two integers $ a_{i},b_{i} $ ( $ 1<=a_{i},b_{i}<=2n $ ), which means that there is a line carved on the ice connecting the $ a_{i} $ –th and $ b_{i} $ –th endpoint.
It's guaranteed that each endpoints touches exactly one line.</div>
<h3>输出格式</h3>
<br />
<div>Print the number of ways to build the caves.
Please, do not write the %lld specifier to read or write 64-bit integers in С++. It is preferred to use the cin, cout streams or the %I64d specifier.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>4
5 4
1 2
6 7
8 3
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>2
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>8
1 7
2 4
3 9
5 11
6 8
10 16
13 15
14 12
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>6
</code></pre>
<h2>说明</h2>
<div>The second sample corresponds to the figure in the problem statement.</div>
</article>
</div>
</div>
</body>
</html>
