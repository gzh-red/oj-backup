<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Instant Messanger - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573393689:yEFlTv0O4MKK173Nz0kejppxzF4WH11UuDZnHFjo1ZM=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22User%20ainta%20decided%20to%20make%20a%20new%20instant%20messenger%20called%20%5C%22aintalk%5C%22.%20With%20aintalk%2C%20each%20user%20can%20chat%20with%20other%20people.%20User%20ainta%20made%20the%20prototype%20of%20some%20functions%20to%20implement%20this%20thing.%5Cn%5Cn1.%20login%28%20%24%20u%20%24%20%29%3A%20User%20%24%20u%20%24%20logins%20into%20aintalk%20and%20becomes%20online.%5Cn2.%20logout%28%20%24%20u%20%24%20%29%3A%20User%20%24%20u%20%24%20logouts%20and%20becomes%20offline.%5Cn3.%20add%5C%5C_friend%28%20%24%20u%20%24%20%2C%20%24%20v%20%24%20%29%3A%20User%20%24%20u%20%24%20and%20user%20%24%20v%20%24%20become%20friends.%20It%20means%2C%20%24%20u%20%24%20and%20%24%20v%20%24%20can%20talk%20with%20each%20other.%20The%20friendship%20is%20bidirectional.%5Cn4.%20del%5C%5C_friend%28%20%24%20u%20%24%20%2C%20%24%20v%20%24%20%29%3A%20Unfriend%20user%20%24%20u%20%24%20and%20user%20%24%20v%20%24%20.%20It%20means%2C%20%24%20u%20%24%20and%20%24%20v%20%24%20cannot%20talk%20with%20each%20other%20from%20then.%5Cn5.%20count%5C%5C_online%5C%5C_friends%28%20%24%20u%20%24%20%29%3A%20The%20function%20returns%20the%20number%20of%20friends%20of%20user%20%24%20u%20%24%20who%20are%20online%20at%20the%20moment.%5Cn%5CnBecause%20the%20messenger%20is%20being%20tested%20by%20some%20users%20numbered%20from%20%24%201%20%24%20to%20%24%20n%20%24%20%2C%20there%20is%20no%20register%20method.%20This%20means%2C%20at%20the%20beginning%2C%20some%20users%20may%20be%20online%2C%20and%20some%20users%20may%20have%20friends.%5Cn%5CnUser%20ainta%20is%20going%20to%20make%20these%20functions%2C%20but%20before%20making%20the%20messenger%20public%2C%20he%20wants%20to%20know%20whether%20he%20is%20correct.%20Help%20ainta%20verify%20his%20code.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20three%20space-separated%20integers%20%24%20n%20%24%20%2C%20%24%20m%20%24%20and%20%24%20q%20%24%20%28%20%24%201%3C%3Dn%3C%3D50000%20%24%20%3B%20%24%201%3C%3Dm%3C%3D150000%20%24%20%3B%20%24%201%3C%3Dq%3C%3D250000%20%24%20%29%20%5Cu2014%20the%20number%20of%20users%2C%20the%20number%20of%20pairs%20of%20friends%2C%20and%20the%20number%20of%20queries.%5Cn%5CnThe%20second%20line%20contains%20an%20integer%20%24%20o%20%24%20%24%20%281%3C%3Do%3C%3Dn%29%20%24%20%5Cu2014%20the%20number%20of%20online%20users%20at%20the%20beginning.%20The%20third%20line%20contains%20%24%20o%20%24%20space-separated%20integers%20%24%20x_%7B1%7D%2Cx_%7B2%7D%2C...%2Cx_%7Bo%7D%20%24%20%28%20%24%201%3C%3Dx_%7Bi%7D%3C%3Dn%20%24%20%29%20%5Cu2014%20the%20ids%20of%20the%20online%20users.%20It%20is%20guaranteed%20that%20these%20values%20are%20distinct.%5Cn%5CnEach%20of%20the%20next%20%24%20m%20%24%20lines%20contains%20two%20space-separated%20integers%20%24%20a_%7Bi%7D%20%24%20and%20%24%20b_%7Bi%7D%20%24%20%28%20%24%201%3C%3Da_%7Bi%7D%2Cb_%7Bi%7D%3C%3Dn%3B%5Cu00a0a_%7Bi%7D%5Cu2260b_%7Bi%7D%20%24%20%29%20%5Cu2014%20the%20ids%20of%20two%20users%20who%20are%20friends%20at%20the%20beginning.%20It%20is%20guaranteed%20there%20are%20no%20multiple%20friendship%20given%20in%20the%20input.%20Note%20that%20the%20friendship%20is%20bidirectional.%5Cn%5CnNext%20%24%20q%20%24%20lines%20describe%20the%20%24%20q%20%24%20queries%20in%20the%20format%3A%5Cn%5Cn-%20%5C%22O%20%24%20u%20%24%20%5C%22%20%28%20%24%201%3C%3Du%3C%3Dn%20%24%20%29%20%3A%20Call%20online%28%20%24%20u%20%24%20%29.%20It%20is%20guaranteed%20that%20user%20%24%20u%20%24%20was%20offline%20just%20before%20the%20function%20call.%5Cn-%20%5C%22F%20%24%20u%20%24%20%5C%22%20%28%20%24%201%3C%3Du%3C%3Dn%20%24%20%29%20%3A%20Call%20offline%28%20%24%20u%20%24%20%29.%20It%20is%20guaranteed%20that%20user%20%24%20u%20%24%20was%20online%20just%20before%20the%20function%20call.%5Cn-%20%5C%22A%20%24%20u%20%24%20%24%20v%20%24%20%5C%22%20%28%20%24%201%3C%3Du%2Cv%3C%3Dn%3B%5Cu00a0u%5Cu2260v%20%24%20%29%20%3A%20Call%20add%5C%5C_friend%28%20%24%20u%2Cv%20%24%20%29.%20It%20is%20guaranteed%20that%20these%20two%20users%20weren%27t%20friends%20just%20before%20the%20function%20call.%5Cn-%20%5C%22D%20%24%20u%20%24%20%24%20v%20%24%20%5C%22%20%28%20%24%201%3C%3Du%2Cv%3C%3Dn%3B%5Cu00a0u%5Cu2260v%20%24%20%29%20%3A%20Call%20del%5C%5C_friend%28%20%24%20u%2Cv%20%24%20%29.%20It%20is%20guaranteed%20that%20these%20two%20users%20were%20friends%20just%20before%20the%20function%20call.%5Cn-%20%5C%22C%20%24%20u%20%24%20%5C%22%20%28%20%24%201%3C%3Du%3C%3Dn%20%24%20%29%20%3A%20Call%20count%5C%5C_online%5C%5C_friends%28%20%24%20u%20%24%20%29%20and%20print%20the%20result%20in%20a%20single%20line.%22%2C%22outputFormat%22%3A%22For%20each%20count%5C%5C_online%5C%5C_friends%28%20%24%20u%20%24%20%29%20query%2C%20print%20the%20required%20answer%20in%20a%20single%20line.%22%2C%22samples%22%3A%5B%5B%225%202%209%5Cn1%5Cn4%5Cn1%203%5Cn3%204%5CnC%203%5CnA%202%205%5CnO%201%5CnD%201%203%5CnA%201%202%5CnA%204%202%5CnC%202%5CnF%204%5CnC%202%5Cn%22%2C%221%5Cn2%5Cn1%5Cn%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F398%5C%2FD%22%2C%22id%22%3A%22398D%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22CF398D%22%2C%22title%22%3A%22Instant%20Messanger%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Instant%20Messanger%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573295103;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Instant Messanger</h1>
<h2>题目描述</h2>
<div>User ainta decided to make a new instant messenger called "aintalk". With aintalk, each user can chat with other people. User ainta made the prototype of some functions to implement this thing.
1. login( $ u $ ): User $ u $ logins into aintalk and becomes online.
2. logout( $ u $ ): User $ u $ logouts and becomes offline.
3. add\_friend( $ u $ , $ v $ ): User $ u $ and user $ v $ become friends. It means, $ u $ and $ v $ can talk with each other. The friendship is bidirectional.
4. del\_friend( $ u $ , $ v $ ): Unfriend user $ u $ and user $ v $ . It means, $ u $ and $ v $ cannot talk with each other from then.
5. count\_online\_friends( $ u $ ): The function returns the number of friends of user $ u $ who are online at the moment.
Because the messenger is being tested by some users numbered from $ 1 $ to $ n $ , there is no register method. This means, at the beginning, some users may be online, and some users may have friends.
User ainta is going to make these functions, but before making the messenger public, he wants to know whether he is correct. Help ainta verify his code.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains three space-separated integers $ n $ , $ m $ and $ q $ ( $ 1<=n<=50000 $ ; $ 1<=m<=150000 $ ; $ 1<=q<=250000 $ ) — the number of users, the number of pairs of friends, and the number of queries.
The second line contains an integer $ o $ $ (1<=o<=n) $ — the number of online users at the beginning. The third line contains $ o $ space-separated integers $ x_{1},x_{2},...,x_{o} $ ( $ 1<=x_{i}<=n $ ) — the ids of the online users. It is guaranteed that these values are distinct.
Each of the next $ m $ lines contains two space-separated integers $ a_{i} $ and $ b_{i} $ ( $ 1<=a_{i},b_{i}<=n; a_{i}≠b_{i} $ ) — the ids of two users who are friends at the beginning. It is guaranteed there are no multiple friendship given in the input. Note that the friendship is bidirectional.
Next $ q $ lines describe the $ q $ queries in the format:
- "O $ u $ " ( $ 1<=u<=n $ ) : Call online( $ u $ ). It is guaranteed that user $ u $ was offline just before the function call.
- "F $ u $ " ( $ 1<=u<=n $ ) : Call offline( $ u $ ). It is guaranteed that user $ u $ was online just before the function call.
- "A $ u $ $ v $ " ( $ 1<=u,v<=n; u≠v $ ) : Call add\_friend( $ u,v $ ). It is guaranteed that these two users weren't friends just before the function call.
- "D $ u $ $ v $ " ( $ 1<=u,v<=n; u≠v $ ) : Call del\_friend( $ u,v $ ). It is guaranteed that these two users were friends just before the function call.
- "C $ u $ " ( $ 1<=u<=n $ ) : Call count\_online\_friends( $ u $ ) and print the result in a single line.</div>
<h3>输出格式</h3>
<br />
<div>For each count\_online\_friends( $ u $ ) query, print the required answer in a single line.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>5 2 9
1
4
1 3
3 4
C 3
A 2 5
O 1
D 1 3
A 1 2
A 4 2
C 2
F 4
C 2
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>1
2
1
</code></pre>
</article>
</div>
</div>
</body>
</html>
