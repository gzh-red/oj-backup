<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Compress String - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573401978:lvWzbHVPXA2S78bxyN2c7SRwfDNIxuHCDRe/3hOpgUM=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Suppose%20you%20are%20given%20a%20string%20%24%20s%20%24%20of%20length%20%24%20n%20%24%20consisting%20of%20lowercase%20English%20letters.%20You%20need%20to%20compress%20it%20using%20the%20smallest%20possible%20number%20of%20coins.%5Cn%5CnTo%20compress%20the%20string%2C%20you%20have%20to%20represent%20%24%20s%20%24%20as%20a%20concatenation%20of%20several%20non-empty%20strings%3A%20%24%20s%20%3D%20t_%7B1%7D%20t_%7B2%7D%20%5C%5Cldots%20t_%7Bk%7D%20%24%20.%20The%20%24%20i%20%24%20-th%20of%20these%20strings%20should%20be%20encoded%20with%20one%20of%20the%20two%20ways%3A%5Cn%5Cn-%20if%20%24%20%7Ct_%7Bi%7D%7C%20%3D%201%20%24%20%2C%20meaning%20that%20the%20current%20string%20consists%20of%20a%20single%20character%2C%20you%20can%20encode%20it%20paying%20%24%20a%20%24%20coins%3B%5Cn-%20if%20%24%20t_%7Bi%7D%20%24%20is%20a%20substring%20of%20%24%20t_%7B1%7D%20t_%7B2%7D%20%5C%5Cldots%20t_%7Bi%20-%201%7D%20%24%20%2C%20then%20you%20can%20encode%20it%20paying%20%24%20b%20%24%20coins.%5Cn%5CnA%20string%20%24%20x%20%24%20is%20a%20substring%20of%20a%20string%20%24%20y%20%24%20if%20%24%20x%20%24%20can%20be%20obtained%20from%20%24%20y%20%24%20by%20deletion%20of%20several%20%28possibly%2C%20zero%20or%20all%29%20characters%20from%20the%20beginning%20and%20several%20%28possibly%2C%20zero%20or%20all%29%20characters%20from%20the%20end.%5Cn%5CnSo%20your%20task%20is%20to%20calculate%20the%20minimum%20possible%20number%20of%20coins%20you%20need%20to%20spend%20in%20order%20to%20compress%20the%20given%20string%20%24%20s%20%24%20.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20three%20positive%20integers%2C%20separated%20by%20spaces%3A%20%24%20n%20%24%20%2C%20%24%20a%20%24%20and%20%24%20b%20%24%20%28%20%24%201%20%5C%5Cleq%20n%2C%20a%2C%20b%20%5C%5Cleq%205000%20%24%20%29%20%5Cu2014%20the%20length%20of%20the%20string%2C%20the%20cost%20to%20compress%20a%20one-character%20string%20and%20the%20cost%20to%20compress%20a%20string%20that%20appeared%20before.%5Cn%5CnThe%20second%20line%20contains%20a%20single%20string%20%24%20s%20%24%20%2C%20consisting%20of%20%24%20n%20%24%20lowercase%20English%20letters.%22%2C%22outputFormat%22%3A%22Output%20a%20single%20integer%20%5Cu2014%20the%20smallest%20possible%20number%20of%20coins%20you%20need%20to%20spend%20to%20compress%20%24%20s%20%24%20.%22%2C%22samples%22%3A%5B%5B%22%5Cn3%203%201%5Cnaba%5Cn%22%2C%22%5Cn7%5Cn%22%5D%2C%5B%22%5Cn4%201%201%5Cnabcd%5Cn%22%2C%22%5Cn4%5Cn%22%5D%2C%5B%22%5Cn4%2010%201%5Cnaaaa%5Cn%22%2C%22%5Cn12%5Cn%22%5D%5D%2C%22hint%22%3A%22In%20the%20first%20sample%20case%2C%20you%20can%20set%20%24%20t_%7B1%7D%20%3D%20%24%20%27a%27%2C%20%24%20t_%7B2%7D%20%3D%20%24%20%27b%27%2C%20%24%20t_%7B3%7D%20%3D%20%24%20%27a%27%20and%20pay%20%24%203%20%2B%203%20%2B%201%20%3D%207%20%24%20coins%2C%20since%20%24%20t_%7B3%7D%20%24%20is%20a%20substring%20of%20%24%20t_%7B1%7Dt_%7B2%7D%20%24%20.%5Cn%5CnIn%20the%20second%20sample%2C%20you%20just%20need%20to%20compress%20every%20character%20by%20itself.%5Cn%5CnIn%20the%20third%20sample%2C%20you%20set%20%24%20t_%7B1%7D%20%3D%20t_%7B2%7D%20%3D%20%24%20%27a%27%2C%20%24%20t_%7B3%7D%20%3D%20%24%20%27aa%27%20and%20pay%20%24%2010%20%2B%201%20%2B%201%20%3D%2012%20%24%20coins%2C%20since%20%24%20t_%7B2%7D%20%24%20is%20a%20substring%20of%20%24%20t_%7B1%7D%20%24%20and%20%24%20t_%7B3%7D%20%24%20is%20a%20substring%20of%20%24%20t_%7B1%7D%20t_%7B2%7D%20%24%20.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B3000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F1120%5C%2FC%22%2C%22id%22%3A%221120C%22%7D%2C%22translation%22%3A%22%5Cu7ed9%5Cu51fa%24n%24%2C%24a%24%2C%24b%24%2C%5Cu5c06%5Cu4e00%5Cu4e2a%5Cu4e32%5Cu5212%5Cu5206%5Cu6210%5Cu82e5%5Cu5e72%5Cu6bb5%5Cuff0c%5Cu6bcf%5Cu4e00%5Cu6bb5%5Cu5fc5%5Cu987b%5Cu662f%5Cu5355%5Cu4e2a%5Cu5b57%5Cu7b26%5Cu6216%5Cu8005%5Cu662f%5Cu524d%5Cu9762%5Cu4e00%5Cu90e8%5Cu5206%5Cu7684%5Cu5b50%5Cu4e32%5Cuff0c%5Cu5212%5Cu5206%5Cu6210%5Cu4e00%5Cu4e2a%5Cu5b57%5Cu7b26%5Cu9700%5Cu8981%24a%24%5Cu5143%5Cuff0c%5Cu5212%5Cu5206%5Cu6210%5Cu524d%5Cu9762%5Cu4e00%5Cu90e8%5Cu5206%5Cu7684%5Cu5b50%5Cu4e32%5Cu9700%5Cu8981%24b%24%5Cu5143%5Cuff0c%5Cu95ee%5Cu6700%5Cu5c0f%5Cu82b1%5Cu8d39%5Cu662f%5Cu591a%5Cu5c11%5Cu3002%24n%3C%3D5000%24%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A88%2C%22totalAccepted%22%3A51%2C%22pid%22%3A%22CF1120C%22%2C%22title%22%3A%22Compress%20String%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P3065%22%2C%22title%22%3A%22%5BUSACO12DEC%5D%5Cu7b2c%5Cu4e00%21First%21%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22CF535D%22%2C%22title%22%3A%22Tavas%20and%20Malekas%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22P4824%22%2C%22title%22%3A%22%5BUSACO15FEB%5DCensoring%20%28Silver%29%20%5Cu5ba1%5Cu67e5%28%5Cu94f6%29%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P5018%22%2C%22title%22%3A%22%5Cu5bf9%5Cu79f0%5Cu4e8c%5Cu53c9%5Cu6811%22%2C%22difficulty%22%3A4%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22CF1120D%22%2C%22title%22%3A%22Power%20Tree%22%2C%22difficulty%22%3A4%2C%22type%22%3A%22CF%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Compress%20String%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Compress String</h1>
<h2>题意翻译</h2>
<div>给出$n$,$a$,$b$,将一个串划分成若干段，每一段必须是单个字符或者是前面一部分的子串，划分成一个字符需要$a$元，划分成前面一部分的子串需要$b$元，问最小花费是多少。$n<=5000$</div>
<h2>题目描述</h2>
<div>Suppose you are given a string $ s $ of length $ n $ consisting of lowercase English letters. You need to compress it using the smallest possible number of coins.
To compress the string, you have to represent $ s $ as a concatenation of several non-empty strings: $ s = t_{1} t_{2} \ldots t_{k} $ . The $ i $ -th of these strings should be encoded with one of the two ways:
- if $ |t_{i}| = 1 $ , meaning that the current string consists of a single character, you can encode it paying $ a $ coins;
- if $ t_{i} $ is a substring of $ t_{1} t_{2} \ldots t_{i - 1} $ , then you can encode it paying $ b $ coins.
A string $ x $ is a substring of a string $ y $ if $ x $ can be obtained from $ y $ by deletion of several (possibly, zero or all) characters from the beginning and several (possibly, zero or all) characters from the end.
So your task is to calculate the minimum possible number of coins you need to spend in order to compress the given string $ s $ .</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains three positive integers, separated by spaces: $ n $ , $ a $ and $ b $ ( $ 1 \leq n, a, b \leq 5000 $ ) — the length of the string, the cost to compress a one-character string and the cost to compress a string that appeared before.
The second line contains a single string $ s $ , consisting of $ n $ lowercase English letters.</div>
<h3>输出格式</h3>
<br />
<div>Output a single integer — the smallest possible number of coins you need to spend to compress $ s $ .</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>
3 3 1
aba
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>
7
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>
4 1 1
abcd
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>
4
</code></pre>
<h3>输入样例 #3</h3>
<pre><code>
4 10 1
aaaa
</code></pre>
<h3>输出样例 #3</h3>
<pre><code>
12
</code></pre>
<h2>说明</h2>
<div>In the first sample case, you can set $ t_{1} = $ 'a', $ t_{2} = $ 'b', $ t_{3} = $ 'a' and pay $ 3 + 3 + 1 = 7 $ coins, since $ t_{3} $ is a substring of $ t_{1}t_{2} $ .
In the second sample, you just need to compress every character by itself.
In the third sample, you set $ t_{1} = t_{2} = $ 'a', $ t_{3} = $ 'aa' and pay $ 10 + 1 + 1 = 12 $ coins, since $ t_{2} $ is a substring of $ t_{1} $ and $ t_{3} $ is a substring of $ t_{1} t_{2} $ .</div>
</article>
</div>
</div>
</body>
</html>
