<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>New Year and Snowy Grid - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573397456:Jlin0VfchFbqH+QadUKxh9qaI5z5h39U6PURXdrna3s=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%22%2C%22description%22%3A%22Pay%20attention%20to%20the%20output%20section%20below%2C%20where%20you%20will%20see%20the%20information%20about%20flushing%20the%20output.%5Cn%5CnBearland%20is%20a%20grid%20with%20%24%20h%20%24%20rows%20and%20%24%20w%20%24%20columns.%20Rows%20are%20numbered%20%24%201%20%24%20through%20%24%20h%20%24%20from%20top%20to%20bottom.%20Columns%20are%20numbered%20%24%201%20%24%20through%20%24%20w%20%24%20from%20left%20to%20right.%20Every%20cell%20is%20either%20allowed%20%28denoted%20by%20%27.%27%20in%20the%20input%29%20or%20permanently%20blocked%20%28denoted%20by%20%27%5C%5C%23%27%29.%5Cn%5CnBearland%20is%20a%20cold%20land%2C%20where%20heavy%20snow%20often%20makes%20travelling%20harder.%20Every%20day%20a%20few%20allowed%20cells%20are%20temporarily%20blocked%20by%20snow.%20Note%2C%20that%20this%20block%20works%20only%20on%20this%20particular%20day%20and%20next%20day%20any%20of%20these%20cells%20might%20be%20allowed%20again%20%28unless%20there%20is%20another%20temporarily%20block%29.%5Cn%5CnIt%27s%20possible%20to%20move%20directly%20between%20two%20cells%20only%20if%20they%20share%20a%20side%20and%20none%20of%20them%20is%20permanently%20or%20temporarily%20blocked.%5Cn%5CnLimak%20is%20a%20little%20polar%20bear%20who%20lives%20in%20Bearland.%20His%20house%20is%20at%20the%20top%20left%20cell%2C%20while%20his%20school%20is%20at%20the%20bottom%20right%20cell.%20Every%20day%20Limak%20should%20first%20go%20from%20his%20house%20to%20the%20school%20and%20then%20return%20back%20to%20his%20house.%20Since%20he%20gets%20bored%20easily%2C%20he%20doesn%27t%20want%20to%20visit%20the%20same%20cell%20twice%20on%20one%20day%2C%20except%20for%20the%20cell%20with%20his%20house%2C%20where%20he%20starts%20and%20ends.%20If%20Limak%20can%20reach%20a%20school%20and%20return%20home%20avoiding%20revisiting%20cells%2C%20he%20calls%20a%20day%20interesting.%5Cn%5CnThere%20are%20%24%20q%20%24%20days%20you%20must%20process%2C%20one%20after%20another.%20For%20each%20of%20these%20days%20you%20should%20check%20if%20it%27s%20interesting%20and%20print%20%5C%22YES%5C%22%20or%20%5C%22NO%5C%22%20on%20a%20separate%20line.%20In%20order%20to%20be%20able%20to%20read%20the%20description%20of%20the%20next%20day%20you%20should%20print%20the%20answer%20for%20the%20previous%20one%20and%20flush%20the%20output.%5Cn%5CnIt%27s%20guaranteed%20that%20a%20day%20with%20no%20cells%20temporarily%20blocked%20by%20snow%20would%20be%20interesting.%20It%27s%20also%20guaranteed%20that%20cells%20with%20Limak%27s%20house%20and%20school%20are%20never%20blocked%20%28neither%20permanently%20or%20temporarily%29.%22%2C%22inputFormat%22%3A%22The%20first%20line%20of%20the%20input%20contains%20three%20integers%20%24%20h%20%24%20%2C%20%24%20w%20%24%20and%20%24%20q%20%24%20%28%20%24%202%3C%3Dh%2Cw%3C%3D1000%20%24%20%2C%20%24%201%3C%3Dq%3C%3D10000%20%24%20%29%20%5Cu2014%20the%20height%20and%20the%20width%20of%20the%20grid%2C%20and%20the%20number%20of%20days%2C%20respectively.%5Cn%5CnNext%20%24%20h%20%24%20lines%20describe%20which%20cells%20are%20allowed%20and%20which%20permanently%20blocked.%20The%20%24%20i%20%24%20-th%20line%20contains%20a%20string%20of%20length%20%24%20w%20%24%20%2C%20describing%20the%20%24%20i%20%24%20-th%20row.%20Every%20character%20is%20either%20%27.%27%20%28denoting%20an%20allowed%20cell%29%20or%20%27%5C%5C%23%27%20%28denoting%20a%20permanently%20blocked%20cell%29.%20It%27s%20guaranteed%20that%20a%20day%20with%20no%20cells%20temporarily%20blocked%20by%20snow%20would%20be%20interesting.%5Cn%5CnThen%2C%20the%20description%20of%20%24%20q%20%24%20days%20is%20given.%20The%20description%20of%20the%20%24%20i%20%24%20-th%20day%20starts%20with%20a%20line%20containing%20a%20single%20integer%20%24%20k_%7Bi%7D%20%24%20%28%20%24%201%3C%3Dk_%7Bi%7D%3C%3D10%20%24%20%29%20%5Cu2014%20the%20number%20of%20cells%20that%20are%20temporarily%20blocked%20by%20snow%20on%20that%20day.%20Each%20of%20next%20%24%20k_%7Bi%7D%20%24%20lines%20contains%20two%20integers%20%24%20r_%7Bi%2Cj%7D%20%24%20and%20%24%20c_%7Bi%2Cj%7D%20%24%20%28%20%24%201%3C%3Dr_%7Bi%2Cj%7D%3C%3Dh%20%24%20%2C%20%24%201%3C%3Dc_%7Bi%2Cj%7D%3C%3Dw%20%24%20%29%2C%20representing%20a%20cell%20at%20the%20intersection%20of%20the%20row%20%24%20r_%7Bi%2Cj%7D%20%24%20and%20the%20column%20%24%20c_%7Bi%2Cj%7D%20%24%20.%20The%20given%20%24%20k_%7Bi%7D%20%24%20cells%20are%20distinct%20and%20none%20of%20them%20is%20permanently%20blocked.%20Also%2C%20none%20of%20them%20contains%20Limak%27s%20house%20or%20school.%22%2C%22outputFormat%22%3A%22For%20each%20of%20%24%20q%20%24%20days%20print%20%5C%22YES%5C%22%20if%20that%20day%20is%20interesting%2C%20and%20otherwise%20print%20%5C%22NO%5C%22%2C%20both%20without%20the%20quotes.%20After%20printing%20an%20answer%2C%20you%20have%20to%20both%20print%20the%20end-of-line%20character%20and%20flush%20the%20output.%20Then%20you%20can%20proceed%20to%20the%20next%20day.%20You%20can%20get%20Idleness%20Limit%20Exceeded%20if%20you%20don%27t%20print%20anything%20or%20if%20you%20forget%20to%20flush%20the%20output.%5Cn%5CnTo%20flush%20you%20can%20use%20%28just%20after%20printing%20a%20YES%5C%2FNO%20and%20end-of-line%29%3A%5Cn%5Cn-%20fflush%28stdout%29%20in%20C%2B%2B%3B%5Cn-%20System.out.flush%28%29%20in%20Java%3B%5Cn-%20stdout.flush%28%29%20in%20Python%3B%5Cn-%20flush%28output%29%20in%20Pascal%3B%5Cn-%20See%20the%20documentation%20for%20other%20languages.%22%2C%22samples%22%3A%5B%5B%223%205%204%5Cn.....%5Cn.....%5Cn.%23...%5Cn1%5Cn1%204%5Cn1%5Cn1%205%5Cn2%5Cn2%204%5Cn3%201%5Cn2%5Cn1%205%5Cn3%203%5Cn%22%2C%22NO%5CnYES%5CnYES%5CnNO%5Cn%22%5D%2C%5B%229%2031%205%5Cn...............................%5Cn...............................%5Cn.%23%23%23.%23%23%23.%23.%23%23%23...%23%23%23.%23%23%23.%23.%23%23%23.%5Cn...%23.%23.%23.%23.%23.......%23.%23.%23.%23...%23.%5Cn.%23%23%23.%23.%23.%23.%23%23%23...%23%23%23.%23.%23.%23...%23.%5Cn.%23...%23.%23.%23.%23.%23...%23...%23.%23.%23...%23.%5Cn.%23%23%23.%23%23%23.%23.%23%23%23...%23%23%23.%23%23%23.%23...%23.%5Cn...............................%5Cn...............................%5Cn5%5Cn6%205%5Cn2%2011%5Cn1%2014%5Cn8%2015%5Cn2%2014%5Cn5%5Cn2%2014%5Cn1%2014%5Cn8%2016%5Cn6%205%5Cn2%2011%5Cn3%5Cn2%202%5Cn1%204%5Cn8%2030%5Cn10%5Cn3%201%5Cn3%2011%5Cn5%2016%5Cn7%2021%5Cn4%2016%5Cn3%205%5Cn7%2031%5Cn3%209%5Cn7%2025%5Cn3%2027%5Cn10%5Cn3%201%5Cn3%209%5Cn7%2025%5Cn3%2027%5Cn7%2021%5Cn4%2017%5Cn3%205%5Cn7%2031%5Cn4%2016%5Cn3%2011%5Cn%22%2C%22NO%5CnYES%5CnYES%5CnYES%5CnNO%5Cn%22%5D%5D%2C%22hint%22%3A%22In%20the%20first%20sample%2C%20there%20are%20%24%204%20%24%20days.%20Drawings%20below%20show%20how%20Limak%20could%20go%20to%20school%20and%20return%20to%20his%20home%20in%20the%20second%20and%20the%20third%20day%20%28on%20the%20left%20and%20on%20the%20right%20respectively%29.%20A%20permanently%20blocked%20cell%20is%20painted%20red%2C%20while%20cells%20temporarily%20blocked%20by%20snow%20are%20painted%20orange.%20Black%20and%20green%20arrows%20should%20Limak%27s%20way%20to%20the%20school%20and%20back%20to%20the%20house%20respectively.%5Cn%5Cn%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF750H%5C%2F12faf454c20e549286698bdfff6e5baa8b1aae30.png%29For%20the%20second%20sample%2C%20below%20you%20can%20see%20how%20the%20grid%20looks%20like%20on%20each%20day%2C%20where%20%27%5C%5C%23%27%20denotes%20a%20cell%20that%20is%20blocked%2C%20either%20temporarily%20or%20permanently.%5Cn%5Cn%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF750H%5C%2Ff3a41e654116d8de6780666e33ff7f4faa3b7c75.png%29%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B9000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F750%5C%2FH%22%2C%22id%22%3A%22750H%22%7D%2C%22translation%22%3A%22%5Cu7ed9%5Cu4e00%5Cu4e2a%24N%2AM%24%20%5Cu7684%5Cu68cb%5Cu76d8%2C%5Cu6709%5Cu969c%5Cu788d%2C%24Q%24%20%5Cu6b21%5Cu8be2%5Cu95ee%5Cu628a%24K%24%20%5Cu4e2a%5Cu70b9%5Cu53d8%5Cu6210%5Cu969c%5Cu788d%5Cu540e%5Cu80fd%5Cu5426%5Cu627e%5Cu5230%5Cu4e24%5Cu6761%24%281%2C1%29%24%20%5Cu5230%24%28n%2Cn%29%24%20%5Cu7684%5Cu4e0d%5Cu76f8%5Cu4ea4%5Cu8def%5Cu5f84%2C%5Cu5f3a%5Cu5236%5Cu5728%5Cu7ebf%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A2%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22CF750H%22%2C%22title%22%3A%22New%20Year%20and%20Snowy%20Grid%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A36600%2C%22title%22%3A%22%5Cu9898%5Cu610f%22%2C%22forum%22%3A%7B%22id%22%3A9610%2C%22name%22%3A%22CF750H%20New%20Year%20and%20Snowy%20Grid%22%2C%22slug%22%3A%22CF750H%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22New%20Year%20and%20Snowy%20Grid%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>New Year and Snowy Grid</h1>
<h2>题意翻译</h2>
<div>给一个$N*M$ 的棋盘,有障碍,$Q$ 次询问把$K$ 个点变成障碍后能否找到两条$(1,1)$ 到$(n,n)$ 的不相交路径,强制在线</div>
<h2>题目描述</h2>
<div>Pay attention to the output section below, where you will see the information about flushing the output.
Bearland is a grid with $ h $ rows and $ w $ columns. Rows are numbered $ 1 $ through $ h $ from top to bottom. Columns are numbered $ 1 $ through $ w $ from left to right. Every cell is either allowed (denoted by '.' in the input) or permanently blocked (denoted by '\#').
Bearland is a cold land, where heavy snow often makes travelling harder. Every day a few allowed cells are temporarily blocked by snow. Note, that this block works only on this particular day and next day any of these cells might be allowed again (unless there is another temporarily block).
It's possible to move directly between two cells only if they share a side and none of them is permanently or temporarily blocked.
Limak is a little polar bear who lives in Bearland. His house is at the top left cell, while his school is at the bottom right cell. Every day Limak should first go from his house to the school and then return back to his house. Since he gets bored easily, he doesn't want to visit the same cell twice on one day, except for the cell with his house, where he starts and ends. If Limak can reach a school and return home avoiding revisiting cells, he calls a day interesting.
There are $ q $ days you must process, one after another. For each of these days you should check if it's interesting and print "YES" or "NO" on a separate line. In order to be able to read the description of the next day you should print the answer for the previous one and flush the output.
It's guaranteed that a day with no cells temporarily blocked by snow would be interesting. It's also guaranteed that cells with Limak's house and school are never blocked (neither permanently or temporarily).</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line of the input contains three integers $ h $ , $ w $ and $ q $ ( $ 2<=h,w<=1000 $ , $ 1<=q<=10000 $ ) — the height and the width of the grid, and the number of days, respectively.
Next $ h $ lines describe which cells are allowed and which permanently blocked. The $ i $ -th line contains a string of length $ w $ , describing the $ i $ -th row. Every character is either '.' (denoting an allowed cell) or '\#' (denoting a permanently blocked cell). It's guaranteed that a day with no cells temporarily blocked by snow would be interesting.
Then, the description of $ q $ days is given. The description of the $ i $ -th day starts with a line containing a single integer $ k_{i} $ ( $ 1<=k_{i}<=10 $ ) — the number of cells that are temporarily blocked by snow on that day. Each of next $ k_{i} $ lines contains two integers $ r_{i,j} $ and $ c_{i,j} $ ( $ 1<=r_{i,j}<=h $ , $ 1<=c_{i,j}<=w $ ), representing a cell at the intersection of the row $ r_{i,j} $ and the column $ c_{i,j} $ . The given $ k_{i} $ cells are distinct and none of them is permanently blocked. Also, none of them contains Limak's house or school.</div>
<h3>输出格式</h3>
<br />
<div>For each of $ q $ days print "YES" if that day is interesting, and otherwise print "NO", both without the quotes. After printing an answer, you have to both print the end-of-line character and flush the output. Then you can proceed to the next day. You can get Idleness Limit Exceeded if you don't print anything or if you forget to flush the output.
To flush you can use (just after printing a YES/NO and end-of-line):
- fflush(stdout) in C++;
- System.out.flush() in Java;
- stdout.flush() in Python;
- flush(output) in Pascal;
- See the documentation for other languages.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>3 5 4
.....
.....
.#...
1
1 4
1
1 5
2
2 4
3 1
2
1 5
3 3
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>NO
YES
YES
NO
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>9 31 5
...............................
...............................
.###.###.#.###...###.###.#.###.
...#.#.#.#.#.......#.#.#.#...#.
.###.#.#.#.###...###.#.#.#...#.
.#...#.#.#.#.#...#...#.#.#...#.
.###.###.#.###...###.###.#...#.
...............................
...............................
5
6 5
2 11
1 14
8 15
2 14
5
2 14
1 14
8 16
6 5
2 11
3
2 2
1 4
8 30
10
3 1
3 11
5 16
7 21
4 16
3 5
7 31
3 9
7 25
3 27
10
3 1
3 9
7 25
3 27
7 21
4 17
3 5
7 31
4 16
3 11
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>NO
YES
YES
YES
NO
</code></pre>
<h2>说明</h2>
<div>In the first sample, there are $ 4 $ days. Drawings below show how Limak could go to school and return to his home in the second and the third day (on the left and on the right respectively). A permanently blocked cell is painted red, while cells temporarily blocked by snow are painted orange. Black and green arrows should Limak's way to the school and back to the house respectively.
![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF750H/12faf454c20e549286698bdfff6e5baa8b1aae30.png)For the second sample, below you can see how the grid looks like on each day, where '\#' denotes a cell that is blocked, either temporarily or permanently.
![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF750H/f3a41e654116d8de6780666e33ff7f4faa3b7c75.png)</div>
</article>
</div>
</div>
</body>
</html>
