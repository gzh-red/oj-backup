<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Pawn - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573390213:4ZlZdndwoqCPgEXV0DHBl8cXfUKBhIdLXwRqXC29p+U=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%22%2C%22description%22%3A%22On%20some%20square%20in%20the%20lowest%20row%20of%20a%20chessboard%20a%20stands%20a%20pawn.%20It%20has%20only%20two%20variants%20of%20moving%3A%20upwards%20and%20leftwards%20or%20upwards%20and%20rightwards.%20The%20pawn%20can%20choose%20from%20which%20square%20of%20the%20lowest%20row%20it%20can%20start%20its%20journey.%20On%20each%20square%20lay%20from%200%20to%209%20peas.%20The%20pawn%20wants%20to%20reach%20the%20uppermost%20row%20having%20collected%20as%20many%20peas%20as%20possible.%20As%20there%20it%20will%20have%20to%20divide%20the%20peas%20between%20itself%20and%20its%20%24%20k%20%24%20brothers%2C%20the%20number%20of%20peas%20must%20be%20divisible%20by%20%24%20k%2B1%20%24%20.%20Find%20the%20maximal%20number%20of%20peas%20it%20will%20be%20able%20to%20collect%20and%20which%20moves%20it%20should%20make%20to%20do%20it.%5Cn%5CnThe%20pawn%20cannot%20throw%20peas%20away%20or%20leave%20the%20board.%20When%20a%20pawn%20appears%20in%20some%20square%20of%20the%20board%20%28including%20the%20first%20and%20last%20square%20of%20the%20way%29%2C%20it%20necessarily%20takes%20all%20the%20peas.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20three%20integers%20%24%20n%20%24%20%2C%20%24%20m%20%24%20%2C%20%24%20k%20%24%20%28%20%24%202%3C%3Dn%2Cm%3C%3D100%2C0%3C%3Dk%3C%3D10%20%24%20%29%20%5Cu2014%20the%20number%20of%20rows%20and%20columns%20on%20the%20chessboard%2C%20the%20number%20of%20the%20pawn%27s%20brothers.%20Then%20follow%20%24%20n%20%24%20lines%20containing%20each%20%24%20m%20%24%20numbers%20from%200%20to%209%20without%20spaces%20%5Cu2014%20the%20chessboard%27s%20description.%20Each%20square%20is%20described%20by%20one%20number%20%5Cu2014%20the%20number%20of%20peas%20in%20it.%20The%20first%20line%20corresponds%20to%20the%20uppermost%20row%20and%20the%20last%20line%20%5Cu2014%20to%20the%20lowest%20row.%22%2C%22outputFormat%22%3A%22If%20it%20is%20impossible%20to%20reach%20the%20highest%20row%20having%20collected%20the%20number%20of%20peas%20divisible%20by%20%24%20k%2B1%20%24%20%2C%20print%20-1.%5Cn%5CnOtherwise%2C%20the%20first%20line%20must%20contain%20a%20single%20number%20%5Cu2014%20the%20maximal%20number%20of%20peas%20the%20pawn%20can%20collect%20given%20that%20the%20number%20must%20be%20divisible%20by%20%24%20k%2B1%20%24%20.%20The%20second%20line%20must%20contain%20a%20single%20number%20%5Cu2014%20the%20number%20of%20the%20square%27s%20column%20in%20the%20lowest%20row%2C%20from%20which%20the%20pawn%20must%20start%20its%20journey.%20The%20columns%20are%20numbered%20from%20the%20left%20to%20the%20right%20with%20integral%20numbers%20starting%20from%20%24%201%20%24%20.%20The%20third%20line%20must%20contain%20a%20line%20consisting%20of%20%24%20n-1%20%24%20symbols%20%5Cu2014%20the%20description%20of%20the%20pawn%27s%20moves.%20If%20the%20pawn%20must%20move%20upwards%20and%20leftwards%2C%20print%20L%2C%20if%20it%20must%20move%20upwards%20and%20rightwards%2C%20print%20R.%20If%20there%20are%20several%20solutions%20to%20that%20problem%2C%20print%20any%20of%20them.%22%2C%22samples%22%3A%5B%5B%223%203%201%5Cn123%5Cn456%5Cn789%5Cn%22%2C%2216%5Cn2%5CnRL%5Cn%22%5D%2C%5B%223%203%200%5Cn123%5Cn456%5Cn789%5Cn%22%2C%2217%5Cn3%5CnLR%5Cn%22%5D%2C%5B%222%202%2010%5Cn98%5Cn75%5Cn%22%2C%22-1%5Cn%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F41%5C%2FD%22%2C%22id%22%3A%2241D%22%7D%2C%22translation%22%3A%22%5Cu7ffb%5Cu8bd1%5Cuff1a%5Cn%5Cu9898%5Cu76ee%5Cu63cf%5Cu8ff0%5Cuff1a%5Cn%5Cu56fd%5Cu9645%5Cu8c61%5Cu68cb%5Cu68cb%5Cu76d8%5Cu6700%5Cu5e95%5Cu884c%5Cu7ad9%5Cu4e86%5Cu4e00%5Cu4e2a%5Cu5175%5Cu3002%20%5Cu5b83%5Cu53ea%5Cu6709%5Cu4e24%5Cu79cd%5Cu884c%5Cu52a8%5Cu65b9%5Cu5f0f%5Cuff1a%20%5Cu5411%5Cu4e0a%5Cu5de6%5Cu6216%5Cu5411%5Cu4e0a%5Cu53f3%5Cu8d70%5Cu3002%20%5Cu5b83%5Cu53ef%5Cu4ee5%5Cu9009%5Cu62e9%5Cu4ece%5Cu6700%5Cu4f4e%5Cu884c%5Cu54ea%5Cu4e2a%5Cu8282%5Cu70b9%5Cu5f00%5Cu59cb%5Cu4ed6%5Cu7684%5Cu65c5%5Cu7a0b%5Cu3002%20%5Cu6bcf%5Cu4e2a%5Cu683c%5Cu5b50%5Cu4e0a%5Cu67090-9%5Cu9897%5Cu8c4c%5Cu8c46%5Cuff0c%5Cu800c%5Cu58eb%5Cu5175%5Cu60f3%5Cu79fb%5Cu52a8%5Cu5230%5Cu6700%5Cu4e0a%5Cu4e00%5Cu884c%5Cu5e76%5Cu4e14%5Cu79ef%5Cu7d2f%5Cu5230%5Cu5c3d%5Cu53ef%5Cu80fd%5Cu591a%5Cu7684%5Cu8c4c%5Cu8c46%5Cu3002%5Cu540c%5Cu65f6%5Cuff0c%5Cu56e0%5Cu4e3a%5Cu8fd9%5Cu4e2a%5Cu58eb%5Cu5175%5Cu5fc5%5Cu987b%5Cu628a%5Cu8c4c%5Cu8c46%5Cu5e73%5Cu5747%5Cu5206%5Cu7ed9%5Cu81ea%5Cu5df1%5Cu548c%5Cu4ed6%5Cu7684k%5Cu4e2a%5Cu5144%5Cu5f1f%5Cuff0c%5Cu4ed6%5Cu6240%5Cu6536%5Cu96c6%5Cu5230%5Cu7684%5Cu8c4c%5Cu8c46%5Cu5fc5%5Cu987b%5Cu662fk%2B1%5Cu7684%5Cu500d%5Cu6570%5Cu3002%5Cu8bf7%5Cu627e%5Cu5230%5Cu4ed6%5Cu53ef%5Cu4ee5%5Cu6536%5Cu96c6%5Cu5230%5Cu7684%5Cu6700%5Cu591a%5Cu8c4c%5Cu8c46%5Cuff0c%5Cu5e76%5Cu786e%5Cu5b9a%5Cu4ed6%5Cu7684%5Cu64cd%5Cu4f5c%5Cu5e8f%5Cu5217%5Cu3002%5Cn%5Cn%5Cu89c4%5Cu5b9a%5Cu58eb%5Cu5175%5Cu4e0d%5Cu80fd%5Cu624b%5Cu52a8%5Cu6254%5Cu51fa%5Cu8c4c%5Cu8c46%5Cuff0c%5Cu5e76%5Cu4e14%5Cu4ed6%5Cu5fc5%5Cu987b%5Cu6361%5Cu8d77%5Cu6240%5Cu5230%5Cu8fbe%5Cu7684%5Cu6bcf%5Cu4e00%5Cu4e2a%5Cu683c%5Cu5b50%5Cu7684%5Cu6240%5Cu6709%5Cu8c4c%5Cu8c46%5Cu3002%5Cn%5Cn%5Cu8f93%5Cu5165%5Cu683c%5Cu5f0f%5Cuff1a%5Cn%5Cu7b2c%5Cu4e00%5Cu884c%5Cu4e09%5Cu4e2a%5Cu6574%5Cu6570n%2Cm%2Ck%28%242%20%3C%3D%20n%2Cm%20%3C%3D%20100%2C%200%20%3C%3D%20k%20%3C%3D%2010%29%24%20%5Cu884c%5Cu6570%5Cu3001%5Cu5217%5Cu6570%5Cu3001%5Cu58eb%5Cu5175%5Cu7684%5Cu5144%5Cu5f1f%5Cu4eec%5Cu3002%20%5Cn%5Cu63a5%5Cu4e0b%5Cu6765%5Cu4e00%5Cu4e2a%24n%20%5C%5Ctimes%20m%24%5Cu7684%5Cu77e9%5Cu9635%5Cuff0c%5Cu6bcf%5Cu4e2a%5Cu5143%5Cu7d20%5Cu5747%5Cu662f0-9%5Cu7684%5Cu6574%5Cu6570%5Cuff08%5Cu4e0d%5Cu7a7a%5Cu683c%5Cuff09%5Cuff0c%5Cu63cf%5Cu8ff0%5Cu8be5%5Cu683c%5Cu7684%5Cu8c4c%5Cu8c46%5Cu3002%5Cu7b2c%5Cu4e00%5Cu884c%5Cu88ab%5Cu8ba4%5Cu4e3a%5Cu662f%5Cu6700%5Cu4e0a%5Cu4e00%5Cu884c%5Cuff0c%5Cu6700%5Cu540e%5Cu4e00%5Cu884c%5Cu88ab%5Cu8ba4%5Cu4e3a%5Cu662f%5Cu6700%5Cu4e0b%5Cu4e00%5Cu884c%5Cu3002%5Cn%5Cn%5Cu8f93%5Cu51fa%5Cu683c%5Cu5f0f%5Cuff1a%5Cn%5Cn%5Cu5982%5Cu679c%5Cu4e0d%5Cu80fd%5Cu6536%5Cu96c6%5Cu5230k%2B1%5Cu500d%5Cu6570%5Cu7684%5Cu8c4c%5Cu8c46%5Cuff0c%5Cu8f93%5Cu51fa-1.%5Cn%5Cu5426%5Cu5219%5Cuff0c%5Cu8f93%5Cu51fa%5Cu7b2c%5Cu4e00%5Cu884c%5Cu4e00%5Cu4e2a%5Cu6574%5Cu6570%5Cuff0c%5Cu4e3a%5Cu6700%5Cu591a%5Cu8c4c%5Cu8c46%5Cu6570%5Cuff1b%5Cu7b2c%5Cu4e8c%5Cu884c%5Cu4e00%5Cu4e2a%5Cu6574%5Cu6570%5Cuff0c%5Cu4e3a%5Cu58eb%5Cu5175%5Cu5f00%5Cu59cb%5Cu79fb%5Cu52a8%5Cu7684%5Cu4f4d%5Cu7f6e%5Cuff1b%5Cu7b2c%5Cu4e09%5Cu884c%5Cu5305%5Cu62ecn-1%5Cu4e2a%5Cu5b57%5Cu6bcdL%20%5Cu6216%20R%5Cuff0c%5Cu8868%5Cu793a%5Cu58eb%5Cu5175%5Cu7684%5Cu884c%5Cu52a8%5Cu5e8f%5Cu5217%5Cu3002%5Cn%5Cn%5Cu5982%5Cu679c%5Cu6709%5Cu591a%5Cu79cd%5Cu6536%5Cu96c6%5Cu5230%5Cu76f8%5Cu540c%5Cu4e14%5Cu662fk%2B1%5Cu500d%5Cu6570%5Cu6570%5Cu91cf%5Cu7684%5Cu8c4c%5Cu8c46%5Cuff0c%5Cu4f60%5Cu53ef%5Cu4ee5%5Cu4efb%5Cu610f%5Cu8f93%5Cu51fa%5Cu4e00%5Cu79cd%5Cu65b9%5Cu6848%5Cu3002%5CnTranslated%20by%20%40Maniac%5Cu4e36%5Cu575a%5Cu679c%20%22%2C%22tags%22%3A%5B3%2C111%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A75%2C%22totalAccepted%22%3A25%2C%22pid%22%3A%22CF41D%22%2C%22title%22%3A%22Pawn%22%2C%22difficulty%22%3A4%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A32990%2C%22title%22%3A%22%5Cu7ffb%5Cu8bd1%22%2C%22forum%22%3A%7B%22id%22%3A12506%2C%22name%22%3A%22CF41D%20Pawn%22%2C%22slug%22%3A%22CF41D%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P1410%22%2C%22title%22%3A%22%5Cu5b50%5Cu5e8f%5Cu5217%22%2C%22difficulty%22%3A4%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P2296%22%2C%22title%22%3A%22%5Cu5bfb%5Cu627e%5Cu9053%5Cu8def%22%2C%22difficulty%22%3A4%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P2101%22%2C%22title%22%3A%22%5Cu547d%5Cu8fd0%5Cu77f3%5Cu4e4b%5Cu95e8%5Cu7684%5Cu9009%5Cu62e9%22%2C%22difficulty%22%3A3%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22CF474D%22%2C%22title%22%3A%22Flowers%22%2C%22difficulty%22%3A4%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF2B%22%2C%22title%22%3A%22The%20least%20round%20way%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22CF%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Pawn%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573295103;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Pawn</h1>
<h2>题意翻译</h2>
<div>翻译：
题目描述：
国际象棋棋盘最底行站了一个兵。 它只有两种行动方式： 向上左或向上右走。 它可以选择从最低行哪个节点开始他的旅程。 每个格子上有0-9颗豌豆，而士兵想移动到最上一行并且积累到尽可能多的豌豆。同时，因为这个士兵必须把豌豆平均分给自己和他的k个兄弟，他所收集到的豌豆必须是k+1的倍数。请找到他可以收集到的最多豌豆，并确定他的操作序列。
规定士兵不能手动扔出豌豆，并且他必须捡起所到达的每一个格子的所有豌豆。
输入格式：
第一行三个整数n,m,k($2 <= n,m <= 100, 0 <= k <= 10)$ 行数、列数、士兵的兄弟们。
接下来一个$n \times m$的矩阵，每个元素均是0-9的整数（不空格），描述该格的豌豆。第一行被认为是最上一行，最后一行被认为是最下一行。
输出格式：
如果不能收集到k+1倍数的豌豆，输出-1.
否则，输出第一行一个整数，为最多豌豆数；第二行一个整数，为士兵开始移动的位置；第三行包括n-1个字母L 或 R，表示士兵的行动序列。
如果有多种收集到相同且是k+1倍数数量的豌豆，你可以任意输出一种方案。
Translated by @Maniac丶坚果 </div>
<h2>题目描述</h2>
<div>On some square in the lowest row of a chessboard a stands a pawn. It has only two variants of moving: upwards and leftwards or upwards and rightwards. The pawn can choose from which square of the lowest row it can start its journey. On each square lay from 0 to 9 peas. The pawn wants to reach the uppermost row having collected as many peas as possible. As there it will have to divide the peas between itself and its $ k $ brothers, the number of peas must be divisible by $ k+1 $ . Find the maximal number of peas it will be able to collect and which moves it should make to do it.
The pawn cannot throw peas away or leave the board. When a pawn appears in some square of the board (including the first and last square of the way), it necessarily takes all the peas.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains three integers $ n $ , $ m $ , $ k $ ( $ 2<=n,m<=100,0<=k<=10 $ ) — the number of rows and columns on the chessboard, the number of the pawn's brothers. Then follow $ n $ lines containing each $ m $ numbers from 0 to 9 without spaces — the chessboard's description. Each square is described by one number — the number of peas in it. The first line corresponds to the uppermost row and the last line — to the lowest row.</div>
<h3>输出格式</h3>
<br />
<div>If it is impossible to reach the highest row having collected the number of peas divisible by $ k+1 $ , print -1.
Otherwise, the first line must contain a single number — the maximal number of peas the pawn can collect given that the number must be divisible by $ k+1 $ . The second line must contain a single number — the number of the square's column in the lowest row, from which the pawn must start its journey. The columns are numbered from the left to the right with integral numbers starting from $ 1 $ . The third line must contain a line consisting of $ n-1 $ symbols — the description of the pawn's moves. If the pawn must move upwards and leftwards, print L, if it must move upwards and rightwards, print R. If there are several solutions to that problem, print any of them.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>3 3 1
123
456
789
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>16
2
RL
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>3 3 0
123
456
789
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>17
3
LR
</code></pre>
<h3>输入样例 #3</h3>
<pre><code>2 2 10
98
75
</code></pre>
<h3>输出样例 #3</h3>
<pre><code>-1
</code></pre>
</article>
</div>
</div>
</body>
</html>
