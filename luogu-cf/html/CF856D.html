<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Masha and Cactus - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573398688:+rgwNB0a41wCZsoYv7dgt5WXd5v/g5FhH6GGMH+jXZo=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Masha%20is%20fond%20of%20cacti.%20When%20she%20was%20a%20little%20girl%2C%20she%20decided%20to%20plant%20a%20tree.%20Now%20Masha%20wants%20to%20make%20a%20nice%20cactus%20out%20of%20her%20tree.%5Cn%5CnRecall%20that%20tree%20is%20a%20connected%20undirected%20graph%20that%20has%20no%20cycles.%20Cactus%20is%20a%20connected%20undirected%20graph%20such%20that%20each%20vertex%20belongs%20to%20at%20most%20one%20cycle.%5Cn%5CnMasha%20has%20some%20additional%20edges%20that%20she%20can%20add%20to%20a%20tree.%20For%20each%20edge%20she%20knows%20which%20vertices%20it%20would%20connect%20and%20the%20beauty%20of%20this%20edge.%20Masha%20can%20add%20some%20of%20these%20edges%20to%20the%20graph%20if%20the%20resulting%20graph%20is%20a%20cactus.%20Beauty%20of%20the%20resulting%20cactus%20is%20sum%20of%20beauties%20of%20all%20added%20edges.%5Cn%5CnHelp%20Masha%20find%20out%20what%20maximum%20beauty%20of%20the%20resulting%20cactus%20she%20can%20achieve.%22%2C%22inputFormat%22%3A%22The%20first%20line%20of%20the%20input%20data%20contains%20two%20integers%20%24%20n%20%24%20and%20%24%20m%20%24%20%5Cu2014%20the%20number%20of%20vertices%20in%20a%20tree%2C%20and%20the%20number%20of%20additional%20edges%20available%20%28%20%24%203%3C%3Dn%3C%3D2%5Cu00b710%5E%7B5%7D%20%24%20%3B%20%24%200%3C%3Dm%3C%3D2%5Cu00b710%5E%7B5%7D%20%24%20%29.%5Cn%5CnLet%20us%20describe%20Masha%27s%20tree.%20It%20has%20a%20root%20at%20vertex%201.%20The%20second%20line%20contains%20%24%20n-1%20%24%20integers%3A%20%24%20p_%7B2%7D%2Cp_%7B3%7D%2C...%2Cp_%7Bn%7D%20%24%20%2C%20here%20%24%20p_%7Bi%7D%20%24%20%5Cu2014%20is%20the%20parent%20of%20a%20vertex%20%24%20i%20%24%20%5Cu2014%20the%20first%20vertex%20on%20a%20path%20from%20the%20vertex%20%24%20i%20%24%20to%20the%20root%20of%20the%20tree%20%28%20%24%201%3C%3Dp_%7Bi%7D%26lt%3Bi%20%24%20%29.%5Cn%5CnThe%20following%20%24%20m%20%24%20lines%20contain%20three%20integers%20%24%20u_%7Bi%7D%20%24%20%2C%20%24%20v_%7Bi%7D%20%24%20and%20%24%20c_%7Bi%7D%20%24%20%5Cu2014%20pairs%20of%20vertices%20to%20be%20connected%20by%20the%20additional%20edges%20that%20Masha%20can%20add%20to%20the%20tree%20and%20beauty%20of%20edge%20%28%20%24%201%3C%3Du_%7Bi%7D%2Cv_%7Bi%7D%3C%3Dn%20%24%20%3B%20%24%20u_%7Bi%7D%5Cu2260v_%7Bi%7D%20%24%20%3B%20%24%201%3C%3Dc_%7Bi%7D%3C%3D10%5E%7B4%7D%20%24%20%29.%5Cn%5CnIt%20is%20guaranteed%20that%20no%20additional%20edge%20coincides%20with%20the%20edge%20of%20the%20tree.%22%2C%22outputFormat%22%3A%22Output%20one%20integer%20%5Cu2014%20the%20maximum%20beauty%20of%20a%20cactus%20Masha%20can%20achieve.%22%2C%22samples%22%3A%5B%5B%227%203%5Cn1%201%202%202%203%203%5Cn4%205%201%5Cn6%207%201%5Cn2%203%201%5Cn%22%2C%222%5Cn%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F856%5C%2FD%22%2C%22id%22%3A%22856D%22%7D%2C%22translation%22%3A%22%5Cu7ed9%5Cu5b9a%5Cu4e00%5Cu68f5%24n%24%5Cu4e2a%5Cu70b9%5Cu7684%5Cu6811%5Cuff0c%5Cu53e6%5Cu6709%24m%24%5Cu6761%5Cu8fb9%5Cuff0c%5Cu6bcf%5Cu6761%5Cu8fb9%5Cu6709%5Cu4e00%5Cu4e2a%5Cu6743%5Cu503c%24c_i%24%5Cuff0c%5Cu8981%5Cu9009%5Cu62e9%5Cu4e00%5Cu4e9b%5Cu8fb9%5Cu52a0%5Cu5165%5Cu6811%5Cu4e2d%5Cuff0c%5Cu4f7f%5Cu5f97%5Cu6811%5Cu6210%5Cu4e3a%5Cu4ed9%5Cu4eba%5Cu638c%5Cuff0c%5Cu6307%5Cu6bcf%5Cu4e00%5Cu4e2a%5Cu70b9%5Cu81f3%5Cu591a%5Cu5305%5Cu542b%5Cu4e8e%5Cu4e00%5Cu4e2a%5Cu73af%5Cu7684%5Cu56fe%5Cuff0c%5Cu5e76%5Cu4f7f%5Cu5f97%5Cu9009%5Cu62e9%5Cu7684%5Cu8fb9%5Cu7684%5Cu6743%5Cu503c%5Cu548c%5Cu6700%5Cu5927%5Cuff0c%5Cu6c42%5Cu51fa%5Cu8fd9%5Cu4e2a%5Cu6700%5Cu5927%5Cu503c%5Cu3002%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A12%2C%22totalAccepted%22%3A7%2C%22pid%22%3A%22CF856D%22%2C%22title%22%3A%22Masha%20and%20Cactus%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Masha%20and%20Cactus%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Masha and Cactus</h1>
<h2>题意翻译</h2>
<div>给定一棵$n$个点的树，另有$m$条边，每条边有一个权值$c_i$，要选择一些边加入树中，使得树成为仙人掌，指每一个点至多包含于一个环的图，并使得选择的边的权值和最大，求出这个最大值。</div>
<h2>题目描述</h2>
<div>Masha is fond of cacti. When she was a little girl, she decided to plant a tree. Now Masha wants to make a nice cactus out of her tree.
Recall that tree is a connected undirected graph that has no cycles. Cactus is a connected undirected graph such that each vertex belongs to at most one cycle.
Masha has some additional edges that she can add to a tree. For each edge she knows which vertices it would connect and the beauty of this edge. Masha can add some of these edges to the graph if the resulting graph is a cactus. Beauty of the resulting cactus is sum of beauties of all added edges.
Help Masha find out what maximum beauty of the resulting cactus she can achieve.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line of the input data contains two integers $ n $ and $ m $ — the number of vertices in a tree, and the number of additional edges available ( $ 3<=n<=2·10^{5} $ ; $ 0<=m<=2·10^{5} $ ).
Let us describe Masha's tree. It has a root at vertex 1. The second line contains $ n-1 $ integers: $ p_{2},p_{3},...,p_{n} $ , here $ p_{i} $ — is the parent of a vertex $ i $ — the first vertex on a path from the vertex $ i $ to the root of the tree ( $ 1<=p_{i}&lt;i $ ).
The following $ m $ lines contain three integers $ u_{i} $ , $ v_{i} $ and $ c_{i} $ — pairs of vertices to be connected by the additional edges that Masha can add to the tree and beauty of edge ( $ 1<=u_{i},v_{i}<=n $ ; $ u_{i}≠v_{i} $ ; $ 1<=c_{i}<=10^{4} $ ).
It is guaranteed that no additional edge coincides with the edge of the tree.</div>
<h3>输出格式</h3>
<br />
<div>Output one integer — the maximum beauty of a cactus Masha can achieve.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>7 3
1 1 2 2 3 3
4 5 1
6 7 1
2 3 1
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>2
</code></pre>
</article>
</div>
</div>
</body>
</html>
