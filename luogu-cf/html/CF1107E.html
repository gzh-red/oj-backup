<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Vasya and Binary String - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573401780:XLXxxJQZnEPxD6dx2IaRbqJHYYxt0fz86vsvi4vF/CM=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Vasya%20has%20a%20string%20%24%20s%20%24%20of%20length%20%24%20n%20%24%20consisting%20only%20of%20digits%200%20and%201.%20Also%20he%20has%20an%20array%20%24%20a%20%24%20of%20length%20%24%20n%20%24%20.%5Cn%5CnVasya%20performs%20the%20following%20operation%20until%20the%20string%20becomes%20empty%3A%20choose%20some%20consecutive%20substring%20of%20equal%20characters%2C%20erase%20it%20from%20the%20string%20and%20glue%20together%20the%20remaining%20parts%20%28any%20of%20them%20can%20be%20empty%29.%20For%20example%2C%20if%20he%20erases%20substring%20111%20from%20string%20111110%20he%20will%20get%20the%20string%20110.%20Vasya%20gets%20%24%20a_x%20%24%20points%20for%20erasing%20substring%20of%20length%20%24%20x%20%24%20.%5Cn%5CnVasya%20wants%20to%20maximize%20his%20total%20points%2C%20so%20help%20him%20with%20this%21%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20one%20integer%20%24%20n%20%24%20%28%20%24%201%20%5C%5Cle%20n%20%5C%5Cle%20100%20%24%20%29%20%5Cu2014%20the%20length%20of%20string%20%24%20s%20%24%20.%5Cn%5CnThe%20second%20line%20contains%20string%20%24%20s%20%24%20%2C%20consisting%20only%20of%20digits%200%20and%201.%5Cn%5CnThe%20third%20line%20contains%20%24%20n%20%24%20integers%20%24%20a_1%2C%20a_2%2C%20%5C%5Cdots%20a_n%20%24%20%28%20%24%201%20%5C%5Cle%20a_i%20%5C%5Cle%2010%5E9%20%24%20%29%2C%20where%20%24%20a_i%20%24%20is%20the%20number%20of%20points%20for%20erasing%20the%20substring%20of%20length%20%24%20i%20%24%20.%22%2C%22outputFormat%22%3A%22Print%20one%20integer%20%5Cu2014%20the%20maximum%20total%20points%20Vasya%20can%20get.%22%2C%22samples%22%3A%5B%5B%22%5Cn7%5Cn1101001%5Cn3%204%209%20100%201%202%203%5Cn%22%2C%22%5Cn109%5Cn%22%5D%2C%5B%22%5Cn5%5Cn10101%5Cn3%2010%2015%2015%2015%5Cn%22%2C%22%5Cn23%5Cn%22%5D%5D%2C%22hint%22%3A%22In%20the%20first%20example%20the%20optimal%20sequence%20of%20erasings%20is%3A%201101001%20%24%20%5C%5Crightarrow%20%24%20111001%20%24%20%5C%5Crightarrow%20%24%2011101%20%24%20%5C%5Crightarrow%20%24%201111%20%24%20%5C%5Crightarrow%20%24%20%24%20%5C%5Cvarnothing%20%24%20.%5Cn%5CnIn%20the%20second%20example%20the%20optimal%20sequence%20of%20erasings%20is%3A%2010101%20%24%20%5C%5Crightarrow%20%24%201001%20%24%20%5C%5Crightarrow%20%24%2011%20%24%20%5C%5Crightarrow%20%24%20%24%20%5C%5Cvarnothing%20%24%20.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F1107%5C%2FE%22%2C%22id%22%3A%221107E%22%7D%2C%22translation%22%3A%22%5Cu7ed9%5Cu4f60%5Cu4e00%5Cu4e2a%5Cu957f%5Cu5ea6%5Cu4e3a%24n%281%3C%3Dn%3C%3D100%29%24%5Cu768401%5Cu4e32%24s%24%5Cuff0c%5Cu4ece%24s%24%5Cu4e2d%5Cu5220%5Cu9664%5Cu4e00%5Cu6bb5%5Cu8fde%5Cu7eed%5Cu7684%5Cu957f%5Cu5ea6%5Cu4e3ai%5Cu7684%5Cu6240%5Cu6709%5Cu5b57%5Cu7b26%5Cu90fd%5Cu76f8%5Cu540c%5Cu7684%5Cu5b50%5Cu4e32%5Cu5c06%5Cu4f1a%5Cu5f97%5Cu5230%24a_i%24%5Cu7684%5Cu5206%5Cu6570%5Cuff0c%5Cu5982%5Cu679c%5Cu6267%5Cu884c%5Cu4e0a%5Cu8ff0%5Cu64cd%5Cu4f5c%5Cu76f4%5Cu5230%24s%24%5Cu88ab%5Cu5220%5Cu9664%5Cu5b8c%5Cuff0c%5Cu6c42%5Cu6700%5Cu5927%5Cu5206%5Cu6570%5Cu548c%5Cu3002%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A73%2C%22totalAccepted%22%3A44%2C%22pid%22%3A%22CF1107E%22%2C%22title%22%3A%22Vasya%20and%20Binary%20String%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A103398%2C%22title%22%3A%22%5Cu611f%5Cu89c9%5Cu5e76%5Cu4e0d%5Cu662f%5Cu7279%5Cu522b%5Cu96be%22%2C%22forum%22%3A%7B%22id%22%3A33961%2C%22name%22%3A%22CF1107E%20Vasya%20and%20Binary%20String%22%2C%22slug%22%3A%22CF1107E%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22UVA10559%22%2C%22title%22%3A%22%5Cu65b9%5Cu5757%5Cu6d88%5Cu9664%20Blocks%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22UVA%22%7D%2C%7B%22pid%22%3A%22CF1107D%22%2C%22title%22%3A%22Compression%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22P5227%22%2C%22title%22%3A%22%5BAHOI2013%5D%5Cu8fde%5Cu901a%5Cu56fe%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22CF1153F%22%2C%22title%22%3A%22Serval%20and%20Bonus%20Problem%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1182E%22%2C%22title%22%3A%22Product%20Oriented%20Recurrence%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Vasya%20and%20Binary%20String%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Vasya and Binary String</h1>
<h2>题意翻译</h2>
<div>给你一个长度为$n(1<=n<=100)$的01串$s$，从$s$中删除一段连续的长度为i的所有字符都相同的子串将会得到$a_i$的分数，如果执行上述操作直到$s$被删除完，求最大分数和。</div>
<h2>题目描述</h2>
<div>Vasya has a string $ s $ of length $ n $ consisting only of digits 0 and 1. Also he has an array $ a $ of length $ n $ .
Vasya performs the following operation until the string becomes empty: choose some consecutive substring of equal characters, erase it from the string and glue together the remaining parts (any of them can be empty). For example, if he erases substring 111 from string 111110 he will get the string 110. Vasya gets $ a_x $ points for erasing substring of length $ x $ .
Vasya wants to maximize his total points, so help him with this!</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains one integer $ n $ ( $ 1 \le n \le 100 $ ) — the length of string $ s $ .
The second line contains string $ s $ , consisting only of digits 0 and 1.
The third line contains $ n $ integers $ a_1, a_2, \dots a_n $ ( $ 1 \le a_i \le 10^9 $ ), where $ a_i $ is the number of points for erasing the substring of length $ i $ .</div>
<h3>输出格式</h3>
<br />
<div>Print one integer — the maximum total points Vasya can get.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>
7
1101001
3 4 9 100 1 2 3
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>
109
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>
5
10101
3 10 15 15 15
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>
23
</code></pre>
<h2>说明</h2>
<div>In the first example the optimal sequence of erasings is: 1101001 $ \rightarrow $ 111001 $ \rightarrow $ 11101 $ \rightarrow $ 1111 $ \rightarrow $ $ \varnothing $ .
In the second example the optimal sequence of erasings is: 10101 $ \rightarrow $ 1001 $ \rightarrow $ 11 $ \rightarrow $ $ \varnothing $ .</div>
</article>
</div>
</div>
</body>
</html>
