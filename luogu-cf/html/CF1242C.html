<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Sum Balance - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573403605:ub7B8sKdqfthuHmTgX0nhe7Hjd6KlxvwmCXKmVK9CUM=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Ujan%20has%20a%20lot%20of%20numbers%20in%20his%20boxes.%20He%20likes%20order%20and%20balance%2C%20so%20he%20decided%20to%20reorder%20the%20numbers.%5Cn%5CnThere%20are%20%24%20k%20%24%20boxes%20numbered%20from%20%24%201%20%24%20to%20%24%20k%20%24%20.%20The%20%24%20i%20%24%20-th%20box%20contains%20%24%20n_i%20%24%20integer%20numbers.%20The%20integers%20can%20be%20negative.%20All%20of%20the%20integers%20are%20distinct.%5Cn%5CnUjan%20is%20lazy%2C%20so%20he%20will%20do%20the%20following%20reordering%20of%20the%20numbers%20exactly%20once.%20He%20will%20pick%20a%20single%20integer%20from%20each%20of%20the%20boxes%2C%20%24%20k%20%24%20integers%20in%20total.%20Then%20he%20will%20insert%20the%20chosen%20numbers%20%5Cu2014%20one%20integer%20in%20each%20of%20the%20boxes%2C%20so%20that%20the%20number%20of%20integers%20in%20each%20box%20is%20the%20same%20as%20in%20the%20beginning.%20Note%20that%20he%20may%20also%20insert%20an%20integer%20he%20picked%20from%20a%20box%20back%20into%20the%20same%20box.%5Cn%5CnUjan%20will%20be%20happy%20if%20the%20sum%20of%20the%20integers%20in%20each%20box%20is%20the%20same.%20Can%20he%20achieve%20this%20and%20make%20the%20boxes%20perfectly%20balanced%2C%20like%20all%20things%20should%20be%3F%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20a%20single%20integer%20%24%20k%20%24%20%28%20%24%201%20%5C%5Cleq%20k%20%5C%5Cleq%2015%20%24%20%29%2C%20the%20number%20of%20boxes.%5Cn%5CnThe%20%24%20i%20%24%20-th%20of%20the%20next%20%24%20k%20%24%20lines%20first%20contains%20a%20single%20integer%20%24%20n_i%20%24%20%28%20%24%201%20%5C%5Cleq%20n_i%20%5C%5Cleq%205%5C%5C%2C000%20%24%20%29%2C%20the%20number%20of%20integers%20in%20box%20%24%20i%20%24%20.%20Then%20the%20same%20line%20contains%20%24%20n_i%20%24%20integers%20%24%20a_%7Bi%2C1%7D%2C%20%5C%5Cldots%2C%20a_%7Bi%2Cn_i%7D%20%24%20%28%20%24%20%7Ca_%7Bi%2Cj%7D%7C%20%5C%5Cleq%2010%5E9%20%24%20%29%2C%20the%20integers%20in%20the%20%24%20i%20%24%20-th%20box.%5Cn%5CnIt%20is%20guaranteed%20that%20all%20%24%20a_%7Bi%2Cj%7D%20%24%20are%20distinct.%22%2C%22outputFormat%22%3A%22If%20Ujan%20cannot%20achieve%20his%20goal%2C%20output%20%5C%22No%5C%22%20in%20a%20single%20line.%20Otherwise%20in%20the%20first%20line%20output%20%5C%22Yes%5C%22%2C%20and%20then%20output%20%24%20k%20%24%20lines.%20The%20%24%20i%20%24%20-th%20of%20these%20lines%20should%20contain%20two%20integers%20%24%20c_i%20%24%20and%20%24%20p_i%20%24%20.%20This%20means%20that%20Ujan%20should%20pick%20the%20integer%20%24%20c_i%20%24%20from%20the%20%24%20i%20%24%20-th%20box%20and%20place%20it%20in%20the%20%24%20p_i%20%24%20-th%20box%20afterwards.%5Cn%5CnIf%20there%20are%20multiple%20solutions%2C%20output%20any%20of%20those.%5Cn%5CnYou%20can%20print%20each%20letter%20in%20any%20case%20%28upper%20or%20lower%29.%22%2C%22samples%22%3A%5B%5B%22%5Cn4%5Cn3%201%207%204%5Cn2%203%202%5Cn2%208%205%5Cn1%2010%5Cn%22%2C%22%5CnYes%5Cn7%202%5Cn2%203%5Cn5%201%5Cn10%204%5Cn%22%5D%2C%5B%22%5Cn2%5Cn2%203%20-2%5Cn2%20-1%205%5Cn%22%2C%22%5CnNo%5Cn%22%5D%2C%5B%22%5Cn2%5Cn2%20-10%2010%5Cn2%200%20-20%5Cn%22%2C%22%5CnYes%5Cn-10%202%5Cn-20%201%5Cn%22%5D%5D%2C%22hint%22%3A%22In%20the%20first%20sample%2C%20Ujan%20can%20put%20the%20number%20%24%207%20%24%20in%20the%20%24%202%20%24%20nd%20box%2C%20the%20number%20%24%202%20%24%20in%20the%20%24%203%20%24%20rd%20box%2C%20the%20number%20%24%205%20%24%20in%20the%20%24%201%20%24%20st%20box%20and%20keep%20the%20number%20%24%2010%20%24%20in%20the%20same%20%24%204%20%24%20th%20box.%20Then%20the%20boxes%20will%20contain%20numbers%20%24%20%5C%5C%7B1%2C5%2C4%5C%5C%7D%20%24%20%2C%20%24%20%5C%5C%7B3%2C%207%5C%5C%7D%20%24%20%2C%20%24%20%5C%5C%7B8%2C2%5C%5C%7D%20%24%20and%20%24%20%5C%5C%7B10%5C%5C%7D%20%24%20.%20The%20sum%20in%20each%20box%20then%20is%20equal%20to%20%24%2010%20%24%20.%5Cn%5CnIn%20the%20second%20sample%2C%20it%20is%20not%20possible%20to%20pick%20and%20redistribute%20the%20numbers%20in%20the%20required%20way.%5Cn%5CnIn%20the%20third%20sample%2C%20one%20can%20swap%20the%20numbers%20%24%20-20%20%24%20and%20%24%20-10%20%24%20%2C%20making%20the%20sum%20in%20each%20box%20equal%20to%20%24%20-10%20%24%20.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F1242%5C%2FC%22%2C%22id%22%3A%221242C%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A14%2C%22totalAccepted%22%3A10%2C%22pid%22%3A%22CF1242C%22%2C%22title%22%3A%22Sum%20Balance%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Sum%20Balance%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Sum Balance</h1>
<h2>题目描述</h2>
<div>Ujan has a lot of numbers in his boxes. He likes order and balance, so he decided to reorder the numbers.
There are $ k $ boxes numbered from $ 1 $ to $ k $ . The $ i $ -th box contains $ n_i $ integer numbers. The integers can be negative. All of the integers are distinct.
Ujan is lazy, so he will do the following reordering of the numbers exactly once. He will pick a single integer from each of the boxes, $ k $ integers in total. Then he will insert the chosen numbers — one integer in each of the boxes, so that the number of integers in each box is the same as in the beginning. Note that he may also insert an integer he picked from a box back into the same box.
Ujan will be happy if the sum of the integers in each box is the same. Can he achieve this and make the boxes perfectly balanced, like all things should be?</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains a single integer $ k $ ( $ 1 \leq k \leq 15 $ ), the number of boxes.
The $ i $ -th of the next $ k $ lines first contains a single integer $ n_i $ ( $ 1 \leq n_i \leq 5\,000 $ ), the number of integers in box $ i $ . Then the same line contains $ n_i $ integers $ a_{i,1}, \ldots, a_{i,n_i} $ ( $ |a_{i,j}| \leq 10^9 $ ), the integers in the $ i $ -th box.
It is guaranteed that all $ a_{i,j} $ are distinct.</div>
<h3>输出格式</h3>
<br />
<div>If Ujan cannot achieve his goal, output "No" in a single line. Otherwise in the first line output "Yes", and then output $ k $ lines. The $ i $ -th of these lines should contain two integers $ c_i $ and $ p_i $ . This means that Ujan should pick the integer $ c_i $ from the $ i $ -th box and place it in the $ p_i $ -th box afterwards.
If there are multiple solutions, output any of those.
You can print each letter in any case (upper or lower).</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>
4
3 1 7 4
2 3 2
2 8 5
1 10
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>
Yes
7 2
2 3
5 1
10 4
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>
2
2 3 -2
2 -1 5
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>
No
</code></pre>
<h3>输入样例 #3</h3>
<pre><code>
2
2 -10 10
2 0 -20
</code></pre>
<h3>输出样例 #3</h3>
<pre><code>
Yes
-10 2
-20 1
</code></pre>
<h2>说明</h2>
<div>In the first sample, Ujan can put the number $ 7 $ in the $ 2 $ nd box, the number $ 2 $ in the $ 3 $ rd box, the number $ 5 $ in the $ 1 $ st box and keep the number $ 10 $ in the same $ 4 $ th box. Then the boxes will contain numbers $ \{1,5,4\} $ , $ \{3, 7\} $ , $ \{8,2\} $ and $ \{10\} $ . The sum in each box then is equal to $ 10 $ .
In the second sample, it is not possible to pick and redistribute the numbers in the required way.
In the third sample, one can swap the numbers $ -20 $ and $ -10 $ , making the sum in each box equal to $ -10 $ .</div>
</article>
</div>
</div>
</body>
</html>
