<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Alyona and Strings - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573396635:1MNxnCZmT8vqOSBJfYJupC16vy2TOz04FyPmQ0Dczm4=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22After%20returned%20from%20forest%2C%20Alyona%20started%20reading%20a%20book.%20She%20noticed%20strings%20%24%20s%20%24%20and%20%24%20t%20%24%20%2C%20lengths%20of%20which%20are%20%24%20n%20%24%20and%20%24%20m%20%24%20respectively.%20As%20usual%2C%20reading%20bored%20Alyona%20and%20she%20decided%20to%20pay%20her%20attention%20to%20strings%20%24%20s%20%24%20and%20%24%20t%20%24%20%2C%20which%20she%20considered%20very%20similar.%5Cn%5CnAlyona%20has%20her%20favourite%20positive%20integer%20%24%20k%20%24%20and%20because%20she%20is%20too%20small%2C%20%24%20k%20%24%20does%20not%20exceed%20%24%2010%20%24%20.%20The%20girl%20wants%20now%20to%20choose%20%24%20k%20%24%20disjoint%20non-empty%20substrings%20of%20string%20%24%20s%20%24%20such%20that%20these%20strings%20appear%20as%20disjoint%20substrings%20of%20string%20%24%20t%20%24%20and%20in%20the%20same%20order%20as%20they%20do%20in%20string%20%24%20s%20%24%20.%20She%20is%20also%20interested%20in%20that%20their%20length%20is%20maximum%20possible%20among%20all%20variants.%5Cn%5CnFormally%2C%20Alyona%20wants%20to%20find%20a%20sequence%20of%20%24%20k%20%24%20non-empty%20strings%20%24%20p_%7B1%7D%2Cp_%7B2%7D%2Cp_%7B3%7D%2C...%2Cp_%7Bk%7D%20%24%20satisfying%20following%20conditions%3A%5Cn%5Cn-%20%24%20s%20%24%20can%20be%20represented%20as%20concatenation%20%24%20a_%7B1%7Dp_%7B1%7Da_%7B2%7Dp_%7B2%7D...%5C%5C%20a_%7Bk%7Dp_%7Bk%7Da_%7Bk%2B1%7D%20%24%20%2C%20where%20%24%20a_%7B1%7D%2Ca_%7B2%7D%2C...%2Ca_%7Bk%2B1%7D%20%24%20is%20a%20sequence%20of%20arbitrary%20strings%20%28some%20of%20them%20may%20be%20possibly%20empty%29%3B%5Cn-%20%24%20t%20%24%20can%20be%20represented%20as%20concatenation%20%24%20b_%7B1%7Dp_%7B1%7Db_%7B2%7Dp_%7B2%7D...%5C%5C%20b_%7Bk%7Dp_%7Bk%7Db_%7Bk%2B1%7D%20%24%20%2C%20where%20%24%20b_%7B1%7D%2Cb_%7B2%7D%2C...%2Cb_%7Bk%2B1%7D%20%24%20is%20a%20sequence%20of%20arbitrary%20strings%20%28some%20of%20them%20may%20be%20possibly%20empty%29%3B%5Cn-%20sum%20of%20the%20lengths%20of%20strings%20in%20sequence%20is%20maximum%20possible.%5Cn%5CnPlease%20help%20Alyona%20solve%20this%20complicated%20problem%20and%20find%20at%20least%20the%20sum%20of%20the%20lengths%20of%20the%20strings%20in%20a%20desired%20sequence.%5Cn%5CnA%20substring%20of%20a%20string%20is%20a%20subsequence%20of%20consecutive%20characters%20of%20the%20string.%22%2C%22inputFormat%22%3A%22In%20the%20first%20line%20of%20the%20input%20three%20integers%20%24%20n%20%24%20%2C%20%24%20m%20%24%20%2C%20%24%20k%20%24%20%28%20%24%201%3C%3Dn%2Cm%3C%3D1000%20%24%20%2C%20%24%201%3C%3Dk%3C%3D10%20%24%20%29%20are%20given%20%5Cu2014%20the%20length%20of%20the%20string%20%24%20s%20%24%20%2C%20the%20length%20of%20the%20string%20%24%20t%20%24%20and%20Alyona%27s%20favourite%20number%20respectively.%5Cn%5CnThe%20second%20line%20of%20the%20input%20contains%20string%20%24%20s%20%24%20%2C%20consisting%20of%20lowercase%20English%20letters.%5Cn%5CnThe%20third%20line%20of%20the%20input%20contains%20string%20%24%20t%20%24%20%2C%20consisting%20of%20lowercase%20English%20letters.%22%2C%22outputFormat%22%3A%22In%20the%20only%20line%20print%20the%20only%20non-negative%20integer%20%5Cu2014%20the%20sum%20of%20the%20lengths%20of%20the%20strings%20in%20a%20desired%20sequence.%5Cn%5CnIt%20is%20guaranteed%2C%20that%20at%20least%20one%20desired%20sequence%20exists.%22%2C%22samples%22%3A%5B%5B%223%202%202%5Cnabc%5Cnab%5Cn%22%2C%222%5Cn%22%5D%2C%5B%229%2012%204%5Cnbbaaababb%5Cnabbbabbaaaba%5Cn%22%2C%227%5Cn%22%5D%5D%2C%22hint%22%3A%22The%20following%20image%20describes%20the%20answer%20for%20the%20second%20sample%20case%3A%5Cn%5Cn%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF682D%5C%2F2e74041884d67a1d079badb418366bd0a678e7b0.png%29%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F682%5C%2FD%22%2C%22id%22%3A%22682D%22%7D%2C%22translation%22%3A%22%5Cu6709%5Cu4e24%5Cu79cd%5Cu5b57%5Cu7b26%5Cu4e32s%2Ct%5Cu3002%5Cu957f%5Cu5ea6%5Cu5206%5Cu522b%5Cu4e3an%2Cm%5Cu3002%5Cu73b0%5Cu5728%5Cu9700%5Cu8981%5Cu5728s%5Cu91cc%5Cu9762%5Cu6709%5Cu5e8f%5Cu5730%5Cu9009%5Cu51fak%5Cu4e2a%5Cu5b50%5Cu4e32%5Cuff0c%5Cu4e14%5Cu5728t%5Cu4e2d%5Cu51fa%5Cu73b0%5Cu7684%5Cu987a%5Cu5e8f%5Cu4e0e%5Cu8fd9k%5Cu4e2a%5Cu5b50%5Cu4e32%5Cu7684%5Cu987a%5Cu5e8f%5Cu76f8%5Cu540c%5Cu3002%5Cu95ee%5Cu8fd9k%5Cu4e2a%5Cu5b50%5Cu4e32%5Cu6700%5Cu5927%5Cu7684%5Cu957f%5Cu5ea6%5Cu548c%5Cu3002%5Cr%5Cn%5Cr%5Cnn%2Cm%5Cu22641000%5Cuff0ck%5Cu226410%5Cr%5Cn%5Cr%5Cn------------%5Cr%5Cn%2A%2A%5Cu8f93%5Cu5165%2A%2A%5Cr%5Cn%5Cr%5Cn%5Cu8f93%5Cu5165%5Cu7684%5Cu7b2c%5Cu4e00%5Cu884c%5Cu5305%5Cu542b%5Cu4e09%5Cu4e2a%5Cu6574%5Cu6570n%2Cm%2Ck%5Cr%5Cn%5Cr%5Cn%5Cu8f93%5Cu5165%5Cu7684%5Cu7b2c%5Cu4e8c%5Cu884c%5Cu5305%5Cu542b%5Cu5b57%5Cu7b26%5Cu4e32s%5Cuff0c%5Cu7531%5Cu5c0f%5Cu5199%5Cu82f1%5Cu6587%5Cu5b57%5Cu6bcd%5Cu7ec4%5Cu6210%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu8f93%5Cu5165%5Cu7684%5Cu7b2c%5Cu4e09%5Cu884c%5Cu5305%5Cu542b%5Cu5b57%5Cu7b26%5Cu4e32t%5Cuff0c%5Cu7531%5Cu5c0f%5Cu5199%5Cu82f1%5Cu6587%5Cu5b57%5Cu6bcd%5Cu7ec4%5Cu6210%5Cu3002%5Cr%5Cn%5Cr%5Cn------------%5Cr%5Cn%2A%2A%5Cu8f93%5Cu51fa%2A%2A%5Cr%5Cn%5Cr%5Cn%5Cu8f93%5Cu51fa%5Cu7b54%5Cu6848%5Cr%5Cn%5Cr%5Cn------------%5Cr%5Cn%5Cu6ce8%3A1%5Cu3001%5Cu4fdd%5Cu8bc1%5Cu81f3%5Cu5c11%5Cu5b58%5Cu5728%5Cu4e00%5Cu4e2a%5Cu671f%5Cu671b%5Cu7684%5Cu5e8f%5Cu5217%5Cu3002%5Cr%5Cn2%5Cu3001%5Cu56fe%5Cu793a%5Cu4e3a%5Cu6837%5Cu4f8b%5Cu4e8c%5Cu7684%5Cu60c5%5Cu51b5%5Cr%5Cn%5Cr%5Cn------------%5Cr%5Cn%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A55%2C%22totalAccepted%22%3A42%2C%22pid%22%3A%22CF682D%22%2C%22title%22%3A%22Alyona%20and%20Strings%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P1776%22%2C%22title%22%3A%22%5Cu5b9d%5Cu7269%5Cu7b5b%5Cu9009_NOI%5Cu5bfc%5Cu520a2010%5Cu63d0%5Cu9ad8%5Cuff0802%5Cuff09%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P3196%22%2C%22title%22%3A%22%5BHNOI2008%5D%5Cu795e%5Cu5947%5Cu7684%5Cu56fd%5Cu5ea6%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22CF580E%22%2C%22title%22%3A%22Kefa%20and%20Watch%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF567E%22%2C%22title%22%3A%22President%20and%20Roads%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22P5377%22%2C%22title%22%3A%22%5BTHUPC2019%5D%5Cu9e3d%5Cu9e3d%5Cu7684%5Cu5206%5Cu5272%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Alyona%20and%20Strings%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Alyona and Strings</h1>
<h2>题意翻译</h2>
<div>有两种字符串s,t。长度分别为n,m。现在需要在s里面有序地选出k个子串，且在t中出现的顺序与这k个子串的顺序相同。问这k个子串最大的长度和。
n,m≤1000，k≤10
------------
**输入**
输入的第一行包含三个整数n,m,k
输入的第二行包含字符串s，由小写英文字母组成。
输入的第三行包含字符串t，由小写英文字母组成。
------------
**输出**
输出答案
------------
注:1、保证至少存在一个期望的序列。
2、图示为样例二的情况
------------
</div>
<h2>题目描述</h2>
<div>After returned from forest, Alyona started reading a book. She noticed strings $ s $ and $ t $ , lengths of which are $ n $ and $ m $ respectively. As usual, reading bored Alyona and she decided to pay her attention to strings $ s $ and $ t $ , which she considered very similar.
Alyona has her favourite positive integer $ k $ and because she is too small, $ k $ does not exceed $ 10 $ . The girl wants now to choose $ k $ disjoint non-empty substrings of string $ s $ such that these strings appear as disjoint substrings of string $ t $ and in the same order as they do in string $ s $ . She is also interested in that their length is maximum possible among all variants.
Formally, Alyona wants to find a sequence of $ k $ non-empty strings $ p_{1},p_{2},p_{3},...,p_{k} $ satisfying following conditions:
- $ s $ can be represented as concatenation $ a_{1}p_{1}a_{2}p_{2}...\ a_{k}p_{k}a_{k+1} $ , where $ a_{1},a_{2},...,a_{k+1} $ is a sequence of arbitrary strings (some of them may be possibly empty);
- $ t $ can be represented as concatenation $ b_{1}p_{1}b_{2}p_{2}...\ b_{k}p_{k}b_{k+1} $ , where $ b_{1},b_{2},...,b_{k+1} $ is a sequence of arbitrary strings (some of them may be possibly empty);
- sum of the lengths of strings in sequence is maximum possible.
Please help Alyona solve this complicated problem and find at least the sum of the lengths of the strings in a desired sequence.
A substring of a string is a subsequence of consecutive characters of the string.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>In the first line of the input three integers $ n $ , $ m $ , $ k $ ( $ 1<=n,m<=1000 $ , $ 1<=k<=10 $ ) are given — the length of the string $ s $ , the length of the string $ t $ and Alyona's favourite number respectively.
The second line of the input contains string $ s $ , consisting of lowercase English letters.
The third line of the input contains string $ t $ , consisting of lowercase English letters.</div>
<h3>输出格式</h3>
<br />
<div>In the only line print the only non-negative integer — the sum of the lengths of the strings in a desired sequence.
It is guaranteed, that at least one desired sequence exists.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>3 2 2
abc
ab
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>2
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>9 12 4
bbaaababb
abbbabbaaaba
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>7
</code></pre>
<h2>说明</h2>
<div>The following image describes the answer for the second sample case:
![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF682D/2e74041884d67a1d079badb418366bd0a678e7b0.png)</div>
</article>
</div>
</div>
</body>
</html>
