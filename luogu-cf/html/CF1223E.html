<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Paint the Tree - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573403445:1lUG2WT0dF1nNBYwIz7h4Q/fVDh63NdU+wdsleI4Ab0=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22You%20are%20given%20a%20weighted%20tree%20consisting%20of%20%24%20n%20%24%20vertices.%20Recall%20that%20a%20tree%20is%20a%20connected%20graph%20without%20cycles.%20Vertices%20%24%20u_i%20%24%20and%20%24%20v_i%20%24%20are%20connected%20by%20an%20edge%20with%20weight%20%24%20w_i%20%24%20.%5Cn%5CnLet%27s%20define%20the%20%24%20k%20%24%20-coloring%20of%20the%20tree%20as%20an%20assignment%20of%20exactly%20%24%20k%20%24%20colors%20to%20each%20vertex%2C%20so%20that%20each%20color%20is%20used%20no%20more%20than%20two%20times.%20You%20can%20assume%20that%20you%20have%20infinitely%20many%20colors%20available.%20We%20say%20that%20an%20edge%20is%20saturated%20in%20the%20given%20%24%20k%20%24%20-coloring%20if%20its%20endpoints%20share%20at%20least%20one%20color%20%28i.e.%20there%20exists%20a%20color%20that%20is%20assigned%20to%20both%20endpoints%29.%5Cn%5CnLet%27s%20also%20define%20the%20value%20of%20a%20%24%20k%20%24%20-coloring%20as%20the%20sum%20of%20weights%20of%20saturated%20edges.%5Cn%5CnPlease%20calculate%20the%20maximum%20possible%20value%20of%20a%20%24%20k%20%24%20-coloring%20of%20the%20given%20tree.%5Cn%5CnYou%20have%20to%20answer%20%24%20q%20%24%20independent%20queries.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20one%20integer%20%24%20q%20%24%20%28%20%24%201%20%5C%5Cle%20q%20%5C%5Cle%205%20%5C%5Ccdot%2010%5E5%20%24%20%29%20%5Cu2013%20the%20number%20of%20queries.%5Cn%5CnThe%20first%20line%20of%20each%20query%20contains%20two%20integers%20%24%20n%20%24%20and%20%24%20k%20%24%20%28%20%24%201%20%5C%5Cle%20n%2C%20k%20%5C%5Cle%205%20%5C%5Ccdot%2010%5E5%20%24%20%29%20%5Cu2014%20the%20number%20of%20vertices%20in%20the%20tree%20and%20the%20number%20of%20colors%20to%20assign%20to%20each%20vertex%2C%20respectively.%5Cn%5CnEach%20of%20the%20next%20%24%20n%20-%201%20%24%20lines%20describes%20an%20edge%20of%20the%20tree.%20Edge%20%24%20i%20%24%20is%20denoted%20by%20three%20integers%20%24%20u_i%20%24%20%2C%20%24%20v_i%20%24%20and%20%24%20w_i%20%24%20%28%20%24%201%20%5C%5Cle%20u_i%2C%20v_i%20%5C%5Cle%20n%20%24%20%2C%20%24%20u_i%20%5C%5Cne%20v_i%20%24%20%2C%20%24%201%20%5C%5Cle%20w_i%20%5C%5Cle%2010%5E5%20%24%20%29%20%5Cu2014%20the%20labels%20of%20vertices%20it%20connects%20and%20the%20weight%20of%20the%20edge.%20It%20is%20guaranteed%20that%20the%20given%20edges%20form%20a%20tree.%5Cn%5CnIt%20is%20guaranteed%20that%20sum%20of%20all%20%24%20n%20%24%20over%20all%20queries%20does%20not%20exceed%20%24%205%20%5C%5Ccdot%2010%5E5%20%24%20.%22%2C%22outputFormat%22%3A%22For%20each%20query%20print%20one%20integer%20%5Cu2014%20the%20maximum%20value%20of%20a%20%24%20k%20%24%20-coloring%20of%20the%20given%20tree.%22%2C%22samples%22%3A%5B%5B%22%5Cn2%5Cn4%201%5Cn1%202%205%5Cn3%201%202%5Cn3%204%203%5Cn7%202%5Cn1%202%205%5Cn1%203%204%5Cn1%204%202%5Cn2%205%201%5Cn2%206%202%5Cn4%207%203%5Cn%22%2C%22%5Cn8%5Cn14%5Cn%22%5D%5D%2C%22hint%22%3A%22The%20tree%20corresponding%20to%20the%20first%20query%20in%20the%20example%3A%5Cn%5Cn%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF1223E%5C%2F3b8633820433e5bdb8f19f1fbdc32d46ec37182e.png%29%5Cn%5CnOne%20of%20the%20possible%20%24%20k%20%24%20-colorings%20in%20the%20first%20example%3A%20%24%20%281%29%2C%20%281%29%2C%20%282%29%2C%20%282%29%20%24%20%2C%20then%20the%20%24%201%20%24%20-st%20and%20the%20%24%203%20%24%20-rd%20edges%20are%20saturated%20and%20the%20sum%20of%20their%20weights%20is%20%24%208%20%24%20.%5Cn%5CnThe%20tree%20corresponding%20to%20the%20second%20query%20in%20the%20example%3A%5Cn%5Cn%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF1223E%5C%2F3c15fa6c90ac8c8d763f3b9409764a2a806ddf5f.png%29%5Cn%5CnOne%20of%20the%20possible%20%24%20k%20%24%20-colorings%20in%20the%20second%20example%3A%20%24%20%281%2C%202%29%2C%20%281%2C%203%29%2C%20%282%2C%204%29%2C%20%285%2C%206%29%2C%20%287%2C%208%29%2C%20%283%2C%204%29%2C%20%285%2C%206%29%20%24%20%2C%20then%20the%20%24%201%20%24%20-st%2C%20%24%202%20%24%20-nd%2C%20%24%205%20%24%20-th%20and%20%24%206%20%24%20-th%20edges%20are%20saturated%20and%20the%20sum%20of%20their%20weights%20is%20%24%2014%20%24%20.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F1223%5C%2FE%22%2C%22id%22%3A%221223E%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A41%2C%22totalAccepted%22%3A25%2C%22pid%22%3A%22CF1223E%22%2C%22title%22%3A%22Paint%20the%20Tree%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Paint%20the%20Tree%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Paint the Tree</h1>
<h2>题目描述</h2>
<div>You are given a weighted tree consisting of $ n $ vertices. Recall that a tree is a connected graph without cycles. Vertices $ u_i $ and $ v_i $ are connected by an edge with weight $ w_i $ .
Let's define the $ k $ -coloring of the tree as an assignment of exactly $ k $ colors to each vertex, so that each color is used no more than two times. You can assume that you have infinitely many colors available. We say that an edge is saturated in the given $ k $ -coloring if its endpoints share at least one color (i.e. there exists a color that is assigned to both endpoints).
Let's also define the value of a $ k $ -coloring as the sum of weights of saturated edges.
Please calculate the maximum possible value of a $ k $ -coloring of the given tree.
You have to answer $ q $ independent queries.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains one integer $ q $ ( $ 1 \le q \le 5 \cdot 10^5 $ ) – the number of queries.
The first line of each query contains two integers $ n $ and $ k $ ( $ 1 \le n, k \le 5 \cdot 10^5 $ ) — the number of vertices in the tree and the number of colors to assign to each vertex, respectively.
Each of the next $ n - 1 $ lines describes an edge of the tree. Edge $ i $ is denoted by three integers $ u_i $ , $ v_i $ and $ w_i $ ( $ 1 \le u_i, v_i \le n $ , $ u_i \ne v_i $ , $ 1 \le w_i \le 10^5 $ ) — the labels of vertices it connects and the weight of the edge. It is guaranteed that the given edges form a tree.
It is guaranteed that sum of all $ n $ over all queries does not exceed $ 5 \cdot 10^5 $ .</div>
<h3>输出格式</h3>
<br />
<div>For each query print one integer — the maximum value of a $ k $ -coloring of the given tree.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>
2
4 1
1 2 5
3 1 2
3 4 3
7 2
1 2 5
1 3 4
1 4 2
2 5 1
2 6 2
4 7 3
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>
8
14
</code></pre>
<h2>说明</h2>
<div>The tree corresponding to the first query in the example:
![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1223E/3b8633820433e5bdb8f19f1fbdc32d46ec37182e.png)
One of the possible $ k $ -colorings in the first example: $ (1), (1), (2), (2) $ , then the $ 1 $ -st and the $ 3 $ -rd edges are saturated and the sum of their weights is $ 8 $ .
The tree corresponding to the second query in the example:
![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1223E/3c15fa6c90ac8c8d763f3b9409764a2a806ddf5f.png)
One of the possible $ k $ -colorings in the second example: $ (1, 2), (1, 3), (2, 4), (5, 6), (7, 8), (3, 4), (5, 6) $ , then the $ 1 $ -st, $ 2 $ -nd, $ 5 $ -th and $ 6 $ -th edges are saturated and the sum of their weights is $ 14 $ .</div>
</article>
</div>
</div>
</body>
</html>
