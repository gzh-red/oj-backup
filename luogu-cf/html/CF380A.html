<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Sereja and Prefixes - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573393465:5r5aTcFEuC3ImJw4TvVghV71aAHoZMeBWoyH2sSEtuk=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%22%2C%22description%22%3A%22Sereja%20loves%20number%20sequences%20very%20much.%20That%27s%20why%20he%20decided%20to%20make%20himself%20a%20new%20one%20following%20a%20certain%20algorithm.%5Cn%5CnSereja%20takes%20a%20blank%20piece%20of%20paper.%20Then%20he%20starts%20writing%20out%20the%20sequence%20in%20%24%20m%20%24%20stages.%20Each%20time%20he%20either%20adds%20a%20new%20number%20to%20the%20end%20of%20the%20sequence%20or%20takes%20%24%20l%20%24%20first%20elements%20of%20the%20current%20sequence%20and%20adds%20them%20%24%20c%20%24%20times%20to%20the%20end.%20More%20formally%2C%20if%20we%20represent%20the%20current%20sequence%20as%20%24%20a_%7B1%7D%2Ca_%7B2%7D%2C...%2Ca_%7Bn%7D%20%24%20%2C%20then%20after%20we%20apply%20the%20described%20operation%2C%20the%20sequence%20transforms%20into%20%24%20a_%7B1%7D%2Ca_%7B2%7D%2C...%2Ca_%7Bn%7D%5B%2Ca_%7B1%7D%2Ca_%7B2%7D%2C...%2Ca_%7Bl%7D%5D%20%24%20%28the%20block%20in%20the%20square%20brackets%20must%20be%20repeated%20%24%20c%20%24%20times%29.%5Cn%5CnA%20day%20has%20passed%20and%20Sereja%20has%20completed%20the%20sequence.%20He%20wonders%20what%20are%20the%20values%20of%20some%20of%20its%20elements.%20Help%20Sereja.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20integer%20%24%20m%20%24%20%24%20%281%3C%3Dm%3C%3D10%5E%7B5%7D%29%20%24%20%5Cu2014%20the%20number%20of%20stages%20to%20build%20a%20sequence.%5Cn%5CnNext%20%24%20m%20%24%20lines%20contain%20the%20description%20of%20the%20stages%20in%20the%20order%20they%20follow.%20The%20first%20number%20in%20the%20line%20is%20a%20type%20of%20stage%20%281%20or%202%29.%20Type%201%20means%20adding%20one%20number%20to%20the%20end%20of%20the%20sequence%2C%20in%20this%20case%20the%20line%20contains%20integer%20%24%20x_%7Bi%7D%20%24%20%24%20%281%3C%3Dx_%7Bi%7D%3C%3D10%5E%7B5%7D%29%20%24%20%5Cu2014%20the%20number%20to%20add.%20Type%202%20means%20copying%20a%20prefix%20of%20length%20%24%20l_%7Bi%7D%20%24%20to%20the%20end%20%24%20c_%7Bi%7D%20%24%20times%2C%20in%20this%20case%20the%20line%20further%20contains%20two%20integers%20%24%20l_%7Bi%7D%2Cc_%7Bi%7D%20%24%20%24%20%281%3C%3Dl_%7Bi%7D%3C%3D10%5E%7B5%7D%2C1%3C%3Dc_%7Bi%7D%3C%3D10%5E%7B4%7D%29%20%24%20%2C%20%24%20l_%7Bi%7D%20%24%20is%20the%20length%20of%20the%20prefix%2C%20%24%20c_%7Bi%7D%20%24%20is%20the%20number%20of%20copyings.%20It%20is%20guaranteed%20that%20the%20length%20of%20prefix%20%24%20l_%7Bi%7D%20%24%20is%20never%20larger%20than%20the%20current%20length%20of%20the%20sequence.%5Cn%5CnThe%20next%20line%20contains%20integer%20%24%20n%20%24%20%24%20%281%3C%3Dn%3C%3D10%5E%7B5%7D%29%20%24%20%5Cu2014%20the%20number%20of%20elements%20Sereja%20is%20interested%20in.%20The%20next%20line%20contains%20the%20numbers%20of%20elements%20of%20the%20final%20sequence%20Sereja%20is%20interested%20in.%20The%20numbers%20are%20given%20in%20the%20strictly%20increasing%20order.%20It%20is%20guaranteed%20that%20all%20numbers%20are%20strictly%20larger%20than%20zero%20and%20do%20not%20exceed%20the%20length%20of%20the%20resulting%20sequence.%20Consider%20the%20elements%20of%20the%20final%20sequence%20numbered%20starting%20from%20%24%201%20%24%20from%20the%20beginning%20to%20the%20end%20of%20the%20sequence.%5Cn%5CnPlease%2C%20do%20not%20use%20the%20%25lld%20specifier%20to%20read%20or%20write%2064-bit%20integers%20in%20%5Cu0421%2B%2B.%20It%20is%20preferred%20to%20use%20the%20cin%2C%20cout%20streams%20or%20the%20%25I64d%20specifier.%22%2C%22outputFormat%22%3A%22Print%20the%20elements%20that%20Sereja%20is%20interested%20in%2C%20in%20the%20order%20in%20which%20their%20numbers%20occur%20in%20the%20input.%22%2C%22samples%22%3A%5B%5B%226%5Cn1%201%5Cn1%202%5Cn2%202%201%5Cn1%203%5Cn2%205%202%5Cn1%204%5Cn16%5Cn1%202%203%204%205%206%207%208%209%2010%2011%2012%2013%2014%2015%2016%5Cn%22%2C%221%202%201%202%203%201%202%201%202%203%201%202%201%202%203%204%5Cn%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F380%5C%2FA%22%2C%22id%22%3A%22380A%22%7D%2C%22translation%22%3A%22%5Cu9898%5Cu9762%5Cuff1a%5Cn%5Cn%5Cu521d%5Cu59cb%5Cu6709%5Cu4e00%5Cu4e2a%5Cu7a7a%5Cu5e8f%5Cu5217%2C%5Cu6709m%5Cu6b21%5Cu64cd%5Cu4f5c%2C%5Cu6bcf%5Cu6b21%5Cu7ed9%5Cu51fa%5Cu4e00%5Cu79cd%5Cu64cd%5Cu4f5c%3A%5Cn1.%20%5Cu5728%5Cu5e8f%5Cu5217%5Cu672b%5Cu5c3e%5Cu6dfb%5Cu52a0%5Cu4e00%5Cu4e2a%5Cu6570x.%5Cn2.%20%5Cu5c06%5Cu5e8f%5Cu5217%5Cu957f%5Cu5ea6%5Cu4e3al%5Cu7684%5Cu524d%5Cu7f00%5Cu590d%5Cu5236c%5Cu6b21%5Cu63d2%5Cu5165%5Cu5230%5Cu5e8f%5Cu5217%5Cu672b%5Cu5c3e.%5Cn%5Cn%5Cu6709n%5Cu7ec4%5Cu8be2%5Cu95ee%5Cuff0c%5Cu6bcf%5Cu7ec4%5Cu8be2%5Cu95ee%5Cu4e3a%5Cu64cd%5Cu4f5c%5Cu5b8c%5Cu7684%5Cu5e8f%5Cu5217%5Cu4e0a%5Cu7b2ci%5Cu53f7%5Cu70b9%5Cu7684%5Cu503c.%5Cn%5Cu8f93%5Cu5165%5Cu6570%5Cu636e%5Cuff1a%5Cn%5Cn%5Cu7b2c%5Cu4e00%5Cu884c%5Cu4e00%5Cu4e2am%5Cn%5Cu63a5%5Cu4e0b%5Cu6765m%5Cu884c%5Cu64cd%5Cu4f5c%2C%5Cu5f62%5Cu5982%3C1%2Cx%3E%20or%20%3C2%2Cl%2Cc%3E%5Cn%5Cu7b2cm%2B2%5Cu884c%5Cu4e00%5Cu4e2an%5Cn%5Cu63a5%5Cu4e0b%5Cu6765n%5Cu4e2a%5Cu6570%2C%5Cu5206%5Cu522b%5Cu8be2%5Cu95ee%5Cu7b2ci%5Cu53f7%5Cu4f4d%5Cu4e0a%5Cu7684%5Cu503c.%5Cn%5Cu8f93%5Cu51fa%5Cu6570%5Cu636e%5Cuff1a%5Cn%5Cn%5Cu4ec5%5Cu4e00%5Cu884c%2Cn%5Cu4e2a%5Cu8be2%5Cu95ee%5Cu7684%5Cu8f93%5Cu51fa.%5Cn%5Cu6570%5Cu636e%5Cu8303%5Cu56f4%5Cuff1a%5Cn%5Cnm%3A%5B1%2C1e5%5D%5Cnx%3A%5B1%2C1e5%5D%5Cnl%3A%5B1%2C1e5%5D%5Cnc%3A%5B1%2C1e4%5D%5Cnn%3A%5B1%2C1e5%5D%5Cni%3Csizeof%28long%20long%29%5Cn%5Cu6ce8%5Cu610f%5Cuff1a%5Cn%5Cn%5Cu8bb0%5Cu5f97%5Cu5f00long%20long%21%5Cn%5Cu7ffb%5Cu8bd1%5Cu8d21%5Cu732e%5Cu8005%5Cuff1a%5Cu5c18%5Cu67d3%5Cu68a6%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A4%2C%22totalAccepted%22%3A2%2C%22pid%22%3A%22CF380A%22%2C%22title%22%3A%22Sereja%20and%20Prefixes%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A33120%2C%22title%22%3A%22%5B%5Cu7ffb%5Cu8bd1%5DCF380A%22%2C%22forum%22%3A%7B%22id%22%3A11115%2C%22name%22%3A%22CF380A%20Sereja%20and%20Prefixes%22%2C%22slug%22%3A%22CF380A%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Sereja%20and%20Prefixes%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Sereja and Prefixes</h1>
<h2>题意翻译</h2>
<div>题面：
初始有一个空序列,有m次操作,每次给出一种操作:
1. 在序列末尾添加一个数x.
2. 将序列长度为l的前缀复制c次插入到序列末尾.
有n组询问，每组询问为操作完的序列上第i号点的值.
输入数据：
第一行一个m
接下来m行操作,形如<1,x> or <2,l,c>
第m+2行一个n
接下来n个数,分别询问第i号位上的值.
输出数据：
仅一行,n个询问的输出.
数据范围：
m:[1,1e5]
x:[1,1e5]
l:[1,1e5]
c:[1,1e4]
n:[1,1e5]
i<sizeof(long long) 注意： 记得开long long! 翻译贡献者：尘染梦</div>
<h2>题目描述</h2>
<div>Sereja loves number sequences very much. That's why he decided to make himself a new one following a certain algorithm.
Sereja takes a blank piece of paper. Then he starts writing out the sequence in $ m $ stages. Each time he either adds a new number to the end of the sequence or takes $ l $ first elements of the current sequence and adds them $ c $ times to the end. More formally, if we represent the current sequence as $ a_{1},a_{2},...,a_{n} $ , then after we apply the described operation, the sequence transforms into $ a_{1},a_{2},...,a_{n}[,a_{1},a_{2},...,a_{l}] $ (the block in the square brackets must be repeated $ c $ times).
A day has passed and Sereja has completed the sequence. He wonders what are the values of some of its elements. Help Sereja.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains integer $ m $ $ (1<=m<=10^{5}) $ — the number of stages to build a sequence.
Next $ m $ lines contain the description of the stages in the order they follow. The first number in the line is a type of stage (1 or 2). Type 1 means adding one number to the end of the sequence, in this case the line contains integer $ x_{i} $ $ (1<=x_{i}<=10^{5}) $ — the number to add. Type 2 means copying a prefix of length $ l_{i} $ to the end $ c_{i} $ times, in this case the line further contains two integers $ l_{i},c_{i} $ $ (1<=l_{i}<=10^{5},1<=c_{i}<=10^{4}) $ , $ l_{i} $ is the length of the prefix, $ c_{i} $ is the number of copyings. It is guaranteed that the length of prefix $ l_{i} $ is never larger than the current length of the sequence.
The next line contains integer $ n $ $ (1<=n<=10^{5}) $ — the number of elements Sereja is interested in. The next line contains the numbers of elements of the final sequence Sereja is interested in. The numbers are given in the strictly increasing order. It is guaranteed that all numbers are strictly larger than zero and do not exceed the length of the resulting sequence. Consider the elements of the final sequence numbered starting from $ 1 $ from the beginning to the end of the sequence.
Please, do not use the %lld specifier to read or write 64-bit integers in С++. It is preferred to use the cin, cout streams or the %I64d specifier.</div>
<h3>输出格式</h3>
<br />
<div>Print the elements that Sereja is interested in, in the order in which their numbers occur in the input.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>6
1 1
1 2
2 2 1
1 3
2 5 2
1 4
16
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>1 2 1 2 3 1 2 1 2 3 1 2 1 2 3 4
</code></pre>
</article>
</div>
</div>
</body>
</html>
