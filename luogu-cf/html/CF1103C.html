<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Johnny Solving - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573401714:9PbgFeVavRGLapTlNIVTfeU6zSuwvEfaX5t6pjYQJzg=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Today%20is%20tuesday%2C%20that%20means%20there%20is%20a%20dispute%20in%20JOHNNY%20SOLVING%20team%20again%3A%20they%20try%20to%20understand%20who%20is%20Johnny%20and%20who%20is%20Solving.%20That%27s%20why%20guys%20asked%20Umnik%20to%20help%20them.%20Umnik%20gave%20guys%20a%20connected%20graph%20with%20%24%20n%20%24%20vertices%20without%20loops%20and%20multiedges%2C%20such%20that%20a%20degree%20of%20any%20vertex%20is%20at%20least%20%24%203%20%24%20%2C%20and%20also%20he%20gave%20a%20number%20%24%201%20%5C%5Cleq%20k%20%5C%5Cleq%20n%20%24%20.%20Because%20Johnny%20is%20not%20too%20smart%2C%20he%20promised%20to%20find%20a%20simple%20path%20with%20length%20at%20least%20%24%20%5C%5Cfrac%7Bn%7D%7Bk%7D%20%24%20in%20the%20graph.%20In%20reply%2C%20Solving%20promised%20to%20find%20%24%20k%20%24%20simple%20by%20vertices%20cycles%20with%20representatives%2C%20such%20that%3A%5Cn%5Cn-%20Length%20of%20each%20cycle%20is%20at%20least%20%24%203%20%24%20.%5Cn-%20Length%20of%20each%20cycle%20is%20not%20divisible%20by%20%24%203%20%24%20.%5Cn-%20In%20each%20cycle%20must%20be%20a%20representative%20-%20vertex%2C%20which%20belongs%20only%20to%20this%20cycle%20among%20all%20printed%20cycles.%5Cn%5CnYou%20need%20to%20help%20guys%20resolve%20the%20dispute%2C%20for%20that%20you%20need%20to%20find%20a%20solution%20for%20Johnny%3A%20a%20simple%20path%20with%20length%20at%20least%20%24%20%5C%5Cfrac%7Bn%7D%7Bk%7D%20%24%20%28%20%24%20n%20%24%20is%20not%20necessarily%20divided%20by%20%24%20k%20%24%20%29%2C%20or%20solution%20for%20Solving%3A%20%24%20k%20%24%20cycles%20that%20satisfy%20all%20the%20conditions%20above.%20If%20there%20is%20no%20any%20solution%20-%20print%20%24%20-1%20%24%20.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20three%20integers%20%24%20n%20%24%20%2C%20%24%20m%20%24%20and%20%24%20k%20%24%20%28%20%24%201%20%5C%5Cleq%20k%20%5C%5Cleq%20n%20%5C%5Cleq%202.5%20%5C%5Ccdot%2010%5E5%2C%201%20%5C%5Cleq%20m%20%5C%5Cleq%205%20%5C%5Ccdot%2010%5E5%20%24%20%29%5Cn%5CnNext%20%24%20m%20%24%20lines%20describe%20edges%20of%20the%20graph%20in%20format%20%24%20v%20%24%20%2C%20%24%20u%20%24%20%28%20%24%201%20%5C%5Cleq%20v%2C%20u%20%5C%5Cleq%20n%20%24%20%29.%20It%27s%20guaranteed%20that%20%24%20v%20%5C%5Cneq%20u%20%24%20and%20all%20%24%20m%20%24%20pairs%20are%20distinct.%5Cn%5CnIt%27s%20guaranteed%20that%20a%20degree%20of%20each%20vertex%20is%20at%20least%20%24%203%20%24%20.%22%2C%22outputFormat%22%3A%22Print%20PATH%20in%20the%20first%20line%2C%20if%20you%20solve%20problem%20for%20Johnny.%20In%20the%20second%20line%20print%20the%20number%20of%20vertices%20in%20the%20path%20%24%20c%20%24%20%28%20%24%20c%20%5C%5Cgeq%20%5C%5Cfrac%7Bn%7D%7Bk%7D%20%24%20%29.%20And%20in%20the%20third%20line%20print%20vertices%20describing%20the%20path%20in%20route%20order.%5Cn%5CnPrint%20CYCLES%20in%20the%20first%20line%2C%20if%20you%20solve%20problem%20for%20Solving.%20In%20the%20following%20lines%20describe%20exactly%20%24%20k%20%24%20cycles%20in%20the%20following%20format%3A%20in%20the%20first%20line%20print%20the%20size%20of%20the%20cycle%20%24%20c%20%24%20%28%20%24%20c%20%5C%5Cgeq%203%20%24%20%29.%20In%20the%20second%20line%20print%20the%20cycle%20in%20route%20order.%20Also%2C%20the%20first%20vertex%20in%20the%20cycle%20must%20be%20a%20representative.%5Cn%5CnPrint%20%24%20-1%20%24%20if%20there%20is%20no%20any%20solution.%20The%20total%20amount%20of%20printed%20numbers%20in%20the%20output%20must%20be%20at%20most%20%24%2010%5E6%20%24%20.%20It%27s%20guaranteed%2C%20that%20if%20exists%20any%20solution%20then%20there%20is%20a%20correct%20output%20satisfies%20this%20restriction.%22%2C%22samples%22%3A%5B%5B%22%5Cn4%206%202%5Cn1%202%5Cn1%203%5Cn1%204%5Cn2%203%5Cn2%204%5Cn3%204%5Cn%22%2C%22%5CnPATH%5Cn4%5Cn1%202%203%204%20%22%5D%2C%5B%22%5Cn10%2018%202%5Cn1%202%5Cn1%203%5Cn1%204%5Cn1%205%5Cn1%206%5Cn1%207%5Cn1%208%5Cn1%209%5Cn1%2010%5Cn2%203%5Cn3%204%5Cn2%204%5Cn5%206%5Cn6%207%5Cn5%207%5Cn8%209%5Cn9%2010%5Cn8%2010%5Cn%22%2C%22%5CnCYCLES%5Cn4%5Cn4%201%202%203%20%5Cn4%5Cn7%201%205%206%20%5Cn%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F1103%5C%2FC%22%2C%22id%22%3A%221103C%22%7D%2C%22translation%22%3A%22%5Cu7ed9%5Cu51fa%5Cu4e00%5Cu5f20%5Cu65e0%5Cu91cd%5Cu8fb9%5Cu7684%5Cu65e0%5Cu5411%5Cu56fe%5Cuff08%5Cu4fdd%5Cu8bc1%5Cu6bcf%5Cu4e2a%5Cu70b9%5Cu5ea6%5Cu6570%5Cu5927%5Cu4e8e%5Cu7b49%5Cu4e8e3%5Cuff09%5Cu548c%5Cu4e00%5Cu4e2a%5Cu9650%5Cu5236%24k%24%5Cuff0c%5Cu9700%5Cu8981%5Cu4f60%5Cu6784%5Cu9020%5Cu4ee5%5Cu4e0b%5Cu4e24%5Cu79cd%5Cu60c5%5Cu51b5%5Cu4e2d%5Cu7684%5Cu4e00%5Cu79cd%5Cuff1a%5Cr%5Cn%5Cr%5Cn1%5Cu3001%5Cu627e%5Cu51fa%5Cu4e00%5Cu6761%5Cu8def%5Cu5f84%5Cu957f%5Cu5ea6%5Cu4e3a%24n%5C%2Fk%24%5Cu3002%5Cr%5Cn%5Cr%5Cn2%5Cu3001%5Cu627e%5Cu51fa%24k%24%5Cu4e2a%5Cu73af%5Cuff0c%5Cu4f7f%5Cu5f97%5Cu6bcf%5Cu4e2a%5Cu73af%5Cu7684%5Cu957f%5Cu5ea6%5Cu5927%5Cu4e8e3%5Cu800c%5Cu4e14%5Cu4e0d%5Cu662f3%5Cu7684%5Cu500d%5Cu6570%5Cuff0c%5Cu5e76%5Cu4e14%5Cu8981%5Cu6c42%5Cu4fdd%5Cu8bc1%5Cu6bcf%5Cu4e2a%5Cu73af%5Cu4e2d%5Cu81f3%5Cu5c11%5Cu6709%5Cu4e00%5Cu4e2a%5Cu70b9%5Cu5728%5Cu8fd9%24k%24%5Cu4e2a%5Cu73af%5Cu91cc%5Cu53ea%5Cu51fa%5Cu73b0%5Cu4e00%5Cu6b21%5Cu3002%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A72%2C%22totalAccepted%22%3A26%2C%22pid%22%3A%22CF1103C%22%2C%22title%22%3A%22Johnny%20Solving%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A160765%2C%22title%22%3A%22%5Cu7ffb%5Cu8bd1%5Cu6709%5Cu8bef%22%2C%22forum%22%3A%7B%22id%22%3A33884%2C%22name%22%3A%22CF1103C%20Johnny%20Solving%22%2C%22slug%22%3A%22CF1103C%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22CF1103B%22%2C%22title%22%3A%22Game%20with%20modulo%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1109B%22%2C%22title%22%3A%22Sasha%20and%20One%20More%20Name%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1109A%22%2C%22title%22%3A%22Sasha%20and%20a%20Bit%20of%20Relax%22%2C%22difficulty%22%3A3%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1214D%22%2C%22title%22%3A%22Treasure%20Island%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1209D%22%2C%22title%22%3A%22Cow%20and%20Snacks%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Johnny%20Solving%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Johnny Solving</h1>
<h2>题意翻译</h2>
<div>给出一张无重边的无向图（保证每个点度数大于等于3）和一个限制$k$，需要你构造以下两种情况中的一种：
1、找出一条路径长度为$n/k$。
2、找出$k$个环，使得每个环的长度大于3而且不是3的倍数，并且要求保证每个环中至少有一个点在这$k$个环里只出现一次。</div>
<h2>题目描述</h2>
<div>Today is tuesday, that means there is a dispute in JOHNNY SOLVING team again: they try to understand who is Johnny and who is Solving. That's why guys asked Umnik to help them. Umnik gave guys a connected graph with $ n $ vertices without loops and multiedges, such that a degree of any vertex is at least $ 3 $ , and also he gave a number $ 1 \leq k \leq n $ . Because Johnny is not too smart, he promised to find a simple path with length at least $ \frac{n}{k} $ in the graph. In reply, Solving promised to find $ k $ simple by vertices cycles with representatives, such that:
- Length of each cycle is at least $ 3 $ .
- Length of each cycle is not divisible by $ 3 $ .
- In each cycle must be a representative - vertex, which belongs only to this cycle among all printed cycles.
You need to help guys resolve the dispute, for that you need to find a solution for Johnny: a simple path with length at least $ \frac{n}{k} $ ( $ n $ is not necessarily divided by $ k $ ), or solution for Solving: $ k $ cycles that satisfy all the conditions above. If there is no any solution - print $ -1 $ .</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains three integers $ n $ , $ m $ and $ k $ ( $ 1 \leq k \leq n \leq 2.5 \cdot 10^5, 1 \leq m \leq 5 \cdot 10^5 $ )
Next $ m $ lines describe edges of the graph in format $ v $ , $ u $ ( $ 1 \leq v, u \leq n $ ). It's guaranteed that $ v \neq u $ and all $ m $ pairs are distinct.
It's guaranteed that a degree of each vertex is at least $ 3 $ .</div>
<h3>输出格式</h3>
<br />
<div>Print PATH in the first line, if you solve problem for Johnny. In the second line print the number of vertices in the path $ c $ ( $ c \geq \frac{n}{k} $ ). And in the third line print vertices describing the path in route order.
Print CYCLES in the first line, if you solve problem for Solving. In the following lines describe exactly $ k $ cycles in the following format: in the first line print the size of the cycle $ c $ ( $ c \geq 3 $ ). In the second line print the cycle in route order. Also, the first vertex in the cycle must be a representative.
Print $ -1 $ if there is no any solution. The total amount of printed numbers in the output must be at most $ 10^6 $ . It's guaranteed, that if exists any solution then there is a correct output satisfies this restriction.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>
4 6 2
1 2
1 3
1 4
2 3
2 4
3 4
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>
PATH
4
1 2 3 4 </code></pre>
<h3>输入样例 #2</h3>
<pre><code>
10 18 2
1 2
1 3
1 4
1 5
1 6
1 7
1 8
1 9
1 10
2 3
3 4
2 4
5 6
6 7
5 7
8 9
9 10
8 10
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>
CYCLES
4
4 1 2 3 
4
7 1 5 6 
</code></pre>
</article>
</div>
</div>
</body>
</html>
