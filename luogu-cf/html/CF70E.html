<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Information Reform - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573390532:5RgC7I7/16arIYOLvFw2zdVaaynMMU/4tO44oIeeuJ8=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Thought%20it%20is%20already%20the%20XXI%20century%2C%20the%20Mass%20Media%20isn%27t%20very%20popular%20in%20Walrusland.%20The%20cities%20get%20news%20from%20messengers%20who%20can%20only%20travel%20along%20roads.%20The%20network%20of%20roads%20in%20Walrusland%20is%20built%20so%20that%20it%20is%20possible%20to%20get%20to%20any%20city%20from%20any%20other%20one%20in%20exactly%20one%20way%2C%20and%20the%20roads%27%20lengths%20are%20equal.%5Cn%5CnThe%20North%20Pole%20governor%20decided%20to%20carry%20out%20an%20information%20reform.%20Several%20cities%20were%20decided%20to%20be%20chosen%20and%20made%20regional%20centers.%20Maintaining%20a%20region%20center%20takes%20%24%20k%20%24%20fishlars%20%28which%20is%20a%20local%20currency%29%20per%20year.%20It%20is%20assumed%20that%20a%20regional%20center%20always%20has%20information%20on%20the%20latest%20news.%5Cn%5CnFor%20every%20city%20which%20is%20not%20a%20regional%20center%2C%20it%20was%20decided%20to%20appoint%20a%20regional%20center%20which%20will%20be%20responsible%20for%20keeping%20this%20city%20informed.%20In%20that%20case%20the%20maintenance%20costs%20will%20be%20equal%20to%20%24%20d_%7Blen%7D%20%24%20fishlars%20per%20year%2C%20where%20%24%20len%20%24%20is%20the%20distance%20from%20a%20city%20to%20the%20corresponding%20regional%20center%2C%20measured%20in%20the%20number%20of%20roads%20along%20which%20one%20needs%20to%20go.%5Cn%5CnYour%20task%20is%20to%20minimize%20the%20costs%20to%20carry%20out%20the%20reform.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20two%20given%20numbers%20%24%20n%20%24%20and%20%24%20k%20%24%20%28%20%24%201%3C%3Dn%3C%3D180%2C1%3C%3Dk%3C%3D10%5E%7B5%7D%20%24%20%29.%5Cn%5CnThe%20second%20line%20contains%20%24%20n-1%20%24%20integers%20%24%20d_%7Bi%7D%20%24%20%2C%20numbered%20starting%20with%201%20%28%20%24%20d_%7Bi%7D%3C%3Dd_%7Bi%2B1%7D%2C0%3C%3Dd_%7Bi%7D%3C%3D10%5E%7B5%7D%20%24%20%29.%5Cn%5CnNext%20%24%20n-1%20%24%20lines%20contain%20the%20pairs%20of%20cities%20connected%20by%20a%20road.%22%2C%22outputFormat%22%3A%22On%20the%20first%20line%20print%20the%20minimum%20number%20of%20fishlars%20needed%20for%20a%20year%27s%20maintenance.%20On%20the%20second%20line%20print%20%24%20n%20%24%20numbers%2C%20where%20the%20%24%20i%20%24%20-th%20number%20will%20represent%20the%20number%20of%20the%20regional%20center%2C%20appointed%20to%20the%20%24%20i%20%24%20-th%20city.%20If%20the%20%24%20i%20%24%20-th%20city%20is%20a%20regional%20center%20itself%2C%20then%20you%20should%20print%20number%20%24%20i%20%24%20.%5Cn%5CnIf%20there%20are%20several%20solutions%20to%20that%20problem%2C%20print%20any%20of%20them.%22%2C%22samples%22%3A%5B%5B%228%2010%5Cn2%205%209%2011%2015%2019%2020%5Cn1%204%5Cn1%203%5Cn1%207%5Cn4%206%5Cn2%208%5Cn2%203%5Cn3%205%5Cn%22%2C%2238%5Cn3%203%203%204%203%204%203%203%20%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F70%5C%2FE%22%2C%22id%22%3A%2270E%22%7D%2C%22translation%22%3A%22%5Cu9898%5Cu76ee%5Cu63cf%5Cu8ff0%5Cuff1a%20%20%5Cr%5Cn%5Cu5c3d%5Cu7ba1%5Cu73b0%5Cu5728%5Cu5df2%5Cu7ecf%5Cu662f21%5Cu4e16%5Cu7eaa%5Cu4e86%5Cuff0c%5Cu4f46%5Cu662f%5Cu5927%5Cu4f17%5Cu4f20%5Cu64ad%5Cu5a92%5Cu4ecb%5Cu5728%24Walrusland%24%5Cu4f9d%5Cu7136%5Cu6ca1%5Cu6709%5Cu666e%5Cu53ca%5Cu5f00%5Cu6765%5Cu3002%5Cu8fd9%5Cu91cc%5Cu7684%5Cu57ce%5Cu5e02%5Cu901a%5Cu8fc7%5Cu80fd%5Cu591f%5Cu5728%5Cu57ce%5Cu5e02%5Cu95f4%5Cu7684%5Cu9053%5Cu8def%5Cu6765%5Cu5f80%5Cu7684%5Cu4fe1%5Cu4f7f%5Cu6765%5Cu4e92%5Cu76f8%5Cu4f20%5Cu9012%5Cu6d88%5Cu606f%5Cu3002%5Cu5728%24Walrusland%24%5Cuff0c%5Cu57ce%5Cu5e02%5Cu95f4%5Cu7684%5Cu9053%5Cu8def%5Cu4fdd%5Cu8bc1%5Cu4fe1%5Cu4f7f%5Cu53ef%5Cu4ee5%5Cu4ece%5Cu4e00%5Cu5ea7%5Cu57ce%5Cu5e02%5Cu5230%5Cu4efb%5Cu610f%5Cu53e6%5Cu4e00%5Cu5ea7%5Cu57ce%5Cu5e02%5Cuff0c%5Cu800c%5Cu4e14%5Cu8fd9%5Cu4e9b%5Cu9053%5Cu8def%5Cu662f%5Cu7b49%5Cu957f%5Cu7684%5Cu3002%20%20%5Cr%5Cn%5Cu5317%5Cu6781%5Cu653f%5Cu5e9c%5Cu51b3%5Cu5b9a%5Cu5b9e%5Cu65bd%5Cu4e00%5Cu9879%5Cu4fe1%5Cu606f%5Cu6539%5Cu9769%5Cu3002%5Cu51e0%5Cu5ea7%5Cu57ce%5Cu5e02%5Cu88ab%5Cu9009%5Cu4e2d%5Cu6210%5Cu4e3a%5Cu533a%5Cu57df%5Cu4fe1%5Cu606f%5Cu4e2d%5Cu5fc3%5Cu3002%5Cu7ef4%5Cu62a4%5Cu4e00%5Cu5ea7%5Cu533a%5Cu57df%5Cu4fe1%5Cu606f%5Cu4e2d%5Cu5fc3%5Cu6bcf%5Cu5e74%5Cu9700%5Cu8981%5Cu82b1%5Cu8d39%24k%24%5Cu4e2a%24fishlar%24%5Cuff08%5Cu8fd9%5Cu662f%5Cu5f53%5Cu5730%5Cu7684%5Cu8d27%5Cu5e01%5Cuff09%5Cu3002%5Cu5047%5Cu8bbe%5Cu6bcf%5Cu5ea7%5Cu533a%5Cu57df%5Cu4fe1%5Cu606f%5Cu4e2d%5Cu5fc3%5Cu603b%5Cu662f%5Cu80fd%5Cu5373%5Cu65f6%5Cu83b7%5Cu5f97%5Cu6700%5Cu65b0%5Cu7684%5Cu6d88%5Cu606f%5Cu3002%20%20%5Cr%5Cn%5Cu6bcf%5Cu4e00%5Cu5ea7%5Cu4e0d%5Cu662f%5Cu533a%5Cu57df%5Cu4fe1%5Cu606f%5Cu4e2d%5Cu5fc3%5Cu7684%5Cu57ce%5Cu5e02%5Cuff0c%5Cu90fd%5Cu4f1a%5Cu88ab%5Cu5b89%5Cu6392%5Cu901a%5Cu8fc7%5Cu4e00%5Cu5ea7%5Cu533a%5Cu57df%5Cu4fe1%5Cu606f%5Cu4e2d%5Cu5fc3%5Cu6765%5Cu4fdd%5Cu6301%5Cu4fe1%5Cu606f%5Cu901a%5Cu8fbe%5Cu3002%5Cu8fd9%5Cu6837%5Cuff0c%5Cu6bcf%5Cu5e74%5Cu7ef4%5Cu62a4%5Cu8d39%5Cu7528%5Cu5c06%5Cu4f1a%5Cu7b49%5Cu4e8e%24d_%7Blen%7D%20%5C%5C%20%24%5Cu4e2a%24fishlar%24%5Cuff0c%5Cu5176%5Cu4e2d%24len%24%5Cu8868%5Cu793a%5Cu8fd9%5Cu5ea7%5Cu57ce%5Cu5e02%5Cu5230%5Cu5b83%5Cu7684%5Cu533a%5Cu57df%5Cu4fe1%5Cu606f%5Cu4e2d%5Cu5fc3%5Cu7684%5Cu8ddd%5Cu79bb%5Cuff0c%5Cu5373%5Cu4e00%5Cu4e2a%5Cu4eba%5Cu4ece%5Cu8fd9%5Cu5ea7%5Cu57ce%5Cu5e02%5Cu5230%5Cu5b83%5Cu7684%5Cu533a%5Cu57df%5Cu4fe1%5Cu606f%5Cu4e2d%5Cu5fc3%5Cu9700%5Cu8981%5Cu8d70%5Cu8fc7%5Cu7684%5Cu9053%5Cu8def%5Cu6761%5Cu6570%5Cu3002%20%20%5Cr%5Cn%5Cu4f60%5Cu7684%5Cu4efb%5Cu52a1%5Cu662f%5Cu6c42%5Cu51fa%5Cu5b9e%5Cu884c%5Cu8fd9%5Cu9879%5Cu6539%5Cu9769%5Cu7684%5Cu6700%5Cu5c0f%5Cu5f00%5Cu9500%5Cu3002%5Cr%5Cn%20%20%5Cr%5Cn%5Cu8f93%5Cu5165%5Cu683c%5Cu5f0f%5Cuff1a%20%20%5Cr%5Cn%5Cu7b2c%5Cu4e00%5Cu884c%5Cu5305%5Cu542b%5Cu4e24%5Cu4e2a%5Cu7ed9%5Cu5b9a%5Cu7684%5Cu6574%5Cu6570%24n%24%5Cu548c%24k%24%5Cuff08%241%3C%3Dn%3C%3D180%24%5Cuff0c%241%3C%3Dk%3C%3D10%5E%7B5%7D%24%5Cuff09%5Cuff1b%20%20%5Cr%5Cn%5Cu7b2c%5Cu4e8c%5Cu884c%5Cu5305%5Cu542b%24n-1%24%5Cu4e2a%5Cu6574%5Cu6570%24d_i%24%5Cuff0c%5Cu4e0b%5Cu6807%5Cu4ece%241%24%5Cu5f00%5Cu59cb%5Cu3002%5Cuff08%24d_%7Bi%7D%3C%3Dd_%7Bi%2B1%7D%2C0%3C%3Dd_%7Bi%7D%3C%3D10%5E%7B5%7D%24%5Cuff09%20%20%5Cr%5Cn%5Cu63a5%5Cu4e0b%5Cu6765%5Cu7684%24n-1%24%5Cu884c%5Cu5305%5Cu542b%5Cu88ab%5Cu4e00%5Cu6761%5Cu9053%5Cu8def%5Cu8fde%5Cu63a5%5Cu7684%5Cu57ce%5Cu5e02%5Cu5bf9%5Cu3002%20%20%5Cr%5Cn%20%20%5Cr%5Cn%5Cu8f93%5Cu51fa%5Cu683c%5Cu5f0f%5Cuff1a%20%20%5Cr%5Cn%5Cu7b2c%5Cu4e00%5Cu884c%5Cuff0c%5Cu8f93%5Cu51fa%5Cu6bcf%5Cu5e74%5Cu7ef4%5Cu62a4%5Cu4fe1%5Cu606f%5Cu8054%5Cu7cfb%5Cu7684%5Cu6700%5Cu5c0f%5Cu82b1%5Cu9500%5Cu3002%5Cuff08%5Cu5355%5Cu4f4d%5Cuff1a%24fishlar%24%5Cuff09%5Cuff1b%5Cr%5Cn%5Cu7b2c%5Cu4e8c%5Cu884c%5Cuff0c%5Cu8f93%5Cu51fa%24n%24%5Cu4e2a%5Cu6574%5Cu6570%5Cuff0c%5Cu7b2c%24i%24%5Cu4e2a%5Cu6574%5Cu6570%5Cu4ee3%5Cu8868%5Cu7b2c%24i%24%5Cu5ea7%5Cu57ce%5Cu5e02%5Cu6240%5Cu7531%5Cu7f16%5Cu53f7%5Cu4e3a%24a_i%24%5Cu7684%5Cu533a%5Cu57df%5Cu4fe1%5Cu606f%5Cu4e2d%5Cu5fc3%5Cu7684%5Cu8d1f%5Cu8d23%5Cuff1b%5Cu5982%5Cu679c%5Cu7b2c%24i%24%5Cu5ea7%5Cu57ce%5Cu5e02%5Cu662f%5Cu4e00%5Cu5ea7%5Cu533a%5Cu57df%5Cu4fe1%5Cu606f%5Cu4e2d%5Cu5fc3%5Cuff0c%5Cu4f60%5Cu53ea%5Cu9700%5Cu8f93%5Cu51fa%5Cu6570%5Cu5b57%24i%24%5Cu3002%20%20%5Cr%5Cn%5Cu5982%5Cu679c%5Cu6b64%5Cu9898%5Cu6709%5Cu591a%5Cu89e3%5Cuff0c%5Cu53ea%5Cu9700%5Cu8f93%5Cu51fa%5Cu4efb%5Cu610f%5Cu4e00%5Cu7ec4%5Cu3002%20%20%5Cr%5Cn%20%20%20%20%20%5Cr%5Cn%5Cu7ffb%5Cu8bd1%20By%20%40%5Cu82e5%5Cu5982%5Cu521d%5Cu89c1%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A30%2C%22totalAccepted%22%3A23%2C%22pid%22%3A%22CF70E%22%2C%22title%22%3A%22Information%20Reform%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A135157%2C%22title%22%3A%22%5Cu6b64%5Cu9898%5Cu6837%5Cu4f8b%5Cu6709%5Cu8bef%5Cuff0c%5Cu671b%5Cu4fee%5Cu6539%22%2C%22forum%22%3A%7B%22id%22%3A12342%2C%22name%22%3A%22CF70E%20Information%20Reform%22%2C%22slug%22%3A%22CF70E%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Information%20Reform%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573286098;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Information Reform</h1>
<h2>题意翻译</h2>
<div>题目描述：
尽管现在已经是21世纪了，但是大众传播媒介在$Walrusland$依然没有普及开来。这里的城市通过能够在城市间的道路来往的信使来互相传递消息。在$Walrusland$，城市间的道路保证信使可以从一座城市到任意另一座城市，而且这些道路是等长的。
北极政府决定实施一项信息改革。几座城市被选中成为区域信息中心。维护一座区域信息中心每年需要花费$k$个$fishlar$（这是当地的货币）。假设每座区域信息中心总是能即时获得最新的消息。
每一座不是区域信息中心的城市，都会被安排通过一座区域信息中心来保持信息通达。这样，每年维护费用将会等于$d_{len} \ $个$fishlar$，其中$len$表示这座城市到它的区域信息中心的距离，即一个人从这座城市到它的区域信息中心需要走过的道路条数。
你的任务是求出实行这项改革的最小开销。
输入格式：
第一行包含两个给定的整数$n$和$k$（$1<=n<=180$，$1<=k<=10^{5}$）；
第二行包含$n-1$个整数$d_i$，下标从$1$开始。（$d_{i}<=d_{i+1},0<=d_{i}<=10^{5}$）
接下来的$n-1$行包含被一条道路连接的城市对。
输出格式：
第一行，输出每年维护信息联系的最小花销。（单位：$fishlar$）；
第二行，输出$n$个整数，第$i$个整数代表第$i$座城市所由编号为$a_i$的区域信息中心的负责；如果第$i$座城市是一座区域信息中心，你只需输出数字$i$。
如果此题有多解，只需输出任意一组。
翻译 By @若如初见</div>
<h2>题目描述</h2>
<div>Thought it is already the XXI century, the Mass Media isn't very popular in Walrusland. The cities get news from messengers who can only travel along roads. The network of roads in Walrusland is built so that it is possible to get to any city from any other one in exactly one way, and the roads' lengths are equal.
The North Pole governor decided to carry out an information reform. Several cities were decided to be chosen and made regional centers. Maintaining a region center takes $ k $ fishlars (which is a local currency) per year. It is assumed that a regional center always has information on the latest news.
For every city which is not a regional center, it was decided to appoint a regional center which will be responsible for keeping this city informed. In that case the maintenance costs will be equal to $ d_{len} $ fishlars per year, where $ len $ is the distance from a city to the corresponding regional center, measured in the number of roads along which one needs to go.
Your task is to minimize the costs to carry out the reform.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains two given numbers $ n $ and $ k $ ( $ 1<=n<=180,1<=k<=10^{5} $ ).
The second line contains $ n-1 $ integers $ d_{i} $ , numbered starting with 1 ( $ d_{i}<=d_{i+1},0<=d_{i}<=10^{5} $ ).
Next $ n-1 $ lines contain the pairs of cities connected by a road.</div>
<h3>输出格式</h3>
<br />
<div>On the first line print the minimum number of fishlars needed for a year's maintenance. On the second line print $ n $ numbers, where the $ i $ -th number will represent the number of the regional center, appointed to the $ i $ -th city. If the $ i $ -th city is a regional center itself, then you should print number $ i $ .
If there are several solutions to that problem, print any of them.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>8 10
2 5 9 11 15 19 20
1 4
1 3
1 7
4 6
2 8
2 3
3 5
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>38
3 3 3 4 3 4 3 3 </code></pre>
</article>
</div>
</div>
</body>
</html>
