<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Delivery Oligopoly - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573402386:fVPhoF/hdPANvm150kZShFGeUInQr0XGzCEPrV22cU4=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22The%20whole%20delivery%20market%20of%20Berland%20is%20controlled%20by%20two%20rival%20companies%3A%20BerEx%20and%20BerPS.%20They%20both%20provide%20fast%20and%20reliable%20delivery%20services%20across%20all%20the%20cities%20of%20Berland.%5Cn%5CnThe%20map%20of%20Berland%20can%20be%20represented%20as%20an%20undirected%20graph.%20The%20cities%20are%20vertices%20and%20the%20roads%20are%20edges%20between%20them.%20Each%20pair%20of%20cities%20has%20no%20more%20than%20one%20road%20between%20them.%20Each%20road%20connects%20different%20cities.%5Cn%5CnBerEx%20and%20BerPS%20are%20so%20competitive%20that%20for%20each%20pair%20of%20cities%20%24%20%28v%2C%20u%29%20%24%20they%20have%20set%20up%20their%20paths%20from%20%24%20v%20%24%20to%20%24%20u%20%24%20in%20such%20a%20way%20that%20these%20two%20paths%20don%27t%20share%20a%20single%20road.%20It%20is%20guaranteed%20that%20it%20was%20possible.%5Cn%5CnNow%20Berland%20government%20decided%20to%20cut%20down%20the%20road%20maintenance%20cost%20by%20abandoning%20some%20roads.%20Obviously%2C%20they%20want%20to%20maintain%20as%20little%20roads%20as%20possible.%20However%2C%20they%20don%27t%20want%20to%20break%20the%20entire%20delivery%20system.%20So%20BerEx%20and%20BerPS%20should%20still%20be%20able%20to%20have%20their%20paths%20between%20every%20pair%20of%20cities%20non-intersecting.%5Cn%5CnWhat%20is%20the%20minimal%20number%20of%20roads%20Berland%20government%20can%20maintain%3F%5Cn%5CnMore%20formally%2C%20given%20a%202-edge%20connected%20undirected%20graph%2C%20what%20is%20the%20minimum%20number%20of%20edges%20that%20can%20be%20left%20in%20it%20so%20that%20the%20resulting%20graph%20is%20also%202-edge%20connected%3F%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20two%20integers%20%24%20n%20%24%20and%20%24%20m%20%24%20%28%20%24%203%20%5C%5Cle%20n%20%5C%5Cle%2014%20%24%20%2C%20%24%20n%20%5C%5Cle%20m%20%5C%5Cle%20%5C%5Cfrac%7Bn%28n%20-%201%29%7D%7B2%7D%20%24%20%29%20%5Cu2014%20the%20number%20of%20cities%20and%20the%20number%20of%20roads%20between%20them.%5Cn%5CnEach%20of%20the%20next%20%24%20m%20%24%20lines%20contains%20two%20integers%20%24%20v%20%24%20and%20%24%20u%20%24%20%28%20%24%201%20%5C%5Cle%20v%2C%20u%20%5C%5Cle%20n%20%24%20%2C%20%24%20v%20%5C%5Cne%20u%20%24%20%29%20%5Cu2014%20the%20cities%20connected%20by%20the%20next%20road.%5Cn%5CnIt%20is%20guaranteed%20that%20each%20pair%20of%20cities%20has%20no%20more%20than%20one%20road%20between%20them.%20It%20is%20guaranteed%20that%20each%20pair%20of%20cities%20have%20at%20least%20two%20paths%20between%20them%20that%20don%27t%20share%20a%20single%20road.%22%2C%22outputFormat%22%3A%22The%20first%20line%20should%20contain%20a%20single%20integer%20%24%20k%20%24%20%5Cu2014%20the%20minimum%20number%20of%20roads%20Berland%20government%20can%20maintain%20so%20that%20BerEx%20and%20BerPS%20are%20still%20able%20to%20have%20their%20paths%20between%20every%20pair%20of%20cities%20non-intersecting.%5Cn%5CnThe%20next%20%24%20k%20%24%20lines%20should%20contain%20the%20list%20of%20roads%20which%20are%20being%20maintained.%20Each%20line%20of%20form%20%5C%22%20%24%20v~u%20%24%20%5C%22%2C%20where%20%24%20v%20%24%20and%20%24%20u%20%24%20are%20cities%20connected%20by%20the%20next%20road.%5Cn%5CnIf%20there%20are%20multiple%20lists%20of%20minimum%20size%2C%20print%20any%20of%20them.%20The%20order%20of%20roads%20in%20the%20list%20doesn%27t%20matter.%22%2C%22samples%22%3A%5B%5B%22%5Cn3%203%5Cn1%202%5Cn2%203%5Cn3%201%5Cn%22%2C%22%5Cn3%5Cn1%203%5Cn3%202%5Cn1%202%5Cn%22%5D%2C%5B%22%5Cn4%205%5Cn1%202%5Cn1%204%5Cn2%203%5Cn4%203%5Cn1%203%5Cn%22%2C%22%5Cn4%5Cn1%204%5Cn4%203%5Cn3%202%5Cn1%202%5Cn%22%5D%2C%5B%22%5Cn6%2010%5Cn1%202%5Cn2%203%5Cn3%201%5Cn3%204%5Cn4%205%5Cn5%206%5Cn4%206%5Cn2%205%5Cn1%206%5Cn3%205%5Cn%22%2C%22%5Cn6%5Cn1%206%5Cn6%205%5Cn5%204%5Cn4%203%5Cn3%202%5Cn1%202%5Cn%22%5D%5D%2C%22hint%22%3A%22Here%20are%20graphs%20from%20the%20examples%2C%20red%20edges%20are%20the%20maintained%20ones.%5Cn%5Cn%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF1155F%5C%2Ff8cc8be0ffeaa507611464c133b700c1bfff4218.png%29%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF1155F%5C%2Fddf572c9ce5da3caff7f3f945bec8caed610de38.png%29%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF1155F%5C%2F396a726bd443525a7d7d772e211f1816f0f1d82f.png%29%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F1155%5C%2FF%22%2C%22id%22%3A%221155F%22%7D%2C%22translation%22%3A%22%5Cu7ed9%5Cu5b9a%5Cu4e00%5Cu5f20%24n%24%5Cu4e2a%5Cu70b9%24m%24%5Cu6761%5Cu8fb9%5Cu65e0%5Cu5411%5Cu56fe%20%5Cu4fdd%5Cu8bc1%5Cu5b83%5Cu662f%5Cu4e00%5Cu4e2a%5Cu8fb9%5Cu53cc%5Cu8fde%5Cu901a%5Cu5206%5Cu91cf%20%20%5Cr%5Cn%5Cu4f60%5Cu9700%5Cu8981%5Cu6c42%5Cu51fa%5Cu5b83%5Cu7684%5Cu4e00%5Cu4e2a%5Cu5305%5Cu542b%24n%24%5Cu4e2a%5Cu70b9%5Cu7684%5Cu5b50%5Cu56fe%20%5Cu6ee1%5Cu8db3%5Cu4e24%5Cu4e2a%5Cu6761%5Cu4ef6%5Cuff1a%5Cr%5Cn-%20%5Cu8fd9%5Cu4e2a%5Cu5b50%5Cu56fe%5Cu5fc5%5Cu987b%5Cu4e5f%5Cu662f%5Cu8fb9%5Cu53cc%5Cu8fde%5Cu901a%5Cu5206%5Cu91cf%5Cr%5Cn-%20%5Cu8fd9%5Cu4e2a%5Cu5b50%5Cu56fe%5Cu7684%5Cu8fb9%5Cu6570%5Cu6700%5Cu5c11%20%20%5Cr%5Cn%5Cr%5Cn%5Cu6570%5Cu636e%5Cu4fdd%5Cu8bc1%5Cu6709%5Cu89e3%20%20%5Cr%5Cn%5Cu4f60%5Cu9700%5Cu8981%5Cu8f93%5Cu51fa%5Cu8fd9%5Cu4e2a%5Cu5b50%5Cu56fe%5Cu7684%5Cu6240%5Cu6709%5Cu8fb9%20%20%5Cr%5Cn%5Cr%5Cn%5Cu8fb9%5Cu53cc%5Cu8fde%5Cu901a%5Cu5206%5Cu91cf%5Cu662f%5Cu6307%5Cu4e00%5Cu4e2a%5Cu53bb%5Cu6389%5Cu4efb%5Cu4f55%5Cu4e00%5Cu6761%5Cu8fb9%5Cu90fd%5Cu4f9d%5Cu7136%5Cu8054%5Cu901a%5Cu7684%5Cu56fe%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A33%2C%22totalAccepted%22%3A14%2C%22pid%22%3A%22CF1155F%22%2C%22title%22%3A%22Delivery%20Oligopoly%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Delivery%20Oligopoly%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Delivery Oligopoly</h1>
<h2>题意翻译</h2>
<div>给定一张$n$个点$m$条边无向图 保证它是一个边双连通分量
你需要求出它的一个包含$n$个点的子图 满足两个条件：
- 这个子图必须也是边双连通分量
- 这个子图的边数最少
数据保证有解
你需要输出这个子图的所有边
边双连通分量是指一个去掉任何一条边都依然联通的图</div>
<h2>题目描述</h2>
<div>The whole delivery market of Berland is controlled by two rival companies: BerEx and BerPS. They both provide fast and reliable delivery services across all the cities of Berland.
The map of Berland can be represented as an undirected graph. The cities are vertices and the roads are edges between them. Each pair of cities has no more than one road between them. Each road connects different cities.
BerEx and BerPS are so competitive that for each pair of cities $ (v, u) $ they have set up their paths from $ v $ to $ u $ in such a way that these two paths don't share a single road. It is guaranteed that it was possible.
Now Berland government decided to cut down the road maintenance cost by abandoning some roads. Obviously, they want to maintain as little roads as possible. However, they don't want to break the entire delivery system. So BerEx and BerPS should still be able to have their paths between every pair of cities non-intersecting.
What is the minimal number of roads Berland government can maintain?
More formally, given a 2-edge connected undirected graph, what is the minimum number of edges that can be left in it so that the resulting graph is also 2-edge connected?</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains two integers $ n $ and $ m $ ( $ 3 \le n \le 14 $ , $ n \le m \le \frac{n(n - 1)}{2} $ ) — the number of cities and the number of roads between them.
Each of the next $ m $ lines contains two integers $ v $ and $ u $ ( $ 1 \le v, u \le n $ , $ v \ne u $ ) — the cities connected by the next road.
It is guaranteed that each pair of cities has no more than one road between them. It is guaranteed that each pair of cities have at least two paths between them that don't share a single road.</div>
<h3>输出格式</h3>
<br />
<div>The first line should contain a single integer $ k $ — the minimum number of roads Berland government can maintain so that BerEx and BerPS are still able to have their paths between every pair of cities non-intersecting.
The next $ k $ lines should contain the list of roads which are being maintained. Each line of form " $ v~u $ ", where $ v $ and $ u $ are cities connected by the next road.
If there are multiple lists of minimum size, print any of them. The order of roads in the list doesn't matter.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>
3 3
1 2
2 3
3 1
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>
3
1 3
3 2
1 2
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>
4 5
1 2
1 4
2 3
4 3
1 3
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>
4
1 4
4 3
3 2
1 2
</code></pre>
<h3>输入样例 #3</h3>
<pre><code>
6 10
1 2
2 3
3 1
3 4
4 5
5 6
4 6
2 5
1 6
3 5
</code></pre>
<h3>输出样例 #3</h3>
<pre><code>
6
1 6
6 5
5 4
4 3
3 2
1 2
</code></pre>
<h2>说明</h2>
<div>Here are graphs from the examples, red edges are the maintained ones.
![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1155F/f8cc8be0ffeaa507611464c133b700c1bfff4218.png)![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1155F/ddf572c9ce5da3caff7f3f945bec8caed610de38.png)![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1155F/396a726bd443525a7d7d772e211f1816f0f1d82f.png)</div>
</article>
</div>
</div>
</body>
</html>
