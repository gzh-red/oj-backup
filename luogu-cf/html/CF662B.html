<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Graph Coloring - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573396480:XxzNxNHuTzRTSPvqMQWwz62u567tpIVSB78TXvPge7w=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22You%20are%20given%20an%20undirected%20graph%20that%20consists%20of%20%24%20n%20%24%20vertices%20and%20%24%20m%20%24%20edges.%20Initially%2C%20each%20edge%20is%20colored%20either%20red%20or%20blue.%20Each%20turn%20a%20player%20picks%20a%20single%20vertex%20and%20switches%20the%20color%20of%20all%20edges%20incident%20to%20it.%20That%20is%2C%20all%20red%20edges%20with%20an%20endpoint%20in%20this%20vertex%20change%20the%20color%20to%20blue%2C%20while%20all%20blue%20edges%20with%20an%20endpoint%20in%20this%20vertex%20change%20the%20color%20to%20red.%5Cn%5CnFind%20the%20minimum%20possible%20number%20of%20moves%20required%20to%20make%20the%20colors%20of%20all%20edges%20equal.%22%2C%22inputFormat%22%3A%22The%20first%20line%20of%20the%20input%20contains%20two%20integers%20%24%20n%20%24%20and%20%24%20m%20%24%20%28%20%24%201%3C%3Dn%2Cm%3C%3D100000%20%24%20%29%20%5Cu2014%20the%20number%20of%20vertices%20and%20edges%2C%20respectively.%5Cn%5CnThe%20following%20%24%20m%20%24%20lines%20provide%20the%20description%20of%20the%20edges%2C%20as%20the%20%24%20i%20%24%20-th%20of%20them%20contains%20two%20integers%20%24%20u_%7Bi%7D%20%24%20and%20%24%20v_%7Bi%7D%20%24%20%28%20%24%201%3C%3Du_%7Bi%7D%2Cv_%7Bi%7D%3C%3Dn%20%24%20%2C%20%24%20u_%7Bi%7D%5Cu2260v_%7Bi%7D%20%24%20%29%20%5Cu2014%20the%20indices%20of%20the%20vertices%20connected%20by%20the%20%24%20i%20%24%20-th%20edge%2C%20and%20a%20character%20%24%20c_%7Bi%7D%20%24%20%28%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF662B%5C%2F427b9b8bbbd6a7ee3970807ed458245f7bc435be.png%29%29%20providing%20the%20initial%20color%20of%20this%20edge.%20If%20%24%20c_%7Bi%7D%20%24%20equals%20%27R%27%2C%20then%20this%20edge%20is%20initially%20colored%20red.%20Otherwise%2C%20%24%20c_%7Bi%7D%20%24%20is%20equal%20to%20%27B%27%20and%20this%20edge%20is%20initially%20colored%20blue.%20It%27s%20guaranteed%20that%20there%20are%20no%20self-loops%20and%20multiple%20edges.%22%2C%22outputFormat%22%3A%22If%20there%20is%20no%20way%20to%20make%20the%20colors%20of%20all%20edges%20equal%20output%20%24%20-1%20%24%20in%20the%20only%20line%20of%20the%20output.%20Otherwise%20first%20output%20%24%20k%20%24%20%5Cu2014%20the%20minimum%20number%20of%20moves%20required%20to%20achieve%20the%20goal%2C%20then%20output%20%24%20k%20%24%20integers%20%24%20a_%7B1%7D%2Ca_%7B2%7D%2C...%2Ca_%7Bk%7D%20%24%20%2C%20where%20%24%20a_%7Bi%7D%20%24%20is%20equal%20to%20the%20index%20of%20the%20vertex%20that%20should%20be%20used%20at%20the%20%24%20i%20%24%20-th%20move.%5Cn%5CnIf%20there%20are%20multiple%20optimal%20sequences%20of%20moves%2C%20output%20any%20of%20them.%22%2C%22samples%22%3A%5B%5B%223%203%5Cn1%202%20B%5Cn3%201%20R%5Cn3%202%20B%5Cn%22%2C%221%5Cn2%20%5Cn%22%5D%2C%5B%226%205%5Cn1%203%20R%5Cn2%203%20R%5Cn3%204%20B%5Cn4%205%20R%5Cn4%206%20R%5Cn%22%2C%222%5Cn3%204%20%5Cn%22%5D%2C%5B%224%205%5Cn1%202%20R%5Cn1%203%20R%5Cn2%203%20B%5Cn3%204%20B%5Cn1%204%20B%5Cn%22%2C%22-1%5Cn%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F662%5C%2FB%22%2C%22id%22%3A%22662B%22%7D%2C%22translation%22%3A%22%23%20%5Cu9898%5Cu76ee%5Cu63cf%5Cu8ff0%5Cr%5Cn%5Cu7ed9%5Cu51fa%5Cu4e00%5Cu4e2a%24n%24%5Cu4e2a%5Cu70b9%5Cuff0c%24m%24%5Cu6761%5Cu8fb9%5Cu7684%5Cu65e0%5Cu5411%5Cu56fe%5Cuff0c%5Cu4e00%5Cu5f00%5Cu59cb%5Cu6bcf%5Cu6761%5Cu8fb9%5Cu53ef%5Cu80fd%5Cu662f%5Cu7ea2%5Cu8272%5Cu6216%5Cu8005%5Cu84dd%5Cu8272%5Cuff0c%5Cu7ffb%5Cu8f6c%5Cu4e00%5Cu4e2a%5Cu70b9%5Cu53ef%5Cu4ee5%5Cu4f7f%5Cu76f8%5Cu8fde%5Cu7684%5Cu8fb9%5Cu53d8%5Cu6210%5Cu76f8%5Cu53cd%5Cu7684%5Cu989c%5Cu8272%5Cuff0c%5Cu5e0c%5Cu671b%5Cu80fd%5Cu591f%5Cu628a%5Cu5168%5Cu90e8%5Cu8fb9%5Cu53d8%5Cu6210%5Cu7ea2%5Cu8272%5Cu6216%5Cu8005%5Cu84dd%5Cu8272%5Cr%5Cn%5Cu95ee%5Cu6700%5Cu5c11%5Cu9700%5Cu8981%5Cu7ffb%5Cu8f6c%5Cu7684%5Cu70b9%5Cu6570%5Cuff0c%5Cu5e76%5Cu7ed9%5Cu51fa%5Cu5177%5Cu4f53%5Cu7684%5Cu65b9%5Cu6848%5Cr%5Cn%5Cr%5Cn---%5Cr%5Cn%23%20%5Cu8f93%5Cu5165%5Cu8f93%5Cu51fa%5Cu683c%5Cu5f0f%5Cr%5Cn%23%23%20%5Cu8f93%5Cu5165%5Cu683c%5Cu5f0f%5Cr%5Cn%5Cu7b2c%5Cu4e00%5Cu884c%5Cu8f93%5Cu5165%24n%2Cm%24%5Cuff0c%5Cu5206%5Cu522b%5Cu8868%5Cu793a%5Cu70b9%5Cu7684%5Cu6570%5Cu91cf%5Cu548c%5Cu8fb9%5Cu7684%5Cu6570%5Cu91cf%24%281%5C%5Cleq%20n%2Cm%5C%5Cleq%20100000%29%24%5Cr%5Cn%5Cr%5Cn%5Cu7b2c%5Cu4e8c%5Cu81f3%24m%2B1%24%5Cu884c%24ui%2Cvi%2Cci%24%5Cuff0c%5Cu5206%5Cu522b%5Cu8868%5Cu793a%5Cu65e0%5Cu5411%5Cu8fb9%5Cu7684%5Cu4e24%5Cu4e2a%5Cu70b9%5Cu4ee5%5Cu53ca%5Cu5b83%5Cu7684%5Cu989c%5Cu8272%5Cuff0c%5Cu4fdd%5Cu8bc1%5Cu6ca1%5Cu6709%5Cu91cd%5Cu8fb9%5Cu548c%5Cu81ea%5Cu73af%5Cr%5Cn%5Cr%5Cn%23%23%20%5Cu8f93%5Cu51fa%5Cu683c%5Cu5f0f%5Cr%5Cn%5Cu5982%5Cu679c%5Cu6ca1%5Cu6709%5Cu65b9%5Cu6cd5%5Cu4f7f%5Cu5176%5Cu5408%5Cu6cd5%5Cu8f93%5Cu51fa%24-1%24%5Cuff0c%5Cr%5Cn%5Cu5426%5Cu5219%5Cu7b2c%5Cu4e00%5Cu884c%5Cu8f93%5Cu51fa%5Cu6700%5Cu5c11%5Cu9700%5Cu8981%5Cu7ffb%5Cu8f6c%5Cu7684%5Cu70b9%5Cu6570%5Cuff0c%5Cu7b2c%5Cu4e8c%5Cu884c%5Cu7528%5Cu7a7a%5Cu683c%5Cu5206%5Cu9694%5Cu8f93%5Cu51fa%5Cu7ffb%5Cu8f6c%5Cu70b9%5Cu7684%5Cu7f16%5Cu53f7%5Cuff0c%5Cu53ea%5Cu9700%5Cu8981%5Cu8f93%5Cu51fa%5Cu4e00%5Cu79cd%5Cu65b9%5Cu6848%5Cr%5Cn%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A30%2C%22totalAccepted%22%3A7%2C%22pid%22%3A%22CF662B%22%2C%22title%22%3A%22Graph%20Coloring%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A67455%2C%22title%22%3A%22%5Cu7ffb%5Cu8bd1%22%2C%22forum%22%3A%7B%22id%22%3A9989%2C%22name%22%3A%22CF662B%20Graph%20Coloring%22%2C%22slug%22%3A%22CF662B%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Graph%20Coloring%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573306449;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Graph Coloring</h1>
<h2>题意翻译</h2>
<div># 题目描述
给出一个$n$个点，$m$条边的无向图，一开始每条边可能是红色或者蓝色，翻转一个点可以使相连的边变成相反的颜色，希望能够把全部边变成红色或者蓝色
问最少需要翻转的点数，并给出具体的方案
---
# 输入输出格式
## 输入格式
第一行输入$n,m$，分别表示点的数量和边的数量$(1\leq n,m\leq 100000)$
第二至$m+1$行$ui,vi,ci$，分别表示无向边的两个点以及它的颜色，保证没有重边和自环
## 输出格式
如果没有方法使其合法输出$-1$，
否则第一行输出最少需要翻转的点数，第二行用空格分隔输出翻转点的编号，只需要输出一种方案
</div>
<h2>题目描述</h2>
<div>You are given an undirected graph that consists of $ n $ vertices and $ m $ edges. Initially, each edge is colored either red or blue. Each turn a player picks a single vertex and switches the color of all edges incident to it. That is, all red edges with an endpoint in this vertex change the color to blue, while all blue edges with an endpoint in this vertex change the color to red.
Find the minimum possible number of moves required to make the colors of all edges equal.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line of the input contains two integers $ n $ and $ m $ ( $ 1<=n,m<=100000 $ ) — the number of vertices and edges, respectively.
The following $ m $ lines provide the description of the edges, as the $ i $ -th of them contains two integers $ u_{i} $ and $ v_{i} $ ( $ 1<=u_{i},v_{i}<=n $ , $ u_{i}≠v_{i} $ ) — the indices of the vertices connected by the $ i $ -th edge, and a character $ c_{i} $ (![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF662B/427b9b8bbbd6a7ee3970807ed458245f7bc435be.png)) providing the initial color of this edge. If $ c_{i} $ equals 'R', then this edge is initially colored red. Otherwise, $ c_{i} $ is equal to 'B' and this edge is initially colored blue. It's guaranteed that there are no self-loops and multiple edges.</div>
<h3>输出格式</h3>
<br />
<div>If there is no way to make the colors of all edges equal output $ -1 $ in the only line of the output. Otherwise first output $ k $ — the minimum number of moves required to achieve the goal, then output $ k $ integers $ a_{1},a_{2},...,a_{k} $ , where $ a_{i} $ is equal to the index of the vertex that should be used at the $ i $ -th move.
If there are multiple optimal sequences of moves, output any of them.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>3 3
1 2 B
3 1 R
3 2 B
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>1
2 
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>6 5
1 3 R
2 3 R
3 4 B
4 5 R
4 6 R
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>2
3 4 
</code></pre>
<h3>输入样例 #3</h3>
<pre><code>4 5
1 2 R
1 3 R
2 3 B
3 4 B
1 4 B
</code></pre>
<h3>输出样例 #3</h3>
<pre><code>-1
</code></pre>
</article>
</div>
</div>
</body>
</html>
