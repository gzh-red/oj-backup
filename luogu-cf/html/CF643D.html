<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Bearish Fanpages - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573396326:z2jFU9T2MuHPKMJLueaHBQL5SKBTcL9tVfCck7w6AbU=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22There%20is%20a%20social%20website%20with%20%24%20n%20%24%20fanpages%2C%20numbered%20%24%201%20%24%20through%20%24%20n%20%24%20.%20There%20are%20also%20%24%20n%20%24%20companies%2C%20and%20the%20%24%20i%20%24%20-th%20company%20owns%20the%20%24%20i%20%24%20-th%20fanpage.%5Cn%5CnRecently%2C%20the%20website%20created%20a%20feature%20called%20following.%20Each%20fanpage%20must%20choose%20exactly%20one%20other%20fanpage%20to%20follow.%5Cn%5CnThe%20website%20doesn%5Cu2019t%20allow%20a%20situation%20where%20%24%20i%20%24%20follows%20%24%20j%20%24%20and%20at%20the%20same%20time%20%24%20j%20%24%20follows%20%24%20i%20%24%20.%20Also%2C%20a%20fanpage%20can%27t%20follow%20itself.%5Cn%5CnLet%5Cu2019s%20say%20that%20fanpage%20%24%20i%20%24%20follows%20some%20other%20fanpage%20%24%20j_%7B0%7D%20%24%20.%20Also%2C%20let%5Cu2019s%20say%20that%20%24%20i%20%24%20is%20followed%20by%20%24%20k%20%24%20other%20fanpages%20%24%20j_%7B1%7D%2Cj_%7B2%7D%2C...%2Cj_%7Bk%7D%20%24%20.%20Then%2C%20when%20people%20visit%20fanpage%20%24%20i%20%24%20they%20see%20ads%20from%20%24%20k%2B2%20%24%20distinct%20companies%3A%20%24%20i%2Cj_%7B0%7D%2Cj_%7B1%7D%2C...%2Cj_%7Bk%7D%20%24%20.%20Exactly%20%24%20t_%7Bi%7D%20%24%20people%20subscribe%20%28like%29%20the%20%24%20i%20%24%20-th%20fanpage%2C%20and%20each%20of%20them%20will%20click%20exactly%20one%20add.%20For%20each%20of%20%24%20k%2B1%20%24%20companies%20%24%20j_%7B0%7D%2Cj_%7B1%7D%2C...%2Cj_%7Bk%7D%20%24%20%2C%20exactly%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF643D%5C%2F21bba61653cf179f89248142af248d7df7419d53.png%29%20people%20will%20click%20their%20ad.%20Remaining%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF643D%5C%2F41e88e0191cf8cbf46af6c24ce4f538a6481272e.png%29%20people%20will%20click%20an%20ad%20from%20company%20%24%20i%20%24%20%28the%20owner%20of%20the%20fanpage%29.%5Cn%5CnThe%20total%20income%20of%20the%20company%20is%20equal%20to%20the%20number%20of%20people%20who%20click%20ads%20from%20this%20copmany.%5Cn%5CnLimak%20and%20Radewoosh%20ask%20you%20for%20help.%20Initially%2C%20fanpage%20%24%20i%20%24%20follows%20fanpage%20%24%20f_%7Bi%7D%20%24%20.%20Your%20task%20is%20to%20handle%20%24%20q%20%24%20queries%20of%20three%20types%3A%5Cn%5Cn-%201%20i%20j%20%5Cu2014%20fanpage%20%24%20i%20%24%20follows%20fanpage%20%24%20j%20%24%20from%20now.%20It%27s%20guaranteed%20that%20%24%20i%20%24%20didn%27t%20follow%20%24%20j%20%24%20just%20before%20the%20query.%20Note%20an%20extra%20constraint%20for%20the%20number%20of%20queries%20of%20this%20type%20%28below%2C%20in%20the%20Input%20section%29.%5Cn-%202%20i%20%5Cu2014%20print%20the%20total%20income%20of%20the%20%24%20i%20%24%20-th%20company.%5Cn-%203%20%5Cu2014%20print%20two%20integers%3A%20the%20smallest%20income%20of%20one%20company%20and%20the%20biggest%20income%20of%20one%20company.%22%2C%22inputFormat%22%3A%22The%20first%20line%20of%20the%20input%20contains%20two%20integers%20%24%20n%20%24%20and%20%24%20q%20%24%20%28%20%24%203%3C%3Dn%3C%3D100000%20%24%20%2C%20%24%201%3C%3Dq%3C%3D100000%20%24%20%29%20%5Cu2014%20the%20number%20of%20fanpages%20and%20the%20number%20of%20queries%2C%20respectively.%5Cn%5CnThe%20second%20line%20contains%20%24%20n%20%24%20integers%20%24%20t_%7B1%7D%2Ct_%7B2%7D%2C...%2Ct_%7Bn%7D%20%24%20%28%20%24%201%3C%3Dt_%7Bi%7D%3C%3D10%5E%7B12%7D%20%24%20%29%20where%20%24%20t_%7Bi%7D%20%24%20denotes%20the%20number%20of%20people%20subscribing%20the%20%24%20i%20%24%20-th%20fanpage.%5Cn%5CnThe%20third%20line%20contains%20%24%20n%20%24%20integers%20%24%20f_%7B1%7D%2Cf_%7B2%7D%2C...%2Cf_%7Bn%7D%20%24%20%28%20%24%201%3C%3Df_%7Bi%7D%3C%3Dn%20%24%20%29.%20Initially%2C%20fanpage%20%24%20i%20%24%20follows%20fanpage%20%24%20f_%7Bi%7D%20%24%20.%5Cn%5CnThen%2C%20%24%20q%20%24%20lines%20follow.%20The%20%24%20i%20%24%20-th%20of%20them%20describes%20the%20%24%20i%20%24%20-th%20query.%20The%20first%20number%20in%20the%20line%20is%20an%20integer%20%24%20type_%7Bi%7D%20%24%20%28%20%24%201%3C%3Dtype_%7Bi%7D%3C%3D3%20%24%20%29%20%5Cu2014%20the%20type%20of%20the%20query.%5Cn%5CnThere%20will%20be%20at%20most%20%24%2050000%20%24%20queries%20of%20the%20first%20type.%20There%20will%20be%20at%20least%20one%20query%20of%20the%20second%20or%20the%20third%20type%20%28so%2C%20the%20output%20won%27t%20be%20empty%29.%5Cn%5CnIt%27s%20guaranteed%20that%20at%20each%20moment%20a%20fanpage%20doesn%27t%20follow%20itself%2C%20and%20that%20no%20two%20fanpages%20follow%20each%20other.%22%2C%22outputFormat%22%3A%22For%20each%20query%20of%20the%20second%20type%20print%20one%20integer%20in%20a%20separate%20line%20-%20the%20total%20income%20of%20the%20given%20company.%20For%20each%20query%20of%20the%20third%20type%20print%20two%20integers%20in%20a%20separate%20line%20-%20the%20minimum%20and%20the%20maximum%20total%20income%2C%20respectively.%22%2C%22samples%22%3A%5B%5B%225%2012%5Cn10%2020%2030%2040%2050%5Cn2%203%204%205%202%5Cn2%201%5Cn2%202%5Cn2%203%5Cn2%204%5Cn2%205%5Cn1%204%202%5Cn2%201%5Cn2%202%5Cn2%203%5Cn2%204%5Cn2%205%5Cn3%5Cn%22%2C%2210%5Cn36%5Cn28%5Cn40%5Cn36%5Cn9%5Cn57%5Cn27%5Cn28%5Cn29%5Cn9%2057%5Cn%22%5D%5D%2C%22hint%22%3A%22%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF643D%5C%2Fd9db9bc44e733c82215e5751c44c438174d7820a.png%29In%20the%20sample%20test%2C%20there%20are%20%24%205%20%24%20fanpages.%20The%20%24%20i%20%24%20-th%20of%20them%20has%20%24%20i%5Cu00b710%20%24%20subscribers.%5Cn%5CnOn%20drawings%2C%20numbers%20of%20subscribers%20are%20written%20in%20circles.%20An%20arrow%20from%20%24%20A%20%24%20to%20%24%20B%20%24%20means%20that%20%24%20A%20%24%20follows%20%24%20B%20%24%20.%5Cn%5CnThe%20left%20drawing%20shows%20the%20initial%20situation.%20The%20first%20company%20gets%20income%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF643D%5C%2F66341a4c63fe8dcbff87b6d1efb8920e9cbb8631.png%29%20from%20its%20own%20fanpage%2C%20and%20gets%20income%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF643D%5C%2Fe1ae5946de33df9032cda69753ae955ed119e264.png%29%20from%20the%20%24%202%20%24%20-nd%20fanpage.%20So%2C%20the%20total%20income%20is%20%24%205%2B5%3D10%20%24%20.%20After%20the%20first%20query%20%28%5C%222%201%5C%22%29%20you%20should%20print%20%24%2010%20%24%20.%5Cn%5CnThe%20right%20drawing%20shows%20the%20situation%20after%20a%20query%20%5C%221%204%202%5C%22%20%28after%20which%20fanpage%20%24%204%20%24%20follows%20fanpage%20%24%202%20%24%20%29.%20Then%2C%20the%20first%20company%20still%20gets%20income%20%24%205%20%24%20from%20its%20own%20fanpage%2C%20but%20now%20it%20gets%20only%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF643D%5C%2F2ec2bf132e45182de4904da17cfe1690c0fccba6.png%29%20from%20the%20%24%202%20%24%20-nd%20fanpage.%20So%2C%20the%20total%20income%20is%20%24%205%2B4%3D9%20%24%20now.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B5000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F643%5C%2FD%22%2C%22id%22%3A%22643D%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A49%2C%22totalAccepted%22%3A33%2C%22pid%22%3A%22CF643D%22%2C%22title%22%3A%22Bearish%20Fanpages%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Bearish%20Fanpages%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573306449;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Bearish Fanpages</h1>
<h2>题目描述</h2>
<div>There is a social website with $ n $ fanpages, numbered $ 1 $ through $ n $ . There are also $ n $ companies, and the $ i $ -th company owns the $ i $ -th fanpage.
Recently, the website created a feature called following. Each fanpage must choose exactly one other fanpage to follow.
The website doesn’t allow a situation where $ i $ follows $ j $ and at the same time $ j $ follows $ i $ . Also, a fanpage can't follow itself.
Let’s say that fanpage $ i $ follows some other fanpage $ j_{0} $ . Also, let’s say that $ i $ is followed by $ k $ other fanpages $ j_{1},j_{2},...,j_{k} $ . Then, when people visit fanpage $ i $ they see ads from $ k+2 $ distinct companies: $ i,j_{0},j_{1},...,j_{k} $ . Exactly $ t_{i} $ people subscribe (like) the $ i $ -th fanpage, and each of them will click exactly one add. For each of $ k+1 $ companies $ j_{0},j_{1},...,j_{k} $ , exactly ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF643D/21bba61653cf179f89248142af248d7df7419d53.png) people will click their ad. Remaining ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF643D/41e88e0191cf8cbf46af6c24ce4f538a6481272e.png) people will click an ad from company $ i $ (the owner of the fanpage).
The total income of the company is equal to the number of people who click ads from this copmany.
Limak and Radewoosh ask you for help. Initially, fanpage $ i $ follows fanpage $ f_{i} $ . Your task is to handle $ q $ queries of three types:
- 1 i j — fanpage $ i $ follows fanpage $ j $ from now. It's guaranteed that $ i $ didn't follow $ j $ just before the query. Note an extra constraint for the number of queries of this type (below, in the Input section).
- 2 i — print the total income of the $ i $ -th company.
- 3 — print two integers: the smallest income of one company and the biggest income of one company.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line of the input contains two integers $ n $ and $ q $ ( $ 3<=n<=100000 $ , $ 1<=q<=100000 $ ) — the number of fanpages and the number of queries, respectively.
The second line contains $ n $ integers $ t_{1},t_{2},...,t_{n} $ ( $ 1<=t_{i}<=10^{12} $ ) where $ t_{i} $ denotes the number of people subscribing the $ i $ -th fanpage.
The third line contains $ n $ integers $ f_{1},f_{2},...,f_{n} $ ( $ 1<=f_{i}<=n $ ). Initially, fanpage $ i $ follows fanpage $ f_{i} $ .
Then, $ q $ lines follow. The $ i $ -th of them describes the $ i $ -th query. The first number in the line is an integer $ type_{i} $ ( $ 1<=type_{i}<=3 $ ) — the type of the query.
There will be at most $ 50000 $ queries of the first type. There will be at least one query of the second or the third type (so, the output won't be empty).
It's guaranteed that at each moment a fanpage doesn't follow itself, and that no two fanpages follow each other.</div>
<h3>输出格式</h3>
<br />
<div>For each query of the second type print one integer in a separate line - the total income of the given company. For each query of the third type print two integers in a separate line - the minimum and the maximum total income, respectively.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>5 12
10 20 30 40 50
2 3 4 5 2
2 1
2 2
2 3
2 4
2 5
1 4 2
2 1
2 2
2 3
2 4
2 5
3
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>10
36
28
40
36
9
57
27
28
29
9 57
</code></pre>
<h2>说明</h2>
<div> ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF643D/d9db9bc44e733c82215e5751c44c438174d7820a.png)In the sample test, there are $ 5 $ fanpages. The $ i $ -th of them has $ i·10 $ subscribers.
On drawings, numbers of subscribers are written in circles. An arrow from $ A $ to $ B $ means that $ A $ follows $ B $ .
The left drawing shows the initial situation. The first company gets income ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF643D/66341a4c63fe8dcbff87b6d1efb8920e9cbb8631.png) from its own fanpage, and gets income ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF643D/e1ae5946de33df9032cda69753ae955ed119e264.png) from the $ 2 $ -nd fanpage. So, the total income is $ 5+5=10 $ . After the first query ("2 1") you should print $ 10 $ .
The right drawing shows the situation after a query "1 4 2" (after which fanpage $ 4 $ follows fanpage $ 2 $ ). Then, the first company still gets income $ 5 $ from its own fanpage, but now it gets only ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF643D/2ec2bf132e45182de4904da17cfe1690c0fccba6.png) from the $ 2 $ -nd fanpage. So, the total income is $ 5+4=9 $ now.</div>
</article>
</div>
</div>
</body>
</html>
