<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Ants - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573400387:uQo8B9aAN3Rl02GdNRR5TviYC01sv/s9uembm/FpzyM=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22There%20is%20a%20tree%20with%20%24%20n%20%24%20vertices.%20There%20are%20also%20%24%20m%20%24%20ants%20living%20on%20it.%20Each%20ant%20has%20its%20own%20color.%20The%20%24%20i%20%24%20-th%20ant%20has%20two%20favorite%20pairs%20of%20vertices%3A%20%28%20%24%20a_i%2C%20b_i%20%24%20%29%20and%20%28%20%24%20c_i%2C%20d_i%20%24%20%29.%20You%20need%20to%20tell%20if%20it%20is%20possible%20to%20paint%20the%20edges%20of%20the%20tree%20in%20%24%20m%20%24%20colors%20so%20that%20every%20ant%20will%20be%20able%20to%20walk%20between%20vertices%20from%20one%20of%20its%20favorite%20pairs%20using%20only%20edges%20of%20his%20color%3B%20if%20it%20is%20possible%2C%20you%20need%20to%20print%20which%20pair%20every%20ant%20should%20use.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20a%20single%20integer%20%24%20n%20%24%20%28%20%24%202%20%5C%5Cleq%20n%20%5C%5Cleq%2010%5E5%20%24%20%29%20%5Cu2014%20the%20number%20of%20vertices.%5Cn%5CnEach%20of%20the%20next%20%24%20n-1%20%24%20lines%20contains%20two%20integers%20%24%20u_i%20%24%20and%20%24%20v_i%20%24%20%28%20%24%201%20%5C%5Cleq%20u_i%2C%20v_i%20%5C%5Cleq%20n%20%24%20%29%2C%20meaning%20that%20there%20is%20an%20edge%20between%20vertices%20%24%20u_i%20%24%20and%20%24%20v_i%20%24%20.%5Cn%5CnThe%20next%20line%20contains%20a%20single%20integer%20%24%20m%20%24%20%28%20%24%201%20%5C%5Cleq%20m%20%5C%5Cleq%2010%5E4%20%24%20%29%20%5Cu2014%20the%20number%20of%20ants.%5Cn%5CnEach%20of%20the%20next%20%24%20m%20%24%20lines%20contains%20four%20integers%20%24%20a_i%20%24%20%2C%20%24%20b_i%20%24%20%2C%20%24%20c_i%20%24%20%2C%20and%20%24%20d_i%20%24%20%28%20%24%201%20%5C%5Cleq%20a_i%2C%20b_i%2C%20c_i%2C%20d_i%20%5C%5Cleq%20n%20%24%20%2C%20%24%20a_i%20%5C%5Cneq%20b_i%2C%20c_i%20%5C%5Cneq%20d_i%20%24%20%29%2C%20meaning%20that%20pairs%20%28%20%24%20a_i%20%24%20%2C%20%24%20b_i%20%24%20%29%20and%20%28%20%24%20c_i%20%24%20%2C%20%24%20d_i%20%24%20%29%20are%20favorite%20for%20the%20%24%20i%20%24%20-th%20ant.%22%2C%22outputFormat%22%3A%22Print%20%5C%22NO%5C%22%20%28without%20quotes%29%20if%20the%20wanted%20painting%20is%20impossible.%5Cn%5CnOtherwise%2C%20print%20%5C%22YES%5C%22%20%28without%20quotes%29.%20Print%20%24%20m%20%24%20lines.%20On%20the%20%24%20i%20%24%20-th%20line%2C%20print%20%24%201%20%24%20if%20the%20%24%20i%20%24%20-th%20ant%20will%20use%20the%20first%20pair%20and%20%24%202%20%24%20otherwise.%20If%20there%20are%20multiple%20answers%2C%20print%20any.%22%2C%22samples%22%3A%5B%5B%226%5Cn1%202%5Cn3%201%5Cn4%201%5Cn5%202%5Cn6%202%5Cn3%5Cn2%206%203%204%5Cn1%206%206%205%5Cn1%204%205%202%5Cn%22%2C%22YES%5Cn2%5Cn1%5Cn2%5Cn%22%5D%2C%5B%225%5Cn1%202%5Cn1%203%5Cn1%204%5Cn1%205%5Cn2%5Cn2%203%204%205%5Cn3%204%205%202%5Cn%22%2C%22NO%5Cn%22%5D%5D%2C%22hint%22%3A%22In%20the%20sample%2C%20the%20second%20and%20the%20third%20edge%20should%20be%20painted%20in%20the%20first%20color%2C%20the%20first%20and%20the%20fifth%20should%20be%20painted%20in%20the%20second%20color%2C%20and%20the%20fourth%20should%20be%20painted%20in%20the%20third%20color.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B3000%5D%2C%22memory%22%3A%5B768000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F1007%5C%2FD%22%2C%22id%22%3A%221007D%22%7D%2C%22translation%22%3A%22%5Cu6709%5Cu4e00%5Cu68f5%5Cu6811%5Cu6709n%5Cu4e2a%5Cu9876%5Cu70b9%5Cu3002%5Cu8fd8%5Cu6709m%5Cu53ea%5Cu8682%5Cu8681%5Cu4f4f%5Cu5728%5Cu4e0a%5Cu9762%5Cu3002%5Cu6bcf%5Cu53ea%5Cu8682%5Cu8681%5Cu90fd%5Cu6709%5Cu81ea%5Cu5df1%5Cu7684%5Cu989c%5Cu8272%5Cu3002%5Cu7b2ci%5Cu53ea%5Cu8682%5Cu8681%5Cu6709%5Cu4e24%5Cu4e2a%5Cu6700%5Cu559c%5Cu6b22%5Cu7684%5Cu9876%5Cu70b9%5Cu5bf9%5Cuff1a%5Cuff08ai%5Cuff0cbi%5Cuff09%5Cu548c%5Cuff08ci%5Cuff0cdi%5Cuff09%5Cu3002%5Cu4f60%5Cu9700%5Cu8981%5Cu77e5%5Cu9053%5Cu662f%5Cu5426%5Cu53ef%5Cu4ee5%5Cu7528m%5Cu79cd%5Cu989c%5Cu8272%5Cu7ed8%5Cu5236%5Cu6811%5Cu7684%5Cu8fb9%5Cuff0c%5Cu4ee5%5Cu4fbf%5Cu6bcf%5Cu4e2a%5Cu8682%5Cu8681%5Cu80fd%5Cu5728%5Cu5176%5Cu6700%5Cu559c%5Cu6b22%5Cu7684%5Cu4e00%5Cu5bf9%5Cu9876%5Cu70b9%5Cu5bf9%5Cu4e4b%5Cu95f4%5Cu884c%5Cu8d70%5Cu4e14%5Cu8fd9%5Cu6761%5Cu8fb9%5Cu7684%5Cu989c%5Cu8272%5Cu4e0e%5Cu8fd9%5Cu53ea%5Cu8682%5Cu8681%5Cu76f8%5Cu540c%5Cuff1b%5Cu5982%5Cu679c%5Cu53ef%5Cu80fd%5Cuff0c%5Cu4f60%5Cu9700%5Cu8981%5Cu8f93%5Cu51fa%5Cu6bcf%5Cu4e2a%5Cu8682%5Cu8681%5Cu884c%5Cu8d70%5Cu7684%5Cu9876%5Cu70b9%5Cu5bf9%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu7b2c%5Cu4e00%5Cu884c%5Cu8f93%5Cu5165%5Cu5305%5Cu542b%5Cu4e3a%5Cu6574%5Cu6570n%5Cuff08%5Cu9876%5Cu70b9%5Cu6570%5Cuff09%5Cu63a5%5Cu4e0b%5Cu6765%5Cu7684n-1%5Cu884c%5Cu4e2d%5Cu7684%5Cu6bcf%5Cu4e00%5Cu884c%5Cu90fd%5Cu5305%5Cu542b%5Cu4e24%5Cu4e2a%5Cu6574%5Cu6570ui%5Cu548cvi%5Cuff0c%5Cu8bf4%5Cu660e%5Cu5728%5Cu9876%5Cu70b9ui%5Cu548cvi%5Cu4e4b%5Cu95f4%5Cu6709%5Cu4e00%5Cu6761%5Cu8fb9%5Cu3002%5Cr%5Cn%5Cu4e0b%5Cu4e00%5Cu884c%5Cu5305%5Cu542b%5Cu4e00%5Cu4e2a%5Cu6574%5Cu6570m%5Cu2014%5Cu2014%5Cu8682%5Cu8681%5Cu7684%5Cu6570%5Cu91cf%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu4e0b%5Cu4e00%5Cu4e2am%5Cu884c%5Cu4e2d%5Cu7684%5Cu6bcf%5Cu4e00%5Cu884c%5Cu90fd%5Cu5305%5Cu542b%5Cu56db%5Cu4e2a%5Cu6574%5Cu6570ai%5Cu3001bi%5Cu3001ci%5Cu548cdi%5Cu3002%5Cuff08ai%5Cuff0cbi%5Cuff09%5Cu548c%5Cuff08ci%5Cuff0cdi%5Cuff09%5Cu662f%5Cu7b2ci%5Cu53ea%5Cu8682%5Cu8681%5Cu7684%5Cu6700%5Cu7231%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu5982%5Cu679c%5Cu4e0d%5Cu53ef%5Cu80fd%5Cu7684%5Cu8bdd%5Cuff0c%5Cu8f93%5Cu51fa%5Cu201cNO%5Cu201d%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu5426%5Cu5219%5Cu8f93%5Cu51fa%5Cu201cYES%5Cu201d%5Cu5e76%5Cu8f93%5Cu51fam%5Cu884c%5Cu3002%5Cu5728%5Cu7b2ci%5Cu884c%5Cuff0c%5Cu5982%5Cu679c%5Cu7b2ci%5Cu53ea%5Cu8682%5Cu8681%5Cu5c06%5Cu4f7f%5Cu7528%5Cu7b2c%5Cu4e00%5Cu4e2a%5Cu9876%5Cu70b9%5Cu5bf9%5Cuff0c%5Cu5219%5Cu8f93%5Cu51fa1%5Cuff0c%5Cu5426%5Cu5219%5Cu8f93%5Cu51fa%202%5Cu3002%5Cu5982%5Cu679c%5Cu6709%5Cu591a%5Cu4e2a%5Cu7b54%5Cu6848%5Cuff0c%5Cu8bf7%5Cu8f93%5Cu51fa%5Cu5176%5Cu4e2d%5Cu4efb%5Cu4f55%5Cu4e00%5Cu4e2a%5Cu3002%5Cr%5Cn%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A3%2C%22totalAccepted%22%3A2%2C%22pid%22%3A%22CF1007D%22%2C%22title%22%3A%22Ants%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A146368%2C%22title%22%3A%222-SAT%22%2C%22forum%22%3A%7B%22id%22%3A27254%2C%22name%22%3A%22CF1007D%20Ants%22%2C%22slug%22%3A%22CF1007D%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Ants%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Ants</h1>
<h2>题意翻译</h2>
<div>有一棵树有n个顶点。还有m只蚂蚁住在上面。每只蚂蚁都有自己的颜色。第i只蚂蚁有两个最喜欢的顶点对：（ai，bi）和（ci，di）。你需要知道是否可以用m种颜色绘制树的边，以便每个蚂蚁能在其最喜欢的一对顶点对之间行走且这条边的颜色与这只蚂蚁相同；如果可能，你需要输出每个蚂蚁行走的顶点对。
第一行输入包含为整数n（顶点数）接下来的n-1行中的每一行都包含两个整数ui和vi，说明在顶点ui和vi之间有一条边。
下一行包含一个整数m——蚂蚁的数量。
下一个m行中的每一行都包含四个整数ai、bi、ci和di。（ai，bi）和（ci，di）是第i只蚂蚁的最爱。
如果不可能的话，输出“NO”。
否则输出“YES”并输出m行。在第i行，如果第i只蚂蚁将使用第一个顶点对，则输出1，否则输出 2。如果有多个答案，请输出其中任何一个。
</div>
<h2>题目描述</h2>
<div>There is a tree with $ n $ vertices. There are also $ m $ ants living on it. Each ant has its own color. The $ i $ -th ant has two favorite pairs of vertices: ( $ a_i, b_i $ ) and ( $ c_i, d_i $ ). You need to tell if it is possible to paint the edges of the tree in $ m $ colors so that every ant will be able to walk between vertices from one of its favorite pairs using only edges of his color; if it is possible, you need to print which pair every ant should use.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains a single integer $ n $ ( $ 2 \leq n \leq 10^5 $ ) — the number of vertices.
Each of the next $ n-1 $ lines contains two integers $ u_i $ and $ v_i $ ( $ 1 \leq u_i, v_i \leq n $ ), meaning that there is an edge between vertices $ u_i $ and $ v_i $ .
The next line contains a single integer $ m $ ( $ 1 \leq m \leq 10^4 $ ) — the number of ants.
Each of the next $ m $ lines contains four integers $ a_i $ , $ b_i $ , $ c_i $ , and $ d_i $ ( $ 1 \leq a_i, b_i, c_i, d_i \leq n $ , $ a_i \neq b_i, c_i \neq d_i $ ), meaning that pairs ( $ a_i $ , $ b_i $ ) and ( $ c_i $ , $ d_i $ ) are favorite for the $ i $ -th ant.</div>
<h3>输出格式</h3>
<br />
<div>Print "NO" (without quotes) if the wanted painting is impossible.
Otherwise, print "YES" (without quotes). Print $ m $ lines. On the $ i $ -th line, print $ 1 $ if the $ i $ -th ant will use the first pair and $ 2 $ otherwise. If there are multiple answers, print any.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>6
1 2
3 1
4 1
5 2
6 2
3
2 6 3 4
1 6 6 5
1 4 5 2
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>YES
2
1
2
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>5
1 2
1 3
1 4
1 5
2
2 3 4 5
3 4 5 2
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>NO
</code></pre>
<h2>说明</h2>
<div>In the sample, the second and the third edge should be painted in the first color, the first and the fifth should be painted in the second color, and the fourth should be painted in the third color.</div>
</article>
</div>
</div>
</body>
</html>
