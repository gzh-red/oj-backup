<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Axis Walking - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573392776:2snQ2p/uiy5yuqB6NUkXD7Lk3obpcZflFJH54Bxpmyo=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%22%2C%22description%22%3A%22Iahub%20wants%20to%20meet%20his%20girlfriend%20Iahubina.%20They%20both%20live%20in%20%24%20Ox%20%24%20axis%20%28the%20horizontal%20axis%29.%20Iahub%20lives%20at%20point%200%20and%20Iahubina%20at%20point%20%24%20d%20%24%20.%5Cn%5CnIahub%20has%20%24%20n%20%24%20positive%20integers%20%24%20a_%7B1%7D%20%24%20%2C%20%24%20a_%7B2%7D%20%24%20%2C%20...%2C%20%24%20a_%7Bn%7D%20%24%20.%20The%20sum%20of%20those%20numbers%20is%20%24%20d%20%24%20.%20Suppose%20%24%20p_%7B1%7D%20%24%20%2C%20%24%20p_%7B2%7D%20%24%20%2C%20...%2C%20%24%20p_%7Bn%7D%20%24%20is%20a%20permutation%20of%20%24%20%7B1%2C2%2C...%2Cn%7D%20%24%20.%20Then%2C%20let%20%24%20b_%7B1%7D%3Da_%7Bp1%7D%20%24%20%2C%20%24%20b_%7B2%7D%3Da_%7Bp2%7D%20%24%20and%20so%20on.%20The%20array%20b%20is%20called%20a%20%5C%22route%5C%22.%20There%20are%20%24%20n%21%20%24%20different%20routes%2C%20one%20for%20each%20permutation%20%24%20p%20%24%20.%5Cn%5CnIahub%27s%20travel%20schedule%20is%3A%20he%20walks%20%24%20b_%7B1%7D%20%24%20steps%20on%20%24%20Ox%20%24%20axis%2C%20then%20he%20makes%20a%20break%20in%20point%20%24%20b_%7B1%7D%20%24%20.%20Then%2C%20he%20walks%20%24%20b_%7B2%7D%20%24%20more%20steps%20on%20%24%20Ox%20%24%20axis%20and%20makes%20a%20break%20in%20point%20%24%20b_%7B1%7D%2Bb_%7B2%7D%20%24%20.%20Similarly%2C%20at%20%24%20j%20%24%20-th%20%24%20%281%3C%3Dj%3C%3Dn%29%20%24%20time%20he%20walks%20%24%20b_%7Bj%7D%20%24%20more%20steps%20on%20%24%20Ox%20%24%20axis%20and%20makes%20a%20break%20in%20point%20%24%20b_%7B1%7D%2Bb_%7B2%7D%2B...%2Bb_%7Bj%7D%20%24%20.%5Cn%5CnIahub%20is%20very%20superstitious%20and%20has%20%24%20k%20%24%20integers%20which%20give%20him%20bad%20luck.%20He%20calls%20a%20route%20%5C%22good%5C%22%20if%20he%20never%20makes%20a%20break%20in%20a%20point%20corresponding%20to%20one%20of%20those%20%24%20k%20%24%20numbers.%20For%20his%20own%20curiosity%2C%20answer%20how%20many%20good%20routes%20he%20can%20make%2C%20modulo%20%24%201000000007%20%24%20%28%20%24%2010%5E%7B9%7D%2B7%20%24%20%29.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20an%20integer%20%24%20n%20%24%20%28%20%24%201%3C%3Dn%3C%3D24%20%24%20%29.%20The%20following%20line%20contains%20%24%20n%20%24%20integers%3A%20%24%20a_%7B1%7D%2Ca_%7B2%7D%2C...%2Ca_%7Bn%7D%20%24%20%28%20%24%201%3C%3Da_%7Bi%7D%3C%3D10%5E%7B9%7D%20%24%20%29.%5Cn%5CnThe%20third%20line%20contains%20integer%20%24%20k%20%24%20%28%20%24%200%3C%3Dk%3C%3D2%20%24%20%29.%20The%20fourth%20line%20contains%20%24%20k%20%24%20positive%20integers%2C%20representing%20the%20numbers%20that%20give%20Iahub%20bad%20luck.%20Each%20of%20these%20numbers%20does%20not%20exceed%20%24%2010%5E%7B9%7D%20%24%20.%22%2C%22outputFormat%22%3A%22Output%20a%20single%20integer%20%5Cu2014%20the%20answer%20of%20Iahub%27s%20dilemma%20modulo%20%24%201000000007%20%24%20%28%20%24%2010%5E%7B9%7D%2B7%20%24%20%29.%22%2C%22samples%22%3A%5B%5B%223%5Cn2%203%205%5Cn2%5Cn5%207%5Cn%22%2C%221%5Cn%22%5D%2C%5B%223%5Cn2%202%202%5Cn2%5Cn1%203%5Cn%22%2C%226%5Cn%22%5D%5D%2C%22hint%22%3A%22In%20the%20first%20case%20consider%20six%20possible%20orderings%3A%5Cn%5Cn-%20%5C%5C%5B2%2C%203%2C%205%5C%5C%5D.%20Iahub%20will%20stop%20at%20position%202%2C%205%20and%2010.%20Among%20them%2C%205%20is%20bad%20luck%20for%20him.%5Cn-%20%5C%5C%5B2%2C%205%2C%203%5C%5C%5D.%20Iahub%20will%20stop%20at%20position%202%2C%207%20and%2010.%20Among%20them%2C%207%20is%20bad%20luck%20for%20him.%5Cn-%20%5C%5C%5B3%2C%202%2C%205%5C%5C%5D.%20He%20will%20stop%20at%20the%20unlucky%205.%5Cn-%20%5C%5C%5B3%2C%205%2C%202%5C%5C%5D.%20This%20is%20a%20valid%20ordering.%5Cn-%20%5C%5C%5B5%2C%202%2C%203%5C%5C%5D.%20He%20got%20unlucky%20twice%20%285%20and%207%29.%5Cn-%20%5C%5C%5B5%2C%203%2C%202%5C%5C%5D.%20Iahub%20would%20reject%2C%20as%20it%20sends%20him%20to%20position%205.%5Cn%5CnIn%20the%20second%20case%2C%20note%20that%20it%20is%20possible%20that%20two%20different%20ways%20have%20the%20identical%20set%20of%20stopping.%20In%20fact%2C%20all%20six%20possible%20ways%20have%20the%20same%20stops%3A%20%5C%5C%5B2%2C%204%2C%206%5C%5C%5D%2C%20so%20there%27s%20no%20bad%20luck%20for%20Iahub.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B3000%5D%2C%22memory%22%3A%5B512000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F327%5C%2FE%22%2C%22id%22%3A%22327E%22%7D%2C%22translation%22%3A%22%5Cu7ed9%5Cu4f60%5Cu4e00%5Cu4e2a%5Cu957f%5Cu5ea6%5Cu4e3a%24n%281%3C%3Dn%3C%3D24%29%24%5Cu7684%5Cu6b63%5Cu6574%5Cu6570%5Cu5e8f%5Cu5217%24S%24%5Cuff0c%5Cu518d%5Cu6709%24k%280%3C%3Dk%3C%3D2%29%24%5Cu4e2a%5Cu6b63%5Cu6574%5Cu6570%5Cu3002%5Cn%5Cn%5Cu6c42%5Cu6709%5Cu591a%5Cu5c11%5Cu79cd%24S%24%5Cu7684%5Cu6392%5Cu5217%5Cu65b9%5Cu5f0f%5Cu4f7f%5Cu5f97%5Cu5176%5Cu524d%5Cu7f00%5Cu548c%5Cu4e0d%5Cu4f1a%5Cu6210%5Cu4e3a%5Cu90a3%24k%24%5Cu4e2a%5Cu6570%5Cu91cc%5Cu7684%5Cu4efb%5Cu610f%5Cu4e00%5Cu4e2a%5Cu3002%5Cn%5Cu7b54%5Cu6848%5Cu5bf9%241e9%2B7%24%5Cu53d6%5Cu6a21%5Cu3002%22%2C%22tags%22%3A%5B151%2C244%2C254%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A379%2C%22totalAccepted%22%3A169%2C%22pid%22%3A%22CF327E%22%2C%22title%22%3A%22Axis%20Walking%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A154941%2C%22title%22%3A%22%5Cu538b%5Cu884c%5Cu81f4CE%5Cuff1f%22%2C%22forum%22%3A%7B%22id%22%3A11325%2C%22name%22%3A%22CF327E%20Axis%20Walking%22%2C%22slug%22%3A%22CF327E%22%7D%7D%2C%7B%22id%22%3A97323%2C%22title%22%3A%22p2396A%5Cu4e86%5Cuff0c%5Cu8fd9%5Cu9898%5Cu7b2c45%5Cu4e2a%5Cu70b9wa%5Cu4e86%5Cuff0c%5Cu771f%5Cu7684%5Cu662f%5Cu540c%5Cu4e00%5Cu9898%5Cu5417%5Cuff1f%22%2C%22forum%22%3A%7B%22id%22%3A11325%2C%22name%22%3A%22CF327E%20Axis%20Walking%22%2C%22slug%22%3A%22CF327E%22%7D%7D%2C%7B%22id%22%3A84875%2C%22title%22%3A%22%5Cu53cc%5Cu500d%5Cu7ecf%5Cu9a8c%22%2C%22forum%22%3A%7B%22id%22%3A11325%2C%22name%22%3A%22CF327E%20Axis%20Walking%22%2C%22slug%22%3A%22CF327E%22%7D%7D%2C%7B%22id%22%3A64954%2C%22title%22%3A%22%5Cu7ffb%5Cu8bd1%22%2C%22forum%22%3A%7B%22id%22%3A11325%2C%22name%22%3A%22CF327E%20Axis%20Walking%22%2C%22slug%22%3A%22CF327E%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P1463%22%2C%22title%22%3A%22%5BPOI2002%5D%5BHAOI2007%5D%5Cu53cd%5Cu7d20%5Cu6570%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P2114%22%2C%22title%22%3A%22%5BNOI2014%5D%5Cu8d77%5Cu5e8a%5Cu56f0%5Cu96be%5Cu7efc%5Cu5408%5Cu75c7%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P2396%22%2C%22title%22%3A%22yyy%20loves%20Maths%20VII%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22CF895C%22%2C%22title%22%3A%22Square%20Subsets%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF11D%22%2C%22title%22%3A%22A%20Simple%20Task%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Axis%20Walking%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573295103;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Axis Walking</h1>
<h2>题意翻译</h2>
<div>给你一个长度为$n(1<=n<=24)$的正整数序列$S$，再有$k(0<=k<=2)$个正整数。
求有多少种$S$的排列方式使得其前缀和不会成为那$k$个数里的任意一个。
答案对$1e9+7$取模。</div>
<h2>题目描述</h2>
<div>Iahub wants to meet his girlfriend Iahubina. They both live in $ Ox $ axis (the horizontal axis). Iahub lives at point 0 and Iahubina at point $ d $ .
Iahub has $ n $ positive integers $ a_{1} $ , $ a_{2} $ , ..., $ a_{n} $ . The sum of those numbers is $ d $ . Suppose $ p_{1} $ , $ p_{2} $ , ..., $ p_{n} $ is a permutation of $ {1,2,...,n} $ . Then, let $ b_{1}=a_{p1} $ , $ b_{2}=a_{p2} $ and so on. The array b is called a "route". There are $ n! $ different routes, one for each permutation $ p $ .
Iahub's travel schedule is: he walks $ b_{1} $ steps on $ Ox $ axis, then he makes a break in point $ b_{1} $ . Then, he walks $ b_{2} $ more steps on $ Ox $ axis and makes a break in point $ b_{1}+b_{2} $ . Similarly, at $ j $ -th $ (1<=j<=n) $ time he walks $ b_{j} $ more steps on $ Ox $ axis and makes a break in point $ b_{1}+b_{2}+...+b_{j} $ .
Iahub is very superstitious and has $ k $ integers which give him bad luck. He calls a route "good" if he never makes a break in a point corresponding to one of those $ k $ numbers. For his own curiosity, answer how many good routes he can make, modulo $ 1000000007 $ ( $ 10^{9}+7 $ ).</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains an integer $ n $ ( $ 1<=n<=24 $ ). The following line contains $ n $ integers: $ a_{1},a_{2},...,a_{n} $ ( $ 1<=a_{i}<=10^{9} $ ).
The third line contains integer $ k $ ( $ 0<=k<=2 $ ). The fourth line contains $ k $ positive integers, representing the numbers that give Iahub bad luck. Each of these numbers does not exceed $ 10^{9} $ .</div>
<h3>输出格式</h3>
<br />
<div>Output a single integer — the answer of Iahub's dilemma modulo $ 1000000007 $ ( $ 10^{9}+7 $ ).</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>3
2 3 5
2
5 7
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>1
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>3
2 2 2
2
1 3
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>6
</code></pre>
<h2>说明</h2>
<div>In the first case consider six possible orderings:
- \[2, 3, 5\]. Iahub will stop at position 2, 5 and 10. Among them, 5 is bad luck for him.
- \[2, 5, 3\]. Iahub will stop at position 2, 7 and 10. Among them, 7 is bad luck for him.
- \[3, 2, 5\]. He will stop at the unlucky 5.
- \[3, 5, 2\]. This is a valid ordering.
- \[5, 2, 3\]. He got unlucky twice (5 and 7).
- \[5, 3, 2\]. Iahub would reject, as it sends him to position 5.
In the second case, note that it is possible that two different ways have the identical set of stopping. In fact, all six possible ways have the same stops: \[2, 4, 6\], so there's no bad luck for Iahub.</div>
</article>
</div>
</div>
</body>
</html>
