<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Greg and Friends - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573392425:sowbhCEAN1/3CYZR1kppikNOqujAkOF+vDqgHHPb50M=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%22%2C%22description%22%3A%22One%20day%20Greg%20and%20his%20friends%20were%20walking%20in%20the%20forest.%20Overall%20there%20were%20%24%20n%20%24%20people%20walking%2C%20including%20Greg.%20Soon%20he%20found%20himself%20in%20front%20of%20a%20river.%20The%20guys%20immediately%20decided%20to%20get%20across%20the%20river.%20Luckily%2C%20there%20was%20a%20boat%20by%20the%20river%20bank%2C%20just%20where%20the%20guys%20were%20standing.%20We%20know%20that%20the%20boat%20can%20hold%20people%20with%20the%20total%20weight%20of%20at%20most%20%24%20k%20%24%20kilograms.%5Cn%5CnGreg%20immediately%20took%20a%20piece%20of%20paper%20and%20listed%20there%20the%20weights%20of%20all%20people%20in%20his%20group%20%28including%20himself%29.%20It%20turned%20out%20that%20each%20person%20weights%20either%2050%20or%20100%20kilograms.%20Now%20Greg%20wants%20to%20know%20what%20minimum%20number%20of%20times%20the%20boat%20needs%20to%20cross%20the%20river%20to%20transport%20the%20whole%20group%20to%20the%20other%20bank.%20The%20boat%20needs%20at%20least%20one%20person%20to%20navigate%20it%20from%20one%20bank%20to%20the%20other.%20As%20the%20boat%20crosses%20the%20river%2C%20it%20can%20have%20any%20non-zero%20number%20of%20passengers%20as%20long%20as%20their%20total%20weight%20doesn%27t%20exceed%20%24%20k%20%24%20.%5Cn%5CnAlso%20Greg%20is%20wondering%2C%20how%20many%20ways%20there%20are%20to%20transport%20everybody%20to%20the%20other%20side%20in%20the%20minimum%20number%20of%20boat%20rides.%20Two%20ways%20are%20considered%20distinct%20if%20during%20some%20ride%20they%20have%20distinct%20sets%20of%20people%20on%20the%20boat.%5Cn%5CnHelp%20Greg%20with%20this%20problem.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20two%20integers%20%24%20n%20%24%20%2C%20%24%20k%20%24%20%24%20%281%3C%3Dn%3C%3D50%2C1%3C%3Dk%3C%3D5000%29%20%24%20%5Cu2014%20the%20number%20of%20people%2C%20including%20Greg%2C%20and%20the%20boat%27s%20weight%20limit.%20The%20next%20line%20contains%20%24%20n%20%24%20integers%20%5Cu2014%20the%20people%27s%20weights.%20A%20person%27s%20weight%20is%20either%20%24%2050%20%24%20kilos%20or%20%24%20100%20%24%20kilos.%5Cn%5CnYou%20can%20consider%20Greg%20and%20his%20friends%20indexed%20in%20some%20way.%22%2C%22outputFormat%22%3A%22In%20the%20first%20line%20print%20an%20integer%20%5Cu2014%20the%20minimum%20number%20of%20rides.%20If%20transporting%20everyone%20to%20the%20other%20bank%20is%20impossible%2C%20print%20an%20integer%20-1.%5Cn%5CnIn%20the%20second%20line%20print%20the%20remainder%20after%20dividing%20the%20number%20of%20ways%20to%20transport%20the%20people%20in%20the%20minimum%20number%20of%20rides%20by%20number%20%24%201000000007%20%24%20%24%20%2810%5E%7B9%7D%2B7%29%20%24%20.%20If%20transporting%20everyone%20to%20the%20other%20bank%20is%20impossible%2C%20print%20integer%20%24%200%20%24%20.%22%2C%22samples%22%3A%5B%5B%221%2050%5Cn50%5Cn%22%2C%221%5Cn1%5Cn%22%5D%2C%5B%223%20100%5Cn50%2050%20100%5Cn%22%2C%225%5Cn2%5Cn%22%5D%2C%5B%222%2050%5Cn50%2050%5Cn%22%2C%22-1%5Cn0%5Cn%22%5D%5D%2C%22hint%22%3A%22In%20the%20first%20test%20Greg%20walks%20alone%20and%20consequently%2C%20he%20needs%20only%20one%20ride%20across%20the%20river.%5Cn%5CnIn%20the%20second%20test%20you%20should%20follow%20the%20plan%3A%5Cn%5Cn1.%20transport%20two%20%24%2050%20%24%20kg.%20people%3B%5Cn2.%20transport%20one%20%24%2050%20%24%20kg.%20person%20back%3B%5Cn3.%20transport%20one%20%24%20100%20%24%20kg.%20person%3B%5Cn4.%20transport%20one%20%24%2050%20%24%20kg.%20person%20back%3B%5Cn5.%20transport%20two%20%24%2050%20%24%20kg.%20people.%5Cn%5CnThat%20totals%20to%20%24%205%20%24%20rides.%20Depending%20on%20which%20person%20to%20choose%20at%20step%202%2C%20we%20can%20get%20two%20distinct%20ways.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F295%5C%2FC%22%2C%22id%22%3A%22295C%22%7D%2C%22translation%22%3A%22%5Cu9898%5Cu610f%5Cn%5Cu6709%5Cu4e00%5Cu4e2a%5Cu8239%5Cu6700%5Cu591a%5Cu80fd%5Cu8f7dK%5Cu5343%5Cu514b%2C%20%5Cu73b0%5Cu5728%5Cu6709n%5Cu4e2a%5Cu4eba%5Cu8981%5Cu8fc7%5Cu6cb3%2C%20%5Cu8239%5Cu53ea%5Cu6709%5Cu4e00%5Cu6761%2C%5Cu6bcf%5Cu4e2a%5Cu4eba%5Cu8981%5Cu4e48%5Cu662f50%5Cu5343%5Cu514b%2C%5Cu8981%5Cu4e48%5Cu662f100%5Cu5343%5Cu514b%2C%5Cu95ee%5Cu6709%5Cu591a%5Cu5c11%5Cu79cd%5Cu65b9%5Cu6848%5Cu53ef%5Cu4ee5%5Cu5230%5Cu8fbe%5Cu6cb3%5Cu5bf9%5Cu5cb8%2C%5Cu4e14%5Cu6765%5Cu56de%5Cu6b21%5Cu6570%5Cu6700%5Cu5c11%3F%20%5Cu5148%5Cu8f93%5Cu51fa%5Cu6700%5Cu5c11%5Cu6765%5Cu56de%5Cu6b21%5Cu6570%2C%5Cu518d%5Cu8f93%5Cu51fa%5Cu65b9%5Cu6848%5Cu6570%2C%5Cu7ed3%5Cu679c%5Cu5bf910%5E9%2B7%5Cu53d6%5Cu6a21%20%5Cu65e0%5Cu89e3%5Cu8f93%5Cu51fa%20-1%200%5Cn%5Cn%5Cu611f%5Cu8c22%40hello_world2005%20%5Cu63d0%5Cu4f9b%5Cu7684%5Cu7ffb%5Cu8bd1%22%2C%22tags%22%3A%5B1%2C3%2C111%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A27%2C%22totalAccepted%22%3A13%2C%22pid%22%3A%22CF295C%22%2C%22title%22%3A%22Greg%20and%20Friends%22%2C%22difficulty%22%3A4%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A52063%2C%22title%22%3A%22CF295C%5Cu9898%5Cu610f%22%2C%22forum%22%3A%7B%22id%22%3A11424%2C%22name%22%3A%22CF295C%20Greg%20and%20Friends%22%2C%22slug%22%3A%22CF295C%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Greg%20and%20Friends%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Greg and Friends</h1>
<h2>题意翻译</h2>
<div>题意
有一个船最多能载K千克, 现在有n个人要过河, 船只有一条,每个人要么是50千克,要么是100千克,问有多少种方案可以到达河对岸,且来回次数最少? 先输出最少来回次数,再输出方案数,结果对10^9+7取模 无解输出 -1 0
感谢@hello_world2005 提供的翻译</div>
<h2>题目描述</h2>
<div>One day Greg and his friends were walking in the forest. Overall there were $ n $ people walking, including Greg. Soon he found himself in front of a river. The guys immediately decided to get across the river. Luckily, there was a boat by the river bank, just where the guys were standing. We know that the boat can hold people with the total weight of at most $ k $ kilograms.
Greg immediately took a piece of paper and listed there the weights of all people in his group (including himself). It turned out that each person weights either 50 or 100 kilograms. Now Greg wants to know what minimum number of times the boat needs to cross the river to transport the whole group to the other bank. The boat needs at least one person to navigate it from one bank to the other. As the boat crosses the river, it can have any non-zero number of passengers as long as their total weight doesn't exceed $ k $ .
Also Greg is wondering, how many ways there are to transport everybody to the other side in the minimum number of boat rides. Two ways are considered distinct if during some ride they have distinct sets of people on the boat.
Help Greg with this problem.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains two integers $ n $ , $ k $ $ (1<=n<=50,1<=k<=5000) $ — the number of people, including Greg, and the boat's weight limit. The next line contains $ n $ integers — the people's weights. A person's weight is either $ 50 $ kilos or $ 100 $ kilos.
You can consider Greg and his friends indexed in some way.</div>
<h3>输出格式</h3>
<br />
<div>In the first line print an integer — the minimum number of rides. If transporting everyone to the other bank is impossible, print an integer -1.
In the second line print the remainder after dividing the number of ways to transport the people in the minimum number of rides by number $ 1000000007 $ $ (10^{9}+7) $ . If transporting everyone to the other bank is impossible, print integer $ 0 $ .</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>1 50
50
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>1
1
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>3 100
50 50 100
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>5
2
</code></pre>
<h3>输入样例 #3</h3>
<pre><code>2 50
50 50
</code></pre>
<h3>输出样例 #3</h3>
<pre><code>-1
0
</code></pre>
<h2>说明</h2>
<div>In the first test Greg walks alone and consequently, he needs only one ride across the river.
In the second test you should follow the plan:
1. transport two $ 50 $ kg. people;
2. transport one $ 50 $ kg. person back;
3. transport one $ 100 $ kg. person;
4. transport one $ 50 $ kg. person back;
5. transport two $ 50 $ kg. people.
That totals to $ 5 $ rides. Depending on which person to choose at step 2, we can get two distinct ways.</div>
</article>
</div>
</div>
</body>
</html>
