<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Paint it really, really dark gray - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573397016:IP/2T7mP0ljWiNJHH3dRml4mHImvZohsZYROTYO8Qok=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22I%20see%20a%20pink%20boar%20and%20I%20want%20it%20painted%20black.%20Black%20boars%20look%20much%20more%20awesome%20and%20mighty%20than%20the%20pink%20ones.%20Since%20Jaggy%20became%20the%20ruler%20of%20the%20forest%2C%20he%20has%20been%20trying%20his%20best%20to%20improve%20the%20diplomatic%20relations%20between%20the%20forest%20region%20and%20the%20nearby%20ones.%5Cn%5CnSome%20other%20rulers%2C%20however%2C%20have%20requested%20too%20much%20in%20return%20for%20peace%20between%20their%20two%20regions%2C%20so%20he%20realized%20he%20has%20to%20resort%20to%20intimidation.%20Once%20a%20delegate%20for%20diplomatic%20relations%20of%20a%20neighboring%20region%20visits%20Jaggy%5Cu2019s%20forest%2C%20if%20they%20see%20a%20whole%20bunch%20of%20black%20boars%2C%20they%20might%20suddenly%20change%20their%20mind%20about%20attacking%20Jaggy.%20Black%20boars%20are%20really%20scary%2C%20after%20all.%5Cn%5CnJaggy%5Cu2019s%20forest%20can%20be%20represented%20as%20a%20tree%20%28connected%20graph%20without%20cycles%29%20with%20%24%20n%20%24%20vertices.%20Each%20vertex%20represents%20a%20boar%20and%20is%20colored%20either%20black%20or%20pink.%20Jaggy%20has%20sent%20a%20squirrel%20to%20travel%20through%20the%20forest%20and%20paint%20all%20the%20boars%20black.%20The%20squirrel%2C%20however%2C%20is%20quite%20unusually%20trained%20and%20while%20it%20traverses%20the%20graph%2C%20it%20changes%20the%20color%20of%20every%20vertex%20it%20visits%2C%20regardless%20of%20its%20initial%20color%3A%20pink%20vertices%20become%20black%20and%20black%20vertices%20become%20pink.%5Cn%5CnSince%20Jaggy%20is%20too%20busy%20to%20plan%20the%20squirrel%5Cu2019s%20route%2C%20he%20needs%20your%20help.%20He%20wants%20you%20to%20construct%20a%20walk%20through%20the%20tree%20starting%20from%20vertex%20%24%201%20%24%20such%20that%20in%20the%20end%20all%20vertices%20are%20black.%20A%20walk%20is%20a%20sequence%20of%20vertices%2C%20such%20that%20every%20consecutive%20pair%20has%20an%20edge%20between%20them%20in%20a%20tree.%22%2C%22inputFormat%22%3A%22The%20first%20line%20of%20input%20contains%20integer%20%24%20n%20%24%20%28%20%24%202%3C%3Dn%3C%3D200000%20%24%20%29%2C%20denoting%20the%20number%20of%20vertices%20in%20the%20tree.%20The%20following%20%24%20n%20%24%20lines%20contains%20%24%20n%20%24%20integers%2C%20which%20represent%20the%20color%20of%20the%20nodes.%5Cn%5CnIf%20the%20%24%20i%20%24%20-th%20integer%20is%20%24%201%20%24%20%2C%20if%20the%20%24%20i%20%24%20-th%20vertex%20is%20black%20and%20%24%20-1%20%24%20if%20the%20%24%20i%20%24%20-th%20vertex%20is%20pink.%5Cn%5CnEach%20of%20the%20next%20%24%20n-1%20%24%20lines%20contains%20two%20integers%2C%20which%20represent%20the%20indexes%20of%20the%20vertices%20which%20are%20connected%20by%20the%20edge.%20Vertices%20are%20numbered%20starting%20with%20%24%201%20%24%20.%22%2C%22outputFormat%22%3A%22Output%20path%20of%20a%20squirrel%3A%20output%20a%20sequence%20of%20visited%20nodes%27%20indexes%20in%20order%20of%20visiting.%20In%20case%20of%20all%20the%20nodes%20are%20initially%20black%2C%20you%20should%20print%20%24%201%20%24%20.%20Solution%20is%20guaranteed%20to%20exist.%20If%20there%20are%20multiple%20solutions%20to%20the%20problem%20you%20can%20output%20any%20of%20them%20provided%20length%20of%20sequence%20is%20not%20longer%20than%20%24%2010%5E%7B7%7D%20%24%20.%22%2C%22samples%22%3A%5B%5B%225%5Cn1%5Cn1%5Cn-1%5Cn1%5Cn-1%5Cn2%205%5Cn4%203%5Cn2%204%5Cn4%201%5Cn%22%2C%221%204%202%205%202%204%203%204%201%204%201%5Cn%22%5D%5D%2C%22hint%22%3A%22At%20the%20beginning%20squirrel%20is%20at%20node%201%20and%20its%20color%20is%20black.%20Next%20steps%20are%20as%20follows%3A%5Cn%5Cn-%20From%20node%20%24%201%20%24%20we%20walk%20to%20node%20%24%204%20%24%20and%20change%20its%20color%20to%20pink.%5Cn-%20From%20node%20%24%204%20%24%20we%20walk%20to%20node%20%24%202%20%24%20and%20change%20its%20color%20to%20pink.%5Cn-%20From%20node%20%24%202%20%24%20we%20walk%20to%20node%20%24%205%20%24%20and%20change%20its%20color%20to%20black.%5Cn-%20From%20node%20%24%205%20%24%20we%20return%20to%20node%20%24%202%20%24%20and%20change%20its%20color%20to%20black.%5Cn-%20From%20node%20%24%202%20%24%20we%20walk%20to%20node%20%24%204%20%24%20and%20change%20its%20color%20to%20black.%5Cn-%20We%20visit%20node%20%24%203%20%24%20and%20change%20its%20color%20to%20black.%5Cn-%20We%20visit%20node%20%24%204%20%24%20and%20change%20its%20color%20to%20pink.%5Cn-%20We%20visit%20node%20%24%201%20%24%20and%20change%20its%20color%20to%20pink.%5Cn-%20We%20visit%20node%20%24%204%20%24%20and%20change%20its%20color%20to%20black.%5Cn-%20We%20visit%20node%20%24%201%20%24%20and%20change%20its%20color%20to%20black.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F717%5C%2FE%22%2C%22id%22%3A%22717E%22%7D%2C%22translation%22%3A%22%23%23%23%23%20%5Cu9898%5Cu76ee%5Cu63cf%5Cu8ff0%5Cuff1a%5Cr%5Cn%5Cr%5Cn%5Cu7ed9%5Cu4f60%5Cu4e00%5Cu68f5%5Cu8282%5Cu70b9%5Cu7f16%5Cu53f7%5Cu4e3a%241...n%24%5Cu7684%5Cu6811%5Cuff0c%5Cu6bcf%5Cu4e2a%5Cu8282%5Cu70b9%5Cu90fd%5Cu6709%5Cu4e24%5Cu79cd%5Cu989c%5Cu8272%5Cuff1a%5Cu7c89%5Cu8272%5Cu6216%5Cu9ed1%5Cu8272%5Cu3002%5Cu73b0%5Cu5728%5Cu4f60%5Cu8981%5Cu4ece1%5Cu53f7%5Cu8282%5Cu70b9%5Cuff08%5Cu5373%5Cu6811%5Cu6839%5Cuff09%5Cu51fa%5Cu53d1%5Cuff0c%5Cu6bcf%5Cu7ecf%5Cu8fc7%5Cu4e00%5Cu4e2a%5Cu8282%5Cu70b9%5Cuff0c%5Cu8be5%5Cu8282%5Cu70b9%5Cu7684%5Cu989c%5Cu8272%5Cu5c31%5Cu4f1a%5Cu6539%5Cu53d8%5Cu3002%5Cuff08%5Cu7c89%5Cu8272%5Cu53d8%5Cu4e3a%5Cu9ed1%5Cu8272%5Cuff0c%5Cu9ed1%5Cu8272%5Cu53d8%5Cu4e3a%5Cu7c89%5Cu8272%5Cuff09%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu73b0%5Cu5728%5Cu8bf7%5Cu4f60%5Cu627e%5Cu51fa%5Cu4e00%5Cu6761%5Cu4ece1%5Cu53f7%5Cu8282%5Cu70b9%5Cuff08%5Cu5373%5Cu6811%5Cu6839%5Cuff09%5Cu51fa%5Cu53d1%5Cu7684%5Cu8def%5Cu5f84%5Cuff0c%5Cu4f7f%5Cu5f97%5Cu6cbf%5Cu8fd9%5Cu6761%5Cu8def%5Cu5f84%5Cu8d70%5Cu5b8c%5Cu540e%5Cuff0c%5Cu6240%5Cu6709%5Cu7684%5Cu8282%5Cu70b9%5Cu989c%5Cu8272%5Cu90fd%5Cu53d8%5Cu4e3a%5Cu9ed1%5Cu8272%5Cu3002%2A%2A%5Cu6ce8%5Cu610f%5Cuff1a%5Cu4f60%5Cu53ef%5Cu4ee5%5Cu7ecf%5Cu8fc7%5Cu4e00%5Cu4e2a%5Cu8282%5Cu70b9%5Cu6216%5Cu4e00%5Cu6761%5Cu8fb9%5Cu591a%5Cu6b21%5Cuff0c%5Cu5e76%5Cu4e14%5Cu8def%5Cu5f84%5Cu4e0d%5Cu8981%5Cu6c42%5Cu4e00%5Cu5b9a%5Cu8981%5Cu57281%5Cu53f7%5Cu8282%5Cu70b9%5Cuff08%5Cu5373%5Cu6811%5Cu6839%5Cuff09%5Cu7ed3%5Cu675f%5Cu3002%2A%2A%5Cr%5Cn%5Cr%5Cn-----------------------------%5Cr%5Cn%5Cr%5Cn%23%23%23%23%20%5Cu8f93%5Cu5165%5Cu683c%5Cu5f0f%5Cuff1a%5Cr%5Cn%5Cr%5Cn%5Cu7b2c%5Cu4e00%5Cu884c%5Cu4e00%5Cu4e2a%5Cu6b63%5Cu6574%5Cu6570%24n%24%5Cuff0c%5Cu4ee3%5Cu8868%5Cu6811%5Cu4e2d%5Cu8282%5Cu70b9%5Cu7684%5Cu6570%5Cu91cf%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu63a5%5Cu4e0b%5Cu53bb%5Cu7b2c%20%242%24%20%5Cu5230%20%24n%2B1%24%20%5Cu884c%5Cuff0c%5Cu6bcf%5Cu884c%5Cu4e00%5Cu4e2a%5Cu6574%5Cu6570%5Cuff1a%241%24%5Cu4ee3%5Cu8868%5Cu9ed1%5Cu8272%5Cuff0c%24-1%24%5Cu4ee3%5Cu8868%5Cu7c89%5Cu8272%5Cu3002%5Cu5176%5Cu4e2d%5Cu7b2c%20%24i%24%20%5Cu884c%5Cu7684%5Cu6574%5Cu6570%5Cu8868%5Cu793a%5Cu7b2c%20%24i%24%20%5Cu53f7%5Cu8282%5Cu70b9%5Cu7684%5Cu989c%5Cu8272%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu6700%5Cu540e%20%24n-1%24%20%5Cu884c%5Cuff0c%5Cu6bcf%5Cu884c%5Cu4e24%5Cu4e2a%5Cu6b63%5Cu6574%5Cu6570%20%24x%24%20%5Cuff0c%24y%24%20%5Cuff0c%5Cu8868%5Cu793a%5Cu7b2c%20%24x%24%20%5Cu53f7%5Cu8282%5Cu70b9%5Cu5230%5Cu7b2c%20%24y%24%20%5Cu53f7%5Cu8282%5Cu70b9%5Cu6709%5Cu4e00%5Cu6761%5Cu8fb9%5Cu76f8%5Cu8fde%5Cu3002%5Cr%5Cn%5Cr%5Cn%23%23%23%23%20%5Cu8f93%5Cu51fa%5Cu683c%5Cu5f0f%5Cuff1a%5Cr%5Cn%5Cr%5Cn%5Cu5171%5Cu4e00%5Cu884c%5Cuff0c%5Cu4e3a%5Cu80fd%5Cu4f7f%5Cu6240%5Cu6709%5Cu8282%5Cu70b9%5Cu53d8%5Cu4e3a%5Cu9ed1%5Cu8272%5Cu7684%5Cu8def%5Cu5f84%5Cu4e0a%5Cu7684%5Cu8282%5Cu70b9%5Cu7f16%5Cu53f7%5Cu3002%5Cu5982%5Cu679c%5Cu6811%5Cu4e2d%5Cu6240%5Cu6709%5Cu8282%5Cu70b9%5Cu5df2%5Cu7ecf%5Cu5168%5Cu4e3a%5Cu9ed1%5Cu8272%5Cuff0c%5Cu8bf7%5Cu8f93%5Cu51fa%241%24%5Cu3002%5Cu6570%5Cu636e%5Cu4fdd%5Cu8bc1%5Cu6709%5Cu4e00%5Cu6761%5Cu8fd9%5Cu6837%5Cu7684%5Cu8def%5Cu5f84%5Cu5b58%5Cu5728%5Cu3002%5Cr%5Cn%5Cr%5Cn------------------------------%5Cr%5Cn%5Cr%5Cn%2A%2A%5Cu5173%5Cu4e8e%5Cu6837%5Cu4f8b%5Cu8f93%5Cu51fa%5Cuff1a%5Cu6ce8%5Cu610f%5Cu8f93%5Cu51fa%5Cu7684%5Cu7b2c%5Cu4e00%5Cu4e2a1%5Cu53f7%5Cu8282%5Cu70b9%5Cuff0c%5Cu5b9e%5Cu9645%5Cu4e0a%5Cu6211%5Cu4eec%5Cu5e76%5Cu6ca1%5Cu6709%5Cu5c06%5Cu5176%5Cu53d8%5Cu8272%5Cu3002%5Cu771f%5Cu6b63%5Cu53d8%5Cu8272%5Cu7684%5Cu8282%5Cu70b9%5Cu4e3a%5Cu8f93%5Cu51fa%5Cu7684%5Cu7b2c%5Cu4e8c%5Cu4e2a%5Cu8282%5Cu70b9%5Cu53ca%5Cu4e4b%5Cu540e%5Cu7684%5Cu8282%5Cu70b9%5Cu3002%2A%2A%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A2%2C%22totalAccepted%22%3A1%2C%22pid%22%3A%22CF717E%22%2C%22title%22%3A%22Paint%20it%20really%2C%20really%20dark%20gray%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Paint%20it%20really%2C%20really%20dark%20gray%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Paint it really, really dark gray</h1>
<h2>题意翻译</h2>
<div>#### 题目描述：
给你一棵节点编号为$1...n$的树，每个节点都有两种颜色：粉色或黑色。现在你要从1号节点（即树根）出发，每经过一个节点，该节点的颜色就会改变。（粉色变为黑色，黑色变为粉色）。
现在请你找出一条从1号节点（即树根）出发的路径，使得沿这条路径走完后，所有的节点颜色都变为黑色。**注意：你可以经过一个节点或一条边多次，并且路径不要求一定要在1号节点（即树根）结束。**
-----------------------------
#### 输入格式：
第一行一个正整数$n$，代表树中节点的数量。
接下去第 $2$ 到 $n+1$ 行，每行一个整数：$1$代表黑色，$-1$代表粉色。其中第 $i$ 行的整数表示第 $i$ 号节点的颜色。
最后 $n-1$ 行，每行两个正整数 $x$ ，$y$ ，表示第 $x$ 号节点到第 $y$ 号节点有一条边相连。
#### 输出格式：
共一行，为能使所有节点变为黑色的路径上的节点编号。如果树中所有节点已经全为黑色，请输出$1$。数据保证有一条这样的路径存在。
------------------------------
**关于样例输出：注意输出的第一个1号节点，实际上我们并没有将其变色。真正变色的节点为输出的第二个节点及之后的节点。**</div>
<h2>题目描述</h2>
<div>I see a pink boar and I want it painted black. Black boars look much more awesome and mighty than the pink ones. Since Jaggy became the ruler of the forest, he has been trying his best to improve the diplomatic relations between the forest region and the nearby ones.
Some other rulers, however, have requested too much in return for peace between their two regions, so he realized he has to resort to intimidation. Once a delegate for diplomatic relations of a neighboring region visits Jaggy’s forest, if they see a whole bunch of black boars, they might suddenly change their mind about attacking Jaggy. Black boars are really scary, after all.
Jaggy’s forest can be represented as a tree (connected graph without cycles) with $ n $ vertices. Each vertex represents a boar and is colored either black or pink. Jaggy has sent a squirrel to travel through the forest and paint all the boars black. The squirrel, however, is quite unusually trained and while it traverses the graph, it changes the color of every vertex it visits, regardless of its initial color: pink vertices become black and black vertices become pink.
Since Jaggy is too busy to plan the squirrel’s route, he needs your help. He wants you to construct a walk through the tree starting from vertex $ 1 $ such that in the end all vertices are black. A walk is a sequence of vertices, such that every consecutive pair has an edge between them in a tree.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line of input contains integer $ n $ ( $ 2<=n<=200000 $ ), denoting the number of vertices in the tree. The following $ n $ lines contains $ n $ integers, which represent the color of the nodes.
If the $ i $ -th integer is $ 1 $ , if the $ i $ -th vertex is black and $ -1 $ if the $ i $ -th vertex is pink.
Each of the next $ n-1 $ lines contains two integers, which represent the indexes of the vertices which are connected by the edge. Vertices are numbered starting with $ 1 $ .</div>
<h3>输出格式</h3>
<br />
<div>Output path of a squirrel: output a sequence of visited nodes' indexes in order of visiting. In case of all the nodes are initially black, you should print $ 1 $ . Solution is guaranteed to exist. If there are multiple solutions to the problem you can output any of them provided length of sequence is not longer than $ 10^{7} $ .</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>5
1
1
-1
1
-1
2 5
4 3
2 4
4 1
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>1 4 2 5 2 4 3 4 1 4 1
</code></pre>
<h2>说明</h2>
<div>At the beginning squirrel is at node 1 and its color is black. Next steps are as follows:
- From node $ 1 $ we walk to node $ 4 $ and change its color to pink.
- From node $ 4 $ we walk to node $ 2 $ and change its color to pink.
- From node $ 2 $ we walk to node $ 5 $ and change its color to black.
- From node $ 5 $ we return to node $ 2 $ and change its color to black.
- From node $ 2 $ we walk to node $ 4 $ and change its color to black.
- We visit node $ 3 $ and change its color to black.
- We visit node $ 4 $ and change its color to pink.
- We visit node $ 1 $ and change its color to pink.
- We visit node $ 4 $ and change its color to black.
- We visit node $ 1 $ and change its color to black.</div>
</article>
</div>
</div>
</body>
</html>
