<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Walking! - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573395578:uwGto+2bLIEOQpa/m4DtoWYoWguppMZjQluOxDam1FQ=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22There%20is%20a%20sand%20trail%20in%20front%20of%20Alice%27s%20home.%5Cn%5CnIn%20daytime%2C%20people%20walk%20over%20it%20and%20leave%20a%20footprint%20on%20the%20trail%20for%20their%20every%20single%20step.%20Alice%20cannot%20distinguish%20the%20order%20of%20the%20footprints%2C%20but%20she%20can%20tell%20whether%20each%20footprint%20is%20made%20by%20left%20foot%20or%20right%20foot.%20Also%20she%27s%20certain%20that%20all%20people%20are%20walking%20by%20alternating%20left%20foot%20and%20right%20foot.%5Cn%5CnFor%20example%2C%20suppose%20that%20one%20person%20walked%20through%20the%20trail%20and%20left%20some%20footprints.%20The%20footprints%20are%20RRLRL%20in%20order%20along%20the%20trail%20%28%27R%27%20means%20right%20foot%20and%20%27L%27%20means%20left%20foot%29.%20You%20might%20think%20the%20outcome%20of%20the%20footprints%20is%20strange.%20But%20in%20fact%2C%20some%20steps%20are%20resulting%20from%20walking%20backwards%21%5Cn%5CnThere%20are%20some%20possible%20order%20of%20steps%20that%20produce%20these%20footprints%20such%20as%20%24%201%5Cu21923%5Cu21922%5Cu21925%5Cu21924%20%24%20or%20%24%202%5Cu21923%5Cu21924%5Cu21925%5Cu21921%20%24%20%28we%20suppose%20that%20the%20distance%20between%20two%20consecutive%20steps%20can%20be%20arbitrarily%20long%29.%20The%20number%20of%20backward%20steps%20from%20above%20two%20examples%20are%20%24%202%20%24%20and%20%24%201%20%24%20separately.%5Cn%5CnAlice%20is%20interested%20in%20these%20footprints.%20Whenever%20there%20is%20a%20person%20walking%20trough%20the%20trail%2C%20she%20takes%20a%20picture%20of%20all%20these%20footprints%20along%20the%20trail%20and%20erase%20all%20of%20them%20so%20that%20next%20person%20will%20leave%20a%20new%20set%20of%20footprints.%20We%20know%20that%20people%20walk%20by%20alternating%20right%20foot%20and%20left%20foot%2C%20but%20we%20don%27t%20know%20if%20the%20first%20step%20is%20made%20by%20left%20foot%20or%20right%20foot.%5Cn%5CnAlice%20wants%20to%20know%20the%20minimum%20possible%20number%20of%20backward%20steps%20made%20by%20a%20person.%20But%20it%27s%20a%20little%20hard.%20Please%20help%20Alice%20to%20calculate%20it.%20You%20also%20need%20to%20construct%20one%20possible%20history%20of%20these%20footprints.%22%2C%22inputFormat%22%3A%22Only%20one%20line%20containing%20the%20string%20%24%20S%20%24%20%28%20%24%201%3C%3D%7CS%7C%3C%3D100000%20%24%20%29%20containing%20all%20footprints%20in%20order%20along%20the%20trail%20from%20entrance%20to%20exit.%5Cn%5CnIt%20is%20guaranteed%20that%20there%20is%20at%20least%20one%20possible%20footprint%20history.%22%2C%22outputFormat%22%3A%22You%20should%20output%20%24%202%20%24%20lines.%5Cn%5CnThe%20first%20line%20should%20contain%20a%20number%20denoting%20the%20minimum%20number%20of%20backward%20steps.%5Cn%5CnThe%20second%20line%20should%20contain%20a%20permutation%20of%20integers%20from%201%20to%20%24%20%7CS%7C%20%24%20.%20This%20permutation%20should%20denote%20the%20order%20of%20footprints%20that%20may%20possible%20be%20used%20by%20person%20walked%20there.%5Cn%5CnIf%20there%20are%20several%20possible%20answers%2C%20you%20may%20output%20any%20of%20them.%22%2C%22samples%22%3A%5B%5B%22RRLRL%5Cn%22%2C%221%5Cn2%205%201%203%204%5Cn%22%5D%2C%5B%22RLRLRLRLR%5Cn%22%2C%220%5Cn1%202%203%204%205%206%207%208%209%5Cn%22%5D%2C%5B%22RRRRRLLLL%5Cn%22%2C%224%5Cn4%209%203%208%202%207%201%206%205%5Cn%22%5D%5D%2C%22hint%22%3A%22For%20the%20first%20sample%2C%20one%20possible%20order%20is%20%24%202%5Cu21925%5Cu21921%5Cu21923%5Cu21924%20%24%20%2C%20among%20them%20only%20the%20step%20%24%205%5Cu21921%20%24%20is%20backward%20step%20so%20the%20answer%20is%20%24%201%20%24%20.%5Cn%5CnFor%20the%20second%20example%20one%20possible%20order%20is%20just%20to%20follow%20the%20order%20of%20input%2C%20thus%20there%20are%20no%20backward%20steps.%5Cn%5CnFor%20the%20third%20sample%2C%20there%20will%20be%20%24%204%20%24%20backward%20steps%20because%20every%20step%20from%20L%20to%20R%20will%20be%20a%20backward%20step.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F578%5C%2FE%22%2C%22id%22%3A%22578E%22%7D%2C%22translation%22%3A%22%5Cu7ed9%5Cu5b9a%5Cu4e00%5Cu4e2a%5Cu957f%5Cu4e3a%24n%24%5Cu7684%5Cu8db3%5Cu8ff9%5Cu5e8f%5Cu5217%5Cuff08%5Cu53ea%5Cu5305%5Cu542b%24L%2CR%24%5Cu4e24%5Cu79cd%5Cu5b57%5Cu7b26%5Cuff09%5Cuff0c%5Cu4f60%5Cu9700%5Cu8981%24LRLRLR...%24%5Cu8fd9%5Cu6837%5Cu4ea4%5Cu66ff%5Cu5728%24L%24%5Cu548c%24R%24%5Cu4e0a%5Cu8d70%5Cuff08%5Cu7b2c%5Cu4e00%5Cu6b65%5Cu53ef%5Cu4ee5%5Cu9009%5Cu62e9%24L%24%5Cu4e5f%5Cu53ef%5Cu4ee5%5Cu9009%24R%24%5Cuff09%5Cu3002%5Cu5f53%5Cu4f60%5Cu5728%24L%24%5Cu65f6%5Cuff0c%5Cu4e0b%5Cu4e00%5Cu6b65%5Cu53ef%5Cu4ee5%5Cu8d70%5Cu5230%5Cu4efb%5Cu610f%5Cu4e00%5Cu4e2a%5Cu6ca1%5Cu8d70%5Cu8fc7%5Cu7684%24R%24%5Cuff1b%5Cu5728%24R%24%5Cu65f6%5Cuff0c%5Cu4e0b%5Cu4e00%5Cu6b65%5Cu53ef%5Cu4ee5%5Cu8d70%5Cu5230%5Cu4efb%5Cu610f%5Cu4e00%5Cu4e2a%5Cu6ca1%5Cu8d70%5Cu8fc7%5Cu7684%24L%24%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu6c42%5Cu8d70%5Cu5b8c%5Cu8fd9%5Cu4e2a%24L%2CR%24%5Cu5e8f%5Cu5217%5Cu6700%5Cu5c11%5Cu9700%5Cu8981%5Cu5f80%5Cu56de%5Cu8d70%5Cu51e0%5Cu6b21%5Cuff0c%5Cu5e76%5Cu8f93%5Cu51fa%5Cu65b9%5Cu6848%5Cuff08%5Cu5f80%5Cu56de%5Cu8d70%5Cu662f%5Cu6307%5Cu4ece%5Cu4f4d%5Cu7f6e%24i%24%5Cu8d70%5Cu5230%5Cu4f4d%5Cu7f6e%24j%24%5Cuff0c%24j%5C%5Clt%20i%24%5Cuff09%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu6570%5Cu636e%5Cu4fdd%5Cu8bc1%5Cu5b58%5Cu5728%5Cu4e00%5Cu7ec4%5Cu53ef%5Cu884c%5Cu65b9%5Cu6848%5Cuff0c%24n%5C%5Cleq10%5E5%24%5Cu3002%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A56%2C%22totalAccepted%22%3A19%2C%22pid%22%3A%22CF578E%22%2C%22title%22%3A%22Walking%21%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22CF704B%22%2C%22title%22%3A%22Ant%20Man%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF590E%22%2C%22title%22%3A%22Birthday%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF547D%22%2C%22title%22%3A%22Mike%20and%20Fish%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF504E%22%2C%22title%22%3A%22Misha%20and%20LCP%20on%20Tree%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1256A%22%2C%22title%22%3A%22Payment%20Without%20Change%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Walking%21%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Walking!</h1>
<h2>题意翻译</h2>
<div>给定一个长为$n$的足迹序列（只包含$L,R$两种字符），你需要$LRLRLR...$这样交替在$L$和$R$上走（第一步可以选择$L$也可以选$R$）。当你在$L$时，下一步可以走到任意一个没走过的$R$；在$R$时，下一步可以走到任意一个没走过的$L$。
求走完这个$L,R$序列最少需要往回走几次，并输出方案（往回走是指从位置$i$走到位置$j$，$j\lt i$）。
数据保证存在一组可行方案，$n\leq10^5$。</div>
<h2>题目描述</h2>
<div>There is a sand trail in front of Alice's home.
In daytime, people walk over it and leave a footprint on the trail for their every single step. Alice cannot distinguish the order of the footprints, but she can tell whether each footprint is made by left foot or right foot. Also she's certain that all people are walking by alternating left foot and right foot.
For example, suppose that one person walked through the trail and left some footprints. The footprints are RRLRL in order along the trail ('R' means right foot and 'L' means left foot). You might think the outcome of the footprints is strange. But in fact, some steps are resulting from walking backwards!
There are some possible order of steps that produce these footprints such as $ 1→3→2→5→4 $ or $ 2→3→4→5→1 $ (we suppose that the distance between two consecutive steps can be arbitrarily long). The number of backward steps from above two examples are $ 2 $ and $ 1 $ separately.
Alice is interested in these footprints. Whenever there is a person walking trough the trail, she takes a picture of all these footprints along the trail and erase all of them so that next person will leave a new set of footprints. We know that people walk by alternating right foot and left foot, but we don't know if the first step is made by left foot or right foot.
Alice wants to know the minimum possible number of backward steps made by a person. But it's a little hard. Please help Alice to calculate it. You also need to construct one possible history of these footprints.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>Only one line containing the string $ S $ ( $ 1<=|S|<=100000 $ ) containing all footprints in order along the trail from entrance to exit.
It is guaranteed that there is at least one possible footprint history.</div>
<h3>输出格式</h3>
<br />
<div>You should output $ 2 $ lines.
The first line should contain a number denoting the minimum number of backward steps.
The second line should contain a permutation of integers from 1 to $ |S| $ . This permutation should denote the order of footprints that may possible be used by person walked there.
If there are several possible answers, you may output any of them.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>RRLRL
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>1
2 5 1 3 4
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>RLRLRLRLR
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>0
1 2 3 4 5 6 7 8 9
</code></pre>
<h3>输入样例 #3</h3>
<pre><code>RRRRRLLLL
</code></pre>
<h3>输出样例 #3</h3>
<pre><code>4
4 9 3 8 2 7 1 6 5
</code></pre>
<h2>说明</h2>
<div>For the first sample, one possible order is $ 2→5→1→3→4 $ , among them only the step $ 5→1 $ is backward step so the answer is $ 1 $ .
For the second example one possible order is just to follow the order of input, thus there are no backward steps.
For the third sample, there will be $ 4 $ backward steps because every step from L to R will be a backward step.</div>
</article>
</div>
</div>
</body>
</html>
