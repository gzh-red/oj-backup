<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Distinct Paths - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573392397:ZyBGqxCuoipxz0vnWdlBKOugg11lAO5Y8nwvXdmHO5g=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%22%2C%22description%22%3A%22You%20have%20a%20rectangular%20%24%20n%5Cu00d7m%20%24%20-cell%20board.%20Some%20cells%20are%20already%20painted%20some%20of%20%24%20k%20%24%20colors.%20You%20need%20to%20paint%20each%20uncolored%20cell%20one%20of%20the%20%24%20k%20%24%20colors%20so%20that%20any%20path%20from%20the%20upper%20left%20square%20to%20the%20lower%20right%20one%20doesn%27t%20contain%20any%20two%20cells%20of%20the%20same%20color.%20The%20path%20can%20go%20only%20along%20side-adjacent%20cells%20and%20can%20only%20go%20down%20or%20right.%5Cn%5CnPrint%20the%20number%20of%20possible%20paintings%20modulo%20%24%201000000007%20%24%20%24%20%2810%5E%7B9%7D%2B7%29%20%24%20.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20three%20integers%20%24%20n%2Cm%2Ck%20%24%20%24%20%281%3C%3Dn%2Cm%3C%3D1000%2C1%3C%3Dk%3C%3D10%29%20%24%20.%20The%20next%20%24%20n%20%24%20lines%20contain%20%24%20m%20%24%20integers%20each%20%5Cu2014%20the%20board.%20The%20first%20of%20them%20contains%20%24%20m%20%24%20uppermost%20cells%20of%20the%20board%20from%20the%20left%20to%20the%20right%20and%20the%20second%20one%20contains%20%24%20m%20%24%20cells%20from%20the%20second%20uppermost%20row%20and%20so%20on.%20If%20a%20number%20in%20a%20line%20equals%200%2C%20then%20the%20corresponding%20cell%20isn%27t%20painted.%20Otherwise%2C%20this%20number%20represents%20the%20initial%20color%20of%20the%20board%20cell%20%5Cu2014%20an%20integer%20from%201%20to%20%24%20k%20%24%20.%5Cn%5CnConsider%20all%20colors%20numbered%20from%201%20to%20%24%20k%20%24%20in%20some%20manner.%22%2C%22outputFormat%22%3A%22Print%20the%20number%20of%20possible%20paintings%20modulo%20%24%201000000007%20%24%20%24%20%2810%5E%7B9%7D%2B7%29%20%24%20.%22%2C%22samples%22%3A%5B%5B%222%202%204%5Cn0%200%5Cn0%200%5Cn%22%2C%2248%5Cn%22%5D%2C%5B%222%202%204%5Cn1%202%5Cn2%201%5Cn%22%2C%220%5Cn%22%5D%2C%5B%225%206%2010%5Cn0%200%200%200%200%200%5Cn0%200%200%200%200%200%5Cn0%200%200%200%200%200%5Cn0%200%200%200%200%200%5Cn0%200%200%200%200%200%5Cn%22%2C%223628800%5Cn%22%5D%2C%5B%222%206%2010%5Cn1%202%203%204%205%206%5Cn0%200%200%200%200%200%5Cn%22%2C%224096%5Cn%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F293%5C%2FB%22%2C%22id%22%3A%22293B%22%7D%2C%22translation%22%3A%22%5Cu3010%5Cu95ee%5Cu9898%5Cu63cf%5Cu8ff0%5Cu3011%5Cn%5Cn%5Cu7ed9%5Cu5b9a%5Cu4e00%5Cu4e2a%20n%2Am%20%5Cu7684%5Cu77e9%5Cu5f62%5Cu8272%5Cu677f%5Cuff0c%5Cu6709%20k%20%5Cu79cd%5Cu4e0d%5Cu540c%5Cu7684%5Cu989c%5Cu6599%5Cuff0c%5Cu6709%5Cu4e9b%5Cu683c%5Cu5b50%5Cu5df2%5Cu7ecf%5Cu586b%5Cu4e0a%5Cu4e86%5Cu67d0%5Cu79cd%5Cu989c%5Cu8272%5Cuff0c%5Cu73b0%5Cu5728%20%5Cn%5Cu9700%5Cu8981%5Cu5c06%5Cu5176%5Cu4ed6%5Cu683c%5Cu5b50%5Cu4e5f%5Cu586b%5Cu4e0a%5Cu989c%5Cu8272%5Cuff0c%5Cu4f7f%5Cu5f97%5Cu4ece%5Cu5de6%5Cu4e0a%5Cu89d2%5Cu5230%5Cu53f3%5Cu4e0b%5Cu89d2%5Cu7684%5Cu4efb%5Cu610f%5Cu8def%5Cu5f84%5Cu7ecf%5Cu8fc7%5Cu7684%5Cu683c%5Cu5b50%5Cu90fd%5Cu4e0d%5Cu4f1a%5Cu51fa%5Cu73b0%5Cu4e24%5Cu79cd%20%5Cn%5Cu53ca%5Cu4ee5%5Cu4e0a%5Cu76f8%5Cu540c%5Cu7684%5Cu989c%5Cu8272%5Cu3002%5Cu8def%5Cu5f84%5Cu53ea%5Cu80fd%5Cu6cbf%5Cu7740%5Cu76f8%5Cu90bb%5Cu7684%5Cu683c%5Cu5b50%5Cuff0c%5Cu4e14%5Cu53ea%5Cu80fd%5Cu5411%5Cu4e0b%5Cu6216%5Cu8005%5Cu5411%5Cu53f3%5Cu3002%20%5Cn%5Cu8ba1%5Cu7b97%5Cu6240%5Cu6709%5Cu53ef%5Cu80fd%5Cu7684%5Cu65b9%5Cu6848%5Cuff0c%5Cu7ed3%5Cu679c%5Cu5bf9%201000000007%20%2810%5E9%20%2B%207%29%5Cu6c42%5Cu6a21%5Cu3002%5Cn%5Cn%5Cu3010%5Cu8f93%5Cu5165%5Cu6570%5Cu636e%5Cu3011%5Cn%5Cn%5Cu7b2c%5Cu4e00%5Cu884c%5Cuff0c%5Cu4e09%5Cu4e2a%5Cu6574%5Cu6570%20n%2C%20m%2C%20k%20%281%20%5Cu2264%20n%2C%20m%20%5Cu2264%201000%2C%201%20%5Cu2264%20k%20%5Cu2264%2010%29%5Cuff1b%20%5Cn%5Cu63a5%5Cu4e0b%5Cu6765%20n%20%5Cu884c%5Cuff0c%5Cu6bcf%5Cu884c%5Cu5305%5Cu542b%20m%20%5Cu4e2a%5Cu6574%5Cu6570%5Cuff0c%5Cu8868%5Cu793a%5Cu989c%5Cu8272%5Cu3002%5Cu5176%5Cu4e2d%200%20%5Cu8868%5Cu793a%5Cu672a%5Cu6d82%5Cu8272%5Cuff0c%5Cu975e%200%20%5Cu8868%5Cu793a%5Cu989c%5Cu8272%5Cu7684%5Cu7f16%5Cu53f7%5Cuff0c%20%5Cn%5Cu989c%5Cu8272%5Cu7f16%5Cu53f7%5Cu4e3a%201%20%5Cu5230%20k%5Cu3002%5Cn%5Cn%5Cu3010%5Cu8f93%5Cu51fa%5Cu6570%5Cu636e%5Cu3011%5Cn%5Cn%5Cu4e00%5Cu884c%5Cuff0c%5Cu4e00%5Cu4e2a%5Cu6574%5Cu6570%5Cuff0c%5Cu8868%5Cu793a%5Cu6d82%5Cu8272%5Cu65b9%5Cu6848%5Cu5bf9%201000000007%20%2810%5E9%20%2B%207%29%5Cu6c42%5Cu6a21%5Cu7684%5Cu7ed3%5Cu679c%5Cu3002%5Cn%5Cn%5Cu7531%20%40hicc0305%20%5Cu63d0%5Cu4f9b%5Cu7ffb%5Cu8bd1%22%2C%22tags%22%3A%5B4%2C128%2C151%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A275%2C%22totalAccepted%22%3A107%2C%22pid%22%3A%22CF293B%22%2C%22title%22%3A%22Distinct%20Paths%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A161487%2C%22title%22%3A%22%5Cu8fd9%5Cu9898%5Cu54ea%5Cu6709%5Cu90a3%5Cu4e48%5Cu96be%22%2C%22forum%22%3A%7B%22id%22%3A11435%2C%22name%22%3A%22CF293B%20Distinct%20Paths%22%2C%22slug%22%3A%22CF293B%22%7D%7D%2C%7B%22id%22%3A42013%2C%22title%22%3A%22%5Cu7ffb%5Cu8bd1%22%2C%22forum%22%3A%7B%22id%22%3A11435%2C%22name%22%3A%22CF293B%20Distinct%20Paths%22%2C%22slug%22%3A%22CF293B%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P4027%22%2C%22title%22%3A%22%5BNOI2007%5D%5Cu8d27%5Cu5e01%5Cu5151%5Cu6362%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22CF620E%22%2C%22title%22%3A%22New%20Year%20Tree%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22UVA1603%22%2C%22title%22%3A%22%5Cu7834%5Cu574f%5Cu6b63%5Cu65b9%5Cu5f62%20Square%20Destroyer%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22UVA%22%7D%2C%7B%22pid%22%3A%22P4841%22%2C%22title%22%3A%22%5Cu57ce%5Cu5e02%5Cu89c4%5Cu5212%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22CF1105E%22%2C%22title%22%3A%22Helping%20Hiasat%20%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Distinct%20Paths%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Distinct Paths</h1>
<h2>题意翻译</h2>
<div>【问题描述】
给定一个 n*m 的矩形色板，有 k 种不同的颜料，有些格子已经填上了某种颜色，现在
需要将其他格子也填上颜色，使得从左上角到右下角的任意路径经过的格子都不会出现两种
及以上相同的颜色。路径只能沿着相邻的格子，且只能向下或者向右。
计算所有可能的方案，结果对 1000000007 (10^9 + 7)求模。
【输入数据】
第一行，三个整数 n, m, k (1 ≤ n, m ≤ 1000, 1 ≤ k ≤ 10)；
接下来 n 行，每行包含 m 个整数，表示颜色。其中 0 表示未涂色，非 0 表示颜色的编号，
颜色编号为 1 到 k。
【输出数据】
一行，一个整数，表示涂色方案对 1000000007 (10^9 + 7)求模的结果。
由 @hicc0305 提供翻译</div>
<h2>题目描述</h2>
<div>You have a rectangular $ n×m $ -cell board. Some cells are already painted some of $ k $ colors. You need to paint each uncolored cell one of the $ k $ colors so that any path from the upper left square to the lower right one doesn't contain any two cells of the same color. The path can go only along side-adjacent cells and can only go down or right.
Print the number of possible paintings modulo $ 1000000007 $ $ (10^{9}+7) $ .</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains three integers $ n,m,k $ $ (1<=n,m<=1000,1<=k<=10) $ . The next $ n $ lines contain $ m $ integers each — the board. The first of them contains $ m $ uppermost cells of the board from the left to the right and the second one contains $ m $ cells from the second uppermost row and so on. If a number in a line equals 0, then the corresponding cell isn't painted. Otherwise, this number represents the initial color of the board cell — an integer from 1 to $ k $ .
Consider all colors numbered from 1 to $ k $ in some manner.</div>
<h3>输出格式</h3>
<br />
<div>Print the number of possible paintings modulo $ 1000000007 $ $ (10^{9}+7) $ .</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>2 2 4
0 0
0 0
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>48
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>2 2 4
1 2
2 1
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>0
</code></pre>
<h3>输入样例 #3</h3>
<pre><code>5 6 10
0 0 0 0 0 0
0 0 0 0 0 0
0 0 0 0 0 0
0 0 0 0 0 0
0 0 0 0 0 0
</code></pre>
<h3>输出样例 #3</h3>
<pre><code>3628800
</code></pre>
<h3>输入样例 #4</h3>
<pre><code>2 6 10
1 2 3 4 5 6
0 0 0 0 0 0
</code></pre>
<h3>输出样例 #4</h3>
<pre><code>4096
</code></pre>
</article>
</div>
</div>
</body>
</html>
