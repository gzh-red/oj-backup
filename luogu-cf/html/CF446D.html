<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>DZY Loves Games - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573394173:MlPUthnW5zt6lI1y6nwpz23+8yK95H297Cs/X1pHrDs=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Today%20DZY%20begins%20to%20play%20an%20old%20game.%20In%20this%20game%2C%20he%20is%20in%20a%20big%20maze%20with%20%24%20n%20%24%20rooms%20connected%20by%20%24%20m%20%24%20corridors%20%28each%20corridor%20allows%20to%20move%20in%20both%20directions%29.%20You%20can%20assume%20that%20all%20the%20rooms%20are%20connected%20with%20corridors%20directly%20or%20indirectly.%5Cn%5CnDZY%20has%20got%20lost%20in%20the%20maze.%20Currently%20he%20is%20in%20the%20first%20room%20and%20has%20%24%20k%20%24%20lives.%20He%20will%20act%20like%20the%20follows%3A%5Cn%5Cn-%20Firstly%20he%20will%20randomly%20pick%20one%20of%20the%20corridors%20going%20from%20his%20current%20room.%20Each%20outgoing%20corridor%20has%20the%20same%20probability%20to%20be%20picked.%5Cn-%20Then%20he%20will%20go%20through%20the%20corridor%20and%20then%20the%20process%20repeats.%5Cn%5CnThere%20are%20some%20rooms%20which%20have%20traps%20in%20them.%20The%20first%20room%20definitely%20has%20no%20trap%2C%20the%20%24%20n%20%24%20-th%20room%20definitely%20has%20a%20trap.%20Each%20time%20DZY%20enters%20one%20of%20these%20rooms%2C%20he%20will%20lost%20one%20life.%20Now%2C%20DZY%20knows%20that%20if%20he%20enters%20the%20%24%20n%20%24%20-th%20room%20with%20exactly%202%20lives%2C%20firstly%20he%20will%20lost%20one%20live%2C%20but%20then%20he%20will%20open%20a%20bonus%20round.%20He%20wants%20to%20know%20the%20probability%20for%20him%20to%20open%20the%20bonus%20round.%20Please%2C%20help%20him.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20three%20integers%20%24%20n%2Cm%2Ck%5Cu00a0%282%3C%3Dn%3C%3D500%3B%5Cu00a01%3C%3Dm%3C%3D10%5E%7B5%7D%3B%5Cu00a02%3C%3Dk%3C%3D10%5E%7B9%7D%29%20%24%20.%5Cn%5CnThe%20second%20line%20contains%20%24%20n%20%24%20integers%2C%20each%20of%20them%20is%20either%20%24%200%20%24%20or%20%24%201%20%24%20.%20If%20the%20%24%20i%20%24%20-th%20number%20is%20%24%201%20%24%20%2C%20then%20the%20%24%20i%20%24%20-th%20room%20has%20a%20trap%2C%20otherwise%20it%20has%20not%20a%20trap.%20Please%20note%2C%20that%20the%20number%20of%20rooms%20with%20a%20trap%20is%20no%20more%20than%20%24%20101%20%24%20.%20It%20is%20guaranteed%20that%20the%20first%20room%20has%20no%20trap%2C%20and%20the%20%24%20n%20%24%20-th%20room%20has%20a%20trap.%5Cn%5CnThen%20%24%20m%20%24%20lines%20follows.%20Each%20of%20them%20contains%20two%20integers%20%24%20u_%7Bi%7D%2Cv_%7Bi%7D%5Cu00a0%281%3C%3Du_%7Bi%7D%2Cv_%7Bi%7D%3C%3Dn%3B%5Cu00a0u_%7Bi%7D%5Cu2260v_%7Bi%7D%29%20%24%20%2C%20meaning%20that%20current%20corridor%20connects%20two%20rooms%20%24%20u_%7Bi%7D%20%24%20and%20%24%20v_%7Bi%7D%20%24%20.%20It%20is%20guaranteed%20that%20the%20corridor%20system%20is%20connected.%22%2C%22outputFormat%22%3A%22Print%20the%20only%20real%20number%20%5Cu2014%20the%20probability%20for%20DZY%20to%20open%20the%20bonus%20round.%20The%20answer%20will%20be%20considered%20correct%20if%20its%20relative%20or%20absolute%20error%20doesn%27t%20exceed%20%24%2010%5E%7B-4%7D%20%24%20.%22%2C%22samples%22%3A%5B%5B%225%205%203%5Cn0%200%201%200%201%5Cn1%202%5Cn2%203%5Cn3%204%5Cn4%205%5Cn1%202%5Cn%22%2C%220.25000000%5Cn%22%5D%2C%5B%223%202%202%5Cn0%201%201%5Cn1%202%5Cn2%203%5Cn%22%2C%22-0.00000000%5Cn%22%5D%2C%5B%222%201%203%5Cn0%201%5Cn1%202%5Cn%22%2C%221.00000000%5Cn%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F446%5C%2FD%22%2C%22id%22%3A%22446D%22%7D%2C%22translation%22%3A%22%23%23%20%5Cu9898%5Cu76ee%5Cu63cf%5Cu8ff0%5Cuff1a%5Cr%5CnDZY%5Cu5f00%5Cu59cb%5Cu73a9%5Cu4e00%5Cu79cd%5Cu53e4%5Cu8001%5Cu7684%5Cu6e38%5Cu620f%5Cu3002%20%5Cu5728%5Cu8fd9%5Cu4e2a%5Cu6e38%5Cu620f%5Cu4e2d%5Cuff0c%5Cu4ed6%5Cu5c06%5Cu5904%5Cu4e8e%5Cu4e00%5Cu4e2a%5Cu5de8%5Cu5927%5Cu7684%5Cu8ff7%5Cu5bab%5Cu4e2d%5Cuff0c%5Cu8ff7%5Cu5bab%5Cu4e2d%5Cu6709n%5Cu4e2a%5Cu623f%5Cu95f4%5Cuff0c%5Cu7531m%5Cu6761%5Cu8d70%5Cu5eca%5Cu76f8%5Cu8fde%5Cu63a5%5Cuff08%5Cu6bcf%5Cu4e2a%5Cu8d70%5Cu5eca%5Cu5141%5Cu8bb8%5Cu5411%5Cu4e24%5Cu4e2a%5Cu65b9%5Cu5411%5Cu79fb%5Cu52a8%5Cuff09%5Cu3002%5Cu4f60%5Cu53ef%5Cu4ee5%5Cu5047%5Cu8bbe%5Cu6240%5Cu6709%5Cu623f%5Cu95f4%5Cu90fd%5Cu76f4%5Cu63a5%5Cu6216%5Cu95f4%5Cu63a5%5Cu4e0e%5Cu8d70%5Cu5eca%5Cu76f8%5Cu8fde%5Cu3002%5Cr%5CnDZY%5Cu8ff7%5Cu5931%5Cu5728%5Cu8ff7%5Cu5bab%5Cu4e2d%5Cu3002%20%5Cu76ee%5Cu524d%5Cu4ed6%5Cu5728%5Cu7b2c%5Cu4e00%5Cu4e2a%5Cu623f%5Cu95f4%5Cuff0c%5Cu6709k%5Cu6761%5Cu547d%5Cu3002%20%5Cu4ed6%5Cu7684%5Cu884c%5Cu4e3a%5Cu5982%5Cu4e0b%5Cuff1a%5Cr%5Cn-%20%5Cu9996%5Cu5148%5Cuff0c%5Cu4ed6%5Cu5c06%5Cu968f%5Cu673a%5Cu6311%5Cu9009%5Cu4e00%5Cu6761%5Cu80fd%5Cu8d70%5Cu51fa%5Cu5f53%5Cu524d%5Cu6240%5Cu5728%5Cu623f%5Cu95f4%5Cu7684%5Cu8d70%5Cu5eca%5Cu3002%20%5Cu6bcf%5Cu4e2a%5Cu8d70%5Cu5eca%5Cu88ab%5Cu6311%5Cu9009%5Cu7684%5Cu6982%5Cu7387%5Cu76f8%5Cu540c%5Cu3002%5Cr%5Cn-%20%5Cu7136%5Cu540e%5Cuff0c%5Cu4ed6%5Cu4f1a%5Cu7a7f%5Cu8fc7%5Cu8d70%5Cu5eca%5Cuff0c%5Cu7136%5Cu540e%5Cu91cd%5Cu590d%5Cu8fd9%5Cu4e2a%5Cu8fc7%5Cu7a0b%5Cu3002%5Cr%5Cn%5Cu6709%5Cu4e9b%5Cu623f%5Cu95f4%5Cu91cc%5Cu9762%5Cu6709%5Cu9677%5Cu9631%5Cu3002%20%5Cu7b2c%5Cu4e00%5Cu4e2a%5Cu623f%5Cu95f4%5Cu80af%5Cu5b9a%5Cu6ca1%5Cu6709%5Cu9677%5Cu9631%5Cuff0c%5Cu4f46%5Cu7b2cn%5Cu4e2a%5Cu623f%5Cu95f4%5Cu80af%5Cu5b9a%5Cu6709%5Cu4e00%5Cu4e2a%5Cu9677%5Cu9631%5Cu3002%5Cr%5Cn%5Cu6bcf%5Cu5f53DZY%5Cu8fdb%5Cu5165%5Cu5176%5Cu4e2d%5Cu4e00%5Cu4e2a%5Cu623f%5Cu95f4%5Cu65f6%5Cuff0c%5Cu4ed6%5Cu5c31%5Cu4f1a%5Cu5931%5Cu53bb%5Cu4e00%5Cu6761%5Cu547d%5Cu3002%20%5Cu5982%5Cu679c%5Cu4ed6%5Cu8fdb%5Cu5165%5Cu7b2cn%5Cu4e2a%5Cu623f%5Cu95f4%5Cuff0c%5Cu53ea%5Cu67092%5Cu6761%5Cu547d%5Cu7684%5Cu8bdd%5Cuff0c%5Cu9996%5Cu5148%5Cu4ed6%5Cu5c06%5Cu5931%5Cu53bb%5Cu4e00%5Cu6761%5Cu751f%5Cu547d%5Cuff0c%5Cu4f46%5Cu968f%5Cu540e%5Cu4ed6%5Cu5c06%5Cu8fdb%5Cu5165%5Cu5956%5Cu91d1%5Cu56de%5Cu5408%5Cu3002%20%5Cu4ed6%5Cu60f3%5Cu77e5%5Cu9053%5Cu4ed6%5Cu8fdb%5Cu5165%5Cu5956%5Cu91d1%5Cu56de%5Cu5408%5Cu7684%5Cu53ef%5Cu80fd%5Cu6027%5Cu6709%5Cu591a%5Cu5927%5Cu3002%5Cr%5Cn%23%23%20%5Cu8f93%5Cu5165%5Cu8f93%5Cu51fa%5Cuff1a%5Cr%5Cn%23%23%23%20%5Cu8f93%5Cu5165%5Cu683c%5Cu5f0f%5Cuff1a%5Cr%5Cn%5Cu7b2c%5Cu4e00%5Cu884c%5Cu5305%5Cu542b%5Cu4e09%5Cu4e2a%5Cu6574%5Cu6570%20n%2Cm%2Ck%5Cuff082%3C%3Dn%3C%3D500%5Cuff1b1%3C%3Dm%3C%3D10%5E5%5Cuff1b2%3C%3Dk%3C%3D10%5E9%5Cuff09%5Cu3002%5Cr%5Cn%5Cu7b2c%5Cu4e8c%5Cu884c%5Cu5305%5Cu542b%20n%5Cu4e2a%5Cu6574%5Cu6570%5Cuff0c%5Cu90fd%5Cu662f%200%20%5Cu6216%201%20%5Cuff0c%5Cu7b2ci%5Cu4e2a%5Cu6570%5Cu4e3a%201%20%5Cu5219%5Cu4ee3%5Cu8868%5Cu7b2c%20i%20%5Cu4e2a%5Cu623f%5Cu95f4%5Cu6709%5Cu9677%5Cu9631%5Cuff0c%5Cu662f%200%20%5Cu5219%5Cu6ca1%5Cu6709%5Cu3002%5Cuff08%5Cu6709%5Cu9677%5Cu9631%5Cu7684%5Cu623f%5Cu95f4%5Cu7684%5Cu603b%5Cu6570%5Cu4e0d%5Cu8d85%5Cu8fc7%20101%20%5Cu4e2a%5Cuff09%5Cu8f93%5Cu5165%5Cu4fdd%5Cu8bc1%5Cu7b2c%201%20%5Cu4e2a%5Cu623f%5Cu95f4%5Cu65e0%5Cu9677%5Cu9631%5Cuff0c%5Cu7b2c%20n%20%5Cu4e2a%5Cu623f%5Cu95f4%5Cu6709%5Cu9677%5Cu9631%5Cr%5Cn%5Cu7136%5Cu540e%5Cu662fm%5Cu884c%5Cuff0c%5Cu6bcf%5Cu884c%5Cu6709%5Cu4e24%5Cu4e2a%5Cu6574%5Cu6570%20u%5Bi%5D%20%5Cu4e0e%20v%5Bi%5D%20%5Cuff081%3C%3Du%5Bi%5D%2Cv%5Bi%5D%3C%3Dn%20%3B%20u%5Bi%5D%5Cu2260v%5Bi%5D%5Cuff09%20%5Cu8868%5Cu793a%5Cu7b2ci%5Cu6761%5Cu8d70%5Cu5eca%5Cu8fde%5Cu63a5%5Cu4e86%5Cu623f%5Cu95f4%20u%5Bi%5D%20%5Cu4e0e%20v%5Bi%5D%20%5Cu3002%5Cu4fdd%5Cu8bc1%5Cu6574%5Cu4e2a%5Cu8d70%5Cu5eca%5Cu7cfb%5Cu7edf%5Cu662f%5Cu8fde%5Cu901a%5Cu7684%5Cu3002%5Cr%5Cn%23%23%23%20%5Cu8f93%5Cu51fa%5Cu683c%5Cu5f0f%5Cuff1a%5Cr%5Cn%5Cu53ea%5Cu8f93%5Cu51fa%5Cu4e00%5Cu4e2a%5Cu5b9e%5Cu6570%5Cuff0c%5Cu5373DZY%5Cu8fdb%5Cu5165%5Cu5956%5Cu91d1%5Cu56de%5Cu5408%5Cu7684%5Cu6982%5Cu7387%5Cuff0c%5Cu8bef%5Cu5dee%5Cu4e0d%5Cu8d85%5Cu8fc7%2010%5E-4%5Cr%5Cn%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A36%2C%22totalAccepted%22%3A14%2C%22pid%22%3A%22CF446D%22%2C%22title%22%3A%22DZY%20Loves%20Games%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A119273%2C%22title%22%3A%22%5Cu7ffb%5Cu8bd1%5Cu6709%5Cu6b67%5Cu4e49%22%2C%22forum%22%3A%7B%22id%22%3A10869%2C%22name%22%3A%22CF446D%20DZY%20Loves%20Games%22%2C%22slug%22%3A%22CF446D%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22DZY%20Loves%20Games%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>DZY Loves Games</h1>
<h2>题意翻译</h2>
<div>## 题目描述：
DZY开始玩一种古老的游戏。 在这个游戏中，他将处于一个巨大的迷宫中，迷宫中有n个房间，由m条走廊相连接（每个走廊允许向两个方向移动）。你可以假设所有房间都直接或间接与走廊相连。
DZY迷失在迷宫中。 目前他在第一个房间，有k条命。 他的行为如下：
- 首先，他将随机挑选一条能走出当前所在房间的走廊。 每个走廊被挑选的概率相同。
- 然后，他会穿过走廊，然后重复这个过程。
有些房间里面有陷阱。 第一个房间肯定没有陷阱，但第n个房间肯定有一个陷阱。
每当DZY进入其中一个房间时，他就会失去一条命。 如果他进入第n个房间，只有2条命的话，首先他将失去一条生命，但随后他将进入奖金回合。 他想知道他进入奖金回合的可能性有多大。
## 输入输出：
### 输入格式：
第一行包含三个整数 n,m,k（2<=n<=500；1<=m<=10^5；2<=k<=10^9）。
第二行包含 n个整数，都是 0 或 1 ，第i个数为 1 则代表第 i 个房间有陷阱，是 0 则没有。（有陷阱的房间的总数不超过 101 个）输入保证第 1 个房间无陷阱，第 n 个房间有陷阱
然后是m行，每行有两个整数 u[i] 与 v[i] （1<=u[i],v[i]<=n ; u[i]≠v[i]） 表示第i条走廊连接了房间 u[i] 与 v[i] 。保证整个走廊系统是连通的。
### 输出格式：
只输出一个实数，即DZY进入奖金回合的概率，误差不超过 10^-4
</div>
<h2>题目描述</h2>
<div>Today DZY begins to play an old game. In this game, he is in a big maze with $ n $ rooms connected by $ m $ corridors (each corridor allows to move in both directions). You can assume that all the rooms are connected with corridors directly or indirectly.
DZY has got lost in the maze. Currently he is in the first room and has $ k $ lives. He will act like the follows:
- Firstly he will randomly pick one of the corridors going from his current room. Each outgoing corridor has the same probability to be picked.
- Then he will go through the corridor and then the process repeats.
There are some rooms which have traps in them. The first room definitely has no trap, the $ n $ -th room definitely has a trap. Each time DZY enters one of these rooms, he will lost one life. Now, DZY knows that if he enters the $ n $ -th room with exactly 2 lives, firstly he will lost one live, but then he will open a bonus round. He wants to know the probability for him to open the bonus round. Please, help him.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains three integers $ n,m,k (2<=n<=500; 1<=m<=10^{5}; 2<=k<=10^{9}) $ .
The second line contains $ n $ integers, each of them is either $ 0 $ or $ 1 $ . If the $ i $ -th number is $ 1 $ , then the $ i $ -th room has a trap, otherwise it has not a trap. Please note, that the number of rooms with a trap is no more than $ 101 $ . It is guaranteed that the first room has no trap, and the $ n $ -th room has a trap.
Then $ m $ lines follows. Each of them contains two integers $ u_{i},v_{i} (1<=u_{i},v_{i}<=n; u_{i}≠v_{i}) $ , meaning that current corridor connects two rooms $ u_{i} $ and $ v_{i} $ . It is guaranteed that the corridor system is connected.</div>
<h3>输出格式</h3>
<br />
<div>Print the only real number — the probability for DZY to open the bonus round. The answer will be considered correct if its relative or absolute error doesn't exceed $ 10^{-4} $ .</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>5 5 3
0 0 1 0 1
1 2
2 3
3 4
4 5
1 2
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>0.25000000
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>3 2 2
0 1 1
1 2
2 3
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>-0.00000000
</code></pre>
<h3>输入样例 #3</h3>
<pre><code>2 1 3
0 1
1 2
</code></pre>
<h3>输出样例 #3</h3>
<pre><code>1.00000000
</code></pre>
</article>
</div>
</div>
</body>
</html>
