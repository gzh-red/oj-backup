<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Captains Mode - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573393419:Cj1s1mIKJX5lzheqbJRDnbpkUqGPXWibW4fRxZ1Y9ZE=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Kostya%20is%20a%20progamer%20specializing%20in%20the%20discipline%20of%20Dota%202.%20Valve%20Corporation%2C%20the%20developer%20of%20this%20game%2C%20has%20recently%20released%20a%20new%20patch%20which%20turned%20the%20balance%20of%20the%20game%20upside%20down.%20Kostya%2C%20as%20the%20captain%20of%20the%20team%2C%20realizes%20that%20the%20greatest%20responsibility%20lies%20on%20him%2C%20so%20he%20wants%20to%20resort%20to%20the%20analysis%20of%20innovations%20patch%20from%20the%20mathematical%20point%20of%20view%20to%20choose%20the%20best%20heroes%20for%20his%20team%20in%20every%20game.%5Cn%5CnA%20Dota%202%20match%20involves%20two%20teams%2C%20each%20of%20them%20must%20choose%20some%20heroes%20that%20the%20players%20of%20the%20team%20are%20going%20to%20play%20for%2C%20and%20it%20is%20forbidden%20to%20choose%20the%20same%20hero%20several%20times%2C%20even%20in%20different%20teams.%20In%20large%20electronic%20sports%20competitions%20where%20Kostya%27s%20team%20is%20going%20to%20participate%2C%20the%20matches%20are%20held%20in%20the%20Captains%20Mode.%20In%20this%20mode%20the%20captains%20select%20the%20heroes%20by%20making%20one%20of%20two%20possible%20actions%20in%20a%20certain%2C%20predetermined%20order%3A%20pick%20or%20ban.%5Cn%5Cn-%20To%20pick%20a%20hero%20for%20the%20team.%20After%20the%20captain%20picks%2C%20the%20picked%20hero%20goes%20to%20his%20team%20%28later%20one%20of%20a%20team%20members%20will%20play%20it%29%20and%20can%20no%20longer%20be%20selected%20by%20any%20of%20the%20teams.%5Cn-%20To%20ban%20a%20hero.%20After%20the%20ban%20the%20hero%20is%20not%20sent%20to%20any%20of%20the%20teams%2C%20but%20it%20still%20can%20no%20longer%20be%20selected%20by%20any%20of%20the%20teams.%5Cn%5CnThe%20team%20captain%20may%20miss%20a%20pick%20or%20a%20ban.%20If%20he%20misses%20a%20pick%2C%20a%20random%20hero%20is%20added%20to%20his%20team%20from%20those%20that%20were%20available%20at%20that%20moment%2C%20and%20if%20he%20misses%20a%20ban%2C%20no%20hero%20is%20banned%2C%20as%20if%20there%20was%20no%20ban.%5Cn%5CnKostya%20has%20already%20identified%20the%20strength%20of%20all%20the%20heroes%20based%20on%20the%20new%20patch%20fixes.%20Of%20course%2C%20Kostya%20knows%20the%20order%20of%20picks%20and%20bans.%20The%20strength%20of%20a%20team%20is%20the%20sum%20of%20the%20strengths%20of%20the%20team%27s%20heroes%20and%20both%20teams%20that%20participate%20in%20the%20match%20seek%20to%20maximize%20the%20difference%20in%20strengths%20in%20their%20favor.%20Help%20Kostya%20determine%20what%20team%2C%20the%20first%20one%20or%20the%20second%20one%2C%20has%20advantage%20in%20the%20match%2C%20and%20how%20large%20the%20advantage%20is.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20a%20single%20integer%20%24%20n%20%24%20%28%20%24%202%3C%3Dn%3C%3D100%20%24%20%29%20%5Cu2014%20the%20number%20of%20heroes%20in%20Dota%202.%5Cn%5CnThe%20second%20line%20contains%20%24%20n%20%24%20integers%20%24%20s_%7B1%7D%20%24%20%2C%20%24%20s_%7B2%7D%20%24%20%2C%20...%2C%20%24%20s_%7Bn%7D%20%24%20%28%20%24%201%3C%3Ds_%7Bi%7D%3C%3D10%5E%7B6%7D%20%24%20%29%20%5Cu2014%20the%20strengths%20of%20all%20the%20heroes.%5Cn%5CnThe%20third%20line%20contains%20a%20single%20integer%20%24%20m%20%24%20%28%20%24%202%3C%3Dm%3C%3Dmin%28n%2C20%29%20%24%20%29%20%5Cu2014%20the%20number%20of%20actions%20the%20captains%20of%20the%20team%20must%20perform.%5Cn%5CnNext%20%24%20m%20%24%20lines%20look%20like%20%5C%22%20%24%20action%5Cu00a0team%20%24%20%5C%22%2C%20where%20%24%20action%20%24%20is%20the%20needed%20action%3A%20a%20pick%20%28represented%20as%20a%20%5C%22p%5C%22%29%20or%20a%20ban%20%28represented%20as%20a%20%5C%22b%5C%22%29%2C%20and%20%24%20team%20%24%20is%20the%20number%20of%20the%20team%20that%20needs%20to%20perform%20the%20action%20%28number%20%24%201%20%24%20or%20%24%202%20%24%20%29.%5Cn%5CnIt%20is%20guaranteed%20that%20each%20team%20makes%20at%20least%20one%20pick.%20Besides%2C%20each%20team%20has%20the%20same%20number%20of%20picks%20and%20the%20same%20number%20of%20bans.%22%2C%22outputFormat%22%3A%22Print%20a%20single%20integer%20%5Cu2014%20the%20difference%20between%20the%20strength%20of%20the%20first%20team%20and%20the%20strength%20of%20the%20second%20team%20if%20the%20captains%20of%20both%20teams%20will%20act%20optimally%20well.%22%2C%22samples%22%3A%5B%5B%222%5Cn2%201%5Cn2%5Cnp%201%5Cnp%202%5Cn%22%2C%221%5Cn%22%5D%2C%5B%226%5Cn6%204%205%204%205%205%5Cn4%5Cnb%202%5Cnp%201%5Cnb%201%5Cnp%202%5Cn%22%2C%220%5Cn%22%5D%2C%5B%224%5Cn1%202%203%204%5Cn4%5Cnp%202%5Cnb%202%5Cnp%201%5Cnb%201%5Cn%22%2C%22-2%5Cn%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F377%5C%2FC%22%2C%22id%22%3A%22377C%22%7D%2C%22translation%22%3A%22%5Cu6709%5Cu4e24%5Cu4e2a%5Cu961f%5Cu5728%5Cu6e38%5Cu620fDota%202%5Cu91cc%5Cu9009%5Cu62e9%5Cu82f1%5Cu96c4%5Cu3002%5Cu6709%24n%24%5Cu4e2a%5Cu82f1%5Cu96c4%5Cuff0c%5Cu6bcf%5Cu4e2a%5Cu82f1%5Cu96c4%5Cu7684%5Cu529b%5Cu91cf%5Cu4e3a%24s_i%24%5Cu3002%5Cu4e24%5Cu4e2a%5Cu961f%5Cu4f0d%5Cu4e00%5Cu5171%5Cu8981%5Cu64cd%5Cu4f5c%24m%24%5Cu6b21%5Cu3002%5Cu64cd%5Cu4f5c%5Cu6709%5Cu4e24%5Cu79cd%5Cuff1a%5Cr%5Cn%5Cr%5Cn%5Cu64cd%5Cu4f5c%27p%27%5Cu4f1a%5Cu9009%5Cu62e9%5Cu4e00%5Cu4e2a%5Cu82f1%5Cu96c4%5Cuff0c%5Cu5e76%5Cu4e14%5Cu83b7%5Cu5f97%5Cu8be5%5Cu82f1%5Cu96c4%5Cu7684%5Cu529b%5Cu91cf%5Cu3002%5Cu9009%5Cu62e9%5Cu8fd9%5Cu4e2a%5Cu82f1%5Cu96c4%5Cu540e%5Cuff0c%5Cu8fd9%5Cu4e2a%5Cu82f1%5Cu96c4%5Cu5c31%5Cu4e0d%5Cu80fd%5Cu88ab%5Cu4efb%5Cu610f%5Cu961f%5Cu4f0d%5Cu518d%5Cu6b21%5Cu9009%5Cu62e9%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu64cd%5Cu4f5c%27b%27%5Cu4f1a%5Cu7981%5Cu7528%5Cu4e00%5Cu4e2a%5Cu82f1%5Cu96c4%5Cuff0c%5Cu7981%5Cu7528%5Cu8fd9%5Cu4e2a%5Cu82f1%5Cu96c4%5Cu540e%5Cuff0c%5Cu8fd9%5Cu4e2a%5Cu82f1%5Cu96c4%5Cu5c31%5Cu4e0d%5Cu80fd%5Cu88ab%5Cu4efb%5Cu610f%5Cu961f%5Cu4f0d%5Cu518d%5Cu6b21%5Cu9009%5Cu62e9%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu64cd%5Cu4f5c%5Cu65f6%5Cu961f%5Cu4f0d%5Cu53ef%5Cu4ee5%5Cu9009%5Cu62e9%5Cu8df3%5Cu8fc7%5Cu4e00%5Cu6b21%5Cu64cd%5Cu4f5c%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu5982%5Cu679c%5Cu8df3%5Cu8fc7%27p%27%5Cu64cd%5Cu4f5c%5Cuff0c%5Cu4e00%5Cu4e2a%5Cu968f%5Cu673a%5Cu7684%5Cu82f1%5Cu96c4%5Cu5c06%5Cu4f1a%5Cu88ab%5Cu52a0%5Cu5165%5Cu961f%5Cu4f0d%5Cuff0c%5Cu5e76%5Cu4e14%5Cu83b7%5Cu5f97%5Cu8be5%5Cu82f1%5Cu96c4%5Cu7684%5Cu529b%5Cu91cf%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu5982%5Cu679c%5Cu8df3%5Cu8fc7%27b%27%5Cu64cd%5Cu4f5c%5Cuff0c%5Cu6ca1%5Cu6709%5Cu82f1%5Cu96c4%5Cu5c06%5Cu88ab%5Cu7981%5Cu7528%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu6c42%5Cu5728%5Cu4e24%5Cu4e2a%5Cu961f%5Cu4f0d%5Cu64cd%5Cu4f5c%5Cu90fd%5Cu6700%5Cu4f18%5Cu7684%5Cu60c5%5Cu51b5%5Cu4e0b%5Cuff0c%5Cu7b2c%5Cu4e00%5Cu4e2a%5Cu961f%5Cu4f0d%5Cu7684%5Cu82f1%5Cu96c4%5Cu529b%5Cu91cf%5Cu4e4b%5Cu548c%5Cu51cf%5Cu53bb%5Cu7b2c%5Cu4e8c%5Cu4e2a%5Cu961f%5Cu4f0d%5Cu7684%5Cu82f1%5Cu96c4%5Cu529b%5Cu91cf%5Cu4e4b%5Cu548c%5Cu7684%5Cu503c%5Cu3002%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A7%2C%22totalAccepted%22%3A3%2C%22pid%22%3A%22CF377C%22%2C%22title%22%3A%22Captains%20Mode%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Captains%20Mode%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573295103;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Captains Mode</h1>
<h2>题意翻译</h2>
<div>有两个队在游戏Dota 2里选择英雄。有$n$个英雄，每个英雄的力量为$s_i$。两个队伍一共要操作$m$次。操作有两种：
操作'p'会选择一个英雄，并且获得该英雄的力量。选择这个英雄后，这个英雄就不能被任意队伍再次选择。
操作'b'会禁用一个英雄，禁用这个英雄后，这个英雄就不能被任意队伍再次选择。
操作时队伍可以选择跳过一次操作。
如果跳过'p'操作，一个随机的英雄将会被加入队伍，并且获得该英雄的力量。
如果跳过'b'操作，没有英雄将被禁用。
求在两个队伍操作都最优的情况下，第一个队伍的英雄力量之和减去第二个队伍的英雄力量之和的值。</div>
<h2>题目描述</h2>
<div>Kostya is a progamer specializing in the discipline of Dota 2. Valve Corporation, the developer of this game, has recently released a new patch which turned the balance of the game upside down. Kostya, as the captain of the team, realizes that the greatest responsibility lies on him, so he wants to resort to the analysis of innovations patch from the mathematical point of view to choose the best heroes for his team in every game.
A Dota 2 match involves two teams, each of them must choose some heroes that the players of the team are going to play for, and it is forbidden to choose the same hero several times, even in different teams. In large electronic sports competitions where Kostya's team is going to participate, the matches are held in the Captains Mode. In this mode the captains select the heroes by making one of two possible actions in a certain, predetermined order: pick or ban.
- To pick a hero for the team. After the captain picks, the picked hero goes to his team (later one of a team members will play it) and can no longer be selected by any of the teams.
- To ban a hero. After the ban the hero is not sent to any of the teams, but it still can no longer be selected by any of the teams.
The team captain may miss a pick or a ban. If he misses a pick, a random hero is added to his team from those that were available at that moment, and if he misses a ban, no hero is banned, as if there was no ban.
Kostya has already identified the strength of all the heroes based on the new patch fixes. Of course, Kostya knows the order of picks and bans. The strength of a team is the sum of the strengths of the team's heroes and both teams that participate in the match seek to maximize the difference in strengths in their favor. Help Kostya determine what team, the first one or the second one, has advantage in the match, and how large the advantage is.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains a single integer $ n $ ( $ 2<=n<=100 $ ) — the number of heroes in Dota 2.
The second line contains $ n $ integers $ s_{1} $ , $ s_{2} $ , ..., $ s_{n} $ ( $ 1<=s_{i}<=10^{6} $ ) — the strengths of all the heroes.
The third line contains a single integer $ m $ ( $ 2<=m<=min(n,20) $ ) — the number of actions the captains of the team must perform.
Next $ m $ lines look like " $ action team $ ", where $ action $ is the needed action: a pick (represented as a "p") or a ban (represented as a "b"), and $ team $ is the number of the team that needs to perform the action (number $ 1 $ or $ 2 $ ).
It is guaranteed that each team makes at least one pick. Besides, each team has the same number of picks and the same number of bans.</div>
<h3>输出格式</h3>
<br />
<div>Print a single integer — the difference between the strength of the first team and the strength of the second team if the captains of both teams will act optimally well.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>2
2 1
2
p 1
p 2
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>1
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>6
6 4 5 4 5 5
4
b 2
p 1
b 1
p 2
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>0
</code></pre>
<h3>输入样例 #3</h3>
<pre><code>4
1 2 3 4
4
p 2
b 2
p 1
b 1
</code></pre>
<h3>输出样例 #3</h3>
<pre><code>-2
</code></pre>
</article>
</div>
</div>
</body>
</html>
