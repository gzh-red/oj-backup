<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Ant on the Tree - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573390090:4W0yVngQW3kgKZsOkN7+Q0wA8efCALrHivFjLQfEbQk=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Connected%20undirected%20graph%20without%20cycles%20is%20called%20a%20tree.%20Trees%20is%20a%20class%20of%20graphs%20which%20is%20interesting%20not%20only%20for%20people%2C%20but%20for%20ants%20too.%5Cn%5CnAn%20ant%20stands%20at%20the%20root%20of%20some%20tree.%20He%20sees%20that%20there%20are%20%24%20n%20%24%20vertexes%20in%20the%20tree%2C%20and%20they%20are%20connected%20by%20%24%20n-1%20%24%20edges%20so%20that%20there%20is%20a%20path%20between%20any%20pair%20of%20vertexes.%20A%20leaf%20is%20a%20distinct%20from%20root%20vertex%2C%20which%20is%20connected%20with%20exactly%20one%20other%20vertex.%5Cn%5CnThe%20ant%20wants%20to%20visit%20every%20vertex%20in%20the%20tree%20and%20return%20to%20the%20root%2C%20passing%20every%20edge%20twice.%20In%20addition%2C%20he%20wants%20to%20visit%20the%20leaves%20in%20a%20specific%20order.%20You%20are%20to%20find%20some%20possible%20route%20of%20the%20ant.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20integer%20%24%20n%20%24%20%28%20%24%203%3C%3Dn%3C%3D300%20%24%20%29%20%5Cu2014%20amount%20of%20vertexes%20in%20the%20tree.%20Next%20%24%20n-1%20%24%20lines%20describe%20edges.%20Each%20edge%20is%20described%20with%20two%20integers%20%5Cu2014%20indexes%20of%20vertexes%20which%20it%20connects.%20Each%20edge%20can%20be%20passed%20in%20any%20direction.%20Vertexes%20are%20numbered%20starting%20from%20%24%201%20%24%20.%20The%20root%20of%20the%20tree%20has%20number%20%24%201%20%24%20.%20The%20last%20line%20contains%20%24%20k%20%24%20integers%2C%20where%20%24%20k%20%24%20is%20amount%20of%20leaves%20in%20the%20tree.%20These%20numbers%20describe%20the%20order%20in%20which%20the%20leaves%20should%20be%20visited.%20It%20is%20guaranteed%20that%20each%20leaf%20appears%20in%20this%20order%20exactly%20once.%22%2C%22outputFormat%22%3A%22If%20the%20required%20route%20doesn%27t%20exist%2C%20output%20-1.%20Otherwise%2C%20output%20%24%202n-1%20%24%20numbers%2C%20describing%20the%20route.%20Every%20time%20the%20ant%20comes%20to%20a%20vertex%2C%20output%20it%27s%20index.%22%2C%22samples%22%3A%5B%5B%223%5Cn1%202%5Cn2%203%5Cn3%5Cn%22%2C%221%202%203%202%201%20%22%5D%2C%5B%226%5Cn1%202%5Cn1%203%5Cn2%204%5Cn4%205%5Cn4%206%5Cn5%206%203%5Cn%22%2C%221%202%204%205%204%206%204%202%201%203%201%20%22%5D%2C%5B%226%5Cn1%202%5Cn1%203%5Cn2%204%5Cn4%205%5Cn4%206%5Cn5%203%206%5Cn%22%2C%22-1%5Cn%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F29%5C%2FD%22%2C%22id%22%3A%2229D%22%7D%2C%22translation%22%3A%22%5Cu65e0%5Cu73af%5Cu8fde%5Cu901a%5Cu65e0%5Cu5411%5Cu56fe%5Cu79f0%5Cu4e3a%5Cu6811%5Cu3002%5Cu6811%5Cu662f%5Cu4e00%5Cu7c7b%5Cu56fe%5Cuff0c%5Cu4e0d%5Cu4ec5%5Cu5bf9%5Cu4e8e%5Cu4eba%5Cu5f88%5Cu6709%5Cu8da3%5Cuff0c%5Cu800c%5Cu4e14%5Cu5bf9%5Cu8682%5Cu8681%5Cu4e5f%5Cu5f88%5Cu6709%5Cu8da3%5Cu3002%5Cn%5Cn%5Cu8682%5Cu8681%5Cu7ad9%5Cu5728%5Cu6811%5Cu6839%5Cu5904%5Cu3002%5Cu4ed6%5Cu53d1%5Cu73b0%5Cu6811%5Cu4e2d%5Cu6709N%5Cu4e2a%5Cu9876%5Cu70b9%5Cuff0c%5Cu5b83%5Cu4eec%5Cu7531n-1%5Cu6761%5Cu8fb9%5Cu8fde%5Cu63a5%5Cuff0c%5Cu56e0%5Cu6b64%5Cu5728%5Cu4efb%5Cu4f55%5Cu4e00%5Cu5bf9%5Cu8282%5Cu70b9%5Cu4e4b%5Cu95f4%5Cu90fd%5Cu6709%5Cu4e00%5Cu6761%5Cu8def%5Cu5f84%5Cu3002%5Cu53f6%5Cu8282%5Cu70b9%5Cu4e0e%5Cu6839%5Cu8282%5Cu70b9%5Cu4e0d%5Cu540c%5Cuff0c%5Cu5b83%5Cu53ea%5Cu4e0e%5Cu53e6%5Cu4e00%5Cu4e2a%5Cu8282%5Cu70b9%5Cu76f8%5Cu8fde%5Cu3002%5Cn%5Cn%5Cu8682%5Cu8681%5Cu60f3%5Cu8981%5Cu8bbf%5Cu95ee%5Cu6811%5Cu4e2d%5Cu7684%5Cu6bcf%5Cu4e2a%5Cu8282%5Cu70b9%5Cu5e76%5Cu8fd4%5Cu56de%5Cu5230%5Cu6839%5Cuff0c%5Cu6bcf%5Cu6761%5Cu8fb9%5Cu90fd%5Cu8981%5Cu7ecf%5Cu8fc7%5Cu4e24%5Cu6b21%5Cu3002%5Cu6b64%5Cu5916%5Cuff0c%5Cu4ed6%5Cu60f3%5Cu4ee5%5Cu7279%5Cu5b9a%5Cu7684%5Cu987a%5Cu5e8f%5Cu8bbf%5Cu95ee%5Cu8282%5Cu70b9%5Cu3002%5Cu4f60%5Cu8981%5Cu627e%5Cu5230%5Cu8682%5Cu8681%5Cu7684%5Cu53ef%5Cu80fd%5Cu8def%5Cu7ebf%5Cu3002%5Cn%5Cn%5Cn%5Cu8f93%5Cu5165%5Cuff1a%5Cn%5Cn%5Cu7b2c%5Cu4e00%5Cu884c%5Cu5305%5Cu542b%5Cu6574%5Cu6570N%5Cuff083%3C%3DN%3C%3D300%5Cuff09%5Cu4ee3%5Cu8868%5Cu6811%5Cu4e2d%5Cu7684%5Cu9876%5Cu70b9%5Cu6570%5Cu91cf%5Cu3002%5Cu63a5%5Cu4e0b%5Cu6765%5Cu7684N-1%5Cu884c%5Cu63cf%5Cu8ff0%5Cu8fb9%5Cu3002%5Cu6bcf%5Cu4e2a%5Cu8fb9%5Cu7528%5Cu4e24%5Cu4e2a%5Cu6574%5Cu6570%5Cu6765%5Cu63cf%5Cu8ff0%5Cuff0c%5Cu5373%5Cu5b83%5Cu8fde%5Cu63a5%5Cu7684%5Cu9876%5Cu70b9%5Cu7684%5Cu7f16%5Cu53f7%5Cu3002%5Cu5747%5Cu4e3a%5Cu65e0%5Cu5411%5Cu8fb9%5Cu3002%5Cu9876%5Cu70b9%5Cu4ece1%5Cu5f00%5Cu59cb%5Cu7f16%5Cu53f7%5Cuff0c1%5Cu662f%5Cu6839%5Cu8282%5Cu70b9%5Cu3002%5Cu6700%5Cu540e%5Cu4e00%5Cu884c%5Cu5305%5Cu542bk%5Cu6574%5Cu6570%5Cuff0c%5Cu5176%5Cu4e2dk%5Cu662f%5Cu6811%5Cu4e2d%5Cu53f6%5Cu5b50%5Cu7684%5Cu6570%5Cu91cf%5Cu3002%5Cu8fd9%5Cu4e9b%5Cu6570%5Cu5b57%5Cu63cf%5Cu8ff0%5Cu4e86%5Cu53f6%5Cu8282%5Cu70b9%5Cu5e94%5Cu8be5%5Cu88ab%5Cu8bbf%5Cu95ee%5Cu7684%5Cu987a%5Cu5e8f%5Cu3002%5Cu4fdd%5Cu8bc1%5Cu6bcf%5Cu4e2a%5Cu53f6%5Cu8282%5Cu70b9%5Cu53ea%5Cu51fa%5Cu73b0%5Cu4e00%5Cu6b21%5Cu3002%5Cn%5Cn%5Cu8f93%5Cu51fa%5Cuff1a%5Cn%5Cn%5Cu5982%5Cu679c%5Cu6240%5Cu9700%5Cu7684%5Cu8def%5Cu5f84%5Cu4e0d%5Cu5b58%5Cu5728%5Cuff0c%5Cu8f93%5Cu51fa-1%5Cu3002%5Cu5426%5Cu5219%5Cuff0c%5Cu8f93%5Cu51fa2N-1%5Cu4e2a%5Cu6570%5Cu5b57%5Cuff0c%5Cu63cf%5Cu8ff0%5Cu8def%5Cu5f84%5Cu3002%5Cu6bcf%5Cu6b21%5Cu8682%5Cu8681%5Cu5230%5Cu8fbe%5Cu4e00%5Cu4e2a%5Cu8282%5Cu70b9%5Cu65f6%5Cuff0c%5Cu8f93%5Cu51fa%5Cu5b83%5Cu7684%5Cu7f16%5Cu53f7%5Cu3002%5Cn%5Cn%5Cn%5Cn%5Cn%5Cn------------%5Cn%5Cu7b80%5Cu5316%5Cuff1a%5Cu7ed9%5Cu4e00%5Cu68f5%5Cu6811%5Cuff0c%5Cu6839%5Cu8282%5Cu70b9%5Cu4e3a1%5Cuff0c%5Cu8981%5Cu6c42%5Cu4ee5%5Cu7279%5Cu5b9a%5Cu987a%5Cu5e8f%5Cu904d%5Cu5386%5Cu8fd9%5Cu68f5%5Cu6811%5Cu7684%5Cu53f6%5Cu5b50%5Cu8282%5Cu70b9%5Cuff0c%5Cu5e76%5Cu987a%5Cu5e8f%5Cu8f93%5Cu51fa%5Cu5230%5Cu8fbe%5Cu7684%5Cu6bcf%5Cu4e00%5Cu4e2a%5Cu8282%5Cu70b9%5Cu3002%5Cu5982%5Cu679c%5Cu505a%5Cu4e0d%5Cu5230%5Cuff0c%5Cu8f93%5Cu51fa-1%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A93%2C%22totalAccepted%22%3A42%2C%22pid%22%3A%22CF29D%22%2C%22title%22%3A%22Ant%20on%20the%20Tree%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A51669%2C%22title%22%3A%22%5Cu7ffb%5Cu8bd1%22%2C%22forum%22%3A%7B%22id%22%3A12575%2C%22name%22%3A%22CF29D%20Ant%20on%20the%20Tree%22%2C%22slug%22%3A%22CF29D%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22CF832D%22%2C%22title%22%3A%22Misha%2C%20Grisha%20and%20Underground%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF274B%22%2C%22title%22%3A%22Zero%20Tree%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF191C%22%2C%22title%22%3A%22Fools%20and%20Roads%22%2C%22difficulty%22%3A4%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF95B%22%2C%22title%22%3A%22Lucky%20Numbers%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF3D%22%2C%22title%22%3A%22Least%20Cost%20Bracket%20Sequence%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22CF%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Ant%20on%20the%20Tree%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573295103;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Ant on the Tree</h1>
<h2>题意翻译</h2>
<div>无环连通无向图称为树。树是一类图，不仅对于人很有趣，而且对蚂蚁也很有趣。
蚂蚁站在树根处。他发现树中有N个顶点，它们由n-1条边连接，因此在任何一对节点之间都有一条路径。叶节点与根节点不同，它只与另一个节点相连。
蚂蚁想要访问树中的每个节点并返回到根，每条边都要经过两次。此外，他想以特定的顺序访问节点。你要找到蚂蚁的可能路线。
输入：
第一行包含整数N（3<=N<=300）代表树中的顶点数量。接下来的N-1行描述边。每个边用两个整数来描述，即它连接的顶点的编号。均为无向边。顶点从1开始编号，1是根节点。最后一行包含k整数，其中k是树中叶子的数量。这些数字描述了叶节点应该被访问的顺序。保证每个叶节点只出现一次。
输出：
如果所需的路径不存在，输出-1。否则，输出2N-1个数字，描述路径。每次蚂蚁到达一个节点时，输出它的编号。
------------
简化：给一棵树，根节点为1，要求以特定顺序遍历这棵树的叶子节点，并顺序输出到达的每一个节点。如果做不到，输出-1</div>
<h2>题目描述</h2>
<div>Connected undirected graph without cycles is called a tree. Trees is a class of graphs which is interesting not only for people, but for ants too.
An ant stands at the root of some tree. He sees that there are $ n $ vertexes in the tree, and they are connected by $ n-1 $ edges so that there is a path between any pair of vertexes. A leaf is a distinct from root vertex, which is connected with exactly one other vertex.
The ant wants to visit every vertex in the tree and return to the root, passing every edge twice. In addition, he wants to visit the leaves in a specific order. You are to find some possible route of the ant.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains integer $ n $ ( $ 3<=n<=300 $ ) — amount of vertexes in the tree. Next $ n-1 $ lines describe edges. Each edge is described with two integers — indexes of vertexes which it connects. Each edge can be passed in any direction. Vertexes are numbered starting from $ 1 $ . The root of the tree has number $ 1 $ . The last line contains $ k $ integers, where $ k $ is amount of leaves in the tree. These numbers describe the order in which the leaves should be visited. It is guaranteed that each leaf appears in this order exactly once.</div>
<h3>输出格式</h3>
<br />
<div>If the required route doesn't exist, output -1. Otherwise, output $ 2n-1 $ numbers, describing the route. Every time the ant comes to a vertex, output it's index.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>3
1 2
2 3
3
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>1 2 3 2 1 </code></pre>
<h3>输入样例 #2</h3>
<pre><code>6
1 2
1 3
2 4
4 5
4 6
5 6 3
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>1 2 4 5 4 6 4 2 1 3 1 </code></pre>
<h3>输入样例 #3</h3>
<pre><code>6
1 2
1 3
2 4
4 5
4 6
5 3 6
</code></pre>
<h3>输出样例 #3</h3>
<pre><code>-1
</code></pre>
</article>
</div>
</div>
</body>
</html>
