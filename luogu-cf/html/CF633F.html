<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>The Chocolate Spree - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573396260:eNIZSWkqob0bMQC0SUUrQqcvmTNIqINqkLR5DwijHaw=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Alice%20and%20Bob%20have%20a%20tree%20%28undirected%20acyclic%20connected%20graph%29.%20There%20are%20%24%20a_%7Bi%7D%20%24%20chocolates%20waiting%20to%20be%20picked%20up%20in%20the%20%24%20i%20%24%20-th%20vertex%20of%20the%20tree.%20First%2C%20they%20choose%20two%20different%20vertices%20as%20their%20starting%20positions%20%28Alice%20chooses%20first%29%20and%20take%20all%20the%20chocolates%20contained%20in%20them.%5Cn%5CnThen%2C%20they%20alternate%20their%20moves%2C%20selecting%20one%20vertex%20at%20a%20time%20and%20collecting%20all%20chocolates%20from%20this%20node.%20To%20make%20things%20more%20interesting%2C%20they%20decided%20that%20one%20can%20select%20a%20vertex%20only%20if%20he%5C%2Fshe%20selected%20a%20vertex%20adjacent%20to%20that%20one%20at%20his%5C%2Fher%20previous%20turn%20and%20this%20vertex%20has%20not%20been%20already%20chosen%20by%20any%20of%20them%20during%20other%20move.%5Cn%5CnIf%20at%20any%20moment%20one%20of%20them%20is%20not%20able%20to%20select%20the%20node%20that%20satisfy%20all%20the%20rules%2C%20he%5C%2Fshe%20will%20skip%20his%20turns%20and%20let%20the%20other%20person%20pick%20chocolates%20as%20long%20as%20he%5C%2Fshe%20can.%20This%20goes%20on%20until%20both%20of%20them%20cannot%20pick%20chocolates%20any%20further.%5Cn%5CnDue%20to%20their%20greed%20for%20chocolates%2C%20they%20want%20to%20collect%20as%20many%20chocolates%20as%20possible.%20However%2C%20as%20they%20are%20friends%20they%20only%20care%20about%20the%20total%20number%20of%20chocolates%20they%20obtain%20together.%20What%20is%20the%20maximum%20total%20number%20of%20chocolates%20they%20may%20pick%3F%22%2C%22inputFormat%22%3A%22The%20first%20line%20of%20the%20input%20contains%20the%20single%20integer%20%24%20n%20%24%20%28%20%24%202%3C%3D%20%24%20n%20%24%20%3C%3D100000%20%24%20%29%20%5Cu2014%20the%20number%20of%20vertices%20in%20the%20tree.%5Cn%5CnThe%20second%20line%20contains%20%24%20n%20%24%20integers%20%24%20a_%7Bi%7D%20%24%20%28%20%24%201%3C%3Da_%7Bi%7D%3C%3D10%5E%7B9%7D%20%24%20%29%2C%20%24%20i%20%24%20-th%20of%20these%20numbers%20stands%20for%20the%20number%20of%20chocolates%20stored%20at%20the%20node%20%24%20i%20%24%20.%5Cn%5CnThen%20follow%20%24%20n-1%20%24%20lines%20that%20describe%20the%20tree.%20Each%20of%20them%20contains%20two%20integers%20%24%20u_%7Bi%7D%20%24%20and%20%24%20v_%7Bi%7D%20%24%20%28%20%24%201%3C%3Du_%7Bi%7D%2Cv_%7Bi%7D%3C%3Dn%20%24%20%29%20%5Cu2014%20indices%20of%20vertices%20connected%20by%20the%20%24%20i%20%24%20-th%20edge.%22%2C%22outputFormat%22%3A%22Print%20the%20number%20of%20chocolates%20Alice%20and%20Bob%20can%20collect%20together%20if%20they%20behave%20optimally.%22%2C%22samples%22%3A%5B%5B%229%5Cn1%202%203%204%205%206%207%208%209%5Cn1%202%5Cn1%203%5Cn1%204%5Cn1%205%5Cn1%206%5Cn1%207%5Cn1%208%5Cn1%209%5Cn%22%2C%2225%5Cn%22%5D%2C%5B%222%5Cn20%2010%5Cn1%202%5Cn%22%2C%2230%5Cn%22%5D%5D%2C%22hint%22%3A%22In%20the%20first%20sample%2C%20Alice%20may%20start%20at%20the%20vertex%20%24%209%20%24%20and%20Bob%20at%20vertex%20%24%208%20%24%20.%20Alice%20will%20select%20vertex%20%24%201%20%24%20and%20Bob%20has%20no%20options%20now.%20Alice%20selects%20the%20vertex%20%24%207%20%24%20and%20they%20both%20stop.%5Cn%5CnIn%20the%20second%20sample%2C%20both%20of%20them%20will%20pick%20either%20of%20the%20nodes%20alternately.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F633%5C%2FF%22%2C%22id%22%3A%22633F%22%7D%2C%22translation%22%3A%22%5Cu7ed9%5Cu51fa%5Cu4e00%5Cu68f5%5Cu6811%5Cuff0c%5Cu6bcf%5Cu4e2a%5Cu8282%5Cu70b9%5Cu6709%5Cu4e00%5Cu4e2a%5Cu6743%5Cu503c%5Cuff0c%5Cu6c42%5Cu51fa%5Cu4e0d%5Cu76f8%5Cu4ea4%5Cu7684%5Cu4e24%5Cu6761%5Cu94fe%5Cu7684%5Cu6700%5Cu5927%5Cu6743%5Cu503c%5Cu548c%5Cu3002%22%2C%22tags%22%3A%5B3%2C111%2C127%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A134%2C%22totalAccepted%22%3A61%2C%22pid%22%3A%22CF633F%22%2C%22title%22%3A%22The%20Chocolate%20Spree%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P3444%22%2C%22title%22%3A%22%5BPOI2006%5DORK-Ploughing%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22CF891C%22%2C%22title%22%3A%22Envy%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF797F%22%2C%22title%22%3A%22Mice%20and%20Holes%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF442D%22%2C%22title%22%3A%22Adam%20and%20Tree%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1245F%22%2C%22title%22%3A%22Daniel%20and%20Spring%20Cleaning%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22The%20Chocolate%20Spree%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573306449;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>The Chocolate Spree</h1>
<h2>题意翻译</h2>
<div>给出一棵树，每个节点有一个权值，求出不相交的两条链的最大权值和。</div>
<h2>题目描述</h2>
<div>Alice and Bob have a tree (undirected acyclic connected graph). There are $ a_{i} $ chocolates waiting to be picked up in the $ i $ -th vertex of the tree. First, they choose two different vertices as their starting positions (Alice chooses first) and take all the chocolates contained in them.
Then, they alternate their moves, selecting one vertex at a time and collecting all chocolates from this node. To make things more interesting, they decided that one can select a vertex only if he/she selected a vertex adjacent to that one at his/her previous turn and this vertex has not been already chosen by any of them during other move.
If at any moment one of them is not able to select the node that satisfy all the rules, he/she will skip his turns and let the other person pick chocolates as long as he/she can. This goes on until both of them cannot pick chocolates any further.
Due to their greed for chocolates, they want to collect as many chocolates as possible. However, as they are friends they only care about the total number of chocolates they obtain together. What is the maximum total number of chocolates they may pick?</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line of the input contains the single integer $ n $ ( $ 2<= $ n $ <=100000 $ ) — the number of vertices in the tree.
The second line contains $ n $ integers $ a_{i} $ ( $ 1<=a_{i}<=10^{9} $ ), $ i $ -th of these numbers stands for the number of chocolates stored at the node $ i $ .
Then follow $ n-1 $ lines that describe the tree. Each of them contains two integers $ u_{i} $ and $ v_{i} $ ( $ 1<=u_{i},v_{i}<=n $ ) — indices of vertices connected by the $ i $ -th edge.</div>
<h3>输出格式</h3>
<br />
<div>Print the number of chocolates Alice and Bob can collect together if they behave optimally.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>9
1 2 3 4 5 6 7 8 9
1 2
1 3
1 4
1 5
1 6
1 7
1 8
1 9
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>25
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>2
20 10
1 2
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>30
</code></pre>
<h2>说明</h2>
<div>In the first sample, Alice may start at the vertex $ 9 $ and Bob at vertex $ 8 $ . Alice will select vertex $ 1 $ and Bob has no options now. Alice selects the vertex $ 7 $ and they both stop.
In the second sample, both of them will pick either of the nodes alternately.</div>
</article>
</div>
</div>
</body>
</html>
