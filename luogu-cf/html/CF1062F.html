<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Upgrading Cities - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573401128:ydDkm0hvZxhH2wXbann63YLsq121IjPUIkaEOE/ioNs=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22There%20are%20%24%20n%20%24%20cities%20in%20the%20kingdom%20%24%20X%20%24%20%2C%20numbered%20from%20%24%201%20%24%20through%20%24%20n%20%24%20.%20People%20travel%20between%20cities%20by%20some%20one-way%20roads.%20As%20a%20passenger%2C%20JATC%20finds%20it%20weird%20that%20from%20any%20city%20%24%20u%20%24%20%2C%20he%20can%27t%20start%20a%20trip%20in%20it%20and%20then%20return%20back%20to%20it%20using%20the%20roads%20of%20the%20kingdom.%20That%20is%2C%20the%20kingdom%20can%20be%20viewed%20as%20an%20acyclic%20graph.%5Cn%5CnBeing%20annoyed%20by%20the%20traveling%20system%2C%20JATC%20decides%20to%20meet%20the%20king%20and%20ask%20him%20to%20do%20something.%20In%20response%2C%20the%20king%20says%20that%20he%20will%20upgrade%20some%20cities%20to%20make%20it%20easier%20to%20travel.%20Because%20of%20the%20budget%2C%20the%20king%20will%20only%20upgrade%20those%20cities%20that%20are%20important%20or%20semi-important.%20A%20city%20%24%20u%20%24%20is%20called%20important%20if%20for%20every%20city%20%24%20v%20%5C%5Cneq%20u%20%24%20%2C%20there%20is%20either%20a%20path%20from%20%24%20u%20%24%20to%20%24%20v%20%24%20or%20a%20path%20from%20%24%20v%20%24%20to%20%24%20u%20%24%20.%20A%20city%20%24%20u%20%24%20is%20called%20semi-important%20if%20it%20is%20not%20important%20and%20we%20can%20destroy%20exactly%20one%20city%20%24%20v%20%5C%5Cneq%20u%20%24%20so%20that%20%24%20u%20%24%20becomes%20important.%5Cn%5CnThe%20king%20will%20start%20to%20act%20as%20soon%20as%20he%20finds%20out%20all%20those%20cities.%20Please%20help%20him%20to%20speed%20up%20the%20process.%22%2C%22inputFormat%22%3A%22The%20first%20line%20of%20the%20input%20contains%20two%20integers%20%24%20n%20%24%20and%20%24%20m%20%24%20%28%20%24%202%20%5C%5Cle%20n%20%5C%5Cle%20300%5C%5C%2C000%20%24%20%2C%20%24%201%20%5C%5Cle%20m%20%5C%5Cle%20300%5C%5C%2C000%20%24%20%29%20%5Cu2014%20the%20number%20of%20cities%20and%20the%20number%20of%20one-way%20roads.%5Cn%5CnNext%20%24%20m%20%24%20lines%20describe%20the%20road%20system%20of%20the%20kingdom.%20Each%20of%20them%20contains%20two%20integers%20%24%20u_i%20%24%20and%20%24%20v_i%20%24%20%28%20%24%201%20%5C%5Cle%20u_i%2C%20v_i%20%5C%5Cle%20n%20%24%20%2C%20%24%20u_i%20%5C%5Cneq%20v_i%20%24%20%29%2C%20denoting%20one-way%20road%20from%20%24%20u_i%20%24%20to%20%24%20v_i%20%24%20.%5Cn%5CnIt%20is%20guaranteed%2C%20that%20the%20kingdoms%27%20roads%20make%20an%20acyclic%20graph%2C%20which%20doesn%27t%20contain%20multiple%20edges%20and%20self-loops.%22%2C%22outputFormat%22%3A%22Print%20a%20single%20integer%20%5Cu2014%20the%20number%20of%20cities%20that%20the%20king%20has%20to%20upgrade.%22%2C%22samples%22%3A%5B%5B%227%207%5Cn1%202%5Cn2%203%5Cn3%204%5Cn4%207%5Cn2%205%5Cn5%204%5Cn6%204%5Cn%22%2C%224%22%5D%2C%5B%226%207%5Cn1%202%5Cn2%203%5Cn3%204%5Cn1%205%5Cn5%203%5Cn2%206%5Cn6%204%5Cn%22%2C%224%22%5D%5D%2C%22hint%22%3A%22In%20the%20first%20example%3A%5Cn%5Cn%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF1062F%5C%2F2b311b0e26aa0adf06c45b2f7b136f0365691de2.png%29-%20Starting%20at%20the%20city%20%24%201%20%24%20we%20can%20reach%20all%20the%20other%20cities%2C%20except%20for%20the%20city%20%24%206%20%24%20.%20Also%2C%20from%20the%20city%20%24%206%20%24%20we%20cannot%20reach%20the%20city%20%24%201%20%24%20.%20Therefore%2C%20if%20we%20destroy%20the%20city%20%24%206%20%24%20then%20the%20city%20%24%201%20%24%20will%20become%20important.%20So%20%24%201%20%24%20is%20a%20semi-important%20city.%5Cn-%20For%20city%20%24%202%20%24%20%2C%20the%20set%20of%20cities%20that%20cannot%20reach%20%24%202%20%24%20and%20cannot%20be%20reached%20by%20%24%202%20%24%20is%20%24%20%5C%5C%7B6%5C%5C%7D%20%24%20.%20Therefore%2C%20destroying%20city%20%24%206%20%24%20will%20make%20the%20city%20%24%202%20%24%20important.%20So%20city%20%24%202%20%24%20is%20also%20semi-important.%5Cn-%20For%20city%20%24%203%20%24%20%2C%20the%20set%20is%20%24%20%5C%5C%7B5%2C%206%5C%5C%7D%20%24%20.%20As%20you%20can%20see%2C%20destroying%20either%20city%20%24%205%20%24%20or%20%24%206%20%24%20will%20not%20make%20the%20city%20%24%203%20%24%20important.%20Therefore%2C%20it%20is%20neither%20important%20nor%20semi-important.%5Cn-%20For%20city%20%24%204%20%24%20%2C%20the%20set%20is%20empty.%20So%20%24%204%20%24%20is%20an%20important%20city.%5Cn-%20The%20set%20for%20city%20%24%205%20%24%20is%20%24%20%5C%5C%7B3%2C%206%5C%5C%7D%20%24%20and%20the%20set%20for%20city%20%24%206%20%24%20is%20%24%20%5C%5C%7B3%2C%205%5C%5C%7D%20%24%20.%20Similarly%20to%20city%20%24%203%20%24%20%2C%20both%20of%20them%20are%20not%20important%20nor%20semi-important.%5Cn-%20The%20city%20%24%207%20%24%20is%20important%20since%20we%20can%20reach%20it%20from%20all%20other%20cities.%5Cn%5Cn%20So%20we%20have%20two%20important%20cities%20%28%20%24%204%20%24%20and%20%24%207%20%24%20%29%20and%20two%20semi-important%20cities%20%28%20%24%201%20%24%20and%20%24%202%20%24%20%29.In%20the%20second%20example%2C%20the%20important%20cities%20are%20%24%201%20%24%20and%20%24%204%20%24%20.%20The%20semi-important%20cities%20are%20%24%202%20%24%20and%20%24%203%20%24%20.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F1062%5C%2FF%22%2C%22id%22%3A%221062F%22%7D%2C%22translation%22%3A%22%5Cu7ed9%5Cu5b9a%5Cu4e00%5Cu5f20%5Cu6709%5Cu5411%5Cu65e0%5Cu73af%5Cu56fe%5Cuff0c%5Cu5b9a%5Cu4e49%5Cu91cd%5Cu8981%5Cu7684%5Cu8282%5Cu70b9%24x%24%5Cu4e3a%5Cu6ee1%5Cu8db3%5Cu4e0d%5Cu5b58%5Cu5728%5Cu4e00%5Cu4e2a%5Cu8282%5Cu70b9%24y%24%5Cuff0c%5Cu4f7f%5Cu5f97%5Cu65e2%5Cu4e0d%5Cu80fd%5Cu4ece%24x%24%5Cu5230%24y%24%5Cuff0c%5Cu4e5f%5Cu4e0d%5Cu80fd%5Cu4ece%24y%24%5Cu5230%24x%24%5Cu7684%5Cu8282%5Cu70b9%5Cuff0c%5Cu6b21%5Cu91cd%5Cu8981%5Cu7684%5Cu8282%5Cu70b9%5Cu4e3a%5Cu5220%5Cu9664%5Cu67d0%5Cu4e2a%5Cu8282%5Cu70b9%5Cu540e%5Cu80fd%5Cu6ee1%5Cu8db3%5Cu4e0a%5Cu9762%5Cu6761%5Cu4ef6%5Cu7684%5Cu8282%5Cu70b9%5Cuff08%5Cu4e0d%5Cu5305%5Cu62ec%5Cu91cd%5Cu8981%5Cu7684%5Cu8282%5Cu70b9%5Cuff09%5Cuff0c%5Cu6c42%5Cu91cd%5Cu8981%5Cu7684%5Cu8282%5Cu70b9%5Cu548c%5Cu6b21%5Cu91cd%5Cu8981%5Cu7684%5Cu8282%5Cu70b9%5Cu4e00%5Cu5171%5Cu6709%5Cu591a%5Cu5c11%5Cu4e2a%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu8f93%5Cu5165%5Cuff1a%5Cu7b2c%5Cu4e00%5Cu884c%5Cu4e24%5Cu4e2a%5Cu6574%5Cu6570%24n%2Cm%24%5Cu8868%5Cu793a%5Cu8282%5Cu70b9%5Cu4e2a%5Cu6570%5Cu548c%5Cu8fb9%5Cu7684%5Cu6761%5Cu6570%5Cuff0c%5Cu63a5%5Cu4e0b%5Cu6765%24m%24%5Cu884c%5Cu5206%5Cu522b%5Cu4e3a%5Cu6bcf%5Cu6761%5Cu8fb9%5Cr%5Cn%5Cr%5Cn%5Cu8f93%5Cu51fa%5Cuff1a%5Cu4e00%5Cu884c%5Cuff0c%5Cu5373%5Cu91cd%5Cu8981%5Cu7684%5Cu8282%5Cu70b9%5Cu548c%5Cu6b21%5Cu91cd%5Cu8981%5Cu7684%5Cu8282%5Cu70b9%5Cu7684%5Cu4e2a%5Cu6570%5Cu548c%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A26%2C%22totalAccepted%22%3A16%2C%22pid%22%3A%22CF1062F%22%2C%22title%22%3A%22Upgrading%20Cities%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A127887%2C%22title%22%3A%22%5Cu6765%5Cu8ba8%5Cu8bba%5Cu554a%22%2C%22forum%22%3A%7B%22id%22%3A31970%2C%22name%22%3A%22CF1062F%20Upgrading%20Cities%22%2C%22slug%22%3A%22CF1062F%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Upgrading%20Cities%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Upgrading Cities</h1>
<h2>题意翻译</h2>
<div>给定一张有向无环图，定义重要的节点$x$为满足不存在一个节点$y$，使得既不能从$x$到$y$，也不能从$y$到$x$的节点，次重要的节点为删除某个节点后能满足上面条件的节点（不包括重要的节点），求重要的节点和次重要的节点一共有多少个。
输入：第一行两个整数$n,m$表示节点个数和边的条数，接下来$m$行分别为每条边
输出：一行，即重要的节点和次重要的节点的个数和</div>
<h2>题目描述</h2>
<div>There are $ n $ cities in the kingdom $ X $ , numbered from $ 1 $ through $ n $ . People travel between cities by some one-way roads. As a passenger, JATC finds it weird that from any city $ u $ , he can't start a trip in it and then return back to it using the roads of the kingdom. That is, the kingdom can be viewed as an acyclic graph.
Being annoyed by the traveling system, JATC decides to meet the king and ask him to do something. In response, the king says that he will upgrade some cities to make it easier to travel. Because of the budget, the king will only upgrade those cities that are important or semi-important. A city $ u $ is called important if for every city $ v \neq u $ , there is either a path from $ u $ to $ v $ or a path from $ v $ to $ u $ . A city $ u $ is called semi-important if it is not important and we can destroy exactly one city $ v \neq u $ so that $ u $ becomes important.
The king will start to act as soon as he finds out all those cities. Please help him to speed up the process.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line of the input contains two integers $ n $ and $ m $ ( $ 2 \le n \le 300\,000 $ , $ 1 \le m \le 300\,000 $ ) — the number of cities and the number of one-way roads.
Next $ m $ lines describe the road system of the kingdom. Each of them contains two integers $ u_i $ and $ v_i $ ( $ 1 \le u_i, v_i \le n $ , $ u_i \neq v_i $ ), denoting one-way road from $ u_i $ to $ v_i $ .
It is guaranteed, that the kingdoms' roads make an acyclic graph, which doesn't contain multiple edges and self-loops.</div>
<h3>输出格式</h3>
<br />
<div>Print a single integer — the number of cities that the king has to upgrade.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>7 7
1 2
2 3
3 4
4 7
2 5
5 4
6 4
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>4</code></pre>
<h3>输入样例 #2</h3>
<pre><code>6 7
1 2
2 3
3 4
1 5
5 3
2 6
6 4
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>4</code></pre>
<h2>说明</h2>
<div>In the first example:
![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1062F/2b311b0e26aa0adf06c45b2f7b136f0365691de2.png)- Starting at the city $ 1 $ we can reach all the other cities, except for the city $ 6 $ . Also, from the city $ 6 $ we cannot reach the city $ 1 $ . Therefore, if we destroy the city $ 6 $ then the city $ 1 $ will become important. So $ 1 $ is a semi-important city.
- For city $ 2 $ , the set of cities that cannot reach $ 2 $ and cannot be reached by $ 2 $ is $ \{6\} $ . Therefore, destroying city $ 6 $ will make the city $ 2 $ important. So city $ 2 $ is also semi-important.
- For city $ 3 $ , the set is $ \{5, 6\} $ . As you can see, destroying either city $ 5 $ or $ 6 $ will not make the city $ 3 $ important. Therefore, it is neither important nor semi-important.
- For city $ 4 $ , the set is empty. So $ 4 $ is an important city.
- The set for city $ 5 $ is $ \{3, 6\} $ and the set for city $ 6 $ is $ \{3, 5\} $ . Similarly to city $ 3 $ , both of them are not important nor semi-important.
- The city $ 7 $ is important since we can reach it from all other cities.
So we have two important cities ( $ 4 $ and $ 7 $ ) and two semi-important cities ( $ 1 $ and $ 2 $ ).In the second example, the important cities are $ 1 $ and $ 4 $ . The semi-important cities are $ 2 $ and $ 3 $ .</div>
</article>
</div>
</div>
</body>
</html>
