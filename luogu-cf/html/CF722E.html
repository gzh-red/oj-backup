<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Research Rover - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573397090:jT5EAEGlAOiYXe/4snCW0UIwiyy5c7u1zKWrdIP6jMQ=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Unfortunately%2C%20the%20formal%20description%20of%20the%20task%20turned%20out%20to%20be%20too%20long%2C%20so%20here%20is%20the%20legend.%5Cn%5CnResearch%20rover%20finally%20reached%20the%20surface%20of%20Mars%20and%20is%20ready%20to%20complete%20its%20mission.%20Unfortunately%2C%20due%20to%20the%20mistake%20in%20the%20navigation%20system%20design%2C%20the%20rover%20is%20located%20in%20the%20wrong%20place.%5Cn%5CnThe%20rover%20will%20operate%20on%20the%20grid%20consisting%20of%20%24%20n%20%24%20rows%20and%20%24%20m%20%24%20columns.%20We%20will%20define%20as%20%24%20%28r%2Cc%29%20%24%20the%20cell%20located%20in%20the%20row%20%24%20r%20%24%20and%20column%20%24%20c%20%24%20.%20From%20each%20cell%20the%20rover%20is%20able%20to%20move%20to%20any%20cell%20that%20share%20a%20side%20with%20the%20current%20one.%5Cn%5CnThe%20rover%20is%20currently%20located%20at%20cell%20%24%20%281%2C1%29%20%24%20and%20has%20to%20move%20to%20the%20cell%20%24%20%28n%2Cm%29%20%24%20.%20It%20will%20randomly%20follow%20some%20shortest%20path%20between%20these%20two%20cells.%20Each%20possible%20way%20is%20chosen%20equiprobably.%5Cn%5CnThe%20cargo%20section%20of%20the%20rover%20contains%20the%20battery%20required%20to%20conduct%20the%20research.%20Initially%2C%20the%20battery%20charge%20is%20equal%20to%20%24%20s%20%24%20units%20of%20energy.%5Cn%5CnSome%20of%20the%20cells%20contain%20anomaly.%20Each%20time%20the%20rover%20gets%20to%20the%20cell%20with%20anomaly%2C%20the%20battery%20looses%20half%20of%20its%20charge%20rounded%20down.%20Formally%2C%20if%20the%20charge%20was%20equal%20to%20%24%20x%20%24%20before%20the%20rover%20gets%20to%20the%20cell%20with%20anomaly%2C%20the%20charge%20will%20change%20to%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF722E%5C%2F5e007d05e4d6f2ed51d5f62962d41cc3679ff923.png%29.%5Cn%5CnWhile%20the%20rover%20picks%20a%20random%20shortest%20path%20to%20proceed%2C%20compute%20the%20expected%20value%20of%20the%20battery%20charge%20after%20it%20reaches%20cell%20%24%20%28n%2Cm%29%20%24%20.%20If%20the%20cells%20%24%20%281%2C1%29%20%24%20and%20%24%20%28n%2Cm%29%20%24%20contain%20anomaly%2C%20they%20also%20affect%20the%20charge%20of%20the%20battery.%22%2C%22inputFormat%22%3A%22The%20first%20line%20of%20the%20input%20contains%20four%20integers%20%24%20n%20%24%20%2C%20%24%20m%20%24%20%2C%20%24%20k%20%24%20and%20%24%20s%20%24%20%28%20%24%201%3C%3Dn%2Cm%3C%3D100000%20%24%20%2C%20%24%200%3C%3Dk%3C%3D2000%20%24%20%2C%20%24%201%3C%3Ds%3C%3D1000000%20%24%20%29%20%5Cu2014%20the%20number%20of%20rows%20and%20columns%20of%20the%20field%2C%20the%20number%20of%20cells%20with%20anomaly%20and%20the%20initial%20charge%20of%20the%20battery%20respectively.%5Cn%5CnThe%20follow%20%24%20k%20%24%20lines%20containing%20two%20integers%20%24%20r_%7Bi%7D%20%24%20and%20%24%20c_%7Bi%7D%20%24%20%28%20%24%201%3C%3Dr_%7Bi%7D%3C%3Dn%20%24%20%2C%20%24%201%3C%3Dc_%7Bi%7D%3C%3Dm%20%24%20%29%20%5Cu2014%20coordinates%20of%20the%20cells%2C%20containing%20anomaly.%20It%27s%20guaranteed%20that%20each%20cell%20appears%20in%20this%20list%20no%20more%20than%20once.%22%2C%22outputFormat%22%3A%22The%20answer%20can%20always%20be%20represented%20as%20an%20irreducible%20fraction%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF722E%5C%2F00f1f3a9533210841fcc58db3ebf06c253f3f34f.png%29.%20Print%20the%20only%20integer%20%24%20P%5Cu00b7Q%5E%7B-1%7D%20%24%20modulo%20%24%2010%5E%7B9%7D%2B7%20%24%20.%22%2C%22samples%22%3A%5B%5B%223%203%202%2011%5Cn2%201%5Cn2%203%5Cn%22%2C%22333333342%5Cn%22%5D%2C%5B%224%205%203%2017%5Cn1%202%5Cn3%203%5Cn4%201%5Cn%22%2C%22514285727%5Cn%22%5D%2C%5B%221%206%202%2015%5Cn1%201%5Cn1%205%5Cn%22%2C%224%5Cn%22%5D%5D%2C%22hint%22%3A%22In%20the%20first%20sample%2C%20the%20rover%20picks%20one%20of%20the%20following%20six%20routes%3A%5Cn%5Cn1.%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF722E%5C%2F9ec03018ca0f56c6c2f6d978bba5abe354af00a2.png%29%2C%20after%20passing%20cell%20%24%20%282%2C3%29%20%24%20charge%20is%20equal%20to%20%24%206%20%24%20.%5Cn2.%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF722E%5C%2Fc33021a457ac8c5bc889f817a80d61835c80a6b0.png%29%2C%20after%20passing%20cell%20%24%20%282%2C3%29%20%24%20charge%20is%20equal%20to%20%24%206%20%24%20.%5Cn3.%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF722E%5C%2Ff31c3021594dce78e1218b41ad36645544e3eb2f.png%29%2C%20charge%20remains%20unchanged%20and%20equals%20%24%2011%20%24%20.%5Cn4.%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF722E%5C%2Fd616d340616d474f1cf131e388bc97ff077c00fd.png%29%2C%20after%20passing%20cells%20%24%20%282%2C1%29%20%24%20and%20%24%20%282%2C3%29%20%24%20charge%20equals%20%24%206%20%24%20and%20then%20%24%203%20%24%20.%5Cn5.%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF722E%5C%2F58b582f83e30271c9a15562ebd2f560f6b5dd797.png%29%2C%20after%20passing%20cell%20%24%20%282%2C1%29%20%24%20charge%20is%20equal%20to%20%24%206%20%24%20.%5Cn6.%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF722E%5C%2F856271589dd61834f189db966542ee9a7b753d25.png%29%2C%20after%20passing%20cell%20%24%20%282%2C1%29%20%24%20charge%20is%20equal%20to%20%24%206%20%24%20.%5Cn%5CnExpected%20value%20of%20the%20battery%20charge%20is%20calculated%20by%20the%20following%20formula%3A%5Cn%5Cn%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF722E%5C%2F56e29a53ed442392bc44fee422ffcf414eab5cce.png%29.%5Cn%5CnThus%20%24%20P%3D19%20%24%20%2C%20and%20%24%20Q%3D3%20%24%20.%5Cn%5Cn%20%24%203%5E%7B-1%7D%20%24%20modulo%20%24%2010%5E%7B9%7D%2B7%20%24%20equals%20%24%20333333336%20%24%20.%5Cn%5Cn%20%24%2019%5Cu00b7333333336%3D333333342%5Cu00a0%28mod%5Cu00a010%5E%7B9%7D%2B7%29%20%24%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2500%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F722%5C%2FE%22%2C%22id%22%3A%22722E%22%7D%2C%22translation%22%3A%22%5Cu6709%5Cu4e00%5Cu4e2an%2Am%5Cu7684%5Cu7f51%5Cu683c%5Cu56fe%5Cuff0c%5Cu56fe%5Cu4e2d%5Cu6709k%5Cu4e2a%5Cu7279%5Cu6b8a%5Cu70b9%5Cu3002%5Cr%5Cn%5Cu521d%5Cu59cb%5Cu65f6%5Cu4f60%5Cu6709%5Cu4e00%5Cu4e2a%5Cu6743%5Cu503cs%5Cuff0c%5Cu5e76%5Cu4e14%5Cu53ea%5Cu80fd%5Cu5411%5Cu4e0b%5Cu6216%5Cu5411%5Cu53f3%5Cu8d70%5Cuff0c%5Cr%5Cn%5Cu6bcf%5Cu7ecf%5Cu8fc7%5Cu4e00%5Cu4e2a%5Cu7279%5Cu6b8a%5Cu70b9%5Cu4f1a%5Cu4f7f%5Cu5f97%5Cu4f60%5Cu7684%5Cu6743%5Cu503c%5C%2F2%28%5Cu5411%5Cu4e0a%5Cu53d6%5Cu6574%29%5Cu3002%5Cr%5Cn%5Cu6c42%5Cu4ece%281%2C1%29%5Cu8d70%5Cu5230%28n%2Cm%29%5Cu65f6%5Cu62e5%5Cu6709%5Cu6743%5Cu503c%5Cu7684%5Cu671f%5Cu671b%28mod%201e9%2B7%29%5Cu3002%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A69%2C%22totalAccepted%22%3A34%2C%22pid%22%3A%22CF722E%22%2C%22title%22%3A%22Research%20Rover%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P2885%22%2C%22title%22%3A%22%5BUSACO07NOV%5D%5Cu7535%5Cu8bdd%5Cu7ebfTelephone%20Wire%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P2939%22%2C%22title%22%3A%22%5BUSACO09FEB%5D%5Cu6539%5Cu9020%5Cu8defRevamping%20Trails%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22CF814E%22%2C%22title%22%3A%22An%20unavoidable%20detour%20for%20home%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF712D%22%2C%22title%22%3A%22Memory%20and%20Scores%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF570E%22%2C%22title%22%3A%22Pig%20and%20Palindromes%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22CF%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Research%20Rover%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Research Rover</h1>
<h2>题意翻译</h2>
<div>有一个n*m的网格图，图中有k个特殊点。
初始时你有一个权值s，并且只能向下或向右走，
每经过一个特殊点会使得你的权值/2(向上取整)。
求从(1,1)走到(n,m)时拥有权值的期望(mod 1e9+7)。</div>
<h2>题目描述</h2>
<div>Unfortunately, the formal description of the task turned out to be too long, so here is the legend.
Research rover finally reached the surface of Mars and is ready to complete its mission. Unfortunately, due to the mistake in the navigation system design, the rover is located in the wrong place.
The rover will operate on the grid consisting of $ n $ rows and $ m $ columns. We will define as $ (r,c) $ the cell located in the row $ r $ and column $ c $ . From each cell the rover is able to move to any cell that share a side with the current one.
The rover is currently located at cell $ (1,1) $ and has to move to the cell $ (n,m) $ . It will randomly follow some shortest path between these two cells. Each possible way is chosen equiprobably.
The cargo section of the rover contains the battery required to conduct the research. Initially, the battery charge is equal to $ s $ units of energy.
Some of the cells contain anomaly. Each time the rover gets to the cell with anomaly, the battery looses half of its charge rounded down. Formally, if the charge was equal to $ x $ before the rover gets to the cell with anomaly, the charge will change to ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF722E/5e007d05e4d6f2ed51d5f62962d41cc3679ff923.png).
While the rover picks a random shortest path to proceed, compute the expected value of the battery charge after it reaches cell $ (n,m) $ . If the cells $ (1,1) $ and $ (n,m) $ contain anomaly, they also affect the charge of the battery.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line of the input contains four integers $ n $ , $ m $ , $ k $ and $ s $ ( $ 1<=n,m<=100000 $ , $ 0<=k<=2000 $ , $ 1<=s<=1000000 $ ) — the number of rows and columns of the field, the number of cells with anomaly and the initial charge of the battery respectively.
The follow $ k $ lines containing two integers $ r_{i} $ and $ c_{i} $ ( $ 1<=r_{i}<=n $ , $ 1<=c_{i}<=m $ ) — coordinates of the cells, containing anomaly. It's guaranteed that each cell appears in this list no more than once.</div>
<h3>输出格式</h3>
<br />
<div>The answer can always be represented as an irreducible fraction ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF722E/00f1f3a9533210841fcc58db3ebf06c253f3f34f.png). Print the only integer $ P·Q^{-1} $ modulo $ 10^{9}+7 $ .</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>3 3 2 11
2 1
2 3
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>333333342
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>4 5 3 17
1 2
3 3
4 1
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>514285727
</code></pre>
<h3>输入样例 #3</h3>
<pre><code>1 6 2 15
1 1
1 5
</code></pre>
<h3>输出样例 #3</h3>
<pre><code>4
</code></pre>
<h2>说明</h2>
<div>In the first sample, the rover picks one of the following six routes:
1. ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF722E/9ec03018ca0f56c6c2f6d978bba5abe354af00a2.png), after passing cell $ (2,3) $ charge is equal to $ 6 $ .
2. ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF722E/c33021a457ac8c5bc889f817a80d61835c80a6b0.png), after passing cell $ (2,3) $ charge is equal to $ 6 $ .
3. ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF722E/f31c3021594dce78e1218b41ad36645544e3eb2f.png), charge remains unchanged and equals $ 11 $ .
4. ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF722E/d616d340616d474f1cf131e388bc97ff077c00fd.png), after passing cells $ (2,1) $ and $ (2,3) $ charge equals $ 6 $ and then $ 3 $ .
5. ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF722E/58b582f83e30271c9a15562ebd2f560f6b5dd797.png), after passing cell $ (2,1) $ charge is equal to $ 6 $ .
6. ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF722E/856271589dd61834f189db966542ee9a7b753d25.png), after passing cell $ (2,1) $ charge is equal to $ 6 $ .
Expected value of the battery charge is calculated by the following formula:
![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF722E/56e29a53ed442392bc44fee422ffcf414eab5cce.png).
Thus $ P=19 $ , and $ Q=3 $ .
$ 3^{-1} $ modulo $ 10^{9}+7 $ equals $ 333333336 $ .
$ 19·333333336=333333342 (mod 10^{9}+7) $</div>
</article>
</div>
</div>
</body>
</html>
