<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Pollywog - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573399383:OV/3+z59y+AhMsDzta9W2c35s8F5ipeimweG9meilvU=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%22%2C%22description%22%3A%22As%20we%20all%20know%2C%20Dart%20is%20some%20kind%20of%20creature%20from%20Upside%20Down%20world.%20For%20simplicity%2C%20we%20call%20their%20kind%20pollywogs.%20Dart%20and%20%24%20x-1%20%24%20other%20pollywogs%20are%20playing%20a%20game.%20There%20are%20%24%20n%20%24%20stones%20in%20a%20row%2C%20numbered%20from%20%24%201%20%24%20through%20%24%20n%20%24%20from%20left%20to%20right.%20At%20most%20%24%201%20%24%20pollywog%20may%20be%20sitting%20on%20each%20stone%20at%20a%20time.%20Initially%2C%20the%20pollywogs%20are%20sitting%20on%20the%20first%20%24%20x%20%24%20stones%20%28one%20pollywog%20on%20each%20stone%29.%5Cn%5Cn%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF917C%5C%2Fa0a82f5f6337291f52388ae32f43260aec71496f.png%29Dart%20and%20his%20friends%20want%20to%20end%20up%20on%20the%20last%20%24%20x%20%24%20stones.%20At%20each%20second%2C%20the%20leftmost%20pollywog%20should%20jump%20to%20the%20right.%20A%20pollywog%20can%20jump%20at%20most%20%24%20k%20%24%20stones%3B%20more%20specifically%2C%20a%20pollywog%20can%20jump%20from%20stone%20number%20%24%20i%20%24%20to%20stones%20%24%20i%2B1%2Ci%2B2%2C...%5C%5C%20i%2Bk%20%24%20.%20A%20pollywog%20can%27t%20jump%20on%20an%20occupied%20stone.%20Jumping%20a%20distance%20%24%20i%20%24%20takes%20%24%20c_%7Bi%7D%20%24%20amounts%20of%20energy%20from%20the%20pollywog.%5Cn%5CnAlso%2C%20%24%20q%20%24%20stones%20are%20special%20Each%20time%20landing%20on%20a%20special%20stone%20%24%20p%20%24%20%2C%20takes%20%24%20w_%7Bp%7D%20%24%20amounts%20of%20energy%20%28in%20addition%20to%20the%20energy%20for%20jump%29%20from%20the%20pollywog.%20%24%20w_%7Bp%7D%20%24%20could%20be%20negative%2C%20in%20this%20case%2C%20it%20means%20the%20pollywog%20absorbs%20%24%20%7Cw_%7Bp%7D%7C%20%24%20amounts%20of%20energy.%5Cn%5CnPollywogs%20want%20to%20spend%20as%20little%20energy%20as%20possible%20%28this%20value%20could%20be%20negative%29.%5Cn%5CnThey%27re%20just%20pollywogs%2C%20so%20they%20asked%20for%20your%20help.%20Tell%20them%20the%20total%20change%20in%20their%20energy%2C%20in%20case%20they%20move%20optimally.%22%2C%22inputFormat%22%3A%22The%20first%20line%20of%20input%20contains%20four%20integers%2C%20%24%20x%2Ck%2Cn%20%24%20and%20%24%20q%20%24%20%28%20%24%201%3C%3Dx%3C%3Dk%3C%3D8%20%24%20%2C%20%24%20k%3C%3Dn%3C%3D10%5E%7B8%7D%20%24%20%2C%20%24%200%3C%3Dq%3C%3Dmin%2825%2Cn-x%29%20%24%20%29%20%5Cu2014%20the%20number%20of%20pollywogs%2C%20the%20maximum%20length%20of%20jump%2C%20the%20number%20of%20stones%20and%20the%20number%20of%20special%20stones.%5Cn%5CnThe%20next%20line%20contains%20%24%20k%20%24%20integers%2C%20%24%20c_%7B1%7D%2Cc_%7B2%7D%2C...%5C%5C%20c_%7Bk%7D%20%24%20%2C%20separated%20by%20spaces%20%28%20%24%201%3C%3Dc_%7Bi%7D%3C%3D10%5E%7B9%7D%20%24%20%29%20%5Cu2014%20the%20energetic%20costs%20of%20jumps.%5Cn%5CnThe%20next%20%24%20q%20%24%20lines%20contain%20description%20of%20the%20special%20stones.%20Each%20line%20contains%20two%20integers%20%24%20p%20%24%20and%20%24%20w_%7Bp%7D%20%24%20%28%20%24%20x%2B1%3C%3Dp%3C%3Dn%20%24%20%2C%20%24%20%7Cw_%7Bp%7D%7C%3C%3D10%5E%7B9%7D%20%24%20%29.%20All%20%24%20p%20%24%20are%20distinct.%22%2C%22outputFormat%22%3A%22Print%20the%20minimum%20amount%20of%20energy%20they%20need%2C%20in%20the%20first%20and%20only%20line%20of%20output.%22%2C%22samples%22%3A%5B%5B%222%203%2010%202%5Cn1%202%203%5Cn5%20-10%5Cn6%201000%5Cn%22%2C%226%5Cn%22%5D%2C%5B%224%207%2085%203%5Cn17%205%2028%204%2052%2046%206%5Cn59%20-76%5Cn33%20-69%5Cn19%202018%5Cn%22%2C%22135%5Cn%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F917%5C%2FC%22%2C%22id%22%3A%22917C%22%7D%2C%22translation%22%3A%22%5Cn%5Cn%5Cu9898%5Cu610f%5Cuff1a%5Cn%5Cn%5Cu6709n%5Cu4e2a%5Cu77f3%5Cu5934%5Cuff0c%5Cu4ece%5Cu5de6%5Cu8fb9%5Cu5f00%5Cu59cb%5Cu7f16%5Cu53f7%5Cu4e3a1~n.%5Cn%5Cn%5Cu4e00%5Cu5f00%5Cu59cb%5Cu6709x%5Cu4e2a%5Cu9752%5Cu86d9%5Cu7ad9%5Cu5728%5Cu6700%5Cu5de6%5Cu8fb9%5Cu7684x%5Cu4e2a%5Cu77f3%5Cu5934%5Cu4e0a%5Cuff0c%5Cu6bcf%5Cu4e2a%5Cu77f3%5Cu5934%5Cu4e0a%5Cu53ea%5Cu80fd%5Cu7ad9%5Cu4e00%5Cu53ea%5Cu9752%5Cu86d9%5Cu3002%5Cn%5Cn%5Cu6bcf%5Cu4e00%5Cu8f6e%5Cuff0c%5Cu6700%5Cu5de6%5Cu8fb9%5Cu7684%5Cu9752%5Cu86d9%5Cu53ef%5Cu4ee5%5Cu9009%5Cu62e9%5Cu5411%5Cu53f3%5Cu8fb9%5Cu8df31~k%5Cu4e2a%5Cu77f3%5Cu5934%5Cuff0c%5Cu5373%5Cu4ece%5Cu7b2ci%5Cu4e2a%5Cu5230%5Cu7b2ci%2B1%5Cuff0ci%2B2%5Cuff0c......i%2Bk%5Cu4e2a%5Cu77f3%5Cu5934%5Cu3002%5Cu9752%5Cu86d9%5Cu4e0d%5Cu53ef%5Cu4ee5%5Cu8df3%5Cu5230%5Cu5df2%5Cu7ecf%5Cu6709%5Cu9752%5Cu86d9%5Cu7684%5Cu77f3%5Cu5934%5Cu4e0a%5Cn%5Cn%5Cu5411%5Cu53f3%5Cu8fb9%5Cu8df3i%5Cu4e2a%5Cu77f3%5Cu5934%5Cu82b1%5Cu8d39%5Cu7684%5Cu4f53%5Cu529b%5Cu4e3a%20ci%5Cn%5Cn%5Cu6240%5Cu6709%5Cu7684%5Cu77f3%5Cu5934%5Cu4e2d%5Cu6709q%5Cu4e2a%5Cu7279%5Cu6b8a%5Cu77f3%5Cu5934%5Cuff0c%5Cu5bf9%5Cu4e8e%5Cu6bcf%5Cu4e00%5Cu4e2a%5Cu7279%5Cu6b8a%5Cu77f3%5Cu5934p%5Cuff0c%5Cu8df3%5Cu5230p%5Cu4e0a%5Cu65f6%5Cu4f1a%5Cu989d%5Cu5916%5Cu6d88%5Cu8017%20Wp%20%5Cu70b9%5Cu4f53%5Cu529b%5Cuff0cWp%5Cu53ef%5Cu80fd%5Cu662f%5Cu8d1f%5Cu6570%5Cuff08%5Cu5373%5Cu4e3a%5Cu4f53%5Cu529b%5Cu589e%5Cu52a0%5Cn%5Cn%5Cu6c42%5Cu4f7f%5Cu5f97%5Cu8fd9x%5Cu4e2a%5Cu9752%5Cu86d9%5Cu4ece1-x%5Cu77f3%5Cu5934%5Cu8df3%5Cu5230%5Cu6700%5Cu53f3%5Cu8fb9%5Cu7684x%5Cu4e2a%5Cu77f3%5Cu5934%5Cu4e0a%5Cuff0c%5Cu6240%5Cu8981%5Cu82b1%5Cu8d39%5Cu7684%5Cu4f53%5Cu529b%5Cu6700%5Cu5c0f%5Cu503c%5Cu3002%5Cn%5Cn%5Cu8fd9%5Cu4e2a%5Cu6700%5Cu5c0f%5Cu503c%5Cu53ef%5Cu4ee5%5Cu4e3a%5Cu8d1f%5Cu6570%5Cn%5CnTranslated%20by%20KamijuIndex%5Cn%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A22%2C%22totalAccepted%22%3A14%2C%22pid%22%3A%22CF917C%22%2C%22title%22%3A%22Pollywog%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A34115%2C%22title%22%3A%22%5Cu8fd9%5Cu9898%5Cu4e0e%2A%2A%20HNOI%202010%20BUS%20%5Cu516c%5Cu4ea4%5Cu7ebf%5Cu8def%2A%2A%20%5Cu6709%5Cu533a%5Cu522b%5Cu5417%5Cuff1f%22%2C%22forum%22%3A%7B%22id%22%3A12773%2C%22name%22%3A%22CF917C%20Pollywog%22%2C%22slug%22%3A%22CF917C%22%7D%7D%2C%7B%22id%22%3A32380%2C%22title%22%3A%22%5Cu7ffb%5Cu8bd1%22%2C%22forum%22%3A%7B%22id%22%3A12773%2C%22name%22%3A%22CF917C%20Pollywog%22%2C%22slug%22%3A%22CF917C%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Pollywog%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Pollywog</h1>
<h2>题意翻译</h2>
<div>
题意：
有n个石头，从左边开始编号为1~n.
一开始有x个青蛙站在最左边的x个石头上，每个石头上只能站一只青蛙。
每一轮，最左边的青蛙可以选择向右边跳1~k个石头，即从第i个到第i+1，i+2，......i+k个石头。青蛙不可以跳到已经有青蛙的石头上
向右边跳i个石头花费的体力为 ci
所有的石头中有q个特殊石头，对于每一个特殊石头p，跳到p上时会额外消耗 Wp 点体力，Wp可能是负数（即为体力增加
求使得这x个青蛙从1-x石头跳到最右边的x个石头上，所要花费的体力最小值。
这个最小值可以为负数
Translated by KamijuIndex
</div>
<h2>题目描述</h2>
<div>As we all know, Dart is some kind of creature from Upside Down world. For simplicity, we call their kind pollywogs. Dart and $ x-1 $ other pollywogs are playing a game. There are $ n $ stones in a row, numbered from $ 1 $ through $ n $ from left to right. At most $ 1 $ pollywog may be sitting on each stone at a time. Initially, the pollywogs are sitting on the first $ x $ stones (one pollywog on each stone).
![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF917C/a0a82f5f6337291f52388ae32f43260aec71496f.png)Dart and his friends want to end up on the last $ x $ stones. At each second, the leftmost pollywog should jump to the right. A pollywog can jump at most $ k $ stones; more specifically, a pollywog can jump from stone number $ i $ to stones $ i+1,i+2,...\ i+k $ . A pollywog can't jump on an occupied stone. Jumping a distance $ i $ takes $ c_{i} $ amounts of energy from the pollywog.
Also, $ q $ stones are special Each time landing on a special stone $ p $ , takes $ w_{p} $ amounts of energy (in addition to the energy for jump) from the pollywog. $ w_{p} $ could be negative, in this case, it means the pollywog absorbs $ |w_{p}| $ amounts of energy.
Pollywogs want to spend as little energy as possible (this value could be negative).
They're just pollywogs, so they asked for your help. Tell them the total change in their energy, in case they move optimally.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line of input contains four integers, $ x,k,n $ and $ q $ ( $ 1<=x<=k<=8 $ , $ k<=n<=10^{8} $ , $ 0<=q<=min(25,n-x) $ ) — the number of pollywogs, the maximum length of jump, the number of stones and the number of special stones.
The next line contains $ k $ integers, $ c_{1},c_{2},...\ c_{k} $ , separated by spaces ( $ 1<=c_{i}<=10^{9} $ ) — the energetic costs of jumps.
The next $ q $ lines contain description of the special stones. Each line contains two integers $ p $ and $ w_{p} $ ( $ x+1<=p<=n $ , $ |w_{p}|<=10^{9} $ ). All $ p $ are distinct.</div>
<h3>输出格式</h3>
<br />
<div>Print the minimum amount of energy they need, in the first and only line of output.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>2 3 10 2
1 2 3
5 -10
6 1000
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>6
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>4 7 85 3
17 5 28 4 52 46 6
59 -76
33 -69
19 2018
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>135
</code></pre>
</article>
</div>
</div>
</body>
</html>
