<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Journey - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573390404:clbJ0gCPPtwbnbx3hYjcFSmnVFwXrNOkj8VlbGlsbGg=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Stewie%20the%20Rabbit%20explores%20a%20new%20parallel%20universe.%20This%20two%20dimensional%20universe%20has%20the%20shape%20of%20a%20rectangular%20grid%2C%20containing%20%24%20n%20%24%20lines%20and%20%24%20m%20%24%20columns.%20The%20universe%20is%20very%20small%3A%20one%20cell%20of%20the%20grid%20can%20only%20contain%20one%20particle.%20Each%20particle%20in%20this%20universe%20is%20either%20static%20or%20dynamic.%20Each%20static%20particle%20always%20remains%20in%20one%20and%20the%20same%20position.%20Due%20to%20unintelligible%20gravitation%20laws%20no%20two%20static%20particles%20in%20the%20parallel%20universe%20can%20be%20present%20in%20one%20column%20or%20row%2C%20and%20they%20also%20can%27t%20be%20present%20in%20the%20diagonally%20adjacent%20cells.%20A%20dynamic%20particle%20appears%20in%20a%20random%20empty%20cell%2C%20randomly%20chooses%20the%20destination%20cell%20%28destination%20cell%20may%20coincide%20with%20the%20start%20cell%2C%20see%20the%20samples%29%20and%20moves%20there%20along%20the%20shortest%20path%20through%20the%20cells%2C%20unoccupied%20by%20the%20static%20particles.%20All%20empty%20cells%20have%20the%20same%20probability%20of%20being%20selected%20as%20the%20beginning%20or%20end%20of%20the%20path.%20Having%20reached%20the%20destination%20cell%2C%20the%20particle%20disappears.%20Only%20one%20dynamic%20particle%20can%20exist%20at%20one%20moment%20of%20time.%20This%20particle%20can%20move%20from%20a%20cell%20to%20a%20cell%20if%20they%20have%20an%20adjacent%20side%2C%20and%20this%20transition%20takes%20exactly%20one%20galactic%20second.%20Stewie%20got%20interested%20in%20what%20is%20the%20average%20lifespan%20of%20one%20particle%20in%20the%20given%20universe.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20two%20space-separated%20integers%3A%20%24%20n%2Cm%20%24%20%28%20%24%202%3C%3Dn%2Cm%3C%3D1000%20%24%20%29%20which%20represent%20the%20sizes%20of%20the%20universe.%20The%20next%20%24%20n%20%24%20lines%20containing%20%24%20m%20%24%20symbols%20each%20describe%20the%20universe%20without%20dynamic%20particles%20%5Cu2014%20the%20%24%20j%20%24%20-th%20symbol%20of%20the%20%24%20i%20%24%20-th%20line%20equals%20to%20%27X%27%20if%20the%20cell%20is%20occupied%20by%20a%20static%20particle%2C%20and%20to%20%27.%27%20if%20it%20is%20empty.%20It%20is%20guaranteed%20that%20the%20described%20universe%20satisfies%20the%20properties%20described%20above%2C%20that%20is%20no%20two%20static%20particles%20can%20be%20in%20one%20column%20or%20in%20one%20row%2C%20besides%2C%20they%20can%27t%20be%20positioned%20in%20the%20diagonally%20adjacent%20cells.%22%2C%22outputFormat%22%3A%22You%20have%20to%20print%20on%20a%20single%20line%20a%20single%20number%20which%20is%20the%20average%20life%20span%20of%20a%20particle%20with%20an%20accuracy%20of%20at%20least%206%20decimal%20places.%5Cn%5CnThe%20answer%20will%20be%20accepted%20if%20it%20is%20within%20%24%2010%5E%7B-6%7D%20%24%20of%20absolute%20or%20relative%20error%20from%20the%20correct%20answer.%22%2C%22samples%22%3A%5B%5B%222%202%5Cn..%5Cn.X%5Cn%22%2C%220.888888888889%5Cn%22%5D%2C%5B%223%203%5Cn...%5Cn.X.%5Cn...%5Cn%22%2C%222.000000000000%5Cn%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F57%5C%2FD%22%2C%22id%22%3A%2257D%22%7D%2C%22translation%22%3A%22%5Cu5154%5Cu5b50Stewie%5Cu53d1%5Cu73b0%5Cu4e86%5Cu4e00%5Cu4e2a%5Cu65b0%5Cu7684%5Cu5e73%5Cu884c%5Cu5b87%5Cu5b99%5Cu3002%5Cu8fd9%5Cu4e2a%5Cu5b87%5Cu5b99%5Cu662f%5Cu4e8c%5Cu7ef4%5Cu7684%5Cu4e14%5Cu662f%5Cu77e9%5Cu5f62%5Cu7f51%5Cu683c%5Cuff0c%5Cu5305%5Cu542bn%5Cu884c%5Cuff0cm%5Cu5217%5Cu3002%5Cu5b83%5Cu662f%5Cu975e%5Cu5e38%5Cu5c0f%5Cu7684%5Cuff1a%5Cu7f51%5Cu683c%5Cu7684%5Cu4e00%5Cu4e2a%5Cu683c%5Cu5b50%5Cu53ea%5Cu80fd%5Cu5305%5Cu542b%5Cu4e00%5Cu4e2a%5Cu7c92%5Cu5b50%5Cu3002%5Cu8fd9%5Cu4e2a%5Cu5b87%5Cu5b99%5Cu4e2d%5Cu7684%5Cu6bcf%5Cu4e00%5Cu4e2a%5Cu7c92%5Cu5b50%5Cu8981%5Cu4e48%5Cu662f%5Cu9759%5Cu6001%5Cu7684%5Cuff0c%5Cu8981%5Cu4e48%5Cu662f%5Cu52a8%5Cu6001%5Cu7684%5Cu3002%5Cu6bcf%5Cu4e2a%5Cu9759%5Cu6001%5Cu7c92%5Cu5b50%5Cu603b%5Cu662f%5Cu4fdd%5Cu6301%5Cu5728%5Cu540c%5Cu4e00%5Cu4f4d%5Cu7f6e%5Cu3002%5Cu7531%5Cu4e8e%5Cu83ab%5Cu540d%5Cu5176%5Cu5999%5Cu7684%5Cu5f15%5Cu529b%5Cu5b9a%5Cu5f8b%5Cuff0c%5Cu5e73%5Cu884c%5Cu5b87%5Cu5b99%5Cu4e2d%5Cu6ca1%5Cu6709%5Cu4e24%5Cu4e2a%5Cu9759%5Cu6001%5Cu7c92%5Cu5b50%5Cu5b58%5Cu5728%5Cu4e8e%5Cu4e00%5Cu884c%5Cu6216%5Cu4e00%5Cu5217%5Cu4e2d%5Cuff0c%5Cu4e5f%5Cu4e0d%5Cu53ef%5Cu80fd%5Cu5b58%5Cu5728%5Cu4e8e%5Cu5176%5Cu5b83%5Cu9759%5Cu6001%5Cu7c92%5Cu5b50%5Cu7684%5Cu5de6%5Cu4e0a%5Cuff0c%5Cu5de6%5Cu4e0b%5Cuff0c%5Cu53f3%5Cu4e0a%5Cuff0c%5Cu53f3%5Cu4e0b%5Cu76844%5Cu4e2a%5Cu683c%5Cu5b50%5Cu4e2d%5Cu3002%5Cu4e00%5Cu4e2a%5Cu52a8%5Cu6001%5Cu7c92%5Cu5b50%5Cu51fa%5Cu73b0%5Cu5728%5Cu4e00%5Cu4e2a%5Cu968f%5Cu673a%5Cu7684%5Cu7a7a%5Cu683c%5Cu5b50%5Cu4e2d%5Cuff0c%5Cu968f%5Cu673a%5Cu5730%5Cu9009%5Cu62e9%5Cu76ee%5Cu7684%5Cu683c%5Cu5b50%5Cuff08%5Cu76ee%5Cu7684%5Cu683c%5Cu5b50%5Cu53ef%5Cu80fd%5Cu4e0e%5Cu8d77%5Cu59cb%5Cu683c%5Cu5b50%5Cu91cd%5Cu5408%5Cuff0c%5Cu8bf7%5Cu770b%5Cu6837%5Cu4f8b%5Cuff09%5Cuff0c%5Cu5e76%5Cu6cbf%5Cu7740%5Cu6700%5Cu77ed%5Cu7684%5Cu8def%5Cu5f84%5Cu79fb%5Cu52a8%5Cu5230%5Cu6ca1%5Cu6709%5Cu88ab%5Cu9759%5Cu6001%5Cu7c92%5Cu5b50%5Cu5360%5Cu636e%5Cu7684%5Cu76ee%5Cu6807%5Cu683c%5Cu5b50%5Cu4e2d%5Cu3002%5Cu6240%5Cu6709%5Cu7a7a%5Cu683c%5Cu5b50%5Cu88ab%5Cu9009%5Cu62e9%5Cu4e3a%5Cu8def%5Cu5f84%5Cu7684%5Cu5f00%5Cu59cb%5Cu6216%5Cu7ed3%5Cu675f%5Cu7684%5Cu6982%5Cu7387%5Cu662f%5Cu76f8%5Cu540c%5Cu7684%5Cu3002%5Cu5230%5Cu8fbe%5Cu76ee%5Cu6807%5Cu683c%5Cu5b50%5Cu540e%5Cuff0c%5Cu7c92%5Cu5b50%5Cu6d88%5Cu5931%5Cu3002%5Cu5728%5Cu540c%5Cu4e00%5Cu4e2a%5Cu65f6%5Cu523b%5Cu53ea%5Cu5141%5Cu8bb8%5Cu6709%5Cu4e00%5Cu4e2a%5Cu52a8%5Cu6001%5Cu7c92%5Cu5b50%5Cu5b58%5Cu5728%5Cu3002%5Cu6bcf%5Cu4e2a%5Cu79fb%5Cu52a8%5Cu8fc7%5Cu7a0b%5Cu4e2d%5Cuff0c%5Cu8fd9%5Cu4e2a%5Cu7c92%5Cu5b50%5Cu5fc5%5Cu987b%5Cu4ece%5Cu4e00%5Cu4e2a%5Cu683c%5Cu5b50%5Cu79fb%5Cu52a8%5Cu5230%5Cu76f8%5Cu90bb%5Cu7684%5Cu4e00%5Cu4e2a%5Cu683c%5Cu5b50%5Cuff0c%5Cu8fd9%5Cu4e2a%5Cu8fc7%5Cu7a0b%5Cu9700%5Cu8981%5Cu4e00%5Cu4e2a%5Cu94f6%5Cu6cb3%5Cu79d2%5Cu3002Stewie%5Cu5bf9%5Cu5b87%5Cu5b99%5Cu4e2d%5Cu4e00%5Cu4e2a%5Cu7c92%5Cu5b50%5Cu7684%5Cu5e73%5Cu5747%5Cu5bff%5Cu547d%5Cu611f%5Cu5174%5Cu8da3%5Cu3002%5Cn%5Cn%5Cn------------%5Cn%5Cn%23%23%20%5Cu8f93%5Cu5165%5Cu8f93%5Cu51fa%5Cu683c%5Cu5f0f%5Cn%5Cn%23%23%23%23%20%5Cu8f93%5Cu5165%5Cu683c%5Cu5f0f%5Cuff1a%5Cn%5Cn%5Cu7b2c%5Cu4e00%5Cu884c%5Cu5305%5Cu542b%5Cu4e24%5Cu4e2a%5Cu7528%5Cu7a7a%5Cu683c%5Cu5206%5Cu5f00%5Cu7684%5Cu6574%5Cu6570%5Cuff1an%5Cuff0cm%5Cuff082%5Cuff1cn%5Cuff0cm%20%3C%5Cuff1d1000%5Cuff09%5Cuff0c%5Cu8868%5Cu793a%5Cu5b87%5Cu5b99%5Cu7684%5Cu5927%5Cu5c0f%5Cu3002%5Cu540e%5Cu9762%5Cu6709n%5Cu884c%5Cuff0c%5Cu6bcf%5Cu884cm%5Cu4e2a%5Cu7b26%5Cu53f7%5Cuff0c%5Cu6bcf%5Cu4e00%5Cu4e2a%5Cu7b26%5Cu53f7%5Cu63cf%5Cu8ff0%5Cu4e86%5Cu6ca1%5Cu6709%5Cu52a8%5Cu6001%5Cu7c92%5Cu5b50%5Cu7684%5Cu5b87%5Cu5b99%5Cu2014%5Cu2014%5Cu5982%5Cu679c%5Cu7b2ci%5Cu884c%5Cu7b2c%20j%5Cu4e2a%5Cu7b26%5Cu53f7%5Cu7b49%5Cu4e8e%5Cu2018X%5Cu2019%5Cuff0c%5Cu8868%5Cu793a%5Cu6709%5Cu4e00%5Cu4e2a%5Cu9759%5Cu6001%5Cu7c92%5Cu5b50%5Cuff0c%5Cu5982%5Cu679c%5Cu5b83%5Cu662f%5Cu7a7a%5Cu7684%5Cuff0c%5Cu5219%5Cu7b49%5Cu4e8e%5Cu201c.%5Cu201d%5Cu3002%5Cu4fdd%5Cu8bc1%5Cu6240%5Cu63cf%5Cu8ff0%5Cu7684%5Cu5b87%5Cu5b99%5Cu6ee1%5Cu8db3%5Cu4e0a%5Cu8ff0%5Cu9759%5Cu6001%5Cu7c92%5Cu5b50%5Cu6392%5Cu5e03%5Cu89c4%5Cu5219%5Cn%5Cn%5Cn%23%23%23%23%20%5Cu8f93%5Cu51fa%5Cu683c%5Cu5f0f%5Cuff1a%5Cn%5Cn%5Cu8f93%5Cu51fa%5Cu6709%5Cu4e00%5Cu884c%5Cuff0c%5Cu4e00%5Cu4e2a%5Cu6570%5Cuff0c%5Cu8868%5Cu793a%5Cu7c92%5Cu5b50%5Cu7684%5Cu5e73%5Cu5747%5Cu5bff%5Cu547d%5Cu3002%5Cn%5Cu7ed3%5Cu679c%5Cu5982%5Cu4e0e%5Cu6b63%5Cu786e%5Cu7b54%5Cu6848%5Cu670910%5Cu7684-6%5Cu6b21%5Cu65b9%5Cu4ee5%5Cu5185%5Cu8bef%5Cu5dee%5Cuff0c%5Cu5373%5Cu4e3a%5Cu6b63%5Cu786e%5Cu3002%5Cn%22%2C%22tags%22%3A%5B111%2C160%2C254%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A51%2C%22totalAccepted%22%3A24%2C%22pid%22%3A%22CF57D%22%2C%22title%22%3A%22Journey%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A132112%2C%22title%22%3A%22%5Cu7b2c7%5Cu4e2a%5Cu70b9%5Cu662f%5Cu5361%5Cu7cbe%5Cu5ea6%5Cu4e48%3F%3F%3F%22%2C%22forum%22%3A%7B%22id%22%3A12412%2C%22name%22%3A%22CF57D%20Journey%22%2C%22slug%22%3A%22CF57D%22%7D%7D%2C%7B%22id%22%3A55289%2C%22title%22%3A%22%5Cu7ffb%5Cu8bd1%22%2C%22forum%22%3A%7B%22id%22%3A12412%2C%22name%22%3A%22CF57D%20Journey%22%2C%22slug%22%3A%22CF57D%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P4167%22%2C%22title%22%3A%22%5BViolet%5D%5Cu6a31%5Cu82b1%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22CF57E%22%2C%22title%22%3A%22Chess%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22P4665%22%2C%22title%22%3A%22%5BBalticOI%202015%5DNetwork%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22CF1234B2%22%2C%22title%22%3A%22Social%20Network%20%28hard%20version%29%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1244A%22%2C%22title%22%3A%22Pens%20and%20Pencils%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Journey%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573286098;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Journey</h1>
<h2>题意翻译</h2>
<div>兔子Stewie发现了一个新的平行宇宙。这个宇宙是二维的且是矩形网格，包含n行，m列。它是非常小的：网格的一个格子只能包含一个粒子。这个宇宙中的每一个粒子要么是静态的，要么是动态的。每个静态粒子总是保持在同一位置。由于莫名其妙的引力定律，平行宇宙中没有两个静态粒子存在于一行或一列中，也不可能存在于其它静态粒子的左上，左下，右上，右下的4个格子中。一个动态粒子出现在一个随机的空格子中，随机地选择目的格子（目的格子可能与起始格子重合，请看样例），并沿着最短的路径移动到没有被静态粒子占据的目标格子中。所有空格子被选择为路径的开始或结束的概率是相同的。到达目标格子后，粒子消失。在同一个时刻只允许有一个动态粒子存在。每个移动过程中，这个粒子必须从一个格子移动到相邻的一个格子，这个过程需要一个银河秒。Stewie对宇宙中一个粒子的平均寿命感兴趣。
------------
## 输入输出格式
#### 输入格式：
第一行包含两个用空格分开的整数：n，m（2＜n，m <＝1000），表示宇宙的大小。后面有n行，每行m个符号，每一个符号描述了没有动态粒子的宇宙——如果第i行第 j个符号等于‘X’，表示有一个静态粒子，如果它是空的，则等于“.”。保证所描述的宇宙满足上述静态粒子排布规则
#### 输出格式：
输出有一行，一个数，表示粒子的平均寿命。
结果如与正确答案有10的-6次方以内误差，即为正确。
</div>
<h2>题目描述</h2>
<div>Stewie the Rabbit explores a new parallel universe. This two dimensional universe has the shape of a rectangular grid, containing $ n $ lines and $ m $ columns. The universe is very small: one cell of the grid can only contain one particle. Each particle in this universe is either static or dynamic. Each static particle always remains in one and the same position. Due to unintelligible gravitation laws no two static particles in the parallel universe can be present in one column or row, and they also can't be present in the diagonally adjacent cells. A dynamic particle appears in a random empty cell, randomly chooses the destination cell (destination cell may coincide with the start cell, see the samples) and moves there along the shortest path through the cells, unoccupied by the static particles. All empty cells have the same probability of being selected as the beginning or end of the path. Having reached the destination cell, the particle disappears. Only one dynamic particle can exist at one moment of time. This particle can move from a cell to a cell if they have an adjacent side, and this transition takes exactly one galactic second. Stewie got interested in what is the average lifespan of one particle in the given universe.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains two space-separated integers: $ n,m $ ( $ 2<=n,m<=1000 $ ) which represent the sizes of the universe. The next $ n $ lines containing $ m $ symbols each describe the universe without dynamic particles — the $ j $ -th symbol of the $ i $ -th line equals to 'X' if the cell is occupied by a static particle, and to '.' if it is empty. It is guaranteed that the described universe satisfies the properties described above, that is no two static particles can be in one column or in one row, besides, they can't be positioned in the diagonally adjacent cells.</div>
<h3>输出格式</h3>
<br />
<div>You have to print on a single line a single number which is the average life span of a particle with an accuracy of at least 6 decimal places.
The answer will be accepted if it is within $ 10^{-6} $ of absolute or relative error from the correct answer.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>2 2
..
.X
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>0.888888888889
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>3 3
...
.X.
...
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>2.000000000000
</code></pre>
</article>
</div>
</div>
</body>
</html>
