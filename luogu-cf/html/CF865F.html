<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Egg Roulette - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573398822:DDyAoCfWefvnQap2C3G1K5mlI9B9CYulbOQS+v+1eQ4=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22The%20game%20of%20Egg%20Roulette%20is%20played%20between%20two%20players.%20Initially%20%24%202R%20%24%20raw%20eggs%20and%20%24%202C%20%24%20cooked%20eggs%20are%20placed%20randomly%20into%20a%20carton.%20The%20shells%20are%20left%20on%20so%20there%20is%20no%20way%20to%20distinguish%20a%20raw%20egg%20from%20a%20cooked%20egg.%20One%20at%20a%20time%2C%20a%20player%20will%20select%20an%20egg%2C%20and%20then%20smash%20the%20egg%20on%20his%5C%2Fher%20forehead.%20If%20the%20egg%20was%20cooked%2C%20not%20much%20happens%2C%20but%20if%20the%20egg%20was%20raw%2C%20it%20will%20make%20quite%20the%20mess.%20This%20continues%20until%20one%20player%20has%20broken%20%24%20R%20%24%20raw%20eggs%2C%20at%20which%20point%20that%20player%20is%20declared%20the%20loser%20and%20the%20other%20player%20wins.%5Cn%5CnThe%20order%20in%20which%20players%20take%20turns%20can%20be%20described%20as%20a%20string%20of%20%27A%27%20and%20%27B%27%20characters%2C%20where%20the%20%24%20i%20%24%20-th%20character%20tells%20which%20player%20should%20choose%20the%20%24%20i%20%24%20-th%20egg.%20Traditionally%2C%20players%20take%20turns%20going%20one%20after%20the%20other.%20That%20is%2C%20they%20follow%20the%20ordering%20%5C%22ABABAB...%5C%22.%20This%20isn%27t%20very%20fair%20though%2C%20because%20the%20second%20player%20will%20win%20more%20often%20than%20the%20first.%20We%27d%20like%20you%20to%20find%20a%20better%20ordering%20for%20the%20players%20to%20take%20their%20turns.%20Let%27s%20define%20the%20unfairness%20of%20an%20ordering%20as%20the%20absolute%20difference%20between%20the%20first%20player%27s%20win%20probability%20and%20the%20second%20player%27s%20win%20probability.%20We%27re%20interested%20in%20orderings%20that%20minimize%20the%20unfairness.%20We%20only%20consider%20an%20ordering%20valid%20if%20it%20contains%20the%20same%20number%20of%20%27A%27s%20as%20%27B%27s.%5Cn%5CnYou%20will%20also%20be%20given%20a%20string%20%24%20S%20%24%20of%20length%20%24%202%28R%2BC%29%20%24%20containing%20only%20%27A%27%2C%20%27B%27%2C%20and%20%27%3F%27%20characters.%20An%20ordering%20is%20said%20to%20match%20%24%20S%20%24%20if%20it%20only%20differs%20from%20%24%20S%20%24%20in%20positions%20where%20%24%20S%20%24%20contains%20a%20%27%3F%27.%20Of%20the%20valid%20orderings%20that%20minimize%20unfairness%2C%20how%20many%20match%20%24%20S%20%24%20%3F%22%2C%22inputFormat%22%3A%22The%20first%20line%20of%20input%20will%20contain%20integers%20%24%20R%20%24%20and%20%24%20C%20%24%20%24%20%281%3C%3DR%2CC%3C%3D20%2CR%2BC%3C%3D30%29%20%24%20.%5Cn%5CnThe%20second%20line%20of%20input%20will%20contain%20the%20string%20%24%20S%20%24%20of%20length%20%24%202%28R%2BC%29%20%24%20consisting%20only%20of%20characters%20%27A%27%2C%20%27B%27%2C%20%27%3F%27.%22%2C%22outputFormat%22%3A%22Print%20the%20number%20of%20valid%20orderings%20that%20minimize%20unfairness%20and%20match%20%24%20S%20%24%20.%22%2C%22samples%22%3A%5B%5B%221%201%5Cn%3F%3FBB%5Cn%22%2C%220%5Cn%22%5D%2C%5B%222%204%5Cn%3FBA%3F%3FB%3F%3FA%3F%3F%3F%5Cn%22%2C%221%5Cn%22%5D%2C%5B%224%2014%5Cn%3F%3F%3F%3FA%3F%3FBB%3F%3F%3F%3F%3F%3F%3F%3F%3F%3F%3F%3F%3FAB%3F%3F%3F%3F%3F%3F%3F%3F%3F%3F%3F%3F%5Cn%22%2C%22314%5Cn%22%5D%5D%2C%22hint%22%3A%22In%20the%20first%20test%20case%2C%20the%20minimum%20unfairness%20is%20%24%200%20%24%20%2C%20and%20the%20orderings%20that%20achieve%20it%20are%20%5C%22ABBA%5C%22%20and%20%5C%22BAAB%5C%22%2C%20neither%20of%20which%20match%20%24%20S%20%24%20.%20Note%20that%20an%20ordering%20such%20as%20%5C%22ABBB%5C%22%20would%20also%20have%20an%20unfairness%20of%20%24%200%20%24%20%2C%20but%20is%20invalid%20because%20it%20does%20not%20contain%20the%20same%20number%20of%20%27A%27s%20as%20%27B%27s.%5Cn%5CnIn%20the%20second%20example%2C%20the%20only%20matching%20ordering%20is%20%5C%22BBAAABABABBA%5C%22.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B3000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F865%5C%2FF%22%2C%22id%22%3A%22865F%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22CF865F%22%2C%22title%22%3A%22Egg%20Roulette%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Egg%20Roulette%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Egg Roulette</h1>
<h2>题目描述</h2>
<div>The game of Egg Roulette is played between two players. Initially $ 2R $ raw eggs and $ 2C $ cooked eggs are placed randomly into a carton. The shells are left on so there is no way to distinguish a raw egg from a cooked egg. One at a time, a player will select an egg, and then smash the egg on his/her forehead. If the egg was cooked, not much happens, but if the egg was raw, it will make quite the mess. This continues until one player has broken $ R $ raw eggs, at which point that player is declared the loser and the other player wins.
The order in which players take turns can be described as a string of 'A' and 'B' characters, where the $ i $ -th character tells which player should choose the $ i $ -th egg. Traditionally, players take turns going one after the other. That is, they follow the ordering "ABABAB...". This isn't very fair though, because the second player will win more often than the first. We'd like you to find a better ordering for the players to take their turns. Let's define the unfairness of an ordering as the absolute difference between the first player's win probability and the second player's win probability. We're interested in orderings that minimize the unfairness. We only consider an ordering valid if it contains the same number of 'A's as 'B's.
You will also be given a string $ S $ of length $ 2(R+C) $ containing only 'A', 'B', and '?' characters. An ordering is said to match $ S $ if it only differs from $ S $ in positions where $ S $ contains a '?'. Of the valid orderings that minimize unfairness, how many match $ S $ ?</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line of input will contain integers $ R $ and $ C $ $ (1<=R,C<=20,R+C<=30) $ .
The second line of input will contain the string $ S $ of length $ 2(R+C) $ consisting only of characters 'A', 'B', '?'.</div>
<h3>输出格式</h3>
<br />
<div>Print the number of valid orderings that minimize unfairness and match $ S $ .</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>1 1
??BB
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>0
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>2 4
?BA??B??A???
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>1
</code></pre>
<h3>输入样例 #3</h3>
<pre><code>4 14
????A??BB?????????????AB????????????
</code></pre>
<h3>输出样例 #3</h3>
<pre><code>314
</code></pre>
<h2>说明</h2>
<div>In the first test case, the minimum unfairness is $ 0 $ , and the orderings that achieve it are "ABBA" and "BAAB", neither of which match $ S $ . Note that an ordering such as "ABBB" would also have an unfairness of $ 0 $ , but is invalid because it does not contain the same number of 'A's as 'B's.
In the second example, the only matching ordering is "BBAAABABABBA".</div>
</article>
</div>
</div>
</body>
</html>
