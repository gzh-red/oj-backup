<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Underfail - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573397023:pmBxHO5LIO2gFQykrHDrhlJiXY8lboXpTtdK7BBdX+M=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22You%20have%20recently%20fallen%20through%20a%20hole%20and%2C%20after%20several%20hours%20of%20unconsciousness%2C%20have%20realized%20you%20are%20in%20an%20underground%20city.%20On%20one%20of%20your%20regular%2C%20daily%20walks%20through%20the%20unknown%2C%20you%20have%20encountered%20two%20unusually%20looking%20skeletons%20called%20Sanz%20and%20P%5Cu2019pairus%2C%20who%20decided%20to%20accompany%20you%20and%20give%20you%20some%20puzzles%20for%20seemingly%20unknown%20reasons.%5Cn%5CnOne%20day%2C%20Sanz%20has%20created%20a%20crossword%20for%20you.%20Not%20any%20kind%20of%20crossword%2C%20but%20a%201D%20crossword%21%20You%20are%20given%20%24%20m%20%24%20words%20and%20a%20string%20of%20length%20%24%20n%20%24%20.%20You%20are%20also%20given%20an%20array%20%24%20p%20%24%20%2C%20which%20designates%20how%20much%20each%20word%20is%20worth%20%5Cu2014%20the%20%24%20i%20%24%20-th%20word%20is%20worth%20%24%20p_%7Bi%7D%20%24%20points.%20Whenever%20you%20find%20one%20of%20the%20%24%20m%20%24%20words%20in%20the%20string%2C%20you%20are%20given%20the%20corresponding%20number%20of%20points.%20Each%20position%20in%20the%20crossword%20can%20be%20used%20at%20most%20%24%20x%20%24%20times.%20A%20certain%20word%20can%20be%20counted%20at%20different%20places%2C%20but%20you%20cannot%20count%20the%20same%20appearance%20of%20a%20word%20multiple%20times.%20If%20a%20word%20is%20a%20substring%20of%20another%20word%2C%20you%20can%20count%20them%20both%20%28presuming%20you%20haven%5Cu2019t%20used%20the%20positions%20more%20than%20%24%20x%20%24%20times%29.%5Cn%5CnIn%20order%20to%20solve%20the%20puzzle%2C%20you%20need%20to%20tell%20Sanz%20what%5Cu2019s%20the%20maximum%20achievable%20number%20of%20points%20in%20the%20crossword.%20There%20is%20no%20need%20to%20cover%20all%20postions%2C%20just%20get%20the%20maximal%20score%21%20Crossword%20and%20words%20contain%20only%20lowercase%20English%20letters.%22%2C%22inputFormat%22%3A%22The%20first%20line%20of%20the%20input%20contains%20a%20single%20integer%20%24%20n%20%24%20%28%20%24%201%3C%3Dn%3C%3D500%20%24%20%29%20%5Cu2014%20the%20length%20of%20the%20crossword.%20The%20second%20line%20contains%20the%20crossword%20string.%20The%20third%20line%20contains%20a%20single%20integer%20%24%20m%20%24%20%28%20%24%201%3C%3Dm%3C%3D100%20%24%20%29%20%5Cu2014%20the%20number%20of%20given%20words%2C%20and%20next%20%24%20m%20%24%20lines%20contain%20description%20of%20words%3A%20each%20line%20will%20have%20a%20string%20representing%20a%20non-empty%20word%20%28its%20length%20doesn%27t%20exceed%20the%20length%20of%20the%20crossword%29%20and%20integer%20%24%20p_%7Bi%7D%20%24%20%28%20%24%200%3C%3Dp_%7Bi%7D%3C%3D100%20%24%20%29.%20Last%20line%20of%20the%20input%20will%20contain%20%24%20x%20%24%20%28%20%24%201%3C%3Dx%3C%3D100%20%24%20%29%20%5Cu2014%20maximum%20number%20of%20times%20a%20position%20in%20crossword%20can%20be%20used.%22%2C%22outputFormat%22%3A%22Output%20single%20integer%20%5Cu2014%20maximum%20number%20of%20points%20you%20can%20get.%22%2C%22samples%22%3A%5B%5B%226%5Cnabacba%5Cn2%5Cnaba%206%5Cnba%203%5Cn3%5Cn%22%2C%2212%5Cn%22%5D%5D%2C%22hint%22%3A%22For%20example%2C%20with%20the%20string%20%5C%22abacba%5C%22%2C%20words%20%5C%22aba%5C%22%20%286%20points%29%20and%20%5C%22ba%5C%22%20%283%20points%29%2C%20and%20%24%20x%3D3%20%24%20%2C%20you%20can%20get%20at%20most%20%24%2012%20%24%20points%20-%20the%20word%20%5C%22aba%5C%22%20appears%20once%20%28%5C%22abacba%5C%22%29%2C%20while%20%5C%22ba%5C%22%20appears%20two%20times%20%28%5C%22abacba%5C%22%29.%20Note%20that%20for%20%24%20x%3D1%20%24%20%2C%20you%20could%20get%20at%20most%20%24%209%20%24%20points%2C%20since%20you%20wouldn%5Cu2019t%20be%20able%20to%20count%20both%20%5C%22aba%5C%22%20and%20the%20first%20appearance%20of%20%5C%22ba%5C%22.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F717%5C%2FG%22%2C%22id%22%3A%22717G%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A6%2C%22totalAccepted%22%3A5%2C%22pid%22%3A%22CF717G%22%2C%22title%22%3A%22Underfail%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Underfail%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Underfail</h1>
<h2>题目描述</h2>
<div>You have recently fallen through a hole and, after several hours of unconsciousness, have realized you are in an underground city. On one of your regular, daily walks through the unknown, you have encountered two unusually looking skeletons called Sanz and P’pairus, who decided to accompany you and give you some puzzles for seemingly unknown reasons.
One day, Sanz has created a crossword for you. Not any kind of crossword, but a 1D crossword! You are given $ m $ words and a string of length $ n $ . You are also given an array $ p $ , which designates how much each word is worth — the $ i $ -th word is worth $ p_{i} $ points. Whenever you find one of the $ m $ words in the string, you are given the corresponding number of points. Each position in the crossword can be used at most $ x $ times. A certain word can be counted at different places, but you cannot count the same appearance of a word multiple times. If a word is a substring of another word, you can count them both (presuming you haven’t used the positions more than $ x $ times).
In order to solve the puzzle, you need to tell Sanz what’s the maximum achievable number of points in the crossword. There is no need to cover all postions, just get the maximal score! Crossword and words contain only lowercase English letters.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line of the input contains a single integer $ n $ ( $ 1<=n<=500 $ ) — the length of the crossword. The second line contains the crossword string. The third line contains a single integer $ m $ ( $ 1<=m<=100 $ ) — the number of given words, and next $ m $ lines contain description of words: each line will have a string representing a non-empty word (its length doesn't exceed the length of the crossword) and integer $ p_{i} $ ( $ 0<=p_{i}<=100 $ ). Last line of the input will contain $ x $ ( $ 1<=x<=100 $ ) — maximum number of times a position in crossword can be used.</div>
<h3>输出格式</h3>
<br />
<div>Output single integer — maximum number of points you can get.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>6
abacba
2
aba 6
ba 3
3
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>12
</code></pre>
<h2>说明</h2>
<div>For example, with the string "abacba", words "aba" (6 points) and "ba" (3 points), and $ x=3 $ , you can get at most $ 12 $ points - the word "aba" appears once ("abacba"), while "ba" appears two times ("abacba"). Note that for $ x=1 $ , you could get at most $ 9 $ points, since you wouldn’t be able to count both "aba" and the first appearance of "ba".</div>
</article>
</div>
</div>
</body>
</html>
