<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Bender Problem - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573390070:SSchubhZn74E9nqKHEzurtpCTA6ndO8J5/rgsKlXgWQ=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Robot%20Bender%20decided%20to%20make%20Fray%20a%20birthday%20present.%20He%20drove%20%24%20n%20%24%20nails%20and%20numbered%20them%20from%20%24%201%20%24%20to%20%24%20n%20%24%20in%20some%20order.%20Bender%20decided%20to%20make%20a%20picture%20using%20metal%20rods.%20The%20picture%20is%20a%20closed%20polyline%2C%20which%20vertices%20should%20be%20nails%20%28in%20the%20given%20order%29.%20The%20segments%20of%20the%20polyline%20should%20be%20parallel%20to%20the%20coordinate%20axes.%20Polyline%20is%20allowed%20to%20have%20self-intersections.%20Bender%20can%20take%20a%20rod%20and%20fold%20it%20exactly%20once%20in%20any%20place%20to%20form%20an%20angle%20of%2090%20degrees.%20Then%20he%20can%20attach%20the%20place%20of%20the%20fold%20to%20some%20unoccupied%20nail%20and%20attach%20two%20ends%20of%20this%20rod%20to%20adjacent%20nails.%20A%20nail%20is%20considered%20unoccupied%20if%20there%20is%20no%20rod%20attached%20to%20it%20%28neither%20by%20it%27s%20end%20nor%20the%20by%20the%20fold%20place%29.%20No%20rod%20could%20be%20used%20twice.%20It%20is%20not%20required%20to%20use%20all%20the%20rods.%5Cn%5CnHelp%20Bender%20to%20solve%20this%20difficult%20task.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20two%20positive%20integers%20%24%20n%20%24%20and%20%24%20m%20%24%20%28%20%24%204%3C%3Dn%3C%3D500%2C2%3C%3Dm%3C%3D500%20%24%20%2C%20%24%20n%20%24%20is%20even%29%20%5Cu2014%20the%20amount%20of%20nails%20and%20the%20amount%20of%20rods.%20%24%20i%20%24%20-th%20of%20the%20following%20%24%20n%20%24%20lines%20contains%20a%20pair%20of%20integers%2C%20denoting%20the%20coordinates%20of%20the%20%24%20i%20%24%20-th%20nail.%20Nails%20should%20be%20connected%20in%20the%20same%20order%20as%20they%20are%20given%20in%20the%20input.%20The%20last%20line%20contains%20%24%20m%20%24%20integers%20%5Cu2014%20the%20lenghts%20of%20the%20rods.%20All%20coordinates%20do%20not%20exceed%20%24%2010%5E%7B4%7D%20%24%20by%20absolute%20value.%20Lengths%20of%20the%20rods%20are%20between%20%24%201%20%24%20and%20%24%20200000%20%24%20.%20No%20rod%20can%20be%20used%20twice.%20It%20is%20guaranteed%20that%20all%20segments%20of%20the%20given%20polyline%20are%20parallel%20to%20coordinate%20axes.%20No%20three%20consecutive%20nails%20lie%20on%20the%20same%20line.%22%2C%22outputFormat%22%3A%22If%20it%20is%20impossible%20to%20solve%20Bender%27s%20problem%2C%20output%20NO.%20Otherwise%2C%20output%20YES%20in%20the%20first%20line%2C%20and%20in%20the%20second%20line%20output%20%24%20n%20%24%20numbers%20%5Cu2014%20%24%20i%20%24%20-th%20of%20them%20should%20be%20the%20number%20of%20rod%2C%20which%20fold%20place%20is%20attached%20to%20the%20%24%20i%20%24%20-th%20nail%2C%20or%20-1%2C%20if%20there%20is%20no%20such%20rod.%5Cn%5CnIf%20there%20are%20multiple%20solutions%2C%20print%20any%20of%20them.%22%2C%22samples%22%3A%5B%5B%224%202%5Cn0%200%5Cn0%202%5Cn2%202%5Cn2%200%5Cn4%204%5Cn%22%2C%22YES%5Cn1%20-1%202%20-1%20%5Cn%22%5D%2C%5B%226%203%5Cn0%200%5Cn1%200%5Cn1%201%5Cn2%201%5Cn2%202%5Cn0%202%5Cn3%202%203%5Cn%22%2C%22YES%5Cn1%20-1%202%20-1%203%20-1%20%5Cn%22%5D%2C%5B%226%203%5Cn0%200%5Cn1%200%5Cn1%201%5Cn2%201%5Cn2%202%5Cn0%202%5Cn2%202%203%5Cn%22%2C%22NO%5Cn%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F28%5C%2FA%22%2C%22id%22%3A%2228A%22%7D%2C%22translation%22%3A%22%5Cu9898%5Cu610f%5Cuff1a%5Cu6709n%5Cu4e2a%5Cu9489%5Cu5b50%5Cuff0c%5Cu4ece1~n%5Cu7f16%5Cu53f7%5Cuff0c%5Cu6709m%5Cu6761%5Cu94c1%5Cu68d2%5Cuff0c%5Cu8981%5Cu6c42%5Cu7528%5Cu8fd9%5Cu4e9b%5Cu94c1%5Cu68d2%5Cu548c%5Cu9489%5Cu5b50%5Cu56f4%5Cu6210%5Cu4e00%5Cu4e2a%5Cu5c01%5Cu95ed%5Cu7684%5Cu6298%5Cu7ebf%5Cu3002%5Cu8981%5Cu6c42%5Cu94c1%5Cu68d2%5Cu4e0d%5Cu4e00%5Cu5b9a%5Cu5168%5Cu90e8%5Cu7528%5Cu5b8c%5Cuff0c%5Cu94c1%5Cu68d2%5Cu5fc5%5Cu987b%5Cu5e73%5Cu884c%5Cu4e8e%5Cu5750%5Cu6807%5Cu8f74%5Cu3002%5Cu73b0%5Cu5728%5Cu4ed6%5Cu8981%5Cu628a%5Cu94c1%5Cu68d2%5Cu5f2f%5Cu6210%5Cu76f4%5Cu89d2%5Cuff0c%5Cu8fd9%5Cu6837%5Cu4e2d%5Cu95f4%5Cu7684%5Cu6298%5Cu53e0%5Cu70b9%5Cu4e00%5Cu4e2a%5Cu9489%5Cu5b50%5Cuff0c%5Cu4e24%5Cu5934%5Cu5404%5Cu4e00%5Cu4e2a%5Cu9489%5Cu5b50%5Cuff0c%5Cu8981%5Cu6c42%5Cu6298%5Cu53e0%5Cu7684%5Cu8fd9%5Cu9897%5Cu9489%5Cu5b50%5Cu4e4b%5Cu524d%5Cu5fc5%5Cu987b%5Cu662f%5Cu6ca1%5Cu6709%5Cu522b%5Cu7684%5Cu68d2%5Cu8fde%5Cu63a5%5Cu7684%5Cuff08%5Cu4e5f%5Cu5c31%5Cu662f%5Cu7a7a%5Cu9489%5Cu5b50%5Cuff09%5Cuff0c%5Cu95ee%5Cu600e%5Cu4e48%5Cu9009%5Cu68d2%5Cuff0c%5Cu68d2%5Cu53ea%5Cu80fd%5Cu7528%5Cu4e00%5Cu6b21%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A9%2C%22totalAccepted%22%3A3%2C%22pid%22%3A%22CF28A%22%2C%22title%22%3A%22Bender%20Problem%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A61871%2C%22title%22%3A%22%5Cu7ffb%5Cu8bd1%22%2C%22forum%22%3A%7B%22id%22%3A12583%2C%22name%22%3A%22CF28A%20Bender%20Problem%22%2C%22slug%22%3A%22CF28A%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Bender%20Problem%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Bender Problem</h1>
<h2>题意翻译</h2>
<div>题意：有n个钉子，从1~n编号，有m条铁棒，要求用这些铁棒和钉子围成一个封闭的折线。要求铁棒不一定全部用完，铁棒必须平行于坐标轴。现在他要把铁棒弯成直角，这样中间的折叠点一个钉子，两头各一个钉子，要求折叠的这颗钉子之前必须是没有别的棒连接的（也就是空钉子），问怎么选棒，棒只能用一次</div>
<h2>题目描述</h2>
<div>Robot Bender decided to make Fray a birthday present. He drove $ n $ nails and numbered them from $ 1 $ to $ n $ in some order. Bender decided to make a picture using metal rods. The picture is a closed polyline, which vertices should be nails (in the given order). The segments of the polyline should be parallel to the coordinate axes. Polyline is allowed to have self-intersections. Bender can take a rod and fold it exactly once in any place to form an angle of 90 degrees. Then he can attach the place of the fold to some unoccupied nail and attach two ends of this rod to adjacent nails. A nail is considered unoccupied if there is no rod attached to it (neither by it's end nor the by the fold place). No rod could be used twice. It is not required to use all the rods.
Help Bender to solve this difficult task.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains two positive integers $ n $ and $ m $ ( $ 4<=n<=500,2<=m<=500 $ , $ n $ is even) — the amount of nails and the amount of rods. $ i $ -th of the following $ n $ lines contains a pair of integers, denoting the coordinates of the $ i $ -th nail. Nails should be connected in the same order as they are given in the input. The last line contains $ m $ integers — the lenghts of the rods. All coordinates do not exceed $ 10^{4} $ by absolute value. Lengths of the rods are between $ 1 $ and $ 200000 $ . No rod can be used twice. It is guaranteed that all segments of the given polyline are parallel to coordinate axes. No three consecutive nails lie on the same line.</div>
<h3>输出格式</h3>
<br />
<div>If it is impossible to solve Bender's problem, output NO. Otherwise, output YES in the first line, and in the second line output $ n $ numbers — $ i $ -th of them should be the number of rod, which fold place is attached to the $ i $ -th nail, or -1, if there is no such rod.
If there are multiple solutions, print any of them.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>4 2
0 0
0 2
2 2
2 0
4 4
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>YES
1 -1 2 -1 
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>6 3
0 0
1 0
1 1
2 1
2 2
0 2
3 2 3
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>YES
1 -1 2 -1 3 -1 
</code></pre>
<h3>输入样例 #3</h3>
<pre><code>6 3
0 0
1 0
1 1
2 1
2 2
0 2
2 2 3
</code></pre>
<h3>输出样例 #3</h3>
<pre><code>NO
</code></pre>
</article>
</div>
</div>
</body>
</html>
