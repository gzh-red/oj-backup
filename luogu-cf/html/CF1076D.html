<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Edge Deletion - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573401276:uHrF1srCF8kee1msYsqKys+BCsvDtpSAnxQlsHbM7bo=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22You%20are%20given%20an%20undirected%20connected%20weighted%20graph%20consisting%20of%20%24%20n%20%24%20vertices%20and%20%24%20m%20%24%20edges.%20Let%27s%20denote%20the%20length%20of%20the%20shortest%20path%20from%20vertex%20%24%201%20%24%20to%20vertex%20%24%20i%20%24%20as%20%24%20d_i%20%24%20.%5Cn%5CnYou%20have%20to%20erase%20some%20edges%20of%20the%20graph%20so%20that%20at%20most%20%24%20k%20%24%20edges%20remain.%20Let%27s%20call%20a%20vertex%20%24%20i%20%24%20good%20if%20there%20still%20exists%20a%20path%20from%20%24%201%20%24%20to%20%24%20i%20%24%20with%20length%20%24%20d_i%20%24%20after%20erasing%20the%20edges.%5Cn%5CnYour%20goal%20is%20to%20erase%20the%20edges%20in%20such%20a%20way%20that%20the%20number%20of%20good%20vertices%20is%20maximized.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20three%20integers%20%24%20n%20%24%20%2C%20%24%20m%20%24%20and%20%24%20k%20%24%20%28%20%24%202%20%5C%5Cle%20n%20%5C%5Cle%203%20%5C%5Ccdot%2010%5E5%20%24%20%2C%20%24%201%20%5C%5Cle%20m%20%5C%5Cle%203%20%5C%5Ccdot%2010%5E5%20%24%20%2C%20%24%20n%20-%201%20%5C%5Cle%20m%20%24%20%2C%20%24%200%20%5C%5Cle%20k%20%5C%5Cle%20m%20%24%20%29%20%5Cu2014%20the%20number%20of%20vertices%20and%20edges%20in%20the%20graph%2C%20and%20the%20maximum%20number%20of%20edges%20that%20can%20be%20retained%20in%20the%20graph%2C%20respectively.%5Cn%5CnThen%20%24%20m%20%24%20lines%20follow%2C%20each%20containing%20three%20integers%20%24%20x%20%24%20%2C%20%24%20y%20%24%20%2C%20%24%20w%20%24%20%28%20%24%201%20%5C%5Cle%20x%2C%20y%20%5C%5Cle%20n%20%24%20%2C%20%24%20x%20%5C%5Cne%20y%20%24%20%2C%20%24%201%20%5C%5Cle%20w%20%5C%5Cle%2010%5E9%20%24%20%29%2C%20denoting%20an%20edge%20connecting%20vertices%20%24%20x%20%24%20and%20%24%20y%20%24%20and%20having%20weight%20%24%20w%20%24%20.%5Cn%5CnThe%20given%20graph%20is%20connected%20%28any%20vertex%20can%20be%20reached%20from%20any%20other%20vertex%29%20and%20simple%20%28there%20are%20no%20self-loops%2C%20and%20for%20each%20unordered%20pair%20of%20vertices%20there%20exists%20at%20most%20one%20edge%20connecting%20these%20vertices%29.%22%2C%22outputFormat%22%3A%22In%20the%20first%20line%20print%20%24%20e%20%24%20%5Cu2014%20the%20number%20of%20edges%20that%20should%20remain%20in%20the%20graph%20%28%20%24%200%20%5C%5Cle%20e%20%5C%5Cle%20k%20%24%20%29.%5Cn%5CnIn%20the%20second%20line%20print%20%24%20e%20%24%20distinct%20integers%20from%20%24%201%20%24%20to%20%24%20m%20%24%20%5Cu2014%20the%20indices%20of%20edges%20that%20should%20remain%20in%20the%20graph.%20Edges%20are%20numbered%20in%20the%20same%20order%20they%20are%20given%20in%20the%20input.%20The%20number%20of%20good%20vertices%20should%20be%20as%20large%20as%20possible.%22%2C%22samples%22%3A%5B%5B%22%5Cn3%203%202%5Cn1%202%201%5Cn3%202%201%5Cn1%203%203%5Cn%22%2C%22%5Cn2%5Cn1%202%20%22%5D%2C%5B%22%5Cn4%205%202%5Cn4%201%208%5Cn2%204%201%5Cn2%201%203%5Cn3%204%209%5Cn3%201%205%5Cn%22%2C%22%5Cn2%5Cn3%202%20%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2500%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F1076%5C%2FD%22%2C%22id%22%3A%221076D%22%7D%2C%22translation%22%3A%22%23%23%20%5Cu9898%5Cu76ee%5Cu63cf%5Cu8ff0%5Cr%5Cn%5Cr%5Cn%5Cu7ed9%5Cu4e00%5Cu4e2a%24n%24%5Cu4e2a%5Cu70b9%2C%24m%24%5Cu6761%5Cu8fb9%5Cu7684%5Cu65e0%5Cu5411%5Cu7b80%5Cu5355%5Cu5e26%5Cu6743%5Cu8fde%5Cu901a%5Cu56fe%2C%20%5Cu8981%5Cu6c42%5Cu5220%5Cu8fb9%5Cu81f3%5Cu6700%5Cu591a%5Cu5269%5Cu4f59%24k%24%5Cu6761%5Cu8fb9.%5Cr%5Cn%5Cr%5Cn%5Cu5b9a%5Cu4e49%5C%22%5Cu597d%5Cu70b9%5C%22%5Cu662f%5Cu6307%5Cu5220%5Cu8fb9%5Cu540e%2C%201%5Cu53f7%5Cu8282%5Cu70b9%5Cu5230%5Cu5b83%5Cu7684%5Cu6700%5Cu77ed%5Cu8def%5Cu957f%5Cu5ea6%5Cu4ecd%5Cu7136%5Cu7b49%5Cu4e8e%5Cu539f%5Cu56fe%5Cu6700%5Cu77ed%5Cu8def%5Cu957f%5Cu5ea6%5Cu7684%5Cu8282%5Cu70b9.%5Cr%5Cn%5Cr%5Cn%5Cu6700%5Cu5927%5Cu5316%5Cu5220%5Cu8fb9%5Cu540e%5Cu7684%5Cu597d%5Cu70b9%5Cu4e2a%5Cu6570.%5Cr%5Cn%5Cr%5Cn%23%23%20%5Cu8f93%5Cu5165%5Cu683c%5Cu5f0f%5Cr%5Cn%5Cr%5Cn%5Cu7b2c%5Cu4e00%5Cu884c%5Cu4e09%5Cu4e2a%5Cu6574%5Cu6570%24n%2Cm%2Ck%24.%5Cu63a5%5Cu4e0b%5Cu6765%24m%24%5Cu884c%5Cu6bcf%5Cu884c%5Cu4e09%5Cu4e2a%5Cu6574%5Cu6570%2C%20%24u%2Cv%2Cw%24%2C%20%5Cu5206%5Cu522b%5Cu4e3a%5Cu7aef%5Cu70b9%5Cu548c%5Cu8fb9%5Cu6743.%5Cr%5Cn%5Cr%5Cn%23%23%20%5Cu8f93%5Cu51fa%5Cu683c%5Cu5f0f%5Cr%5Cn%5Cr%5Cn%5Cu7b2c%5Cu4e00%5Cu884c%5Cu4e00%5Cu4e2a%5Cu6574%5Cu6570%24e%2C%20%280%20%5C%5Cle%20e%20%5C%5Cle%20k%29%24%2C%20%5Cu9700%5Cu8981%5Cu4fdd%5Cu7559%5Cu7684%5Cu8fb9%5Cu6570.%5Cr%5Cn%5Cr%5Cn%5Cu63a5%5Cu4e0b%5Cu6765%5Cu4e00%5Cu884c%24e%24%5Cu4e2a%5Cu6574%5Cu6570%2C%20%5Cu4fdd%5Cu7559%5Cu7684%5Cu8fb9%5Cu7684%5Cu7f16%5Cu53f7%2C%20%5Cu8fb9%5Cu662f%5Cu6309%5Cu8f93%5Cu5165%5Cu987a%5Cu5e8f%5Cu7f16%5Cu53f7%5Cu7684%2C%20%5Cu4f46%5Cu8f93%5Cu51fa%5Cu53ef%5Cu4ee5%5Cu4ee5%5Cu4efb%5Cu610f%5Cu987a%5Cu5e8f.%5Cr%5Cn%5Cr%5Cn%23%23%20%5Cu6570%5Cu636e%5Cu8303%5Cu56f4%5Cr%5Cn%5Cr%5Cn%24n%2C%20m%20%5C%5Cle%203%20%5C%5Ctimes%2010%5E5%24.%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A173%2C%22totalAccepted%22%3A59%2C%22pid%22%3A%22CF1076D%22%2C%22title%22%3A%22Edge%20Deletion%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P3350%22%2C%22title%22%3A%22%5BZJOI2016%5D%5Cu65c5%5Cu884c%5Cu8005%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22CF449B%22%2C%22title%22%3A%22Jzzhu%20and%20Cities%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1051F%22%2C%22title%22%3A%22The%20Shortest%20Statement%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1076E%22%2C%22title%22%3A%22Vasya%20and%20a%20Tree%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1239C%22%2C%22title%22%3A%22Queue%20in%20the%20Train%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Edge%20Deletion%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Edge Deletion</h1>
<h2>题意翻译</h2>
<div>## 题目描述
给一个$n$个点,$m$条边的无向简单带权连通图, 要求删边至最多剩余$k$条边.
定义"好点"是指删边后, 1号节点到它的最短路长度仍然等于原图最短路长度的节点.
最大化删边后的好点个数.
## 输入格式
第一行三个整数$n,m,k$.接下来$m$行每行三个整数, $u,v,w$, 分别为端点和边权.
## 输出格式
第一行一个整数$e, (0 \le e \le k)$, 需要保留的边数.
接下来一行$e$个整数, 保留的边的编号, 边是按输入顺序编号的, 但输出可以以任意顺序.
## 数据范围
$n, m \le 3 \times 10^5$.</div>
<h2>题目描述</h2>
<div>You are given an undirected connected weighted graph consisting of $ n $ vertices and $ m $ edges. Let's denote the length of the shortest path from vertex $ 1 $ to vertex $ i $ as $ d_i $ .
You have to erase some edges of the graph so that at most $ k $ edges remain. Let's call a vertex $ i $ good if there still exists a path from $ 1 $ to $ i $ with length $ d_i $ after erasing the edges.
Your goal is to erase the edges in such a way that the number of good vertices is maximized.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains three integers $ n $ , $ m $ and $ k $ ( $ 2 \le n \le 3 \cdot 10^5 $ , $ 1 \le m \le 3 \cdot 10^5 $ , $ n - 1 \le m $ , $ 0 \le k \le m $ ) — the number of vertices and edges in the graph, and the maximum number of edges that can be retained in the graph, respectively.
Then $ m $ lines follow, each containing three integers $ x $ , $ y $ , $ w $ ( $ 1 \le x, y \le n $ , $ x \ne y $ , $ 1 \le w \le 10^9 $ ), denoting an edge connecting vertices $ x $ and $ y $ and having weight $ w $ .
The given graph is connected (any vertex can be reached from any other vertex) and simple (there are no self-loops, and for each unordered pair of vertices there exists at most one edge connecting these vertices).</div>
<h3>输出格式</h3>
<br />
<div>In the first line print $ e $ — the number of edges that should remain in the graph ( $ 0 \le e \le k $ ).
In the second line print $ e $ distinct integers from $ 1 $ to $ m $ — the indices of edges that should remain in the graph. Edges are numbered in the same order they are given in the input. The number of good vertices should be as large as possible.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>
3 3 2
1 2 1
3 2 1
1 3 3
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>
2
1 2 </code></pre>
<h3>输入样例 #2</h3>
<pre><code>
4 5 2
4 1 8
2 4 1
2 1 3
3 4 9
3 1 5
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>
2
3 2 </code></pre>
</article>
</div>
</div>
</body>
</html>
