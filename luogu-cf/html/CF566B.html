<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Replicating Processes - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573395430:9g7cZfSND9LNryb4SDrym6JO/C9CHZgNTosJk3ubo40=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22A%20Large%20Software%20Company%20develops%20its%20own%20social%20network.%20Analysts%20have%20found%20that%20during%20the%20holidays%2C%20major%20sporting%20events%20and%20other%20significant%20events%20users%20begin%20to%20enter%20the%20network%20more%20frequently%2C%20resulting%20in%20great%20load%20increase%20on%20the%20infrastructure.%5Cn%5CnAs%20part%20of%20this%20task%2C%20we%20assume%20that%20the%20social%20network%20is%20%24%204n%20%24%20processes%20running%20on%20the%20%24%20n%20%24%20servers.%20All%20servers%20are%20absolutely%20identical%20machines%2C%20each%20of%20which%20has%20a%20volume%20of%20RAM%20of%20%24%201%20%24%20GB%20%3D%20%24%201024%20%24%20MB%20%24%20%5E%7B%281%29%7D%20%24%20.%20Each%20process%20takes%20100%20MB%20of%20RAM%20on%20the%20server.%20At%20the%20same%20time%2C%20the%20needs%20of%20maintaining%20the%20viability%20of%20the%20server%20takes%20about%20%24%20100%20%24%20more%20megabytes%20of%20RAM.%20Thus%2C%20each%20server%20may%20have%20up%20to%20%24%209%20%24%20different%20processes%20of%20social%20network.%5Cn%5CnNow%20each%20of%20the%20%24%20n%20%24%20servers%20is%20running%20exactly%20%24%204%20%24%20processes.%20However%2C%20at%20the%20moment%20of%20peak%20load%20it%20is%20sometimes%20necessary%20to%20replicate%20the%20existing%20%24%204n%20%24%20processes%20by%20creating%20%24%208n%20%24%20new%20processes%20instead%20of%20the%20old%20ones.%20More%20formally%2C%20there%20is%20a%20set%20of%20replication%20rules%2C%20the%20%24%20i%20%24%20-th%20%28%20%24%201%3C%3Di%3C%3D4n%20%24%20%29%20of%20which%20has%20the%20form%20of%20%24%20a_%7Bi%7D%5Cu2192%28b_%7Bi%7D%2Cc_%7Bi%7D%29%20%24%20%2C%20where%20%24%20a_%7Bi%7D%20%24%20%2C%20%24%20b_%7Bi%7D%20%24%20and%20%24%20c_%7Bi%7D%20%24%20%28%20%24%201%3C%3Da_%7Bi%7D%2Cb_%7Bi%7D%2Cc_%7Bi%7D%3C%3Dn%20%24%20%29%20are%20the%20numbers%20of%20servers.%20This%20means%20that%20instead%20of%20an%20old%20process%20running%20on%20server%20%24%20a_%7Bi%7D%20%24%20%2C%20there%20should%20appear%20two%20new%20copies%20of%20the%20process%20running%20on%20servers%20%24%20b_%7Bi%7D%20%24%20and%20%24%20c_%7Bi%7D%20%24%20.%20The%20two%20new%20replicated%20processes%20can%20be%20on%20the%20same%20server%20%28i.e.%2C%20%24%20b_%7Bi%7D%20%24%20may%20be%20equal%20to%20%24%20c_%7Bi%7D%20%24%20%29%20or%20even%20on%20the%20same%20server%20where%20the%20original%20process%20was%20%28i.e.%20%24%20a_%7Bi%7D%20%24%20may%20be%20equal%20to%20%24%20b_%7Bi%7D%20%24%20or%20%24%20c_%7Bi%7D%20%24%20%29.%20During%20the%20implementation%20of%20the%20rule%20%24%20a_%7Bi%7D%5Cu2192%28b_%7Bi%7D%2Cc_%7Bi%7D%29%20%24%20first%20the%20process%20from%20the%20server%20%24%20a_%7Bi%7D%20%24%20is%20destroyed%2C%20then%20appears%20a%20process%20on%20the%20server%20%24%20b_%7Bi%7D%20%24%20%2C%20then%20appears%20a%20process%20on%20the%20server%20%24%20c_%7Bi%7D%20%24%20.%5Cn%5CnThere%20is%20a%20set%20of%20%24%204n%20%24%20rules%2C%20destroying%20all%20the%20original%20%24%204n%20%24%20processes%20from%20%24%20n%20%24%20servers%2C%20and%20creating%20after%20their%20application%20%24%208n%20%24%20replicated%20processes%2C%20besides%2C%20on%20each%20of%20the%20%24%20n%20%24%20servers%20will%20be%20exactly%20%24%208%20%24%20processes.%20However%2C%20the%20rules%20can%20only%20be%20applied%20consecutively%2C%20and%20therefore%20the%20amount%20of%20RAM%20of%20the%20servers%20imposes%20limitations%20on%20the%20procedure%20for%20the%20application%20of%20the%20rules.%5Cn%5CnAccording%20to%20this%20set%20of%20rules%20determine%20the%20order%20in%20which%20you%20want%20to%20apply%20all%20the%20%24%204n%20%24%20rules%20so%20that%20at%20any%20given%20time%20the%20memory%20of%20each%20of%20the%20servers%20contained%20at%20most%20%24%209%20%24%20processes%20%28old%20and%20new%20together%29%2C%20or%20tell%20that%20it%20is%20impossible.%22%2C%22inputFormat%22%3A%22The%20first%20line%20of%20the%20input%20contains%20integer%20%24%20n%20%24%20%28%20%24%201%3C%3Dn%3C%3D30000%20%24%20%29%20%5Cu2014%20the%20number%20of%20servers%20of%20the%20social%20network.%5Cn%5CnNext%20%24%204n%20%24%20lines%20contain%20the%20rules%20of%20replicating%20processes%2C%20the%20%24%20i%20%24%20-th%20%28%20%24%201%3C%3Di%3C%3D4n%20%24%20%29%20of%20these%20lines%20as%20form%20%24%20a_%7Bi%7D%2Cb_%7Bi%7D%2Cc_%7Bi%7D%20%24%20%28%20%24%201%3C%3Da_%7Bi%7D%2Cb_%7Bi%7D%2Cc_%7Bi%7D%3C%3Dn%20%24%20%29%20and%20describes%20rule%20%24%20a_%7Bi%7D%5Cu2192%28b_%7Bi%7D%2Cc_%7Bi%7D%29%20%24%20.%5Cn%5CnIt%20is%20guaranteed%20that%20each%20number%20of%20a%20server%20from%20%24%201%20%24%20to%20%24%20n%20%24%20occurs%20four%20times%20in%20the%20set%20of%20all%20%24%20a_%7Bi%7D%20%24%20%2C%20and%20eight%20times%20among%20a%20set%20that%20unites%20all%20%24%20b_%7Bi%7D%20%24%20and%20%24%20c_%7Bi%7D%20%24%20.%22%2C%22outputFormat%22%3A%22If%20the%20required%20order%20of%20performing%20rules%20does%20not%20exist%2C%20print%20%5C%22NO%5C%22%20%28without%20the%20quotes%29.%5Cn%5CnOtherwise%2C%20print%20in%20the%20first%20line%20%5C%22YES%5C%22%20%28without%20the%20quotes%29%2C%20and%20in%20the%20second%20line%20%5Cu2014%20a%20sequence%20of%20%24%204n%20%24%20numbers%20from%20%24%201%20%24%20to%20%24%204n%20%24%20%2C%20giving%20the%20numbers%20of%20the%20rules%20in%20the%20order%20they%20are%20applied.%20The%20sequence%20should%20be%20a%20permutation%2C%20that%20is%2C%20include%20each%20number%20from%20%24%201%20%24%20to%20%24%204n%20%24%20exactly%20once.%5Cn%5CnIf%20there%20are%20multiple%20possible%20variants%2C%20you%20are%20allowed%20to%20print%20any%20of%20them.%22%2C%22samples%22%3A%5B%5B%222%5Cn1%202%202%5Cn1%202%202%5Cn1%202%202%5Cn1%202%202%5Cn2%201%201%5Cn2%201%201%5Cn2%201%201%5Cn2%201%201%5Cn%22%2C%22YES%5Cn1%202%205%206%203%207%204%208%5Cn%22%5D%2C%5B%223%5Cn1%202%203%5Cn1%201%201%5Cn1%201%201%5Cn1%201%201%5Cn2%201%203%5Cn2%202%202%5Cn2%202%202%5Cn2%202%202%5Cn3%201%202%5Cn3%203%203%5Cn3%203%203%5Cn3%203%203%5Cn%22%2C%22YES%5Cn2%203%204%206%207%208%2010%2011%2012%201%205%209%5Cn%22%5D%5D%2C%22hint%22%3A%22%20%24%20%5E%7B%281%29%7D%20%24%20To%20be%20extremely%20accurate%2C%20we%20should%20note%20that%20the%20amount%20of%20server%20memory%20is%20%24%201%20%24%20GiB%20%3D%20%24%201024%20%24%20MiB%20and%20processes%20require%20%24%20100%20%24%20MiB%20RAM%20where%20a%20gibibyte%20%28GiB%29%20is%20the%20amount%20of%20RAM%20of%20%24%202%5E%7B30%7D%20%24%20bytes%20and%20a%20mebibyte%20%28MiB%29%20is%20the%20amount%20of%20RAM%20of%20%24%202%5E%7B20%7D%20%24%20bytes.%5Cn%5CnIn%20the%20first%20sample%20test%20the%20network%20uses%20two%20servers%2C%20each%20of%20which%20initially%20has%20four%20launched%20processes.%20In%20accordance%20with%20the%20rules%20of%20replication%2C%20each%20of%20the%20processes%20must%20be%20destroyed%20and%20twice%20run%20on%20another%20server.%20One%20of%20the%20possible%20answers%20is%20given%20in%20the%20statement%3A%20after%20applying%20rules%20%24%201%20%24%20and%20%24%202%20%24%20the%20first%20server%20will%20have%20%24%202%20%24%20old%20running%20processes%2C%20and%20the%20second%20server%20will%20have%20%24%208%20%24%20%28%20%24%204%20%24%20old%20and%20%24%204%20%24%20new%29%20processes.%20After%20we%20apply%20rules%20%24%205%20%24%20and%20%24%206%20%24%20%2C%20both%20servers%20will%20have%20%24%206%20%24%20running%20processes%20%28%20%24%202%20%24%20old%20and%20%24%204%20%24%20new%29.%20After%20we%20apply%20rules%20%24%203%20%24%20and%20%24%207%20%24%20%2C%20both%20servers%20will%20have%20%24%207%20%24%20running%20processes%20%28%20%24%201%20%24%20old%20and%20%24%206%20%24%20new%29%2C%20and%20after%20we%20apply%20rules%20%24%204%20%24%20and%20%24%208%20%24%20%2C%20each%20server%20will%20have%20%24%208%20%24%20running%20processes.%20At%20no%20time%20the%20number%20of%20processes%20on%20a%20single%20server%20exceeds%20%24%209%20%24%20.%5Cn%5CnIn%20the%20second%20sample%20test%20the%20network%20uses%20three%20servers.%20On%20each%20server%2C%20three%20processes%20are%20replicated%20into%20two%20processes%20on%20the%20same%20server%2C%20and%20the%20fourth%20one%20is%20replicated%20in%20one%20process%20for%20each%20of%20the%20two%20remaining%20servers.%20As%20a%20result%20of%20applying%20rules%20%24%202%2C3%2C4%2C6%2C7%2C8%2C10%2C11%2C12%20%24%20each%20server%20would%20have%20%24%207%20%24%20processes%20%28%20%24%206%20%24%20old%20and%20%24%201%20%24%20new%29%2C%20as%20a%20result%20of%20applying%20rules%20%24%201%2C5%2C9%20%24%20each%20server%20will%20have%20%24%208%20%24%20processes.%20At%20no%20time%20the%20number%20of%20processes%20on%20a%20single%20server%20exceeds%20%24%209%20%24%20.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F566%5C%2FB%22%2C%22id%22%3A%22566B%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22CF566B%22%2C%22title%22%3A%22Replicating%20Processes%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Replicating%20Processes%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573306449;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Replicating Processes</h1>
<h2>题目描述</h2>
<div>A Large Software Company develops its own social network. Analysts have found that during the holidays, major sporting events and other significant events users begin to enter the network more frequently, resulting in great load increase on the infrastructure.
As part of this task, we assume that the social network is $ 4n $ processes running on the $ n $ servers. All servers are absolutely identical machines, each of which has a volume of RAM of $ 1 $ GB = $ 1024 $ MB $ ^{(1)} $ . Each process takes 100 MB of RAM on the server. At the same time, the needs of maintaining the viability of the server takes about $ 100 $ more megabytes of RAM. Thus, each server may have up to $ 9 $ different processes of social network.
Now each of the $ n $ servers is running exactly $ 4 $ processes. However, at the moment of peak load it is sometimes necessary to replicate the existing $ 4n $ processes by creating $ 8n $ new processes instead of the old ones. More formally, there is a set of replication rules, the $ i $ -th ( $ 1<=i<=4n $ ) of which has the form of $ a_{i}→(b_{i},c_{i}) $ , where $ a_{i} $ , $ b_{i} $ and $ c_{i} $ ( $ 1<=a_{i},b_{i},c_{i}<=n $ ) are the numbers of servers. This means that instead of an old process running on server $ a_{i} $ , there should appear two new copies of the process running on servers $ b_{i} $ and $ c_{i} $ . The two new replicated processes can be on the same server (i.e., $ b_{i} $ may be equal to $ c_{i} $ ) or even on the same server where the original process was (i.e. $ a_{i} $ may be equal to $ b_{i} $ or $ c_{i} $ ). During the implementation of the rule $ a_{i}→(b_{i},c_{i}) $ first the process from the server $ a_{i} $ is destroyed, then appears a process on the server $ b_{i} $ , then appears a process on the server $ c_{i} $ .
There is a set of $ 4n $ rules, destroying all the original $ 4n $ processes from $ n $ servers, and creating after their application $ 8n $ replicated processes, besides, on each of the $ n $ servers will be exactly $ 8 $ processes. However, the rules can only be applied consecutively, and therefore the amount of RAM of the servers imposes limitations on the procedure for the application of the rules.
According to this set of rules determine the order in which you want to apply all the $ 4n $ rules so that at any given time the memory of each of the servers contained at most $ 9 $ processes (old and new together), or tell that it is impossible.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line of the input contains integer $ n $ ( $ 1<=n<=30000 $ ) — the number of servers of the social network.
Next $ 4n $ lines contain the rules of replicating processes, the $ i $ -th ( $ 1<=i<=4n $ ) of these lines as form $ a_{i},b_{i},c_{i} $ ( $ 1<=a_{i},b_{i},c_{i}<=n $ ) and describes rule $ a_{i}→(b_{i},c_{i}) $ .
It is guaranteed that each number of a server from $ 1 $ to $ n $ occurs four times in the set of all $ a_{i} $ , and eight times among a set that unites all $ b_{i} $ and $ c_{i} $ .</div>
<h3>输出格式</h3>
<br />
<div>If the required order of performing rules does not exist, print "NO" (without the quotes).
Otherwise, print in the first line "YES" (without the quotes), and in the second line — a sequence of $ 4n $ numbers from $ 1 $ to $ 4n $ , giving the numbers of the rules in the order they are applied. The sequence should be a permutation, that is, include each number from $ 1 $ to $ 4n $ exactly once.
If there are multiple possible variants, you are allowed to print any of them.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>2
1 2 2
1 2 2
1 2 2
1 2 2
2 1 1
2 1 1
2 1 1
2 1 1
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>YES
1 2 5 6 3 7 4 8
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>3
1 2 3
1 1 1
1 1 1
1 1 1
2 1 3
2 2 2
2 2 2
2 2 2
3 1 2
3 3 3
3 3 3
3 3 3
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>YES
2 3 4 6 7 8 10 11 12 1 5 9
</code></pre>
<h2>说明</h2>
<div> $ ^{(1)} $ To be extremely accurate, we should note that the amount of server memory is $ 1 $ GiB = $ 1024 $ MiB and processes require $ 100 $ MiB RAM where a gibibyte (GiB) is the amount of RAM of $ 2^{30} $ bytes and a mebibyte (MiB) is the amount of RAM of $ 2^{20} $ bytes.
In the first sample test the network uses two servers, each of which initially has four launched processes. In accordance with the rules of replication, each of the processes must be destroyed and twice run on another server. One of the possible answers is given in the statement: after applying rules $ 1 $ and $ 2 $ the first server will have $ 2 $ old running processes, and the second server will have $ 8 $ ( $ 4 $ old and $ 4 $ new) processes. After we apply rules $ 5 $ and $ 6 $ , both servers will have $ 6 $ running processes ( $ 2 $ old and $ 4 $ new). After we apply rules $ 3 $ and $ 7 $ , both servers will have $ 7 $ running processes ( $ 1 $ old and $ 6 $ new), and after we apply rules $ 4 $ and $ 8 $ , each server will have $ 8 $ running processes. At no time the number of processes on a single server exceeds $ 9 $ .
In the second sample test the network uses three servers. On each server, three processes are replicated into two processes on the same server, and the fourth one is replicated in one process for each of the two remaining servers. As a result of applying rules $ 2,3,4,6,7,8,10,11,12 $ each server would have $ 7 $ processes ( $ 6 $ old and $ 1 $ new), as a result of applying rules $ 1,5,9 $ each server will have $ 8 $ processes. At no time the number of processes on a single server exceeds $ 9 $ .</div>
</article>
</div>
</div>
</body>
</html>
