<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Another Sith Tournament - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573396601:C78xtdaFB99k2fxmX5b5vTepH5GHncoOhrHn57B1fY4=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22The%20rules%20of%20Sith%20Tournament%20are%20well%20known%20to%20everyone.%20%24%20n%20%24%20Sith%20take%20part%20in%20the%20Tournament.%20The%20Tournament%20starts%20with%20the%20random%20choice%20of%20two%20Sith%20who%20will%20fight%20in%20the%20first%20battle.%20As%20one%20of%20them%20loses%2C%20his%20place%20is%20taken%20by%20the%20next%20randomly%20chosen%20Sith%20who%20didn%27t%20fight%20before.%20Does%20it%20need%20to%20be%20said%20that%20each%20battle%20in%20the%20Sith%20Tournament%20ends%20with%20a%20death%20of%20one%20of%20opponents%3F%20The%20Tournament%20ends%20when%20the%20only%20Sith%20remains%20alive.%5Cn%5CnJedi%20Ivan%20accidentally%20appeared%20in%20the%20list%20of%20the%20participants%20in%20the%20Sith%20Tournament.%20However%2C%20his%20skills%20in%20the%20Light%20Side%20of%20the%20Force%20are%20so%20strong%20so%20he%20can%20influence%20the%20choice%20of%20participants%20either%20who%20start%20the%20Tournament%20or%20who%20take%20the%20loser%27s%20place%20after%20each%20battle.%20Of%20course%2C%20he%20won%27t%20miss%20his%20chance%20to%20take%20advantage%20of%20it.%20Help%20him%20to%20calculate%20the%20probability%20of%20his%20victory.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20a%20single%20integer%20%24%20n%20%24%20%28%20%24%201%3C%3Dn%3C%3D18%20%24%20%29%20%5Cu2014%20the%20number%20of%20participants%20of%20the%20Sith%20Tournament.%5Cn%5CnEach%20of%20the%20next%20%24%20n%20%24%20lines%20contains%20%24%20n%20%24%20real%20numbers%2C%20which%20form%20a%20matrix%20%24%20p_%7Bij%7D%20%24%20%28%20%24%200%3C%3Dp_%7Bij%7D%3C%3D1%20%24%20%29.%20Each%20its%20element%20%24%20p_%7Bij%7D%20%24%20is%20the%20probability%20that%20the%20%24%20i%20%24%20-th%20participant%20defeats%20the%20%24%20j%20%24%20-th%20in%20a%20duel.%5Cn%5CnThe%20elements%20on%20the%20main%20diagonal%20%24%20p_%7Bii%7D%20%24%20are%20equal%20to%20zero.%20For%20all%20different%20%24%20i%20%24%20%2C%20%24%20j%20%24%20the%20equality%20%24%20p_%7Bij%7D%2Bp_%7Bji%7D%3D1%20%24%20holds.%20All%20probabilities%20are%20given%20with%20no%20more%20than%20six%20decimal%20places.%5Cn%5CnJedi%20Ivan%20is%20the%20number%20%24%201%20%24%20in%20the%20list%20of%20the%20participants.%22%2C%22outputFormat%22%3A%22Output%20a%20real%20number%20%5Cu2014%20the%20probability%20that%20Jedi%20Ivan%20will%20stay%20alive%20after%20the%20Tournament.%20Absolute%20or%20relative%20error%20of%20the%20answer%20must%20not%20exceed%20%24%2010%5E%7B-6%7D%20%24%20.%22%2C%22samples%22%3A%5B%5B%223%5Cn0.0%200.5%200.8%5Cn0.5%200.0%200.4%5Cn0.2%200.6%200.0%5Cn%22%2C%220.680000000000000%5Cn%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2500%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F678%5C%2FE%22%2C%22id%22%3A%22678E%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A135%2C%22totalAccepted%22%3A12%2C%22pid%22%3A%22CF678E%22%2C%22title%22%3A%22Another%20Sith%20Tournament%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A165573%2C%22title%22%3A%22%5Cu8fd9%5Cu9898%5Cu662f%5Cu4e0d%5Cu662f%5Cu53ef%5Cu4ee5n%5E3%5Cu8d2a%5Cu5fc3%22%2C%22forum%22%3A%7B%22id%22%3A9936%2C%22name%22%3A%22CF678E%20Another%20Sith%20Tournament%22%2C%22slug%22%3A%22CF678E%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22CF915F%22%2C%22title%22%3A%22Imbalance%20Value%20of%20a%20Tree%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF704B%22%2C%22title%22%3A%22Ant%20Man%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF691E%22%2C%22title%22%3A%22Xor-sequences%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22SP1716%22%2C%22title%22%3A%22GSS3%20-%20Can%20you%20answer%20these%20queries%20III%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22SP%22%7D%2C%7B%22pid%22%3A%22P5123%22%2C%22title%22%3A%22%5BUSACO18DEC%5DCowpatibility%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Another%20Sith%20Tournament%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Another Sith Tournament</h1>
<h2>题目描述</h2>
<div>The rules of Sith Tournament are well known to everyone. $ n $ Sith take part in the Tournament. The Tournament starts with the random choice of two Sith who will fight in the first battle. As one of them loses, his place is taken by the next randomly chosen Sith who didn't fight before. Does it need to be said that each battle in the Sith Tournament ends with a death of one of opponents? The Tournament ends when the only Sith remains alive.
Jedi Ivan accidentally appeared in the list of the participants in the Sith Tournament. However, his skills in the Light Side of the Force are so strong so he can influence the choice of participants either who start the Tournament or who take the loser's place after each battle. Of course, he won't miss his chance to take advantage of it. Help him to calculate the probability of his victory.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains a single integer $ n $ ( $ 1<=n<=18 $ ) — the number of participants of the Sith Tournament.
Each of the next $ n $ lines contains $ n $ real numbers, which form a matrix $ p_{ij} $ ( $ 0<=p_{ij}<=1 $ ). Each its element $ p_{ij} $ is the probability that the $ i $ -th participant defeats the $ j $ -th in a duel.
The elements on the main diagonal $ p_{ii} $ are equal to zero. For all different $ i $ , $ j $ the equality $ p_{ij}+p_{ji}=1 $ holds. All probabilities are given with no more than six decimal places.
Jedi Ivan is the number $ 1 $ in the list of the participants.</div>
<h3>输出格式</h3>
<br />
<div>Output a real number — the probability that Jedi Ivan will stay alive after the Tournament. Absolute or relative error of the answer must not exceed $ 10^{-6} $ .</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>3
0.0 0.5 0.8
0.5 0.0 0.4
0.2 0.6 0.0
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>0.680000000000000
</code></pre>
</article>
</div>
</div>
</body>
</html>
