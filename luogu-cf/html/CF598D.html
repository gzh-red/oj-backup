<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Igor In the Museum - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573395821:sySfCYnGhqtuCku4nfM5nlFP7kpCR3AQerXuiK6XcT8=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Igor%20is%20in%20the%20museum%20and%20he%20wants%20to%20see%20as%20many%20pictures%20as%20possible.%5Cn%5CnMuseum%20can%20be%20represented%20as%20a%20rectangular%20field%20of%20%24%20n%5Cu00d7m%20%24%20cells.%20Each%20cell%20is%20either%20empty%20or%20impassable.%20Empty%20cells%20are%20marked%20with%20%27.%27%2C%20impassable%20cells%20are%20marked%20with%20%27%5C%5C%2A%27.%20Every%20two%20adjacent%20cells%20of%20different%20types%20%28one%20empty%20and%20one%20impassable%29%20are%20divided%20by%20a%20wall%20containing%20one%20picture.%5Cn%5CnAt%20the%20beginning%20Igor%20is%20in%20some%20empty%20cell.%20At%20every%20moment%20he%20can%20move%20to%20any%20empty%20cell%20that%20share%20a%20side%20with%20the%20current%20one.%5Cn%5CnFor%20several%20starting%20positions%20you%20should%20calculate%20the%20maximum%20number%20of%20pictures%20that%20Igor%20can%20see.%20Igor%20is%20able%20to%20see%20the%20picture%20only%20if%20he%20is%20in%20the%20cell%20adjacent%20to%20the%20wall%20with%20this%20picture.%20Igor%20have%20a%20lot%20of%20time%2C%20so%20he%20will%20examine%20every%20picture%20he%20can%20see.%22%2C%22inputFormat%22%3A%22First%20line%20of%20the%20input%20contains%20three%20integers%20%24%20n%20%24%20%2C%20%24%20m%20%24%20and%20%24%20k%20%24%20%28%20%24%203%3C%3Dn%2Cm%3C%3D1000%2C1%3C%3Dk%3C%3Dmin%28n%5Cu00b7m%2C100000%29%20%24%20%29%20%5Cu2014%20the%20museum%20dimensions%20and%20the%20number%20of%20starting%20positions%20to%20process.%5Cn%5CnEach%20of%20the%20next%20%24%20n%20%24%20lines%20contains%20%24%20m%20%24%20symbols%20%27.%27%2C%20%27%5C%5C%2A%27%20%5Cu2014%20the%20description%20of%20the%20museum.%20It%20is%20guaranteed%20that%20all%20border%20cells%20are%20impassable%2C%20so%20Igor%20can%27t%20go%20out%20from%20the%20museum.%5Cn%5CnEach%20of%20the%20last%20%24%20k%20%24%20lines%20contains%20two%20integers%20%24%20x%20%24%20and%20%24%20y%20%24%20%28%20%24%201%3C%3Dx%3C%3Dn%2C1%3C%3Dy%3C%3Dm%20%24%20%29%20%5Cu2014%20the%20row%20and%20the%20column%20of%20one%20of%20Igor%27s%20starting%20positions%20respectively.%20Rows%20are%20numbered%20from%20top%20to%20bottom%2C%20columns%20%5Cu2014%20from%20left%20to%20right.%20It%20is%20guaranteed%20that%20all%20starting%20positions%20are%20empty%20cells.%22%2C%22outputFormat%22%3A%22Print%20%24%20k%20%24%20integers%20%5Cu2014%20the%20maximum%20number%20of%20pictures%2C%20that%20Igor%20can%20see%20if%20he%20starts%20in%20corresponding%20position.%22%2C%22samples%22%3A%5B%5B%225%206%203%5Cn%2A%2A%2A%2A%2A%2A%5Cn%2A..%2A.%2A%5Cn%2A%2A%2A%2A%2A%2A%5Cn%2A....%2A%5Cn%2A%2A%2A%2A%2A%2A%5Cn2%202%5Cn2%205%5Cn4%203%5Cn%22%2C%226%5Cn4%5Cn10%5Cn%22%5D%2C%5B%224%204%201%5Cn%2A%2A%2A%2A%5Cn%2A..%2A%5Cn%2A.%2A%2A%5Cn%2A%2A%2A%2A%5Cn3%202%5Cn%22%2C%228%5Cn%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F598%5C%2FD%22%2C%22id%22%3A%22598D%22%7D%2C%22translation%22%3A%22%5Cu7ed9%5Cu5b9a%5Cu4e00%5Cu4e2an%5C%5C%2Am%5Cu7684%5Cu5730%5Cu56fe%5Cuff0c%5Cu6709k%5Cu6b21%5Cu67e5%5Cu8be2%5Cu3002%5Cu6bcf%5Cu6b21%5Cu67e5%5Cu8be2%5Cuff0c%5Cu8be2%5Cu95ee%5Cu4f4d%5Cu7f6e%5Cuff08x%2Cy%5Cuff09%5Cu7684%27.%27%5Cu8fde%5Cu901a%5Cu5757%5Cu5468%5Cu56f4%5Cu6709%5Cu591a%5Cu5c11%5Cu4e2a%27%2A%27%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A137%2C%22totalAccepted%22%3A66%2C%22pid%22%3A%22CF598D%22%2C%22title%22%3A%22Igor%20In%20the%20Museum%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22CF598E%22%2C%22title%22%3A%22Chocolate%20Bar%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF585B%22%2C%22title%22%3A%22Phillip%20and%20Trains%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF540C%22%2C%22title%22%3A%22Ice%20Cave%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22P4377%22%2C%22title%22%3A%22%5BUSACO18OPEN%5DTalent%20Show%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22CF1065D%22%2C%22title%22%3A%22Three%20Pieces%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Igor%20In%20the%20Museum%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573306449;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Igor In the Museum</h1>
<h2>题意翻译</h2>
<div>给定一个n\*m的地图，有k次查询。每次查询，询问位置（x,y）的'.'连通块周围有多少个'*'</div>
<h2>题目描述</h2>
<div>Igor is in the museum and he wants to see as many pictures as possible.
Museum can be represented as a rectangular field of $ n×m $ cells. Each cell is either empty or impassable. Empty cells are marked with '.', impassable cells are marked with '\*'. Every two adjacent cells of different types (one empty and one impassable) are divided by a wall containing one picture.
At the beginning Igor is in some empty cell. At every moment he can move to any empty cell that share a side with the current one.
For several starting positions you should calculate the maximum number of pictures that Igor can see. Igor is able to see the picture only if he is in the cell adjacent to the wall with this picture. Igor have a lot of time, so he will examine every picture he can see.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>First line of the input contains three integers $ n $ , $ m $ and $ k $ ( $ 3<=n,m<=1000,1<=k<=min(n·m,100000) $ ) — the museum dimensions and the number of starting positions to process.
Each of the next $ n $ lines contains $ m $ symbols '.', '\*' — the description of the museum. It is guaranteed that all border cells are impassable, so Igor can't go out from the museum.
Each of the last $ k $ lines contains two integers $ x $ and $ y $ ( $ 1<=x<=n,1<=y<=m $ ) — the row and the column of one of Igor's starting positions respectively. Rows are numbered from top to bottom, columns — from left to right. It is guaranteed that all starting positions are empty cells.</div>
<h3>输出格式</h3>
<br />
<div>Print $ k $ integers — the maximum number of pictures, that Igor can see if he starts in corresponding position.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>5 6 3
******
*..*.*
******
*....*
******
2 2
2 5
4 3
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>6
4
10
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>4 4 1
****
*..*
*.**
****
3 2
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>8
</code></pre>
</article>
</div>
</div>
</body>
</html>
