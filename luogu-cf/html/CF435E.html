<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Special Graph - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573394046:r+vXt0SOcuK8KQ/JOTEWVw43rynquspYAs0QZzWsm7E=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22In%20this%20problem%20you%20will%20need%20to%20deal%20with%20an%20%24%20n%5Cu00d7m%20%24%20grid%20graph.%20The%20graph%27s%20vertices%20are%20the%20nodes%20of%20the%20%24%20n%5Cu00d7m%20%24%20grid.%20The%20graph%27s%20edges%20are%20all%20the%20sides%20and%20diagonals%20of%20the%20grid%27s%20unit%20squares.%5Cn%5CnThe%20figure%20below%20shows%20a%20%24%203%5Cu00d75%20%24%20graph.%20The%20black%20lines%20are%20the%20graph%27s%20edges%2C%20the%20colored%20circles%20are%20the%20graph%27s%20vertices.%20The%20vertices%20of%20the%20graph%20are%20painted%20on%20the%20picture%20for%20a%20reason%3A%20the%20coloring%20is%20a%20correct%20vertex%20coloring%20of%20the%20%24%203%5Cu00d75%20%24%20graph%20into%20four%20colors.%20A%20graph%20coloring%20is%20correct%20if%20and%20only%20if%20each%20vertex%20is%20painted%20and%20no%20two%20vertices%20connected%20by%20an%20edge%20are%20painted%20the%20same%20color.%5Cn%5Cn%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF435E%5C%2F3bf484c3ac261bc390a50b90927cfdf12af83fc1.png%29You%20are%20given%20the%20size%20of%20the%20grid%20graph%20%24%20n%5Cu00d7m%20%24%20and%20the%20colors%20of%20some%20of%20its%20vertices.%20Find%20any%20way%20how%20to%20paint%20the%20unpainted%20vertices%20of%20the%20graph%20in%204%20colors%20to%20make%20the%20final%20coloring%20a%20correct%20vertex%20graph%20coloring.%20If%20there%20is%20no%20such%20correct%20vertex%20coloring%2C%20say%20that%20the%20answer%20doesn%27t%20exist.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20two%20integers%20%24%20n%20%24%20and%20%24%20m%20%24%20%24%20%282%3C%3Dn%2Cm%3C%3D1000%29%20%24%20.%20Each%20of%20the%20next%20%24%20n%20%24%20lines%20consists%20of%20%24%20m%20%24%20characters%20%5Cu2014%20the%20given%20graph.%20Each%20character%20is%20either%20%5Cu00ab0%5Cu00bb%2C%20%5Cu00ab1%5Cu00bb%2C%20%5Cu00ab2%5Cu00bb%2C%20%5Cu00ab3%5Cu00bb%2C%20%5Cu00ab4%5Cu00bb.%20Character%20%5Cu00ab0%5Cu00bb%20means%20that%20the%20corresponding%20vertex%20is%20unpainted%2C%20otherwise%20the%20character%20means%20the%20color%20of%20the%20vertex.%5Cn%5CnAssume%20that%20all%20the%20available%20colors%20are%20numbered%20from%20%24%201%20%24%20to%20%24%204%20%24%20.%22%2C%22outputFormat%22%3A%22If%20there%20is%20no%20way%20to%20get%20correct%20vertex%20coloring%20of%20the%20graph%2C%20print%200%20in%20a%20single%20line.%20Otherwise%20print%20the%20colored%20%24%20n%5Cu00d7m%20%24%20graph.%20Print%20the%20graph%20in%20the%20same%20format%20as%20in%20the%20input.%5Cn%5CnIf%20multiple%20answers%20exist%2C%20print%20any%20of%20them.%22%2C%22samples%22%3A%5B%5B%223%205%5Cn10101%5Cn00020%5Cn01000%5Cn%22%2C%2213131%5Cn42424%5Cn31313%5Cn%22%5D%2C%5B%222%202%5Cn00%5Cn00%5Cn%22%2C%2212%5Cn34%5Cn%22%5D%2C%5B%222%202%5Cn11%5Cn00%5Cn%22%2C%220%5Cn%22%5D%5D%2C%22hint%22%3A%22The%20answer%20to%20the%20first%20sample%20is%20shown%20on%20the%20picture%20%281%20%5Cu2014%20green%20color%2C%202%20%5Cu2014%20blue%2C%203%20%5Cu2014%20dark%20blue%2C%204%20%5Cu2014%20pink%29.%5Cn%5CnIn%20the%20second%20sample%20there%20exists%204%21%20answers%2C%20each%20of%20them%20is%20considered%20correct.%5Cn%5CnIn%20the%20third%20sample%20two%20vertices%20with%20equal%20colors%20are%20connected.%20So%20the%20correct%20vertex%20coloring%20couldn%27t%20be%20obtained.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F435%5C%2FE%22%2C%22id%22%3A%22435E%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22CF435E%22%2C%22title%22%3A%22Special%20Graph%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Special%20Graph%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Special Graph</h1>
<h2>题目描述</h2>
<div>In this problem you will need to deal with an $ n×m $ grid graph. The graph's vertices are the nodes of the $ n×m $ grid. The graph's edges are all the sides and diagonals of the grid's unit squares.
The figure below shows a $ 3×5 $ graph. The black lines are the graph's edges, the colored circles are the graph's vertices. The vertices of the graph are painted on the picture for a reason: the coloring is a correct vertex coloring of the $ 3×5 $ graph into four colors. A graph coloring is correct if and only if each vertex is painted and no two vertices connected by an edge are painted the same color.
![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF435E/3bf484c3ac261bc390a50b90927cfdf12af83fc1.png)You are given the size of the grid graph $ n×m $ and the colors of some of its vertices. Find any way how to paint the unpainted vertices of the graph in 4 colors to make the final coloring a correct vertex graph coloring. If there is no such correct vertex coloring, say that the answer doesn't exist.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains two integers $ n $ and $ m $ $ (2<=n,m<=1000) $ . Each of the next $ n $ lines consists of $ m $ characters — the given graph. Each character is either «0», «1», «2», «3», «4». Character «0» means that the corresponding vertex is unpainted, otherwise the character means the color of the vertex.
Assume that all the available colors are numbered from $ 1 $ to $ 4 $ .</div>
<h3>输出格式</h3>
<br />
<div>If there is no way to get correct vertex coloring of the graph, print 0 in a single line. Otherwise print the colored $ n×m $ graph. Print the graph in the same format as in the input.
If multiple answers exist, print any of them.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>3 5
10101
00020
01000
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>13131
42424
31313
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>2 2
00
00
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>12
34
</code></pre>
<h3>输入样例 #3</h3>
<pre><code>2 2
11
00
</code></pre>
<h3>输出样例 #3</h3>
<pre><code>0
</code></pre>
<h2>说明</h2>
<div>The answer to the first sample is shown on the picture (1 — green color, 2 — blue, 3 — dark blue, 4 — pink).
In the second sample there exists 4! answers, each of them is considered correct.
In the third sample two vertices with equal colors are connected. So the correct vertex coloring couldn't be obtained.</div>
</article>
</div>
</div>
</body>
</html>
