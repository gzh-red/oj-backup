<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Clearing Up - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573391120:eUvdXH0FqLFP6RW5s4kGCxd/CZ/kYu91dVeh1oHB7e0=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22After%20Santa%20Claus%20and%20his%20assistant%20Elf%20delivered%20all%20the%20presents%20and%20made%20all%20the%20wishes%20come%20true%2C%20they%20returned%20to%20the%20North%20Pole%20and%20found%20out%20that%20it%20is%20all%20covered%20with%20snow.%20Both%20of%20them%20were%20quite%20tired%20and%20they%20decided%20only%20to%20remove%20the%20snow%20from%20the%20roads%20connecting%20huts.%20The%20North%20Pole%20has%20%24%20n%20%24%20huts%20connected%20with%20%24%20m%20%24%20roads.%20One%20can%20go%20along%20the%20roads%20in%20both%20directions.%5Cn%5CnThe%20Elf%20offered%20to%20split%3A%20Santa%20Claus%20will%20clear%20up%20the%20wide%20roads%20and%20the%20Elf%20will%20tread%20out%20the%20narrow%20roads.%20For%20each%20road%20they%20decided%20who%20will%20clear%20it%3A%20Santa%20Claus%20or%20the%20Elf.%20To%20minimize%20the%20efforts%20they%20decided%20to%20clear%20the%20road%20so%20as%20to%20fulfill%20both%20those%20conditions%3A%5Cn%5Cn-%20between%20any%20two%20huts%20should%20exist%20exactly%20one%20simple%20path%20along%20the%20cleared%20roads%3B%5Cn-%20Santa%20Claus%20and%20the%20Elf%20should%20clear%20the%20same%20number%20of%20roads.%5Cn%5CnAt%20this%20point%20Santa%20Claus%20and%20his%20assistant%20Elf%20wondered%20which%20roads%20should%20they%20clear%20up%3F%22%2C%22inputFormat%22%3A%22The%20first%20input%20line%20contains%20two%20positive%20integers%20%24%20n%20%24%20and%20%24%20m%20%24%20%28%20%24%201%3C%3Dn%3C%3D10%5E%7B3%7D%20%24%20%2C%20%24%201%3C%3Dm%3C%3D10%5E%7B5%7D%20%24%20%29%20%5Cu2014%20the%20number%20of%20huts%20and%20the%20number%20of%20roads.%20Then%20follow%20%24%20m%20%24%20lines%2C%20each%20of%20them%20contains%20a%20road%20description%3A%20the%20numbers%20of%20huts%20it%20connects%20%5Cu2014%20%24%20x%20%24%20and%20%24%20y%20%24%20%28%20%24%201%3C%3Dx%2Cy%3C%3Dn%20%24%20%29%20and%20the%20person%20responsible%20for%20clearing%20out%20this%20road%20%28%5C%22S%5C%22%20%5Cu2014%20for%20the%20Elf%20or%20%5C%22M%5C%22%20for%20Santa%20Claus%29.%20It%20is%20possible%20to%20go%20on%20each%20road%20in%20both%20directions.%20Note%20that%20there%20can%20be%20more%20than%20one%20road%20between%20two%20huts%20and%20a%20road%20can%20begin%20and%20end%20in%20the%20same%20hut.%22%2C%22outputFormat%22%3A%22Print%20%5C%22-1%5C%22%20without%20the%20quotes%20if%20it%20is%20impossible%20to%20choose%20the%20roads%20that%20will%20be%20cleared%20by%20the%20given%20rule.%20Otherwise%20print%20in%20the%20first%20line%20how%20many%20roads%20should%20be%20cleared%20and%20in%20the%20second%20line%20print%20the%20numbers%20of%20those%20roads%20%28the%20roads%20are%20numbered%20from%20%24%201%20%24%20in%20the%20order%20of%20occurrence%20in%20the%20input%29.%20It%20is%20allowed%20to%20print%20the%20numbers%20of%20the%20roads%20in%20any%20order.%20Each%20number%20should%20be%20printed%20exactly%20once.%20As%20you%20print%20the%20numbers%2C%20separate%20them%20with%20spaces.%22%2C%22samples%22%3A%5B%5B%221%202%5Cn1%201%20S%5Cn1%201%20M%5Cn%22%2C%220%5Cn%5Cn%22%5D%2C%5B%223%203%5Cn1%202%20S%5Cn1%203%20M%5Cn2%203%20S%5Cn%22%2C%222%5Cn2%201%20%5Cn%22%5D%2C%5B%225%206%5Cn1%201%20S%5Cn1%202%20M%5Cn1%203%20S%5Cn1%204%20M%5Cn1%205%20M%5Cn2%202%20S%5Cn%22%2C%22-1%5Cn%22%5D%5D%2C%22hint%22%3A%22A%20path%20is%20called%20simple%20if%20all%20huts%20on%20it%20are%20pairwise%20different.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F141%5C%2FE%22%2C%22id%22%3A%22141E%22%7D%2C%22translation%22%3A%22%5Cu6709%5Cu4e00%5Cu4e2a%20%24n%24%20%5Cu4e2a%5Cu70b9%20%24m%24%20%5Cu6761%5Cu8fb9%5Cu7684%5Cu6709%5Cu5411%5Cu56fe%5Cuff0c%5Cu6bcf%5Cu6761%5Cu8fb9%5Cu53ef%5Cu80fd%5Cu6709%5Cu4e24%5Cu79cd%5Cu989c%5Cu8272%20%24S%24%20%5Cu6216%20%24M%24%20%5Cuff0c%5Cu8bf7%5Cu4f60%5Cu5224%5Cu65ad%5Cu662f%5Cu5426%5Cu5b58%5Cu5728%5Cu5e76%5Cu8f93%5Cu51fa%5Cu4e00%5Cu79cd%5Cu8fd9%5Cu6837%5Cu7684%5Cu65b9%5Cu6848%5Cuff0c%5Cu4f7f%5Cu5f97%5Cu5176%5Cu751f%5Cu6210%5Cu6811%5Cu4e2d%5Cu8fb9%5Cu7684%5Cu989c%5Cu8272%5Cu4e3a%20%24S%24%20%5Cu548c%20%24M%24%20%5Cu7684%5Cu6b63%5Cu597d%5Cu5404%5Cu5360%5Cu4e00%5Cu534a%5Cu3002%5Cu5982%5Cu679c%5Cu65e0%5Cu89e3%5Cuff0c%5Cu8f93%5Cu51fa%20%24-1%24%20%5Cuff0c%5Cu5426%5Cu5219%5Cu5148%5Cu8f93%5Cu51fa%5Cu8fd9%5Cu6837%5Cu7684%5Cu751f%5Cu6210%5Cu6811%5Cu7684%5Cu8fb9%5Cu7684%5Cu4e2a%5Cu6570%5Cuff0c%5Cu518d%5Cu8f93%5Cu51fa%5Cu4e00%5Cu79cd%5Cu5408%5Cu6cd5%5Cu7684%5Cu60c5%5Cu51b5%5Cu7684%5Cu8fb9%5Cu7684%5Cu96c6%5Cu5408%5Cu3002%5Cn%22%2C%22tags%22%3A%5B47%2C166%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A30%2C%22totalAccepted%22%3A9%2C%22pid%22%3A%22CF141E%22%2C%22title%22%3A%22Clearing%20Up%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A66466%2C%22title%22%3A%22%5Cu7ffb%5Cu8bd1%22%2C%22forum%22%3A%7B%22id%22%3A12033%2C%22name%22%3A%22CF141E%20Clearing%20Up%22%2C%22slug%22%3A%22CF141E%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Clearing%20Up%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573295103;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Clearing Up</h1>
<h2>题意翻译</h2>
<div>有一个 $n$ 个点 $m$ 条边的有向图，每条边可能有两种颜色 $S$ 或 $M$ ，请你判断是否存在并输出一种这样的方案，使得其生成树中边的颜色为 $S$ 和 $M$ 的正好各占一半。如果无解，输出 $-1$ ，否则先输出这样的生成树的边的个数，再输出一种合法的情况的边的集合。
</div>
<h2>题目描述</h2>
<div>After Santa Claus and his assistant Elf delivered all the presents and made all the wishes come true, they returned to the North Pole and found out that it is all covered with snow. Both of them were quite tired and they decided only to remove the snow from the roads connecting huts. The North Pole has $ n $ huts connected with $ m $ roads. One can go along the roads in both directions.
The Elf offered to split: Santa Claus will clear up the wide roads and the Elf will tread out the narrow roads. For each road they decided who will clear it: Santa Claus or the Elf. To minimize the efforts they decided to clear the road so as to fulfill both those conditions:
- between any two huts should exist exactly one simple path along the cleared roads;
- Santa Claus and the Elf should clear the same number of roads.
At this point Santa Claus and his assistant Elf wondered which roads should they clear up?</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first input line contains two positive integers $ n $ and $ m $ ( $ 1<=n<=10^{3} $ , $ 1<=m<=10^{5} $ ) — the number of huts and the number of roads. Then follow $ m $ lines, each of them contains a road description: the numbers of huts it connects — $ x $ and $ y $ ( $ 1<=x,y<=n $ ) and the person responsible for clearing out this road ("S" — for the Elf or "M" for Santa Claus). It is possible to go on each road in both directions. Note that there can be more than one road between two huts and a road can begin and end in the same hut.</div>
<h3>输出格式</h3>
<br />
<div>Print "-1" without the quotes if it is impossible to choose the roads that will be cleared by the given rule. Otherwise print in the first line how many roads should be cleared and in the second line print the numbers of those roads (the roads are numbered from $ 1 $ in the order of occurrence in the input). It is allowed to print the numbers of the roads in any order. Each number should be printed exactly once. As you print the numbers, separate them with spaces.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>1 2
1 1 S
1 1 M
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>0

</code></pre>
<h3>输入样例 #2</h3>
<pre><code>3 3
1 2 S
1 3 M
2 3 S
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>2
2 1 
</code></pre>
<h3>输入样例 #3</h3>
<pre><code>5 6
1 1 S
1 2 M
1 3 S
1 4 M
1 5 M
2 2 S
</code></pre>
<h3>输出样例 #3</h3>
<pre><code>-1
</code></pre>
<h2>说明</h2>
<div>A path is called simple if all huts on it are pairwise different.</div>
</article>
</div>
</div>
</body>
</html>
