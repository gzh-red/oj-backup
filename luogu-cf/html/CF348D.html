<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Turtles - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573393093:SKPawnElC99EEy5xDQVJPkIFklC5aUIPA0mfW6mWW/g=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22You%27ve%20got%20a%20table%20of%20size%20%24%20n%5Cu00d7m%20%24%20.%20We%27ll%20consider%20the%20table%20rows%20numbered%20from%20top%20to%20bottom%201%20through%20%24%20n%20%24%20%2C%20and%20the%20columns%20numbered%20from%20left%20to%20right%201%20through%20%24%20m%20%24%20.%20Then%20we%27ll%20denote%20the%20cell%20in%20row%20%24%20x%20%24%20and%20column%20%24%20y%20%24%20as%20%24%20%28x%2Cy%29%20%24%20.%5Cn%5CnInitially%20cell%20%24%20%281%2C1%29%20%24%20contains%20two%20similar%20turtles.%20Both%20turtles%20want%20to%20get%20to%20cell%20%24%20%28n%2Cm%29%20%24%20.%20Some%20cells%20of%20the%20table%20have%20obstacles%20but%20it%20is%20guaranteed%20that%20there%20aren%27t%20any%20obstacles%20in%20the%20upper%20left%20and%20lower%20right%20corner.%20A%20turtle%20%28one%20or%20the%20other%29%20can%20go%20from%20cell%20%24%20%28x%2Cy%29%20%24%20to%20one%20of%20two%20cells%20%24%20%28x%2B1%2Cy%29%20%24%20and%20%24%20%28x%2Cy%2B1%29%20%24%20%2C%20as%20long%20as%20the%20required%20cell%20doesn%27t%20contain%20an%20obstacle.%20The%20turtles%20have%20had%20an%20argument%20so%20they%20don%27t%20want%20to%20have%20any%20chance%20of%20meeting%20each%20other%20along%20the%20way.%20Help%20them%20find%20the%20number%20of%20ways%20in%20which%20they%20can%20go%20from%20cell%20%24%20%281%2C1%29%20%24%20to%20cell%20%24%20%28n%2Cm%29%20%24%20.%5Cn%5CnMore%20formally%2C%20find%20the%20number%20of%20pairs%20of%20non-intersecting%20ways%20from%20cell%20%24%20%281%2C1%29%20%24%20to%20cell%20%24%20%28n%2Cm%29%20%24%20modulo%20%24%201000000007%20%24%20%24%20%2810%5E%7B9%7D%2B7%29%20%24%20.%20Two%20ways%20are%20called%20non-intersecting%20if%20they%20have%20exactly%20two%20common%20points%20%5Cu2014%20the%20starting%20point%20and%20the%20final%20point.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20two%20integers%20%24%20n%2Cm%20%24%20%24%20%282%3C%3Dn%2Cm%3C%3D3000%29%20%24%20.%20Each%20of%20the%20following%20%24%20n%20%24%20lines%20contains%20%24%20m%20%24%20characters%20describing%20the%20table.%20The%20empty%20cells%20are%20marked%20by%20characters%20%5C%22.%5C%22%2C%20the%20cells%20with%20obstacles%20are%20marked%20by%20%5C%22%5C%5C%23%5C%22.%5Cn%5CnIt%20is%20guaranteed%20that%20the%20upper%20left%20and%20the%20lower%20right%20cells%20are%20empty.%22%2C%22outputFormat%22%3A%22In%20a%20single%20line%20print%20a%20single%20integer%20%5Cu2014%20the%20number%20of%20pairs%20of%20non-intersecting%20paths%20from%20cell%20%24%20%281%2C1%29%20%24%20to%20cell%20%24%20%28n%2Cm%29%20%24%20modulo%20%24%201000000007%20%24%20%24%20%2810%5E%7B9%7D%2B7%29%20%24%20.%22%2C%22samples%22%3A%5B%5B%224%205%5Cn.....%5Cn.%23%23%23.%5Cn.%23%23%23.%5Cn.....%5Cn%22%2C%221%5Cn%22%5D%2C%5B%222%203%5Cn...%5Cn...%5Cn%22%2C%221%5Cn%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F348%5C%2FD%22%2C%22id%22%3A%22348D%22%7D%2C%22translation%22%3A%22%23%23%20%5Cu9898%5Cu76ee%5Cu63cf%5Cu8ff0%5Cr%5Cn%5Cu4e00%5Cu5f20%24n%24%5Cu884c%24m%24%5Cu5217%5Cu7684%5Cu7f51%5Cu683c%5Cu56fe%5Cuff0c%5Cu56fe%5Cu4e2d%5Cu7684%5Cu6709%5Cu4e9b%5Cu683c%5Cu5b50%5Cu4e0a%5Cu9762%5Cu6709%5Cu969c%5Cu788d%5Cu7269%5Cuff0c%5Cu4f46%5Cu4fdd%5Cu8bc1%24%281%2C1%29%24%5Cu548c%24%28n%2Cm%29%24%5Cu4e0a%5Cu9762%5Cu90fd%5Cu6ca1%5Cu6709%5Cu969c%5Cu788d%5Cu7269%5Cu3002%5Cu5728%24%281%2C1%29%24%5Cu5904%5Cu6709%5Cu4e24%5Cu53ea%5Cu4e4c%5Cu9f9f%5Cuff0c%5Cu90fd%5Cu60f3%5Cu8981%5Cu53bb%24%28n%2Cm%29%24%5Cu3002%5Cu4e4c%5Cu9f9f%5Cu6bcf%5Cu6b21%5Cu90fd%5Cu53ef%5Cu4ee5%5Cu5411%5Cu4e0b%5Cu6216%5Cu8005%5Cu5411%5Cu53f3%5Cu8d70%5Cu4e00%5Cu683c%5Cuff0c%5Cu524d%5Cu63d0%5Cu662f%5Cu683c%5Cu5b50%5Cu4e0a%5Cu6ca1%5Cu6709%5Cu4efb%5Cu4f55%5Cu969c%5Cu788d%5Cu7269%5Cu3002%5Cu8981%5Cu6c42%5Cu4e24%5Cu53ea%5Cu4e4c%5Cu9f9f%5Cu5728%5Cu524d%5Cu5f80%24%28n%2Cm%29%24%5Cu7684%5Cu8def%5Cu9014%5Cu4e2d%5Cu4e0d%5Cu53ef%5Cu4ee5%5Cu76f8%5Cu9047%5Cuff0c%5Cu5373%5Cu9664%5Cu4e86%5Cu8d77%5Cu70b9%5Cu548c%5Cu7ec8%5Cu70b9%5Cuff0c%5Cu4ed6%5Cu4eec%5Cu7684%5Cu8def%5Cu5f84%5Cu6ca1%5Cu6709%5Cu5176%5Cu4ed6%5Cu516c%5Cu5171%5Cu70b9%5Cu3002%5Cu6c42%5Cu51fa%5Cu4ece%5Cu8d77%5Cu70b9%5Cu5230%5Cu7ec8%5Cu70b9%5Cu7684%5Cu4e0d%5Cu540c%5Cu8def%5Cu5f84%5Cu5bf9%5Cu6570%5Cu3002%5Cu7b54%5Cu6848%5Cu5bf9%2410%5E9%2B7%24%5Cu53d6%5Cu6a21%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu6ce8%5Cuff1a%24%28route_a%2Croute_b%29%24%5Cu548c%24%28route_b%2Croute_a%29%24%5Cu88ab%5Cu89c6%5Cu4e3a%5Cu540c%5Cu4e00%5Cu5bf9%5Cu8def%5Cu5f84%5Cu3002%5Cr%5Cn%5Cr%5Cn%23%23%20%5Cu8f93%5Cu5165%5Cu683c%5Cu5f0f%5Cr%5Cn%5Cu7b2c%5Cu4e00%5Cu884c%5Cu5305%5Cu542b%5Cu4e86%24n%2Cm%24%2C%24%282%5Cu2264n%2Cm%5Cu22643000%29%24%5Cuff0c%5Cu540e%5Cu9762%24n%24%5Cu884c%5Cuff0c%5Cu6bcf%5Cu884c%5Cu6709%24m%24%5Cu4e2a%5Cu5b57%5Cu7b26%5Cuff0c%5Cu7b2c%24i%24%5Cu884c%5Cu7b2c%24j%24%5Cu4e2a%5Cu5b57%5Cu7b26%5Cu8868%5Cu793a%24%28i%2Cj%29%24%5Cu7684%5Cu72b6%5Cu6001%5Cuff08%24%27.%27%24%5Cu4e3a%5Cu7a7a%5Cu683c%2C%24%27%5C%5C%23%27%24%5Cu4e3a%5Cu969c%5Cu788d%5Cu7269%5Cu3002%5Cuff09%5Cr%5Cn%5Cr%5Cn%23%23%20%5Cu8f93%5Cu51fa%5Cu683c%5Cu5f0f%5Cr%5Cn%5Cu4e00%5Cu884c%5Cuff0c%5Cu5bf9%2410%5E9%2B7%24%5Cu53d6%5Cu6a21%5Cu540e%5Cu7684%5Cu4ece%5Cu8d77%5Cu70b9%5Cu5230%5Cu7ec8%5Cu70b9%5Cu7684%5Cu4e0d%5Cu540c%5Cu8def%5Cu5f84%5Cu5bf9%5Cu6570%5Cu3002%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A64%2C%22totalAccepted%22%3A28%2C%22pid%22%3A%22CF348D%22%2C%22title%22%3A%22Turtles%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A50721%2C%22title%22%3A%22%5Cu7ffb%5Cu8bd1%5Cuff08%5Cu82f1%5Cu8bed%5Cu5c0f%5Cu767d%5Cuff0c%5Cu5927%5Cu4f6c%5Cu52ff%5Cu55b7%5Cuff09%22%2C%22forum%22%3A%7B%22id%22%3A11244%2C%22name%22%3A%22CF348D%20Turtles%22%2C%22slug%22%3A%22CF348D%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P3953%22%2C%22title%22%3A%22%5Cu901b%5Cu516c%5Cu56ed%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P4111%22%2C%22title%22%3A%22%5BHEOI2015%5D%5Cu5c0fZ%5Cu7684%5Cu623f%5Cu95f4%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P4558%22%2C%22title%22%3A%22%5BJSOI2018%5D%5Cu673a%5Cu5668%5Cu4eba%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22CF1188C%22%2C%22title%22%3A%22Array%20Beauty%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22P5460%22%2C%22title%22%3A%22%5BBJOI2016%5DIP%5Cu5730%5Cu5740%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Turtles%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573286098;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Turtles</h1>
<h2>题意翻译</h2>
<div>## 题目描述
一张$n$行$m$列的网格图，图中的有些格子上面有障碍物，但保证$(1,1)$和$(n,m)$上面都没有障碍物。在$(1,1)$处有两只乌龟，都想要去$(n,m)$。乌龟每次都可以向下或者向右走一格，前提是格子上没有任何障碍物。要求两只乌龟在前往$(n,m)$的路途中不可以相遇，即除了起点和终点，他们的路径没有其他公共点。求出从起点到终点的不同路径对数。答案对$10^9+7$取模。
注：$(route_a,route_b)$和$(route_b,route_a)$被视为同一对路径。
## 输入格式
第一行包含了$n,m$,$(2≤n,m≤3000)$，后面$n$行，每行有$m$个字符，第$i$行第$j$个字符表示$(i,j)$的状态（$'.'$为空格,$'\#'$为障碍物。）
## 输出格式
一行，对$10^9+7$取模后的从起点到终点的不同路径对数。</div>
<h2>题目描述</h2>
<div>You've got a table of size $ n×m $ . We'll consider the table rows numbered from top to bottom 1 through $ n $ , and the columns numbered from left to right 1 through $ m $ . Then we'll denote the cell in row $ x $ and column $ y $ as $ (x,y) $ .
Initially cell $ (1,1) $ contains two similar turtles. Both turtles want to get to cell $ (n,m) $ . Some cells of the table have obstacles but it is guaranteed that there aren't any obstacles in the upper left and lower right corner. A turtle (one or the other) can go from cell $ (x,y) $ to one of two cells $ (x+1,y) $ and $ (x,y+1) $ , as long as the required cell doesn't contain an obstacle. The turtles have had an argument so they don't want to have any chance of meeting each other along the way. Help them find the number of ways in which they can go from cell $ (1,1) $ to cell $ (n,m) $ .
More formally, find the number of pairs of non-intersecting ways from cell $ (1,1) $ to cell $ (n,m) $ modulo $ 1000000007 $ $ (10^{9}+7) $ . Two ways are called non-intersecting if they have exactly two common points — the starting point and the final point.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains two integers $ n,m $ $ (2<=n,m<=3000) $ . Each of the following $ n $ lines contains $ m $ characters describing the table. The empty cells are marked by characters ".", the cells with obstacles are marked by "\#".
It is guaranteed that the upper left and the lower right cells are empty.</div>
<h3>输出格式</h3>
<br />
<div>In a single line print a single integer — the number of pairs of non-intersecting paths from cell $ (1,1) $ to cell $ (n,m) $ modulo $ 1000000007 $ $ (10^{9}+7) $ .</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>4 5
.....
.###.
.###.
.....
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>1
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>2 3
...
...
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>1
</code></pre>
</article>
</div>
</div>
</body>
</html>
