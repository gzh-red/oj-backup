<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Beads - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573389901:cR0ZL3R+BOsunkRL3Bq74CEWlknoWXIFEkzKILSTdIg=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%22%2C%22description%22%3A%22One%20Martian%20boy%20called%20Zorg%20wants%20to%20present%20a%20string%20of%20beads%20to%20his%20friend%20from%20the%20Earth%20%5Cu2014%20Masha.%20He%20knows%20that%20Masha%20likes%20two%20colours%3A%20blue%20and%20red%2C%20%5Cu2014%20and%20right%20in%20the%20shop%20where%20he%20has%20come%2C%20there%20is%20a%20variety%20of%20adornments%20with%20beads%20of%20these%20two%20colours.%20All%20the%20strings%20of%20beads%20have%20a%20small%20fastener%2C%20and%20if%20one%20unfastens%20it%2C%20one%20might%20notice%20that%20all%20the%20strings%20of%20beads%20in%20the%20shop%20are%20of%20the%20same%20length.%20Because%20of%20the%20peculiarities%20of%20the%20Martian%20eyesight%2C%20if%20Zorg%20sees%20one%20blue-and-red%20string%20of%20beads%20first%2C%20and%20then%20the%20other%20with%20red%20beads%20instead%20of%20blue%20ones%2C%20and%20blue%20%5Cu2014%20instead%20of%20red%2C%20he%20regards%20these%20two%20strings%20of%20beads%20as%20identical.%20In%20other%20words%2C%20Zorg%20regards%20as%20identical%20not%20only%20those%20strings%20of%20beads%20that%20can%20be%20derived%20from%20each%20other%20by%20the%20string%20turnover%2C%20but%20as%20well%20those%20that%20can%20be%20derived%20from%20each%20other%20by%20a%20mutual%20replacement%20of%20colours%20and%5C%2For%20by%20the%20string%20turnover.%5Cn%5CnIt%20is%20known%20that%20all%20Martians%20are%20very%20orderly%2C%20and%20if%20a%20Martian%20sees%20some%20amount%20of%20objects%2C%20he%20tries%20to%20put%20them%20in%20good%20order.%20Zorg%20thinks%20that%20a%20red%20bead%20is%20smaller%20than%20a%20blue%20one.%20Let%27s%20put%200%20for%20a%20red%20bead%2C%20and%201%20%5Cu2014%20for%20a%20blue%20one.%20From%20two%20strings%20the%20Martian%20puts%20earlier%20the%20string%20with%20a%20red%20bead%20in%20the%20%24%20i%20%24%20-th%20position%2C%20providing%20that%20the%20second%20string%20has%20a%20blue%20bead%20in%20the%20%24%20i%20%24%20-th%20position%2C%20and%20the%20first%20two%20beads%20%24%20i-1%20%24%20are%20identical.%5Cn%5CnAt%20first%20Zorg%20unfastens%20all%20the%20strings%20of%20beads%2C%20and%20puts%20them%20into%20small%20heaps%20so%2C%20that%20in%20each%20heap%20strings%20are%20identical%2C%20in%20his%20opinion.%20Then%20he%20sorts%20out%20the%20heaps%20and%20chooses%20the%20minimum%20string%20in%20each%20heap%2C%20in%20his%20opinion.%20He%20gives%20the%20unnecassary%20strings%20back%20to%20the%20shop%20assistant%20and%20says%20he%20doesn%27t%20need%20them%20any%20more.%20Then%20Zorg%20sorts%20out%20the%20remaining%20strings%20of%20beads%20and%20buys%20the%20string%20with%20index%20%24%20k%20%24%20.%5Cn%5CnAll%20these%20manupulations%20will%20take%20Zorg%20a%20lot%20of%20time%2C%20that%27s%20why%20he%20asks%20you%20to%20help%20and%20find%20the%20string%20of%20beads%20for%20Masha.%22%2C%22inputFormat%22%3A%22The%20input%20file%20contains%20two%20integers%20%24%20n%20%24%20and%20%24%20k%20%24%20%28%20%24%202%3C%3Dn%3C%3D50%3B1%3C%3Dk%3C%3D10%5E%7B16%7D%20%24%20%29%20%5Cu2014the%20length%20of%20a%20string%20of%20beads%2C%20and%20the%20index%20of%20the%20string%2C%20chosen%20by%20Zorg.%22%2C%22outputFormat%22%3A%22Output%20the%20%24%20k%20%24%20-th%20string%20of%20beads%2C%20putting%200%20for%20a%20red%20bead%2C%20and%201%20%5Cu2014%20for%20a%20blue%20one.%20If%20it%20s%20impossible%20to%20find%20the%20required%20string%2C%20output%20the%20only%20number%20-1.%22%2C%22samples%22%3A%5B%5B%224%204%5Cn%22%2C%220101%5Cn%22%5D%5D%2C%22hint%22%3A%22Let%27s%20consider%20the%20example%20of%20strings%20of%20length%204%20%5Cu2014%200001%2C%200010%2C%200011%2C%200100%2C%200101%2C%200110%2C%200111%2C%201000%2C%201001%2C%201010%2C%201011%2C%201100%2C%201101%2C%201110.%20Zorg%20will%20divide%20them%20into%20heaps%3A%20%7B0001%2C%200111%2C%201000%2C%201110%7D%2C%20%7B0010%2C%200100%2C%201011%2C%201101%7D%2C%20%7B0011%2C%201100%7D%2C%20%7B0101%2C%201010%7D%2C%20%7B0110%2C%201001%7D.%20Then%20he%20will%20choose%20the%20minimum%20strings%20of%20beads%20in%20each%20heap%3A%200001%2C%200010%2C%200011%2C%200101%2C%200110.%20The%20forth%20string%20%5Cu2014%200101.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B5000%5D%2C%22memory%22%3A%5B64000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F8%5C%2FE%22%2C%22id%22%3A%228E%22%7D%2C%22translation%22%3A%22%5Cu5c06%5Cu6240%5Cu6709%5Cu4e8c%5Cu8fdb%5Cu5236%5Cu4e32%5Cuff08%5Cu53ea%5Cu5141%5Cu8bb8%5Cu524d%5Cu5bfc%200%5Cuff09%5Cu4e2d%5Cuff0c%5Cu540c%5Cu65f6%5Cu6ee1%5Cu8db3%5Cu5b57%5Cu5178%5Cu5e8f%5Cu4e0d%5Cu5927%5Cu4e8e%5Cu5176%5Cu9006%5Cu5e8f%5Cu4e32%5Cuff0c%5Cu53d6%5Cu53cd%5Cu4e32%5Cu548c%5Cu9006%5Cu5e8f%5Cu53d6%5Cu53cd%5Cu4e32%5Cuff08%5Cu4e09%5Cu79cd%5Cu90fd%5Cu8981%5Cu6ee1%5Cu8db3%5Cuff09%5Cu7684%5Cu4e32%5Cu63d0%5Cu51fa%5Cu6765%5Cuff0c%5Cu6309%5Cu5b57%5Cu5178%5Cu5e8f%5Cu6392%5Cu5e8f%5Cuff0c%5Cu6c42%5Cu7b2cm%5Cu4e2a%5Cu3002%22%2C%22tags%22%3A%5B111%2C244%2C266%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A37%2C%22totalAccepted%22%3A15%2C%22pid%22%3A%22CF8E%22%2C%22title%22%3A%22Beads%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A32131%2C%22title%22%3A%22%5Cu7ffb%5Cu8bd1%22%2C%22forum%22%3A%7B%22id%22%3A12676%2C%22name%22%3A%22CF8E%20Beads%22%2C%22slug%22%3A%22CF8E%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Beads%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Beads</h1>
<h2>题意翻译</h2>
<div>将所有二进制串（只允许前导 0）中，同时满足字典序不大于其逆序串，取反串和逆序取反串（三种都要满足）的串提出来，按字典序排序，求第m个。</div>
<h2>题目描述</h2>
<div>One Martian boy called Zorg wants to present a string of beads to his friend from the Earth — Masha. He knows that Masha likes two colours: blue and red, — and right in the shop where he has come, there is a variety of adornments with beads of these two colours. All the strings of beads have a small fastener, and if one unfastens it, one might notice that all the strings of beads in the shop are of the same length. Because of the peculiarities of the Martian eyesight, if Zorg sees one blue-and-red string of beads first, and then the other with red beads instead of blue ones, and blue — instead of red, he regards these two strings of beads as identical. In other words, Zorg regards as identical not only those strings of beads that can be derived from each other by the string turnover, but as well those that can be derived from each other by a mutual replacement of colours and/or by the string turnover.
It is known that all Martians are very orderly, and if a Martian sees some amount of objects, he tries to put them in good order. Zorg thinks that a red bead is smaller than a blue one. Let's put 0 for a red bead, and 1 — for a blue one. From two strings the Martian puts earlier the string with a red bead in the $ i $ -th position, providing that the second string has a blue bead in the $ i $ -th position, and the first two beads $ i-1 $ are identical.
At first Zorg unfastens all the strings of beads, and puts them into small heaps so, that in each heap strings are identical, in his opinion. Then he sorts out the heaps and chooses the minimum string in each heap, in his opinion. He gives the unnecassary strings back to the shop assistant and says he doesn't need them any more. Then Zorg sorts out the remaining strings of beads and buys the string with index $ k $ .
All these manupulations will take Zorg a lot of time, that's why he asks you to help and find the string of beads for Masha.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The input file contains two integers $ n $ and $ k $ ( $ 2<=n<=50;1<=k<=10^{16} $ ) —the length of a string of beads, and the index of the string, chosen by Zorg.</div>
<h3>输出格式</h3>
<br />
<div>Output the $ k $ -th string of beads, putting 0 for a red bead, and 1 — for a blue one. If it s impossible to find the required string, output the only number -1.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>4 4
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>0101
</code></pre>
<h2>说明</h2>
<div>Let's consider the example of strings of length 4 — 0001, 0010, 0011, 0100, 0101, 0110, 0111, 1000, 1001, 1010, 1011, 1100, 1101, 1110. Zorg will divide them into heaps: {0001, 0111, 1000, 1110}, {0010, 0100, 1011, 1101}, {0011, 1100}, {0101, 1010}, {0110, 1001}. Then he will choose the minimum strings of beads in each heap: 0001, 0010, 0011, 0101, 0110. The forth string — 0101.</div>
</article>
</div>
</div>
</body>
</html>
