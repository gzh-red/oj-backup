<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Wallpaper - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573391097:JDCCoO6vHSFrJYGcIQzQnk2E2UougtewqfyXDDT0cAY=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Having%20bought%20his%20own%20apartment%2C%20Boris%20decided%20to%20paper%20the%20walls%20in%20every%20room.%20Boris%27s%20flat%20has%20%24%20n%20%24%20rooms%2C%20each%20of%20which%20has%20the%20form%20of%20a%20rectangular%20parallelepiped.%20For%20every%20room%20we%20known%20its%20length%2C%20width%20and%20height%20of%20the%20walls%20in%20meters%20%28different%20rooms%20can%20have%20different%20dimensions%2C%20including%20height%29.%5Cn%5CnBoris%20chose%20%24%20m%20%24%20types%20of%20wallpaper%20to%20paper%20the%20walls%20of%20the%20rooms%20with%20%28but%20it%20is%20not%20necessary%20to%20use%20all%20the%20types%29.%20Each%20type%20of%20wallpaper%20is%20sold%20in%20rolls%20of%20a%20fixed%20length%20and%20width%20%28the%20length%2C%20naturally%2C%20shows%20how%20long%20the%20unfolded%20roll%20will%20be%29.%20In%20addition%2C%20for%20each%20type%20we%20know%20the%20price%20of%20one%20roll%20of%20this%20type.%5Cn%5CnThe%20wallpaper%20of%20each%20type%20contains%20strips%20running%20along%20the%20length%20of%20the%20roll.%20When%20gluing%20the%20strips%20must%20be%20located%20strictly%20vertically%20%28so%20the%20roll%20cannot%20be%20rotated%2C%20even%20if%20the%20length%20is%20less%20than%20the%20width%29.%20Besides%2C%20a%20roll%20can%20be%20cut%20in%20an%20arbitrary%20manner%2C%20but%20the%20joints%20of%20glued%20pieces%20should%20also%20be%20vertical.%20In%20addition%2C%20each%20room%20should%20be%20papered%20by%20only%20one%20type%20of%20wallpaper.%20And%20pieces%20of%20the%20same%20roll%20cannot%20be%20used%20to%20paper%20different%20rooms.%20That%20is%2C%20for%20each%20room%20the%20rolls%20are%20purchased%20separately.%20Also%2C%20some%20rolls%20can%20be%20used%20not%20completely.%5Cn%5CnAfter%20buying%20an%20apartment%20Boris%20is%20short%20of%20cash%2C%20so%20he%20wants%20to%20spend%20the%20minimum%20money%20on%20wallpaper.%20Help%20him.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20a%20positive%20integer%20%24%20n%20%24%20%28%20%24%201%3C%3Dn%3C%3D500%20%24%20%29%20%5Cu2014%20the%20number%20of%20rooms%20in%20Boris%27s%20apartment.%5Cn%5CnEach%20of%20the%20next%20%24%20n%20%24%20lines%20contains%20three%20space-separated%20positive%20integers%20%5Cu2014%20the%20length%2C%20width%20and%20height%20of%20the%20walls%20in%20a%20given%20room%20in%20meters%2C%20respectively.%5Cn%5CnThe%20next%20line%20contains%20a%20positive%20integer%20%24%20m%20%24%20%28%20%24%201%3C%3Dm%3C%3D500%20%24%20%29%20%5Cu2014%20the%20number%20of%20available%20wallpaper%20types.%5Cn%5CnEach%20of%20the%20following%20%24%20m%20%24%20lines%20contains%20three%20space-separated%20positive%20integers%20%5Cu2014%20the%20length%20and%20width%20in%20meters%20of%20a%20given%20wallpaper%20and%20the%20price%20of%20one%20roll%2C%20respectively.%5Cn%5CnAll%20numbers%20in%20the%20input%20data%20do%20not%20exceed%20%24%20500%20%24%20.%20It%20is%20guaranteed%20that%20each%20room%20can%20be%20papered%20using%20these%20types%20of%20wallpaper.%22%2C%22outputFormat%22%3A%22Print%20a%20single%20number%20%5Cu2014%20the%20minimum%20total%20cost%20of%20the%20rolls.%22%2C%22samples%22%3A%5B%5B%221%5Cn5%205%203%5Cn3%5Cn10%201%20100%5Cn15%202%20320%5Cn3%2019%20500%5Cn%22%2C%22640%5Cn%22%5D%5D%2C%22hint%22%3A%22Note%20to%20the%20sample%3A%5Cn%5CnThe%20total%20length%20of%20the%20walls%20%28the%20perimeter%29%20of%20the%20room%20is%2020%20m.%5Cn%5CnOne%20roll%20of%20the%20first%20type%20can%20be%20cut%20into%20pieces%20to%20get%20three%20vertical%201%20meter%20wide%20strips%2C%20ergo%20you%20need%207%20rolls%20of%20this%20type%2C%20the%20price%20equals%20700.%5Cn%5CnA%20roll%20of%20the%20second%20type%20can%20be%20cut%20into%20pieces%20to%20get%20five%202%20meter%20wide%20strips%2C%20we%20need%202%20rolls%2C%20the%20price%20is%20640.%5Cn%5CnOne%20roll%20of%20the%20third%20type%20can%20immediately%20paper%2019%20meters%20out%20of%2020%2C%20but%20we%20cannot%20use%20other%20types%20and%20we%20have%20to%20buy%20a%20second%20roll%2C%20the%20price%20is%201000.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F139%5C%2FB%22%2C%22id%22%3A%22139B%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22CF139B%22%2C%22title%22%3A%22Wallpaper%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Wallpaper%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Wallpaper</h1>
<h2>题目描述</h2>
<div>Having bought his own apartment, Boris decided to paper the walls in every room. Boris's flat has $ n $ rooms, each of which has the form of a rectangular parallelepiped. For every room we known its length, width and height of the walls in meters (different rooms can have different dimensions, including height).
Boris chose $ m $ types of wallpaper to paper the walls of the rooms with (but it is not necessary to use all the types). Each type of wallpaper is sold in rolls of a fixed length and width (the length, naturally, shows how long the unfolded roll will be). In addition, for each type we know the price of one roll of this type.
The wallpaper of each type contains strips running along the length of the roll. When gluing the strips must be located strictly vertically (so the roll cannot be rotated, even if the length is less than the width). Besides, a roll can be cut in an arbitrary manner, but the joints of glued pieces should also be vertical. In addition, each room should be papered by only one type of wallpaper. And pieces of the same roll cannot be used to paper different rooms. That is, for each room the rolls are purchased separately. Also, some rolls can be used not completely.
After buying an apartment Boris is short of cash, so he wants to spend the minimum money on wallpaper. Help him.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains a positive integer $ n $ ( $ 1<=n<=500 $ ) — the number of rooms in Boris's apartment.
Each of the next $ n $ lines contains three space-separated positive integers — the length, width and height of the walls in a given room in meters, respectively.
The next line contains a positive integer $ m $ ( $ 1<=m<=500 $ ) — the number of available wallpaper types.
Each of the following $ m $ lines contains three space-separated positive integers — the length and width in meters of a given wallpaper and the price of one roll, respectively.
All numbers in the input data do not exceed $ 500 $ . It is guaranteed that each room can be papered using these types of wallpaper.</div>
<h3>输出格式</h3>
<br />
<div>Print a single number — the minimum total cost of the rolls.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>1
5 5 3
3
10 1 100
15 2 320
3 19 500
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>640
</code></pre>
<h2>说明</h2>
<div>Note to the sample:
The total length of the walls (the perimeter) of the room is 20 m.
One roll of the first type can be cut into pieces to get three vertical 1 meter wide strips, ergo you need 7 rolls of this type, the price equals 700.
A roll of the second type can be cut into pieces to get five 2 meter wide strips, we need 2 rolls, the price is 640.
One roll of the third type can immediately paper 19 meters out of 20, but we cannot use other types and we have to buy a second roll, the price is 1000.</div>
</article>
</div>
</div>
</body>
</html>
