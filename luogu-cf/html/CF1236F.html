<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Alice and the Cactus - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573403536:J4VPpz2CL4lw2otLGbSxeVpAe0Kokq5yyYewHGhCyMc=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Alice%20recently%20found%20some%20cactuses%20growing%20near%20her%20house%21%20After%20several%20months%2C%20more%20and%20more%20cactuses%20appeared%20and%20soon%20they%20blocked%20the%20road.%20So%20Alice%20wants%20to%20clear%20them.%5Cn%5Cn%5BA%20cactus%5D%28https%3A%5C%2F%5C%2Fen.wikipedia.org%5C%2Fwiki%5C%2FCactus_graph%29%20is%20a%20connected%20undirected%20graph.%20No%20edge%20of%20this%20graph%20lies%20on%20more%20than%20one%20simple%20cycle.%20Let%27s%20call%20a%20sequence%20of%20different%20nodes%20of%20the%20graph%20%24%20x_1%2C%20x_2%2C%20%5C%5Cldots%2C%20x_k%20%24%20a%20simple%20cycle%2C%20if%20%24%20k%20%5C%5Cgeq%203%20%24%20and%20all%20pairs%20of%20nodes%20%24%20x_1%20%24%20and%20%24%20x_2%20%24%20%2C%20%24%20x_2%20%24%20and%20%24%20x_3%20%24%20%2C%20%24%20%5C%5Cldots%20%24%20%2C%20%24%20x_%7Bk-1%7D%20%24%20and%20%24%20x_k%20%24%20%2C%20%24%20x_k%20%24%20and%20%24%20x_1%20%24%20are%20connected%20with%20edges.%20Edges%20%24%20%28x_1%2C%20x_2%29%20%24%20%2C%20%24%20%28x_2%2C%20x_3%29%20%24%20%2C%20%24%20%5C%5Cldots%20%24%20%2C%20%24%20%28x_%7Bk-1%7D%2C%20x_k%29%20%24%20%2C%20%24%20%28x_k%2C%20x_1%29%20%24%20lies%20on%20this%20simple%20cycle.%5Cn%5CnThere%20are%20so%20many%20cactuses%2C%20so%20it%20seems%20hard%20to%20destroy%20them.%20But%20Alice%20has%20magic.%20When%20she%20uses%20the%20magic%2C%20every%20node%20of%20the%20cactus%20will%20be%20removed%20independently%20with%20the%20probability%20%24%20%5C%5Cfrac%7B1%7D%7B2%7D%20%24%20.%20When%20a%20node%20is%20removed%2C%20the%20edges%20connected%20to%20it%20are%20also%20removed.%5Cn%5CnNow%20Alice%20wants%20to%20test%20her%20magic.%20She%20has%20picked%20a%20cactus%20with%20%24%20n%20%24%20nodes%20and%20%24%20m%20%24%20edges.%20Let%20%24%20X%5BS%5D%20%24%20%28where%20%24%20S%20%24%20is%20a%20subset%20of%20the%20removed%20nodes%29%20be%20the%20number%20of%20connected%20components%20in%20the%20remaining%20graph%20after%20removing%20nodes%20of%20set%20%24%20S%20%24%20.%20Before%20she%20uses%20magic%2C%20she%20wants%20to%20know%20%5Bthe%20variance%5D%28https%3A%5C%2F%5C%2Fen.wikipedia.org%5C%2Fwiki%5C%2FVariance%29%20of%20random%20variable%20%24%20X%20%24%20%2C%20if%20all%20nodes%20of%20the%20graph%20have%20probability%20%24%20%5C%5Cfrac%7B1%7D%7B2%7D%20%24%20to%20be%20removed%20and%20all%20%24%20n%20%24%20of%20these%20events%20are%20independent.%20By%20the%20definition%20the%20variance%20is%20equal%20to%20%24%20E%5B%28X%20-%20E%5BX%5D%29%5E2%5D%20%24%20%2C%20where%20%24%20E%5BX%5D%20%24%20is%20the%20%5Bexpected%20value%5D%28https%3A%5C%2F%5C%2Fen.wikipedia.org%5C%2Fwiki%5C%2FExpected_value%29%20of%20%24%20X%20%24%20.%20Help%20her%20and%20calculate%20this%20value%20by%20modulo%20%24%2010%5E9%2B7%20%24%20.%5Cn%5CnFormally%2C%20let%20%24%20M%20%3D%2010%5E9%20%2B%207%20%24%20%28a%20prime%20number%29.%20It%20can%20be%20shown%20that%20the%20answer%20can%20be%20expressed%20as%20an%20irreducible%20fraction%20%24%20%5C%5Cfrac%7Bp%7D%7Bq%7D%20%24%20%2C%20where%20%24%20p%20%24%20and%20%24%20q%20%24%20are%20integers%20and%20%24%20q%20%5C%5Cnot%20%5C%5Cequiv%200%20%5C%5Cpmod%7BM%7D%20%24%20.%20Output%20the%20integer%20equal%20to%20%24%20p%20%5C%5Ccdot%20q%5E%7B-1%7D%20%5C%5Cbmod%20M%20%24%20.%20In%20other%20words%2C%20find%20such%20an%20integer%20%24%20x%20%24%20that%20%24%200%20%5C%5Cle%20x%20%3C%20M%20%24%20and%20%24%20x%20%5C%5Ccdot%20q%20%5C%5Cequiv%20p%20%5C%5Cpmod%7BM%7D%20%24%20.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20two%20integers%20%24%20n%20%24%20and%20%24%20m%20%24%20%2C%20separated%20by%20space%20%28%20%24%201%20%5C%5Cleq%20n%20%5C%5Cleq%205%20%5C%5Ccdot%2010%5E5%2C%20n%20-%201%20%5C%5Cleq%20m%20%5C%5Cleq%205%20%5C%5Ccdot%2010%5E5%20%24%20%29%20%5Cu2014%20the%20number%20of%20nodes%20and%20edges%20in%20the%20cactus.%5Cn%5CnThe%20following%20%24%20m%20%24%20lines%20contain%20two%20numbers%20%24%20u%20%24%20and%20%24%20v%20%24%20each%2C%20separated%20by%20space%20%28%20%24%201%20%5C%5Cleq%20u%2C%20v%20%5C%5Cleq%20n%2C%20u%20%5C%5Cneq%20v%20%24%20%29%20meaning%20that%20there%20is%20an%20edge%20between%20the%20nodes%20%24%20u%20%24%20and%20%24%20v%20%24%20.%5Cn%5CnIt%20is%20guaranteed%20that%20there%20are%20no%20loops%20and%20multiple%20edges%20in%20the%20graph%20and%20the%20given%20graph%20is%20cactus.%22%2C%22outputFormat%22%3A%22Print%20one%20integer%20%5Cu2014%20the%20variance%20of%20the%20number%20of%20connected%20components%20in%20the%20remaining%20graph%2C%20after%20removing%20a%20set%20of%20nodes%20such%20that%20each%20node%20has%20probability%20%24%20%5C%5Cfrac%7B1%7D%7B2%7D%20%24%20to%20be%20removed%20and%20all%20these%20events%20are%20independent.%20This%20value%20should%20be%20found%20by%20modulo%20%24%2010%5E9%2B7%20%24%20.%22%2C%22samples%22%3A%5B%5B%22%5Cn3%203%5Cn1%202%5Cn2%203%5Cn1%203%5Cn%22%2C%22%5Cn984375007%22%5D%2C%5B%22%5Cn5%206%5Cn1%202%5Cn2%203%5Cn1%203%5Cn3%204%5Cn4%205%5Cn3%205%5Cn%22%2C%22%5Cn250000002%22%5D%5D%2C%22hint%22%3A%22In%20the%20first%20sample%2C%20the%20answer%20is%20%24%20%5C%5Cfrac%7B7%7D%7B64%7D%20%24%20.%20If%20all%20nodes%20are%20removed%20the%20value%20of%20%24%20X%20%24%20is%20equal%20to%20%24%200%20%24%20%2C%20otherwise%2C%20it%20is%20equal%20to%20%24%201%20%24%20.%20So%2C%20the%20expected%20value%20of%20%24%20X%20%24%20is%20equal%20to%20%24%200%5C%5Ctimes%5C%5Cfrac%7B1%7D%7B8%7D%2B1%5C%5Ctimes%5C%5Cfrac%7B7%7D%7B8%7D%3D%5C%5Cfrac%7B7%7D%7B8%7D%20%24%20.%20So%2C%20the%20variance%20of%20%24%20X%20%24%20is%20equal%20to%20%24%20%280%20-%20%5C%5Cfrac%7B7%7D%7B8%7D%29%5E2%5C%5Ctimes%5C%5Cfrac%7B1%7D%7B8%7D%2B%281-%5C%5Cfrac%7B7%7D%7B8%7D%29%5E2%5C%5Ctimes%5C%5Cfrac%7B7%7D%7B8%7D%20%3D%20%28%5C%5Cfrac%7B7%7D%7B8%7D%29%5E2%5C%5Ctimes%5C%5Cfrac%7B1%7D%7B8%7D%2B%28%5C%5Cfrac%7B1%7D%7B8%7D%29%5E2%5C%5Ctimes%5C%5Cfrac%7B7%7D%7B8%7D%20%3D%20%5C%5Cfrac%7B7%7D%7B64%7D%20%24%20.%5Cn%5CnIn%20the%20second%20sample%2C%20the%20answer%20is%20%24%20%5C%5Cfrac%7B1%7D%7B4%7D%20%24%20.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B3000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F1236%5C%2FF%22%2C%22id%22%3A%221236F%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A1%2C%22totalAccepted%22%3A1%2C%22pid%22%3A%22CF1236F%22%2C%22title%22%3A%22Alice%20and%20the%20Cactus%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Alice%20and%20the%20Cactus%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Alice and the Cactus</h1>
<h2>题目描述</h2>
<div>Alice recently found some cactuses growing near her house! After several months, more and more cactuses appeared and soon they blocked the road. So Alice wants to clear them.
[A cactus](https://en.wikipedia.org/wiki/Cactus_graph) is a connected undirected graph. No edge of this graph lies on more than one simple cycle. Let's call a sequence of different nodes of the graph $ x_1, x_2, \ldots, x_k $ a simple cycle, if $ k \geq 3 $ and all pairs of nodes $ x_1 $ and $ x_2 $ , $ x_2 $ and $ x_3 $ , $ \ldots $ , $ x_{k-1} $ and $ x_k $ , $ x_k $ and $ x_1 $ are connected with edges. Edges $ (x_1, x_2) $ , $ (x_2, x_3) $ , $ \ldots $ , $ (x_{k-1}, x_k) $ , $ (x_k, x_1) $ lies on this simple cycle.
There are so many cactuses, so it seems hard to destroy them. But Alice has magic. When she uses the magic, every node of the cactus will be removed independently with the probability $ \frac{1}{2} $ . When a node is removed, the edges connected to it are also removed.
Now Alice wants to test her magic. She has picked a cactus with $ n $ nodes and $ m $ edges. Let $ X[S] $ (where $ S $ is a subset of the removed nodes) be the number of connected components in the remaining graph after removing nodes of set $ S $ . Before she uses magic, she wants to know [the variance](https://en.wikipedia.org/wiki/Variance) of random variable $ X $ , if all nodes of the graph have probability $ \frac{1}{2} $ to be removed and all $ n $ of these events are independent. By the definition the variance is equal to $ E[(X - E[X])^2] $ , where $ E[X] $ is the [expected value](https://en.wikipedia.org/wiki/Expected_value) of $ X $ . Help her and calculate this value by modulo $ 10^9+7 $ .
Formally, let $ M = 10^9 + 7 $ (a prime number). It can be shown that the answer can be expressed as an irreducible fraction $ \frac{p}{q} $ , where $ p $ and $ q $ are integers and $ q \not \equiv 0 \pmod{M} $ . Output the integer equal to $ p \cdot q^{-1} \bmod M $ . In other words, find such an integer $ x $ that $ 0 \le x < M $ and $ x \cdot q \equiv p \pmod{M} $ .</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains two integers $ n $ and $ m $ , separated by space ( $ 1 \leq n \leq 5 \cdot 10^5, n - 1 \leq m \leq 5 \cdot 10^5 $ ) — the number of nodes and edges in the cactus.
The following $ m $ lines contain two numbers $ u $ and $ v $ each, separated by space ( $ 1 \leq u, v \leq n, u \neq v $ ) meaning that there is an edge between the nodes $ u $ and $ v $ .
It is guaranteed that there are no loops and multiple edges in the graph and the given graph is cactus.</div>
<h3>输出格式</h3>
<br />
<div>Print one integer — the variance of the number of connected components in the remaining graph, after removing a set of nodes such that each node has probability $ \frac{1}{2} $ to be removed and all these events are independent. This value should be found by modulo $ 10^9+7 $ .</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>
3 3
1 2
2 3
1 3
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>
984375007</code></pre>
<h3>输入样例 #2</h3>
<pre><code>
5 6
1 2
2 3
1 3
3 4
4 5
3 5
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>
250000002</code></pre>
<h2>说明</h2>
<div>In the first sample, the answer is $ \frac{7}{64} $ . If all nodes are removed the value of $ X $ is equal to $ 0 $ , otherwise, it is equal to $ 1 $ . So, the expected value of $ X $ is equal to $ 0\times\frac{1}{8}+1\times\frac{7}{8}=\frac{7}{8} $ . So, the variance of $ X $ is equal to $ (0 - \frac{7}{8})^2\times\frac{1}{8}+(1-\frac{7}{8})^2\times\frac{7}{8} = (\frac{7}{8})^2\times\frac{1}{8}+(\frac{1}{8})^2\times\frac{7}{8} = \frac{7}{64} $ .
In the second sample, the answer is $ \frac{1}{4} $ .</div>
</article>
</div>
</div>
</body>
</html>
