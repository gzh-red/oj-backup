<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Network Safety - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573400850:PNegKwzEGHiiSF+2JbBdXWzj59c8I/YsiwPbaSM5JGg=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%22%2C%22description%22%3A%22The%20Metropolis%20computer%20network%20consists%20of%20%24%20n%20%24%20servers%2C%20each%20has%20an%20encryption%20key%20in%20the%20range%20from%20%24%200%20%24%20to%20%24%202%5Ek%20-%201%20%24%20assigned%20to%20it.%20Let%20%24%20c_i%20%24%20be%20the%20encryption%20key%20assigned%20to%20the%20%24%20i%20%24%20-th%20server.%20Additionally%2C%20%24%20m%20%24%20pairs%20of%20servers%20are%20directly%20connected%20via%20a%20data%20communication%20channel.%20Because%20of%20the%20encryption%20algorithms%20specifics%2C%20a%20data%20communication%20channel%20can%20only%20be%20considered%20safe%20if%20the%20two%20servers%20it%20connects%20have%20distinct%20encryption%20keys.%20The%20initial%20assignment%20of%20encryption%20keys%20is%20guaranteed%20to%20keep%20all%20data%20communication%20channels%20safe.%5Cn%5CnYou%20have%20been%20informed%20that%20a%20new%20virus%20is%20actively%20spreading%20across%20the%20internet%2C%20and%20it%20is%20capable%20to%20change%20the%20encryption%20key%20of%20any%20server%20it%20infects.%20More%20specifically%2C%20the%20virus%20body%20contains%20some%20unknown%20number%20%24%20x%20%24%20in%20the%20same%20aforementioned%20range%2C%20and%20when%20server%20%24%20i%20%24%20is%20infected%2C%20its%20encryption%20key%20changes%20from%20%24%20c_i%20%24%20to%20%24%20c_i%20%5C%5Coplus%20x%20%24%20%2C%20where%20%24%20%5C%5Coplus%20%24%20denotes%20the%20%5Bbitwise%20XOR%20operation%5D%28https%3A%5C%2F%5C%2Fen.wikipedia.org%5C%2Fwiki%5C%2FBitwise_operation%23XOR%29.%5Cn%5CnSadly%2C%20you%20know%20neither%20the%20number%20%24%20x%20%24%20nor%20which%20servers%20of%20Metropolis%20are%20going%20to%20be%20infected%20by%20the%20dangerous%20virus%2C%20so%20you%20have%20decided%20to%20count%20the%20number%20of%20such%20situations%20in%20which%20all%20data%20communication%20channels%20remain%20safe.%20Formally%20speaking%2C%20you%20need%20to%20find%20the%20number%20of%20pairs%20%24%20%28A%2C%20x%29%20%24%20%2C%20where%20%24%20A%20%24%20is%20some%20%28possibly%20empty%29%20subset%20of%20the%20set%20of%20servers%20and%20%24%20x%20%24%20is%20some%20number%20in%20the%20range%20from%20%24%200%20%24%20to%20%24%202%5Ek%20-%201%20%24%20%2C%20such%20that%20when%20all%20servers%20from%20the%20chosen%20subset%20%24%20A%20%24%20and%20none%20of%20the%20others%20are%20infected%20by%20a%20virus%20containing%20the%20number%20%24%20x%20%24%20%2C%20all%20data%20communication%20channels%20remain%20safe.%20Since%20this%20number%20can%20be%20quite%20big%2C%20you%20are%20asked%20to%20find%20its%20remainder%20modulo%20%24%2010%5E9%20%2B%207%20%24%20.%22%2C%22inputFormat%22%3A%22The%20first%20line%20of%20input%20contains%20three%20integers%20%24%20n%20%24%20%2C%20%24%20m%20%24%20and%20%24%20k%20%24%20%28%20%24%201%20%5C%5Cleq%20n%20%5C%5Cleq%20500%5C%5C%2C000%20%24%20%2C%20%24%200%20%5C%5Cleq%20m%20%5C%5Cleq%20%5C%5Cmin%28%5C%5Cfrac%7Bn%28n%20-%201%29%7D%7B2%7D%2C%20500%5C%5C%2C000%29%20%24%20%2C%20%24%200%20%5C%5Cleq%20k%20%5C%5Cleq%2060%20%24%20%29%20%5Cu2014%20the%20number%20of%20servers%2C%20the%20number%20of%20pairs%20of%20servers%20directly%20connected%20by%20a%20data%20communication%20channel%2C%20and%20the%20parameter%20%24%20k%20%24%20%2C%20which%20defines%20the%20range%20of%20possible%20values%20for%20encryption%20keys.%5Cn%5CnThe%20next%20line%20contains%20%24%20n%20%24%20integers%20%24%20c_i%20%24%20%28%20%24%200%20%5C%5Cleq%20c_i%20%5C%5Cleq%202%5Ek%20-%201%20%24%20%29%2C%20the%20%24%20i%20%24%20-th%20of%20which%20is%20the%20encryption%20key%20used%20by%20the%20%24%20i%20%24%20-th%20server.%5Cn%5CnThe%20next%20%24%20m%20%24%20lines%20contain%20two%20integers%20%24%20u_i%20%24%20and%20%24%20v_i%20%24%20each%20%28%20%24%201%20%5C%5Cleq%20u_i%2C%20v_i%20%5C%5Cleq%20n%20%24%20%2C%20%24%20u_i%20%5C%5Cne%20v_i%20%24%20%29%20denoting%20that%20those%20servers%20are%20connected%20by%20a%20data%20communication%20channel.%20It%20is%20guaranteed%20that%20each%20pair%20of%20servers%20appears%20in%20this%20list%20at%20most%20once.%22%2C%22outputFormat%22%3A%22The%20only%20output%20line%20should%20contain%20a%20single%20integer%20%5Cu2014%20the%20number%20of%20safe%20infections%20of%20some%20subset%20of%20servers%20by%20a%20virus%20with%20some%20parameter%2C%20modulo%20%24%2010%5E9%20%2B%207%20%24%20.%22%2C%22samples%22%3A%5B%5B%224%204%202%5Cn0%201%200%201%5Cn1%202%5Cn2%203%5Cn3%204%5Cn4%201%5Cn%22%2C%2250%5Cn%22%5D%2C%5B%224%205%203%5Cn7%201%207%202%5Cn1%202%5Cn2%203%5Cn3%204%5Cn4%201%5Cn2%204%5Cn%22%2C%2296%5Cn%22%5D%5D%2C%22hint%22%3A%22Consider%20the%20first%20example.%5Cn%5CnPossible%20values%20for%20the%20number%20%24%20x%20%24%20contained%20by%20the%20virus%20are%20%24%200%20%24%20%2C%20%24%201%20%24%20%2C%20%24%202%20%24%20and%20%24%203%20%24%20.%5Cn%5CnFor%20values%20%24%200%20%24%20%2C%20%24%202%20%24%20and%20%24%203%20%24%20the%20virus%20can%20infect%20any%20subset%20of%20the%20set%20of%20servers%2C%20which%20gives%20us%20%24%2016%20%24%20pairs%20for%20each%20values.%20A%20virus%20containing%20the%20number%20%24%201%20%24%20can%20infect%20either%20all%20of%20the%20servers%2C%20or%20none.%20This%20gives%20us%20%24%2016%20%2B%202%20%2B%2016%20%2B%2016%20%3D%2050%20%24%20pairs%20in%20total.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B3000%5D%2C%22memory%22%3A%5B512000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F1039%5C%2FC%22%2C%22id%22%3A%221039C%22%7D%2C%22translation%22%3A%22%5Cu9898%5Cu610f%5Cuff1a%5Cn%5Cn%5Cu7ed9%5Cu4f60%5Cu4e00%5Cu4e2a%5Cu6709%24n%24%5Cu70b9%5Cu4e2a%5Cu548c%24m%24%5Cu6761%5Cu8fb9%5Cu7684%5Cu56fe%5Cuff0c%5Cu7b2c%24i%24%5Cu4e2a%5Cu70b9%5Cu7684%5Cu6743%5Cu503c%5Cu4e3a%24c_i%24%5Cu3002%5Cn%5Cn%5Cu5b9a%5Cu4e49%5Cu56fe%5Cu4e3a%5Cu5b89%5Cu5168%5Cu7684%5Cu6761%5Cu4ef6%5Cu5bf9%5Cu4e8e%5Cu6240%5Cu6709%5Cu7684%5Cu8fb9%5Cu90fd%5Cu4fdd%5Cu8bc1%24c_l%5Cu2260c_r%24%5Cn%5Cn%5Cu8bf7%5Cu4f60%5Cu6c42%5Cu51fa%5Cu5bf9%5Cu4e8e%5Cu4efb%5Cu610f%5Cu7684%24x%24%5Cuff0c%5Cu96c6%5Cu5408%24s%24%5Cu4e2d%5Cu6240%5Cu6709%5Cu70b9%5Cu7684%5Cu70b9%5Cu6743%24xor%5C%5Cquad%20x%24%5Cu540e%5Cu56fe%5Cu4ecd%5Cu7136%5Cu5b89%5Cu5168%5Cuff0c%5Cu8fd9%5Cu6837%5Cu7684%24x%24%5Cu548c%24s%24%5Cu7684%5Cu7ec4%5Cu5408%5Cu7684%5Cu6570%5Cu91cf%5Cu3002%5Cn%5Cn%5Cu7b54%5Cu6848%5Cu5bf9%5Cu4e8e%241e9%2B7%24%5Cu53d6%5Cu6a21%5Cn%5Cn%5Cu4fdd%5Cu8bc1%5Cu4e00%5Cu5f00%5Cu59cb%5Cu7ed9%5Cu51fa%5Cu7684%5Cu56fe%5Cu662f%5Cu5b89%5Cu5168%5Cu7684%5Cu3002%5Cn%5Cn%5Cu8f93%5Cu5165%5Cu683c%5Cu5f0f%5Cuff1a%5Cn%5Cn%5Cu7b2c%5Cu4e00%5Cu884c%5Cu4e00%5Cu5171%5Cu4e09%5Cu4e2a%5Cu6574%5Cu6570%24n%28n%3C%3D500000%29%2Cm%28m%3C%3Dmin%28%5C%5Cfrac%7Bn%2A%28n-1%29%7D%7B2%7D%2C500000%29%29%2Ck%28k%3C%3D60%29%24%5Cn%5Cn%5Cu7b2c%5Cu4e8c%5Cu884c%5Cu4e00%5Cu5171%24n%24%5Cu4e2a%5Cu6574%5Cu6570%24c_i%28c_i%3C%3D2%5Ek-1%29%24%5Cn%5Cn%5Cu63a5%5Cu4e0b%5Cu6765%5Cu7684%24m%24%5Cu884c%5Cu6bcf%5Cu884c%5Cu4e24%5Cu4e2a%5Cu6574%5Cu6570%24l%2Cr%24%5Cuff0c%5Cu8868%5Cu793a%24l%24%5Cu548c%24r%24%5Cu4e4b%5Cu95f4%5Cu6709%5Cu8fb9%5Cn%5Cn%5Cu8f93%5Cu51fa%5Cu683c%5Cu5f0f%5Cuff1a%5Cn%5Cn%5Cu4e00%5Cu5171%5Cu4e00%5Cu4e2a%5Cu6574%5Cu6570%5Cuff0c%5Cu8868%5Cu793a%5Cu7b54%5Cu6848%5Cn%22%2C%22tags%22%3A%5B47%2C111%2C266%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A50%2C%22totalAccepted%22%3A27%2C%22pid%22%3A%22CF1039C%22%2C%22title%22%3A%22Network%20Safety%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A65159%2C%22title%22%3A%22%5Cu5c1d%5Cu8bd5%5Cu7ffb%5Cu8bd1%22%2C%22forum%22%3A%7B%22id%22%3A29223%2C%22name%22%3A%22CF1039C%20Network%20Safety%22%2C%22slug%22%3A%22CF1039C%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P2568%22%2C%22title%22%3A%22GCD%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P4782%22%2C%22title%22%3A%22%5Cu3010%5Cu6a21%5Cu677f%5Cu30112-SAT%20%5Cu95ee%5Cu9898%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22CF1039D%22%2C%22title%22%3A%22You%20Are%20Given%20a%20Tree%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1031D%22%2C%22title%22%3A%22Minimum%20path%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1043F%22%2C%22title%22%3A%22Make%20It%20One%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Network%20Safety%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Network Safety</h1>
<h2>题意翻译</h2>
<div>题意：
给你一个有$n$点个和$m$条边的图，第$i$个点的权值为$c_i$。
定义图为安全的条件对于所有的边都保证$c_l≠c_r$
请你求出对于任意的$x$，集合$s$中所有点的点权$xor\quad x$后图仍然安全，这样的$x$和$s$的组合的数量。
答案对于$1e9+7$取模
保证一开始给出的图是安全的。
输入格式：
第一行一共三个整数$n(n<=500000),m(m<=min(\frac{n*(n-1)}{2},500000)),k(k<=60)$
第二行一共$n$个整数$c_i(c_i<=2^k-1)$
接下来的$m$行每行两个整数$l,r$，表示$l$和$r$之间有边
输出格式：
一共一个整数，表示答案
</div>
<h2>题目描述</h2>
<div>The Metropolis computer network consists of $ n $ servers, each has an encryption key in the range from $ 0 $ to $ 2^k - 1 $ assigned to it. Let $ c_i $ be the encryption key assigned to the $ i $ -th server. Additionally, $ m $ pairs of servers are directly connected via a data communication channel. Because of the encryption algorithms specifics, a data communication channel can only be considered safe if the two servers it connects have distinct encryption keys. The initial assignment of encryption keys is guaranteed to keep all data communication channels safe.
You have been informed that a new virus is actively spreading across the internet, and it is capable to change the encryption key of any server it infects. More specifically, the virus body contains some unknown number $ x $ in the same aforementioned range, and when server $ i $ is infected, its encryption key changes from $ c_i $ to $ c_i \oplus x $ , where $ \oplus $ denotes the [bitwise XOR operation](https://en.wikipedia.org/wiki/Bitwise_operation#XOR).
Sadly, you know neither the number $ x $ nor which servers of Metropolis are going to be infected by the dangerous virus, so you have decided to count the number of such situations in which all data communication channels remain safe. Formally speaking, you need to find the number of pairs $ (A, x) $ , where $ A $ is some (possibly empty) subset of the set of servers and $ x $ is some number in the range from $ 0 $ to $ 2^k - 1 $ , such that when all servers from the chosen subset $ A $ and none of the others are infected by a virus containing the number $ x $ , all data communication channels remain safe. Since this number can be quite big, you are asked to find its remainder modulo $ 10^9 + 7 $ .</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line of input contains three integers $ n $ , $ m $ and $ k $ ( $ 1 \leq n \leq 500\,000 $ , $ 0 \leq m \leq \min(\frac{n(n - 1)}{2}, 500\,000) $ , $ 0 \leq k \leq 60 $ ) — the number of servers, the number of pairs of servers directly connected by a data communication channel, and the parameter $ k $ , which defines the range of possible values for encryption keys.
The next line contains $ n $ integers $ c_i $ ( $ 0 \leq c_i \leq 2^k - 1 $ ), the $ i $ -th of which is the encryption key used by the $ i $ -th server.
The next $ m $ lines contain two integers $ u_i $ and $ v_i $ each ( $ 1 \leq u_i, v_i \leq n $ , $ u_i \ne v_i $ ) denoting that those servers are connected by a data communication channel. It is guaranteed that each pair of servers appears in this list at most once.</div>
<h3>输出格式</h3>
<br />
<div>The only output line should contain a single integer — the number of safe infections of some subset of servers by a virus with some parameter, modulo $ 10^9 + 7 $ .</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>4 4 2
0 1 0 1
1 2
2 3
3 4
4 1
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>50
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>4 5 3
7 1 7 2
1 2
2 3
3 4
4 1
2 4
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>96
</code></pre>
<h2>说明</h2>
<div>Consider the first example.
Possible values for the number $ x $ contained by the virus are $ 0 $ , $ 1 $ , $ 2 $ and $ 3 $ .
For values $ 0 $ , $ 2 $ and $ 3 $ the virus can infect any subset of the set of servers, which gives us $ 16 $ pairs for each values. A virus containing the number $ 1 $ can infect either all of the servers, or none. This gives us $ 16 + 2 + 16 + 16 = 50 $ pairs in total.</div>
</article>
</div>
</div>
</body>
</html>
