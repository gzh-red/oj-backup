<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Horse Races - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573390747:fek6QmXfVDAeDn6r8eOvJq1cWP0Q41mZ0+Cny4TpbV8=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Petya%20likes%20horse%20racing%20very%20much.%20Horses%20numbered%20from%20%24%20l%20%24%20to%20%24%20r%20%24%20take%20part%20in%20the%20races.%20Petya%20wants%20to%20evaluate%20the%20probability%20of%20victory%3B%20for%20some%20reason%2C%20to%20do%20that%20he%20needs%20to%20know%20the%20amount%20of%20nearly%20lucky%20horses%27%20numbers.%20A%20nearly%20lucky%20number%20is%20an%20integer%20number%20that%20has%20at%20least%20two%20lucky%20digits%20the%20distance%20between%20which%20does%20not%20exceed%20%24%20k%20%24%20.%20Petya%20learned%20from%20some%20of%20his%20mates%20from%20Lviv%20that%20lucky%20digits%20are%20digits%20%24%204%20%24%20and%20%24%207%20%24%20.%20The%20distance%20between%20the%20digits%20is%20the%20absolute%20difference%20between%20their%20positions%20in%20the%20number%20of%20a%20horse.%20For%20example%2C%20if%20%24%20k%3D2%20%24%20%2C%20then%20numbers%20%24%20412395497%20%24%20%2C%20%24%20404%20%24%20%2C%20%24%204070400000070004007%20%24%20are%20nearly%20lucky%20and%20numbers%20%24%204%20%24%20%2C%20%24%204123954997%20%24%20%2C%20%24%204007000040070004007%20%24%20are%20not.%5Cn%5CnPetya%20prepared%20%24%20t%20%24%20intervals%20%24%20%5Bl_%7Bi%7D%2Cr_%7Bi%7D%5D%20%24%20and%20invented%20number%20%24%20k%20%24%20%2C%20common%20for%20all%20of%20them.%20Your%20task%20is%20to%20find%20how%20many%20nearly%20happy%20numbers%20there%20are%20in%20each%20of%20these%20segments.%20Since%20the%20answers%20can%20be%20quite%20large%2C%20output%20them%20modulo%20%24%201000000007%20%24%20%28%20%24%2010%5E%7B9%7D%2B7%20%24%20%29.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20two%20integers%20%24%20t%20%24%20and%20%24%20k%20%24%20%28%20%24%201%3C%3Dt%2Ck%3C%3D1000%20%24%20%29%20%5Cu2014%20the%20number%20of%20segments%20and%20the%20distance%20between%20the%20numbers%20correspondingly.%20Next%20%24%20t%20%24%20lines%20contain%20pairs%20of%20integers%20%24%20l_%7Bi%7D%20%24%20and%20%24%20r_%7Bi%7D%20%24%20%28%20%24%201%3C%3Dl%3C%3Dr%3C%3D10%5E%7B1000%7D%20%24%20%29.%20All%20numbers%20are%20given%20without%20the%20leading%20zeroes.%20Numbers%20in%20each%20line%20are%20separated%20by%20exactly%20one%20space%20character.%22%2C%22outputFormat%22%3A%22Output%20%24%20t%20%24%20lines.%20In%20each%20line%20print%20one%20integer%20%5Cu2014%20the%20answer%20for%20the%20corresponding%20segment%20modulo%20%24%201000000007%20%24%20%28%20%24%2010%5E%7B9%7D%2B7%20%24%20%29.%22%2C%22samples%22%3A%5B%5B%221%202%5Cn1%20100%5Cn%22%2C%224%5Cn%22%5D%2C%5B%221%202%5Cn70%2077%5Cn%22%2C%222%5Cn%22%5D%2C%5B%222%201%5Cn1%2020%5Cn80%20100%5Cn%22%2C%220%5Cn0%5Cn%22%5D%5D%2C%22hint%22%3A%22In%20the%20first%20sample%2C%20the%20four%20nearly%20lucky%20numbers%20are%2044%2C%2047%2C%2074%2C%2077.%5Cn%5CnIn%20the%20second%20sample%2C%20only%2074%20and%2077%20are%20in%20the%20given%20segment.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F95%5C%2FD%22%2C%22id%22%3A%2295D%22%7D%2C%22translation%22%3A%22%5Cu5f7c%5Cu4f73%5Cu975e%5Cu5e38%5Cu559c%5Cu6b22%5Cu8d5b%5Cu9a6c%5Cuff0c%5Cu6709%5Cu7f16%5Cu53f7%5Cu4ecel%5Cu5230r%5Cu7684%5Cu9a6c%5Cu53c2%5Cu52a0%5Cu6bd4%5Cu8d5b%5Cu3002%5Cu5e78%5Cu8fd0%5Cu6570%5Cu5b57%5Cu4e3a4%5Cu62167%5Cu3002%5Cu6709%5Cu673a%5Cu4f1a%5Cu8d62%5Cu7684%5Cu9a6c%5Cu7684%5Cu7f16%5Cu53f7%5Cu6ee1%5Cu8db3%5Cu5728%5Cu8fd9%5Cu4e00%5Cu4e32%5Cu6570%5Cu5b57%5Cu4e2d%5Cuff0c%5Cu5b58%5Cu5728%5Cu4e24%5Cu4e2a%5Cu5e78%5Cu8fd0%5Cu6570%5Cu5b57%5Cuff0c%5Cu5b83%5Cu4eec%5Cu4e4b%5Cu95f4%5Cu7684%5Cu8ddd%5Cu79bb%5Cu4e0d%5Cu8d85%5Cu8fc7k%5Cuff08%5Cu4e24%5Cu4e2a%5Cu76f8%5Cu90bb%5Cu7684%5Cu6570%5Cu5b57%5Cu4e4b%5Cu95f4%5Cu7684%5Cu8ddd%5Cu79bb%5Cu4e3a1%5Cuff09%5Cu3002%5Cu95ee%5Cu6709%5Cu673a%5Cu4f1a%5Cu8d62%5Cu7684%5Cu9a6c%5Cu7684%5Cu7f16%5Cu53f7%5Cu4e00%5Cu5171%5Cu6709%5Cu51e0%5Cu4e2a%5Cu3002%5Cu8f93%5Cu51fa%5Cu7b54%5Cu6848%5Cu5bf91e9%2B7%5Cu53d6%5Cu6a21%5Cu3002%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A7%2C%22totalAccepted%22%3A2%2C%22pid%22%3A%22CF95D%22%2C%22title%22%3A%22Horse%20Races%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Horse%20Races%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573295103;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Horse Races</h1>
<h2>题意翻译</h2>
<div>彼佳非常喜欢赛马，有编号从l到r的马参加比赛。幸运数字为4或7。有机会赢的马的编号满足在这一串数字中，存在两个幸运数字，它们之间的距离不超过k（两个相邻的数字之间的距离为1）。问有机会赢的马的编号一共有几个。输出答案对1e9+7取模。</div>
<h2>题目描述</h2>
<div>Petya likes horse racing very much. Horses numbered from $ l $ to $ r $ take part in the races. Petya wants to evaluate the probability of victory; for some reason, to do that he needs to know the amount of nearly lucky horses' numbers. A nearly lucky number is an integer number that has at least two lucky digits the distance between which does not exceed $ k $ . Petya learned from some of his mates from Lviv that lucky digits are digits $ 4 $ and $ 7 $ . The distance between the digits is the absolute difference between their positions in the number of a horse. For example, if $ k=2 $ , then numbers $ 412395497 $ , $ 404 $ , $ 4070400000070004007 $ are nearly lucky and numbers $ 4 $ , $ 4123954997 $ , $ 4007000040070004007 $ are not.
Petya prepared $ t $ intervals $ [l_{i},r_{i}] $ and invented number $ k $ , common for all of them. Your task is to find how many nearly happy numbers there are in each of these segments. Since the answers can be quite large, output them modulo $ 1000000007 $ ( $ 10^{9}+7 $ ).</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains two integers $ t $ and $ k $ ( $ 1<=t,k<=1000 $ ) — the number of segments and the distance between the numbers correspondingly. Next $ t $ lines contain pairs of integers $ l_{i} $ and $ r_{i} $ ( $ 1<=l<=r<=10^{1000} $ ). All numbers are given without the leading zeroes. Numbers in each line are separated by exactly one space character.</div>
<h3>输出格式</h3>
<br />
<div>Output $ t $ lines. In each line print one integer — the answer for the corresponding segment modulo $ 1000000007 $ ( $ 10^{9}+7 $ ).</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>1 2
1 100
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>4
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>1 2
70 77
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>2
</code></pre>
<h3>输入样例 #3</h3>
<pre><code>2 1
1 20
80 100
</code></pre>
<h3>输出样例 #3</h3>
<pre><code>0
0
</code></pre>
<h2>说明</h2>
<div>In the first sample, the four nearly lucky numbers are 44, 47, 74, 77.
In the second sample, only 74 and 77 are in the given segment.</div>
</article>
</div>
</div>
</body>
</html>
