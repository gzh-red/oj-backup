<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Army Creation - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573398191:ZwuapHtCHf0Xf+pEC+7pwllQw9Q5qDTjtSs1N5dV4xk=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%22%2C%22description%22%3A%22As%20you%20might%20remember%20from%20our%20previous%20rounds%2C%20Vova%20really%20likes%20computer%20games.%20Now%20he%20is%20playing%20a%20strategy%20game%20known%20as%20Rage%20of%20Empires.%5Cn%5CnIn%20the%20game%20Vova%20can%20hire%20%24%20n%20%24%20different%20warriors%3B%20%24%20i%20%24%20th%20warrior%20has%20the%20type%20%24%20a_%7Bi%7D%20%24%20.%20Vova%20wants%20to%20create%20a%20balanced%20army%20hiring%20some%20subset%20of%20warriors.%20An%20army%20is%20called%20balanced%20if%20for%20each%20type%20of%20warrior%20present%20in%20the%20game%20there%20are%20not%20more%20than%20%24%20k%20%24%20warriors%20of%20this%20type%20in%20the%20army.%20Of%20course%2C%20Vova%20wants%20his%20army%20to%20be%20as%20large%20as%20possible.%5Cn%5CnTo%20make%20things%20more%20complicated%2C%20Vova%20has%20to%20consider%20%24%20q%20%24%20different%20plans%20of%20creating%20his%20army.%20%24%20i%20%24%20th%20plan%20allows%20him%20to%20hire%20only%20warriors%20whose%20numbers%20are%20not%20less%20than%20%24%20l_%7Bi%7D%20%24%20and%20not%20greater%20than%20%24%20r_%7Bi%7D%20%24%20.%5Cn%5CnHelp%20Vova%20to%20determine%20the%20largest%20size%20of%20a%20balanced%20army%20for%20each%20plan.%5Cn%5CnBe%20aware%20that%20the%20plans%20are%20given%20in%20a%20modified%20way.%20See%20input%20section%20for%20details.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20two%20integers%20%24%20n%20%24%20and%20%24%20k%20%24%20%28%20%24%201%3C%3Dn%2Ck%3C%3D100000%20%24%20%29.%5Cn%5CnThe%20second%20line%20contains%20%24%20n%20%24%20integers%20%24%20a_%7B1%7D%20%24%20%2C%20%24%20a_%7B2%7D%20%24%20%2C%20...%20%24%20a_%7Bn%7D%20%24%20%28%20%24%201%3C%3Da_%7Bi%7D%3C%3D100000%20%24%20%29.%5Cn%5CnThe%20third%20line%20contains%20one%20integer%20%24%20q%20%24%20%28%20%24%201%3C%3Dq%3C%3D100000%20%24%20%29.%5Cn%5CnThen%20%24%20q%20%24%20lines%20follow.%20%24%20i%20%24%20th%20line%20contains%20two%20numbers%20%24%20x_%7Bi%7D%20%24%20and%20%24%20y_%7Bi%7D%20%24%20which%20represent%20%24%20i%20%24%20th%20plan%20%28%20%24%201%3C%3Dx_%7Bi%7D%2Cy_%7Bi%7D%3C%3Dn%20%24%20%29.%5Cn%5CnYou%20have%20to%20keep%20track%20of%20the%20answer%20to%20the%20last%20plan%20%28let%27s%20call%20it%20%24%20last%20%24%20%29.%20In%20the%20beginning%20%24%20last%3D0%20%24%20.%20Then%20to%20restore%20values%20of%20%24%20l_%7Bi%7D%20%24%20and%20%24%20r_%7Bi%7D%20%24%20for%20the%20%24%20i%20%24%20th%20plan%2C%20you%20have%20to%20do%20the%20following%3A%5Cn%5Cn1.%20%24%20l_%7Bi%7D%3D%28%28x_%7Bi%7D%2Blast%29%5Cu00a0mod%5Cu00a0n%29%2B1%20%24%20%3B%5Cn2.%20%24%20r_%7Bi%7D%3D%28%28y_%7Bi%7D%2Blast%29%5Cu00a0mod%5Cu00a0n%29%2B1%20%24%20%3B%5Cn3.%20If%20%24%20l_%7Bi%7D%3Er_%7Bi%7D%20%24%20%2C%20swap%20%24%20l_%7Bi%7D%20%24%20and%20%24%20r_%7Bi%7D%20%24%20.%22%2C%22outputFormat%22%3A%22Print%20%24%20q%20%24%20numbers.%20%24%20i%20%24%20th%20number%20must%20be%20equal%20to%20the%20maximum%20size%20of%20a%20balanced%20army%20when%20considering%20%24%20i%20%24%20th%20plan.%22%2C%22samples%22%3A%5B%5B%226%202%5Cn1%201%201%202%202%202%5Cn5%5Cn1%206%5Cn4%203%5Cn1%201%5Cn2%206%5Cn2%206%5Cn%22%2C%222%5Cn4%5Cn1%5Cn3%5Cn2%5Cn%22%5D%5D%2C%22hint%22%3A%22In%20the%20first%20example%20the%20real%20plans%20are%3A%5Cn%5Cn1.%20%24%201%5Cu00a02%20%24%5Cn2.%20%24%201%5Cu00a06%20%24%5Cn3.%20%24%206%5Cu00a06%20%24%5Cn4.%20%24%202%5Cu00a04%20%24%5Cn5.%20%24%204%5Cu00a06%20%24%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F813%5C%2FE%22%2C%22id%22%3A%22813E%22%7D%2C%22translation%22%3A%22%24n%24%5Cu4e2a%5Cu6570%24a%5Bi%5D%24%2C%24q%24%5Cu6b21%5Cu8be2%5Cu95ee%2C%24n%2Ca%5Bi%5D%2Cq%3C%3D10%5E5%24.%5Cn%5Cu6bcf%5Cu6b21%5Cu95ee%24%5Bl%2Cr%5D%24%5Cu5185%5Cu6700%5Cu591a%5Cu53ef%5Cu4ee5%5Cu9009%5Cu591a%5Cu5c11%5Cu4e2a%5Cu6570%2C%5Cu6ee1%5Cu8db3%5Cu540c%5Cu4e00%5Cu4e2a%5Cu6570%5Cu7684%5Cu51fa%5Cu73b0%5Cu6b21%5Cu6570%5Cu4e0d%5Cu8d85%5Cu8fc7%24k%24%3F%5Cn%5CnTranslated%20by%20%40yler%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A88%2C%22totalAccepted%22%3A51%2C%22pid%22%3A%22CF813E%22%2C%22title%22%3A%22Army%20Creation%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A36343%2C%22title%22%3A%22%5Cu7ffb%5Cu8bd1%22%2C%22forum%22%3A%7B%22id%22%3A9333%2C%22name%22%3A%22CF813E%20Army%20Creation%22%2C%22slug%22%3A%22CF813E%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P2042%22%2C%22title%22%3A%22%5BNOI2005%5D%5Cu7ef4%5Cu62a4%5Cu6570%5Cu5217%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P2839%22%2C%22title%22%3A%22%5B%5Cu56fd%5Cu5bb6%5Cu96c6%5Cu8bad%5Cu961f%5Dmiddle%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22CF484E%22%2C%22title%22%3A%22Sign%20on%20Fence%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF70D%22%2C%22title%22%3A%22Professor%27s%20task%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF960F%22%2C%22title%22%3A%22Pathwalks%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Army%20Creation%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Army Creation</h1>
<h2>题意翻译</h2>
<div>$n$个数$a[i]$,$q$次询问,$n,a[i],q<=10^5$.
每次问$[l,r]$内最多可以选多少个数,满足同一个数的出现次数不超过$k$?
Translated by @yler</div>
<h2>题目描述</h2>
<div>As you might remember from our previous rounds, Vova really likes computer games. Now he is playing a strategy game known as Rage of Empires.
In the game Vova can hire $ n $ different warriors; $ i $ th warrior has the type $ a_{i} $ . Vova wants to create a balanced army hiring some subset of warriors. An army is called balanced if for each type of warrior present in the game there are not more than $ k $ warriors of this type in the army. Of course, Vova wants his army to be as large as possible.
To make things more complicated, Vova has to consider $ q $ different plans of creating his army. $ i $ th plan allows him to hire only warriors whose numbers are not less than $ l_{i} $ and not greater than $ r_{i} $ .
Help Vova to determine the largest size of a balanced army for each plan.
Be aware that the plans are given in a modified way. See input section for details.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains two integers $ n $ and $ k $ ( $ 1<=n,k<=100000 $ ).
The second line contains $ n $ integers $ a_{1} $ , $ a_{2} $ , ... $ a_{n} $ ( $ 1<=a_{i}<=100000 $ ).
The third line contains one integer $ q $ ( $ 1<=q<=100000 $ ).
Then $ q $ lines follow. $ i $ th line contains two numbers $ x_{i} $ and $ y_{i} $ which represent $ i $ th plan ( $ 1<=x_{i},y_{i}<=n $ ).
You have to keep track of the answer to the last plan (let's call it $ last $ ). In the beginning $ last=0 $ . Then to restore values of $ l_{i} $ and $ r_{i} $ for the $ i $ th plan, you have to do the following:
1. $ l_{i}=((x_{i}+last) mod n)+1 $ ;
2. $ r_{i}=((y_{i}+last) mod n)+1 $ ;
3. If $ l_{i}>r_{i} $ , swap $ l_{i} $ and $ r_{i} $ .</div>
<h3>输出格式</h3>
<br />
<div>Print $ q $ numbers. $ i $ th number must be equal to the maximum size of a balanced army when considering $ i $ th plan.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>6 2
1 1 1 2 2 2
5
1 6
4 3
1 1
2 6
2 6
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>2
4
1
3
2
</code></pre>
<h2>说明</h2>
<div>In the first example the real plans are:
1. $ 1 2 $
2. $ 1 6 $
3. $ 6 6 $
4. $ 2 4 $
5. $ 4 6 $</div>
</article>
</div>
</div>
</body>
</html>
