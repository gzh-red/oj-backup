<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Catch Overflow! - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573402595:PaHmbFqxdRhYtf7wHGWgTsWcTx+a2QV2RTxkkMJZolY=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22You%20are%20given%20a%20function%20%24%20f%20%24%20written%20in%20some%20basic%20language.%20The%20function%20accepts%20an%20integer%20value%2C%20which%20is%20immediately%20written%20into%20some%20variable%20%24%20x%20%24%20.%20%24%20x%20%24%20is%20an%20integer%20variable%20and%20can%20be%20assigned%20values%20from%20%24%200%20%24%20to%20%24%202%5E%7B32%7D-1%20%24%20.%20The%20function%20contains%20three%20types%20of%20commands%3A%5Cn%5Cn-%20for%20%24%20n%20%24%20%5Cu2014%20for%20loop%3B%5Cn-%20end%20%5Cu2014%20every%20command%20between%20%5C%22for%20%24%20n%20%24%20%5C%22%20and%20corresponding%20%5C%22end%5C%22%20is%20executed%20%24%20n%20%24%20times%3B%5Cn-%20add%20%5Cu2014%20adds%201%20to%20%24%20x%20%24%20.%5Cn%5CnAfter%20the%20execution%20of%20these%20commands%2C%20value%20of%20%24%20x%20%24%20is%20returned.%5Cn%5CnEvery%20%5C%22for%20%24%20n%20%24%20%5C%22%20is%20matched%20with%20%5C%22end%5C%22%2C%20thus%20the%20function%20is%20guaranteed%20to%20be%20valid.%20%5C%22for%20%24%20n%20%24%20%5C%22%20can%20be%20immediately%20followed%20by%20%5C%22end%5C%22.%5C%22add%5C%22%20command%20can%20be%20outside%20of%20any%20for%20loops.%5Cn%5CnNotice%20that%20%5C%22add%5C%22%20commands%20might%20overflow%20the%20value%20of%20%24%20x%20%24%20%21%20It%20means%20that%20the%20value%20of%20%24%20x%20%24%20becomes%20greater%20than%20%24%202%5E%7B32%7D-1%20%24%20after%20some%20%5C%22add%5C%22%20command.%5Cn%5CnNow%20you%20run%20%24%20f%280%29%20%24%20and%20wonder%20if%20the%20resulting%20value%20of%20%24%20x%20%24%20is%20correct%20or%20some%20overflow%20made%20it%20incorrect.%5Cn%5CnIf%20overflow%20happened%20then%20output%20%5C%22OVERFLOW%21%21%21%5C%22%2C%20otherwise%20print%20the%20resulting%20value%20of%20%24%20x%20%24%20.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20a%20single%20integer%20%24%20l%20%24%20%28%20%24%201%20%5C%5Cle%20l%20%5C%5Cle%2010%5E5%20%24%20%29%20%5Cu2014%20the%20number%20of%20lines%20in%20the%20function.%5Cn%5CnEach%20of%20the%20next%20%24%20l%20%24%20lines%20contains%20a%20single%20command%20of%20one%20of%20three%20types%3A%5Cn%5Cn-%20for%20%24%20n%20%24%20%28%20%24%201%20%5C%5Cle%20n%20%5C%5Cle%20100%20%24%20%29%20%5Cu2014%20for%20loop%3B%5Cn-%20end%20%5Cu2014%20every%20command%20between%20%5C%22for%20%24%20n%20%24%20%5C%22%20and%20corresponding%20%5C%22end%5C%22%20is%20executed%20%24%20n%20%24%20times%3B%5Cn-%20add%20%5Cu2014%20adds%201%20to%20%24%20x%20%24%20.%22%2C%22outputFormat%22%3A%22If%20overflow%20happened%20during%20execution%20of%20%24%20f%280%29%20%24%20%2C%20then%20output%20%5C%22OVERFLOW%21%21%21%5C%22%2C%20otherwise%20print%20the%20resulting%20value%20of%20%24%20x%20%24%20.%22%2C%22samples%22%3A%5B%5B%22%5Cn9%5Cnadd%5Cnfor%2043%5Cnend%5Cnfor%2010%5Cnfor%2015%5Cnadd%5Cnend%5Cnadd%5Cnend%5Cn%22%2C%22%5Cn161%5Cn%22%5D%2C%5B%22%5Cn2%5Cnfor%2062%5Cnend%5Cn%22%2C%22%5Cn0%5Cn%22%5D%2C%5B%22%5Cn11%5Cnfor%20100%5Cnfor%20100%5Cnfor%20100%5Cnfor%20100%5Cnfor%20100%5Cnadd%5Cnend%5Cnend%5Cnend%5Cnend%5Cnend%5Cn%22%2C%22%5CnOVERFLOW%21%21%21%5Cn%22%5D%5D%2C%22hint%22%3A%22In%20the%20first%20example%20the%20first%20%5C%22add%5C%22%20is%20executed%201%20time%2C%20the%20second%20%5C%22add%5C%22%20is%20executed%20150%20times%20and%20the%20last%20%5C%22add%5C%22%20is%20executed%2010%20times.%20Note%20that%20%5C%22for%20%24%20n%20%24%20%5C%22%20can%20be%20immediately%20followed%20by%20%5C%22end%5C%22%20and%20that%20%5C%22add%5C%22%20can%20be%20outside%20of%20any%20for%20loops.%5Cn%5CnIn%20the%20second%20example%20there%20are%20no%20commands%20%5C%22add%5C%22%2C%20thus%20the%20returning%20value%20is%200.%5Cn%5CnIn%20the%20third%20example%20%5C%22add%5C%22%20command%20is%20executed%20too%20many%20times%2C%20which%20causes%20%24%20x%20%24%20to%20go%20over%20%24%202%5E%7B32%7D-1%20%24%20.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F1175%5C%2FB%22%2C%22id%22%3A%221175B%22%7D%2C%22translation%22%3A%22%5Cu7ed9%5Cu4e00%5Cu4e2a%5Cu51fd%5Cu6570%20%24f%24%5Cuff0c%24f%24%20%5Cu5728%5Cu4e00%5Cu5f00%5Cu59cb%5Cu4f1a%5Cu4f20%5Cu5165%20%24x%24%20%5Cu7684%5Cu521d%5Cu59cb%5Cu503c%5Cu3002%24f%24%20%5Cu6709%5Cu4e00%5Cu4e9b%5Cu6307%5Cu4ee4%5Cuff0c%5Cu6307%5Cu4ee4%5Cu5206%5Cu4e09%5Cu79cd%5Cuff1a%5Cr%5Cn%5Cr%5Cn-%20for%20%24n%24%20-%20%5Cu5faa%5Cu73af%5Cr%5Cn%5Cr%5Cn-%20end%20-%20%5Cu6bcf%5Cu4e2a%5Cu5faa%5Cu73af%5Cu7684%5Cu7ec8%5Cu6b62%5Cu7b26%5Cu3002%5Cu6bcf%5Cu4e2a%5Cu914d%5Cu5bf9%5Cu7684%20for%20%24n%24%20%5Cu548c%20end%20%5Cu4e4b%5Cu95f4%5Cu7684%5Cu4ee3%5Cu7801%5Cu90fd%5Cu8981%5Cu88ab%5Cu8fd0%5Cu884c%20%24n%24%20%5Cu6b21%5Cu3002%5Cu4fdd%5Cu8bc1%5Cu6bcf%5Cu4e2a%20for%20%24n%24%20%5Cu6307%5Cu4ee4%5Cu90fd%5Cu80fd%5Cu4e0e%5Cu4e00%5Cu4e2a%20end%20%5Cu6307%5Cu4ee4%5Cu914d%5Cu5bf9%5Cu3002%5Cr%5Cn%5Cr%5Cn-%20add%20-%20%5Cu5c06%20%24x%24%20%5Cu589e%5Cu52a0%20%241%24%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu505a%5Cu5b8c%5Cu6240%5Cu6709%5Cu64cd%5Cu4f5c%5Cu540e%20%24x%24%20%5Cu88ab%5Cu5f53%5Cu505a%5Cu8fd4%5Cu56de%5Cu503c%5Cu8fd4%5Cu56de%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu5728%5Cu4e2d%5Cu9014%5Cu7684%5Cu8fd0%5Cu7b97%5Cu4e2d%5Cuff0c%24x%24%20%5Cu53ef%5Cu80fd%5Cu4f1a%5Cu5927%5Cu4e8e%20%242%5E%7B32%7D-1%24%5Cuff0c%5Cu6b64%5Cu65f6%5Cu4f60%5Cu8981%5Cu8f93%5Cu51fa%20%60%60OVERFLOW%21%21%21%60%60%5Cr%5Cn%5Cr%5Cn%5Cu73b0%5Cu5728%5Cu8bf7%5Cu8f93%5Cu51fa%20%24f%280%29%24%20%5Cu7684%5Cu503c%5Cu3002%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A249%2C%22totalAccepted%22%3A107%2C%22pid%22%3A%22CF1175B%22%2C%22title%22%3A%22Catch%20Overflow%21%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22CF616D%22%2C%22title%22%3A%22Longest%20k-Good%20Segment%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22P4374%22%2C%22title%22%3A%22%5BUSACO18OPEN%5DDisruption%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22CF1175E%22%2C%22title%22%3A%22Minimal%20Segment%20Cover%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1175D%22%2C%22title%22%3A%22Array%20Splitting%22%2C%22difficulty%22%3A3%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1175C%22%2C%22title%22%3A%22Electrification%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22CF%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Catch%20Overflow%21%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Catch Overflow!</h1>
<h2>题意翻译</h2>
<div>给一个函数 $f$，$f$ 在一开始会传入 $x$ 的初始值。$f$ 有一些指令，指令分三种：
- for $n$ - 循环
- end - 每个循环的终止符。每个配对的 for $n$ 和 end 之间的代码都要被运行 $n$ 次。保证每个 for $n$ 指令都能与一个 end 指令配对。
- add - 将 $x$ 增加 $1$。
做完所有操作后 $x$ 被当做返回值返回。
在中途的运算中，$x$ 可能会大于 $2^{32}-1$，此时你要输出 ``OVERFLOW!!!``
现在请输出 $f(0)$ 的值。</div>
<h2>题目描述</h2>
<div>You are given a function $ f $ written in some basic language. The function accepts an integer value, which is immediately written into some variable $ x $ . $ x $ is an integer variable and can be assigned values from $ 0 $ to $ 2^{32}-1 $ . The function contains three types of commands:
- for $ n $ — for loop;
- end — every command between "for $ n $ " and corresponding "end" is executed $ n $ times;
- add — adds 1 to $ x $ .
After the execution of these commands, value of $ x $ is returned.
Every "for $ n $ " is matched with "end", thus the function is guaranteed to be valid. "for $ n $ " can be immediately followed by "end"."add" command can be outside of any for loops.
Notice that "add" commands might overflow the value of $ x $ ! It means that the value of $ x $ becomes greater than $ 2^{32}-1 $ after some "add" command.
Now you run $ f(0) $ and wonder if the resulting value of $ x $ is correct or some overflow made it incorrect.
If overflow happened then output "OVERFLOW!!!", otherwise print the resulting value of $ x $ .</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains a single integer $ l $ ( $ 1 \le l \le 10^5 $ ) — the number of lines in the function.
Each of the next $ l $ lines contains a single command of one of three types:
- for $ n $ ( $ 1 \le n \le 100 $ ) — for loop;
- end — every command between "for $ n $ " and corresponding "end" is executed $ n $ times;
- add — adds 1 to $ x $ .</div>
<h3>输出格式</h3>
<br />
<div>If overflow happened during execution of $ f(0) $ , then output "OVERFLOW!!!", otherwise print the resulting value of $ x $ .</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>
9
add
for 43
end
for 10
for 15
add
end
add
end
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>
161
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>
2
for 62
end
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>
0
</code></pre>
<h3>输入样例 #3</h3>
<pre><code>
11
for 100
for 100
for 100
for 100
for 100
add
end
end
end
end
end
</code></pre>
<h3>输出样例 #3</h3>
<pre><code>
OVERFLOW!!!
</code></pre>
<h2>说明</h2>
<div>In the first example the first "add" is executed 1 time, the second "add" is executed 150 times and the last "add" is executed 10 times. Note that "for $ n $ " can be immediately followed by "end" and that "add" can be outside of any for loops.
In the second example there are no commands "add", thus the returning value is 0.
In the third example "add" command is executed too many times, which causes $ x $ to go over $ 2^{32}-1 $ .</div>
</article>
</div>
</div>
</body>
</html>
