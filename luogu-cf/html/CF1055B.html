<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Alice and Hairdresser - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573401022:Oco51/GM9gDpHSs69fkeQfeNhjdYac3E03laf1b/184=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Alice%27s%20hair%20is%20growing%20by%20leaps%20and%20bounds.%20Maybe%20the%20cause%20of%20it%20is%20the%20excess%20of%20vitamins%2C%20or%20maybe%20it%20is%20some%20black%20magic...%5Cn%5CnTo%20prevent%20this%2C%20Alice%20decided%20to%20go%20to%20the%20hairdresser.%20She%20wants%20for%20her%20hair%20length%20to%20be%20at%20most%20%24%20l%20%24%20centimeters%20after%20haircut%2C%20where%20%24%20l%20%24%20is%20her%20favorite%20number.%20Suppose%2C%20that%20the%20Alice%27s%20head%20is%20a%20straight%20line%20on%20which%20%24%20n%20%24%20hairlines%20grow.%20Let%27s%20number%20them%20from%20%24%201%20%24%20to%20%24%20n%20%24%20.%20With%20one%20swing%20of%20the%20scissors%20the%20hairdresser%20can%20shorten%20all%20hairlines%20on%20any%20segment%20to%20the%20length%20%24%20l%20%24%20%2C%20given%20that%20all%20hairlines%20on%20that%20segment%20had%20length%20strictly%20greater%20than%20%24%20l%20%24%20.%20The%20hairdresser%20wants%20to%20complete%20his%20job%20as%20fast%20as%20possible%2C%20so%20he%20will%20make%20the%20least%20possible%20number%20of%20swings%20of%20scissors%2C%20since%20each%20swing%20of%20scissors%20takes%20one%20second.%5Cn%5CnAlice%20hasn%27t%20decided%20yet%20when%20she%20would%20go%20to%20the%20hairdresser%2C%20so%20she%20asked%20you%20to%20calculate%20how%20much%20time%20the%20haircut%20would%20take%20depending%20on%20the%20time%20she%20would%20go%20to%20the%20hairdresser.%20In%20particular%2C%20you%20need%20to%20process%20queries%20of%20two%20types%3A%5Cn%5Cn-%20%24%200%20%24%20%5Cu2014%20Alice%20asks%20how%20much%20time%20the%20haircut%20would%20take%20if%20she%20would%20go%20to%20the%20hairdresser%20now.%5Cn-%20%24%201%20%24%20%24%20p%20%24%20%24%20d%20%24%20%5Cu2014%20%24%20p%20%24%20-th%20hairline%20grows%20by%20%24%20d%20%24%20centimeters.%5Cn%5CnNote%2C%20that%20in%20the%20request%20%24%200%20%24%20Alice%20is%20interested%20in%20hypothetical%20scenario%20of%20taking%20a%20haircut%20now%2C%20so%20no%20hairlines%20change%20their%20length.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20three%20integers%20%24%20n%20%24%20%2C%20%24%20m%20%24%20and%20%24%20l%20%24%20%28%20%24%201%20%5C%5Cle%20n%2C%20m%20%5C%5Cle%20100%5C%5C%2C000%20%24%20%2C%20%24%201%20%5C%5Cle%20l%20%5C%5Cle%2010%5E9%20%24%20%29%20%5Cu2014%20the%20number%20of%20hairlines%2C%20the%20number%20of%20requests%20and%20the%20favorite%20number%20of%20Alice.%5Cn%5CnThe%20second%20line%20contains%20%24%20n%20%24%20integers%20%24%20a_i%20%24%20%28%20%24%201%20%5C%5Cle%20a_i%20%5C%5Cle%2010%5E9%20%24%20%29%20%5Cu2014%20the%20initial%20lengths%20of%20all%20hairlines%20of%20Alice.%5Cn%5CnEach%20of%20the%20following%20%24%20m%20%24%20lines%20contains%20a%20request%20in%20the%20format%20described%20in%20the%20statement.%5Cn%5CnThe%20request%20description%20starts%20with%20an%20integer%20%24%20t_i%20%24%20.%20If%20%24%20t_i%20%3D%200%20%24%20%2C%20then%20you%20need%20to%20find%20the%20time%20the%20haircut%20would%20take.%20Otherwise%2C%20%24%20t_i%20%3D%201%20%24%20and%20in%20this%20moment%20one%20hairline%20grows.%20The%20rest%20of%20the%20line%20than%20contains%20two%20more%20integers%3A%20%24%20p_i%20%24%20and%20%24%20d_i%20%24%20%28%20%24%201%20%5C%5Cle%20p_i%20%5C%5Cle%20n%20%24%20%2C%20%24%201%20%5C%5Cle%20d_i%20%5C%5Cle%2010%5E9%20%24%20%29%20%5Cu2014%20the%20number%20of%20the%20hairline%20and%20the%20length%20it%20grows%20by.%22%2C%22outputFormat%22%3A%22For%20each%20query%20of%20type%20%24%200%20%24%20print%20the%20time%20the%20haircut%20would%20take.%22%2C%22samples%22%3A%5B%5B%224%207%203%5Cn1%202%203%204%5Cn0%5Cn1%202%203%5Cn0%5Cn1%201%203%5Cn0%5Cn1%203%201%5Cn0%5Cn%22%2C%221%5Cn2%5Cn2%5Cn1%5Cn%22%5D%5D%2C%22hint%22%3A%22Consider%20the%20first%20example%3A%5Cn%5Cn-%20Initially%20lengths%20of%20hairlines%20are%20equal%20to%20%24%201%2C%202%2C%203%2C%204%20%24%20and%20only%20%24%204%20%24%20-th%20hairline%20is%20longer%20%24%20l%3D3%20%24%20%2C%20and%20hairdresser%20can%20cut%20it%20in%20%24%201%20%24%20second.%5Cn-%20Then%20Alice%27s%20second%20hairline%20grows%2C%20the%20lengths%20of%20hairlines%20are%20now%20equal%20to%20%24%201%2C%205%2C%203%2C%204%20%24%5Cn-%20Now%20haircut%20takes%20two%20seonds%3A%20two%20swings%20are%20required%3A%20for%20the%20%24%204%20%24%20-th%20hairline%20and%20for%20the%20%24%202%20%24%20-nd.%5Cn-%20Then%20Alice%27s%20first%20hairline%20grows%2C%20the%20lengths%20of%20hairlines%20are%20now%20equal%20to%20%24%204%2C%205%2C%203%2C%204%20%24%5Cn-%20The%20haircut%20still%20takes%20two%20seconds%3A%20with%20one%20swing%20hairdresser%20can%20cut%20%24%204%20%24%20-th%20hairline%20and%20with%20one%20more%20swing%20cut%20the%20segment%20from%20%24%201%20%24%20-st%20to%20%24%202%20%24%20-nd%20hairline.%5Cn-%20Then%20Alice%27s%20third%20hairline%20grows%2C%20the%20lengths%20of%20hairlines%20are%20now%20equal%20to%20%24%204%2C%205%2C%204%2C%204%20%24%5Cn-%20Now%20haircut%20takes%20only%20one%20second%3A%20with%20one%20swing%20it%20is%20possible%20to%20cut%20the%20segment%20from%20%24%201%20%24%20-st%20hairline%20to%20the%20%24%204%20%24%20-th.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F1055%5C%2FB%22%2C%22id%22%3A%221055B%22%7D%2C%22translation%22%3A%22Alice%5Cu7684%24n%24%5Cu6839%5Cu5934%5Cu53d1%5Cu53c8%5Cu5728%5Cu75af%5Cu957f%5Cu5566%5Cuff0c%5Cu5979%5Cu51c6%5Cu5907%5Cu53bb%5Cu526a%5Cu53d1%5Cuff0c%5Cu540c%5Cu65f6%5Cu5979%5Cu5fc3%5Cu91cc%5Cu6709%5Cu4e00%5Cu4e2a%5Cu957f%5Cu5ea6%5Cu7684%5Cu6700%5Cu4f73%5Cu503c%24l%24%5Cuff0c%5Cu6bcf%5Cu6839%5Cu957f%5Cu4e8e%24l%24%5Cu7684%5Cu5934%5Cu53d1%5Cu5979%5Cu7684%5Cu7406%5Cu53d1%5Cu5e08%5Cu5c31%5Cu5f97%5Cu82b11%5Cu79d2%5Cu6325%5Cu526a%5Cu5b50%5Cu3002%5Cu540c%5Cu65f6%5Cuff0c%5Cu7406%5Cu53d1%5Cu5e08%5Cu4e5f%5Cu53ef%5Cu4ee5%5Cu82b11%5Cu79d2%5Cu526a%5Cu6389%5Cu4e00%5Cu6392%5Cu5168%5Cu90e8%5Cu4e25%5Cu683c%5Cu957f%5Cu4e8e%24l%24%5Cu7684%5Cu5934%5Cu53d1%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu73b0%5Cu5728%5Cu7ed9%5Cu51fa%24m%24%5Cu4e2a%5Cu64cd%5Cu4f5c%5Cuff0c%5Cu6709%5Cu4ee5%5Cu4e0b%5Cu65b9%5Cu5f0f%3A%5Cr%5Cn%5Cr%5Cn-%200%20%5Cu8868%5Cu793aAlice%5Cu8be2%5Cu95ee%5Cu5047%5Cu8bbe%5Cu6b64%5Cu65f6%5Cu526a%5Cu5934%5Cu6700%5Cu77ed%5Cu9700%5Cu591a%5Cu5c11%5Cu79d2%5Cr%5Cn%5Cr%5Cn-%201%20p%20d%20%5Cu7b2cp%5Cu8ddf%5Cu5934%5Cu53d1%28%5Cu4ece1%5Cu5f00%5Cu59cb%29%5Cu5c06%5Cu957f%5Cu9ad8dcm%5Cr%5Cn%5Cr%5Cn%24%20%24%5Cr%5Cn%5Cr%5Cn%5Cu7b2c%5Cu4e00%5Cu6392%5Cu7ed9%5Cu51fa%24n%2Cm%2Cl%24%5Cr%5Cn%5Cr%5Cn%5Cu4e0b%5Cu9762%5Cu4e00%5Cu6392%24n%24%5Cu4e2a%5Cu6570%5Cuff0c%24a_i%24%5Cu8868%5Cu793a%5Cu7b2ci%5Cu8ddf%5Cu5934%5Cu53d1%5Cu957f%5Cu5ea6%5Cr%5Cn%5Cr%5Cn%5Cu4e0b%5Cu9762%24m%24%5Cu6392%5Cu7ed9%5Cu51fa%5Cu64cd%5Cu4f5c%5Cu3002%5Cr%5Cn%5Cr%5Cn%24%20%24%5Cr%5Cn%5Cr%5Cn%2A%2A%5Cu6837%5Cu4f8b%5Cu89e3%5Cu91ca%2A%2A%5Cr%5Cn%5Cr%5Cn%5Cu4e00%5Cu5f00%5Cu59cb%5Cu53ea%5Cu6709%5Cu7b2c4%5Cu6839%5Cu5934%5Cu53d1%5Cu957f%5Cu4e8e3%5Cuff0c%5Cu9700%5Cu89811%5Cu79d2%5Cr%5Cn%5Cr%5Cn%5Cu7b2c%5Cu4e8c%5Cu6839%5Cu5934%5Cu53d1%5Cu957f3cm%5Cuff0c%5Cu6b64%5Cu65f6%5Cu5934%5Cu53d1%5Cu957f%5Cu5ea6%5Cu4e3a1%2C5%2C3%2C4%5Cuff0c%5Cu7406%5Cu53d1%5Cu5e08%5Cu9700%5Cu89811%5Cu79d2%5Cu526a%5Cu7b2c2%5Cu6839%5Cuff0c%5Cu4e00%5Cu79d2%5Cu526a%5Cu7b2c4%5Cu6839%5Cr%5Cn%5Cr%5Cn%5Cu7b2c%5Cu4e00%5Cu6839%5Cu5934%5Cu53d1%5Cu957f3cm%5Cuff0c%5Cu6b64%5Cu65f6%5Cu5934%5Cu53d1%5Cu957f%5Cu5ea6%5Cu4e3a4%2C5%2C3%2C4%5Cuff0c%5Cu7406%5Cu53d1%5Cu5e08%5Cu53ef%5Cu4ee5%5Cu5c06%5Cu7b2c%5Cu4e00%5Cu4e8c%5Cu6839%5Cu4e00%5Cu8d77%5Cu526a%5Cuff0c%5Cu7b2c4%5Cu6839%5Cu526a%5Cu4e00%5Cu6b21%5Cr%5Cn%5Cr%5Cn%5Cu518d%5Cu63a5%5Cu4e0b%5Cu6765%5Cu957f%5Cu5ea6%5Cu5c31%5Cu4e3a4%2C5%2C4%2C4%5Cu4e86%5Cuff0c%5Cu4e00%5Cu526a%5Cu5b50%5Cu4e0b%5Cu53bb%5Cu5b8c%5Cu4e8b%5Cu3002%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A23%2C%22totalAccepted%22%3A12%2C%22pid%22%3A%22CF1055B%22%2C%22title%22%3A%22Alice%20and%20Hairdresser%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Alice%20and%20Hairdresser%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Alice and Hairdresser</h1>
<h2>题意翻译</h2>
<div>Alice的$n$根头发又在疯长啦，她准备去剪发，同时她心里有一个长度的最佳值$l$，每根长于$l$的头发她的理发师就得花1秒挥剪子。同时，理发师也可以花1秒剪掉一排全部严格长于$l$的头发。
现在给出$m$个操作，有以下方式:
- 0 表示Alice询问假设此时剪头最短需多少秒
- 1 p d 第p跟头发(从1开始)将长高dcm
$ $
第一排给出$n,m,l$
下面一排$n$个数，$a_i$表示第i跟头发长度
下面$m$排给出操作。
$ $
**样例解释**
一开始只有第4根头发长于3，需要1秒
第二根头发长3cm，此时头发长度为1,5,3,4，理发师需要1秒剪第2根，一秒剪第4根
第一根头发长3cm，此时头发长度为4,5,3,4，理发师可以将第一二根一起剪，第4根剪一次
再接下来长度就为4,5,4,4了，一剪子下去完事。</div>
<h2>题目描述</h2>
<div>Alice's hair is growing by leaps and bounds. Maybe the cause of it is the excess of vitamins, or maybe it is some black magic...
To prevent this, Alice decided to go to the hairdresser. She wants for her hair length to be at most $ l $ centimeters after haircut, where $ l $ is her favorite number. Suppose, that the Alice's head is a straight line on which $ n $ hairlines grow. Let's number them from $ 1 $ to $ n $ . With one swing of the scissors the hairdresser can shorten all hairlines on any segment to the length $ l $ , given that all hairlines on that segment had length strictly greater than $ l $ . The hairdresser wants to complete his job as fast as possible, so he will make the least possible number of swings of scissors, since each swing of scissors takes one second.
Alice hasn't decided yet when she would go to the hairdresser, so she asked you to calculate how much time the haircut would take depending on the time she would go to the hairdresser. In particular, you need to process queries of two types:
- $ 0 $ — Alice asks how much time the haircut would take if she would go to the hairdresser now.
- $ 1 $ $ p $ $ d $ — $ p $ -th hairline grows by $ d $ centimeters.
Note, that in the request $ 0 $ Alice is interested in hypothetical scenario of taking a haircut now, so no hairlines change their length.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains three integers $ n $ , $ m $ and $ l $ ( $ 1 \le n, m \le 100\,000 $ , $ 1 \le l \le 10^9 $ ) — the number of hairlines, the number of requests and the favorite number of Alice.
The second line contains $ n $ integers $ a_i $ ( $ 1 \le a_i \le 10^9 $ ) — the initial lengths of all hairlines of Alice.
Each of the following $ m $ lines contains a request in the format described in the statement.
The request description starts with an integer $ t_i $ . If $ t_i = 0 $ , then you need to find the time the haircut would take. Otherwise, $ t_i = 1 $ and in this moment one hairline grows. The rest of the line than contains two more integers: $ p_i $ and $ d_i $ ( $ 1 \le p_i \le n $ , $ 1 \le d_i \le 10^9 $ ) — the number of the hairline and the length it grows by.</div>
<h3>输出格式</h3>
<br />
<div>For each query of type $ 0 $ print the time the haircut would take.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>4 7 3
1 2 3 4
0
1 2 3
0
1 1 3
0
1 3 1
0
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>1
2
2
1
</code></pre>
<h2>说明</h2>
<div>Consider the first example:
- Initially lengths of hairlines are equal to $ 1, 2, 3, 4 $ and only $ 4 $ -th hairline is longer $ l=3 $ , and hairdresser can cut it in $ 1 $ second.
- Then Alice's second hairline grows, the lengths of hairlines are now equal to $ 1, 5, 3, 4 $
- Now haircut takes two seonds: two swings are required: for the $ 4 $ -th hairline and for the $ 2 $ -nd.
- Then Alice's first hairline grows, the lengths of hairlines are now equal to $ 4, 5, 3, 4 $
- The haircut still takes two seconds: with one swing hairdresser can cut $ 4 $ -th hairline and with one more swing cut the segment from $ 1 $ -st to $ 2 $ -nd hairline.
- Then Alice's third hairline grows, the lengths of hairlines are now equal to $ 4, 5, 4, 4 $
- Now haircut takes only one second: with one swing it is possible to cut the segment from $ 1 $ -st hairline to the $ 4 $ -th.</div>
</article>
</div>
</div>
</body>
</html>
