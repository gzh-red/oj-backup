<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Useful Decomposition - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573400030:pkLmg9Ov4ft/2CgoaULh9RFulsE1ilFuzxAk2YaSLVE=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Ramesses%20knows%20a%20lot%20about%20problems%20involving%20trees%20%28undirected%20connected%20graphs%20without%20cycles%29%21%5Cn%5CnHe%20created%20a%20new%20useful%20tree%20decomposition%2C%20but%20he%20does%20not%20know%20how%20to%20construct%20it%2C%20so%20he%20asked%20you%20for%20help%21%5Cn%5CnThe%20decomposition%20is%20the%20splitting%20the%20edges%20of%20the%20tree%20in%20some%20simple%20paths%20in%20such%20a%20way%20that%20each%20two%20paths%20have%20at%20least%20one%20common%20vertex.%20Each%20edge%20of%20the%20tree%20should%20be%20in%20exactly%20one%20path.%5Cn%5CnHelp%20Remesses%2C%20find%20such%20a%20decomposition%20of%20the%20tree%20or%20derermine%20that%20there%20is%20no%20such%20decomposition.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20a%20single%20integer%20%24%20n%20%24%20%28%20%24%202%20%5C%5Cleq%20n%20%5C%5Cleq%2010%5E%7B5%7D%20%24%20%29%20the%20number%20of%20nodes%20in%20the%20tree.%5Cn%5CnEach%20of%20the%20next%20%24%20n%5Cu2009-%5Cu20091%20%24%20lines%20contains%20two%20integers%20%24%20a_i%20%24%20and%20%24%20b_i%20%24%20%28%20%24%201%20%5C%5Cleq%20a_i%2C%20b_i%20%5C%5Cleq%20n%20%24%20%2C%20%24%20a_i%20%5C%5Cneq%20b_i%20%24%20%29%20%5Cu2014%20the%20edges%20of%20the%20tree.%20It%20is%20guaranteed%20that%20the%20given%20edges%20form%20a%20tree.%22%2C%22outputFormat%22%3A%22If%20there%20are%20no%20decompositions%2C%20print%20the%20only%20line%20containing%20%5C%22No%5C%22.%5Cn%5CnOtherwise%20in%20the%20first%20line%20print%20%5C%22Yes%5C%22%2C%20and%20in%20the%20second%20line%20print%20the%20number%20of%20paths%20in%20the%20decomposition%20%24%20m%20%24%20.%5Cn%5CnEach%20of%20the%20next%20%24%20m%20%24%20lines%20should%20contain%20two%20integers%20%24%20u_i%20%24%20%2C%20%24%20v_i%20%24%20%28%20%24%201%20%5C%5Cleq%20u_i%2C%20v_i%20%5C%5Cleq%20n%20%24%20%2C%20%24%20u_i%20%5C%5Cneq%20v_i%20%24%20%29%20denoting%20that%20one%20of%20the%20paths%20in%20the%20decomposition%20is%20the%20simple%20path%20between%20nodes%20%24%20u_i%20%24%20and%20%24%20v_i%20%24%20.%5Cn%5CnEach%20pair%20of%20paths%20in%20the%20decomposition%20should%20have%20at%20least%20one%20common%20vertex%2C%20and%20each%20edge%20of%20the%20tree%20should%20be%20presented%20in%20exactly%20one%20path.%20You%20can%20print%20the%20paths%20and%20the%20ends%20of%20each%20path%20in%20arbitrary%20order.%5Cn%5CnIf%20there%20are%20multiple%20decompositions%2C%20print%20any.%22%2C%22samples%22%3A%5B%5B%224%5Cn1%202%5Cn2%203%5Cn3%204%5Cn%22%2C%22Yes%5Cn1%5Cn1%204%5Cn%22%5D%2C%5B%226%5Cn1%202%5Cn2%203%5Cn3%204%5Cn2%205%5Cn3%206%5Cn%22%2C%22No%5Cn%22%5D%2C%5B%225%5Cn1%202%5Cn1%203%5Cn1%204%5Cn1%205%5Cn%22%2C%22Yes%5Cn4%5Cn1%202%5Cn1%203%5Cn1%204%5Cn1%205%5Cn%22%5D%5D%2C%22hint%22%3A%22The%20tree%20from%20the%20first%20example%20is%20shown%20on%20the%20picture%20below%3A%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF981C%5C%2Fac84a1817ecb1ae8f7e08f7dfa37e5d3eca6d1b6.png%29%20The%20number%20next%20to%20each%20edge%20corresponds%20to%20the%20path%20number%20in%20the%20decomposition.%20It%20is%20easy%20to%20see%20that%20this%20decomposition%20suits%20the%20required%20conditions.%5Cn%5CnThe%20tree%20from%20the%20second%20example%20is%20shown%20on%20the%20picture%20below%3A%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF981C%5C%2F337aa5a9c085354e639d58826e5e3194b32cad26.png%29%20We%20can%20show%20that%20there%20are%20no%20valid%20decompositions%20of%20this%20tree.%5Cn%5CnThe%20tree%20from%20the%20third%20example%20is%20shown%20on%20the%20picture%20below%3A%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF981C%5C%2F0e12f8fa1f6666b81e8b3fb6bdc07e453037ae5d.png%29%20The%20number%20next%20to%20each%20edge%20corresponds%20to%20the%20path%20number%20in%20the%20decomposition.%20It%20is%20easy%20to%20see%20that%20this%20decomposition%20suits%20the%20required%20conditions.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F981%5C%2FC%22%2C%22id%22%3A%22981C%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A90%2C%22totalAccepted%22%3A48%2C%22pid%22%3A%22CF981C%22%2C%22title%22%3A%22Useful%20Decomposition%22%2C%22difficulty%22%3A3%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A47756%2C%22title%22%3A%22%5Cu7ffb%5Cu8bd1%22%2C%22forum%22%3A%7B%22id%22%3A26153%2C%22name%22%3A%22CF981C%20Useful%20Decomposition%22%2C%22slug%22%3A%22CF981C%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P3375%22%2C%22title%22%3A%22%5Cu3010%5Cu6a21%5Cu677f%5Cu3011KMP%5Cu5b57%5Cu7b26%5Cu4e32%5Cu5339%5Cu914d%22%2C%22difficulty%22%3A4%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22CF580C%22%2C%22title%22%3A%22Kefa%20and%20Park%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF981D%22%2C%22title%22%3A%22Bookshelves%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF987C%22%2C%22title%22%3A%22Three%20displays%22%2C%22difficulty%22%3A4%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF986A%22%2C%22title%22%3A%22Fair%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22CF%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Useful%20Decomposition%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Useful Decomposition</h1>
<h2>题目描述</h2>
<div>Ramesses knows a lot about problems involving trees (undirected connected graphs without cycles)!
He created a new useful tree decomposition, but he does not know how to construct it, so he asked you for help!
The decomposition is the splitting the edges of the tree in some simple paths in such a way that each two paths have at least one common vertex. Each edge of the tree should be in exactly one path.
Help Remesses, find such a decomposition of the tree or derermine that there is no such decomposition.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains a single integer $ n $ ( $ 2 \leq n \leq 10^{5} $ ) the number of nodes in the tree.
Each of the next $ n - 1 $ lines contains two integers $ a_i $ and $ b_i $ ( $ 1 \leq a_i, b_i \leq n $ , $ a_i \neq b_i $ ) — the edges of the tree. It is guaranteed that the given edges form a tree.</div>
<h3>输出格式</h3>
<br />
<div>If there are no decompositions, print the only line containing "No".
Otherwise in the first line print "Yes", and in the second line print the number of paths in the decomposition $ m $ .
Each of the next $ m $ lines should contain two integers $ u_i $ , $ v_i $ ( $ 1 \leq u_i, v_i \leq n $ , $ u_i \neq v_i $ ) denoting that one of the paths in the decomposition is the simple path between nodes $ u_i $ and $ v_i $ .
Each pair of paths in the decomposition should have at least one common vertex, and each edge of the tree should be presented in exactly one path. You can print the paths and the ends of each path in arbitrary order.
If there are multiple decompositions, print any.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>4
1 2
2 3
3 4
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>Yes
1
1 4
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>6
1 2
2 3
3 4
2 5
3 6
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>No
</code></pre>
<h3>输入样例 #3</h3>
<pre><code>5
1 2
1 3
1 4
1 5
</code></pre>
<h3>输出样例 #3</h3>
<pre><code>Yes
4
1 2
1 3
1 4
1 5
</code></pre>
<h2>说明</h2>
<div>The tree from the first example is shown on the picture below: ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF981C/ac84a1817ecb1ae8f7e08f7dfa37e5d3eca6d1b6.png) The number next to each edge corresponds to the path number in the decomposition. It is easy to see that this decomposition suits the required conditions.
The tree from the second example is shown on the picture below: ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF981C/337aa5a9c085354e639d58826e5e3194b32cad26.png) We can show that there are no valid decompositions of this tree.
The tree from the third example is shown on the picture below: ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF981C/0e12f8fa1f6666b81e8b3fb6bdc07e453037ae5d.png) The number next to each edge corresponds to the path number in the decomposition. It is easy to see that this decomposition suits the required conditions.</div>
</article>
</div>
</div>
</body>
</html>
