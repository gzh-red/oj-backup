<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Andrew and Taxi - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573401668:AT3Z19FAlQnDAe0YgXF/AxTPpKy7zvXSo5rj8D7tk/Q=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Andrew%20prefers%20taxi%20to%20other%20means%20of%20transport%2C%20but%20recently%20most%20taxi%20drivers%20have%20been%20acting%20inappropriately.%20In%20order%20to%20earn%20more%20money%2C%20taxi%20drivers%20started%20to%20drive%20in%20circles.%20Roads%20in%20Andrew%27s%20city%20are%20one-way%2C%20and%20people%20are%20not%20necessary%20able%20to%20travel%20from%20one%20part%20to%20another%2C%20but%20it%20pales%20in%20comparison%20to%20insidious%20taxi%20drivers.%5Cn%5CnThe%20mayor%20of%20the%20city%20decided%20to%20change%20the%20direction%20of%20certain%20roads%20so%20that%20the%20taxi%20drivers%20wouldn%27t%20be%20able%20to%20increase%20the%20cost%20of%20the%20trip%20endlessly.%20More%20formally%2C%20if%20the%20taxi%20driver%20is%20on%20a%20certain%20crossroads%2C%20they%20wouldn%27t%20be%20able%20to%20reach%20it%20again%20if%20he%20performs%20a%20nonzero%20trip.%5Cn%5CnTraffic%20controllers%20are%20needed%20in%20order%20to%20change%20the%20direction%20the%20road%20goes.%20For%20every%20road%20it%20is%20known%20how%20many%20traffic%20controllers%20are%20needed%20to%20change%20the%20direction%20of%20the%20road%20to%20the%20opposite%20one.%20It%20is%20allowed%20to%20change%20the%20directions%20of%20roads%20one%20by%20one%2C%20meaning%20that%20each%20traffic%20controller%20can%20participate%20in%20reversing%20two%20or%20more%20roads.%5Cn%5CnYou%20need%20to%20calculate%20the%20minimum%20number%20of%20traffic%20controllers%20that%20you%20need%20to%20hire%20to%20perform%20the%20task%20and%20the%20list%20of%20the%20roads%20that%20need%20to%20be%20reversed.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20two%20integers%20%24%20n%20%24%20and%20%24%20m%20%24%20%28%20%24%202%20%5C%5Cleq%20n%20%5C%5Cleq%20100%5C%5C%2C000%20%24%20%2C%20%24%201%20%5C%5Cleq%20m%20%5C%5Cleq%20100%5C%5C%2C000%20%24%20%29%20%5Cu2014%20the%20number%20of%20crossroads%20and%20the%20number%20of%20roads%20in%20the%20city%2C%20respectively.%5Cn%5CnEach%20of%20the%20following%20%24%20m%20%24%20lines%20contain%20three%20integers%20%24%20u_%7Bi%7D%20%24%20%2C%20%24%20v_%7Bi%7D%20%24%20and%20%24%20c_%7Bi%7D%20%24%20%28%20%24%201%20%5C%5Cleq%20u_%7Bi%7D%2C%20v_%7Bi%7D%20%5C%5Cleq%20n%20%24%20%2C%20%24%201%20%5C%5Cleq%20c_%7Bi%7D%20%5C%5Cleq%2010%5E9%20%24%20%2C%20%24%20u_%7Bi%7D%20%5C%5Cne%20v_%7Bi%7D%20%24%20%29%20%5Cu2014%20the%20crossroads%20the%20road%20starts%20at%2C%20the%20crossroads%20the%20road%20ends%20at%20and%20the%20number%20of%20traffic%20controllers%20required%20to%20reverse%20this%20road.%22%2C%22outputFormat%22%3A%22In%20the%20first%20line%20output%20two%20integers%20the%20minimal%20amount%20of%20traffic%20controllers%20required%20to%20complete%20the%20task%20and%20amount%20of%20roads%20%24%20k%20%24%20which%20should%20be%20reversed.%20%24%20k%20%24%20should%20not%20be%20minimized.%5Cn%5CnIn%20the%20next%20line%20output%20%24%20k%20%24%20integers%20separated%20by%20spaces%20%5Cu2014%20numbers%20of%20roads%2C%20the%20directions%20of%20which%20should%20be%20reversed.%20The%20roads%20are%20numerated%20from%20%24%201%20%24%20in%20the%20order%20they%20are%20written%20in%20the%20input.%20If%20there%20are%20many%20solutions%2C%20print%20any%20of%20them.%22%2C%22samples%22%3A%5B%5B%225%206%5Cn2%201%201%5Cn5%202%206%5Cn2%203%202%5Cn3%204%203%5Cn4%205%205%5Cn1%205%204%5Cn%22%2C%222%202%5Cn1%203%20%22%5D%2C%5B%225%207%5Cn2%201%205%5Cn3%202%203%5Cn1%203%203%5Cn2%204%201%5Cn4%203%205%5Cn5%204%201%5Cn1%205%203%5Cn%22%2C%223%203%5Cn3%204%207%20%22%5D%5D%2C%22hint%22%3A%22There%20are%20two%20simple%20cycles%20in%20the%20first%20example%3A%20%24%201%20%5C%5Crightarrow%205%20%5C%5Crightarrow%202%20%5C%5Crightarrow%201%20%24%20and%20%24%202%20%5C%5Crightarrow%203%20%5C%5Crightarrow%204%20%5C%5Crightarrow%205%20%5C%5Crightarrow%202%20%24%20.%20One%20traffic%20controller%20can%20only%20reverse%20the%20road%20%24%202%20%5C%5Crightarrow%201%20%24%20and%20he%20can%27t%20destroy%20the%20second%20cycle%20by%20himself.%20Two%20traffic%20controllers%20can%20reverse%20roads%20%24%202%20%5C%5Crightarrow%201%20%24%20and%20%24%202%20%5C%5Crightarrow%203%20%24%20which%20would%20satisfy%20the%20condition.%5Cn%5CnIn%20the%20second%20example%20one%20traffic%20controller%20can%27t%20destroy%20the%20cycle%20%24%20%201%20%5C%5Crightarrow%203%20%5C%5Crightarrow%202%20%5C%5Crightarrow%201%20%20%24%20.%20With%20the%20help%20of%20three%20controllers%20we%20can%2C%20for%20example%2C%20reverse%20roads%20%24%201%20%5C%5Crightarrow%203%20%24%20%2C%20%24%20%202%20%5C%5Crightarrow%204%20%24%20%2C%20%24%201%20%5C%5Crightarrow%205%20%24%20.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F1100%5C%2FE%22%2C%22id%22%3A%221100E%22%7D%2C%22translation%22%3A%22%5Cu7ed9%5Cu5b9a%5Cu4e00%5Cu4e2a%5Cu6709%5Cu5411%5Cu56fe%5Cuff0c%5Cu6539%5Cu53d8%5Cu5176%5Cu4e2d%5Cu67d0%5Cu4e9b%5Cu8fb9%5Cu7684%5Cu65b9%5Cu5411%5Cuff0c%5Cu5b83%5Cu5c06%5Cu6210%5Cu4e3a%5Cu4e00%5Cu4e2a%5Cu6709%5Cu5411%5Cu65e0%5Cu73af%5Cu56fe%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu73b0%5Cu5728%5Cu6c42%5Cu4e00%5Cu4e2a%5Cu6539%5Cu53d8%5Cu8fb9%5Cu65b9%5Cu5411%5Cu7684%5Cu65b9%5Cu6848%5Cuff0c%5Cu4f7f%5Cu5f97%5Cu6240%5Cu9009%5Cu8fb9%5Cu8fb9%5Cu6743%5Cu7684%5Cu6700%5Cu5927%5Cu503c%5Cu6700%5Cu5c0f%5Cu3002%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A256%2C%22totalAccepted%22%3A115%2C%22pid%22%3A%22CF1100E%22%2C%22title%22%3A%22Andrew%20and%20Taxi%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P1650%22%2C%22title%22%3A%22%5Cu7530%5Cu5fcc%5Cu8d5b%5Cu9a6c%22%2C%22difficulty%22%3A4%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P2495%22%2C%22title%22%3A%22%5BSDOI2011%5D%5Cu6d88%5Cu8017%5Cu6218%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22CF1100F%22%2C%22title%22%3A%22Ivan%20and%20Burgers%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1100D%22%2C%22title%22%3A%22Dasha%20and%20Chess%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1215C%22%2C%22title%22%3A%22Swap%20Letters%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Andrew%20and%20Taxi%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Andrew and Taxi</h1>
<h2>题意翻译</h2>
<div>给定一个有向图，改变其中某些边的方向，它将成为一个有向无环图。
现在求一个改变边方向的方案，使得所选边边权的最大值最小。</div>
<h2>题目描述</h2>
<div>Andrew prefers taxi to other means of transport, but recently most taxi drivers have been acting inappropriately. In order to earn more money, taxi drivers started to drive in circles. Roads in Andrew's city are one-way, and people are not necessary able to travel from one part to another, but it pales in comparison to insidious taxi drivers.
The mayor of the city decided to change the direction of certain roads so that the taxi drivers wouldn't be able to increase the cost of the trip endlessly. More formally, if the taxi driver is on a certain crossroads, they wouldn't be able to reach it again if he performs a nonzero trip.
Traffic controllers are needed in order to change the direction the road goes. For every road it is known how many traffic controllers are needed to change the direction of the road to the opposite one. It is allowed to change the directions of roads one by one, meaning that each traffic controller can participate in reversing two or more roads.
You need to calculate the minimum number of traffic controllers that you need to hire to perform the task and the list of the roads that need to be reversed.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains two integers $ n $ and $ m $ ( $ 2 \leq n \leq 100\,000 $ , $ 1 \leq m \leq 100\,000 $ ) — the number of crossroads and the number of roads in the city, respectively.
Each of the following $ m $ lines contain three integers $ u_{i} $ , $ v_{i} $ and $ c_{i} $ ( $ 1 \leq u_{i}, v_{i} \leq n $ , $ 1 \leq c_{i} \leq 10^9 $ , $ u_{i} \ne v_{i} $ ) — the crossroads the road starts at, the crossroads the road ends at and the number of traffic controllers required to reverse this road.</div>
<h3>输出格式</h3>
<br />
<div>In the first line output two integers the minimal amount of traffic controllers required to complete the task and amount of roads $ k $ which should be reversed. $ k $ should not be minimized.
In the next line output $ k $ integers separated by spaces — numbers of roads, the directions of which should be reversed. The roads are numerated from $ 1 $ in the order they are written in the input. If there are many solutions, print any of them.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>5 6
2 1 1
5 2 6
2 3 2
3 4 3
4 5 5
1 5 4
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>2 2
1 3 </code></pre>
<h3>输入样例 #2</h3>
<pre><code>5 7
2 1 5
3 2 3
1 3 3
2 4 1
4 3 5
5 4 1
1 5 3
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>3 3
3 4 7 </code></pre>
<h2>说明</h2>
<div>There are two simple cycles in the first example: $ 1 \rightarrow 5 \rightarrow 2 \rightarrow 1 $ and $ 2 \rightarrow 3 \rightarrow 4 \rightarrow 5 \rightarrow 2 $ . One traffic controller can only reverse the road $ 2 \rightarrow 1 $ and he can't destroy the second cycle by himself. Two traffic controllers can reverse roads $ 2 \rightarrow 1 $ and $ 2 \rightarrow 3 $ which would satisfy the condition.
In the second example one traffic controller can't destroy the cycle $ 1 \rightarrow 3 \rightarrow 2 \rightarrow 1 $ . With the help of three controllers we can, for example, reverse roads $ 1 \rightarrow 3 $ , $ 2 \rightarrow 4 $ , $ 1 \rightarrow 5 $ .</div>
</article>
</div>
</div>
</body>
</html>
