<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>King&#039;s Path - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573403307:UzsUPMGqCP3VIUbj64HcXyEj8y9MFpbuH5aAW34JAeg=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22There%20are%20%24%20n%20%24%20cities%20and%20%24%20n-1%20%24%20two-way%20roads%20in%20Treeland.%20Each%20road%20connects%20a%20pair%20of%20different%20cities.%20From%20any%20city%20you%20can%20drive%20to%20any%20other%2C%20moving%20only%20along%20the%20roads.%20Cities%20are%20numbered%20from%20%24%201%20%24%20to%20%24%20n%20%24%20.%20Yes%2C%20of%20course%2C%20you%20recognized%20an%20undirected%20tree%20in%20this%20description.%5Cn%5CnThere%20is%20exactly%20one%20flag%20in%20each%20city%2C%20in%20the%20%24%20i%20%24%20-th%20city%20the%20flag%20color%20is%20%24%20c_i%20%24%20.%20The%20colors%20of%20the%20flags%20in%20different%20cities%20may%20be%20the%20same.%5Cn%5CnIf%20the%20King%20travels%20along%20the%20route%20%24%20%5Bu_1%2C%20u_2%2C%20u_3%2C%20%5C%5Cdots%2C%20u_k%5D%20%24%20%2C%20then%20this%20means%20that%20he%20starts%20in%20the%20city%20%24%20u_1%20%24%20%2C%20then%20moves%20to%20the%20city%20%24%20u_2%20%24%20%28%20%24%20u_2%20%24%20is%20connected%20by%20road%20with%20%24%20u_1%20%24%20%29%2C%20then%20from%20%24%20u_2%20%24%20to%20%24%20u_3%20%24%20%28%20%24%20u_3%20%24%20is%20connected%20by%20road%20to%20%24%20u_2%20%24%20%29%2C%20and%20so%20on%20until%20he%20arrives%20in%20the%20city%20of%20%24%20u_k%20%24%20.%20It%20is%20possible%20that%20during%20this%20route%20the%20King%20will%20visit%20the%20same%20city%20more%20than%20once.%20In%20other%20words%2C%20the%20route%20%24%20%5Bu_1%2C%20u_2%2C%20u_3%2C%20%5C%5Cdots%2C%20u_k%5D%20%24%20does%20not%20necessarily%20consist%20of%20different%20cities.%20In%20terms%20of%20graph%20theory%20%5Cu2014%20the%20King%20moves%20from%20%24%20u_1%20%24%20to%20%24%20u_k%20%24%20along%20some%20path%20%24%20%5Bu_1%2C%20u_2%2C%20u_3%2C%20%5C%5Cdots%2C%20u_k%5D%20%24%20%2C%20which%20is%20not%20necessarily%20simple%20%28for%20all%20%24%20j%20%24%20from%20%24%201%20%24%20to%20%24%20k-1%20%24%20of%20the%20city%20%24%20u_j%20%24%20and%20%24%20u_%7Bj%2B1%7D%20%24%20are%20connected%20by%20road%29.%5Cn%5CnWhen%20the%20King%20moves%20from%20one%20city%20to%20another%2C%20city%20heads%20exchange%20flags%20as%20a%20sign%20of%20their%20friendship.%5Cn%5Cn%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF1211G%5C%2Fd695a88743c705b53ebb6d0c8763366c0983b769.png%29Example%20of%20moving%20the%20King%20along%20the%20route%20%24%20%5B1%2C%204%2C%202%2C%206%5D%20%24%20.%20The%20color%20of%20the%20vertex%20matches%20the%20color%20of%20the%20flag%20at%20that%20vertex.For%20aesthetic%20reasons%2C%20the%20King%20wants%20the%20flag%20color%20in%20the%20city%20%24%20i%20%24%20to%20be%20equal%20to%20%24%20d_i%20%24%20for%20all%20%24%20i%20%24%20from%20%24%201%20%24%20to%20%24%20n%20%24%20.%20Determine%20whether%20the%20King%20can%20choose%20some%20route%20and%20drive%20along%20it%20so%20that%20for%20each%20city%20the%20flag%20color%20in%20it%20turns%20out%20to%20be%20equal%20to%20the%20desired%20color%20%24%20d_i%20%24%20.%20Note%20that%20the%20King%20can%20choose%20%28and%20drive%29%20exactly%20one%20route.%20If%20yes%2C%20find%20the%20shortest%20possible%20route%20for%20the%20King.%5Cn%5CnIf%20the%20initial%20colors%20of%20the%20flags%20already%20match%20the%20King%27s%20requirements%20%28i.e.%20%24%20c_i%3Dd_i%20%24%20for%20all%20%24%20i%20%24%20%29%2C%20then%20consider%20that%20the%20King%20makes%20a%20route%20of%20length%20%24%20k%3D0%20%24%20.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20an%20integer%20%24%20t%20%24%20%28%20%24%201%20%5C%5Cle%20t%20%5C%5Cle%2010%5E5%20%24%20%29%20%5Cu2014%20the%20number%20of%20test%20cases%20to%20solve.%20The%20following%20are%20the%20cases.%5Cn%5CnEach%20case%20begins%20with%20a%20line%20containing%20an%20integer%20%24%20n%20%24%20%28%20%24%202%20%5C%5Cle%20n%20%5C%5Cle%202%5C%5Ccdot10%5E5%20%24%20%29%20%5Cu2014%20the%20number%20of%20cities%20in%20Treeland.%5Cn%5CnThe%20following%20is%20a%20line%20of%20%24%20n%20%24%20integers%20%24%20c_1%2C%20c_2%2C%20%5C%5Cdots%2C%20c_n%20%24%20%28%20%24%201%20%5C%5Cle%20c_i%20%5C%5Cle%2010%5E6%20%24%20%29%2C%20where%20%24%20c_i%20%24%20denotes%20the%20color%20of%20the%20flag%20at%20the%20%24%20i%20%24%20-th%20vertex%20before%20the%20King%27s%20journey.%5Cn%5CnThe%20following%20is%20a%20line%20of%20%24%20n%20%24%20integers%20%24%20d_1%2C%20d_2%2C%20%5C%5Cdots%2C%20d_n%20%24%20%28%20%24%201%20%5C%5Cle%20d_i%20%5C%5Cle%2010%5E6%20%24%20%29%2C%20where%20%24%20d_i%20%24%20denotes%20the%20required%20flag%20color%20at%20the%20%24%20i%20%24%20-th%20vertex%20after%20the%20completion%20of%20the%20King%27s%20journey.%5Cn%5CnFurther%2C%20in%20the%20%24%20n-1%20%24%20line%2C%20the%20Treeland%27s%20roads%20are%20listed.%20Each%20road%20is%20given%20by%20a%20line%20containing%20two%20integers%20%24%20x_j%2C%20y_j%20%24%20%28%20%24%201%20%5C%5Cle%20x_j%2C%20y_j%20%5C%5Cle%20n%20%24%20%29%20%5Cu2014%20numbers%20of%20cities%20that%20are%20connected%20by%20the%20%24%20j%20%24%20th%20road.%5Cn%5CnIt%20is%20guaranteed%20that%20from%20every%20city%20you%20can%20get%20to%20any%20other%20by%20road%20%28in%20other%20words%2C%20the%20system%20of%20cities%20and%20roads%20forms%20an%20undirected%20tree%29.%5Cn%5CnThe%20sum%20of%20all%20%24%20n%20%24%20values%20%5Cu200b%5Cu200bfor%20all%20cases%20in%20one%20test%20does%20not%20exceed%20%24%202%5C%5Ccdot10%5E5%20%24%20.%22%2C%22outputFormat%22%3A%22Print%20the%20answers%20to%20all%20cases%20in%20the%20order%20of%20their%20appearance%20in%20the%20input%20data.%5Cn%5CnEach%20answer%20must%20begin%20with%20a%20line%20containing%20%5C%22Yes%5C%22%20%28in%20the%20case%20of%20a%20positive%20answer%29%20or%20%5C%22No%5C%22%20%28in%20the%20case%20that%20the%20required%20route%20does%20not%20exist%29.%20In%20the%20case%20of%20a%20positive%20answer%2C%20the%20following%20line%20must%20contain%20an%20integer%20%24%20k%20%24%20%5Cu2014%20the%20number%20of%20cities%20in%20the%20shortest%20possible%20route%20of%20the%20King.%20The%20next%20line%20should%20contain%20the%20required%20route%20%24%20u_1%2C%20u_2%2C%20%5C%5Cdots%2C%20u_k%20%24%20%28%20%24%201%20%5C%5Cle%20u_i%20%5C%5Cle%20n%20%24%20%29.%20You%20can%20skip%20the%20line%20if%20%24%20k%3D0%20%24%20.%22%2C%22samples%22%3A%5B%5B%22%5Cn1%5Cn7%5Cn2%203%202%207%201%201%203%5Cn7%201%202%203%201%202%203%5Cn1%207%5Cn4%201%5Cn2%206%5Cn2%203%5Cn2%204%5Cn5%204%5Cn%22%2C%22%5CnYes%5Cn4%5Cn1%204%202%206%20%5Cn%22%5D%2C%5B%22%5Cn1%5Cn5%5Cn1%202%202%202%202%5Cn2%202%202%202%201%5Cn1%202%5Cn2%203%5Cn3%204%5Cn4%205%5Cn%22%2C%22%5CnYes%5Cn5%5Cn1%202%203%204%205%20%5Cn%22%5D%2C%5B%22%5Cn3%5Cn4%5Cn10%2020%2010%2020%5Cn20%2010%2020%2010%5Cn1%202%5Cn1%203%5Cn1%204%5Cn2%5Cn1000000%201000000%5Cn1000000%201000000%5Cn1%202%5Cn10%5Cn4%202%202%204%202%204%201%202%203%204%5Cn4%202%204%204%203%202%201%202%204%202%5Cn5%208%5Cn6%209%5Cn10%205%5Cn1%2010%5Cn7%2010%5Cn3%204%5Cn5%209%5Cn3%2010%5Cn2%204%5Cn%22%2C%22%5CnNo%5CnYes%5Cn0%5CnYes%5Cn5%5Cn3%2010%205%209%206%20%5Cn%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B5000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F1211%5C%2FG%22%2C%22id%22%3A%221211G%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22CF1211G%22%2C%22title%22%3A%22King%27s%20Path%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22King%27s%20Path%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>King&#039;s Path</h1>
<h2>题目描述</h2>
<div>There are $ n $ cities and $ n-1 $ two-way roads in Treeland. Each road connects a pair of different cities. From any city you can drive to any other, moving only along the roads. Cities are numbered from $ 1 $ to $ n $ . Yes, of course, you recognized an undirected tree in this description.
There is exactly one flag in each city, in the $ i $ -th city the flag color is $ c_i $ . The colors of the flags in different cities may be the same.
If the King travels along the route $ [u_1, u_2, u_3, \dots, u_k] $ , then this means that he starts in the city $ u_1 $ , then moves to the city $ u_2 $ ( $ u_2 $ is connected by road with $ u_1 $ ), then from $ u_2 $ to $ u_3 $ ( $ u_3 $ is connected by road to $ u_2 $ ), and so on until he arrives in the city of $ u_k $ . It is possible that during this route the King will visit the same city more than once. In other words, the route $ [u_1, u_2, u_3, \dots, u_k] $ does not necessarily consist of different cities. In terms of graph theory — the King moves from $ u_1 $ to $ u_k $ along some path $ [u_1, u_2, u_3, \dots, u_k] $ , which is not necessarily simple (for all $ j $ from $ 1 $ to $ k-1 $ of the city $ u_j $ and $ u_{j+1} $ are connected by road).
When the King moves from one city to another, city heads exchange flags as a sign of their friendship.
![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1211G/d695a88743c705b53ebb6d0c8763366c0983b769.png)Example of moving the King along the route $ [1, 4, 2, 6] $ . The color of the vertex matches the color of the flag at that vertex.For aesthetic reasons, the King wants the flag color in the city $ i $ to be equal to $ d_i $ for all $ i $ from $ 1 $ to $ n $ . Determine whether the King can choose some route and drive along it so that for each city the flag color in it turns out to be equal to the desired color $ d_i $ . Note that the King can choose (and drive) exactly one route. If yes, find the shortest possible route for the King.
If the initial colors of the flags already match the King's requirements (i.e. $ c_i=d_i $ for all $ i $ ), then consider that the King makes a route of length $ k=0 $ .</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains an integer $ t $ ( $ 1 \le t \le 10^5 $ ) — the number of test cases to solve. The following are the cases.
Each case begins with a line containing an integer $ n $ ( $ 2 \le n \le 2\cdot10^5 $ ) — the number of cities in Treeland.
The following is a line of $ n $ integers $ c_1, c_2, \dots, c_n $ ( $ 1 \le c_i \le 10^6 $ ), where $ c_i $ denotes the color of the flag at the $ i $ -th vertex before the King's journey.
The following is a line of $ n $ integers $ d_1, d_2, \dots, d_n $ ( $ 1 \le d_i \le 10^6 $ ), where $ d_i $ denotes the required flag color at the $ i $ -th vertex after the completion of the King's journey.
Further, in the $ n-1 $ line, the Treeland's roads are listed. Each road is given by a line containing two integers $ x_j, y_j $ ( $ 1 \le x_j, y_j \le n $ ) — numbers of cities that are connected by the $ j $ th road.
It is guaranteed that from every city you can get to any other by road (in other words, the system of cities and roads forms an undirected tree).
The sum of all $ n $ values ​​for all cases in one test does not exceed $ 2\cdot10^5 $ .</div>
<h3>输出格式</h3>
<br />
<div>Print the answers to all cases in the order of their appearance in the input data.
Each answer must begin with a line containing "Yes" (in the case of a positive answer) or "No" (in the case that the required route does not exist). In the case of a positive answer, the following line must contain an integer $ k $ — the number of cities in the shortest possible route of the King. The next line should contain the required route $ u_1, u_2, \dots, u_k $ ( $ 1 \le u_i \le n $ ). You can skip the line if $ k=0 $ .</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>
1
7
2 3 2 7 1 1 3
7 1 2 3 1 2 3
1 7
4 1
2 6
2 3
2 4
5 4
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>
Yes
4
1 4 2 6 
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>
1
5
1 2 2 2 2
2 2 2 2 1
1 2
2 3
3 4
4 5
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>
Yes
5
1 2 3 4 5 
</code></pre>
<h3>输入样例 #3</h3>
<pre><code>
3
4
10 20 10 20
20 10 20 10
1 2
1 3
1 4
2
1000000 1000000
1000000 1000000
1 2
10
4 2 2 4 2 4 1 2 3 4
4 2 4 4 3 2 1 2 4 2
5 8
6 9
10 5
1 10
7 10
3 4
5 9
3 10
2 4
</code></pre>
<h3>输出样例 #3</h3>
<pre><code>
No
Yes
0
Yes
5
3 10 5 9 6 
</code></pre>
</article>
</div>
</div>
</body>
</html>
