<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Common ancestor - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573390320:7g7HPW26288sJsQQ5OyKqCD7DvOMTDAo24LELgE+Zuo=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22The%20DNA%20sequence%20for%20every%20living%20creature%20in%20Berland%20can%20be%20represented%20as%20a%20non-empty%20line%20consisting%20of%20lowercase%20Latin%20letters.%20Berland%20scientists%20found%20out%20that%20all%20the%20creatures%20evolve%20by%20stages.%20During%20one%20stage%20exactly%20one%20symbol%20of%20the%20DNA%20line%20is%20replaced%20by%20exactly%20two%20other%20ones.%20At%20that%20overall%20there%20are%20%24%20n%20%24%20permissible%20substitutions.%20The%20substitution%20%20%24%20a_%7Bi%7D%20%24%20-%3E%20%24%20b_%7Bi%7Dc_%7Bi%7D%20%24%20%20means%20that%20any%20one%20symbol%20%24%20a_%7Bi%7D%20%24%20can%20be%20replaced%20with%20two%20symbols%20%24%20b_%7Bi%7Dc_%7Bi%7D%20%24%20.%20Every%20substitution%20could%20happen%20an%20unlimited%20number%20of%20times.%5Cn%5CnThey%20say%20that%20two%20creatures%20with%20DNA%20sequences%20%24%20s_%7B1%7D%20%24%20and%20%24%20s_%7B2%7D%20%24%20can%20have%20a%20common%20ancestor%20if%20there%20exists%20such%20a%20DNA%20sequence%20%24%20s_%7B3%7D%20%24%20that%20throughout%20evolution%20it%20can%20result%20in%20%24%20s_%7B1%7D%20%24%20and%20%24%20s_%7B2%7D%20%24%20%2C%20perhaps%20after%20a%20different%20number%20of%20stages.%20Your%20task%20is%20to%20find%20out%20by%20the%20given%20%24%20s_%7B1%7D%20%24%20and%20%24%20s_%7B2%7D%20%24%20whether%20the%20creatures%20possessing%20such%20DNA%20sequences%20can%20have%20a%20common%20ancestor.%20If%20the%20answer%20is%20positive%2C%20you%20have%20to%20find%20the%20length%20of%20the%20shortest%20sequence%20of%20the%20common%20ancestor%5Cu2019s%20DNA.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20a%20non-empty%20DNA%20sequence%20%24%20s_%7B1%7D%20%24%20%2C%20the%20second%20line%20contains%20a%20non-empty%20DNA%20sequence%20%24%20s_%7B2%7D%20%24%20.%20The%20lengths%20of%20these%20lines%20do%20not%20exceed%2050%2C%20the%20lines%20contain%20only%20lowercase%20Latin%20letters.%20The%20third%20line%20contains%20an%20integer%20%24%20n%20%24%20%28%20%24%200%3C%3Dn%3C%3D50%20%24%20%29%20%5Cu2014%20the%20number%20of%20permissible%20substitutions.%20Then%20follow%20%24%20n%20%24%20lines%20each%20of%20which%20describes%20a%20substitution%20in%20the%20format%20%20%24%20a_%7Bi%7D%20%24%20-%3E%20%24%20b_%7Bi%7Dc_%7Bi%7D%20%24%20.%20The%20characters%20%24%20a_%7Bi%7D%20%24%20%2C%20%24%20b_%7Bi%7D%20%24%20%2C%20and%20%24%20c_%7Bi%7D%20%24%20are%20lowercase%20Latin%20letters.%20Lines%20%24%20s_%7B1%7D%20%24%20and%20%24%20s_%7B2%7D%20%24%20can%20coincide%2C%20the%20list%20of%20substitutions%20can%20contain%20similar%20substitutions.%22%2C%22outputFormat%22%3A%22If%20%24%20s_%7B1%7D%20%24%20and%20%24%20s_%7B2%7D%20%24%20cannot%20have%20a%20common%20ancestor%2C%20print%20-1.%20Otherwise%20print%20the%20length%20of%20the%20shortest%20sequence%20%24%20s_%7B3%7D%20%24%20%2C%20from%20which%20%24%20s_%7B1%7D%20%24%20and%20%24%20s_%7B2%7D%20%24%20could%20have%20evolved.%22%2C%22samples%22%3A%5B%5B%22ababa%5Cnaba%5Cn2%5Cnc-%26gt%3Bba%5Cnc-%26gt%3Bcc%5Cn%22%2C%222%5Cn%22%5D%2C%5B%22ababa%5Cnaba%5Cn7%5Cnc-%26gt%3Bba%5Cnc-%26gt%3Bcc%5Cne-%26gt%3Bab%5Cnz-%26gt%3Bea%5Cnb-%26gt%3Bba%5Cnd-%26gt%3Bdd%5Cnd-%26gt%3Bab%5Cn%22%2C%221%5Cn%22%5D%2C%5B%22ababa%5Cnaba%5Cn1%5Cnc-%26gt%3Bba%5Cn%22%2C%22-1%5Cn%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B5000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F49%5C%2FE%22%2C%22id%22%3A%2249E%22%7D%2C%22translation%22%3A%22%23%23%20%5Cu9898%5Cu76ee%5Cu63cf%5Cu8ff0%5Cuff1a%5CnBerland%5Cu7684%5Cu6bcf%5Cu4e00%5Cu4e2a%5Cu751f%5Cu7269%5Cu7684DNA%5Cu5e8f%5Cu5217%5Cu53ef%5Cu4ee5%5Cu88ab%5Cu8868%5Cu793a%5Cu6210%5Cu4e00%5Cu4e2a%5Cu7531%5Cu5c0f%5Cu5199%5Cu5b57%5Cu6bcd%5Cu7ec4%5Cu6210%5Cu7684%5Cu975e%5Cu7a7a%5Cu5b57%5Cu7b26%5Cu4e32%5Cu3002Berland%5Cu7684%5Cu79d1%5Cu5b66%5Cu5bb6%5Cu4eec%5Cu53d1%5Cu73b0%5Cu6240%5Cu6709%5Cu751f%5Cu7269%5Cu90fd%5Cu662f%5Cu4e00%5Cu6b65%5Cu4e00%5Cu6b65%5Cu8fdb%5Cu5316%5Cu6765%5Cu7684%5Cu3002%5Cu5728%5Cu5176%5Cu4e2d%5Cu7684%5Cu6bcf%5Cu4e00%5Cu6b65%5Cuff0cDNA%5Cu5e8f%5Cu5217%5Cu7684%5Cu4e00%5Cu4e2a%5Cu5b57%5Cu7b26%5Cu4f1a%5Cu88ab%5Cu66ff%5Cu6362%5Cu6210%5Cu53e6%5Cu5916%5Cu7684%5Cu4e24%5Cu4e2a%5Cu3002%5Cu603b%5Cu5171%5Cu6709%24n%24%5Cu79cd%5Cu5141%5Cu8bb8%5Cu7684%5Cu53d8%5Cu5316%5Cu3002%5Cu53d8%5Cu5316%24a_i%5C%5Crightarrow%20b_ic_i%24%5Cu8868%5Cu793a%5Cu4e00%5Cu4e2a%5Cu5b57%5Cu7b26%24a_i%24%5Cu53ef%5Cu4ee5%5Cu88ab%5Cu66ff%5Cu6362%5Cu6210%5Cu4e24%5Cu4e2a%5Cu5b57%5Cu7b26%24b_ic_i%24%5Cu3002%5Cu6bcf%5Cu4e00%5Cu79cd%5Cu53d8%5Cu5316%5Cu5747%5Cu53ef%5Cu4ee5%5Cu65e0%5Cu9650%5Cu6b21%5Cu53d1%5Cu751f%5Cu3002%5Cn%5Cu79d1%5Cu5b66%5Cu5bb6%5Cu4eec%5Cu8868%5Cu793a%5Cuff0c%5Cu5982%5Cu679c%5Cu4e00%5Cu4e2aDNA%5Cu5e8f%5Cu5217%24s_3%24%5Cu5728%5Cu6574%5Cu4e2a%5Cu8fdb%5Cu5316%5Cu8fc7%5Cu7a0b%5Cu4e2d%5Cu53ef%5Cu4ee5%5Cu6700%5Cu7ec8%5Cu53d8%5Cu4e3a%24s_1%24%5Cu548c%24s_2%24%5Cuff0c%5Cu6216%5Cu8bb8%5Cu662f%5Cu7ecf%5Cu8fc7%5Cu4e86%5Cu4e0d%5Cu540c%5Cu7684%5Cu6b65%5Cu9aa4%5Cu6570%5Cuff0c%5Cu90a3%5Cu4e48DNA%5Cu5e8f%5Cu5217%5Cu5206%5Cu522b%5Cu4e3a%24s_1%24%5Cu548c%24s_2%24%5Cu7684%5Cu4e24%5Cu4e2a%5Cu751f%5Cu7269%5Cu5c31%5Cu4f1a%5Cu6709%5Cu4e00%5Cu4e2a%5Cu5171%5Cu540c%5Cu7956%5Cu5148%5Cu3002%5Cu73b0%5Cu5728%5Cu7ed9%5Cu51fa%24s_1%24%5Cu548c%24s_2%24%5Cuff0c%5Cu4f60%5Cu7684%5Cu4efb%5Cu52a1%5Cu662f%5Cu5f04%5Cu6e05%5Cu695a%5Cu5206%5Cu522b%5Cu62e5%5Cu6709%5Cu8fd9%5Cu4e24%5Cu79cdDNA%5Cu5e8f%5Cu5217%5Cu7684%5Cu751f%5Cu7269%5Cu662f%5Cu5426%5Cu6709%5Cu5171%5Cu540c%5Cu7956%5Cu5148%5Cu3002%5Cu5982%5Cu679c%5Cu5b58%5Cu5728%5Cuff0c%5Cu4f60%5Cu9700%5Cu8981%5Cu627e%5Cu51fa%5Cu6240%5Cu6709%5Cu5171%5Cu540c%5Cu7956%5Cu5148%5Cu4e2d%5Cu957f%5Cu5ea6%5Cu6700%5Cu77ed%5Cu7684DNA%5Cu5e8f%5Cu5217%5Cu3002%5Cn%5Cn%23%23%20%5Cu8f93%5Cu5165%5Cu683c%5Cu5f0f%5Cuff1a%5Cn%5Cu7b2c%5Cu4e00%5Cu3001%5Cu4e8c%5Cu884c%5Cu5206%5Cu522b%5Cu5305%5Cu542b%5Cu4e00%5Cu4e2a%5Cu975e%5Cu7a7a%5Cu5b57%5Cu7b26%5Cu4e32%5Cuff0c%5Cu5373%24s_1%24%5Cu548c%24s_2%24%5Cu3002%5Cu8fd9%5Cu4e24%5Cu4e2a%5Cu5b57%5Cu7b26%5Cu4e32%5Cu957f%5Cu5ea6%5Cu4e0d%5Cu8d85%5Cu8fc750%5Cu4e14%5Cu53ea%5Cu5305%5Cu542b%5Cu5c0f%5Cu5199%5Cu5b57%5Cu6bcd%5Cu3002%5Cu7b2c%5Cu4e09%5Cu884c%5Cu5305%5Cu542b%5Cu4e00%5Cu4e2a%5Cu6574%5Cu6570%24n%24%5Cuff0c%240%5C%5Cleq%20n%5C%5Cleq50%24%5Cuff0c%5Cu8868%5Cu793a%5Cu53d8%5Cu5316%5Cu7684%5Cu79cd%5Cu7c7b%5Cu6570%5Cu3002%5Cu968f%5Cu540e%5Cu7684%24n%24%5Cu884c%5Cuff0c%5Cu6bcf%5Cu4e00%5Cu884c%5Cu63cf%5Cu8ff0%5Cu4e86%5Cu4e00%5Cu4e2a%5Cu53d8%5Cu5316%5Cu5f62%5Cu5f0f%24a_i%5C%5Crightarrow%20b_ic_i%24%5Cu3002%24a_i%24%5Cu3001%24b_i%24%5Cu548c%24c_i%24%5Cu90fd%5Cu662f%5Cu5c0f%5Cu5199%5Cu5b57%5Cu6bcd%5Cu3002%24s_1%24%5Cu548c%24s_2%24%5Cu53ef%5Cu80fd%5Cu76f8%5Cu540c%5Cuff0c%5Cu7ed9%5Cu51fa%5Cu7684%5Cu53d8%5Cu5316%5Cu4e2d%5Cu53ef%5Cu80fd%5Cu5305%5Cu542b%5Cu6709%5Cu76f8%5Cu4f3c%5Cu7684%5Cu53d8%5Cu5316%5Cu3002%5Cn%5Cn%23%23%20%5Cu8f93%5Cu51fa%5Cu683c%5Cu5f0f%5Cuff1a%5Cn%5Cu5982%5Cu679c%24s_1%24%5Cu548c%24s_2%24%5Cu6ca1%5Cu6709%5Cu5171%5Cu540c%5Cu7956%5Cu5148%5Cuff0c%5Cu8f93%5Cu51fa-1%5Cu3002%5Cu5426%5Cu5219%5Cu8f93%5Cu51fa%5Cu6700%5Cu77ed%5Cu7684%5Cu5171%5Cu540c%5Cu7956%5Cu5148%24s_3%24%5Cu7684%5Cu5e8f%5Cu5217%5Cu957f%5Cu5ea6%5Cu3002%5Cn%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A18%2C%22totalAccepted%22%3A14%2C%22pid%22%3A%22CF49E%22%2C%22title%22%3A%22Common%20ancestor%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A52563%2C%22title%22%3A%22%5Cu9898%5Cu76ee%5Cu7ffb%5Cu8bd1%22%2C%22forum%22%3A%7B%22id%22%3A12450%2C%22name%22%3A%22CF49E%20Common%20ancestor%22%2C%22slug%22%3A%22CF49E%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Common%20ancestor%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573286098;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Common ancestor</h1>
<h2>题意翻译</h2>
<div>## 题目描述：
Berland的每一个生物的DNA序列可以被表示成一个由小写字母组成的非空字符串。Berland的科学家们发现所有生物都是一步一步进化来的。在其中的每一步，DNA序列的一个字符会被替换成另外的两个。总共有$n$种允许的变化。变化$a_i\rightarrow b_ic_i$表示一个字符$a_i$可以被替换成两个字符$b_ic_i$。每一种变化均可以无限次发生。
科学家们表示，如果一个DNA序列$s_3$在整个进化过程中可以最终变为$s_1$和$s_2$，或许是经过了不同的步骤数，那么DNA序列分别为$s_1$和$s_2$的两个生物就会有一个共同祖先。现在给出$s_1$和$s_2$，你的任务是弄清楚分别拥有这两种DNA序列的生物是否有共同祖先。如果存在，你需要找出所有共同祖先中长度最短的DNA序列。
## 输入格式：
第一、二行分别包含一个非空字符串，即$s_1$和$s_2$。这两个字符串长度不超过50且只包含小写字母。第三行包含一个整数$n$，$0\leq n\leq50$，表示变化的种类数。随后的$n$行，每一行描述了一个变化形式$a_i\rightarrow b_ic_i$。$a_i$、$b_i$和$c_i$都是小写字母。$s_1$和$s_2$可能相同，给出的变化中可能包含有相似的变化。
## 输出格式：
如果$s_1$和$s_2$没有共同祖先，输出-1。否则输出最短的共同祖先$s_3$的序列长度。
</div>
<h2>题目描述</h2>
<div>The DNA sequence for every living creature in Berland can be represented as a non-empty line consisting of lowercase Latin letters. Berland scientists found out that all the creatures evolve by stages. During one stage exactly one symbol of the DNA line is replaced by exactly two other ones. At that overall there are $ n $ permissible substitutions. The substitution $ a_{i} $ -> $ b_{i}c_{i} $ means that any one symbol $ a_{i} $ can be replaced with two symbols $ b_{i}c_{i} $ . Every substitution could happen an unlimited number of times.
They say that two creatures with DNA sequences $ s_{1} $ and $ s_{2} $ can have a common ancestor if there exists such a DNA sequence $ s_{3} $ that throughout evolution it can result in $ s_{1} $ and $ s_{2} $ , perhaps after a different number of stages. Your task is to find out by the given $ s_{1} $ and $ s_{2} $ whether the creatures possessing such DNA sequences can have a common ancestor. If the answer is positive, you have to find the length of the shortest sequence of the common ancestor’s DNA.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains a non-empty DNA sequence $ s_{1} $ , the second line contains a non-empty DNA sequence $ s_{2} $ . The lengths of these lines do not exceed 50, the lines contain only lowercase Latin letters. The third line contains an integer $ n $ ( $ 0<=n<=50 $ ) — the number of permissible substitutions. Then follow $ n $ lines each of which describes a substitution in the format $ a_{i} $ -> $ b_{i}c_{i} $ . The characters $ a_{i} $ , $ b_{i} $ , and $ c_{i} $ are lowercase Latin letters. Lines $ s_{1} $ and $ s_{2} $ can coincide, the list of substitutions can contain similar substitutions.</div>
<h3>输出格式</h3>
<br />
<div>If $ s_{1} $ and $ s_{2} $ cannot have a common ancestor, print -1. Otherwise print the length of the shortest sequence $ s_{3} $ , from which $ s_{1} $ and $ s_{2} $ could have evolved.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>ababa
aba
2
c-&amp;gt;ba
c-&amp;gt;cc
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>2
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>ababa
aba
7
c-&amp;gt;ba
c-&amp;gt;cc
e-&amp;gt;ab
z-&amp;gt;ea
b-&amp;gt;ba
d-&amp;gt;dd
d-&amp;gt;ab
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>1
</code></pre>
<h3>输入样例 #3</h3>
<pre><code>ababa
aba
1
c-&amp;gt;ba
</code></pre>
<h3>输出样例 #3</h3>
<pre><code>-1
</code></pre>
</article>
</div>
</div>
</body>
</html>
