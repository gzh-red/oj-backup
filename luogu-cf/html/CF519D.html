<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>A and B and Interesting Substrings - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573395010:aMxWoSCWxLTT23M/uiRmS+494LDFCm0tZU7unjRdCbc=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%22%2C%22description%22%3A%22A%20and%20B%20are%20preparing%20themselves%20for%20programming%20contests.%5Cn%5CnAfter%20several%20years%20of%20doing%20sports%20programming%20and%20solving%20many%20problems%20that%20require%20calculating%20all%20sorts%20of%20abstract%20objects%2C%20A%20and%20B%20also%20developed%20rather%20peculiar%20tastes.%5Cn%5CnA%20likes%20lowercase%20letters%20of%20the%20Latin%20alphabet.%20He%20has%20assigned%20to%20each%20letter%20a%20number%20that%20shows%20how%20much%20he%20likes%20that%20letter%20%28he%20has%20assigned%20negative%20numbers%20to%20the%20letters%20he%20dislikes%29.%5Cn%5CnB%20likes%20substrings.%20He%20especially%20likes%20the%20ones%20that%20start%20and%20end%20with%20the%20same%20letter%20%28their%20length%20must%20exceed%20one%29.%5Cn%5CnAlso%2C%20A%20and%20B%20have%20a%20string%20%24%20s%20%24%20.%20Now%20they%20are%20trying%20to%20find%20out%20how%20many%20substrings%20%24%20t%20%24%20of%20a%20string%20%24%20s%20%24%20are%20interesting%20to%20B%20%28that%20is%2C%20%24%20t%20%24%20starts%20and%20ends%20with%20the%20same%20letter%20and%20its%20length%20is%20larger%20than%20one%29%2C%20and%20also%20the%20sum%20of%20values%20of%20all%20letters%20%28assigned%20by%20A%29%2C%20except%20for%20the%20first%20and%20the%20last%20one%20is%20equal%20to%20zero.%5Cn%5CnNaturally%2C%20A%20and%20B%20have%20quickly%20found%20the%20number%20of%20substrings%20%24%20t%20%24%20that%20are%20interesting%20to%20them.%20Can%20you%20do%20it%3F%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20%24%2026%20%24%20integers%20%24%20x_%7Ba%7D%2Cx_%7Bb%7D%2C...%2Cx_%7Bz%7D%20%24%20%28%20%24%20-10%5E%7B5%7D%3C%3Dx_%7Bi%7D%3C%3D10%5E%7B5%7D%20%24%20%29%20%5Cu2014%20the%20value%20assigned%20to%20letters%20%24%20a%2Cb%2Cc%2C...%2Cz%20%24%20respectively.%5Cn%5CnThe%20second%20line%20contains%20string%20%24%20s%20%24%20of%20length%20between%20%24%201%20%24%20and%20%24%2010%5E%7B5%7D%20%24%20characters%2C%20consisting%20of%20Lating%20lowercase%20letters%5Cu2014%20the%20string%20for%20which%20you%20need%20to%20calculate%20the%20answer.%22%2C%22outputFormat%22%3A%22Print%20the%20answer%20to%20the%20problem.%22%2C%22samples%22%3A%5B%5B%221%201%20-1%201%201%201%201%201%201%201%201%201%201%201%201%207%201%201%201%208%201%201%201%201%201%201%5Cnxabcab%5Cn%22%2C%222%5Cn%22%5D%2C%5B%221%201%20-1%201%201%201%201%201%201%201%201%201%201%201%201%207%201%201%201%208%201%201%201%201%201%201%5Cnaaa%5Cn%22%2C%222%5Cn%22%5D%5D%2C%22hint%22%3A%22In%20the%20first%20sample%20test%20strings%20satisfying%20the%20condition%20above%20are%20%24%20abca%20%24%20and%20%24%20bcab%20%24%20.%5Cn%5CnIn%20the%20second%20sample%20test%20strings%20satisfying%20the%20condition%20above%20are%20two%20occurences%20of%20%24%20aa%20%24%20.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F519%5C%2FD%22%2C%22id%22%3A%22519D%22%7D%2C%22translation%22%3A%22%23%20A%20%5Cu4e0e%20B%20%5Cu4e0e%5Cu6709%5Cu8da3%5Cu7684%5Cu5b50%5Cu4e32%5Cn%5Cn%23%23%20%5Cu9898%5Cu76ee%5Cu5927%5Cu610f%5Cn%5Cn%5Cu7ed9%5Cu5b9a%5Cu6bcf%5Cu4e2a%5Cu5c0f%5Cu5199%5Cu5b57%5Cu6bcd%5Cu4e00%5Cu4e2a%5Cu6570%5Cu503c%5Cuff0c%5Cu7ed9%5Cu5b9a%5Cu4e00%5Cu4e2a%5Cu53ea%5Cu5305%5Cu542b%5Cu5c0f%5Cu5199%5Cu5b57%5Cu6bcd%5Cu7684%5Cu5b57%5Cu7b26%5Cu4e32%20%24s%24%5Cuff0c%5Cu6c42%20%24s%24%20%5Cu7684%5Cu5b50%5Cu4e32%20%24t%24%20%5Cu4e2a%5Cu6570%5Cuff0c%5Cu4f7f%20%24t%24%20%5Cu6ee1%5Cu8db3%5Cuff1a%5Cn%5Cn-%20%5Cu9996%5Cu4f4d%5Cu5b57%5Cu6bcd%5Cu76f8%5Cu540c%5Cuff0c%5Cu957f%5Cu5ea6%5Cu5927%5Cu4e8e%20%241%24%5Cu3002%5Cn-%20%5Cu9996%5Cu5c3e%5Cu5b57%5Cu6bcd%5Cu9664%5Cu5916%5Cu7684%5Cu5176%5Cu4f59%5Cu5b57%5Cu6bcd%5Cu7684%5Cu6570%5Cu503c%5Cu4e4b%5Cu548c%5Cu4e3a%20%240%24%5Cu3002%5Cn%5Cn%23%23%20%5Cu9898%5Cu76ee%5Cu63cf%5Cu8ff0%5Cn%5CnA%20%5Cu4e0e%20B%20%5Cu6b63%5Cu5728%5Cu4e3a%5Cu7a0b%5Cu5e8f%5Cu8bbe%5Cu8ba1%5Cu7ade%5Cu8d5b%5Cu505a%5Cu51c6%5Cu5907%5Cu3002%5Cn%5Cn%5Cu7ecf%5Cu5386%5Cu4e86%5Cu6570%5Cu5e74%5Cu7684%5Cu7f16%5Cu7a0b%5Cuff0c%5Cu505a%5Cu4e86%5Cu5f88%5Cu591a%5Cu9700%5Cu8981%5Cu5bf9%5Cu5404%5Cu79cd%5Cu53e4%5Cu602a%5Cu5bf9%5Cu8c61%5Cu8fdb%5Cu884c%5Cu8ba1%5Cu7b97%5Cu7684%5Cu9898%5Cu76ee%5Cuff0cA%20%5Cu4e0e%20B%20%5Cu4e5f%5Cu5f62%5Cu6210%5Cu4e86%5Cu72ec%5Cu7279%5Cu7684%5Cu559c%5Cu597d%5Cu3002%5Cn%5CnA%20%5Cu559c%5Cu7231%5Cu5c0f%5Cu5199%5Cu5b57%5Cu6bcd%5Cu3002%5Cu4ed6%5Cu7ed9%5Cu5b9a%5Cu6bcf%5Cu4e2a%5Cu5b57%5Cu6bcd%5Cu4e00%5Cu4e2a%5Cu6570%5Cu503c%5Cuff0c%5Cu6765%5Cu63cf%5Cu8ff0%5Cu5bf9%5Cu8fd9%5Cu4e2a%5Cu5b57%5Cu6bcd%5Cu7684%5Cu559c%5Cu7231%5Cu7a0b%5Cu5ea6%5Cu3002%5Cn%5CnB%20%5Cu559c%5Cu7231%5Cu5b50%5Cu4e32%5Cu3002%5Cu4ed6%5Cu5c24%5Cu5176%5Cu559c%5Cu7231%5Cu9996%5Cu5c3e%5Cu5b57%5Cu6bcd%5Cu76f8%5Cu540c%5Cu7684%5Cu5b50%5Cu4e32%5Cuff08%5Cu957f%5Cu5ea6%5Cu5927%5Cu4e8e%20%241%24%5Cuff09%5Cu3002%5Cn%5Cn%5Cu5e76%5Cu4e14%5Cuff0cA%20%5Cu4e0e%20B%20%5Cu6709%5Cu4e00%5Cu4e2a%5Cu5b57%5Cu7b26%5Cu4e32%20%24s%24%5Cu3002%5Cu4ed6%5Cu4eec%5Cu5c1d%5Cu8bd5%5Cu8ba1%5Cu7b97%5Cu51fa%5Cuff0c%5Cu5b57%5Cu7b26%5Cu4e32%20%24s%24%20%5Cu7684%5Cu5b50%5Cu4e32%20%24t%24%20%5Cu7684%5Cu4e2a%5Cu6570%5Cuff0c%5Cu5176%5Cu4e2d%20%24t%24%20%5Cu662f%20B%20%5Cu559c%5Cu7231%5Cu7684%5Cuff08%5Cu5373%5Cuff0c%24t%24%20%5Cu7684%5Cu9996%5Cu5c3e%5Cu5b57%5Cu6bcd%5Cu76f8%5Cu540c%5Cu4e14%5Cu957f%5Cu5ea6%5Cu5927%5Cu4e8e%241%24%5Cuff09%5Cuff0c%5Cu4e14%5Cu9996%5Cu5c3e%5Cu5b57%5Cu6bcd%5Cu9664%5Cu5916%5Cu7684%5Cu6240%5Cu6709%5Cu5b57%5Cu6bcd%5Cu7684%5Cu6570%5Cu503c%5Cuff08%5Cu7531%20A%20%5Cu7ed9%5Cu5b9a%5Cuff09%5Cu4e4b%5Cu548c%5Cu7b49%5Cu4e8e%20%240%24%5Cu3002%5Cn%5Cn%5Cu81ea%5Cu7136%5Cu5730%5Cuff0cA%20%5Cu4e0e%20B%20%5Cu5f88%5Cu5feb%5Cu8ba1%5Cu7b97%5Cu51fa%5Cu4e86%5Cu4ed6%5Cu4eec%5Cu559c%5Cu7231%5Cu7684%5Cu5b50%5Cu4e32%20%24t%24%20%5Cu7684%5Cu4e2a%5Cu6570%5Cu3002%5Cu4f60%5Cu53ef%5Cu4ee5%5Cu7b97%5Cu51fa%5Cu5417%5Cuff1f%5Cn%5Cn%23%23%20%5Cu8f93%5Cu5165%5Cu8f93%5Cu51fa%5Cu683c%5Cu5f0f%5Cn%5Cn%23%23%23%20%5Cu8f93%5Cu5165%5Cu683c%5Cu5f0f%5Cuff1a%5Cn%5Cn%5Cu7b2c%5Cu4e00%5Cu884c%5Cu5305%5Cu542b%20%2426%24%20%5Cu4e2a%5Cu6574%5Cu6570%20%24x_%7Ba%7D%2Cx_%7Bb%7D%2C%5C%5Cdots%2Cx_%7Bz%7D%28-10%5E%7B5%7D%5C%5Cle%20x_%7Bi%7D%5C%5Cle%2010%5E%7B5%7D%29%24%5Cu2014%5Cu2014%5Cu5206%5Cu522b%5Cu4ee3%5Cu8868%5Cu7ed9%5Cu5b9a%5Cu5b57%5Cu6bcd%20%24a%2Cb%2Cc%2C%5C%5Cdots%2Cz%24%5Cu7684%5Cu6570%5Cu503c%5Cu3002%5Cn%5Cn%5Cu7b2c%5Cu4e8c%5Cu884c%5Cu5305%5Cu542b%5Cu5b57%5Cu7b26%5Cu4e32%20%24s%24%5Cuff0c%5Cu5176%5Cu957f%5Cu5ea6%5Cu5728%20%241%24%20%5Cu5230%20%2410%5E%7B5%7D%24%20%5Cu4e4b%5Cu95f4%5Cuff0c%5Cu53ea%5Cu5305%5Cu542b%5Cu5c0f%5Cu5199%5Cu5b57%5Cu6bcd%5Cu2014%5Cu2014%5Cu4f60%5Cu9700%5Cu8981%5Cu8ba1%5Cu7b97%5Cu7b54%5Cu6848%5Cu7684%5Cu5b57%5Cu7b26%5Cu4e32%5Cu3002%5Cn%5Cn%23%23%23%20%5Cu8f93%5Cu51fa%5Cu683c%5Cu5f0f%5Cuff1a%5Cn%5Cn%5Cu4e00%5Cu884c%5Cuff0c%5Cu5305%5Cu542b%5Cu95ee%5Cu9898%5Cu7684%5Cu7b54%5Cu6848%5Cu3002%5Cn%5Cn%23%23%20%5Cu8bf4%5Cu660e%5Cn%5Cn%5Cu7b2c%5Cu4e00%5Cu7ec4%5Cu6837%5Cu4f8b%5Cu4e2d%5Cuff0c%5Cu6ee1%5Cu8db3%5Cu6761%5Cu4ef6%5Cu7684%5Cu5b50%5Cu4e32%5Cu6709%20%24abca%24%20%5Cu4e0e%20%24bcab%24%5Cu3002%5Cn%5Cn%5Cu7b2c%5Cu4e8c%5Cu7ec4%5Cu6837%5Cu4f8b%5Cu4e2d%5Cuff0c%5Cu6ee1%5Cu8db3%5Cu6761%5Cu4ef6%5Cu7684%5Cu5b50%5Cu4e32%5Cu662f%5Cu4e24%5Cu6b21%5Cu51fa%5Cu73b0%5Cu7684%20%24aa%24%5Cu3002%5Cn%5CnTranslated%20by%20%40Capella%20%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A64%2C%22totalAccepted%22%3A24%2C%22pid%22%3A%22CF519D%22%2C%22title%22%3A%22A%20and%20B%20and%20Interesting%20Substrings%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A35153%2C%22title%22%3A%22%5Cu63d0%5Cu4f9b%5Cu7ffb%5Cu8bd1%5Cu2014%5Cu2014A%20%5Cu4e0e%20B%20%5Cu4e0e%5Cu6709%5Cu8da3%5Cu7684%5Cu5b50%5Cu4e32%22%2C%22forum%22%3A%7B%22id%22%3A10587%2C%22name%22%3A%22CF519D%20A%20and%20B%20and%20Interesting%20Substrings%22%2C%22slug%22%3A%22CF519D%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P3384%22%2C%22title%22%3A%22%5Cu3010%5Cu6a21%5Cu677f%5Cu3011%5Cu6811%5Cu94fe%5Cu5256%5Cu5206%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22CF616D%22%2C%22title%22%3A%22Longest%20k-Good%20Segment%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF519E%22%2C%22title%22%3A%22A%20and%20B%20and%20Lecture%20Rooms%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22P4755%22%2C%22title%22%3A%22Beautiful%20Pair%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22CF1114D%22%2C%22title%22%3A%22Flood%20Fill%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22A%20and%20B%20and%20Interesting%20Substrings%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573306449;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>A and B and Interesting Substrings</h1>
<h2>题意翻译</h2>
<div># A 与 B 与有趣的子串
## 题目大意
给定每个小写字母一个数值，给定一个只包含小写字母的字符串 $s$，求 $s$ 的子串 $t$ 个数，使 $t$ 满足：
- 首位字母相同，长度大于 $1$。
- 首尾字母除外的其余字母的数值之和为 $0$。
## 题目描述
A 与 B 正在为程序设计竞赛做准备。
经历了数年的编程，做了很多需要对各种古怪对象进行计算的题目，A 与 B 也形成了独特的喜好。
A 喜爱小写字母。他给定每个字母一个数值，来描述对这个字母的喜爱程度。
B 喜爱子串。他尤其喜爱首尾字母相同的子串（长度大于 $1$）。
并且，A 与 B 有一个字符串 $s$。他们尝试计算出，字符串 $s$ 的子串 $t$ 的个数，其中 $t$ 是 B 喜爱的（即，$t$ 的首尾字母相同且长度大于$1$），且首尾字母除外的所有字母的数值（由 A 给定）之和等于 $0$。
自然地，A 与 B 很快计算出了他们喜爱的子串 $t$ 的个数。你可以算出吗？
## 输入输出格式
### 输入格式：
第一行包含 $26$ 个整数 $x_{a},x_{b},\dots,x_{z}(-10^{5}\le x_{i}\le 10^{5})$——分别代表给定字母 $a,b,c,\dots,z$的数值。
第二行包含字符串 $s$，其长度在 $1$ 到 $10^{5}$ 之间，只包含小写字母——你需要计算答案的字符串。
### 输出格式：
一行，包含问题的答案。
## 说明
第一组样例中，满足条件的子串有 $abca$ 与 $bcab$。
第二组样例中，满足条件的子串是两次出现的 $aa$。
Translated by @Capella </div>
<h2>题目描述</h2>
<div>A and B are preparing themselves for programming contests.
After several years of doing sports programming and solving many problems that require calculating all sorts of abstract objects, A and B also developed rather peculiar tastes.
A likes lowercase letters of the Latin alphabet. He has assigned to each letter a number that shows how much he likes that letter (he has assigned negative numbers to the letters he dislikes).
B likes substrings. He especially likes the ones that start and end with the same letter (their length must exceed one).
Also, A and B have a string $ s $ . Now they are trying to find out how many substrings $ t $ of a string $ s $ are interesting to B (that is, $ t $ starts and ends with the same letter and its length is larger than one), and also the sum of values of all letters (assigned by A), except for the first and the last one is equal to zero.
Naturally, A and B have quickly found the number of substrings $ t $ that are interesting to them. Can you do it?</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains $ 26 $ integers $ x_{a},x_{b},...,x_{z} $ ( $ -10^{5}<=x_{i}<=10^{5} $ ) — the value assigned to letters $ a,b,c,...,z $ respectively.
The second line contains string $ s $ of length between $ 1 $ and $ 10^{5} $ characters, consisting of Lating lowercase letters— the string for which you need to calculate the answer.</div>
<h3>输出格式</h3>
<br />
<div>Print the answer to the problem.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>1 1 -1 1 1 1 1 1 1 1 1 1 1 1 1 7 1 1 1 8 1 1 1 1 1 1
xabcab
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>2
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>1 1 -1 1 1 1 1 1 1 1 1 1 1 1 1 7 1 1 1 8 1 1 1 1 1 1
aaa
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>2
</code></pre>
<h2>说明</h2>
<div>In the first sample test strings satisfying the condition above are $ abca $ and $ bcab $ .
In the second sample test strings satisfying the condition above are two occurences of $ aa $ .</div>
</article>
</div>
</div>
</body>
</html>
