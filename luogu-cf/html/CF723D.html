<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Lakes in Berland - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573397098:sNpCr44qZF8lfKybUtlKTAFMJrylolBRfBrFE2pvaOA=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22The%20map%20of%20Berland%20is%20a%20rectangle%20of%20the%20size%20%24%20n%5Cu00d7m%20%24%20%2C%20which%20consists%20of%20cells%20of%20size%20%24%201%5Cu00d71%20%24%20.%20Each%20cell%20is%20either%20land%20or%20water.%20The%20map%20is%20surrounded%20by%20the%20ocean.%5Cn%5CnLakes%20are%20the%20maximal%20regions%20of%20water%20cells%2C%20connected%20by%20sides%2C%20which%20are%20not%20connected%20with%20the%20ocean.%20Formally%2C%20lake%20is%20a%20set%20of%20water%20cells%2C%20such%20that%20it%27s%20possible%20to%20get%20from%20any%20cell%20of%20the%20set%20to%20any%20other%20without%20leaving%20the%20set%20and%20moving%20only%20to%20cells%20adjacent%20by%20the%20side%2C%20none%20of%20them%20is%20located%20on%20the%20border%20of%20the%20rectangle%2C%20and%20it%27s%20impossible%20to%20add%20one%20more%20water%20cell%20to%20the%20set%20such%20that%20it%20will%20be%20connected%20with%20any%20other%20cell.%5Cn%5CnYou%20task%20is%20to%20fill%20up%20with%20the%20earth%20the%20minimum%20number%20of%20water%20cells%20so%20that%20there%20will%20be%20exactly%20%24%20k%20%24%20lakes%20in%20Berland.%20Note%20that%20the%20initial%20number%20of%20lakes%20on%20the%20map%20is%20not%20less%20than%20%24%20k%20%24%20.%22%2C%22inputFormat%22%3A%22The%20first%20line%20of%20the%20input%20contains%20three%20integers%20%24%20n%20%24%20%2C%20%24%20m%20%24%20and%20%24%20k%20%24%20%28%20%24%201%3C%3Dn%2Cm%3C%3D50%20%24%20%2C%20%24%200%3C%3Dk%3C%3D50%20%24%20%29%20%5Cu2014%20the%20sizes%20of%20the%20map%20and%20the%20number%20of%20lakes%20which%20should%20be%20left%20on%20the%20map.%5Cn%5CnThe%20next%20%24%20n%20%24%20lines%20contain%20%24%20m%20%24%20characters%20each%20%5Cu2014%20the%20description%20of%20the%20map.%20Each%20of%20the%20characters%20is%20either%20%27.%27%20%28it%20means%20that%20the%20corresponding%20cell%20is%20water%29%20or%20%27%5C%5C%2A%27%20%28it%20means%20that%20the%20corresponding%20cell%20is%20land%29.%5Cn%5CnIt%20is%20guaranteed%20that%20the%20map%20contain%20at%20least%20%24%20k%20%24%20lakes.%22%2C%22outputFormat%22%3A%22In%20the%20first%20line%20print%20the%20minimum%20number%20of%20cells%20which%20should%20be%20transformed%20from%20water%20to%20land.%5Cn%5CnIn%20the%20next%20%24%20n%20%24%20lines%20print%20%24%20m%20%24%20symbols%20%5Cu2014%20the%20map%20after%20the%20changes.%20The%20format%20must%20strictly%20follow%20the%20format%20of%20the%20map%20in%20the%20input%20data%20%28there%20is%20no%20need%20to%20print%20the%20size%20of%20the%20map%29.%20If%20there%20are%20several%20answers%2C%20print%20any%20of%20them.%5Cn%5CnIt%20is%20guaranteed%20that%20the%20answer%20exists%20on%20the%20given%20data.%22%2C%22samples%22%3A%5B%5B%225%204%201%5Cn%2A%2A%2A%2A%5Cn%2A..%2A%5Cn%2A%2A%2A%2A%5Cn%2A%2A.%2A%5Cn..%2A%2A%5Cn%22%2C%221%5Cn%2A%2A%2A%2A%5Cn%2A..%2A%5Cn%2A%2A%2A%2A%5Cn%2A%2A%2A%2A%5Cn..%2A%2A%5Cn%22%5D%2C%5B%223%203%200%5Cn%2A%2A%2A%5Cn%2A.%2A%5Cn%2A%2A%2A%5Cn%22%2C%221%5Cn%2A%2A%2A%5Cn%2A%2A%2A%5Cn%2A%2A%2A%5Cn%22%5D%5D%2C%22hint%22%3A%22In%20the%20first%20example%20there%20are%20only%20two%20lakes%20%5Cu2014%20the%20first%20consists%20of%20the%20cells%20%24%20%282%2C2%29%20%24%20and%20%24%20%282%2C3%29%20%24%20%2C%20the%20second%20consists%20of%20the%20cell%20%24%20%284%2C3%29%20%24%20.%20It%20is%20profitable%20to%20cover%20the%20second%20lake%20because%20it%20is%20smaller.%20Pay%20attention%20that%20the%20area%20of%20water%20in%20the%20lower%20left%20corner%20is%20not%20a%20lake%20because%20this%20area%20share%20a%20border%20with%20the%20ocean.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F723%5C%2FD%22%2C%22id%22%3A%22723D%22%7D%2C%22translation%22%3A%22%2A%2A%5Cu3010%5Cu95ee%5Cu9898%5Cu63cf%5Cu8ff0%5Cu3011%2A%2A%20ldxxx%5Cu5df2%5Cu7ecf%5Cu586b%5Cu5b8c%5Cu4e86%5Cu6240%5Cu6709%5Cu7684%5Cu5751%5Cuff0c%5Cu73b0%5Cu5728%5Cu4ed6%5Cu8981%5Cu7ed9%5Cu571f%5Cu5730%5Cu6d47%5Cu6c34%5Cu6765%5Cu4fdd%5Cu8bc1%5Cu5e7c%5Cu82d7%5Cu7684%5Cu8301%5Cu58ee%5Cu6210%5Cu957f%5Cu3002%5Cu7136%5Cu800c%5Cu4ed6%5Cu521a%5Cu8981%5Cu6d47%5Cu6c34%5Cuff0c%5Cu5c31%5Cu8fce%5Cu6765%5Cu4e86%5Cu74e2%5Cu6cfc%5Cu5927%5Cu96e8%5Cuff0c%5Cu7531%5Cu4e8e%5Cu571f%5Cu5730%5Cu6e17%5Cu900f%5Cu6027%5Cu4e0d%5Cu4e00%5Cuff0c%5Cu6240%5Cu4ee5%5Cu6709%5Cu7684%5Cu571f%5Cu5730%5Cu4e0a%5Cu5b58%5Cu5728%5Cu79ef%5Cu6c34%5Cuff0c%5Cu8fde%5Cu5728%5Cu4e00%5Cu8d77%5Cu7684%5Cu79ef%5Cu6c34%5Cu5c31%5Cu5f62%5Cu6210%5Cu4e86%5Cu4e00%5Cu4e2a%5Cu5c0f%5Cu6e56%5Cu6cca%5Cuff08%5Cu53ea%5Cu6709%5Cu56db%5Cu5468%5Cu88ab%5Cu9646%5Cu5730%5Cu5b8c%5Cu5168%5Cu5305%5Cu56f4%5Cu7684%5Cu624d%5Cu7b97%5Cu6e56%5Cu6cca%5Cuff0c%5Cu53ea%5Cu8981%5Cu548c%5Cu8fb9%5Cu754c%5Cu6709%5Cu4ea4%5Cu70b9%5Cu5c31%5Cu4e0d%5Cu7b97%5Cu6e56%5Cu6cca%5Cuff09%5Cuff0c%5Cu8fd9%5Cu65f6cs%5Cu544a%5Cu8bc9ldxxx%5Cu8bf4%5Cu5982%5Cu679c%5Cu80fd%5Cu5c06%5Cu6e56%5Cu6cca%5Cu7684%5Cu6570%5Cu91cf%5Cu7f29%5Cu5c0f%5Cu5230%5Cu4e00%5Cu4e2a%5Cu503ck%5Cu7684%5Cu8bdd%5Cuff0c%5Cu4ed6%5Cu7684%5Cu5e84%5Cu7a3c%5Cu957f%5Cu5f97%5Cu5e94%5Cu8be5%5Cu6700%5Cu8302%5Cu76db%5Cu3002%5Cu4f46%5Cu662f%5Cu7531%5Cu4e8eldxxx%5Cu5f88%5Cu7b28%5Cuff0c%5Cu4e0d%5Cu77e5%5Cu9053%5Cu8be5%5Cu600e%5Cu4e48%5Cu586b%5Cuff0c%5Cu6240%5Cu4ee5ldxxx%5Cu628a%5Cu6d47%5Cu6c34%5Cu7684%5Cu4efb%5Cu52a1%5Cu7ed9%5Cu4e86cs%5Cuff0c%5Cu7531%5Cu4e8e%5Cu8fd9%5Cu6b21%5Cu662f%5Cu4e49%5Cu52a1%5Cu52b3%5Cu52a8%5Cuff0c%5Cu6240%5Cu4ee5cs%5Cu5f88%5Cu61d2%5Cuff0c%5Cu60f3%5Cu586b%5Cu6700%5Cu5c11%5Cu7684%5Cu6c34%5Cu4f7f%5Cu5f97%5Cu6e56%5Cu6cca%5Cu6570%5Cu91cf%5Cu4e3ak%5Cu4f60%5Cu9700%5Cu8981%5Cu544a%5Cu8bc9%5Cu4ed6%5Cu628a%5Cu6e56%5Cu6cca%5Cu6570%5Cu964d%5Cu5230%2A%2A%5Cu4e0d%5Cu5927%5Cu4e8ek%2A%2A%5Cu81f3%5Cu5c11%5Cu9700%5Cu8981%5Cu586b%5Cu591a%5Cu5c11%5Cu5757%5Cuff0c%5Cu5e76%5Cu4e14%5Cu628a%5Cu586b%5Cu597d%5Cu540e%5Cu7684%5Cu571f%5Cu5730%5Cu79ef%5Cu6c34%5Cu60c5%5Cu51b5%5Cu7ed9%5Cu4ed6%5Cu6253%5Cu5370%5Cu51fa%5Cu6765%5Cu3002%20%5Cu6ce8%5Cu610f%5Cuff1a%5Cu53ea%5Cu6709%5Cu56db%5Cu5468%5Cu88ab%5Cu9646%5Cu5730%5Cu5b8c%5Cu5168%5Cu5305%5Cu56f4%5Cu7684%5Cu624d%5Cu7b97%5Cu6e56%5Cu6cca%5Cuff0c%5Cu53ea%5Cu8981%5Cu548c%5Cu8fb9%5Cu754c%5Cu6709%5Cu4ea4%5Cu70b9%5Cu5c31%5Cu4e0d%5Cu7b97%5Cu6e56%5Cu6cca%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu9898%5Cu9762%5Cu7ffb%5Cu8bd1%5Cu6765%5Cu81eaaccoders%5Cr%5Cn%5Cr%5Cn%2A%2A%5Cu3010%5Cu8f93%5Cu5165%5Cu683c%5Cu5f0f%5Cu3011%2A%2A%20%5Cu7b2c%5Cu4e00%5Cu884c%5Cu4e09%5Cu4e2a%5Cu7528%5Cu7a7a%5Cu683c%5Cu5206%5Cu79bb%5Cu7684%5Cu6b63%5Cu6574%5Cu6570%20n%5Cuff0cm%5Cu548ck%5Cuff0c%5Cu4ee3%5Cu8868%5Cu571f%5Cu5730%5Cu7684%5Cu957f%5Cu548c%5Cu5bbd%5Cu3002%20%5Cu63a5%5Cu4e0b%5Cu6765%20n%20%5Cu884c%5Cuff0c%5Cu6bcf%5Cu884cm%5Cu4e2a%5Cu5b57%5Cu7b26%5Cuff0c%2A%27%27%5Cu4ee3%5Cu8868%5Cu9646%5Cu5730%5Cuff0c%27.%27%5Cu4ee3%5Cu8868%5Cu6c34%5Cu3002%5Cu6570%5Cu636e%5Cu4fdd%5Cu8bc1%5Cu81f3%5Cu5c11%5Cu542b%5Cu6709k%5Cu4e2a%5Cu6e56%5Cu3002%5Cr%5Cn%5Cr%5Cn%2A%2A%5Cu3010%5Cu8f93%5Cu51fa%5Cu683c%5Cu5f0f%5Cu3011%2A%2A%20%5Cu8f93%5Cu51fa%5Cu5171n%2B1%5Cu884c%5Cu3002%20%5Cu7b2c%5Cu4e00%5Cu884c%5Cu4e00%5Cu4e2a%5Cu6b63%5Cu6574%5Cu6570%5Cuff0c%5Cu8868%5Cu793a%5Cu628a%5Cu6e56%5Cu6cca%5Cu6570%5Cu964d%5Cu5230k%5Cu4ee5%5Cu4e0b%5Cu81f3%5Cu5c11%5Cu9700%5Cu8981%5Cu586b%5Cu591a%5Cu5c11%5Cu5757%5Cu3002%20%5Cu63a5%5Cu4e0b%5Cu6765n%5Cu884c%5Cu6bcf%5Cu884cm%5Cu4e2a%5Cu5b57%5Cu7b26%5Cuff0c%2A%2A%27%27%5Cu4ee3%5Cu8868%5Cu9646%5Cu5730%5Cuff0c%27.%27%5Cu4ee3%5Cu8868%5Cu6c34%2A%2A%5Cu3002%20%5Cu6ce8%5Cuff1a%5Cu8f93%5Cu5165%5Cu548c%5Cu8f93%5Cu51fa%20%5Cu6bcf%5Cu884c%5Cu7684%5Cu5b57%5Cu7b26%5Cu4e4b%5Cu95f4%5Cu4e0d%5Cu542b%5Cu7a7a%5Cu683c%5Cu3002%20%5Cr%5Cn%5Cr%5Cn%2A%2A%5Cu3010%5Cu6570%5Cu636e%5Cu8303%5Cu56f4%5Cu3011%2A%2A%20%5Cr%5Cn%5Cr%5Cn%2A%2A1%3C%3Dn%2Cm%3C%3D50%20%20%20%200%3C%3Dk%3C%3D50%2A%2A%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A38%2C%22totalAccepted%22%3A13%2C%22pid%22%3A%22CF723D%22%2C%22title%22%3A%22Lakes%20in%20Berland%22%2C%22difficulty%22%3A4%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Lakes%20in%20Berland%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573306449;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Lakes in Berland</h1>
<h2>题意翻译</h2>
<div>**【问题描述】** ldxxx已经填完了所有的坑，现在他要给土地浇水来保证幼苗的茁壮成长。然而他刚要浇水，就迎来了瓢泼大雨，由于土地渗透性不一，所以有的土地上存在积水，连在一起的积水就形成了一个小湖泊（只有四周被陆地完全包围的才算湖泊，只要和边界有交点就不算湖泊），这时cs告诉ldxxx说如果能将湖泊的数量缩小到一个值k的话，他的庄稼长得应该最茂盛。但是由于ldxxx很笨，不知道该怎么填，所以ldxxx把浇水的任务给了cs，由于这次是义务劳动，所以cs很懒，想填最少的水使得湖泊数量为k你需要告诉他把湖泊数降到**不大于k**至少需要填多少块，并且把填好后的土地积水情况给他打印出来。 注意：只有四周被陆地完全包围的才算湖泊，只要和边界有交点就不算湖泊。
题面翻译来自accoders
**【输入格式】** 第一行三个用空格分离的正整数 n，m和k，代表土地的长和宽。 接下来 n 行，每行m个字符，*''代表陆地，'.'代表水。数据保证至少含有k个湖。
**【输出格式】** 输出共n+1行。 第一行一个正整数，表示把湖泊数降到k以下至少需要填多少块。 接下来n行每行m个字符，**''代表陆地，'.'代表水**。 注：输入和输出 每行的字符之间不含空格。
**【数据范围】**
**1<=n,m<=50 0<=k<=50**</div>
<h2>题目描述</h2>
<div>The map of Berland is a rectangle of the size $ n×m $ , which consists of cells of size $ 1×1 $ . Each cell is either land or water. The map is surrounded by the ocean.
Lakes are the maximal regions of water cells, connected by sides, which are not connected with the ocean. Formally, lake is a set of water cells, such that it's possible to get from any cell of the set to any other without leaving the set and moving only to cells adjacent by the side, none of them is located on the border of the rectangle, and it's impossible to add one more water cell to the set such that it will be connected with any other cell.
You task is to fill up with the earth the minimum number of water cells so that there will be exactly $ k $ lakes in Berland. Note that the initial number of lakes on the map is not less than $ k $ .</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line of the input contains three integers $ n $ , $ m $ and $ k $ ( $ 1<=n,m<=50 $ , $ 0<=k<=50 $ ) — the sizes of the map and the number of lakes which should be left on the map.
The next $ n $ lines contain $ m $ characters each — the description of the map. Each of the characters is either '.' (it means that the corresponding cell is water) or '\*' (it means that the corresponding cell is land).
It is guaranteed that the map contain at least $ k $ lakes.</div>
<h3>输出格式</h3>
<br />
<div>In the first line print the minimum number of cells which should be transformed from water to land.
In the next $ n $ lines print $ m $ symbols — the map after the changes. The format must strictly follow the format of the map in the input data (there is no need to print the size of the map). If there are several answers, print any of them.
It is guaranteed that the answer exists on the given data.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>5 4 1
****
*..*
****
**.*
..**
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>1
****
*..*
****
****
..**
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>3 3 0
***
*.*
***
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>1
***
***
***
</code></pre>
<h2>说明</h2>
<div>In the first example there are only two lakes — the first consists of the cells $ (2,2) $ and $ (2,3) $ , the second consists of the cell $ (4,3) $ . It is profitable to cover the second lake because it is smaller. Pay attention that the area of water in the lower left corner is not a lake because this area share a border with the ocean.</div>
</article>
</div>
</div>
</body>
</html>
