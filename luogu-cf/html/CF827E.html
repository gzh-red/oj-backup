<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Rusty String - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573398355:0mJTQzDTQFAe1nzUqd3g2W6XyOeOsKxM+t40EL9UZyc=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Grigory%20loves%20strings.%20Recently%20he%20found%20a%20metal%20strip%20on%20a%20loft.%20The%20strip%20had%20length%20%24%20n%20%24%20and%20consisted%20of%20letters%20%5C%22V%5C%22%20and%20%5C%22K%5C%22.%20Unfortunately%2C%20rust%20has%20eaten%20some%20of%20the%20letters%20so%20that%20it%27s%20now%20impossible%20to%20understand%20which%20letter%20was%20written.%5Cn%5CnGrigory%20couldn%27t%20understand%20for%20a%20long%20time%20what%20these%20letters%20remind%20him%20of%2C%20so%20he%20became%20interested%20in%20the%20following%20question%3A%20if%20we%20put%20a%20letter%20%5C%22V%5C%22%20or%20%5C%22K%5C%22%20on%20each%20unreadable%20position%2C%20which%20values%20can%20the%20period%20of%20the%20resulting%20string%20be%20equal%20to%3F%5Cn%5CnA%20period%20of%20a%20string%20is%20such%20an%20integer%20%24%20d%20%24%20from%20%24%201%20%24%20to%20the%20length%20of%20the%20string%20that%20if%20we%20put%20the%20string%20shifted%20by%20%24%20d%20%24%20positions%20to%20the%20right%20on%20itself%2C%20then%20all%20overlapping%20letters%20coincide.%20For%20example%2C%20%24%203%20%24%20and%20%24%205%20%24%20are%20periods%20of%20%5C%22VKKVK%5C%22.%22%2C%22inputFormat%22%3A%22There%20are%20several%20%28at%20least%20one%29%20test%20cases%20in%20the%20input.%20The%20first%20line%20contains%20single%20integer%20%5Cu2014%20the%20number%20of%20test%20cases.%5Cn%5CnThere%20is%20an%20empty%20line%20before%20each%20test%20case.%20Each%20test%20case%20is%20described%20in%20two%20lines%3A%20the%20first%20line%20contains%20single%20integer%20%24%20n%20%24%20%28%20%24%201%3C%3Dn%3C%3D5%5Cu00b710%5E%7B5%7D%20%24%20%29%20%5Cu2014%20the%20length%20of%20the%20string%2C%20the%20second%20line%20contains%20the%20string%20of%20length%20%24%20n%20%24%20%2C%20consisting%20of%20letters%20%5C%22V%5C%22%2C%20%5C%22K%5C%22%20and%20characters%20%5C%22%3F%5C%22.%20The%20latter%20means%20the%20letter%20on%20its%20position%20is%20unreadable.%5Cn%5CnIt%20is%20guaranteed%20that%20the%20sum%20of%20lengths%20among%20all%20test%20cases%20doesn%27t%20exceed%20%24%205%5Cu00b710%5E%7B5%7D%20%24%20.%5Cn%5CnFor%20hacks%20you%20can%20only%20use%20tests%20with%20one%20test%20case.%22%2C%22outputFormat%22%3A%22For%20each%20test%20case%20print%20two%20lines.%20In%20the%20first%20line%20print%20the%20number%20of%20possible%20periods%20after%20we%20replace%20each%20unreadable%20letter%20with%20%5C%22V%5C%22%20or%20%5C%22K%5C%22.%20In%20the%20next%20line%20print%20all%20these%20values%20in%20increasing%20order.%22%2C%22samples%22%3A%5B%5B%223%5Cn%5Cu00a0%5Cn5%5CnV%3F%3FVK%5Cn%5Cu00a0%5Cn6%5Cn%3F%3F%3F%3F%3F%3F%5Cn%5Cu00a0%5Cn4%5Cn%3FVK%3F%5Cn%22%2C%222%5Cn3%205%5Cn6%5Cn1%202%203%204%205%206%5Cn3%5Cn2%203%204%5Cn%22%5D%5D%2C%22hint%22%3A%22In%20the%20first%20test%20case%20from%20example%20we%20can%20obtain%2C%20for%20example%2C%20%5C%22VKKVK%5C%22%2C%20which%20has%20periods%20%24%203%20%24%20and%20%24%205%20%24%20.%5Cn%5CnIn%20the%20second%20test%20case%20we%20can%20obtain%20%5C%22VVVVVV%5C%22%20which%20has%20all%20periods%20from%20%24%201%20%24%20to%20%24%206%20%24%20.%5Cn%5CnIn%20the%20third%20test%20case%20string%20%5C%22KVKV%5C%22%20has%20periods%20%24%202%20%24%20and%20%24%204%20%24%20%2C%20and%20string%20%5C%22KVKK%5C%22%20has%20periods%20%24%203%20%24%20and%20%24%204%20%24%20.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B3000%5D%2C%22memory%22%3A%5B512000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F827%5C%2FE%22%2C%22id%22%3A%22827E%22%7D%2C%22translation%22%3A%22%5Cu9898%5Cu610f%5Cr%5Cn%5Cr%5Cn%5Cu591a%5Cu7ec4%5Cu6570%5Cu636e%5Cuff0c%5Cu6bcf%5Cu6b21%5Cu7ed9%5Cu4e00%5Cu4e2a%5Cu7531%20%27V%27%5Cuff0c%27K%27%5Cuff0c%27%3F%27%20%5Cu4e09%5Cu79cd%5Cu5b57%5Cu7b26%5Cu6784%5Cu6210%5Cu7684%5Cu5b57%5Cu7b26%5Cu4e32%5Cuff0c%5Cu4f60%5Cu9700%5Cu8981%5Cu628a%5Cu6240%5Cu6709%5Cu4e3a%20%27%3F%27%20%5Cu7684%5Cu4f4d%5Cu7f6e%5Cu586b%5Cu6210%20%27V%27%20%5Cu6216%5Cu8005%20%27K%27%20%5Cuff0c%5Cu4f60%5Cu8981%5Cu6c42%5Cu51fa%5Cu6240%5Cu6709%5Cu6700%5Cu7ec8%5Cu6784%5Cu9020%5Cu51fa%5Cu6765%5Cu7684%5Cu5b57%5Cu7b26%5Cu4e32%5Cu91cc%5Cu6240%5Cu6709%5Cu53ef%5Cu884c%5Cu7684%5Cu5468%5Cu671f%5Cuff0c%5Cu6211%5Cu4eec%5Cu79f0%24i%24%5Cu4e3a%5Cu5b57%5Cu7b26%5Cu4e32%24S%24%5Cu7684%5Cu5468%5Cu671f%5Cu5f53%5Cu4e14%5Cu4ec5%5Cu5f53%24S%24%5Cu5411%5Cu53f3%5Cu5e73%5Cu79fb%24i%24%5Cu4f4d%5Cu4e4b%5Cu540e%5Cu548c%5Cu539f%5Cu4e32%5Cu91cd%5Cu53e0%5Cu7684%5Cu90e8%5Cu5206%5Cu5b8c%5Cu5168%5Cu4e00%5Cu6837%5Cuff0c%5Cu4f8b%5Cu5982%20%5C%22VKKVK%5C%22%20%5Cuff0c%5Cu5f53%24i%3D3%24%5Cu65f6%5Cuff1a%5Cr%5Cn%5Cr%5Cn%60%60%60cpp%5Cr%5CnVKKVK%5Cr%5Cn%20%20%20VKKVK%5Cr%5Cn%60%60%60%5Cr%5Cn%5Cu5b83%5Cu4eec%5Cu91cd%5Cu53e0%5Cu7684%5Cu90e8%5Cu5206%5Cu90fd%5Cu662f%20%5C%22VK%5C%22%20%5Cuff0c%5Cu6240%5Cu4ee53%5Cu662f%5Cu4e00%5Cu4e2a%5Cu5468%5Cu671f%5Cuff0c%5Cu540c%5Cu74065%5Cu4e5f%5Cu662f%5Cu4e00%5Cu4e2a%5Cu5468%5Cu671f%5Cuff08%5Cu91cd%5Cu53e0%5Cu90e8%5Cu5206%5Cu4e3a%5Cu7a7a%5Cu4e5f%5Cu53ef%5Cu4ee5%5Cuff09%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu8f93%5Cu51fa%5Cu7b54%5Cu6848%5Cu65f6%5Cuff0c%5Cu8981%5Cu5148%5Cu8f93%5Cu51fa%5Cu4e00%5Cu884c%5Cu4e00%5Cu4e2a%5Cu6570%5Cu4e3a%5Cu4f60%5Cu6c42%5Cu5f97%5Cu7684%5Cu6240%5Cu6709%5Cu53ef%5Cu884c%5Cu5468%5Cu671f%5Cu7684%5Cu4e2a%5Cu6570%5Cuff0c%5Cu63a5%5Cu4e0b%5Cu6765%5Cu4e00%5Cu884c%5Cu6309%5Cu7167%2A%2A%5Cu5347%5Cu5e8f%2A%2A%5Cu8f93%5Cu51fa%5Cu6240%5Cu6709%5Cu7684%5Cu53ef%5Cu884c%5Cu5468%5Cu671f%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu4fdd%5Cu8bc1%5Cu8f93%5Cu5165%5Cu5b57%5Cu7b26%5Cu4e32%5Cu603b%5Cu957f%5Cu4e0d%5Cu8d85%5Cu8fc7%245%2A10%5E5%24%5Cu3002%22%2C%22tags%22%3A%5B2%2C111%2C318%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A30%2C%22totalAccepted%22%3A18%2C%22pid%22%3A%22CF827E%22%2C%22title%22%3A%22Rusty%20String%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A101871%2C%22title%22%3A%22%5Cu6211%5Cu9760%5Cu7b2c%5Cu56db%5Cu4e94%5Cu4e2a%5Cu70b9500000%5Cu7ec4%5Cuff0c%5Cu6bcf%5Cu7ec4n%3D1%22%2C%22forum%22%3A%7B%22id%22%3A9277%2C%22name%22%3A%22CF827E%20Rusty%20String%22%2C%22slug%22%3A%22CF827E%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Rusty%20String%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Rusty String</h1>
<h2>题意翻译</h2>
<div>题意
多组数据，每次给一个由 'V'，'K'，'?' 三种字符构成的字符串，你需要把所有为 '?' 的位置填成 'V' 或者 'K' ，你要求出所有最终构造出来的字符串里所有可行的周期，我们称$i$为字符串$S$的周期当且仅当$S$向右平移$i$位之后和原串重叠的部分完全一样，例如 "VKKVK" ，当$i=3$时：
```cpp
VKKVK
VKKVK
```
它们重叠的部分都是 "VK" ，所以3是一个周期，同理5也是一个周期（重叠部分为空也可以）。
输出答案时，要先输出一行一个数为你求得的所有可行周期的个数，接下来一行按照**升序**输出所有的可行周期。
保证输入字符串总长不超过$5*10^5$。</div>
<h2>题目描述</h2>
<div>Grigory loves strings. Recently he found a metal strip on a loft. The strip had length $ n $ and consisted of letters "V" and "K". Unfortunately, rust has eaten some of the letters so that it's now impossible to understand which letter was written.
Grigory couldn't understand for a long time what these letters remind him of, so he became interested in the following question: if we put a letter "V" or "K" on each unreadable position, which values can the period of the resulting string be equal to?
A period of a string is such an integer $ d $ from $ 1 $ to the length of the string that if we put the string shifted by $ d $ positions to the right on itself, then all overlapping letters coincide. For example, $ 3 $ and $ 5 $ are periods of "VKKVK".</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>There are several (at least one) test cases in the input. The first line contains single integer — the number of test cases.
There is an empty line before each test case. Each test case is described in two lines: the first line contains single integer $ n $ ( $ 1<=n<=5·10^{5} $ ) — the length of the string, the second line contains the string of length $ n $ , consisting of letters "V", "K" and characters "?". The latter means the letter on its position is unreadable.
It is guaranteed that the sum of lengths among all test cases doesn't exceed $ 5·10^{5} $ .
For hacks you can only use tests with one test case.</div>
<h3>输出格式</h3>
<br />
<div>For each test case print two lines. In the first line print the number of possible periods after we replace each unreadable letter with "V" or "K". In the next line print all these values in increasing order.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>3
 
5
V??VK
 
6
??????
 
4
?VK?
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>2
3 5
6
1 2 3 4 5 6
3
2 3 4
</code></pre>
<h2>说明</h2>
<div>In the first test case from example we can obtain, for example, "VKKVK", which has periods $ 3 $ and $ 5 $ .
In the second test case we can obtain "VVVVVV" which has all periods from $ 1 $ to $ 6 $ .
In the third test case string "KVKV" has periods $ 2 $ and $ 4 $ , and string "KVKK" has periods $ 3 $ and $ 4 $ .</div>
</article>
</div>
</div>
</body>
</html>
