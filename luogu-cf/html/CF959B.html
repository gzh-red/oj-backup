<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Mahmoud and Ehab and the message - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573399807:6mGd3VNE+Ss6sWUXeI+7zXp3iw0AHKNZsDJSwsJ+ntg=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Mahmoud%20wants%20to%20send%20a%20message%20to%20his%20friend%20Ehab.%20Their%20language%20consists%20of%20%24%20n%20%24%20words%20numbered%20from%20%24%201%20%24%20to%20%24%20n%20%24%20.%20Some%20words%20have%20the%20same%20meaning%20so%20there%20are%20%24%20k%20%24%20groups%20of%20words%20such%20that%20all%20the%20words%20in%20some%20group%20have%20the%20same%20meaning.%5Cn%5CnMahmoud%20knows%20that%20the%20%24%20i%20%24%20-th%20word%20can%20be%20sent%20with%20cost%20%24%20a_%7Bi%7D%20%24%20.%20For%20each%20word%20in%20his%20message%2C%20Mahmoud%20can%20either%20replace%20it%20with%20another%20word%20of%20the%20same%20meaning%20or%20leave%20it%20as%20it%20is.%20Can%20you%20help%20Mahmoud%20determine%20the%20minimum%20cost%20of%20sending%20the%20message%3F%5Cn%5CnThe%20cost%20of%20sending%20the%20message%20is%20the%20sum%20of%20the%20costs%20of%20sending%20every%20word%20in%20it.%22%2C%22inputFormat%22%3A%22The%20first%20line%20of%20input%20contains%20integers%20%24%20n%20%24%20%2C%20%24%20k%20%24%20and%20%24%20m%20%24%20%24%20%281%3C%3Dk%3C%3Dn%3C%3D10%5E%7B5%7D%2C1%3C%3Dm%3C%3D10%5E%7B5%7D%29%20%24%20%5Cu2014%20the%20number%20of%20words%20in%20their%20language%2C%20the%20number%20of%20groups%20of%20words%2C%20and%20the%20number%20of%20words%20in%20Mahmoud%27s%20message%20respectively.%5Cn%5CnThe%20second%20line%20contains%20%24%20n%20%24%20strings%20consisting%20of%20lowercase%20English%20letters%20of%20length%20not%20exceeding%2020%20which%20represent%20the%20words.%20It%27s%20guaranteed%20that%20the%20words%20are%20distinct.%5Cn%5CnThe%20third%20line%20contains%20%24%20n%20%24%20integers%20%24%20a_%7B1%7D%20%24%20%2C%20%24%20a_%7B2%7D%20%24%20%2C%20%24%20...%20%24%20%2C%20%24%20a_%7Bn%7D%20%24%20%24%20%281%3C%3Da_%7Bi%7D%3C%3D10%5E%7B9%7D%29%20%24%20where%20%24%20a_%7Bi%7D%20%24%20is%20the%20cost%20of%20sending%20the%20%24%20i%20%24%20-th%20word.%5Cn%5CnThe%20next%20%24%20k%20%24%20lines%20describe%20the%20groups%20of%20words%20of%20same%20meaning.%20The%20next%20%24%20k%20%24%20lines%20each%20start%20with%20an%20integer%20%24%20x%20%24%20%24%20%281%3C%3Dx%3C%3Dn%29%20%24%20which%20means%20that%20there%20are%20%24%20x%20%24%20words%20in%20this%20group%2C%20followed%20by%20%24%20x%20%24%20integers%20which%20represent%20the%20indices%20of%20words%20in%20this%20group.%20It%27s%20guaranteed%20that%20each%20word%20appears%20in%20exactly%20one%20group.%5Cn%5CnThe%20next%20line%20contains%20%24%20m%20%24%20space-separated%20words%20which%20represent%20Mahmoud%27s%20message.%20Each%20of%20these%20words%20appears%20in%20the%20list%20of%20language%27s%20words.%22%2C%22outputFormat%22%3A%22The%20only%20line%20should%20contain%20the%20minimum%20cost%20to%20send%20the%20message%20after%20replacing%20some%20words%20%28maybe%20none%29%20with%20some%20words%20of%20the%20same%20meaning.%22%2C%22samples%22%3A%5B%5B%225%204%204%5Cni%20loser%20am%20the%20second%5Cn100%201%201%205%2010%5Cn1%201%5Cn1%203%5Cn2%202%205%5Cn1%204%5Cni%20am%20the%20second%5Cn%22%2C%22107%22%5D%2C%5B%225%204%204%5Cni%20loser%20am%20the%20second%5Cn100%2020%201%205%2010%5Cn1%201%5Cn1%203%5Cn2%202%205%5Cn1%204%5Cni%20am%20the%20second%5Cn%22%2C%22116%22%5D%5D%2C%22hint%22%3A%22In%20the%20first%20sample%2C%20Mahmoud%20should%20replace%20the%20word%20%5C%22second%5C%22%20with%20the%20word%20%5C%22loser%5C%22%20because%20it%20has%20less%20cost%20so%20the%20cost%20will%20be%20100%2B1%2B5%2B1%3D107.%5Cn%5CnIn%20the%20second%20sample%2C%20Mahmoud%20shouldn%27t%20do%20any%20replacement%20so%20the%20cost%20will%20be%20100%2B1%2B5%2B10%3D116.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F959%5C%2FB%22%2C%22id%22%3A%22959B%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A25%2C%22totalAccepted%22%3A16%2C%22pid%22%3A%22CF959B%22%2C%22title%22%3A%22Mahmoud%20and%20Ehab%20and%20the%20message%22%2C%22difficulty%22%3A4%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Mahmoud%20and%20Ehab%20and%20the%20message%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Mahmoud and Ehab and the message</h1>
<h2>题目描述</h2>
<div>Mahmoud wants to send a message to his friend Ehab. Their language consists of $ n $ words numbered from $ 1 $ to $ n $ . Some words have the same meaning so there are $ k $ groups of words such that all the words in some group have the same meaning.
Mahmoud knows that the $ i $ -th word can be sent with cost $ a_{i} $ . For each word in his message, Mahmoud can either replace it with another word of the same meaning or leave it as it is. Can you help Mahmoud determine the minimum cost of sending the message?
The cost of sending the message is the sum of the costs of sending every word in it.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line of input contains integers $ n $ , $ k $ and $ m $ $ (1<=k<=n<=10^{5},1<=m<=10^{5}) $ — the number of words in their language, the number of groups of words, and the number of words in Mahmoud's message respectively.
The second line contains $ n $ strings consisting of lowercase English letters of length not exceeding 20 which represent the words. It's guaranteed that the words are distinct.
The third line contains $ n $ integers $ a_{1} $ , $ a_{2} $ , $ ... $ , $ a_{n} $ $ (1<=a_{i}<=10^{9}) $ where $ a_{i} $ is the cost of sending the $ i $ -th word.
The next $ k $ lines describe the groups of words of same meaning. The next $ k $ lines each start with an integer $ x $ $ (1<=x<=n) $ which means that there are $ x $ words in this group, followed by $ x $ integers which represent the indices of words in this group. It's guaranteed that each word appears in exactly one group.
The next line contains $ m $ space-separated words which represent Mahmoud's message. Each of these words appears in the list of language's words.</div>
<h3>输出格式</h3>
<br />
<div>The only line should contain the minimum cost to send the message after replacing some words (maybe none) with some words of the same meaning.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>5 4 4
i loser am the second
100 1 1 5 10
1 1
1 3
2 2 5
1 4
i am the second
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>107</code></pre>
<h3>输入样例 #2</h3>
<pre><code>5 4 4
i loser am the second
100 20 1 5 10
1 1
1 3
2 2 5
1 4
i am the second
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>116</code></pre>
<h2>说明</h2>
<div>In the first sample, Mahmoud should replace the word "second" with the word "loser" because it has less cost so the cost will be 100+1+5+1=107.
In the second sample, Mahmoud shouldn't do any replacement so the cost will be 100+1+5+10=116.</div>
</article>
</div>
</div>
</body>
</html>
