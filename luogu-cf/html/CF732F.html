<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Tourist Reform - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573397217:Lr6k0/ibXpWqLY4DtZYfVoTjyvEt1gpouXfmau0E7XA=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%22%2C%22description%22%3A%22Berland%20is%20a%20tourist%20country%21%20At%20least%2C%20it%20can%20become%20such%20%5Cu2014%20the%20government%20of%20Berland%20is%20confident%20about%20this.%5Cn%5CnThere%20are%20%24%20n%20%24%20cities%20in%20Berland%2C%20some%20pairs%20of%20which%20are%20connected%20by%20two-ways%20roads.%20Each%20road%20connects%20two%20different%20cities.%20In%20Berland%20there%20are%20no%20roads%20which%20connect%20the%20same%20pair%20of%20cities.%20It%20is%20possible%20to%20get%20from%20any%20city%20to%20any%20other%20city%20using%20given%20two-ways%20roads.%5Cn%5CnAccording%20to%20the%20reform%20each%20road%20will%20become%20one-way.%20It%20will%20be%20oriented%20to%20one%20of%20two%20directions.%5Cn%5CnTo%20maximize%20the%20tourist%20attraction%20of%20Berland%2C%20after%20the%20reform%20for%20each%20city%20%24%20i%20%24%20the%20value%20%24%20r_%7Bi%7D%20%24%20will%20be%20calculated.%20It%20will%20equal%20to%20the%20number%20of%20cities%20%24%20x%20%24%20for%20which%20there%20is%20an%20oriented%20path%20from%20the%20city%20%24%20i%20%24%20to%20the%20city%20%24%20x%20%24%20.%20In%20other%20words%2C%20%24%20r_%7Bi%7D%20%24%20will%20equal%20the%20number%20of%20cities%20which%20can%20be%20reached%20from%20the%20city%20%24%20i%20%24%20by%20roads.%5Cn%5CnThe%20government%20is%20sure%20that%20tourist%27s%20attention%20will%20be%20focused%20on%20the%20minimum%20value%20of%20%24%20r_%7Bi%7D%20%24%20.%5Cn%5CnHelp%20the%20government%20of%20Berland%20make%20the%20reform%20to%20maximize%20the%20minimum%20of%20%24%20r_%7Bi%7D%20%24%20.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20two%20integers%20%24%20n%2Cm%20%24%20%28%20%24%202%3C%3Dn%3C%3D400000%2C1%3C%3Dm%3C%3D400000%20%24%20%29%20%5Cu2014%20the%20number%20of%20cities%20and%20the%20number%20of%20roads.%5Cn%5CnThe%20next%20%24%20m%20%24%20lines%20describe%20roads%20in%20Berland%3A%20the%20%24%20j%20%24%20-th%20of%20them%20contains%20two%20integers%20%24%20u_%7Bj%7D%20%24%20and%20%24%20v_%7Bj%7D%20%24%20%28%20%24%201%3C%3Du_%7Bj%7D%2Cv_%7Bj%7D%3C%3Dn%20%24%20%2C%20%24%20u_%7Bj%7D%5Cu2260v_%7Bj%7D%20%24%20%29%2C%20where%20%24%20u_%7Bj%7D%20%24%20and%20%24%20v_%7Bj%7D%20%24%20are%20the%20numbers%20of%20cities%20which%20are%20connected%20by%20the%20%24%20j%20%24%20-th%20road.%5Cn%5CnThe%20cities%20are%20numbered%20from%20%24%201%20%24%20to%20%24%20n%20%24%20.%20It%20is%20guaranteed%20that%20it%20is%20possible%20to%20get%20from%20any%20city%20to%20any%20other%20by%20following%20two-ways%20roads.%20In%20Berland%20there%20are%20no%20roads%20which%20connect%20the%20same%20pair%20of%20cities.%22%2C%22outputFormat%22%3A%22In%20the%20first%20line%20print%20single%20integer%20%5Cu2014%20the%20maximum%20possible%20value%20%24%20min_%7B1%3C%3Di%3C%3Dn%7D%7Br_%7Bi%7D%7D%20%24%20after%20the%20orientation%20of%20roads.%5Cn%5CnThe%20next%20%24%20m%20%24%20lines%20must%20contain%20the%20description%20of%20roads%20after%20the%20orientation%3A%20the%20%24%20j%20%24%20-th%20of%20them%20must%20contain%20two%20integers%20%24%20u_%7Bj%7D%2Cv_%7Bj%7D%20%24%20%2C%20it%20means%20that%20the%20%24%20j%20%24%20-th%20road%20will%20be%20directed%20from%20the%20city%20%24%20u_%7Bj%7D%20%24%20to%20the%20city%20%24%20v_%7Bj%7D%20%24%20.%20Print%20roads%20in%20the%20same%20order%20as%20they%20are%20given%20in%20the%20input%20data.%22%2C%22samples%22%3A%5B%5B%227%209%5Cn4%203%5Cn2%206%5Cn7%201%5Cn4%201%5Cn7%203%5Cn3%205%5Cn7%204%5Cn6%205%5Cn2%205%5Cn%22%2C%224%5Cn4%203%5Cn6%202%5Cn7%201%5Cn1%204%5Cn3%207%5Cn5%203%5Cn7%204%5Cn5%206%5Cn2%205%5Cn%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B4000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F732%5C%2FF%22%2C%22id%22%3A%22732F%22%7D%2C%22translation%22%3A%22Berland%5Cu662f%5Cu4e00%5Cu4e2a%5Cu65c5%5Cu6e38%5Cu56fd%5Cu5bb6%5Cuff01%5Cu81f3%5Cu5c11%5Cu2014%5Cu2014Berland%5Cu653f%5Cu5e9c%5Cu5bf9%5Cu6b64%5Cu5145%5Cu6ee1%5Cu4fe1%5Cu5fc3%5Cu3002%5Cn%5CnBerland%5Cu6709%20%24n%24%20%5Cu4e2a%5Cu57ce%5Cu5e02%5Cuff0c%5Cu5176%5Cu4e2d%5Cu4e00%5Cu4e9b%5Cu57ce%5Cu5e02%5Cu4ee5%5Cu4e24%5Cu6761%5Cu9053%5Cu8def%5Cu8fde%5Cu63a5%5Cu3002%5Cu6bcf%5Cu6761%5Cu8def%5Cu8fde%5Cu63a5%5Cu4e24%5Cu4e2a%5Cu4e0d%5Cu540c%5Cu7684%5Cu57ce%5Cu5e02%5Cu3002%5Cu5728Berland%5Cu6ca1%5Cu6709%5Cu8fde%5Cu63a5%5Cu540c%5Cu4e00%5Cu57ce%5Cu5e02%5Cu7684%5Cu9053%5Cu8def%5Cu3002%5Cu57ce%5Cu5e02%5Cu4e4b%5Cu95f4%5Cu4e24%5Cu4e24%5Cu53ef%5Cu8fbe%5Cu3002%5Cn%5Cn%5Cu6839%5Cu636e%5Cu6539%5Cu9769%5Cuff0c%5Cu6bcf%5Cu4e00%5Cu6761%5Cu9053%5Cu8def%5Cu5c06%5Cu6210%5Cu4e3a%5Cu5355%5Cu5411%5Cu7684%5Cu3002%5Cu5b83%5Cu5c06%5Cu9762%5Cu5411%5Cu4e24%5Cu4e2a%5Cu65b9%5Cu5411%5Cu4e4b%5Cu4e00%5Cu3002%5Cn%5Cn%5Cu4e3a%5Cu4e86%5Cu6700%5Cu5927%5Cu9650%5Cu5ea6%5Cu5730%5Cu63d0%5Cu9ad8Berland%5Cu7684%5Cu65c5%5Cu6e38%5Cu5438%5Cu5f15%5Cu529b%5Cuff0c%5Cu5728%5Cu5bf9%5Cu6bcf%5Cu4e2a%5Cu57ce%5Cu5e02%5Cu8fdb%5Cu884c%5Cu6539%5Cu9769%5Cu540e%5Cuff0c%5Cu6211%5Cu5c06%5Cu8ba1%5Cu7b97%5Cu503c%20%24R_i%24%20%5Cu3002%5Cu5b83%5Cu5c06%5Cu7b49%5Cu4e8e%5Cu57ce%5Cu5e02%20%24X%24%20%5Cu7684%5Cu6570%5Cu91cf%5Cuff0c%5Cu5176%5Cu4e2d%5Cu6709%5Cu4e00%5Cu4e2a%5Cu4ece%5Cu57ce%5Cu5e02%20%24i%24%20%5Cu5230%5Cu57ce%5Cu5e02%20%24X%24%20%5Cu7684%5Cu6709%5Cu5411%5Cu8def%5Cu5f84%5Cu3002%5Cu6362%5Cu8a00%5Cu4e4b%5Cuff0c%24R_i%24%20%5Cu7b49%5Cu4e8e%5Cu53ef%5Cu4ee5%5Cu901a%5Cu8fc7%5Cu9053%5Cu8def%5Cu4ece%20%24i%24%20%5Cu5230%5Cu8fbe%5Cu7684%5Cu57ce%5Cu5e02%5Cu7684%5Cu6570%5Cu91cf%5Cu3002%5Cn%5Cn%5Cn%5Cu653f%5Cu5e9c%5Cu786e%5Cu4fe1%5Cu6e38%5Cu5ba2%5Cu7684%5Cu6ce8%5Cu610f%5Cu529b%5Cu5c06%5Cu96c6%5Cu4e2d%5Cu5728%20%24R_i%24%20%5Cu7684%5Cu6700%5Cu5c0f%5Cu503c%5Cu4e0a%5Cu3002%5Cn%5Cn%5Cn%5Cu5e2e%5Cu52a9Berland%5Cu653f%5Cu5e9c%5Cu8fdb%5Cu884c%5Cu6539%5Cu9769%5Cuff0c%5Cu4ee5%5Cu6700%5Cu5927%5Cu9650%5Cu5ea6%5Cu5730%5Cu63d0%5Cu9ad8%20%24R_i%24%20%5Cu7684%5Cu6700%5Cu5c0f%5Cu503c%5Cu3002%5Cn%5Cn%5Cu7ffb%5Cu8bd1%5Cu63d0%5Cu4f9b%5Cu8005%5Cuff1ajzzcjb%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A75%2C%22totalAccepted%22%3A22%2C%22pid%22%3A%22CF732F%22%2C%22title%22%3A%22Tourist%20Reform%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A48062%2C%22title%22%3A%22%5Cu7ffb%5Cu8bd1%22%2C%22forum%22%3A%7B%22id%22%3A9689%2C%22name%22%3A%22CF732F%20Tourist%20Reform%22%2C%22slug%22%3A%22CF732F%22%7D%7D%2C%7B%22id%22%3A41323%2C%22title%22%3A%22%5Cu6b64%5Cu9898%5Cu7684%5Cu6837%5Cu4f8b%5Cu8f93%5Cu51fa%5Cu662f%5Cu4e0d%5Cu662f%5Cu6709%5Cu4e00%5Cu70b9%5Cu513f%5Cu95ee%5Cu9898%5Cuff1f%22%2C%22forum%22%3A%7B%22id%22%3A9689%2C%22name%22%3A%22CF732F%20Tourist%20Reform%22%2C%22slug%22%3A%22CF732F%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P2423%22%2C%22title%22%3A%22%5BHEOI2012%5D%5Cu670b%5Cu53cb%5Cu5708%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P3628%22%2C%22title%22%3A%22%5BAPIO2010%5D%5Cu7279%5Cu522b%5Cu884c%5Cu52a8%5Cu961f%20%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22CF696B%22%2C%22title%22%3A%22Puzzles%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF241E%22%2C%22title%22%3A%22Flights%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF85E%22%2C%22title%22%3A%22Guard%20Towers%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Tourist%20Reform%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573306449;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Tourist Reform</h1>
<h2>题意翻译</h2>
<div>Berland是一个旅游国家！至少——Berland政府对此充满信心。
Berland有 $n$ 个城市，其中一些城市以两条道路连接。每条路连接两个不同的城市。在Berland没有连接同一城市的道路。城市之间两两可达。
根据改革，每一条道路将成为单向的。它将面向两个方向之一。
为了最大限度地提高Berland的旅游吸引力，在对每个城市进行改革后，我将计算值 $R_i$ 。它将等于城市 $X$ 的数量，其中有一个从城市 $i$ 到城市 $X$ 的有向路径。换言之，$R_i$ 等于可以通过道路从 $i$ 到达的城市的数量。
政府确信游客的注意力将集中在 $R_i$ 的最小值上。
帮助Berland政府进行改革，以最大限度地提高 $R_i$ 的最小值。
翻译提供者：jzzcjb</div>
<h2>题目描述</h2>
<div>Berland is a tourist country! At least, it can become such — the government of Berland is confident about this.
There are $ n $ cities in Berland, some pairs of which are connected by two-ways roads. Each road connects two different cities. In Berland there are no roads which connect the same pair of cities. It is possible to get from any city to any other city using given two-ways roads.
According to the reform each road will become one-way. It will be oriented to one of two directions.
To maximize the tourist attraction of Berland, after the reform for each city $ i $ the value $ r_{i} $ will be calculated. It will equal to the number of cities $ x $ for which there is an oriented path from the city $ i $ to the city $ x $ . In other words, $ r_{i} $ will equal the number of cities which can be reached from the city $ i $ by roads.
The government is sure that tourist's attention will be focused on the minimum value of $ r_{i} $ .
Help the government of Berland make the reform to maximize the minimum of $ r_{i} $ .</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains two integers $ n,m $ ( $ 2<=n<=400000,1<=m<=400000 $ ) — the number of cities and the number of roads.
The next $ m $ lines describe roads in Berland: the $ j $ -th of them contains two integers $ u_{j} $ and $ v_{j} $ ( $ 1<=u_{j},v_{j}<=n $ , $ u_{j}≠v_{j} $ ), where $ u_{j} $ and $ v_{j} $ are the numbers of cities which are connected by the $ j $ -th road.
The cities are numbered from $ 1 $ to $ n $ . It is guaranteed that it is possible to get from any city to any other by following two-ways roads. In Berland there are no roads which connect the same pair of cities.</div>
<h3>输出格式</h3>
<br />
<div>In the first line print single integer — the maximum possible value $ min_{1<=i<=n}{r_{i}} $ after the orientation of roads.
The next $ m $ lines must contain the description of roads after the orientation: the $ j $ -th of them must contain two integers $ u_{j},v_{j} $ , it means that the $ j $ -th road will be directed from the city $ u_{j} $ to the city $ v_{j} $ . Print roads in the same order as they are given in the input data.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>7 9
4 3
2 6
7 1
4 1
7 3
3 5
7 4
6 5
2 5
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>4
4 3
6 2
7 1
1 4
3 7
5 3
7 4
5 6
2 5
</code></pre>
</article>
</div>
</div>
</body>
</html>
