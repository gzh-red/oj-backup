<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Table Compression - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573396360:SThsMScS6p10YCbMouqbyo0mmdIU/2pK8t779F+mkYY=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Little%20Petya%20is%20now%20fond%20of%20data%20compression%20algorithms.%20He%20has%20already%20studied%20gz%2C%20bz%2C%20zip%20algorithms%20and%20many%20others.%20Inspired%20by%20the%20new%20knowledge%2C%20Petya%20is%20now%20developing%20the%20new%20compression%20algorithm%20which%20he%20wants%20to%20name%20dis.%5Cn%5CnPetya%20decided%20to%20compress%20tables.%20He%20is%20given%20a%20table%20%24%20a%20%24%20consisting%20of%20%24%20n%20%24%20rows%20and%20%24%20m%20%24%20columns%20that%20is%20filled%20with%20positive%20integers.%20He%20wants%20to%20build%20the%20table%20%24%20a%27%20%24%20consisting%20of%20positive%20integers%20such%20that%20the%20relative%20order%20of%20the%20elements%20in%20each%20row%20and%20each%20column%20remains%20the%20same.%20That%20is%2C%20if%20in%20some%20row%20%24%20i%20%24%20of%20the%20initial%20table%20%24%20a_%7Bi%2Cj%7D%26lt%3Ba_%7Bi%2Ck%7D%20%24%20%2C%20then%20in%20the%20resulting%20table%20%24%20a%27_%7Bi%2Cj%7D%26lt%3Ba%27_%7Bi%2Ck%7D%20%24%20%2C%20and%20if%20%24%20a_%7Bi%2Cj%7D%3Da_%7Bi%2Ck%7D%20%24%20then%20%24%20a%27_%7Bi%2Cj%7D%3Da%27_%7Bi%2Ck%7D%20%24%20.%20Similarly%2C%20if%20in%20some%20column%20%24%20j%20%24%20of%20the%20initial%20table%20%24%20a_%7Bi%2Cj%7D%26lt%3Ba_%7Bp%2Cj%7D%20%24%20then%20in%20compressed%20table%20%24%20a%27_%7Bi%2Cj%7D%26lt%3Ba%27_%7Bp%2Cj%7D%20%24%20and%20if%20%24%20a_%7Bi%2Cj%7D%3Da_%7Bp%2Cj%7D%20%24%20then%20%24%20a%27_%7Bi%2Cj%7D%3Da%27_%7Bp%2Cj%7D%20%24%20.%5Cn%5CnBecause%20large%20values%20require%20more%20space%20to%20store%20them%2C%20the%20maximum%20value%20in%20%24%20a%27%20%24%20should%20be%20as%20small%20as%20possible.%5Cn%5CnPetya%20is%20good%20in%20theory%2C%20however%2C%20he%20needs%20your%20help%20to%20implement%20the%20algorithm.%22%2C%22inputFormat%22%3A%22The%20first%20line%20of%20the%20input%20contains%20two%20integers%20%24%20n%20%24%20and%20%24%20m%20%24%20%28%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF650C%5C%2Fc86076cb8f0af8ffa49d0c5aca452a56a1c814a9.png%29%2C%20the%20number%20of%20rows%20and%20the%20number%20of%20columns%20of%20the%20table%20respectively.%5Cn%5CnEach%20of%20the%20following%20%24%20n%20%24%20rows%20contain%20%24%20m%20%24%20integers%20%24%20a_%7Bi%2Cj%7D%20%24%20%24%20%281%3C%3Da_%7Bi%2Cj%7D%3C%3D10%5E%7B9%7D%29%20%24%20that%20are%20the%20values%20in%20the%20table.%22%2C%22outputFormat%22%3A%22Output%20the%20compressed%20table%20in%20form%20of%20%24%20n%20%24%20lines%20each%20containing%20%24%20m%20%24%20integers.%5Cn%5CnIf%20there%20exist%20several%20answers%20such%20that%20the%20maximum%20number%20in%20the%20compressed%20table%20is%20minimum%20possible%2C%20you%20are%20allowed%20to%20output%20any%20of%20them.%22%2C%22samples%22%3A%5B%5B%222%202%5Cn1%202%5Cn3%204%5Cn%22%2C%221%202%5Cn2%203%5Cn%22%5D%2C%5B%224%203%5Cn20%2010%2030%5Cn50%2040%2030%5Cn50%2060%2070%5Cn90%2080%2070%5Cn%22%2C%222%201%203%5Cn5%204%203%5Cn5%206%207%5Cn9%208%207%5Cn%22%5D%5D%2C%22hint%22%3A%22In%20the%20first%20sample%20test%2C%20despite%20the%20fact%20%24%20a_%7B1%2C2%7D%5Cu2260a_%7B21%7D%20%24%20%2C%20they%20are%20not%20located%20in%20the%20same%20row%20or%20column%20so%20they%20may%20become%20equal%20after%20the%20compression.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B4000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F650%5C%2FC%22%2C%22id%22%3A%22650C%22%7D%2C%22translation%22%3A%22%2A%2A%5Cu9898%5Cu76ee%5Cu7b80%5Cu8ff0%2A%2A%5Cr%5Cn%5Cr%5Cn%5Cu7ed9%5Cu5b9a%5Cu4e00N%2AM%5Cu7684%5Cu8868%5Cu683ca%5Cuff0c%5Cu8ba9%5Cu4f60%5Cu5bf9%5Cu5176%5Cu8fdb%5Cu884c%5Cu538b%5Cu7f29%5Cuff0c%5Cu4f7f%5Cu5f97%5Cuff1a%5Cr%5Cn-%20%5Cu6bcf%5Cu4e00%5Cu884c%5Cu4e0e%5Cu6bcf%5Cu4e00%5Cu5217%5Cu76f8%5Cu5bf9%5Cu5927%5Cu5c0f%5Cu4e0d%5Cu53d8%5Cuff0c%5Cu5373%5Cu82e5%24a_%7Bi%2Cj%7D%3Ea_%7Bi%2Ck%7D%24%5Cuff0c%5Cu5219%5Cu538b%5Cu7f29%5Cu540e%5Cu7684%24a%27_%7Bi%2Cj%7D%3Ea%27_%7Bi%2Ck%7D%24%5Cuff0c%5Cu5bf9%5Cu4e8e%5Cu5c0f%5Cu4e8e%5Cu53ca%5Cu7b49%5Cu4e8e%5Cu7684%5Cu60c5%5Cu51b5%5Cu548c%5Cu540c%5Cu5217%5Cu4e0d%5Cu540c%5Cu884c%5Cu7684%5Cu60c5%5Cu51b5%5Cu540c%5Cu7406%5Cu3002%5Cr%5Cn-%20%5Cu538b%5Cu7f29%5Cu540e%5Cu8868%5Cu683c%5Cu4e2d%5Cu7684%5Cu6700%5Cu5927%5Cu503c%5Cu5c3d%5Cu91cf%5Cu5c0f%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu8f93%5Cu51fa%5Cu538b%5Cu7f29%5Cu540e%5Cu7684%5Cu8868%5Cu683c%5Cu3002%5Cr%5Cn%5Cr%5Cn%2A%2A%5Cu6570%5Cu636e%5Cu8303%5Cu56f4%2A%2A%20%5Cr%5Cn%5Cr%5Cn-%20%241%3C%3Dn%2Cm%24%5Cu4e14%24n%2Am%3C%3D1000000%24%5Cuff08%5Cu5373%241e6%24%5Cuff09%5Cr%5Cn-%20%24a_%7Bi%2Cj%7D%3C%3D1e9%24%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A24%2C%22totalAccepted%22%3A11%2C%22pid%22%3A%22CF650C%22%2C%22title%22%3A%22Table%20Compression%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Table%20Compression%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Table Compression</h1>
<h2>题意翻译</h2>
<div>**题目简述**
给定一N*M的表格a，让你对其进行压缩，使得：
- 每一行与每一列相对大小不变，即若$a_{i,j}>a_{i,k}$，则压缩后的$a'_{i,j}>a'_{i,k}$，对于小于及等于的情况和同列不同行的情况同理。
- 压缩后表格中的最大值尽量小。
输出压缩后的表格。
**数据范围**
- $1<=n,m$且$n*m<=1000000$（即$1e6$）
- $a_{i,j}<=1e9$</div>
<h2>题目描述</h2>
<div>Little Petya is now fond of data compression algorithms. He has already studied gz, bz, zip algorithms and many others. Inspired by the new knowledge, Petya is now developing the new compression algorithm which he wants to name dis.
Petya decided to compress tables. He is given a table $ a $ consisting of $ n $ rows and $ m $ columns that is filled with positive integers. He wants to build the table $ a' $ consisting of positive integers such that the relative order of the elements in each row and each column remains the same. That is, if in some row $ i $ of the initial table $ a_{i,j}&lt;a_{i,k} $ , then in the resulting table $ a'_{i,j}&lt;a'_{i,k} $ , and if $ a_{i,j}=a_{i,k} $ then $ a'_{i,j}=a'_{i,k} $ . Similarly, if in some column $ j $ of the initial table $ a_{i,j}&lt;a_{p,j} $ then in compressed table $ a'_{i,j}&lt;a'_{p,j} $ and if $ a_{i,j}=a_{p,j} $ then $ a'_{i,j}=a'_{p,j} $ .
Because large values require more space to store them, the maximum value in $ a' $ should be as small as possible.
Petya is good in theory, however, he needs your help to implement the algorithm.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line of the input contains two integers $ n $ and $ m $ (![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF650C/c86076cb8f0af8ffa49d0c5aca452a56a1c814a9.png), the number of rows and the number of columns of the table respectively.
Each of the following $ n $ rows contain $ m $ integers $ a_{i,j} $ $ (1<=a_{i,j}<=10^{9}) $ that are the values in the table.</div>
<h3>输出格式</h3>
<br />
<div>Output the compressed table in form of $ n $ lines each containing $ m $ integers.
If there exist several answers such that the maximum number in the compressed table is minimum possible, you are allowed to output any of them.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>2 2
1 2
3 4
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>1 2
2 3
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>4 3
20 10 30
50 40 30
50 60 70
90 80 70
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>2 1 3
5 4 3
5 6 7
9 8 7
</code></pre>
<h2>说明</h2>
<div>In the first sample test, despite the fact $ a_{1,2}≠a_{21} $ , they are not located in the same row or column so they may become equal after the compression.</div>
</article>
</div>
</div>
</body>
</html>
