<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Boolean Computer - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573400724:4dNac1fPOX7In/tq+DizDhVdyw3EVfH44hS/FOTomDo=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Alice%20has%20a%20computer%20that%20operates%20on%20%24%20w%20%24%20-bit%20integers.%20The%20computer%20has%20%24%20n%20%24%20registers%20for%20values.%20The%20current%20content%20of%20the%20registers%20is%20given%20as%20an%20array%20%24%20a_1%2C%20a_2%2C%20%5C%5Cldots%2C%20a_n%20%24%20.%5Cn%5CnThe%20computer%20uses%20so-called%20%5C%22number%20gates%5C%22%20to%20manipulate%20this%20data.%20Each%20%5C%22number%20gate%5C%22%20takes%20two%20registers%20as%20inputs%20and%20calculates%20a%20function%20of%20the%20two%20values%20stored%20in%20those%20registers.%20Note%20that%20you%20can%20use%20the%20same%20register%20as%20both%20inputs.%5Cn%5CnEach%20%5C%22number%20gate%5C%22%20is%20assembled%20from%20bit%20gates.%20There%20are%20six%20types%20of%20bit%20gates%3A%20AND%2C%20OR%2C%20XOR%2C%20NOT%20AND%2C%20NOT%20OR%2C%20and%20NOT%20XOR%2C%20denoted%20%5C%22A%5C%22%2C%20%5C%22O%5C%22%2C%20%5C%22X%5C%22%2C%20%5C%22a%5C%22%2C%20%5C%22o%5C%22%2C%20%5C%22x%5C%22%2C%20respectively.%20Each%20bit%20gate%20takes%20two%20bits%20as%20input.%20Its%20output%20given%20the%20input%20bits%20%24%20b_1%20%24%20%2C%20%24%20b_2%20%24%20is%20given%20below%3A%5Cn%5Cn%20%24%20%5C%5Cbegin%7Bmatrix%7D%20b_1%20%26%20b_2%20%26%20A%20%26%20O%20%26%20X%20%26%20a%20%26%20o%20%26%20x%20%5C%5C%5C%5C%200%20%26%200%20%26%200%20%26%200%20%26%200%20%26%201%20%26%201%20%26%201%20%5C%5C%5C%5C%200%20%26%201%20%26%200%20%26%201%20%26%201%20%26%201%20%26%200%20%26%200%20%5C%5C%5C%5C%201%20%26%200%20%26%200%20%26%201%20%26%201%20%26%201%20%26%200%20%26%200%20%5C%5C%5C%5C%201%20%26%201%20%26%201%20%26%201%20%26%200%20%26%200%20%26%200%20%26%201%20%5C%5C%5C%5C%20%5C%5Cend%7Bmatrix%7D%20%24%20To%20build%20a%20%5C%22number%20gate%5C%22%2C%20one%20takes%20%24%20w%20%24%20bit%20gates%20and%20assembles%20them%20into%20an%20array.%20A%20%5C%22number%20gate%5C%22%20takes%20two%20%24%20w%20%24%20-bit%20integers%20%24%20x_1%20%24%20and%20%24%20x_2%20%24%20as%20input.%20The%20%5C%22number%20gate%5C%22%20splits%20the%20integers%20into%20%24%20w%20%24%20bits%20and%20feeds%20the%20%24%20i%20%24%20-th%20bit%20of%20each%20input%20to%20the%20%24%20i%20%24%20-th%20bit%20gate.%20After%20that%2C%20it%20assembles%20the%20resulting%20bits%20again%20to%20form%20an%20output%20word.%5Cn%5CnFor%20instance%2C%20for%20%24%204%20%24%20-bit%20computer%20we%20might%20have%20a%20%5C%22number%20gate%5C%22%20%5C%22AXoA%5C%22%20%28AND%2C%20XOR%2C%20NOT%20OR%2C%20AND%29.%20For%20two%20inputs%2C%20%24%2013%20%3D%201101_2%20%24%20and%20%24%2010%20%3D%201010_2%20%24%20%2C%20this%20returns%20%24%2012%20%3D%201100_2%20%24%20%2C%20as%20%24%201%20%24%20and%20%24%201%20%24%20is%20%24%201%20%24%20%2C%20%24%201%20%24%20xor%20%24%200%20%24%20is%20%24%201%20%24%20%2C%20not%20%28%20%24%200%20%24%20or%20%24%201%20%24%20%29%20is%20%24%200%20%24%20%2C%20and%20finally%20%24%201%20%24%20and%20%24%200%20%24%20is%20%24%200%20%24%20.%5Cn%5CnYou%20are%20given%20a%20description%20of%20%24%20m%20%24%20%5C%22number%20gates%5C%22.%20For%20each%20gate%2C%20your%20goal%20is%20to%20report%20the%20number%20of%20register%20pairs%20for%20which%20the%20%5C%22number%20gate%5C%22%20outputs%20the%20number%20%24%200%20%24%20.%20In%20other%20words%2C%20find%20the%20number%20of%20ordered%20pairs%20%24%20%28i%2Cj%29%20%24%20where%20%24%201%20%5C%5Cleq%20i%2Cj%20%5C%5Cleq%20n%20%24%20%2C%20such%20that%20%24%20w_k%28a_i%2C%20a_j%29%20%3D%200%20%24%20%2C%20where%20%24%20w_k%20%24%20is%20the%20function%20computed%20by%20the%20%24%20k%20%24%20-th%20%5C%22number%20gate%5C%22.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20three%20integers%3A%20%24%20w%20%24%20%2C%20%24%20n%20%24%20%2C%20and%20%24%20m~%281%20%5C%5Cleq%20w%20%5C%5Cleq%2012%2C%201%20%5C%5Cleq%20n%20%5C%5Cleq%203%5C%5Ccdot%2010%5E4%2C%201%20%5C%5Cleq%20m%20%5C%5Cleq%205%5C%5Ccdot%2010%5E4%29%20%24%20%5Cu2014%20the%20word%20size%2C%20the%20number%20of%20variables%2C%20and%20the%20number%20of%20gates.%5Cn%5CnThe%20second%20line%20contains%20%24%20n%20%24%20integers%20%24%20a_1%2C%20a_2%2C%20%5C%5Cldots%2C%20a_n%20%24%20%24%20%280%20%5C%5Cleq%20a_i%20%3C%202%5Ew%29%20%24%20%5Cu2014%20the%20value%20of%20variables%20stored%20in%20the%20registers.%5Cn%5CnEach%20of%20the%20next%20%24%20m%20%24%20lines%20contains%20a%20string%20%24%20g_j~%28%7Cg_j%7C%20%3D%20w%29%20%24%20with%20a%20description%20of%20a%20single%20gate.%20Each%20character%20of%20%24%20g_j%20%24%20is%20one%20of%20%5C%22A%5C%22%2C%20%5C%22O%5C%22%2C%20%5C%22X%5C%22%2C%20%5C%22a%5C%22%2C%20%5C%22o%5C%22%2C%20%5C%22x%5C%22.%22%2C%22outputFormat%22%3A%22Print%20%24%20m%20%24%20lines.%20The%20%24%20i%20%24%20-th%20line%20should%20contain%20the%20number%20of%20ordered%20pairs%20of%20variables%20for%20which%20the%20%24%20i%20%24%20-th%20gate%20returns%20zero.%22%2C%22samples%22%3A%5B%5B%224%203%201%5Cn13%2010%206%5CnAXoA%5Cn%22%2C%223%5Cn%22%5D%2C%5B%221%207%206%5Cn0%201%201%200%201%200%200%5CnA%5CnO%5CnX%5Cna%5Cno%5Cnx%5Cn%22%2C%2240%5Cn16%5Cn25%5Cn9%5Cn33%5Cn24%5Cn%22%5D%2C%5B%226%202%204%5Cn47%2012%5CnAOXaox%5CnAAaaAA%5Cnxxxxxx%5CnXXXXXX%5Cn%22%2C%222%5Cn3%5Cn0%5Cn2%5Cn%22%5D%2C%5B%222%202%202%5Cn2%200%5CnxO%5CnOx%5Cn%22%2C%222%5Cn0%5Cn%22%5D%5D%2C%22hint%22%3A%22In%20the%20first%20test%20case%2C%20the%20inputs%20in%20binary%20are%20%24%201101%20%24%20%2C%20%24%201010%20%24%20%2C%20%24%200110%20%24%20.%20The%20pairs%20that%20return%20%24%200%20%24%20are%20%24%20%2813%2C%206%29%20%24%20%2C%20%24%20%286%2C%2013%29%20%24%20%2C%20and%20%24%20%286%2C%206%29%20%24%20.%20As%20it%20was%20already%20mentioned%20in%20the%20problem%20statement%2C%20%24%2013%20%5C%5Coplus%2010%20%3D%2010%20%5C%5Coplus%2013%20%3D%2012%20%24%20.%20The%20other%20pairs%20are%20%24%2013%20%5C%5Coplus%2013%20%3D%2011%20%24%20%2C%20%24%2010%20%5C%5Coplus%2010%20%3D%208%20%24%20and%20%24%2010%20%5C%5Coplus%206%20%3D%206%20%5C%5Coplus%2010%20%3D%204%20%24%20.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B7000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F1033%5C%2FF%22%2C%22id%22%3A%221033F%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A1%2C%22totalAccepted%22%3A1%2C%22pid%22%3A%22CF1033F%22%2C%22title%22%3A%22Boolean%20Computer%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Boolean%20Computer%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Boolean Computer</h1>
<h2>题目描述</h2>
<div>Alice has a computer that operates on $ w $ -bit integers. The computer has $ n $ registers for values. The current content of the registers is given as an array $ a_1, a_2, \ldots, a_n $ .
The computer uses so-called "number gates" to manipulate this data. Each "number gate" takes two registers as inputs and calculates a function of the two values stored in those registers. Note that you can use the same register as both inputs.
Each "number gate" is assembled from bit gates. There are six types of bit gates: AND, OR, XOR, NOT AND, NOT OR, and NOT XOR, denoted "A", "O", "X", "a", "o", "x", respectively. Each bit gate takes two bits as input. Its output given the input bits $ b_1 $ , $ b_2 $ is given below:
$ \begin{matrix} b_1 & b_2 & A & O & X & a & o & x \\ 0 & 0 & 0 & 0 & 0 & 1 & 1 & 1 \\ 0 & 1 & 0 & 1 & 1 & 1 & 0 & 0 \\ 1 & 0 & 0 & 1 & 1 & 1 & 0 & 0 \\ 1 & 1 & 1 & 1 & 0 & 0 & 0 & 1 \\ \end{matrix} $ To build a "number gate", one takes $ w $ bit gates and assembles them into an array. A "number gate" takes two $ w $ -bit integers $ x_1 $ and $ x_2 $ as input. The "number gate" splits the integers into $ w $ bits and feeds the $ i $ -th bit of each input to the $ i $ -th bit gate. After that, it assembles the resulting bits again to form an output word.
For instance, for $ 4 $ -bit computer we might have a "number gate" "AXoA" (AND, XOR, NOT OR, AND). For two inputs, $ 13 = 1101_2 $ and $ 10 = 1010_2 $ , this returns $ 12 = 1100_2 $ , as $ 1 $ and $ 1 $ is $ 1 $ , $ 1 $ xor $ 0 $ is $ 1 $ , not ( $ 0 $ or $ 1 $ ) is $ 0 $ , and finally $ 1 $ and $ 0 $ is $ 0 $ .
You are given a description of $ m $ "number gates". For each gate, your goal is to report the number of register pairs for which the "number gate" outputs the number $ 0 $ . In other words, find the number of ordered pairs $ (i,j) $ where $ 1 \leq i,j \leq n $ , such that $ w_k(a_i, a_j) = 0 $ , where $ w_k $ is the function computed by the $ k $ -th "number gate".</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains three integers: $ w $ , $ n $ , and $ m~(1 \leq w \leq 12, 1 \leq n \leq 3\cdot 10^4, 1 \leq m \leq 5\cdot 10^4) $ — the word size, the number of variables, and the number of gates.
The second line contains $ n $ integers $ a_1, a_2, \ldots, a_n $ $ (0 \leq a_i < 2^w) $ — the value of variables stored in the registers.
Each of the next $ m $ lines contains a string $ g_j~(|g_j| = w) $ with a description of a single gate. Each character of $ g_j $ is one of "A", "O", "X", "a", "o", "x".</div>
<h3>输出格式</h3>
<br />
<div>Print $ m $ lines. The $ i $ -th line should contain the number of ordered pairs of variables for which the $ i $ -th gate returns zero.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>4 3 1
13 10 6
AXoA
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>3
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>1 7 6
0 1 1 0 1 0 0
A
O
X
a
o
x
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>40
16
25
9
33
24
</code></pre>
<h3>输入样例 #3</h3>
<pre><code>6 2 4
47 12
AOXaox
AAaaAA
xxxxxx
XXXXXX
</code></pre>
<h3>输出样例 #3</h3>
<pre><code>2
3
0
2
</code></pre>
<h3>输入样例 #4</h3>
<pre><code>2 2 2
2 0
xO
Ox
</code></pre>
<h3>输出样例 #4</h3>
<pre><code>2
0
</code></pre>
<h2>说明</h2>
<div>In the first test case, the inputs in binary are $ 1101 $ , $ 1010 $ , $ 0110 $ . The pairs that return $ 0 $ are $ (13, 6) $ , $ (6, 13) $ , and $ (6, 6) $ . As it was already mentioned in the problem statement, $ 13 \oplus 10 = 10 \oplus 13 = 12 $ . The other pairs are $ 13 \oplus 13 = 11 $ , $ 10 \oplus 10 = 8 $ and $ 10 \oplus 6 = 6 \oplus 10 = 4 $ .</div>
</article>
</div>
</div>
</body>
</html>
