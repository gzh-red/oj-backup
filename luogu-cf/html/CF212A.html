<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Privatization - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573391751:6w2cqKIG7/Sc1mnNB6m5q5pHx2O5YCbudfla/VussH0=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22There%20is%20a%20developed%20network%20of%20flights%20between%20Berland%20and%20Beerland.%20All%20of%20them%20belong%20to%20the%20Berland%20state%20company%20BerAvia.%20Each%20flight%20connects%20some%20Berland%20city%20with%20some%20Beerland%20city.%20For%20each%20flight%20airplanes%20fly%20in%20both%20directions.%5Cn%5CnChanges%20are%20coming%20to%20Berland%20%5Cu2014%20the%20state%20decided%20to%20privatize%20BerAvia%2C%20namely%2C%20to%20sell%20out%20all%20flights%20to%20%24%20t%20%24%20private%20companies.%20Each%20of%20these%20companies%20wants%20to%20get%20the%20maximal%20number%20of%20flights%2C%20so%20if%20the%20Berland%20flights%20are%20sold%20unevenly%2C%20Berland%20can%20be%20accused%20of%20partiality.%20Berland%20Government%20decided%20to%20sell%20the%20flights%20as%20evenly%20as%20possible%20between%20the%20%24%20t%20%24%20companies.%5Cn%5CnThe%20unevenness%20of%20the%20distribution%20of%20flights%20between%20companies%20is%20calculated%20as%20follows.%20For%20each%20city%20%24%20i%20%24%20%28both%20Berland%20and%20Beerland%29%20we%27ll%20calculate%20the%20value%20of%5Cn%5Cn%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF212A%5C%2F8cb4dc3a97b60ddf7de9158fd0e56414b7e627be.png%29%20where%20%24%20a_%7Bij%7D%20%24%20is%20the%20number%20of%20flights%20from%20city%20%24%20i%20%24%20%2C%20which%20belong%20to%20company%20%24%20j%20%24%20.%20The%20sum%20of%20%24%20w_%7Bi%7D%20%24%20for%20all%20cities%20in%20both%20countries%20is%20called%20the%20unevenness%20of%20the%20distribution.%20The%20distribution%20with%20the%20minimal%20unevenness%20is%20the%20most%20even%20one.Help%20the%20Berland%20government%20come%20up%20with%20the%20most%20even%20distribution%20plan%20of%20selling%20flights.%22%2C%22inputFormat%22%3A%22The%20first%20input%20line%20contains%20four%20integers%20%24%20n%2Cm%2Ck%20%24%20and%20%24%20t%20%24%20%28%20%24%201%3C%3Dn%2Cm%2Ct%3C%3D200%3B1%3C%3Dk%3C%3D5000%20%24%20%29%2C%20where%20%24%20n%2Cm%20%24%20are%20the%20numbers%20of%20cities%20in%20Berland%20and%20Beerland%2C%20correspondingly%2C%20%24%20k%20%24%20is%20the%20number%20of%20flights%20between%20them%2C%20and%20%24%20t%20%24%20is%20the%20number%20of%20private%20companies.%20Next%20%24%20k%20%24%20lines%20describe%20the%20flights%2C%20one%20per%20line%2C%20as%20pairs%20of%20positive%20integers%20%24%20x_%7Bi%7D%2Cy_%7Bi%7D%20%24%20%28%20%24%201%3C%3Dx_%7Bi%7D%3C%3Dn%3B1%3C%3Dy_%7Bi%7D%3C%3Dm%20%24%20%29%2C%20where%20%24%20x_%7Bi%7D%20%24%20and%20%24%20y_%7Bi%7D%20%24%20are%20the%20indexes%20of%20cities%20in%20Berland%20and%20Beerland%2C%20correspondingly%2C%20connected%20by%20the%20%24%20i%20%24%20-th%20flight.%20There%20is%20at%20most%20one%20flight%20between%20any%20pair%20of%20cities%2C%20each%20flight%20connects%20cities%20of%20different%20countries.%20The%20cities%20in%20Berland%20are%20indexed%20from%201%20to%20%24%20n%20%24%20%2C%20and%20in%20Beerland%20%5Cu2014%20from%201%20to%20%24%20m%20%24%20.%22%2C%22outputFormat%22%3A%22Print%20the%20unevenness%20of%20the%20sought%20plan%20on%20the%20first%20line.%20On%20the%20second%20line%20print%20a%20sequence%20of%20%24%20k%20%24%20integers%20%24%20c_%7B1%7D%2Cc_%7B2%7D%2C...%2Cc_%7Bk%7D%20%24%20%28%20%24%201%3C%3Dc_%7Bi%7D%3C%3Dt%20%24%20%29%2C%20where%20%24%20c_%7Bi%7D%20%24%20is%20the%20index%20of%20the%20company%20that%20should%20buy%20the%20%24%20i%20%24%20-th%20flight.%20Assume%20that%20the%20flights%20are%20indexed%20from%201%20to%20%24%20k%20%24%20in%20the%20order%20they%20appear%20in%20the%20input.%20If%20there%20are%20multiple%20solutions%2C%20print%20any%20of%20them.%22%2C%22samples%22%3A%5B%5B%223%205%208%202%5Cn1%204%5Cn1%203%5Cn3%203%5Cn1%202%5Cn1%201%5Cn2%201%5Cn1%205%5Cn2%202%5Cn%22%2C%224%5Cn2%201%202%201%202%201%202%202%20%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F212%5C%2FA%22%2C%22id%22%3A%22212A%22%7D%2C%22translation%22%3A%22Berland%20%5Cu548c%20Beerland%20%5Cu4e4b%5Cu95f4%5Cu6709%5Cu53d1%5Cu8fbe%5Cu7684%5Cu822a%5Cu73ed%5Cu7f51%5Cu7edc%5Cuff0c%5Cu5b83%5Cu4eec%5Cu90fd%5Cu5c5e%5Cu4e8e%20Berland%20%5Cu56fd%5Cu8425%5Cu516c%5Cu53f8%20BerAvia%5Cu3002%5Cu6bcf%5Cu6761%5Cu822a%5Cu7ebf%5Cu5c06%20Berland%20%5Cu7684%5Cu4e00%5Cu4e2a%5Cu57ce%5Cu5e02%5Cu548c%20Beerland%20%5Cu7684%5Cu4e00%5Cu4e2a%5Cu57ce%5Cu5e02%5Cu8fde%5Cu63a5%5Cu8d77%5Cu6765%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu6700%5Cu8fd1%5Cuff0cBerland%20%5Cu51b3%5Cu5b9a%5Cu79c1%5Cu6709%5Cu5316%20BerAvia%5Cuff0c%5Cu4ed6%5Cu4eec%5Cu5c06%5Cu822a%5Cu7ebf%5Cu5356%5Cu7ed9%5Cu4e86%20%24k%24%20%5Cu5bb6%5Cu79c1%5Cu4eba%5Cu516c%5Cu53f8%5Cu3002%5Cu8fd9%5Cu4e9b%5Cu516c%5Cu53f8%5Cu5e0c%5Cu671b%5Cu822a%5Cu7ebf%5Cu7684%5Cu5212%5Cu5206%5Cu5c3d%5Cu91cf%5Cu5747%5Cu5300%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu5177%5Cu4f53%5Cu5730%5Cuff0c%5Cu5bf9%5Cu6bcf%5Cu4e2a%5Cu57ce%5Cu5e02%20%24i%24%5Cuff0c%5Cu5b9a%5Cu4e49%5Cu4e0d%5Cu5747%5Cu5300%5Cu5ea6%5Cr%5Cn%5Cr%5Cn%24%24w_i%3D%5C%5Cmax_j%20a_%7Bi%2Cj%7D-%5C%5Cmin_j%20a_%7Bi%2Cj%7D%24%24%5Cr%5Cn%5Cr%5Cn%5Cu5176%5Cu4e2d%5Cuff0c%24a_%7Bi%2Cj%7D%24%20%5Cu4ee3%5Cu8868%5Cu516c%5Cu53f8%20%24j%24%20%5Cu62e5%5Cu6709%5Cu7684%5Cu7ecf%5Cu8fc7%20%24i%24%20%5Cu5e02%5Cu7684%5Cu822a%5Cu7ebf%5Cu6570%5Cu91cf%5Cu3002%5Cr%5Cn%5Cr%5CnBerland%20%5Cu653f%5Cu5e9c%5Cu5e0c%5Cu671b%5Cu4e0d%5Cu5747%5Cu5300%5Cu5ea6%5Cu7684%5Cu5e73%5Cu5747%5Cu503c%5Cu6700%5Cu5c0f%5Cuff0c%5Cu8bf7%5Cu5e2e%5Cu52a9%5Cu5b83%5Cu4eec%5Cu627e%5Cu5230%5Cu6700%5Cu4f73%5Cu65b9%5Cu6848%5Cuff0c%5Cu5e76%5Cu8f93%5Cu51fa%5Cu4e0d%5Cu5747%5Cu5300%5Cu5ea6%5Cu7684%5Cu548c%5Cu3002%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A1%2C%22totalAccepted%22%3A1%2C%22pid%22%3A%22CF212A%22%2C%22title%22%3A%22Privatization%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A93695%2C%22title%22%3A%22%5Cu7ffb%5Cu8bd1%22%2C%22forum%22%3A%7B%22id%22%3A11768%2C%22name%22%3A%22CF212A%20Privatization%22%2C%22slug%22%3A%22CF212A%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Privatization%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573295103;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Privatization</h1>
<h2>题意翻译</h2>
<div>Berland 和 Beerland 之间有发达的航班网络，它们都属于 Berland 国营公司 BerAvia。每条航线将 Berland 的一个城市和 Beerland 的一个城市连接起来。
最近，Berland 决定私有化 BerAvia，他们将航线卖给了 $k$ 家私人公司。这些公司希望航线的划分尽量均匀。
具体地，对每个城市 $i$，定义不均匀度
$$w_i=\max_j a_{i,j}-\min_j a_{i,j}$$
其中，$a_{i,j}$ 代表公司 $j$ 拥有的经过 $i$ 市的航线数量。
Berland 政府希望不均匀度的平均值最小，请帮助它们找到最佳方案，并输出不均匀度的和。</div>
<h2>题目描述</h2>
<div>There is a developed network of flights between Berland and Beerland. All of them belong to the Berland state company BerAvia. Each flight connects some Berland city with some Beerland city. For each flight airplanes fly in both directions.
Changes are coming to Berland — the state decided to privatize BerAvia, namely, to sell out all flights to $ t $ private companies. Each of these companies wants to get the maximal number of flights, so if the Berland flights are sold unevenly, Berland can be accused of partiality. Berland Government decided to sell the flights as evenly as possible between the $ t $ companies.
The unevenness of the distribution of flights between companies is calculated as follows. For each city $ i $ (both Berland and Beerland) we'll calculate the value of
![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF212A/8cb4dc3a97b60ddf7de9158fd0e56414b7e627be.png) where $ a_{ij} $ is the number of flights from city $ i $ , which belong to company $ j $ . The sum of $ w_{i} $ for all cities in both countries is called the unevenness of the distribution. The distribution with the minimal unevenness is the most even one.Help the Berland government come up with the most even distribution plan of selling flights.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first input line contains four integers $ n,m,k $ and $ t $ ( $ 1<=n,m,t<=200;1<=k<=5000 $ ), where $ n,m $ are the numbers of cities in Berland and Beerland, correspondingly, $ k $ is the number of flights between them, and $ t $ is the number of private companies. Next $ k $ lines describe the flights, one per line, as pairs of positive integers $ x_{i},y_{i} $ ( $ 1<=x_{i}<=n;1<=y_{i}<=m $ ), where $ x_{i} $ and $ y_{i} $ are the indexes of cities in Berland and Beerland, correspondingly, connected by the $ i $ -th flight. There is at most one flight between any pair of cities, each flight connects cities of different countries. The cities in Berland are indexed from 1 to $ n $ , and in Beerland — from 1 to $ m $ .</div>
<h3>输出格式</h3>
<br />
<div>Print the unevenness of the sought plan on the first line. On the second line print a sequence of $ k $ integers $ c_{1},c_{2},...,c_{k} $ ( $ 1<=c_{i}<=t $ ), where $ c_{i} $ is the index of the company that should buy the $ i $ -th flight. Assume that the flights are indexed from 1 to $ k $ in the order they appear in the input. If there are multiple solutions, print any of them.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>3 5 8 2
1 4
1 3
3 3
1 2
1 1
2 1
1 5
2 2
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>4
2 1 2 1 2 1 2 2 </code></pre>
</article>
</div>
</div>
</body>
</html>
