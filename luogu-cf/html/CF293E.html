<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Close Vertices - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573392402:kTzBld7fatFokL1pdxnbuuWsL8is5lvHjAB3FpSb3vg=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22You%27ve%20got%20a%20weighted%20tree%2C%20consisting%20of%20%24%20n%20%24%20vertices.%20Each%20edge%20has%20a%20non-negative%20weight.%20The%20length%20of%20the%20path%20between%20any%20two%20vertices%20of%20the%20tree%20is%20the%20number%20of%20edges%20in%20the%20path.%20The%20weight%20of%20the%20path%20is%20the%20total%20weight%20of%20all%20edges%20it%20contains.%5Cn%5CnTwo%20vertices%20are%20close%20if%20there%20exists%20a%20path%20of%20length%20at%20most%20%24%20l%20%24%20between%20them%20and%20a%20path%20of%20weight%20at%20most%20%24%20w%20%24%20between%20them.%20Count%20the%20number%20of%20pairs%20of%20vertices%20%24%20v%2Cu%20%24%20%24%20%28v%26lt%3Bu%29%20%24%20%2C%20such%20that%20vertices%20%24%20v%20%24%20and%20%24%20u%20%24%20are%20close.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20three%20integers%20%24%20n%20%24%20%2C%20%24%20l%20%24%20and%20%24%20w%20%24%20%24%20%281%3C%3Dn%3C%3D10%5E%7B5%7D%2C1%3C%3Dl%3C%3Dn%2C0%3C%3Dw%3C%3D10%5E%7B9%7D%29%20%24%20.%20The%20next%20%24%20n-1%20%24%20lines%20contain%20the%20descriptions%20of%20the%20tree%20edges.%20The%20%24%20i%20%24%20-th%20line%20contains%20two%20integers%20%24%20p_%7Bi%7D%2Cw_%7Bi%7D%20%24%20%24%20%281%3C%3Dp_%7Bi%7D%26lt%3B%28i%2B1%29%2C0%3C%3Dw_%7Bi%7D%3C%3D10%5E%7B4%7D%29%20%24%20%2C%20that%20mean%20that%20the%20%24%20i%20%24%20-th%20edge%20connects%20vertex%20%24%20%28i%2B1%29%20%24%20and%20%24%20p_%7Bi%7D%20%24%20and%20has%20weight%20%24%20w_%7Bi%7D%20%24%20.%5Cn%5CnConsider%20the%20tree%20vertices%20indexed%20from%201%20to%20%24%20n%20%24%20in%20some%20way.%22%2C%22outputFormat%22%3A%22Print%20a%20single%20integer%20%5Cu2014%20the%20number%20of%20close%20pairs.%5Cn%5CnPlease%2C%20do%20not%20use%20the%20%25lld%20specifier%20to%20read%20or%20write%2064-bit%20integers%20in%20%5Cu0421%2B%2B.%20It%20is%20preferred%20to%20use%20the%20cin%2C%20cout%20streams%20or%20the%20%25I64d%20specifier.%22%2C%22samples%22%3A%5B%5B%224%204%206%5Cn1%203%5Cn1%204%5Cn1%203%5Cn%22%2C%224%5Cn%22%5D%2C%5B%226%202%2017%5Cn1%203%5Cn2%205%5Cn2%2013%5Cn1%206%5Cn5%209%5Cn%22%2C%229%5Cn%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B5000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F293%5C%2FE%22%2C%22id%22%3A%22293E%22%7D%2C%22translation%22%3A%22%20%24n%24%20%5Cu4e2a%5Cu70b9%5Cu7684%5Cu6811%5Cuff0c%5Cu7b2c%20%24i%24%20%5Cu6761%5Cu957f%5Cu5ea6%5Cu4e3a1%5Cuff0c%5Cu8fb9%5Cu6743%5Cu4e3a%20%24w_i%24%2C%5Cu8fde%5Cu63a5%20%24i%2B1%24%5Cuff0c%24p_i%24%5Cu4e24%5Cu4e2a%5Cu8282%5Cu70b9%20%20%5Cr%5Cn%5Cu4e24%5Cu4e2a%5Cu53c2%5Cu6570%20%24l%2Cw%24%20%5Cuff0c%5Cu6c42%5Cu6709%5Cu591a%5Cu5c11%5Cu5bf9%5Cu70b9%5Cuff0c%5Cu6ee1%5Cu8db3%20%24i%5Cu2192j%24%20%5Cu7684%5Cu957f%5Cu5ea6%5Cu4e0d%5Cu8d85%5Cu8fc7%20%24l%24%20%2C%5Cu8fb9%5Cu6743%5Cu4e0d%5Cu8d85%5Cu8fc7%20%24w%24%20%22%2C%22tags%22%3A%5B49%2C53%2C266%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A190%2C%22totalAccepted%22%3A57%2C%22pid%22%3A%22CF293E%22%2C%22title%22%3A%22Close%20Vertices%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A32913%2C%22title%22%3A%22%5Cu9898%5Cu610f%22%2C%22forum%22%3A%7B%22id%22%3A11432%2C%22name%22%3A%22CF293E%20Close%20Vertices%22%2C%22slug%22%3A%22CF293E%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P2805%22%2C%22title%22%3A%22%5BNOI2009%5D%5Cu690d%5Cu7269%5Cu5927%5Cu6218%5Cu50f5%5Cu5c38%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22CF842E%22%2C%22title%22%3A%22Nikita%20and%20game%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF375D%22%2C%22title%22%3A%22Tree%20and%20Queries%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1101D%22%2C%22title%22%3A%22GCD%20Counting%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1188A1%22%2C%22title%22%3A%22Add%20on%20a%20Tree%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Close%20Vertices%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Close Vertices</h1>
<h2>题意翻译</h2>
<div> $n$ 个点的树，第 $i$ 条长度为1，边权为 $w_i$,连接 $i+1$，$p_i$两个节点
两个参数 $l,w$ ，求有多少对点，满足 $i→j$ 的长度不超过 $l$ ,边权不超过 $w$ </div>
<h2>题目描述</h2>
<div>You've got a weighted tree, consisting of $ n $ vertices. Each edge has a non-negative weight. The length of the path between any two vertices of the tree is the number of edges in the path. The weight of the path is the total weight of all edges it contains.
Two vertices are close if there exists a path of length at most $ l $ between them and a path of weight at most $ w $ between them. Count the number of pairs of vertices $ v,u $ $ (v&lt;u) $ , such that vertices $ v $ and $ u $ are close.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains three integers $ n $ , $ l $ and $ w $ $ (1<=n<=10^{5},1<=l<=n,0<=w<=10^{9}) $ . The next $ n-1 $ lines contain the descriptions of the tree edges. The $ i $ -th line contains two integers $ p_{i},w_{i} $ $ (1<=p_{i}&lt;(i+1),0<=w_{i}<=10^{4}) $ , that mean that the $ i $ -th edge connects vertex $ (i+1) $ and $ p_{i} $ and has weight $ w_{i} $ .
Consider the tree vertices indexed from 1 to $ n $ in some way.</div>
<h3>输出格式</h3>
<br />
<div>Print a single integer — the number of close pairs.
Please, do not use the %lld specifier to read or write 64-bit integers in С++. It is preferred to use the cin, cout streams or the %I64d specifier.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>4 4 6
1 3
1 4
1 3
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>4
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>6 2 17
1 3
2 5
2 13
1 6
5 9
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>9
</code></pre>
</article>
</div>
</div>
</body>
</html>
