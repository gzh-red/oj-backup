<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Upgrading Array - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573393729:fE1yJ3y8yqfM2bQpA89GvjiO6L7OyCqPw0DjE1ihZHE=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22You%20have%20an%20array%20of%20positive%20integers%20%24%20a%5B1%5D%2Ca%5B2%5D%2C...%2Ca%5Bn%5D%20%24%20and%20a%20set%20of%20bad%20prime%20numbers%20%24%20b_%7B1%7D%2Cb_%7B2%7D%2C...%2Cb_%7Bm%7D%20%24%20.%20The%20prime%20numbers%20that%20do%20not%20occur%20in%20the%20set%20%24%20b%20%24%20are%20considered%20good.%20The%20beauty%20of%20array%20%24%20a%20%24%20is%20the%20sum%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF402D%5C%2Faea4eb2d17c24d3a2d1067454589473b9ea01095.png%29%2C%20where%20function%20%24%20f%28s%29%20%24%20is%20determined%20as%20follows%3A%5Cn%5Cn-%20%24%20f%281%29%3D0%20%24%20%3B%5Cn-%20Let%27s%20assume%20that%20%24%20p%20%24%20is%20the%20minimum%20prime%20divisor%20of%20%24%20s%20%24%20.%20If%20%24%20p%20%24%20is%20a%20good%20prime%2C%20then%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF402D%5C%2F8afcd99c67c49a2d759fe9b7228c1f8d0e576b6a.png%29%2C%20otherwise%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF402D%5C%2Fcce5ab868ac31145b115c9c6f231d8d473326030.png%29.%5Cn%5CnYou%20are%20allowed%20to%20perform%20an%20arbitrary%20%28probably%20zero%29%20number%20of%20operations%20to%20improve%20array%20%24%20a%20%24%20.%20The%20operation%20of%20improvement%20is%20the%20following%20sequence%20of%20actions%3A%5Cn%5Cn-%20Choose%20some%20number%20%24%20r%20%24%20%28%20%24%201%3C%3Dr%3C%3Dn%20%24%20%29%20and%20calculate%20the%20value%20%24%20g%20%24%20%3D%20GCD%28%20%24%20a%5B1%5D%2Ca%5B2%5D%2C...%2Ca%5Br%5D%20%24%20%29.%5Cn-%20Apply%20the%20assignments%3A%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF402D%5C%2F7da2ca9ebcb0c358dd26347b51043ad8cf29f6d1.png%29%2C%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF402D%5C%2F41a62953f2b193f6f57ad5e6aa04be0947094a88.png%29%2C%20%24%20...%20%24%20%2C%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF402D%5C%2F7947630aa7cab27f0ca3ac2ef6955b60eb99bea8.png%29.%5Cn%5CnWhat%20is%20the%20maximum%20beauty%20of%20the%20array%20you%20can%20get%3F%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20two%20integers%20%24%20n%20%24%20and%20%24%20m%20%24%20%28%20%24%201%3C%3Dn%2Cm%3C%3D5000%20%24%20%29%20showing%20how%20many%20numbers%20are%20in%20the%20array%20and%20how%20many%20bad%20prime%20numbers%20there%20are.%5Cn%5CnThe%20second%20line%20contains%20%24%20n%20%24%20space-separated%20integers%20%24%20a%5B1%5D%2Ca%5B2%5D%2C...%2Ca%5Bn%5D%20%24%20%28%20%24%201%3C%3Da%5Bi%5D%3C%3D10%5E%7B9%7D%20%24%20%29%20%5Cu2014%20array%20%24%20a%20%24%20.%20The%20third%20line%20contains%20%24%20m%20%24%20space-separated%20integers%20%24%20b_%7B1%7D%2Cb_%7B2%7D%2C...%2Cb_%7Bm%7D%20%24%20%28%20%24%202%3C%3Db_%7B1%7D%26lt%3Bb_%7B2%7D%26lt%3B...%26lt%3Bb_%7Bm%7D%3C%3D10%5E%7B9%7D%20%24%20%29%20%5Cu2014%20the%20set%20of%20bad%20prime%20numbers.%22%2C%22outputFormat%22%3A%22Print%20a%20single%20integer%20%5Cu2014%20the%20answer%20to%20the%20problem.%22%2C%22samples%22%3A%5B%5B%225%202%5Cn4%2020%2034%2010%2010%5Cn2%205%5Cn%22%2C%22-2%5Cn%22%5D%2C%5B%224%205%5Cn2%204%208%2016%5Cn3%205%207%2011%2017%5Cn%22%2C%2210%5Cn%22%5D%5D%2C%22hint%22%3A%22Note%20that%20the%20answer%20to%20the%20problem%20can%20be%20negative.%5Cn%5CnThe%20GCD%28%20%24%20x_%7B1%7D%20%24%20%2C%20%24%20x_%7B2%7D%20%24%20%2C%20...%2C%20%24%20x_%7Bk%7D%20%24%20%29%20is%20the%20maximum%20positive%20integer%20that%20divides%20each%20%24%20x_%7Bi%7D%20%24%20.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F402%5C%2FD%22%2C%22id%22%3A%22402D%22%7D%2C%22translation%22%3A%22%5Cu7ed9%5Cu4e00%5Cu4e2a%5Cu6709n%5Cu4e2a%5Cu6570%20a%5B1%5D%2Ca%5B2%5D%2C%5Cu2026%2Ca%5Bn%5D%20%5Cu7684%5Cu6570%5Cu5217%5Cu6253%5Cu5206%5Cuff0c%5Cu4f60%5Cu8ba4%5Cu4e3a%20b%5B1%5D%2Cb%5B2%5D%5Cu2026%2Cb%5Bm%5D%20%5Cu662f%5Cu4e0d%5Cu597d%5Cu7684%5Cu8d28%5Cu6570%5Cu3002%5Cu5b9a%5Cu4e49%5Cu8fd9%5Cu4e2a%5Cu5e8f%5Cu5217%5Cu7684%5Cu5206%5Cu503c%5Cu4e3a%5Cu5404%5Cu4e2a%5Cu6570%5Cu7684%5Cu5206%5Cu503c%5Cu4e4b%5Cu548c%5Cuff0c%5Cu8bbe%20x%20%5Cu7684%5Cu5206%5Cu503c%5Cu4e3a%20f%28x%29%5Cuff0cf%28x%29%3Df%28x%5C%2Fp%29%2Bk%20%5Cuff08p%20%5Cu4e3a%20x%20%5Cu7684%5Cu6700%5Cu5c0f%5Cu8d28%5Cu56e0%5Cu5b50%5Cuff1b%5Cu82e5%20p%20%5Cu4e3a%5Cu4e0d%5Cu597d%5Cu7684%5Cu8d28%5Cu6570%5Cuff0c%20k%20%5Cu53d6%20%5Cu22121%20%5Cuff0c%5Cu5426%5Cu5219%20k%20%5Cu53d6%20%2B1%20%5Cuff1b%20f%281%29%3D0%20%5Cuff09%5Cu3002%5Cr%5Cn%5Cu4f60%5Cu60f3%5Cu8ba9%5Cu5e8f%5Cu5217%5Cu7684%5Cu5206%5Cu503c%5Cu66f4%5Cu5927%5Cuff0c%5Cu53ef%5Cu4ee5%5Cu53cd%5Cu590d%5Cu8fdb%5Cu884c%5Cu4e00%5Cu9879%5Cu64cd%5Cu4f5c%5Cuff1a%24a%5B1%5D%2Ca%5B2%5D%2Ca%5B3%5D%2C...%2Ca%5Bi%5D%28i%3C%3Dn%29%24%20%5Cu7684%5Cu6bcf%5Cu4e2a%5Cu6570%5Cu9664%5Cu4ee5%5Cu5b83%5Cu4eec%5Cu7684%5Cu6700%5Cu5927%5Cu516c%5Cu7ea6%5Cu6570%5Cu3002%5Cu8bf7%5Cu95ee%5Cu4f60%5Cu80fd%5Cu8ba9%5Cu5e8f%5Cu5217%5Cu7684%5Cu5f97%5Cu5206%5Cu6700%5Cu5927%5Cu4e3a%5Cu591a%5Cu5c11%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cr%5Cn%23%23%20%5Cu8f93%5Cu5165%5Cu683c%5Cu5f0f%5Cuff1a%5Cr%5Cn%5Cu9996%5Cu884c%5Cu4e24%5Cu4e2a%5Cu6574%5Cu6570%24n%2Cm%281%3C%3Dn%2Cm%3C%3D5000%29%24%5Cuff0c%5Cu4e0b%5Cu4e00%5Cu884c%5Cu6709%24n%24%5Cu4e2a%5Cu6570%20%24a%5B1%5D%2Ca%5B2%5D%2C%5Cu2026%2Ca%5Bn%5D%24%5Cuff0c%5Cu518d%5Cu4e0b%5Cu4e00%5Cu884c%5Cu6709%24m%24%5Cu4e2a%5Cu6570%24b%5B1%5D%2Cb%5B2%5D%5Cu2026%2Cb%5Bm%5D%24%20%5Cu5373%5Cu4e3a%5Cu574f%5Cu8d28%5Cu6570%5Cu3002%5Cuff08%5Cu4fdd%5Cu8bc1%5Cu6240%5Cu6709%5Cu6570%5Cu4e0d%5Cu8d85%5Cu8fc7%2410%5E9%24%5Cuff0c%20%24b%24%20%5Cu6570%5Cu5217%5Cu90fd%5Cu4e3a%5Cu8d28%5Cu6570%5Cu4e14%5Cu5355%5Cu8c03%5Cu9012%5Cu589e%5Cuff09%5Cr%5Cn%5Cr%5Cn%23%23%20%5Cu8f93%5Cu51fa%5Cu683c%5Cu5f0f%5Cuff1a%5Cr%5Cn%5Cu4e00%5Cu4e2a%5Cu6570%20%24s%24%20%5Cuff0c%5Cu5c31%5Cu662f%5Cu4f60%5Cu80fd%5Cu8ba9%5Cu5e8f%5Cu5217%5Cu5f97%5Cu5206%5Cu7684%5Cu6700%5Cu5927%5Cu503c%5Cu3002%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A142%2C%22totalAccepted%22%3A45%2C%22pid%22%3A%22CF402D%22%2C%22title%22%3A%22Upgrading%20Array%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A49439%2C%22title%22%3A%22%5Cu7ffb%5Cu8bd1%22%2C%22forum%22%3A%7B%22id%22%3A11030%2C%22name%22%3A%22CF402D%20Upgrading%20Array%22%2C%22slug%22%3A%22CF402D%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P1993%22%2C%22title%22%3A%22%5Cu5c0fK%5Cu7684%5Cu519c%5Cu573a%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P2294%22%2C%22title%22%3A%22%5BHNOI2005%5D%5Cu72e1%5Cu733e%5Cu7684%5Cu5546%5Cu4eba%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22CF645E%22%2C%22title%22%3A%22Intellectual%20Inquiry%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF402E%22%2C%22title%22%3A%22Strictly%20Positive%20Matrix%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF65D%22%2C%22title%22%3A%22Harry%20Potter%20and%20the%20Sorting%20Hat%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Upgrading%20Array%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573306449;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Upgrading Array</h1>
<h2>题意翻译</h2>
<div>给一个有n个数 a[1],a[2],…,a[n] 的数列打分，你认为 b[1],b[2]…,b[m] 是不好的质数。定义这个序列的分值为各个数的分值之和，设 x 的分值为 f(x)，f(x)=f(x/p)+k （p 为 x 的最小质因子；若 p 为不好的质数， k 取 −1 ，否则 k 取 +1 ； f(1)=0 ）。
你想让序列的分值更大，可以反复进行一项操作：$a[1],a[2],a[3],...,a[i](i<=n)$ 的每个数除以它们的最大公约数。请问你能让序列的得分最大为多少。
## 输入格式：
首行两个整数$n,m(1<=n,m<=5000)$，下一行有$n$个数 $a[1],a[2],…,a[n]$，再下一行有$m$个数$b[1],b[2]…,b[m]$ 即为坏质数。（保证所有数不超过$10^9$， $b$ 数列都为质数且单调递增）
## 输出格式：
一个数 $s$ ，就是你能让序列得分的最大值。</div>
<h2>题目描述</h2>
<div>You have an array of positive integers $ a[1],a[2],...,a[n] $ and a set of bad prime numbers $ b_{1},b_{2},...,b_{m} $ . The prime numbers that do not occur in the set $ b $ are considered good. The beauty of array $ a $ is the sum ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF402D/aea4eb2d17c24d3a2d1067454589473b9ea01095.png), where function $ f(s) $ is determined as follows:
- $ f(1)=0 $ ;
- Let's assume that $ p $ is the minimum prime divisor of $ s $ . If $ p $ is a good prime, then ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF402D/8afcd99c67c49a2d759fe9b7228c1f8d0e576b6a.png), otherwise ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF402D/cce5ab868ac31145b115c9c6f231d8d473326030.png).
You are allowed to perform an arbitrary (probably zero) number of operations to improve array $ a $ . The operation of improvement is the following sequence of actions:
- Choose some number $ r $ ( $ 1<=r<=n $ ) and calculate the value $ g $ = GCD( $ a[1],a[2],...,a[r] $ ).
- Apply the assignments: ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF402D/7da2ca9ebcb0c358dd26347b51043ad8cf29f6d1.png), ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF402D/41a62953f2b193f6f57ad5e6aa04be0947094a88.png), $ ... $ , ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF402D/7947630aa7cab27f0ca3ac2ef6955b60eb99bea8.png).
What is the maximum beauty of the array you can get?</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains two integers $ n $ and $ m $ ( $ 1<=n,m<=5000 $ ) showing how many numbers are in the array and how many bad prime numbers there are.
The second line contains $ n $ space-separated integers $ a[1],a[2],...,a[n] $ ( $ 1<=a[i]<=10^{9} $ ) — array $ a $ . The third line contains $ m $ space-separated integers $ b_{1},b_{2},...,b_{m} $ ( $ 2<=b_{1}&lt;b_{2}&lt;...&lt;b_{m}<=10^{9} $ ) — the set of bad prime numbers.</div>
<h3>输出格式</h3>
<br />
<div>Print a single integer — the answer to the problem.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>5 2
4 20 34 10 10
2 5
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>-2
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>4 5
2 4 8 16
3 5 7 11 17
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>10
</code></pre>
<h2>说明</h2>
<div>Note that the answer to the problem can be negative.
The GCD( $ x_{1} $ , $ x_{2} $ , ..., $ x_{k} $ ) is the maximum positive integer that divides each $ x_{i} $ .</div>
</article>
</div>
</div>
</body>
</html>
