<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Minimal Diameter Forest - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573401514:Lj3KaKSAeIRi/6qITGwQPhXaVL99Qcx7z/mnVjsoJxQ=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22You%20are%20given%20a%20forest%20%5Cu2014%20an%20undirected%20graph%20with%20%24%20n%20%24%20vertices%20such%20that%20each%20its%20connected%20component%20is%20a%20tree.%5Cn%5CnThe%20diameter%20%28aka%20%5C%22longest%20shortest%20path%5C%22%29%20of%20a%20connected%20undirected%20graph%20is%20the%20maximum%20number%20of%20edges%20in%20the%20shortest%20path%20between%20any%20pair%20of%20its%20vertices.%5Cn%5CnYou%20task%20is%20to%20add%20some%20edges%20%28possibly%20zero%29%20to%20the%20graph%20so%20that%20it%20becomes%20a%20tree%20and%20the%20diameter%20of%20the%20tree%20is%20minimal%20possible.%5Cn%5CnIf%20there%20are%20multiple%20correct%20answers%2C%20print%20any%20of%20them.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20two%20integers%20%24%20n%20%24%20and%20%24%20m%20%24%20%28%20%24%201%20%5C%5Cle%20n%20%5C%5Cle%201000%20%24%20%2C%20%24%200%20%5C%5Cle%20m%20%5C%5Cle%20n%20-%201%20%24%20%29%20%5Cu2014%20the%20number%20of%20vertices%20of%20the%20graph%20and%20the%20number%20of%20edges%2C%20respectively.%5Cn%5CnEach%20of%20the%20next%20%24%20m%20%24%20lines%20contains%20two%20integers%20%24%20v%20%24%20and%20%24%20u%20%24%20%28%20%24%201%20%5C%5Cle%20v%2C%20u%20%5C%5Cle%20n%20%24%20%2C%20%24%20v%20%5C%5Cne%20u%20%24%20%29%20%5Cu2014%20the%20descriptions%20of%20the%20edges.%5Cn%5CnIt%20is%20guaranteed%20that%20the%20given%20graph%20is%20a%20forest.%22%2C%22outputFormat%22%3A%22In%20the%20first%20line%20print%20the%20diameter%20of%20the%20resulting%20tree.%5Cn%5CnEach%20of%20the%20next%20%24%20%28n%20-%201%29%20-%20m%20%24%20lines%20should%20contain%20two%20integers%20%24%20v%20%24%20and%20%24%20u%20%24%20%28%20%24%201%20%5C%5Cle%20v%2C%20u%20%5C%5Cle%20n%20%24%20%2C%20%24%20v%20%5C%5Cne%20u%20%24%20%29%20%5Cu2014%20the%20descriptions%20of%20the%20added%20edges.%5Cn%5CnThe%20resulting%20graph%20should%20be%20a%20tree%20and%20its%20diameter%20should%20be%20minimal%20possible.%5Cn%5CnFor%20%24%20m%20%3D%20n%20-%201%20%24%20no%20edges%20are%20added%2C%20thus%20the%20output%20consists%20of%20a%20single%20integer%20%5Cu2014%20diameter%20of%20the%20given%20tree.%5Cn%5CnIf%20there%20are%20multiple%20correct%20answers%2C%20print%20any%20of%20them.%22%2C%22samples%22%3A%5B%5B%22%5Cn4%202%5Cn1%202%5Cn2%203%5Cn%22%2C%22%5Cn2%5Cn4%202%5Cn%22%5D%2C%5B%22%5Cn2%200%5Cn%22%2C%22%5Cn1%5Cn1%202%5Cn%22%5D%2C%5B%22%5Cn3%202%5Cn1%203%5Cn2%203%5Cn%22%2C%22%5Cn2%5Cn%22%5D%5D%2C%22hint%22%3A%22In%20the%20first%20example%20adding%20edges%20%281%2C%204%29%20or%20%283%2C%204%29%20will%20lead%20to%20a%20total%20diameter%20of%203.%20Adding%20edge%20%282%2C%204%29%2C%20however%2C%20will%20make%20it%202.%5Cn%5CnEdge%20%281%2C%202%29%20is%20the%20only%20option%20you%20have%20for%20the%20second%20example.%20The%20diameter%20is%201.%5Cn%5CnYou%20can%27t%20add%20any%20edges%20in%20the%20third%20example.%20The%20diameter%20is%20already%202.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F1092%5C%2FE%22%2C%22id%22%3A%221092E%22%7D%2C%22translation%22%3A%22%5Cu7ed9%5Cu5b9a%5Cu4e00%5Cu5f20%5Cu56fe%5Cuff08%5Cu4e0d%5Cu4e00%5Cu5b9a%5Cu8054%5Cu901a%5Cuff09%5Cuff0c%5Cu56fe%5Cu4e2d%5Cu6bcf%5Cu4e00%5Cu4e2a%5Cu8054%5Cu901a%5Cu5757%5Cu90fd%5Cu662f%5Cu4e00%5Cu68f5%5Cu6811%5Cuff0c%5Cu6211%5Cu4eec%5Cu79f0%5Cu8fd9%5Cu6837%5Cu7684%5Cu56fe%5Cu4e3a%5Cu201c%5Cu68ee%5Cu6797%5Cu201d%5Cr%5Cn%5Cr%5Cn%5Cu8fd9%5Cu5f20%5Cu56fe%5Cu6709%24n%28%5C%5Cleq%201000%29%24%5Cu4e2a%5Cu70b9%5Cuff0c%24m%28%5C%5Cleq%20n-1%29%24%5Cu6761%5Cu8fb9%5Cuff0c%5Cu73b0%5Cu5728%5Cu7ed9%5Cu8fd9%5Cu5f20%5Cu56fe%5Cu518d%5Cu6dfb%5Cu52a0%24n-m-1%24%5Cu6761%5Cu8fb9%5Cuff0c%5Cu4f7f%5Cu5f97%5Cu8fd9%5Cu5f20%5Cu56fe%5Cu53d8%5Cu6210%5Cu4e00%5Cu68f5%5Cu6811%5Cuff0c%5Cu4e14%5Cu6811%5Cu7684%5Cu76f4%5Cu5f84%5Cu6700%5Cu5c0f%5Cr%5Cn%5Cr%5Cn%5Cu8981%5Cu6c42%5Cu8f93%5Cu51fa%5Cu6700%5Cu5c0f%5Cu7684%5Cu76f4%5Cu5f84%5Cu957f%5Cu5ea6%5Cu548c%5Cu8fde%5Cu8fb9%5Cu65b9%5Cu6848%5Cr%5Cn%5Cr%5Cn%5Cu5982%5Cu679c%5Cu4f60%5Cu4e0d%5Cu6e05%5Cu695a%5Cu6811%5Cu7684%5Cu76f4%5Cu5f84%5Cu662f%5Cu4ec0%5Cu4e48%5Cuff0c%5Cu4e0b%5Cu9762%5Cu7ed9%5Cu51fa%5Cu201c%5Cu76f4%5Cu5f84%5Cu201d%5Cu7684%5Cu5b9a%5Cu4e49%5Cuff1a%5Cu6811%5Cu4e0a%5Cu6240%5Cu6709%5Cu7b80%5Cu5355%5Cu8def%5Cu5f84%5Cu4e2d%5Cu6700%5Cu957f%5Cu7684%5Cu90a3%5Cu6761%5Cu53eb%5Cu201c%5Cu76f4%5Cu5f84%5Cu201d%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A72%2C%22totalAccepted%22%3A20%2C%22pid%22%3A%22CF1092E%22%2C%22title%22%3A%22Minimal%20Diameter%20Forest%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P2480%22%2C%22title%22%3A%22%5BSDOI2010%5D%5Cu53e4%5Cu4ee3%5Cu732a%5Cu6587%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P3451%22%2C%22title%22%3A%22%5BPOI2007%5DATR-Tourist%20Attractions%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P4180%22%2C%22title%22%3A%22%5Cu3010%5Cu6a21%5Cu677f%5Cu3011%5Cu4e25%5Cu683c%5Cu6b21%5Cu5c0f%5Cu751f%5Cu6210%5Cu6811%5BBJWC2010%5D%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22AT2336%22%2C%22title%22%3A%22Flags%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22AT%22%7D%2C%7B%22pid%22%3A%22CF1093E%22%2C%22title%22%3A%22Intersection%20of%20Permutations%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Minimal%20Diameter%20Forest%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Minimal Diameter Forest</h1>
<h2>题意翻译</h2>
<div>给定一张图（不一定联通），图中每一个联通块都是一棵树，我们称这样的图为“森林”
这张图有$n(\leq 1000)$个点，$m(\leq n-1)$条边，现在给这张图再添加$n-m-1$条边，使得这张图变成一棵树，且树的直径最小
要求输出最小的直径长度和连边方案
如果你不清楚树的直径是什么，下面给出“直径”的定义：树上所有简单路径中最长的那条叫“直径”</div>
<h2>题目描述</h2>
<div>You are given a forest — an undirected graph with $ n $ vertices such that each its connected component is a tree.
The diameter (aka "longest shortest path") of a connected undirected graph is the maximum number of edges in the shortest path between any pair of its vertices.
You task is to add some edges (possibly zero) to the graph so that it becomes a tree and the diameter of the tree is minimal possible.
If there are multiple correct answers, print any of them.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains two integers $ n $ and $ m $ ( $ 1 \le n \le 1000 $ , $ 0 \le m \le n - 1 $ ) — the number of vertices of the graph and the number of edges, respectively.
Each of the next $ m $ lines contains two integers $ v $ and $ u $ ( $ 1 \le v, u \le n $ , $ v \ne u $ ) — the descriptions of the edges.
It is guaranteed that the given graph is a forest.</div>
<h3>输出格式</h3>
<br />
<div>In the first line print the diameter of the resulting tree.
Each of the next $ (n - 1) - m $ lines should contain two integers $ v $ and $ u $ ( $ 1 \le v, u \le n $ , $ v \ne u $ ) — the descriptions of the added edges.
The resulting graph should be a tree and its diameter should be minimal possible.
For $ m = n - 1 $ no edges are added, thus the output consists of a single integer — diameter of the given tree.
If there are multiple correct answers, print any of them.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>
4 2
1 2
2 3
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>
2
4 2
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>
2 0
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>
1
1 2
</code></pre>
<h3>输入样例 #3</h3>
<pre><code>
3 2
1 3
2 3
</code></pre>
<h3>输出样例 #3</h3>
<pre><code>
2
</code></pre>
<h2>说明</h2>
<div>In the first example adding edges (1, 4) or (3, 4) will lead to a total diameter of 3. Adding edge (2, 4), however, will make it 2.
Edge (1, 2) is the only option you have for the second example. The diameter is 1.
You can't add any edges in the third example. The diameter is already 2.</div>
</article>
</div>
</div>
</body>
</html>
