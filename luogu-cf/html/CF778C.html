<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Peterson Polyglot - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573397786:8dVlkTz07HQJMFPnBdg2//jd/IpSaq3TWBQYXmFcndI=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Peterson%20loves%20to%20learn%20new%20languages%2C%20but%20his%20favorite%20hobby%20is%20making%20new%20ones.%20Language%20is%20a%20set%20of%20words%2C%20and%20word%20is%20a%20sequence%20of%20lowercase%20Latin%20letters.%5Cn%5CnPeterson%20makes%20new%20language%20every%20morning.%20It%20is%20difficult%20task%20to%20store%20the%20whole%20language%2C%20so%20Peterson%20have%20invented%20new%20data%20structure%20for%20storing%20his%20languages%20which%20is%20called%20broom.%20Broom%20is%20rooted%20tree%20with%20edges%20marked%20with%20letters.%20Initially%20broom%20is%20represented%20by%20the%20only%20vertex%20%5Cu2014%20the%20root%20of%20the%20broom.%20When%20Peterson%20wants%20to%20add%20new%20word%20to%20the%20language%20he%20stands%20at%20the%20root%20and%20processes%20the%20letters%20of%20new%20word%20one%20by%20one.%20Consider%20that%20Peterson%20stands%20at%20the%20vertex%20%24%20u%20%24%20.%20If%20there%20is%20an%20edge%20from%20%24%20u%20%24%20marked%20with%20current%20letter%2C%20Peterson%20goes%20through%20this%20edge.%20Otherwise%20Peterson%20adds%20new%20edge%20from%20%24%20u%20%24%20to%20the%20new%20vertex%20%24%20v%20%24%20%2C%20marks%20it%20with%20the%20current%20letter%20and%20goes%20through%20the%20new%20edge.%20Size%20of%20broom%20is%20the%20number%20of%20vertices%20in%20it.%5Cn%5CnIn%20the%20evening%20after%20working%20day%20Peterson%20can%27t%20understand%20the%20language%20he%20made%20this%20morning.%20It%20is%20too%20difficult%20for%20bored%20Peterson%20and%20he%20tries%20to%20make%20it%20simpler.%20Simplification%20of%20the%20language%20is%20the%20process%20of%20erasing%20some%20letters%20from%20some%20words%20of%20this%20language.%20Formally%2C%20Peterson%20takes%20some%20positive%20integer%20%24%20p%20%24%20and%20erases%20%24%20p%20%24%20-th%20letter%20from%20all%20the%20words%20of%20this%20language%20having%20length%20at%20least%20%24%20p%20%24%20.%20Letters%20in%20words%20are%20indexed%20starting%20by%201.%20Peterson%20considers%20that%20simplification%20should%20change%20at%20least%20one%20word%2C%20i.e.%20there%20has%20to%20be%20at%20least%20one%20word%20of%20length%20at%20least%20%24%20p%20%24%20.%20Peterson%20tries%20to%20make%20his%20language%20as%20simple%20as%20possible%2C%20so%20he%20wants%20to%20choose%20%24%20p%20%24%20such%20that%20the%20size%20of%20the%20broom%20for%20his%20simplified%20language%20is%20as%20small%20as%20possible.%5Cn%5CnPeterson%20is%20pretty%20annoyed%20with%20this%20task%20so%20he%20asks%20you%20for%20help.%20Write%20a%20program%20to%20find%20the%20smallest%20possible%20size%20of%20the%20broom%20and%20integer%20%24%20p%20%24%20.%22%2C%22inputFormat%22%3A%22The%20first%20line%20of%20input%20contains%20integer%20%24%20n%20%24%20%28%20%24%202%3C%3Dn%3C%3D3%5Cu00b710%5E%7B5%7D%20%24%20%29%20%5Cu2014%20the%20size%20of%20the%20broom.%5Cn%5CnNext%20%24%20n-1%20%24%20lines%20describe%20the%20broom%3A%20%24%20i%20%24%20-th%20of%20them%20contains%20integers%20%24%20u_%7Bi%7D%20%24%20%2C%20%24%20v_%7Bi%7D%20%24%20and%20letter%20%24%20x_%7Bi%7D%20%24%20%5Cu2014%20describing%20the%20edge%20from%20%24%20u_%7Bi%7D%20%24%20to%20%24%20v_%7Bi%7D%20%24%20marked%20with%20letter%20%24%20x_%7Bi%7D%20%24%20.%5Cn%5CnVertices%20are%20numbered%20from%201%20to%20%24%20n%20%24%20.%20All%20%24%20x_%7Bi%7D%20%24%20are%20lowercase%20latin%20letters.%20Vertex%201%20is%20the%20root%20of%20the%20broom.%5Cn%5CnEdges%20describe%20correct%20broom%20which%20is%20made%20from%20Peterson%27s%20language.%22%2C%22outputFormat%22%3A%22The%20first%20line%20of%20output%20should%20contain%20the%20minimum%20possible%20size%20of%20the%20broom%20after%20its%20simplification.%20The%20second%20line%20of%20output%20should%20contain%20integer%20%24%20p%20%24%20to%20choose.%20If%20there%20are%20several%20suitable%20%24%20p%20%24%20values%2C%20print%20the%20smallest%20one.%22%2C%22samples%22%3A%5B%5B%225%5Cn1%202%20c%5Cn2%203%20a%5Cn3%204%20t%5Cn2%205%20t%5Cn%22%2C%223%5Cn2%5Cn%22%5D%2C%5B%2216%5Cn1%202%20o%5Cn2%203%20f%5Cn1%204%20p%5Cn4%205%20i%5Cn5%206%20e%5Cn6%207%20c%5Cn7%208%20e%5Cn4%209%20r%5Cn9%2010%20e%5Cn10%2011%20t%5Cn11%2012%20t%5Cn12%2013%20y%5Cn10%2014%20f%5Cn14%2015%20i%5Cn15%2016%20x%5Cn%22%2C%2212%5Cn2%5Cn%22%5D%5D%2C%22hint%22%3A%22%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF778C%5C%2Ff15fa0cc8758e6866285fb29653e592b9e8e324d.png%29%5Cn%5CnBroom%20from%20the%20second%20sample%20test%20can%20be%20built%20using%20language%20%5C%22piece%5C%22%2C%20%5C%22of%5C%22%2C%20%5C%22pie%5C%22%2C%20%5C%22pretty%5C%22%2C%20%5C%22prefix%5C%22.%20Its%20simplification%20with%20%24%20p%3D2%20%24%20obtains%20the%20language%20of%20words%20%5C%22pece%5C%22%2C%20%5C%22o%5C%22%2C%20%5C%22pe%5C%22%2C%20%5C%22petty%5C%22%2C%20%5C%22pefix%5C%22.%20This%20language%20gives%20us%20the%20broom%20with%20minimum%20possible%20size.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B4000%5D%2C%22memory%22%3A%5B512000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F778%5C%2FC%22%2C%22id%22%3A%22778C%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A7%2C%22totalAccepted%22%3A6%2C%22pid%22%3A%22CF778C%22%2C%22title%22%3A%22Peterson%20Polyglot%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Peterson%20Polyglot%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Peterson Polyglot</h1>
<h2>题目描述</h2>
<div>Peterson loves to learn new languages, but his favorite hobby is making new ones. Language is a set of words, and word is a sequence of lowercase Latin letters.
Peterson makes new language every morning. It is difficult task to store the whole language, so Peterson have invented new data structure for storing his languages which is called broom. Broom is rooted tree with edges marked with letters. Initially broom is represented by the only vertex — the root of the broom. When Peterson wants to add new word to the language he stands at the root and processes the letters of new word one by one. Consider that Peterson stands at the vertex $ u $ . If there is an edge from $ u $ marked with current letter, Peterson goes through this edge. Otherwise Peterson adds new edge from $ u $ to the new vertex $ v $ , marks it with the current letter and goes through the new edge. Size of broom is the number of vertices in it.
In the evening after working day Peterson can't understand the language he made this morning. It is too difficult for bored Peterson and he tries to make it simpler. Simplification of the language is the process of erasing some letters from some words of this language. Formally, Peterson takes some positive integer $ p $ and erases $ p $ -th letter from all the words of this language having length at least $ p $ . Letters in words are indexed starting by 1. Peterson considers that simplification should change at least one word, i.e. there has to be at least one word of length at least $ p $ . Peterson tries to make his language as simple as possible, so he wants to choose $ p $ such that the size of the broom for his simplified language is as small as possible.
Peterson is pretty annoyed with this task so he asks you for help. Write a program to find the smallest possible size of the broom and integer $ p $ .</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line of input contains integer $ n $ ( $ 2<=n<=3·10^{5} $ ) — the size of the broom.
Next $ n-1 $ lines describe the broom: $ i $ -th of them contains integers $ u_{i} $ , $ v_{i} $ and letter $ x_{i} $ — describing the edge from $ u_{i} $ to $ v_{i} $ marked with letter $ x_{i} $ .
Vertices are numbered from 1 to $ n $ . All $ x_{i} $ are lowercase latin letters. Vertex 1 is the root of the broom.
Edges describe correct broom which is made from Peterson's language.</div>
<h3>输出格式</h3>
<br />
<div>The first line of output should contain the minimum possible size of the broom after its simplification. The second line of output should contain integer $ p $ to choose. If there are several suitable $ p $ values, print the smallest one.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>5
1 2 c
2 3 a
3 4 t
2 5 t
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>3
2
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>16
1 2 o
2 3 f
1 4 p
4 5 i
5 6 e
6 7 c
7 8 e
4 9 r
9 10 e
10 11 t
11 12 t
12 13 y
10 14 f
14 15 i
15 16 x
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>12
2
</code></pre>
<h2>说明</h2>
<div>![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF778C/f15fa0cc8758e6866285fb29653e592b9e8e324d.png)
Broom from the second sample test can be built using language "piece", "of", "pie", "pretty", "prefix". Its simplification with $ p=2 $ obtains the language of words "pece", "o", "pe", "petty", "pefix". This language gives us the broom with minimum possible size.</div>
</article>
</div>
</div>
</body>
</html>
