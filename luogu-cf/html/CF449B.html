<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Jzzhu and Cities - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573394199:OH0RvcPP516lgq2D1YRU5Gxf02b/KAbKGKqhXAjONdI=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%22%2C%22description%22%3A%22Jzzhu%20is%20the%20president%20of%20country%20A.%20There%20are%20%24%20n%20%24%20cities%20numbered%20from%20%24%201%20%24%20to%20%24%20n%20%24%20in%20his%20country.%20City%20%24%201%20%24%20is%20the%20capital%20of%20A.%20Also%20there%20are%20%24%20m%20%24%20roads%20connecting%20the%20cities.%20One%20can%20go%20from%20city%20%24%20u_%7Bi%7D%20%24%20to%20%24%20v_%7Bi%7D%20%24%20%28and%20vise%20versa%29%20using%20the%20%24%20i%20%24%20-th%20road%2C%20the%20length%20of%20this%20road%20is%20%24%20x_%7Bi%7D%20%24%20.%20Finally%2C%20there%20are%20%24%20k%20%24%20train%20routes%20in%20the%20country.%20One%20can%20use%20the%20%24%20i%20%24%20-th%20train%20route%20to%20go%20from%20capital%20of%20the%20country%20to%20city%20%24%20s_%7Bi%7D%20%24%20%28and%20vise%20versa%29%2C%20the%20length%20of%20this%20route%20is%20%24%20y_%7Bi%7D%20%24%20.%5Cn%5CnJzzhu%20doesn%27t%20want%20to%20waste%20the%20money%20of%20the%20country%2C%20so%20he%20is%20going%20to%20close%20some%20of%20the%20train%20routes.%20Please%20tell%20Jzzhu%20the%20maximum%20number%20of%20the%20train%20routes%20which%20can%20be%20closed%20under%20the%20following%20condition%3A%20the%20length%20of%20the%20shortest%20path%20from%20every%20city%20to%20the%20capital%20mustn%27t%20change.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20three%20integers%20%24%20n%2Cm%2Ck%20%24%20%24%20%282%3C%3Dn%3C%3D10%5E%7B5%7D%3B%5Cu00a01%3C%3Dm%3C%3D3%5Cu00b710%5E%7B5%7D%3B%5Cu00a01%3C%3Dk%3C%3D10%5E%7B5%7D%29%20%24%20.%5Cn%5CnEach%20of%20the%20next%20%24%20m%20%24%20lines%20contains%20three%20integers%20%24%20u_%7Bi%7D%2Cv_%7Bi%7D%2Cx_%7Bi%7D%20%24%20%24%20%281%3C%3Du_%7Bi%7D%2Cv_%7Bi%7D%3C%3Dn%3B%5Cu00a0u_%7Bi%7D%5Cu2260v_%7Bi%7D%3B%5Cu00a01%3C%3Dx_%7Bi%7D%3C%3D10%5E%7B9%7D%29%20%24%20.%5Cn%5CnEach%20of%20the%20next%20%24%20k%20%24%20lines%20contains%20two%20integers%20%24%20s_%7Bi%7D%20%24%20and%20%24%20y_%7Bi%7D%20%24%20%24%20%282%3C%3Ds_%7Bi%7D%3C%3Dn%3B%5Cu00a01%3C%3Dy_%7Bi%7D%3C%3D10%5E%7B9%7D%29%20%24%20.%5Cn%5CnIt%20is%20guaranteed%20that%20there%20is%20at%20least%20one%20way%20from%20every%20city%20to%20the%20capital.%20Note%2C%20that%20there%20can%20be%20multiple%20roads%20between%20two%20cities.%20Also%2C%20there%20can%20be%20multiple%20routes%20going%20to%20the%20same%20city%20from%20the%20capital.%22%2C%22outputFormat%22%3A%22Output%20a%20single%20integer%20representing%20the%20maximum%20number%20of%20the%20train%20routes%20which%20can%20be%20closed.%22%2C%22samples%22%3A%5B%5B%225%205%203%5Cn1%202%201%5Cn2%203%202%5Cn1%203%203%5Cn3%204%204%5Cn1%205%205%5Cn3%205%5Cn4%205%5Cn5%205%5Cn%22%2C%222%5Cn%22%5D%2C%5B%222%202%203%5Cn1%202%202%5Cn2%201%203%5Cn2%201%5Cn2%202%5Cn2%203%5Cn%22%2C%222%5Cn%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F449%5C%2FB%22%2C%22id%22%3A%22449B%22%7D%2C%22translation%22%3A%22%23%23%20%5Cu9898%5Cu610f%5Cu7b80%5Cu8ff0%5Cn%24n%24%20%5Cu4e2a%5Cu70b9%5Cuff0c%24m%24%20%5Cu6761%5Cu5e26%5Cu6743%5Cu8fb9%5Cu7684%5Cu65e0%5Cu5411%5Cu56fe%5Cuff0c%5Cu53e6%5Cu5916%5Cu8fd8%5Cu6709%24k%24%20%5Cu6761%5Cu7279%5Cu6b8a%5Cu8fb9%5Cuff0c%5Cu6bcf%5Cu6761%5Cu8fb9%5Cu8fde%5Cu63a5%241%24%20%5Cu548c%24i%24%20%5Cu3002%5Cn%5Cn%5Cu95ee%5Cu6700%5Cu591a%5Cu53ef%5Cu4ee5%5Cu5220%5Cu9664%5Cu8fd9%24k%24%20%5Cu6761%5Cu8fb9%5Cu4e2d%5Cu7684%5Cu591a%5Cu5c11%5Cu6761%5Cuff0c%5Cu4f7f%5Cu5f97%5Cu6bcf%5Cu4e2a%5Cu70b9%5Cu5230%241%24%20%5Cu7684%5Cu6700%5Cu77ed%5Cu8ddd%5Cu79bb%5Cu4e0d%5Cu53d8%5Cu3002%5Cn%5Cn%23%23%20%5Cu8f93%5Cu5165%5Cn%5Cu7b2c%5Cu4e00%5Cu884c3%5Cu4e2a%5Cu6570%5Cu5b57%24n%2Cm%2Ck%24%20%5Cn%5Cn%5Cu4e0b%5Cu9762%24m%24%20%5Cu884c%5Cuff0c%5Cu6bcf%5Cu884c3%5Cu4e2a%5Cu6570%5Cu5b57%24u_i%2Cv_i%2Cx_i%28u_i%5C%5Cnot%3D%20v_i%29%24%20%5Cn%5Cn%5Cu518d%5Cu4e0b%5Cu9762%24k%24%20%5Cu884c%5Cuff0c%5Cu6bcf%5Cu884c%5Cu4e24%5Cu4e2a%5Cu6570%5Cu5b57%24s_i%2Cy_i%24%20%5Cuff0c%5Cu4ee3%5Cu8868%5Cu8fde%5Cu63a5%241-s%24%20%5Cu7684%5Cu8fb9%5Cuff0c%5Cu6743%5Cu503c%5Cu4e3a%24y_i%24%20%5Cn%23%23%20%5Cu6570%5Cu636e%5Cu8303%5Cu56f4%5Cn%241%20%5Cu2264%20u_i%2Cv_i%2Cs_i%20%5Cu2264n%20%5Cu2264%2010%5E5%24%20%5Cn%5Cn%241%20%5Cu2264%20k%20%5Cu2264%2010%5E5%24%20%5Cn%5Cn%241%20%5Cu2264%20m%20%5Cu2264%203%5C%5Ctimes%2010%5E5%24%20%5Cn%5Cn%241%20%5Cu2264%20x_i%2Cy_i%20%5Cu2264%2010%5E9%24%5Cn%5Cn%5Cu611f%5Cu8c22%40wmxwmx%20%5Cu63d0%5Cu4f9b%5Cu7684%5Cu7ffb%5Cu8bd1%20%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A640%2C%22totalAccepted%22%3A141%2C%22pid%22%3A%22CF449B%22%2C%22title%22%3A%22Jzzhu%20and%20Cities%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A36294%2C%22title%22%3A%22%5Cu9898%5Cu610f%5Cu7b80%5Cu8ff0%22%2C%22forum%22%3A%7B%22id%22%3A10859%2C%22name%22%3A%22CF449B%20Jzzhu%20and%20Cities%22%2C%22slug%22%3A%22CF449B%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P2486%22%2C%22title%22%3A%22%5BSDOI2011%5D%5Cu67d3%5Cu8272%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P3953%22%2C%22title%22%3A%22%5Cu901b%5Cu516c%5Cu56ed%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22CF938D%22%2C%22title%22%3A%22Buy%20a%20Ticket%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1051F%22%2C%22title%22%3A%22The%20Shortest%20Statement%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1076D%22%2C%22title%22%3A%22Edge%20Deletion%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Jzzhu%20and%20Cities%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573306449;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Jzzhu and Cities</h1>
<h2>题意翻译</h2>
<div>## 题意简述
$n$ 个点，$m$ 条带权边的无向图，另外还有$k$ 条特殊边，每条边连接$1$ 和$i$ 。
问最多可以删除这$k$ 条边中的多少条，使得每个点到$1$ 的最短距离不变。
## 输入
第一行3个数字$n,m,k$
下面$m$ 行，每行3个数字$u_i,v_i,x_i(u_i\not= v_i)$
再下面$k$ 行，每行两个数字$s_i,y_i$ ，代表连接$1-s$ 的边，权值为$y_i$
## 数据范围
$1 ≤ u_i,v_i,s_i ≤n ≤ 10^5$
$1 ≤ k ≤ 10^5$
$1 ≤ m ≤ 3\times 10^5$
$1 ≤ x_i,y_i ≤ 10^9$
感谢@wmxwmx 提供的翻译 </div>
<h2>题目描述</h2>
<div>Jzzhu is the president of country A. There are $ n $ cities numbered from $ 1 $ to $ n $ in his country. City $ 1 $ is the capital of A. Also there are $ m $ roads connecting the cities. One can go from city $ u_{i} $ to $ v_{i} $ (and vise versa) using the $ i $ -th road, the length of this road is $ x_{i} $ . Finally, there are $ k $ train routes in the country. One can use the $ i $ -th train route to go from capital of the country to city $ s_{i} $ (and vise versa), the length of this route is $ y_{i} $ .
Jzzhu doesn't want to waste the money of the country, so he is going to close some of the train routes. Please tell Jzzhu the maximum number of the train routes which can be closed under the following condition: the length of the shortest path from every city to the capital mustn't change.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains three integers $ n,m,k $ $ (2<=n<=10^{5}; 1<=m<=3·10^{5}; 1<=k<=10^{5}) $ .
Each of the next $ m $ lines contains three integers $ u_{i},v_{i},x_{i} $ $ (1<=u_{i},v_{i}<=n; u_{i}≠v_{i}; 1<=x_{i}<=10^{9}) $ .
Each of the next $ k $ lines contains two integers $ s_{i} $ and $ y_{i} $ $ (2<=s_{i}<=n; 1<=y_{i}<=10^{9}) $ .
It is guaranteed that there is at least one way from every city to the capital. Note, that there can be multiple roads between two cities. Also, there can be multiple routes going to the same city from the capital.</div>
<h3>输出格式</h3>
<br />
<div>Output a single integer representing the maximum number of the train routes which can be closed.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>5 5 3
1 2 1
2 3 2
1 3 3
3 4 4
1 5 5
3 5
4 5
5 5
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>2
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>2 2 3
1 2 2
2 1 3
2 1
2 2
2 3
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>2
</code></pre>
</article>
</div>
</div>
</body>
</html>
