<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Cowslip Collections - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573396351:WN7CT3F749M436qpPJPjK+7H+Isj1qq2vLWb5SgV/JY=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22In%20an%20attempt%20to%20make%20peace%20with%20the%20Mischievious%20Mess%20Makers%2C%20Bessie%20and%20Farmer%20John%20are%20planning%20to%20plant%20some%20flower%20gardens%20to%20complement%20the%20lush%2C%20grassy%20fields%20of%20Bovinia.%20As%20any%20good%20horticulturist%20knows%2C%20each%20garden%20they%20plant%20must%20have%20the%20exact%20same%20arrangement%20of%20flowers.%20Initially%2C%20Farmer%20John%20has%20%24%20n%20%24%20different%20species%20of%20flowers%20he%20can%20plant%2C%20with%20%24%20a_%7Bi%7D%20%24%20flowers%20of%20the%20%24%20i%20%24%20-th%20species.%5Cn%5CnOn%20each%20of%20the%20next%20%24%20q%20%24%20days%2C%20Farmer%20John%20will%20receive%20a%20batch%20of%20flowers%20of%20a%20new%20species.%20On%20day%20%24%20j%20%24%20%2C%20he%20will%20receive%20%24%20c_%7Bj%7D%20%24%20flowers%20of%20the%20same%20species%2C%20but%20of%20a%20different%20species%20from%20those%20Farmer%20John%20already%20has.%5Cn%5CnFarmer%20John%2C%20knowing%20the%20right%20balance%20between%20extravagance%20and%20minimalism%2C%20wants%20exactly%20%24%20k%20%24%20species%20of%20flowers%20to%20be%20used.%20Furthermore%2C%20to%20reduce%20waste%2C%20each%20flower%20of%20the%20%24%20k%20%24%20species%20Farmer%20John%20chooses%20must%20be%20planted%20in%20some%20garden.%20And%20each%20of%20the%20gardens%20must%20be%20identical%3B%20that%20is%20to%20say%20that%20each%20of%20the%20%24%20k%20%24%20chosen%20species%20should%20have%20an%20equal%20number%20of%20flowers%20in%20each%20garden.%20As%20Farmer%20John%20is%20a%20proponent%20of%20national%20equality%2C%20he%20would%20like%20to%20create%20the%20greatest%20number%20of%20gardens%20possible.%5Cn%5CnAfter%20receiving%20flowers%20on%20each%20of%20these%20%24%20q%20%24%20days%2C%20Farmer%20John%20would%20like%20to%20know%20the%20sum%2C%20over%20all%20possible%20choices%20of%20%24%20k%20%24%20species%2C%20of%20the%20maximum%20number%20of%20gardens%20he%20could%20create.%20Since%20this%20could%20be%20a%20large%20number%2C%20you%20should%20output%20your%20result%20modulo%20%24%2010%5E%7B9%7D%2B7%20%24%20.%22%2C%22inputFormat%22%3A%22The%20first%20line%20of%20the%20input%20contains%20three%20integers%20%24%20n%20%24%20%2C%20%24%20k%20%24%20and%20%24%20q%20%24%20%28%20%24%201%3C%3Dk%3C%3Dn%3C%3D100000%20%24%20%2C%20%24%201%3C%3Dq%3C%3D100000%20%24%20%29.%5Cn%5CnThe%20%24%20i%20%24%20-th%20%28%20%24%201%3C%3Di%3C%3Dn%20%24%20%29%20of%20the%20next%20%24%20n%20%24%20lines%20of%20the%20input%20contains%20an%20integer%20%24%20a_%7Bi%7D%20%24%20%28%20%24%201%3C%3Da_%7Bi%7D%3C%3D1000000%20%24%20%29%2C%20the%20number%20of%20flowers%20of%20species%20%24%20i%20%24%20Farmer%20John%20has%20initially.%5Cn%5CnThe%20%24%20j%20%24%20-th%20%28%20%24%201%3C%3Dj%3C%3Dq%20%24%20%29%20of%20the%20next%20%24%20q%20%24%20lines%20of%20the%20input%20contains%20an%20integer%20%24%20c_%7Bj%7D%20%24%20%28%20%24%201%3C%3Dc_%7Bj%7D%3C%3D1000000%20%24%20%29%2C%20the%20number%20of%20flowers%20of%20a%20new%20species%20Farmer%20John%20receives%20on%20day%20%24%20j%20%24%20.%22%2C%22outputFormat%22%3A%22After%20each%20of%20the%20%24%20q%20%24%20days%2C%20output%20the%20sum%20of%20the%20maximum%20possible%20number%20of%20gardens%2C%20where%20the%20sum%20is%20taken%20over%20all%20possible%20choices%20of%20%24%20k%20%24%20species%2C%20modulo%20%24%2010%5E%7B9%7D%2B7%20%24%20.%22%2C%22samples%22%3A%5B%5B%223%203%202%5Cn4%5Cn6%5Cn9%5Cn8%5Cn6%5Cn%22%2C%225%5Cn16%5Cn%22%5D%2C%5B%224%201%202%5Cn6%5Cn5%5Cn4%5Cn3%5Cn2%5Cn1%5Cn%22%2C%2220%5Cn21%5Cn%22%5D%5D%2C%22hint%22%3A%22In%20the%20first%20sample%20case%2C%20after%20the%20first%20day%20Farmer%20John%20has%20%24%20%284%2C6%2C9%2C8%29%20%24%20of%20each%20type%20of%20flower%2C%20and%20%24%20k%3D3%20%24%20.%5Cn%5CnChoosing%20%24%20%284%2C6%2C8%29%20%24%20lets%20him%20make%20%24%202%20%24%20gardens%2C%20each%20with%20%24%20%282%2C3%2C4%29%20%24%20of%20each%20flower%2C%20respectively.%20Choosing%20%24%20%284%2C6%2C9%29%20%24%20%2C%20%24%20%284%2C9%2C8%29%20%24%20and%20%24%20%286%2C9%2C8%29%20%24%20each%20only%20let%20him%20make%20one%20garden%2C%20since%20there%20is%20no%20number%20of%20gardens%20that%20each%20species%20can%20be%20evenly%20split%20into.%20So%20the%20sum%20over%20all%20choices%20of%20%24%20k%3D3%20%24%20flowers%20is%20%24%202%2B1%2B1%2B1%3D5%20%24%20.%5Cn%5CnAfter%20the%20second%20day%2C%20Farmer%20John%20has%20%24%20%284%2C6%2C9%2C8%2C6%29%20%24%20of%20each%20flower.%20The%20sum%20over%20all%20choices%20is%20%24%201%2B2%2B2%2B1%2B1%2B2%2B2%2B3%2B1%2B1%3D16%20%24%20.%5Cn%5CnIn%20the%20second%20sample%20case%2C%20%24%20k%3D1%20%24%20.%20With%20%24%20x%20%24%20flowers%20Farmer%20John%20can%20make%20%24%20x%20%24%20gardens.%20So%20the%20answers%20to%20the%20queries%20are%20%24%206%2B5%2B4%2B3%2B2%3D20%20%24%20and%20%24%206%2B5%2B4%2B3%2B2%2B1%3D21%20%24%20.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B8000%5D%2C%22memory%22%3A%5B512000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F645%5C%2FF%22%2C%22id%22%3A%22645F%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A2%2C%22totalAccepted%22%3A2%2C%22pid%22%3A%22CF645F%22%2C%22title%22%3A%22Cowslip%20Collections%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Cowslip%20Collections%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Cowslip Collections</h1>
<h2>题目描述</h2>
<div>In an attempt to make peace with the Mischievious Mess Makers, Bessie and Farmer John are planning to plant some flower gardens to complement the lush, grassy fields of Bovinia. As any good horticulturist knows, each garden they plant must have the exact same arrangement of flowers. Initially, Farmer John has $ n $ different species of flowers he can plant, with $ a_{i} $ flowers of the $ i $ -th species.
On each of the next $ q $ days, Farmer John will receive a batch of flowers of a new species. On day $ j $ , he will receive $ c_{j} $ flowers of the same species, but of a different species from those Farmer John already has.
Farmer John, knowing the right balance between extravagance and minimalism, wants exactly $ k $ species of flowers to be used. Furthermore, to reduce waste, each flower of the $ k $ species Farmer John chooses must be planted in some garden. And each of the gardens must be identical; that is to say that each of the $ k $ chosen species should have an equal number of flowers in each garden. As Farmer John is a proponent of national equality, he would like to create the greatest number of gardens possible.
After receiving flowers on each of these $ q $ days, Farmer John would like to know the sum, over all possible choices of $ k $ species, of the maximum number of gardens he could create. Since this could be a large number, you should output your result modulo $ 10^{9}+7 $ .</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line of the input contains three integers $ n $ , $ k $ and $ q $ ( $ 1<=k<=n<=100000 $ , $ 1<=q<=100000 $ ).
The $ i $ -th ( $ 1<=i<=n $ ) of the next $ n $ lines of the input contains an integer $ a_{i} $ ( $ 1<=a_{i}<=1000000 $ ), the number of flowers of species $ i $ Farmer John has initially.
The $ j $ -th ( $ 1<=j<=q $ ) of the next $ q $ lines of the input contains an integer $ c_{j} $ ( $ 1<=c_{j}<=1000000 $ ), the number of flowers of a new species Farmer John receives on day $ j $ .</div>
<h3>输出格式</h3>
<br />
<div>After each of the $ q $ days, output the sum of the maximum possible number of gardens, where the sum is taken over all possible choices of $ k $ species, modulo $ 10^{9}+7 $ .</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>3 3 2
4
6
9
8
6
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>5
16
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>4 1 2
6
5
4
3
2
1
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>20
21
</code></pre>
<h2>说明</h2>
<div>In the first sample case, after the first day Farmer John has $ (4,6,9,8) $ of each type of flower, and $ k=3 $ .
Choosing $ (4,6,8) $ lets him make $ 2 $ gardens, each with $ (2,3,4) $ of each flower, respectively. Choosing $ (4,6,9) $ , $ (4,9,8) $ and $ (6,9,8) $ each only let him make one garden, since there is no number of gardens that each species can be evenly split into. So the sum over all choices of $ k=3 $ flowers is $ 2+1+1+1=5 $ .
After the second day, Farmer John has $ (4,6,9,8,6) $ of each flower. The sum over all choices is $ 1+2+2+1+1+2+2+3+1+1=16 $ .
In the second sample case, $ k=1 $ . With $ x $ flowers Farmer John can make $ x $ gardens. So the answers to the queries are $ 6+5+4+3+2=20 $ and $ 6+5+4+3+2+1=21 $ .</div>
</article>
</div>
</div>
</body>
</html>
