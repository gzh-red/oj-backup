<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Employment - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573403344:YCrCsrlGFEahw/uoLehwVoxVlNpDxhNRuV6vUHm+eWQ=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Two%20large%20companies%20%5C%22Cecsi%5C%22%20and%20%5C%22Poca%20Pola%5C%22%20are%20fighting%20against%20each%20other%20for%20a%20long%20time.%20In%20order%20to%20overcome%20their%20competitor%2C%20%5C%22Poca%20Pola%5C%22%20started%20a%20super%20secret%20project%2C%20for%20which%20it%20has%20total%20%24%20n%20%24%20vacancies%20in%20all%20of%20their%20offices.%20After%20many%20tests%20and%20interviews%20%24%20n%20%24%20candidates%20were%20selected%20and%20the%20only%20thing%20left%20was%20their%20employment.%5Cn%5CnBecause%20all%20candidates%20have%20the%20same%20skills%2C%20it%20doesn%27t%20matter%20where%20each%20of%20them%20will%20work.%20That%20is%20why%20the%20company%20decided%20to%20distribute%20candidates%20between%20workplaces%20so%20that%20the%20total%20distance%20between%20home%20and%20workplace%20over%20all%20candidates%20is%20minimal.%5Cn%5CnIt%20is%20well%20known%20that%20Earth%20is%20round%2C%20so%20it%20can%20be%20described%20as%20a%20circle%2C%20and%20all%20%24%20m%20%24%20cities%20on%20Earth%20can%20be%20described%20as%20points%20on%20this%20circle.%20All%20cities%20are%20enumerated%20from%20%24%201%20%24%20to%20%24%20m%20%24%20so%20that%20for%20each%20%24%20i%20%24%20%28%20%24%201%20%5C%5Cle%20i%20%5C%5Cle%20m%20-%201%20%24%20%29%20cities%20with%20indexes%20%24%20i%20%24%20and%20%24%20i%20%2B%201%20%24%20are%20neighbors%20and%20cities%20with%20indexes%20%24%201%20%24%20and%20%24%20m%20%24%20are%20neighbors%20as%20well.%20People%20can%20move%20only%20along%20the%20circle.%20The%20distance%20between%20any%20two%20cities%20equals%20to%20minimal%20number%20of%20transitions%20between%20neighboring%20cities%20you%20have%20to%20perform%20to%20get%20from%20one%20city%20to%20another.%20In%20particular%2C%20the%20distance%20between%20the%20city%20and%20itself%20equals%20%24%200%20%24%20.%5Cn%5CnThe%20%5C%22Poca%20Pola%5C%22%20vacancies%20are%20located%20at%20offices%20in%20cities%20%24%20a_1%2C%20a_2%2C%20%5C%5Cldots%2C%20a_n%20%24%20.%20The%20candidates%20live%20in%20cities%20%24%20b_1%2C%20b_2%2C%20%5C%5Cldots%2C%20b_n%20%24%20.%20It%20is%20possible%20that%20some%20vacancies%20are%20located%20in%20the%20same%20cities%20and%20some%20candidates%20live%20in%20the%20same%20cities.%5Cn%5CnThe%20%5C%22Poca%20Pola%5C%22%20managers%20are%20too%20busy%20with%20super%20secret%20project%2C%20so%20you%20were%20asked%20to%20help%20%5C%22Poca%20Pola%5C%22%20to%20distribute%20candidates%20between%20workplaces%2C%20so%20that%20the%20sum%20of%20the%20distance%20between%20home%20and%20workplace%20over%20all%20candidates%20is%20minimum%20possible.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20two%20integers%20%24%20m%20%24%20and%20%24%20n%20%24%20%28%20%24%201%20%5C%5Cle%20m%20%5C%5Cle%2010%5E9%20%24%20%2C%20%24%201%20%5C%5Cle%20n%20%5C%5Cle%20200%5C%5C%2C000%20%24%20%29%20%5Cu2014%20the%20number%20of%20cities%20on%20Earth%20and%20the%20number%20of%20vacancies.%5Cn%5CnThe%20second%20line%20contains%20%24%20n%20%24%20integers%20%24%20a_1%2C%20a_2%2C%20a_3%2C%20%5C%5Cldots%2C%20a_n%20%24%20%28%20%24%201%20%5C%5Cle%20a_i%20%5C%5Cle%20m%20%24%20%29%20%5Cu2014%20the%20cities%20where%20vacancies%20are%20located.%5Cn%5CnThe%20third%20line%20contains%20%24%20n%20%24%20integers%20%24%20b_1%2C%20b_2%2C%20b_3%2C%20%5C%5Cldots%2C%20b_n%20%24%20%28%20%24%201%20%5C%5Cle%20b_i%20%5C%5Cle%20m%20%24%20%29%20%5Cu2014%20the%20cities%20where%20the%20candidates%20live.%22%2C%22outputFormat%22%3A%22The%20first%20line%20should%20contain%20the%20minimum%20total%20distance%20between%20home%20and%20workplace%20over%20all%20candidates.%5Cn%5CnThe%20second%20line%20should%20contain%20%24%20n%20%24%20different%20integers%20from%20%24%201%20%24%20to%20%24%20n%20%24%20.%20The%20%24%20i%20%24%20-th%20of%20them%20should%20be%20the%20index%20of%20candidate%20that%20should%20work%20at%20%24%20i%20%24%20-th%20workplace.%22%2C%22samples%22%3A%5B%5B%22%5Cn10%203%5Cn1%205%205%5Cn10%204%206%5Cn%22%2C%22%5Cn3%5Cn1%202%203%20%22%5D%2C%5B%22%5Cn10%203%5Cn1%204%208%5Cn8%203%206%5Cn%22%2C%22%5Cn4%5Cn2%203%201%20%22%5D%5D%2C%22hint%22%3A%22In%20the%20first%20example%2C%20the%20distance%20between%20each%20candidate%20and%20his%20workplace%20equals%20to%20%24%201%20%24%20%28from%20%24%201%20%24%20to%20%24%2010%20%24%20%2C%20from%20%24%204%20%24%20to%20%24%205%20%24%20and%20from%20%24%206%20%24%20to%20%24%205%20%24%20%29.%5Cn%5CnIn%20the%20second%20example%3A%5Cn%5Cn-%20The%20second%20candidate%20works%20at%20first%20workplace%2C%20the%20distance%20between%20cities%20%24%203%20%24%20and%20%24%201%20%24%20equals%20to%20%24%202%20%24%20.%5Cn-%20The%20third%20candidate%20works%20at%20second%20workplace%2C%20the%20distance%20between%20cities%20%24%206%20%24%20and%20%24%204%20%24%20equals%20to%20%24%202%20%24%20.%5Cn-%20The%20first%20candidate%20works%20at%20third%20workplace%2C%20the%20distance%20between%20cities%20%24%208%20%24%20and%20%24%208%20%24%20equals%20to%20%24%200%20%24%20.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B512000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F1214%5C%2FF%22%2C%22id%22%3A%221214F%22%7D%2C%22translation%22%3A%22%5Cu6709%5Cu4e00%5Cu4e2a%5Cu957f%5Cu5ea6%5Cu4e3a%24m%24%5Cu7684%5Cu73af%5Cu5f62%5Cu94c1%5Cu8def%5Cuff0c%5Cu5728%5Cu94c1%5Cu8def%5Cu7684%5Cu67d0%5Cu4e9b%5Cu70b9%5Cu4e0a%5Cu6709%5Cu4e00%5Cu4e9b%5Cu4eba%5Cu6216%5Cu4e00%5Cu4e9b%5Cu529e%5Cu516c%5Cu5ba4%5Cuff0c%5Cu73b0%5Cu5728%5Cu8981%5Cu6c42%5Cu7ed9%5Cu6bcf%5Cu4e2a%5Cu4eba%5Cu914d%5Cu4e00%5Cu4e2a%5Cu529e%5Cu516c%5Cu5ba4%5Cuff0c%5Cu8ba9%5Cu6240%5Cu6709%5Cu4eba%5Cu7684%5Cu4e0a%5Cu73ed%5Cu8def%5Cu7a0b%5Cu6700%5Cu77ed%5Cu3002%5Cu4eba%5Cu548c%5Cu529e%5Cu516c%5Cu5ba4%5Cu7684%5Cu6570%5Cu91cf%5Cu90fd%5Cu662f%24n%24%5Cu3002%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A54%2C%22totalAccepted%22%3A18%2C%22pid%22%3A%22CF1214F%22%2C%22title%22%3A%22Employment%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P1447%22%2C%22title%22%3A%22%5BNOI2010%5D%5Cu80fd%5Cu91cf%5Cu91c7%5Cu96c6%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P2331%22%2C%22title%22%3A%22%5BSCOI2005%5D%5Cu6700%5Cu5927%5Cu5b50%5Cu77e9%5Cu9635%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22CF827D%22%2C%22title%22%3A%22Best%20Edge%20Weight%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22P4260%22%2C%22title%22%3A%22%5BCode%2B%233%5D%5Cu535a%5Cu5f08%5Cu8bba%5Cu4e0e%5Cu6982%5Cu7387%5Cu7edf%5Cu8ba1%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22CF1214A%22%2C%22title%22%3A%22Optimal%20Currency%20Exchange%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Employment%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Employment</h1>
<h2>题意翻译</h2>
<div>有一个长度为$m$的环形铁路，在铁路的某些点上有一些人或一些办公室，现在要求给每个人配一个办公室，让所有人的上班路程最短。人和办公室的数量都是$n$。</div>
<h2>题目描述</h2>
<div>Two large companies "Cecsi" and "Poca Pola" are fighting against each other for a long time. In order to overcome their competitor, "Poca Pola" started a super secret project, for which it has total $ n $ vacancies in all of their offices. After many tests and interviews $ n $ candidates were selected and the only thing left was their employment.
Because all candidates have the same skills, it doesn't matter where each of them will work. That is why the company decided to distribute candidates between workplaces so that the total distance between home and workplace over all candidates is minimal.
It is well known that Earth is round, so it can be described as a circle, and all $ m $ cities on Earth can be described as points on this circle. All cities are enumerated from $ 1 $ to $ m $ so that for each $ i $ ( $ 1 \le i \le m - 1 $ ) cities with indexes $ i $ and $ i + 1 $ are neighbors and cities with indexes $ 1 $ and $ m $ are neighbors as well. People can move only along the circle. The distance between any two cities equals to minimal number of transitions between neighboring cities you have to perform to get from one city to another. In particular, the distance between the city and itself equals $ 0 $ .
The "Poca Pola" vacancies are located at offices in cities $ a_1, a_2, \ldots, a_n $ . The candidates live in cities $ b_1, b_2, \ldots, b_n $ . It is possible that some vacancies are located in the same cities and some candidates live in the same cities.
The "Poca Pola" managers are too busy with super secret project, so you were asked to help "Poca Pola" to distribute candidates between workplaces, so that the sum of the distance between home and workplace over all candidates is minimum possible.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains two integers $ m $ and $ n $ ( $ 1 \le m \le 10^9 $ , $ 1 \le n \le 200\,000 $ ) — the number of cities on Earth and the number of vacancies.
The second line contains $ n $ integers $ a_1, a_2, a_3, \ldots, a_n $ ( $ 1 \le a_i \le m $ ) — the cities where vacancies are located.
The third line contains $ n $ integers $ b_1, b_2, b_3, \ldots, b_n $ ( $ 1 \le b_i \le m $ ) — the cities where the candidates live.</div>
<h3>输出格式</h3>
<br />
<div>The first line should contain the minimum total distance between home and workplace over all candidates.
The second line should contain $ n $ different integers from $ 1 $ to $ n $ . The $ i $ -th of them should be the index of candidate that should work at $ i $ -th workplace.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>
10 3
1 5 5
10 4 6
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>
3
1 2 3 </code></pre>
<h3>输入样例 #2</h3>
<pre><code>
10 3
1 4 8
8 3 6
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>
4
2 3 1 </code></pre>
<h2>说明</h2>
<div>In the first example, the distance between each candidate and his workplace equals to $ 1 $ (from $ 1 $ to $ 10 $ , from $ 4 $ to $ 5 $ and from $ 6 $ to $ 5 $ ).
In the second example:
- The second candidate works at first workplace, the distance between cities $ 3 $ and $ 1 $ equals to $ 2 $ .
- The third candidate works at second workplace, the distance between cities $ 6 $ and $ 4 $ equals to $ 2 $ .
- The first candidate works at third workplace, the distance between cities $ 8 $ and $ 8 $ equals to $ 0 $ .</div>
</article>
</div>
</div>
</body>
</html>
