<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>MST Unification - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573401815:Wh3cm+wz/siAfwll16vDkQQOv2oc9EGKuZWtGKKZ/H4=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22You%20are%20given%20an%20undirected%20weighted%20connected%20graph%20with%20%24%20n%20%24%20vertices%20and%20%24%20m%20%24%20edges%20without%20loops%20and%20multiple%20edges.%5Cn%5CnThe%20%24%20i%20%24%20-th%20edge%20is%20%24%20e_i%20%3D%20%28u_i%2C%20v_i%2C%20w_i%29%20%24%20%3B%20the%20distance%20between%20vertices%20%24%20u_i%20%24%20and%20%24%20v_i%20%24%20along%20the%20edge%20%24%20e_i%20%24%20is%20%24%20w_i%20%24%20%28%20%24%201%20%5C%5Cle%20w_i%20%24%20%29.%20The%20graph%20is%20connected%2C%20i.%20e.%20for%20any%20pair%20of%20vertices%2C%20there%20is%20at%20least%20one%20path%20between%20them%20consisting%20only%20of%20edges%20of%20the%20given%20graph.%5Cn%5CnA%20minimum%20spanning%20tree%20%28MST%29%20in%20case%20of%20positive%20weights%20is%20a%20subset%20of%20the%20edges%20of%20a%20connected%20weighted%20undirected%20graph%20that%20connects%20all%20the%20vertices%20together%20and%20has%20minimum%20total%20cost%20among%20all%20such%20subsets%20%28total%20cost%20is%20the%20sum%20of%20costs%20of%20chosen%20edges%29.%5Cn%5CnYou%20can%20modify%20the%20given%20graph.%20The%20only%20operation%20you%20can%20perform%20is%20the%20following%3A%20increase%20the%20weight%20of%20some%20edge%20by%20%24%201%20%24%20.%20You%20can%20increase%20the%20weight%20of%20each%20edge%20multiple%20%28possibly%2C%20zero%29%20times.%5Cn%5CnSuppose%20that%20the%20initial%20MST%20cost%20is%20%24%20k%20%24%20.%20Your%20problem%20is%20to%20increase%20weights%20of%20some%20edges%20with%20minimum%20possible%20number%20of%20operations%20in%20such%20a%20way%20that%20the%20cost%20of%20MST%20in%20the%20obtained%20graph%20remains%20%24%20k%20%24%20%2C%20but%20MST%20is%20unique%20%28it%20means%20that%20there%20is%20only%20one%20way%20to%20choose%20MST%20in%20the%20obtained%20graph%29.%5Cn%5CnYour%20problem%20is%20to%20calculate%20the%20minimum%20number%20of%20operations%20required%20to%20do%20it.%22%2C%22inputFormat%22%3A%22The%20first%20line%20of%20the%20input%20contains%20two%20integers%20%24%20n%20%24%20and%20%24%20m%20%24%20%28%20%24%201%20%5C%5Cle%20n%20%5C%5Cle%202%20%5C%5Ccdot%2010%5E5%2C%20n%20-%201%20%5C%5Cle%20m%20%5C%5Cle%202%20%5C%5Ccdot%2010%5E5%20%24%20%29%20%5Cu2014%20the%20number%20of%20vertices%20and%20the%20number%20of%20edges%20in%20the%20initial%20graph.%5Cn%5CnThe%20next%20%24%20m%20%24%20lines%20contain%20three%20integers%20each.%20The%20%24%20i%20%24%20-th%20line%20contains%20the%20description%20of%20the%20%24%20i%20%24%20-th%20edge%20%24%20e_i%20%24%20.%20It%20is%20denoted%20by%20three%20integers%20%24%20u_i%2C%20v_i%20%24%20and%20%24%20w_i%20%24%20%28%20%24%201%20%5C%5Cle%20u_i%2C%20v_i%20%5C%5Cle%20n%2C%20u_i%20%5C%5Cne%20v_i%2C%201%20%5C%5Cle%20w%20%5C%5Cle%2010%5E9%20%24%20%29%2C%20where%20%24%20u_i%20%24%20and%20%24%20v_i%20%24%20are%20vertices%20connected%20by%20the%20%24%20i%20%24%20-th%20edge%20and%20%24%20w_i%20%24%20is%20the%20weight%20of%20this%20edge.%5Cn%5CnIt%20is%20guaranteed%20that%20the%20given%20graph%20doesn%27t%20contain%20loops%20and%20multiple%20edges%20%28i.e.%20for%20each%20%24%20i%20%24%20from%20%24%201%20%24%20to%20%24%20m%20%24%20%24%20u_i%20%5C%5Cne%20v_i%20%24%20and%20for%20each%20unordered%20pair%20of%20vertices%20%24%20%28u%2C%20v%29%20%24%20there%20is%20at%20most%20one%20edge%20connecting%20this%20pair%20of%20vertices%29.%20It%20is%20also%20guaranteed%20that%20the%20given%20graph%20is%20connected.%22%2C%22outputFormat%22%3A%22Print%20one%20integer%20%5Cu2014%20the%20minimum%20number%20of%20operations%20to%20unify%20MST%20of%20the%20initial%20graph%20without%20changing%20the%20cost%20of%20MST.%22%2C%22samples%22%3A%5B%5B%22%5Cn8%2010%5Cn1%202%201%5Cn2%203%202%5Cn2%204%205%5Cn1%204%202%5Cn6%203%203%5Cn6%201%203%5Cn3%205%202%5Cn3%207%201%5Cn4%208%201%5Cn6%202%204%5Cn%22%2C%22%5Cn1%5Cn%22%5D%2C%5B%22%5Cn4%203%5Cn2%201%203%5Cn4%203%204%5Cn2%204%201%5Cn%22%2C%22%5Cn0%5Cn%22%5D%2C%5B%22%5Cn3%203%5Cn1%202%201%5Cn2%203%202%5Cn1%203%203%5Cn%22%2C%22%5Cn0%5Cn%22%5D%2C%5B%22%5Cn3%203%5Cn1%202%201%5Cn2%203%203%5Cn1%203%203%5Cn%22%2C%22%5Cn1%5Cn%22%5D%2C%5B%22%5Cn1%200%5Cn%22%2C%22%5Cn0%5Cn%22%5D%2C%5B%22%5Cn5%206%5Cn1%202%202%5Cn2%203%201%5Cn4%205%203%5Cn2%204%202%5Cn1%204%202%5Cn1%205%203%5Cn%22%2C%22%5Cn2%5Cn%22%5D%5D%2C%22hint%22%3A%22The%20picture%20corresponding%20to%20the%20first%20example%3A%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF1108F%5C%2F0e263a00ca735dd5bb719bb03756b985166a7027.png%29%5Cn%5CnYou%20can%2C%20for%20example%2C%20increase%20weight%20of%20the%20edge%20%24%20%281%2C%206%29%20%24%20or%20%24%20%286%2C%203%29%20%24%20by%20%24%201%20%24%20to%20unify%20MST.%5Cn%5CnThe%20picture%20corresponding%20to%20the%20last%20example%3A%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF1108F%5C%2F3b58146df4c5be6d2405c28ffabd0f9fc53a7d4b.png%29%5Cn%5CnYou%20can%2C%20for%20example%2C%20increase%20weights%20of%20edges%20%24%20%281%2C%205%29%20%24%20and%20%24%20%282%2C%204%29%20%24%20by%20%24%201%20%24%20to%20unify%20MST.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B3000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F1108%5C%2FF%22%2C%22id%22%3A%221108F%22%7D%2C%22translation%22%3A%22%5Cu7ed9%5Cu5b9a%5Cu4e00%5Cu4e2a%5Cu6709n%5Cu4e2a%5Cu70b9%5Cuff0cm%5Cu6761%5Cu8fb9%5Cu7684%5Cu65e0%5Cu5411%5Cu8fde%5Cu901a%5Cu56fe%5Cuff0c%5Cu6bcf%5Cu6761%5Cu8fb9%5Cu6709%5Cu8fb9%5Cu6743%5Cu3002%5Cr%5Cn%5Cu5b9a%5Cu4e49%5Cu4e00%5Cu6b21%5Cu64cd%5Cu4f5c%5Cu4e3a%5Cuff1a%5Cu9009%5Cu62e9%5Cu4e00%5Cu6761%5Cu56fe%5Cu4e2d%5Cu7684%5Cu8fb9%5Cuff0c%5Cu5e76%5Cu5c06%5Cu5176%5Cu6743%5Cu503c%2B1%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu8bd5%5Cu6c42%5Cu6700%5Cu5c0f%5Cu7684%5Cu64cd%5Cu4f5c%5Cu6b21%5Cu6570%5Cuff0c%5Cu4f7f%5Cu5f97%5Cu64cd%5Cu4f5c%5Cu540e%5Cu7684%5Cu56fe%5Cu7684%5Cu6700%5Cu5c0f%5Cu751f%5Cu6210%5Cu6811%5Cu662f%5Cu552f%5Cu4e00%5Cu7684%5Cu3002%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A125%2C%22totalAccepted%22%3A71%2C%22pid%22%3A%22CF1108F%22%2C%22title%22%3A%22MST%20Unification%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P3688%22%2C%22title%22%3A%22%5BZJOI2017%5D%5Cu6811%5Cu72b6%5Cu6570%5Cu7ec4%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22CF1097D%22%2C%22title%22%3A%22Makoto%20and%20a%20Blackboard%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1098A%22%2C%22title%22%3A%22Sum%20in%20the%20tree%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1108D%22%2C%22title%22%3A%22Diverse%20Garland%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1245C%22%2C%22title%22%3A%22Constanze%27s%20Machine%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22MST%20Unification%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>MST Unification</h1>
<h2>题意翻译</h2>
<div>给定一个有n个点，m条边的无向连通图，每条边有边权。
定义一次操作为：选择一条图中的边，并将其权值+1。
试求最小的操作次数，使得操作后的图的最小生成树是唯一的。</div>
<h2>题目描述</h2>
<div>You are given an undirected weighted connected graph with $ n $ vertices and $ m $ edges without loops and multiple edges.
The $ i $ -th edge is $ e_i = (u_i, v_i, w_i) $ ; the distance between vertices $ u_i $ and $ v_i $ along the edge $ e_i $ is $ w_i $ ( $ 1 \le w_i $ ). The graph is connected, i. e. for any pair of vertices, there is at least one path between them consisting only of edges of the given graph.
A minimum spanning tree (MST) in case of positive weights is a subset of the edges of a connected weighted undirected graph that connects all the vertices together and has minimum total cost among all such subsets (total cost is the sum of costs of chosen edges).
You can modify the given graph. The only operation you can perform is the following: increase the weight of some edge by $ 1 $ . You can increase the weight of each edge multiple (possibly, zero) times.
Suppose that the initial MST cost is $ k $ . Your problem is to increase weights of some edges with minimum possible number of operations in such a way that the cost of MST in the obtained graph remains $ k $ , but MST is unique (it means that there is only one way to choose MST in the obtained graph).
Your problem is to calculate the minimum number of operations required to do it.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line of the input contains two integers $ n $ and $ m $ ( $ 1 \le n \le 2 \cdot 10^5, n - 1 \le m \le 2 \cdot 10^5 $ ) — the number of vertices and the number of edges in the initial graph.
The next $ m $ lines contain three integers each. The $ i $ -th line contains the description of the $ i $ -th edge $ e_i $ . It is denoted by three integers $ u_i, v_i $ and $ w_i $ ( $ 1 \le u_i, v_i \le n, u_i \ne v_i, 1 \le w \le 10^9 $ ), where $ u_i $ and $ v_i $ are vertices connected by the $ i $ -th edge and $ w_i $ is the weight of this edge.
It is guaranteed that the given graph doesn't contain loops and multiple edges (i.e. for each $ i $ from $ 1 $ to $ m $ $ u_i \ne v_i $ and for each unordered pair of vertices $ (u, v) $ there is at most one edge connecting this pair of vertices). It is also guaranteed that the given graph is connected.</div>
<h3>输出格式</h3>
<br />
<div>Print one integer — the minimum number of operations to unify MST of the initial graph without changing the cost of MST.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>
8 10
1 2 1
2 3 2
2 4 5
1 4 2
6 3 3
6 1 3
3 5 2
3 7 1
4 8 1
6 2 4
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>
1
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>
4 3
2 1 3
4 3 4
2 4 1
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>
0
</code></pre>
<h3>输入样例 #3</h3>
<pre><code>
3 3
1 2 1
2 3 2
1 3 3
</code></pre>
<h3>输出样例 #3</h3>
<pre><code>
0
</code></pre>
<h3>输入样例 #4</h3>
<pre><code>
3 3
1 2 1
2 3 3
1 3 3
</code></pre>
<h3>输出样例 #4</h3>
<pre><code>
1
</code></pre>
<h3>输入样例 #5</h3>
<pre><code>
1 0
</code></pre>
<h3>输出样例 #5</h3>
<pre><code>
0
</code></pre>
<h3>输入样例 #6</h3>
<pre><code>
5 6
1 2 2
2 3 1
4 5 3
2 4 2
1 4 2
1 5 3
</code></pre>
<h3>输出样例 #6</h3>
<pre><code>
2
</code></pre>
<h2>说明</h2>
<div>The picture corresponding to the first example: ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1108F/0e263a00ca735dd5bb719bb03756b985166a7027.png)
You can, for example, increase weight of the edge $ (1, 6) $ or $ (6, 3) $ by $ 1 $ to unify MST.
The picture corresponding to the last example: ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1108F/3b58146df4c5be6d2405c28ffabd0f9fc53a7d4b.png)
You can, for example, increase weights of edges $ (1, 5) $ and $ (2, 4) $ by $ 1 $ to unify MST.</div>
</article>
</div>
</div>
</body>
</html>
