<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Two Subsequences - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573390666:tbL176PJJqUFoHiug1S/anu2fkg2PlHJ+EvJK1rgkD4=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22On%20an%20IT%20lesson%20Valera%20studied%20data%20compression.%20The%20teacher%20told%20about%20a%20new%20method%2C%20which%20we%20shall%20now%20describe%20to%20you.%5Cn%5CnLet%20%24%20%7Ba_%7B1%7D%2Ca_%7B2%7D%2C...%2Ca_%7Bn%7D%7D%20%24%20be%20the%20given%20sequence%20of%20lines%20needed%20to%20be%20compressed.%20Here%20and%20below%20we%20shall%20assume%20that%20all%20lines%20are%20of%20the%20same%20length%20and%20consist%20only%20of%20the%20digits%20%24%200%20%24%20and%20%24%201%20%24%20.%20Let%27s%20define%20the%20compression%20function%3A%5Cn%5Cn-%20%24%20f%28%20%24%20empty%20sequence%20%24%20%29%3D%20%24%20empty%20string%5Cn-%20%24%20f%28s%29%3Ds%20%24%20.%5Cn-%20%24%20f%28s_%7B1%7D%2Cs_%7B2%7D%29%3D%20%24%20the%20smallest%20in%20length%20string%2C%20which%20has%20one%20of%20the%20prefixes%20equal%20to%20%24%20s_%7B1%7D%20%24%20and%20one%20of%20the%20suffixes%20equal%20to%20%24%20s_%7B2%7D%20%24%20.%20For%20example%2C%20%24%20f%28001%2C011%29%3D0011%20%24%20%2C%20%24%20f%28111%2C011%29%3D111011%20%24%20.%5Cn-%20%24%20f%28a_%7B1%7D%2Ca_%7B2%7D%2C...%2Ca_%7Bn%7D%29%3Df%28f%28a_%7B1%7D%2Ca_%7B2%7D%2Ca_%7Bn-1%7D%29%2Ca_%7Bn%7D%29%20%24%20.%20For%20example%2C%20%24%20f%28000%2C000%2C111%29%3Df%28f%28000%2C000%29%2C111%29%3Df%28000%2C111%29%3D000111%20%24%20.%5Cn%5CnValera%20faces%20a%20real%20challenge%3A%20he%20should%20divide%20the%20given%20sequence%20%24%20%7Ba_%7B1%7D%2Ca_%7B2%7D%2C...%2Ca_%7Bn%7D%7D%20%24%20into%20two%20subsequences%20%24%20%7Bb_%7B1%7D%2Cb_%7B2%7D%2C...%2Cb_%7Bk%7D%7D%20%24%20and%20%24%20%7Bc_%7B1%7D%2Cc_%7B2%7D%2C...%2Cc_%7Bm%7D%7D%20%24%20%2C%20%24%20m%2Bk%3Dn%20%24%20%2C%20so%20that%20the%20value%20of%20%24%20S%3D%7Cf%28b_%7B1%7D%2Cb_%7B2%7D%2C...%2Cb_%7Bk%7D%29%7C%2B%7Cf%28c_%7B1%7D%2Cc_%7B2%7D%2C...%2Cc_%7Bm%7D%29%7C%20%24%20took%20the%20minimum%20possible%20value.%20Here%20%24%20%7Cp%7C%20%24%20denotes%20the%20length%20of%20the%20string%20%24%20p%20%24%20.%5Cn%5CnNote%20that%20it%20is%20not%20allowed%20to%20change%20the%20relative%20order%20of%20lines%20in%20the%20subsequences.%20It%20is%20allowed%20to%20make%20one%20of%20the%20subsequences%20empty.%20Each%20string%20from%20the%20initial%20sequence%20should%20belong%20to%20exactly%20one%20subsequence.%20Elements%20of%20subsequences%20%24%20b%20%24%20and%20%24%20c%20%24%20don%27t%20have%20to%20be%20consecutive%20in%20the%20original%20sequence%20%24%20a%20%24%20%2C%20i.%20e.%20elements%20of%20%24%20b%20%24%20and%20%24%20c%20%24%20can%20alternate%20in%20%24%20a%20%24%20%28see%20samples%202%20and%203%29.%5Cn%5CnHelp%20Valera%20to%20find%20the%20minimum%20possible%20value%20of%20%24%20S%20%24%20.%22%2C%22inputFormat%22%3A%22The%20first%20line%20of%20input%20data%20contains%20an%20integer%20%24%20n%20%24%20%5Cu2014%20the%20number%20of%20strings%20%28%20%24%201%3C%3Dn%3C%3D2%5Cu00b710%5E%7B5%7D%20%24%20%29.%20Then%20on%20%24%20n%20%24%20lines%20follow%20elements%20of%20the%20sequence%20%5Cu2014%20strings%20whose%20lengths%20are%20from%20%24%201%20%24%20to%20%24%2020%20%24%20characters%2C%20consisting%20only%20of%20digits%20%24%200%20%24%20and%20%24%201%20%24%20.%20The%20%24%20i%2B1%20%24%20-th%20input%20line%20contains%20the%20%24%20i%20%24%20-th%20element%20of%20the%20sequence.%20Elements%20of%20the%20sequence%20are%20separated%20only%20by%20a%20newline.%20It%20is%20guaranteed%20that%20all%20lines%20have%20the%20same%20length.%22%2C%22outputFormat%22%3A%22Print%20a%20single%20number%20%5Cu2014%20the%20minimum%20possible%20value%20of%20%24%20S%20%24%20.%22%2C%22samples%22%3A%5B%5B%223%5Cn01%5Cn10%5Cn01%5Cn%22%2C%224%5Cn%22%5D%2C%5B%224%5Cn000%5Cn111%5Cn110%5Cn001%5Cn%22%2C%228%5Cn%22%5D%2C%5B%225%5Cn10101%5Cn01010%5Cn11111%5Cn01000%5Cn10010%5Cn%22%2C%2217%5Cn%22%5D%5D%2C%22hint%22%3A%22Detailed%20answers%20to%20the%20tests%3A%5Cn%5Cn-%20The%20best%20option%20is%20to%20make%20one%20of%20the%20subsequences%20empty%2C%20and%20the%20second%20one%20equal%20to%20the%20whole%20given%20sequence.%20%24%20%7Cf%2801%2C10%2C01%29%7C%3D%7Cf%28f%2801%2C10%29%2C01%29%7C%3D%7Cf%28010%2C01%29%7C%3D%7C0101%7C%3D4%20%24%20.%5Cn-%20The%20best%20option%20is%3A%20%24%20b%3D%7B000%2C001%7D%2Cc%3D%7B111%2C110%7D.%20%24%20%24%20S%3D%7Cf%28000%2C001%29%7C%2B%7Cf%28111%2C110%29%7C%3D%7C0001%7C%2B%7C1110%7C%3D8%20%24%20.%5Cn-%20The%20best%20option%20is%3A%20%24%20b%3D%7B10101%2C01010%2C01000%7D%2Cc%3D%7B11111%2C10010%7D.%20%24%20%24%20S%3D%7C10101000%7C%2B%7C111110010%7C%3D17%20%24%20.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F83%5C%2FE%22%2C%22id%22%3A%2283E%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A4%2C%22totalAccepted%22%3A3%2C%22pid%22%3A%22CF83E%22%2C%22title%22%3A%22Two%20Subsequences%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Two%20Subsequences%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573286098;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Two Subsequences</h1>
<h2>题目描述</h2>
<div>On an IT lesson Valera studied data compression. The teacher told about a new method, which we shall now describe to you.
Let $ {a_{1},a_{2},...,a_{n}} $ be the given sequence of lines needed to be compressed. Here and below we shall assume that all lines are of the same length and consist only of the digits $ 0 $ and $ 1 $ . Let's define the compression function:
- $ f( $ empty sequence $ )= $ empty string
- $ f(s)=s $ .
- $ f(s_{1},s_{2})= $ the smallest in length string, which has one of the prefixes equal to $ s_{1} $ and one of the suffixes equal to $ s_{2} $ . For example, $ f(001,011)=0011 $ , $ f(111,011)=111011 $ .
- $ f(a_{1},a_{2},...,a_{n})=f(f(a_{1},a_{2},a_{n-1}),a_{n}) $ . For example, $ f(000,000,111)=f(f(000,000),111)=f(000,111)=000111 $ .
Valera faces a real challenge: he should divide the given sequence $ {a_{1},a_{2},...,a_{n}} $ into two subsequences $ {b_{1},b_{2},...,b_{k}} $ and $ {c_{1},c_{2},...,c_{m}} $ , $ m+k=n $ , so that the value of $ S=|f(b_{1},b_{2},...,b_{k})|+|f(c_{1},c_{2},...,c_{m})| $ took the minimum possible value. Here $ |p| $ denotes the length of the string $ p $ .
Note that it is not allowed to change the relative order of lines in the subsequences. It is allowed to make one of the subsequences empty. Each string from the initial sequence should belong to exactly one subsequence. Elements of subsequences $ b $ and $ c $ don't have to be consecutive in the original sequence $ a $ , i. e. elements of $ b $ and $ c $ can alternate in $ a $ (see samples 2 and 3).
Help Valera to find the minimum possible value of $ S $ .</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line of input data contains an integer $ n $ — the number of strings ( $ 1<=n<=2·10^{5} $ ). Then on $ n $ lines follow elements of the sequence — strings whose lengths are from $ 1 $ to $ 20 $ characters, consisting only of digits $ 0 $ and $ 1 $ . The $ i+1 $ -th input line contains the $ i $ -th element of the sequence. Elements of the sequence are separated only by a newline. It is guaranteed that all lines have the same length.</div>
<h3>输出格式</h3>
<br />
<div>Print a single number — the minimum possible value of $ S $ .</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>3
01
10
01
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>4
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>4
000
111
110
001
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>8
</code></pre>
<h3>输入样例 #3</h3>
<pre><code>5
10101
01010
11111
01000
10010
</code></pre>
<h3>输出样例 #3</h3>
<pre><code>17
</code></pre>
<h2>说明</h2>
<div>Detailed answers to the tests:
- The best option is to make one of the subsequences empty, and the second one equal to the whole given sequence. $ |f(01,10,01)|=|f(f(01,10),01)|=|f(010,01)|=|0101|=4 $ .
- The best option is: $ b={000,001},c={111,110}. $ $ S=|f(000,001)|+|f(111,110)|=|0001|+|1110|=8 $ .
- The best option is: $ b={10101,01010,01000},c={11111,10010}. $ $ S=|10101000|+|111110010|=17 $ .</div>
</article>
</div>
</div>
</body>
</html>
