<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Character Swap (Hard Version) - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573403619:M9167pbSsqfjsL3CXP8ArXnyCVxrOOWfLQOP7lr9L2U=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22This%20problem%20is%20different%20from%20the%20easy%20version.%20In%20this%20version%20Ujan%20makes%20at%20most%20%24%202n%20%24%20swaps.%20In%20addition%2C%20%24%20k%20%5C%5Cle%201000%2C%20n%20%5C%5Cle%2050%20%24%20and%20it%20is%20necessary%20to%20print%20swaps%20themselves.%20You%20can%20hack%20this%20problem%20if%20you%20solve%20it.%20But%20you%20can%20hack%20the%20previous%20problem%20only%20if%20you%20solve%20both%20problems.%5Cn%5CnAfter%20struggling%20and%20failing%20many%20times%2C%20Ujan%20decided%20to%20try%20to%20clean%20up%20his%20house%20again.%20He%20decided%20to%20get%20his%20strings%20in%20order%20first.%5Cn%5CnUjan%20has%20two%20distinct%20strings%20%24%20s%20%24%20and%20%24%20t%20%24%20of%20length%20%24%20n%20%24%20consisting%20of%20only%20of%20lowercase%20English%20characters.%20He%20wants%20to%20make%20them%20equal.%20Since%20Ujan%20is%20lazy%2C%20he%20will%20perform%20the%20following%20operation%20at%20most%20%24%202n%20%24%20times%3A%20he%20takes%20two%20positions%20%24%20i%20%24%20and%20%24%20j%20%24%20%28%20%24%201%20%5C%5Cle%20i%2Cj%20%5C%5Cle%20n%20%24%20%2C%20the%20values%20%24%20i%20%24%20and%20%24%20j%20%24%20can%20be%20equal%20or%20different%29%2C%20and%20swaps%20the%20characters%20%24%20s_i%20%24%20and%20%24%20t_j%20%24%20.%5Cn%5CnUjan%27s%20goal%20is%20to%20make%20the%20strings%20%24%20s%20%24%20and%20%24%20t%20%24%20equal.%20He%20does%20not%20need%20to%20minimize%20the%20number%20of%20performed%20operations%3A%20any%20sequence%20of%20operations%20of%20length%20%24%202n%20%24%20or%20shorter%20is%20suitable.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20a%20single%20integer%20%24%20k%20%24%20%28%20%24%201%20%5C%5Cleq%20k%20%5C%5Cleq%201000%20%24%20%29%2C%20the%20number%20of%20test%20cases.%5Cn%5CnFor%20each%20of%20the%20test%20cases%2C%20the%20first%20line%20contains%20a%20single%20integer%20%24%20n%20%24%20%28%20%24%202%20%5C%5Cleq%20n%20%5C%5Cleq%2050%20%24%20%29%2C%20the%20length%20of%20the%20strings%20%24%20s%20%24%20and%20%24%20t%20%24%20.%5Cn%5CnEach%20of%20the%20next%20two%20lines%20contains%20the%20strings%20%24%20s%20%24%20and%20%24%20t%20%24%20%2C%20each%20having%20length%20exactly%20%24%20n%20%24%20.%20The%20strings%20consist%20only%20of%20lowercase%20English%20letters.%20It%20is%20guaranteed%20that%20strings%20are%20different.%22%2C%22outputFormat%22%3A%22For%20each%20test%20case%2C%20output%20%5C%22Yes%5C%22%20if%20Ujan%20can%20make%20the%20two%20strings%20equal%20with%20at%20most%20%24%202n%20%24%20operations%20and%20%5C%22No%5C%22%20otherwise.%20You%20can%20print%20each%20letter%20in%20any%20case%20%28upper%20or%20lower%29.%5Cn%5CnIn%20the%20case%20of%20%5C%22Yes%5C%22%20print%20%24%20m%20%24%20%28%20%24%201%20%5C%5Cle%20m%20%5C%5Cle%202n%20%24%20%29%20on%20the%20next%20line%2C%20where%20%24%20m%20%24%20is%20the%20number%20of%20swap%20operations%20to%20make%20the%20strings%20equal.%20Then%20print%20%24%20m%20%24%20lines%2C%20each%20line%20should%20contain%20two%20integers%20%24%20i%2C%20j%20%24%20%28%20%24%201%20%5C%5Cle%20i%2C%20j%20%5C%5Cle%20n%20%24%20%29%20meaning%20that%20Ujan%20swaps%20%24%20s_i%20%24%20and%20%24%20t_j%20%24%20during%20the%20corresponding%20operation.%20You%20do%20not%20need%20to%20minimize%20the%20number%20of%20operations.%20Any%20sequence%20of%20length%20not%20more%20than%20%24%202n%20%24%20is%20suitable.%22%2C%22samples%22%3A%5B%5B%22%5Cn4%5Cn5%5Cnsouse%5Cnhouhe%5Cn3%5Cncat%5Cndog%5Cn2%5Cnaa%5Cnaz%5Cn3%5Cnabc%5Cnbca%5Cn%22%2C%22%5CnYes%5Cn1%5Cn1%204%5CnNo%5CnNo%5CnYes%5Cn3%5Cn1%202%5Cn3%201%5Cn2%203%5Cn%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F1243%5C%2FB2%22%2C%22id%22%3A%221243B2%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A13%2C%22totalAccepted%22%3A11%2C%22pid%22%3A%22CF1243B2%22%2C%22title%22%3A%22Character%20Swap%20%28Hard%20Version%29%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Character%20Swap%20%28Hard%20Version%29%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Character Swap (Hard Version)</h1>
<h2>题目描述</h2>
<div>This problem is different from the easy version. In this version Ujan makes at most $ 2n $ swaps. In addition, $ k \le 1000, n \le 50 $ and it is necessary to print swaps themselves. You can hack this problem if you solve it. But you can hack the previous problem only if you solve both problems.
After struggling and failing many times, Ujan decided to try to clean up his house again. He decided to get his strings in order first.
Ujan has two distinct strings $ s $ and $ t $ of length $ n $ consisting of only of lowercase English characters. He wants to make them equal. Since Ujan is lazy, he will perform the following operation at most $ 2n $ times: he takes two positions $ i $ and $ j $ ( $ 1 \le i,j \le n $ , the values $ i $ and $ j $ can be equal or different), and swaps the characters $ s_i $ and $ t_j $ .
Ujan's goal is to make the strings $ s $ and $ t $ equal. He does not need to minimize the number of performed operations: any sequence of operations of length $ 2n $ or shorter is suitable.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains a single integer $ k $ ( $ 1 \leq k \leq 1000 $ ), the number of test cases.
For each of the test cases, the first line contains a single integer $ n $ ( $ 2 \leq n \leq 50 $ ), the length of the strings $ s $ and $ t $ .
Each of the next two lines contains the strings $ s $ and $ t $ , each having length exactly $ n $ . The strings consist only of lowercase English letters. It is guaranteed that strings are different.</div>
<h3>输出格式</h3>
<br />
<div>For each test case, output "Yes" if Ujan can make the two strings equal with at most $ 2n $ operations and "No" otherwise. You can print each letter in any case (upper or lower).
In the case of "Yes" print $ m $ ( $ 1 \le m \le 2n $ ) on the next line, where $ m $ is the number of swap operations to make the strings equal. Then print $ m $ lines, each line should contain two integers $ i, j $ ( $ 1 \le i, j \le n $ ) meaning that Ujan swaps $ s_i $ and $ t_j $ during the corresponding operation. You do not need to minimize the number of operations. Any sequence of length not more than $ 2n $ is suitable.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>
4
5
souse
houhe
3
cat
dog
2
aa
az
3
abc
bca
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>
Yes
1
1 4
No
No
Yes
3
1 2
3 1
2 3
</code></pre>
</article>
</div>
</div>
</body>
</html>
