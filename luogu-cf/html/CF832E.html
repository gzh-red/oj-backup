<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Vasya and Shifts - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573398387:mK7pqL7l9zcSblE1GvcUb7kr3JqntWYugPIaFm2cBoU=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Vasya%20has%20a%20set%20of%20%24%204n%20%24%20strings%20of%20equal%20length%2C%20consisting%20of%20lowercase%20English%20letters%20%5C%22a%5C%22%2C%20%5C%22b%5C%22%2C%20%5C%22c%5C%22%2C%20%5C%22d%5C%22%20and%20%5C%22e%5C%22.%20Moreover%2C%20the%20set%20is%20split%20into%20%24%20n%20%24%20groups%20of%20%24%204%20%24%20equal%20strings%20each.%20Vasya%20also%20has%20one%20special%20string%20%24%20a%20%24%20of%20the%20same%20length%2C%20consisting%20of%20letters%20%5C%22a%5C%22%20only.%5Cn%5CnVasya%20wants%20to%20obtain%20from%20string%20%24%20a%20%24%20some%20fixed%20string%20%24%20b%20%24%20%2C%20in%20order%20to%20do%20this%2C%20he%20can%20use%20the%20strings%20from%20his%20set%20in%20any%20order.%20When%20he%20uses%20some%20string%20%24%20x%20%24%20%2C%20each%20of%20the%20letters%20in%20string%20%24%20a%20%24%20replaces%20with%20the%20next%20letter%20in%20alphabet%20as%20many%20times%20as%20the%20alphabet%20position%2C%20counting%20from%20zero%2C%20of%20the%20corresponding%20letter%20in%20string%20%24%20x%20%24%20.%20Within%20this%20process%20the%20next%20letter%20in%20alphabet%20after%20%5C%22e%5C%22%20is%20%5C%22a%5C%22.%5Cn%5CnFor%20example%2C%20if%20some%20letter%20in%20%24%20a%20%24%20equals%20%5C%22b%5C%22%2C%20and%20the%20letter%20on%20the%20same%20position%20in%20%24%20x%20%24%20equals%20%5C%22c%5C%22%2C%20then%20the%20letter%20in%20%24%20a%20%24%20becomes%20equal%20%5C%22d%5C%22%2C%20because%20%5C%22c%5C%22%20is%20the%20second%20alphabet%20letter%2C%20counting%20from%20zero.%20If%20some%20letter%20in%20%24%20a%20%24%20equals%20%5C%22e%5C%22%2C%20and%20on%20the%20same%20position%20in%20%24%20x%20%24%20is%20%5C%22d%5C%22%2C%20then%20the%20letter%20in%20%24%20a%20%24%20becomes%20%5C%22c%5C%22.%20For%20example%2C%20if%20the%20string%20%24%20a%20%24%20equals%20%5C%22abcde%5C%22%2C%20and%20string%20%24%20x%20%24%20equals%20%5C%22baddc%5C%22%2C%20then%20%24%20a%20%24%20becomes%20%5C%22bbabb%5C%22.%5Cn%5CnA%20used%20string%20disappears%2C%20but%20Vasya%20can%20use%20equal%20strings%20several%20times.%5Cn%5CnVasya%20wants%20to%20know%20for%20%24%20q%20%24%20given%20strings%20%24%20b%20%24%20%2C%20how%20many%20ways%20there%20are%20to%20obtain%20from%20the%20string%20%24%20a%20%24%20string%20%24%20b%20%24%20using%20the%20given%20set%20of%20%24%204n%20%24%20strings%3F%20Two%20ways%20are%20different%20if%20the%20number%20of%20strings%20used%20from%20some%20group%20of%20%24%204%20%24%20strings%20is%20different.%20Help%20Vasya%20compute%20the%20answers%20for%20these%20questions%20modulo%20%24%2010%5E%7B9%7D%2B7%20%24%20.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20two%20integers%20%24%20n%20%24%20and%20%24%20m%20%24%20%28%20%24%201%3C%3Dn%2Cm%3C%3D500%20%24%20%29%20%5Cu2014%20the%20number%20of%20groups%20of%20four%20strings%20in%20the%20set%2C%20and%20the%20length%20of%20all%20strings.%5Cn%5CnEach%20of%20the%20next%20%24%20n%20%24%20lines%20contains%20a%20string%20%24%20s%20%24%20of%20length%20%24%20m%20%24%20%2C%20consisting%20of%20lowercase%20English%20letters%20%5C%22a%5C%22%2C%20%5C%22b%5C%22%2C%20%5C%22c%5C%22%2C%20%5C%22d%5C%22%20and%20%5C%22e%5C%22.%20This%20means%20that%20there%20is%20a%20group%20of%20four%20strings%20equal%20to%20%24%20s%20%24%20.%5Cn%5CnThe%20next%20line%20contains%20single%20integer%20%24%20q%20%24%20%28%20%24%201%3C%3Dq%3C%3D300%20%24%20%29%20%5Cu2014%20the%20number%20of%20strings%20%24%20b%20%24%20Vasya%20is%20interested%20in.%5Cn%5CnEach%20of%20the%20next%20%24%20q%20%24%20strings%20contains%20a%20string%20%24%20b%20%24%20of%20length%20%24%20m%20%24%20%2C%20consisting%20of%20lowercase%20English%20letters%20%5C%22a%5C%22%2C%20%5C%22b%5C%22%2C%20%5C%22c%5C%22%2C%20%5C%22d%5C%22%20and%20%5C%22e%5C%22%20%5Cu2014%20a%20string%20Vasya%20is%20interested%20in.%22%2C%22outputFormat%22%3A%22For%20each%20string%20Vasya%20is%20interested%20in%20print%20the%20number%20of%20ways%20to%20obtain%20it%20from%20string%20%24%20a%20%24%20%2C%20modulo%20%24%2010%5E%7B9%7D%2B7%20%24%20.%22%2C%22samples%22%3A%5B%5B%221%201%5Cnb%5Cn2%5Cna%5Cne%5Cn%22%2C%221%5Cn1%5Cn%22%5D%2C%5B%222%204%5Cnaaaa%5Cnbbbb%5Cn1%5Cncccc%5Cn%22%2C%225%5Cn%22%5D%5D%2C%22hint%22%3A%22In%20the%20first%20example%2C%20we%20have%20%24%204%20%24%20strings%20%5C%22b%5C%22.%20Then%20we%20have%20the%20only%20way%20for%20each%20string%20%24%20b%20%24%20%3A%20select%20%24%200%20%24%20strings%20%5C%22b%5C%22%20to%20get%20%5C%22a%5C%22%20and%20select%20%24%204%20%24%20strings%20%5C%22b%5C%22%20to%20get%20%5C%22e%5C%22%2C%20respectively.%20So%2C%20we%20have%20%24%201%20%24%20way%20for%20each%20request.%5Cn%5CnIn%20the%20second%20example%2C%20note%20that%20the%20choice%20of%20the%20string%20%5C%22aaaa%5C%22%20does%20not%20change%20anything%2C%20that%20is%20we%20can%20choose%20any%20amount%20of%20it%20%28from%20%24%200%20%24%20to%20%24%204%20%24%20%2C%20it%27s%20%24%205%20%24%20different%20ways%29%20and%20we%20have%20to%20select%20the%20line%20%5C%22bbbb%5C%22%20%24%202%20%24%20times%2C%20since%20other%20variants%20do%20not%20fit.%20We%20get%20that%20we%20have%20%24%205%20%24%20ways%20for%20the%20request.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F832%5C%2FE%22%2C%22id%22%3A%22832E%22%7D%2C%22translation%22%3A%22%5Cu6709%5Cu4e00%5Cu7ec44n%5Cu4e2a%5Cu76f8%5Cu7b49%5Cu957f%5Cu5ea6%5Cu7684%5Cu5b57%5Cu7b26%5Cu4e32%2C%5Cu7531%5Cu5c0f%5Cu5199%5Cu5b57%5Cu6bcd%5C%22a%5C%22%5Cu3001%5C%22b%5C%22%5Cu3001%5C%22c%5C%22%5Cu3001%5C%22d%5C%22%5Cu548c%5C%22E%5C%22%5Cu7ec4%5Cu6210%5Cu3002%5Cu5c06%5Cu8fd9%5Cu4e9b%5Cu5206%5Cu6210n%5Cu4e2a%5Cu7ec4%5Cuff0c%5Cu6bcf%5Cu7ec44%5Cu4e2a%5Cu76f8%5Cu7b49%5Cu7684%5Cu4e32%5Cu3002%5Cu53e6%5Cu6709%5Cu4e00%5Cu4e2a%5Cu957f%5Cu5ea6%5Cu4e0e%5Cu5b83%5Cu4eec%5Cu76f8%5Cu540c%5Cu7684%5Cu5b57%5Cu7b26%5Cu4e32%5Cuff0c%5Cu4ec5%5Cu7531%5Cu5b57%5Cu6bcd%5C%22a%5C%22%5Cu7ec4%5Cu6210%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu4e3a%5Cu4e86%5Cu628a%5Cu5b57%5Cu7b26%5Cu4e32a%5Cu53d8%5Cu6210%5Cu4e00%5Cu4e9b%5Cu56fa%5Cu5b9a%5Cu7684%5Cu5b57%5Cu7b26%5Cu4e32b%5Cuff0c%5Cu53ef%5Cu4ee5%5Cu6309%5Cu7167%5Cu4efb%5Cu4f55%5Cu987a%5Cu5e8f%5Cu4f7f%5Cu7528%5Cu96c6%5Cu5408%5Cu4e2d%5Cu7684%5Cu5b57%5Cu7b26%5Cu4e32%5Cu3002%5Cu5f53%5Cu4ed6%5Cu4f7f%5Cu7528%5Cu5b57%5Cu7b26%5Cu4e32x%5Cu65f6%5Cuff0c%5Cu4ece%5Cu96f6%5Cu5f00%5Cu59cba%5Cu4e2d%5Cu7684%5Cu6bcf%5Cu4e2a%5Cu5b57%5Cu6bcd%5Cu90fd%5Cu7528x%5Cu4e2d%5Cu5b57%5Cu6bcd%5Cu7684%5Cu4e0b%5Cu4e00%5Cu4e2a%5Cu5b57%5Cu6bcd%5Cu66ff%5Cu6362%5Cu3002%5Cu5728%5C%22e%5C%22%5Cu540e%5Cu7684%5Cu4e0b%5Cu4e00%5Cu4e2a%5Cu5b57%5Cu6bcd%5Cu662f%5C%22a%5C%22%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu4f8b%5Cu5982%5Cuff0ca%5Cu4e2d%5Cu7684%5Cu67d0%5Cu4e2a%5Cu5b57%5Cu6bcd%5Cu201cb%5Cu201d%5Cu548cx%5Cu4e2d%5Cu7684%5C%22c%5C%22%5Cu4f4d%5Cu7f6e%5Cu76f8%5Cu540c%5Cuff0c%5Cu5219a%5Cu4e2d%5Cu7684%5Cu5b57%5Cu6bcd%5Cu53d8%5Cu4e3a%5C%22d%5C%22%5Cuff0c%5Cu56e0%5Cu4e3a%5C%22c%5C%22%5Cu662f%5Cu7b2c%5Cu4e8c%5Cu4e2a%5Cu5b57%5Cu6bcd%5Cu8868%5Cu5b57%5Cu6bcd%5Cu3002%5Cu5982%5Cu679ca%5Cu4e2d%5Cu7684%5Cu67d0%5Cu4e2a%5Cu5b57%5Cu6bcd%5Cu201ce%5Cu201d%5Cu548cx%5Cu4e2d%5Cu7684%5C%22d%5C%22%5Cu4f4d%5Cu7f6e%5Cu76f8%5Cu540c%5Cuff0c%5Cu5219a%5Cu4e2d%5Cu7684%5Cu5b57%5Cu6bcd%5Cu53d8%5Cu4e3a%5C%22c%5C%22%5Cu3002%5Cu4f8b%5Cu5982%5Cuff0c%5Cu5982%5Cu679c%5Cu5b57%5Cu7b26%5Cu4e32a%5Cu7b49%5Cu4e8e%5C%22abcde%5C%22%5Cuff0c%5Cu800c%5Cu5b57%5Cu7b26%5Cu4e32x%5Cu7b49%5Cu4e8e%5C%22baddc%5C%22%5Cuff0c%5Cu5219a%5Cu53d8%5Cu4e3a%5C%22bbabb%5C%22%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu88ab%5Cu4f7f%5Cu7528%5Cu8fc7%5Cu7684%5Cu5b57%5Cu7b26%5Cu4e32%5Cu6d88%5Cu5931%5Cuff0c%5Cu4f46%5Cu53ef%5Cu4ee5%5Cu591a%5Cu6b21%5Cu4f7f%5Cu7528%5Cu76f8%5Cu7b49%5Cu7684%5Cu5b57%5Cu7b26%5Cu4e32%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu73b0%5Cu5728%5Cu60f3%5Cu77e5%5Cu9053q%5Cu4e2a%5Cu7ed9%5Cu5b9a%5Cu7684%5Cu5b57%5Cu7b26%5Cu4e32b%5Cu3001%5Cu4f7f%5Cu7528%5Cu7ed9%5Cu5b9a%5Cu76844n%5Cu4e2a%5Cu5b57%5Cu7b26%5Cu4e32%5Cuff0c%5Cu80fd%5Cu6709%5Cu591a%5Cu5c11%5Cu79cd%5Cu4f7f%5Cu5b57%5Cu7b26%5Cu4e32a%5Cu53d8%5Cu6210%5Cu5b57%5Cu7b26%5Cu4e32b%5Cu83b7%5Cu5f97%5Cu591a%5Cu5c11%5Cu79cd%5Cu65b9%5Cu5f0f%5Cuff1f%5Cu8ba4%5Cu4e3a%5Cu4ece%5Cu4e00%5Cu7ec44%5Cu4e2a%5Cu5b57%5Cu7b26%5Cu4e32%5Cu4e2d%5Cu4f7f%5Cu7528%5Cu7684%5Cu5b57%5Cu7b26%5Cu4e32%5Cu7684%5Cu6570%5Cu91cf%5Cu4e0d%5Cu540c%5Cuff0c%5Cu5219%5Cu4e24%5Cu79cd%5Cu65b9%5Cu5f0f%5Cu4e0d%5Cu540c%5Cu3002%5Cu8bf7%5Cu8ba1%5Cu7b97%5Cu8fd9%5Cu4e9b%5Cu95ee%5Cu9898%5Cu7684%5Cu7b54%5Cu6848%5Cu5e76%5Cu5bf910%5E9%2B7%5Cu6c42%5Cu4f59%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu611f%5Cu8c22%20%40%5Cu543e%5Cu8c01%5Cu77e5%20%5Cu7684%5Cu7ffb%5Cu8bd1%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A8%2C%22totalAccepted%22%3A3%2C%22pid%22%3A%22CF832E%22%2C%22title%22%3A%22Vasya%20and%20Shifts%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Vasya%20and%20Shifts%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Vasya and Shifts</h1>
<h2>题意翻译</h2>
<div>有一组4n个相等长度的字符串,由小写字母"a"、"b"、"c"、"d"和"E"组成。将这些分成n个组，每组4个相等的串。另有一个长度与它们相同的字符串，仅由字母"a"组成。
为了把字符串a变成一些固定的字符串b，可以按照任何顺序使用集合中的字符串。当他使用字符串x时，从零开始a中的每个字母都用x中字母的下一个字母替换。在"e"后的下一个字母是"a"。
例如，a中的某个字母“b”和x中的"c"位置相同，则a中的字母变为"d"，因为"c"是第二个字母表字母。如果a中的某个字母“e”和x中的"d"位置相同，则a中的字母变为"c"。例如，如果字符串a等于"abcde"，而字符串x等于"baddc"，则a变为"bbabb"。
被使用过的字符串消失，但可以多次使用相等的字符串。
现在想知道q个给定的字符串b、使用给定的4n个字符串，能有多少种使字符串a变成字符串b获得多少种方式？认为从一组4个字符串中使用的字符串的数量不同，则两种方式不同。请计算这些问题的答案并对10^9+7求余。
感谢 @吾谁知 的翻译</div>
<h2>题目描述</h2>
<div>Vasya has a set of $ 4n $ strings of equal length, consisting of lowercase English letters "a", "b", "c", "d" and "e". Moreover, the set is split into $ n $ groups of $ 4 $ equal strings each. Vasya also has one special string $ a $ of the same length, consisting of letters "a" only.
Vasya wants to obtain from string $ a $ some fixed string $ b $ , in order to do this, he can use the strings from his set in any order. When he uses some string $ x $ , each of the letters in string $ a $ replaces with the next letter in alphabet as many times as the alphabet position, counting from zero, of the corresponding letter in string $ x $ . Within this process the next letter in alphabet after "e" is "a".
For example, if some letter in $ a $ equals "b", and the letter on the same position in $ x $ equals "c", then the letter in $ a $ becomes equal "d", because "c" is the second alphabet letter, counting from zero. If some letter in $ a $ equals "e", and on the same position in $ x $ is "d", then the letter in $ a $ becomes "c". For example, if the string $ a $ equals "abcde", and string $ x $ equals "baddc", then $ a $ becomes "bbabb".
A used string disappears, but Vasya can use equal strings several times.
Vasya wants to know for $ q $ given strings $ b $ , how many ways there are to obtain from the string $ a $ string $ b $ using the given set of $ 4n $ strings? Two ways are different if the number of strings used from some group of $ 4 $ strings is different. Help Vasya compute the answers for these questions modulo $ 10^{9}+7 $ .</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains two integers $ n $ and $ m $ ( $ 1<=n,m<=500 $ ) — the number of groups of four strings in the set, and the length of all strings.
Each of the next $ n $ lines contains a string $ s $ of length $ m $ , consisting of lowercase English letters "a", "b", "c", "d" and "e". This means that there is a group of four strings equal to $ s $ .
The next line contains single integer $ q $ ( $ 1<=q<=300 $ ) — the number of strings $ b $ Vasya is interested in.
Each of the next $ q $ strings contains a string $ b $ of length $ m $ , consisting of lowercase English letters "a", "b", "c", "d" and "e" — a string Vasya is interested in.</div>
<h3>输出格式</h3>
<br />
<div>For each string Vasya is interested in print the number of ways to obtain it from string $ a $ , modulo $ 10^{9}+7 $ .</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>1 1
b
2
a
e
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>1
1
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>2 4
aaaa
bbbb
1
cccc
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>5
</code></pre>
<h2>说明</h2>
<div>In the first example, we have $ 4 $ strings "b". Then we have the only way for each string $ b $ : select $ 0 $ strings "b" to get "a" and select $ 4 $ strings "b" to get "e", respectively. So, we have $ 1 $ way for each request.
In the second example, note that the choice of the string "aaaa" does not change anything, that is we can choose any amount of it (from $ 0 $ to $ 4 $ , it's $ 5 $ different ways) and we have to select the line "bbbb" $ 2 $ times, since other variants do not fit. We get that we have $ 5 $ ways for the request.</div>
</article>
</div>
</div>
</body>
</html>
