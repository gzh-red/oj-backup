<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Mrs. Hudson&#039;s Pancakes - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573391249:cCbD2A7AZIPiuocP2GPU5qhgD6An3JHVjLmqWFg47FM=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Mrs.%20Hudson%20hasn%27t%20made%20her%20famous%20pancakes%20for%20quite%20a%20while%20and%20finally%20she%20decided%20to%20make%20them%20again.%20She%20has%20learned%20%24%20m%20%24%20new%20recipes%20recently%20and%20she%20can%27t%20wait%20to%20try%20them.%20Those%20recipes%20are%20based%20on%20%24%20n%20%24%20special%20spices.%20Mrs.%20Hudson%20has%20these%20spices%20in%20the%20kitchen%20lying%20in%20jars%20numbered%20with%20integers%20from%20%24%200%20%24%20to%20%24%20n-1%20%24%20%28each%20spice%20lies%20in%20an%20individual%20jar%29.%20Each%20jar%20also%20has%20the%20price%20of%20the%20corresponding%20spice%20inscribed%20%5Cu2014%20some%20integer%20%24%20a_%7Bi%7D%20%24%20.%5Cn%5CnWe%20know%20three%20values%20for%20the%20%24%20i%20%24%20-th%20pancake%20recipe%3A%20%24%20d_%7Bi%7D%20%24%20%2C%20%24%20s_%7Bi%7D%20%24%20%2C%20%24%20c_%7Bi%7D%20%24%20.%20Here%20%24%20d_%7Bi%7D%20%24%20and%20%24%20c_%7Bi%7D%20%24%20are%20integers%2C%20and%20%24%20s_%7Bi%7D%20%24%20is%20the%20pattern%20of%20some%20integer%20written%20in%20the%20numeral%20system%20with%20radix%20%24%20d_%7Bi%7D%20%24%20.%20The%20pattern%20contains%20digits%2C%20Latin%20letters%20%28to%20denote%20digits%20larger%20than%20nine%29%20and%20question%20marks.%20Number%20%24%20x%20%24%20in%20the%20%24%20d_%7Bi%7D%20%24%20-base%20numeral%20system%20matches%20the%20pattern%20%24%20s_%7Bi%7D%20%24%20%2C%20if%20we%20can%20replace%20question%20marks%20in%20the%20pattern%20with%20digits%20and%20letters%20so%20that%20we%20obtain%20number%20%24%20x%20%24%20%28leading%20zeroes%20aren%27t%20taken%20into%20consideration%20when%20performing%20the%20comparison%29.%20More%20formally%3A%20each%20question%20mark%20should%20be%20replaced%20by%20exactly%20one%20digit%20or%20exactly%20one%20letter.%20If%20after%20we%20replace%20all%20question%20marks%20we%20get%20a%20number%20with%20leading%20zeroes%2C%20we%20can%20delete%20these%20zeroes.%20For%20example%2C%20number%2040A9875%20in%20the%20%24%2011%20%24%20-base%20numeral%20system%20matches%20the%20pattern%20%5C%22%3F%3F4%3F%3F987%3F%5C%22%2C%20and%20number%204A9875%20does%20not.%5Cn%5CnTo%20make%20the%20pancakes%20by%20the%20%24%20i%20%24%20-th%20recipe%2C%20Mrs.%20Hudson%20should%20take%20all%20jars%20with%20numbers%20whose%20representation%20in%20the%20%24%20d_%7Bi%7D%20%24%20-base%20numeral%20system%20matches%20the%20pattern%20%24%20s_%7Bi%7D%20%24%20.%20The%20control%20number%20of%20the%20recipe%20%28%20%24%20z_%7Bi%7D%20%24%20%29%20is%20defined%20as%20the%20sum%20of%20number%20%24%20c_%7Bi%7D%20%24%20and%20the%20product%20of%20prices%20of%20all%20taken%20jars.%20More%20formally%3A%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF156E%5C%2F570206ebd8d73cc8530166d74a246f6d09b37149.png%29%20%28where%20%24%20j%20%24%20is%20all%20such%20numbers%20whose%20representation%20in%20the%20%24%20d_%7Bi%7D%20%24%20-base%20numeral%20system%20matches%20the%20pattern%20%24%20s_%7Bi%7D%20%24%20%29.%5Cn%5CnMrs.%20Hudson%20isn%27t%20as%20interested%20in%20the%20control%20numbers%20as%20she%20is%20in%20their%20minimum%20prime%20divisors.%20Your%20task%20is%3A%20for%20each%20recipe%20%24%20i%20%24%20find%20the%20minimum%20prime%20divisor%20of%20number%20%24%20z_%7Bi%7D%20%24%20.%20If%20this%20divisor%20exceeds%20%24%20100%20%24%20%2C%20then%20you%20do%20not%20have%20to%20find%20it%2C%20print%20-1.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20the%20single%20integer%20%24%20n%20%24%20%28%20%24%201%3C%3Dn%3C%3D10%5E%7B4%7D%20%24%20%29.%20The%20second%20line%20contains%20space-separated%20prices%20of%20the%20spices%20%24%20a_%7B0%7D%2Ca_%7B1%7D%2C...%2Ca_%7Bn-1%7D%20%24%20%2C%20where%20%24%20a_%7Bi%7D%20%24%20is%20an%20integer%20%28%20%24%201%3C%3Da_%7Bi%7D%3C%3D10%5E%7B18%7D%20%24%20%29.%5Cn%5CnThe%20third%20line%20contains%20the%20single%20integer%20%24%20m%20%24%20%28%20%24%201%3C%3Dm%3C%3D3%5Cu00b710%5E%7B4%7D%20%24%20%29%20%5Cu2014%20the%20number%20of%20recipes%20Mrs.%20Hudson%20has%20learned.%5Cn%5CnNext%20%24%20m%20%24%20lines%20describe%20the%20recipes%2C%20one%20per%20line.%20First%20you%20are%20given%20an%20integer%20%24%20d_%7Bi%7D%20%24%20%2C%20written%20in%20the%20decimal%20numeral%20system%20%28%20%24%202%3C%3Dd_%7Bi%7D%3C%3D16%20%24%20%29.%20Then%20after%20a%20space%20follows%20the%20%24%20s_%7Bi%7D%20%24%20pattern%20%5Cu2014%20a%20string%20from%20%24%201%20%24%20to%20%24%2030%20%24%20in%20length%2C%20inclusive%2C%20consisting%20of%20digits%20from%20%5C%220%5C%22%20to%20%5C%229%5C%22%2C%20letters%20from%20%5C%22A%5C%22%20to%20%5C%22F%5C%22%20and%20signs%20%5C%22%3F%5C%22.%20Letters%20from%20%5C%22A%5C%22%20to%20%5C%22F%5C%22%20should%20be%20considered%20as%20digits%20from%20%24%2010%20%24%20to%20%24%2015%20%24%20correspondingly.%20It%20is%20guaranteed%20that%20all%20digits%20of%20the%20pattern%20%28including%20the%20digits%20that%20are%20represented%20by%20letters%29%20are%20strictly%20less%20than%20%24%20d_%7Bi%7D%20%24%20.%20Then%20after%20a%20space%20follows%20an%20integer%20%24%20c_%7Bi%7D%20%24%20%2C%20written%20in%20the%20decimal%20numeral%20system%20%28%20%24%201%3C%3Dc_%7Bi%7D%3C%3D10%5E%7B18%7D%20%24%20%29.%5Cn%5CnPlease%20do%20not%20use%20the%20%25lld%20specificator%20to%20read%20or%20write%2064-bit%20integers%20in%20%5Cu0421%2B%2B%2C%20in%20is%20preferred%20to%20use%20cin%2C%20cout%2C%20strings%20or%20the%20%25I64d%20specificator%20instead.%22%2C%22outputFormat%22%3A%22For%20each%20recipe%20count%20by%20what%20minimum%20prime%20number%20the%20control%20number%20is%20divided%20and%20print%20this%20prime%20number%20on%20the%20single%20line.%20If%20this%20number%20turns%20out%20larger%20than%20%24%20100%20%24%20%2C%20print%20-1.%22%2C%22samples%22%3A%5B%5B%221%5Cn1%5Cn1%5Cn2%20%3F%201%5Cn%22%2C%222%5Cn%22%5D%2C%5B%224%5Cn2%203%205%207%5Cn4%5Cn2%20%3F0%2011%5Cn2%20%3F1%2013%5Cn2%200%3F%2017%5Cn2%201%3F%2019%5Cn%22%2C%223%5Cn2%5Cn23%5Cn2%5Cn%22%5D%2C%5B%221%5Cn1000000000000000000%5Cn1%5Cn16%20%3F%3F%3F%3F%3F%3F%3F%3F%3F%3F%3F%3F%3F%3F%201%5Cn%22%2C%22-1%5Cn%22%5D%5D%2C%22hint%22%3A%22In%20the%20first%20test%20any%20one-digit%20number%20in%20the%20binary%20system%20matches.%20The%20jar%20is%20only%20one%20and%20its%20price%20is%20equal%20to%20%24%201%20%24%20%2C%20the%20number%20%24%20c%20%24%20is%20also%20equal%20to%20%24%201%20%24%20%2C%20the%20control%20number%20equals%20%24%202%20%24%20.%20The%20minimal%20prime%20divisor%20of%20%24%202%20%24%20is%20%24%202%20%24%20.%5Cn%5CnIn%20the%20second%20test%20there%20are%20%24%204%20%24%20jars%20with%20numbers%20from%20%24%200%20%24%20to%20%24%203%20%24%20%2C%20and%20the%20prices%20are%20equal%20%24%202%20%24%20%2C%20%24%203%20%24%20%2C%20%24%205%20%24%20and%20%24%207%20%24%20correspondingly%20%5Cu2014%20the%20first%20four%20prime%20numbers.%20In%20all%20recipes%20numbers%20should%20be%20two-digit.%20In%20the%20first%20recipe%20the%20second%20digit%20always%20is%20%24%200%20%24%20%2C%20in%20the%20second%20recipe%20the%20second%20digit%20always%20is%20%24%201%20%24%20%2C%20in%20the%20third%20recipe%20the%20first%20digit%20must%20be%20%24%200%20%24%20%2C%20in%20the%20fourth%20recipe%20the%20first%20digit%20always%20is%20%24%201%20%24%20.%20Consequently%2C%20the%20control%20numbers%20%5Cu200b%5Cu200bare%20as%20follows%3A%20in%20the%20first%20recipe%20%24%202%5Cu00d75%2B11%3D21%20%24%20%28the%20minimum%20prime%20divisor%20is%20%24%203%20%24%20%29%2C%20in%20the%20second%20recipe%20%24%203%5Cu00d77%2B13%3D44%20%24%20%28the%20minimum%20prime%20divisor%20is%20%24%202%20%24%20%29%2C%20in%20the%20third%20recipe%20%24%202%5Cu00d73%2B17%3D23%20%24%20%28the%20minimum%20prime%20divisor%20is%20%24%2023%20%24%20%29%20and%2C%20finally%2C%20in%20the%20fourth%20recipe%20%24%205%5Cu00d77%2B19%3D54%20%24%20%28the%20minimum%20prime%20divisor%20is%20%24%202%20%24%20%29.%5Cn%5CnIn%20the%20third%20test%2C%20the%20number%20should%20consist%20of%20fourteen%20digits%20and%20be%20recorded%20in%20a%20sixteen-base%20numeral%20system.%20Number%20%24%200%20%24%20%28the%20number%20of%20the%20single%20bottles%29%20matches%2C%20the%20control%20number%20will%20be%20equal%20to%20%24%2010%5E%7B18%7D%2B1%20%24%20.%20The%20minimum%20prime%20divisor%20of%20this%20number%20is%20equal%20to%20%24%20101%20%24%20and%20you%20should%20print%20-1.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B5000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F156%5C%2FE%22%2C%22id%22%3A%22156E%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A4%2C%22totalAccepted%22%3A1%2C%22pid%22%3A%22CF156E%22%2C%22title%22%3A%22Mrs.%20Hudson%27s%20Pancakes%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Mrs.%20Hudson%27s%20Pancakes%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573286098;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Mrs. Hudson&#039;s Pancakes</h1>
<h2>题目描述</h2>
<div>Mrs. Hudson hasn't made her famous pancakes for quite a while and finally she decided to make them again. She has learned $ m $ new recipes recently and she can't wait to try them. Those recipes are based on $ n $ special spices. Mrs. Hudson has these spices in the kitchen lying in jars numbered with integers from $ 0 $ to $ n-1 $ (each spice lies in an individual jar). Each jar also has the price of the corresponding spice inscribed — some integer $ a_{i} $ .
We know three values for the $ i $ -th pancake recipe: $ d_{i} $ , $ s_{i} $ , $ c_{i} $ . Here $ d_{i} $ and $ c_{i} $ are integers, and $ s_{i} $ is the pattern of some integer written in the numeral system with radix $ d_{i} $ . The pattern contains digits, Latin letters (to denote digits larger than nine) and question marks. Number $ x $ in the $ d_{i} $ -base numeral system matches the pattern $ s_{i} $ , if we can replace question marks in the pattern with digits and letters so that we obtain number $ x $ (leading zeroes aren't taken into consideration when performing the comparison). More formally: each question mark should be replaced by exactly one digit or exactly one letter. If after we replace all question marks we get a number with leading zeroes, we can delete these zeroes. For example, number 40A9875 in the $ 11 $ -base numeral system matches the pattern "??4??987?", and number 4A9875 does not.
To make the pancakes by the $ i $ -th recipe, Mrs. Hudson should take all jars with numbers whose representation in the $ d_{i} $ -base numeral system matches the pattern $ s_{i} $ . The control number of the recipe ( $ z_{i} $ ) is defined as the sum of number $ c_{i} $ and the product of prices of all taken jars. More formally: ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF156E/570206ebd8d73cc8530166d74a246f6d09b37149.png) (where $ j $ is all such numbers whose representation in the $ d_{i} $ -base numeral system matches the pattern $ s_{i} $ ).
Mrs. Hudson isn't as interested in the control numbers as she is in their minimum prime divisors. Your task is: for each recipe $ i $ find the minimum prime divisor of number $ z_{i} $ . If this divisor exceeds $ 100 $ , then you do not have to find it, print -1.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains the single integer $ n $ ( $ 1<=n<=10^{4} $ ). The second line contains space-separated prices of the spices $ a_{0},a_{1},...,a_{n-1} $ , where $ a_{i} $ is an integer ( $ 1<=a_{i}<=10^{18} $ ).
The third line contains the single integer $ m $ ( $ 1<=m<=3·10^{4} $ ) — the number of recipes Mrs. Hudson has learned.
Next $ m $ lines describe the recipes, one per line. First you are given an integer $ d_{i} $ , written in the decimal numeral system ( $ 2<=d_{i}<=16 $ ). Then after a space follows the $ s_{i} $ pattern — a string from $ 1 $ to $ 30 $ in length, inclusive, consisting of digits from "0" to "9", letters from "A" to "F" and signs "?". Letters from "A" to "F" should be considered as digits from $ 10 $ to $ 15 $ correspondingly. It is guaranteed that all digits of the pattern (including the digits that are represented by letters) are strictly less than $ d_{i} $ . Then after a space follows an integer $ c_{i} $ , written in the decimal numeral system ( $ 1<=c_{i}<=10^{18} $ ).
Please do not use the %lld specificator to read or write 64-bit integers in С++, in is preferred to use cin, cout, strings or the %I64d specificator instead.</div>
<h3>输出格式</h3>
<br />
<div>For each recipe count by what minimum prime number the control number is divided and print this prime number on the single line. If this number turns out larger than $ 100 $ , print -1.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>1
1
1
2 ? 1
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>2
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>4
2 3 5 7
4
2 ?0 11
2 ?1 13
2 0? 17
2 1? 19
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>3
2
23
2
</code></pre>
<h3>输入样例 #3</h3>
<pre><code>1
1000000000000000000
1
16 ?????????????? 1
</code></pre>
<h3>输出样例 #3</h3>
<pre><code>-1
</code></pre>
<h2>说明</h2>
<div>In the first test any one-digit number in the binary system matches. The jar is only one and its price is equal to $ 1 $ , the number $ c $ is also equal to $ 1 $ , the control number equals $ 2 $ . The minimal prime divisor of $ 2 $ is $ 2 $ .
In the second test there are $ 4 $ jars with numbers from $ 0 $ to $ 3 $ , and the prices are equal $ 2 $ , $ 3 $ , $ 5 $ and $ 7 $ correspondingly — the first four prime numbers. In all recipes numbers should be two-digit. In the first recipe the second digit always is $ 0 $ , in the second recipe the second digit always is $ 1 $ , in the third recipe the first digit must be $ 0 $ , in the fourth recipe the first digit always is $ 1 $ . Consequently, the control numbers ​​are as follows: in the first recipe $ 2×5+11=21 $ (the minimum prime divisor is $ 3 $ ), in the second recipe $ 3×7+13=44 $ (the minimum prime divisor is $ 2 $ ), in the third recipe $ 2×3+17=23 $ (the minimum prime divisor is $ 23 $ ) and, finally, in the fourth recipe $ 5×7+19=54 $ (the minimum prime divisor is $ 2 $ ).
In the third test, the number should consist of fourteen digits and be recorded in a sixteen-base numeral system. Number $ 0 $ (the number of the single bottles) matches, the control number will be equal to $ 10^{18}+1 $ . The minimum prime divisor of this number is equal to $ 101 $ and you should print -1.</div>
</article>
</div>
</div>
</body>
</html>
