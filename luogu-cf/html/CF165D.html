<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Beard Graph - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573391340:Km4e+nTSxZ+iXWGPlZ4jnDWf1eiKALA9db2vPcsgthI=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%22%2C%22description%22%3A%22Let%27s%20define%20a%20non-oriented%20connected%20graph%20of%20%24%20n%20%24%20vertices%20and%20%24%20n-1%20%24%20edges%20as%20a%20beard%2C%20if%20all%20of%20its%20vertices%20except%2C%20perhaps%2C%20one%2C%20have%20the%20degree%20of%202%20or%201%20%28that%20is%2C%20there%20exists%20no%20more%20than%20one%20vertex%2C%20whose%20degree%20is%20more%20than%20two%29.%20Let%20us%20remind%20you%20that%20the%20degree%20of%20a%20vertex%20is%20the%20number%20of%20edges%20that%20connect%20to%20it.%5Cn%5CnLet%20each%20edge%20be%20either%20black%20or%20white.%20Initially%20all%20edges%20are%20black.%5Cn%5CnYou%20are%20given%20the%20description%20of%20the%20beard%20graph.%20Your%20task%20is%20to%20analyze%20requests%20of%20the%20following%20types%3A%5Cn%5Cn-%20paint%20the%20edge%20number%20%24%20i%20%24%20black.%20The%20edge%20number%20%24%20i%20%24%20is%20the%20edge%20that%20has%20this%20number%20in%20the%20description.%20It%20is%20guaranteed%20that%20by%20the%20moment%20of%20this%20request%20the%20%24%20i%20%24%20-th%20edge%20is%20white%5Cn-%20paint%20the%20edge%20number%20%24%20i%20%24%20white.%20It%20is%20guaranteed%20that%20by%20the%20moment%20of%20this%20request%20the%20%24%20i%20%24%20-th%20edge%20is%20black%5Cn-%20find%20the%20length%20of%20the%20shortest%20path%20going%20only%20along%20the%20black%20edges%20between%20vertices%20%24%20a%20%24%20and%20%24%20b%20%24%20or%20indicate%20that%20no%20such%20path%20exists%20between%20them%20%28a%20path%27s%20length%20is%20the%20number%20of%20edges%20in%20it%29%5Cn%5CnThe%20vertices%20are%20numbered%20with%20integers%20from%20%24%201%20%24%20to%20%24%20n%20%24%20%2C%20and%20the%20edges%20are%20numbered%20with%20integers%20from%20%24%201%20%24%20to%20%24%20n-1%20%24%20.%22%2C%22inputFormat%22%3A%22The%20first%20line%20of%20the%20input%20contains%20an%20integer%20%24%20n%20%24%20%28%20%24%202%3C%3Dn%3C%3D10%5E%7B5%7D%20%24%20%29%20%5Cu2014%20the%20number%20of%20vertices%20in%20the%20graph.%20Next%20%24%20n-1%20%24%20lines%20contain%20edges%20described%20as%20the%20numbers%20of%20vertices%20%24%20v_%7Bi%7D%20%24%20%2C%20%24%20u_%7Bi%7D%20%24%20%28%20%24%201%3C%3Dv_%7Bi%7D%2Cu_%7Bi%7D%3C%3Dn%20%24%20%2C%20%24%20v_%7Bi%7D%5Cu2260u_%7Bi%7D%20%24%20%29%20connected%20by%20this%20edge.%20It%20is%20guaranteed%20that%20the%20given%20graph%20is%20connected%20and%20forms%20a%20beard%20graph%2C%20and%20has%20no%20self-loops%20or%20multiple%20edges.%5Cn%5CnThe%20next%20line%20contains%20an%20integer%20%24%20m%20%24%20%28%20%24%201%3C%3Dm%3C%3D3%5Cu00b710%5E%7B5%7D%20%24%20%29%20%5Cu2014%20the%20number%20of%20requests.%20Next%20%24%20m%20%24%20lines%20contain%20requests%20in%20the%20following%20form%3A%20first%20a%20line%20contains%20an%20integer%20%24%20type%20%24%20%2C%20which%20takes%20values%20%5Cu200b%5Cu200bfrom%20%24%201%20%24%20to%20%24%203%20%24%20%2C%20and%20represents%20the%20request%20type.%5Cn%5CnIf%20%24%20type%3D1%20%24%20%2C%20then%20the%20current%20request%20is%20a%20request%20to%20paint%20the%20edge%20black.%20In%20this%20case%2C%20in%20addition%20to%20number%20%24%20type%20%24%20the%20line%20should%20contain%20integer%20%24%20id%20%24%20%28%20%24%201%3C%3Did%3C%3Dn-1%20%24%20%29%2C%20which%20represents%20the%20number%20of%20the%20edge%20to%20paint.%5Cn%5CnIf%20%24%20type%3D2%20%24%20%2C%20then%20the%20current%20request%20is%20a%20request%20to%20paint%20the%20edge%20white%2C%20its%20form%20is%20similar%20to%20the%20previous%20request.%5Cn%5CnIf%20%24%20type%3D3%20%24%20%2C%20then%20the%20current%20request%20is%20a%20request%20to%20find%20the%20distance.%20In%20this%20case%2C%20in%20addition%20to%20%24%20type%20%24%20%2C%20the%20line%20should%20contain%20two%20integers%20%24%20a%20%24%20%2C%20%24%20b%20%24%20%28%20%24%201%3C%3Da%2Cb%3C%3Dn%20%24%20%2C%20%24%20a%20%24%20can%20be%20equal%20to%20%24%20b%20%24%20%29%20%5Cu2014%20the%20numbers%20of%20vertices%2C%20the%20distance%20between%20which%20must%20be%20found.%5Cn%5CnThe%20numbers%20in%20all%20lines%20are%20separated%20by%20exactly%20one%20space.%20The%20edges%20are%20numbered%20in%20the%20order%20in%20which%20they%20are%20given%20in%20the%20input.%22%2C%22outputFormat%22%3A%22For%20each%20request%20to%20%5C%22find%20the%20distance%20between%20vertices%20%24%20a%20%24%20and%20%24%20b%20%24%20%5C%22%20print%20the%20result.%20If%20there%20is%20no%20path%20going%20only%20along%20the%20black%20edges%20between%20vertices%20%24%20a%20%24%20and%20%24%20b%20%24%20%2C%20then%20print%20%5C%22-1%5C%22%20%28without%20the%20quotes%29.%20Print%20the%20results%20in%20the%20order%20of%20receiving%20the%20requests%2C%20separate%20the%20numbers%20with%20spaces%20or%20line%20breaks.%22%2C%22samples%22%3A%5B%5B%223%5Cn1%202%5Cn2%203%5Cn7%5Cn3%201%202%5Cn3%201%203%5Cn3%202%203%5Cn2%202%5Cn3%201%202%5Cn3%201%203%5Cn3%202%203%5Cn%22%2C%221%5Cn2%5Cn1%5Cn1%5Cn-1%5Cn-1%5Cn%22%5D%2C%5B%226%5Cn1%205%5Cn6%204%5Cn2%203%5Cn3%205%5Cn5%206%5Cn6%5Cn3%203%204%5Cn2%205%5Cn3%202%206%5Cn3%201%202%5Cn2%203%5Cn3%203%201%5Cn%22%2C%223%5Cn-1%5Cn3%5Cn2%5Cn%22%5D%5D%2C%22hint%22%3A%22In%20the%20first%20sample%20vertices%20%24%201%20%24%20and%20%24%202%20%24%20are%20connected%20with%20edge%20number%20%24%201%20%24%20%2C%20and%20vertices%20%24%202%20%24%20and%20%24%203%20%24%20are%20connected%20with%20edge%20number%20%24%202%20%24%20.%20Before%20the%20repainting%20edge%20number%20%24%202%20%24%20each%20vertex%20is%20reachable%20from%20each%20one%20along%20the%20black%20edges.%20Specifically%2C%20the%20shortest%20path%20between%20%24%201%20%24%20and%20%24%203%20%24%20goes%20along%20both%20edges.%5Cn%5CnIf%20we%20paint%20edge%20number%20%24%202%20%24%20white%2C%20vertex%20%24%203%20%24%20will%20end%20up%20cut%20off%20from%20other%20vertices%2C%20that%20is%2C%20no%20path%20exists%20from%20it%20to%20any%20other%20vertex%20along%20the%20black%20edges.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B4000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F165%5C%2FD%22%2C%22id%22%3A%22165D%22%7D%2C%22translation%22%3A%22%5Cu7ed9%5Cu5b9a%5Cu4e00%5Cu68f5%5Cu6811%5Cuff0c%5Cu6709m%5Cu6b21%5Cu64cd%5Cu4f5c%5Cu3002%5Cn%5Cn1%20x%20%5Cu628a%5Cu7b2cx%5Cu6761%5Cu8fb9%5Cu67d3%5Cu6210%5Cu9ed1%5Cu8272%5Cn%5Cn2%20x%20%5Cu628a%5Cu7b2cx%5Cu6761%5Cu8fb9%5Cu67d3%5Cu6210%5Cu767d%5Cu8272%5Cn%5Cn3%20x%20y%20%5Cu67e5%5Cu8be2x~y%5Cu4e4b%5Cu95f4%5Cu7684%5Cu9ed1%5Cu8fb9%5Cu6570%5Cuff0c%5Cu5b58%5Cu5728%5Cu767d%5Cu8fb9%5Cu8f93%5Cu51fa-1%5Cn%5Cn%5Cu4e00%5Cu5f00%5Cu59cb%5Cu6240%5Cu6709%5Cu7684%5Cu8fb9%5Cu90fd%5Cu662f%5Cu9ed1%5Cu8fb9%5Cn%5Cn%22%2C%22tags%22%3A%5B42%2C211%2C228%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A128%2C%22totalAccepted%22%3A58%2C%22pid%22%3A%22CF165D%22%2C%22title%22%3A%22Beard%20Graph%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A140836%2C%22title%22%3A%22%5Cu840c%5Cu65b0%5Cu6c42%5Cu52a9QAQ%22%2C%22forum%22%3A%7B%22id%22%3A11926%2C%22name%22%3A%22CF165D%20Beard%20Graph%22%2C%22slug%22%3A%22CF165D%22%7D%7D%2C%7B%22id%22%3A103152%2C%22title%22%3A%22%5Cu9898%5Cu610f%5Cu8865%5Cu5145%22%2C%22forum%22%3A%7B%22id%22%3A11926%2C%22name%22%3A%22CF165D%20Beard%20Graph%22%2C%22slug%22%3A%22CF165D%22%7D%7D%2C%7B%22id%22%3A70171%2C%22title%22%3A%22%5Cu9898%5Cu610f%22%2C%22forum%22%3A%7B%22id%22%3A11926%2C%22name%22%3A%22CF165D%20Beard%20Graph%22%2C%22slug%22%3A%22CF165D%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22CF916E%22%2C%22title%22%3A%22Jamie%20and%20Tree%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF343D%22%2C%22title%22%3A%22Water%20Tree%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF165E%22%2C%22title%22%3A%22Compatible%20Numbers%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22SP6779%22%2C%22title%22%3A%22GSS7%20-%20Can%20you%20answer%20these%20queries%20VII%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22SP%22%7D%2C%7B%22pid%22%3A%22CF1003A%22%2C%22title%22%3A%22Polycarp%27s%20Pockets%22%2C%22difficulty%22%3A1%2C%22type%22%3A%22CF%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Beard%20Graph%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573295103;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Beard Graph</h1>
<h2>题意翻译</h2>
<div>给定一棵树，有m次操作。
1 x 把第x条边染成黑色
2 x 把第x条边染成白色
3 x y 查询x~y之间的黑边数，存在白边输出-1
一开始所有的边都是黑边
</div>
<h2>题目描述</h2>
<div>Let's define a non-oriented connected graph of $ n $ vertices and $ n-1 $ edges as a beard, if all of its vertices except, perhaps, one, have the degree of 2 or 1 (that is, there exists no more than one vertex, whose degree is more than two). Let us remind you that the degree of a vertex is the number of edges that connect to it.
Let each edge be either black or white. Initially all edges are black.
You are given the description of the beard graph. Your task is to analyze requests of the following types:
- paint the edge number $ i $ black. The edge number $ i $ is the edge that has this number in the description. It is guaranteed that by the moment of this request the $ i $ -th edge is white
- paint the edge number $ i $ white. It is guaranteed that by the moment of this request the $ i $ -th edge is black
- find the length of the shortest path going only along the black edges between vertices $ a $ and $ b $ or indicate that no such path exists between them (a path's length is the number of edges in it)
The vertices are numbered with integers from $ 1 $ to $ n $ , and the edges are numbered with integers from $ 1 $ to $ n-1 $ .</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line of the input contains an integer $ n $ ( $ 2<=n<=10^{5} $ ) — the number of vertices in the graph. Next $ n-1 $ lines contain edges described as the numbers of vertices $ v_{i} $ , $ u_{i} $ ( $ 1<=v_{i},u_{i}<=n $ , $ v_{i}≠u_{i} $ ) connected by this edge. It is guaranteed that the given graph is connected and forms a beard graph, and has no self-loops or multiple edges.
The next line contains an integer $ m $ ( $ 1<=m<=3·10^{5} $ ) — the number of requests. Next $ m $ lines contain requests in the following form: first a line contains an integer $ type $ , which takes values ​​from $ 1 $ to $ 3 $ , and represents the request type.
If $ type=1 $ , then the current request is a request to paint the edge black. In this case, in addition to number $ type $ the line should contain integer $ id $ ( $ 1<=id<=n-1 $ ), which represents the number of the edge to paint.
If $ type=2 $ , then the current request is a request to paint the edge white, its form is similar to the previous request.
If $ type=3 $ , then the current request is a request to find the distance. In this case, in addition to $ type $ , the line should contain two integers $ a $ , $ b $ ( $ 1<=a,b<=n $ , $ a $ can be equal to $ b $ ) — the numbers of vertices, the distance between which must be found.
The numbers in all lines are separated by exactly one space. The edges are numbered in the order in which they are given in the input.</div>
<h3>输出格式</h3>
<br />
<div>For each request to "find the distance between vertices $ a $ and $ b $ " print the result. If there is no path going only along the black edges between vertices $ a $ and $ b $ , then print "-1" (without the quotes). Print the results in the order of receiving the requests, separate the numbers with spaces or line breaks.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>3
1 2
2 3
7
3 1 2
3 1 3
3 2 3
2 2
3 1 2
3 1 3
3 2 3
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>1
2
1
1
-1
-1
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>6
1 5
6 4
2 3
3 5
5 6
6
3 3 4
2 5
3 2 6
3 1 2
2 3
3 3 1
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>3
-1
3
2
</code></pre>
<h2>说明</h2>
<div>In the first sample vertices $ 1 $ and $ 2 $ are connected with edge number $ 1 $ , and vertices $ 2 $ and $ 3 $ are connected with edge number $ 2 $ . Before the repainting edge number $ 2 $ each vertex is reachable from each one along the black edges. Specifically, the shortest path between $ 1 $ and $ 3 $ goes along both edges.
If we paint edge number $ 2 $ white, vertex $ 3 $ will end up cut off from other vertices, that is, no path exists from it to any other vertex along the black edges.</div>
</article>
</div>
</div>
</body>
</html>
