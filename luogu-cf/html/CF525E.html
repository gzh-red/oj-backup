<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Anya and Cubes - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573395091:MDgmEqNE4iPzpVXOkHrk/Eb80enhjLhvb5jfQeDGAl8=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%22%2C%22description%22%3A%22Anya%20loves%20to%20fold%20and%20stick.%20Today%20she%20decided%20to%20do%20just%20that.%5Cn%5CnAnya%20has%20%24%20n%20%24%20cubes%20lying%20in%20a%20line%20and%20numbered%20from%20%24%201%20%24%20to%20%24%20n%20%24%20from%20left%20to%20right%2C%20with%20natural%20numbers%20written%20on%20them.%20She%20also%20has%20%24%20k%20%24%20stickers%20with%20exclamation%20marks.%20We%20know%20that%20the%20number%20of%20stickers%20does%20not%20exceed%20the%20number%20of%20cubes.%5Cn%5CnAnya%20can%20stick%20an%20exclamation%20mark%20on%20the%20cube%20and%20get%20the%20factorial%20of%20the%20number%20written%20on%20the%20cube.%20For%20example%2C%20if%20a%20cube%20reads%20%24%205%20%24%20%2C%20then%20after%20the%20sticking%20it%20reads%20%24%205%21%20%24%20%2C%20which%20equals%20%24%20120%20%24%20.%5Cn%5CnYou%20need%20to%20help%20Anya%20count%20how%20many%20ways%20there%20are%20to%20choose%20some%20of%20the%20cubes%20and%20stick%20on%20some%20of%20the%20chosen%20cubes%20at%20most%20%24%20k%20%24%20exclamation%20marks%20so%20that%20the%20sum%20of%20the%20numbers%20written%20on%20the%20chosen%20cubes%20after%20the%20sticking%20becomes%20equal%20to%20%24%20S%20%24%20.%20Anya%20can%20stick%20at%20most%20one%20exclamation%20mark%20on%20each%20cube.%20Can%20you%20do%20it%3F%5Cn%5CnTwo%20ways%20are%20considered%20the%20same%20if%20they%20have%20the%20same%20set%20of%20chosen%20cubes%20and%20the%20same%20set%20of%20cubes%20with%20exclamation%20marks.%22%2C%22inputFormat%22%3A%22The%20first%20line%20of%20the%20input%20contains%20three%20space-separated%20integers%20%24%20n%20%24%20%2C%20%24%20k%20%24%20and%20%24%20S%20%24%20%28%20%24%201%3C%3Dn%3C%3D25%20%24%20%2C%20%24%200%3C%3Dk%3C%3Dn%20%24%20%2C%20%24%201%3C%3DS%3C%3D10%5E%7B16%7D%20%24%20%29%20%5Cu2014%20the%20number%20of%20cubes%20and%20the%20number%20of%20stickers%20that%20Anya%20has%2C%20and%20the%20sum%20that%20she%20needs%20to%20get.%5Cn%5CnThe%20second%20line%20contains%20%24%20n%20%24%20positive%20integers%20%24%20a_%7Bi%7D%20%24%20%28%20%24%201%3C%3Da_%7Bi%7D%3C%3D10%5E%7B9%7D%20%24%20%29%20%5Cu2014%20the%20numbers%2C%20written%20on%20the%20cubes.%20The%20cubes%20in%20the%20input%20are%20described%20in%20the%20order%20from%20left%20to%20right%2C%20starting%20from%20the%20first%20one.%5Cn%5CnMultiple%20cubes%20can%20contain%20the%20same%20numbers.%22%2C%22outputFormat%22%3A%22Output%20the%20number%20of%20ways%20to%20choose%20some%20number%20of%20cubes%20and%20stick%20exclamation%20marks%20on%20some%20of%20them%20so%20that%20the%20sum%20of%20the%20numbers%20became%20equal%20to%20the%20given%20number%20%24%20S%20%24%20.%22%2C%22samples%22%3A%5B%5B%222%202%2030%5Cn4%203%5Cn%22%2C%221%5Cn%22%5D%2C%5B%222%202%207%5Cn4%203%5Cn%22%2C%221%5Cn%22%5D%2C%5B%223%201%201%5Cn1%201%201%5Cn%22%2C%226%5Cn%22%5D%5D%2C%22hint%22%3A%22In%20the%20first%20sample%20the%20only%20way%20is%20to%20choose%20both%20cubes%20and%20stick%20an%20exclamation%20mark%20on%20each%20of%20them.%5Cn%5CnIn%20the%20second%20sample%20the%20only%20way%20is%20to%20choose%20both%20cubes%20but%20don%27t%20stick%20an%20exclamation%20mark%20on%20any%20of%20them.%5Cn%5CnIn%20the%20third%20sample%20it%20is%20possible%20to%20choose%20any%20of%20the%20cubes%20in%20three%20ways%2C%20and%20also%20we%20may%20choose%20to%20stick%20or%20not%20to%20stick%20the%20exclamation%20mark%20on%20it.%20So%2C%20the%20total%20number%20of%20ways%20is%20six.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F525%5C%2FE%22%2C%22id%22%3A%22525E%22%7D%2C%22translation%22%3A%22%5Cu7ed9%5Cu4f60%24n%24%20%5Cu4e2a%5Cu6570%2C%24n%5C%5Cle%2026%24%20%5Cu521d%5Cu59cb%5Cu5e8f%5Cu5217%5Cu4e3a%24a_i%2C0%5C%5Cle%20a_i%5C%5Cle%2010%5E9%24%20%5Cn%5Cn%5Cu4f60%5Cu6709%24k%24%20%5Cu4e2a%24%21%24%20%2C%5Cu6bcf%5Cu4e2a%24%21%24%20%5Cu53ef%5Cu4ee5%5Cu4f7f%5Cu5e8f%5Cu5217%5Cu4e2d%5Cu7684%5Cu4e00%5Cu4e2a%5Cu6570%5Cu53d8%5Cu6210%24a_i%21%24%20%5Cn%5Cn%5Cu4f8b%5Cu5982%245%21%3D120%24%20%5Cn%5Cn%5Cu6c42%3A%5Cu9009%5Cu51fa%5Cu4efb%5Cu610f%5Cu4e2a%5Cu6570%5Cu4f7f%5Cu4ed6%5Cu4eec%5Cu548c%5Cu7684%5Cu7b49%5Cu4e8eS%5Cu7684%5Cu65b9%5Cu6848%5Cu6570%5Cn%5Cn%23%23%20%5Cu8f93%5Cu5165%5Cu683c%5Cu5f0f%5Cn%5Cu7b2c%5Cu4e00%5Cu884c%24n%2Ck%2CS%24%20%5Cn%5Cn%5Cu7b2c%5Cu4e8c%5Cu884cn%5Cu4e2a%5Cu6570%2C%5Cu5206%5Cu522b%5Cu4ee3%5Cu8868%24a_i%24%20%5Cn%5Cn%23%23%20%5Cu8f93%5Cu51fa%5Cn%5Cu4e00%5Cu884c%5Cu4e00%5Cu4e2a%5Cu6574%5Cu6570%2C%5Cu9009%5Cu51fa%5Cu6570%5Cu7684%5Cu5408%5Cu6cd5%5Cu65b9%5Cu6848%5Cu6570%5Cn%5Cn%5Cu611f%5Cu8c22%40s_a_b_e_r%20%20%5Cu63d0%5Cu4f9b%5Cu7684%5Cu7ffb%5Cu8bd1%22%2C%22tags%22%3A%5B4%2C111%2C128%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A613%2C%22totalAccepted%22%3A164%2C%22pid%22%3A%22CF525E%22%2C%22title%22%3A%22Anya%20and%20Cubes%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A145955%2C%22title%22%3A%22%5Cu9898%5Cu9762%5Cu6709%5Cu8bef%22%2C%22forum%22%3A%7B%22id%22%3A10560%2C%22name%22%3A%22CF525E%20Anya%20and%20Cubes%22%2C%22slug%22%3A%22CF525E%22%7D%7D%2C%7B%22id%22%3A36441%2C%22title%22%3A%22%5Cu9898%5Cu610f%22%2C%22forum%22%3A%7B%22id%22%3A10560%2C%22name%22%3A%22CF525E%20Anya%20and%20Cubes%22%2C%22slug%22%3A%22CF525E%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P1585%22%2C%22title%22%3A%22%5Cu9b54%5Cu6cd5%5Cu9635%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P2534%22%2C%22title%22%3A%22%5BAHOI2012%5D%5Cu94c1%5Cu76d8%5Cu6574%5Cu7406%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22CF464E%22%2C%22title%22%3A%22The%20Classic%20Problem%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF163D%22%2C%22title%22%3A%22Large%20Refrigerator%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22P4317%22%2C%22title%22%3A%22%5Cu82b1%5Cu795e%5Cu7684%5Cu6570%5Cu8bba%5Cu9898%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Anya%20and%20Cubes%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573306449;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Anya and Cubes</h1>
<h2>题意翻译</h2>
<div>给你$n$ 个数,$n\le 26$ 初始序列为$a_i,0\le a_i\le 10^9$
你有$k$ 个$!$ ,每个$!$ 可以使序列中的一个数变成$a_i!$
例如$5!=120$
求:选出任意个数使他们和的等于S的方案数
## 输入格式
第一行$n,k,S$
第二行n个数,分别代表$a_i$
## 输出
一行一个整数,选出数的合法方案数
感谢@s_a_b_e_r 提供的翻译</div>
<h2>题目描述</h2>
<div>Anya loves to fold and stick. Today she decided to do just that.
Anya has $ n $ cubes lying in a line and numbered from $ 1 $ to $ n $ from left to right, with natural numbers written on them. She also has $ k $ stickers with exclamation marks. We know that the number of stickers does not exceed the number of cubes.
Anya can stick an exclamation mark on the cube and get the factorial of the number written on the cube. For example, if a cube reads $ 5 $ , then after the sticking it reads $ 5! $ , which equals $ 120 $ .
You need to help Anya count how many ways there are to choose some of the cubes and stick on some of the chosen cubes at most $ k $ exclamation marks so that the sum of the numbers written on the chosen cubes after the sticking becomes equal to $ S $ . Anya can stick at most one exclamation mark on each cube. Can you do it?
Two ways are considered the same if they have the same set of chosen cubes and the same set of cubes with exclamation marks.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line of the input contains three space-separated integers $ n $ , $ k $ and $ S $ ( $ 1<=n<=25 $ , $ 0<=k<=n $ , $ 1<=S<=10^{16} $ ) — the number of cubes and the number of stickers that Anya has, and the sum that she needs to get.
The second line contains $ n $ positive integers $ a_{i} $ ( $ 1<=a_{i}<=10^{9} $ ) — the numbers, written on the cubes. The cubes in the input are described in the order from left to right, starting from the first one.
Multiple cubes can contain the same numbers.</div>
<h3>输出格式</h3>
<br />
<div>Output the number of ways to choose some number of cubes and stick exclamation marks on some of them so that the sum of the numbers became equal to the given number $ S $ .</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>2 2 30
4 3
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>1
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>2 2 7
4 3
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>1
</code></pre>
<h3>输入样例 #3</h3>
<pre><code>3 1 1
1 1 1
</code></pre>
<h3>输出样例 #3</h3>
<pre><code>6
</code></pre>
<h2>说明</h2>
<div>In the first sample the only way is to choose both cubes and stick an exclamation mark on each of them.
In the second sample the only way is to choose both cubes but don't stick an exclamation mark on any of them.
In the third sample it is possible to choose any of the cubes in three ways, and also we may choose to stick or not to stick the exclamation mark on it. So, the total number of ways is six.</div>
</article>
</div>
</div>
</body>
</html>
