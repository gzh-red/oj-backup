<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Broken Tree - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573397538:TwQp0qNG2958+s+ztqJQXsepLBJjJzhI1Ykgt0vTgQY=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%22%2C%22description%22%3A%22You%20are%20given%20a%20tree%20that%20has%20%24%20n%20%24%20vertices%2C%20which%20are%20numbered%20from%20%24%201%20%24%20to%20%24%20n%20%24%20%2C%20where%20the%20vertex%20number%20one%20is%20the%20root.%20Each%20edge%20has%20weight%20%24%20w_%7Bi%7D%20%24%20and%20strength%20%24%20p_%7Bi%7D%20%24%20.%5Cn%5CnBotanist%20Innokentiy%2C%20who%20is%20the%20only%20member%20of%20the%20jury%20of%20the%20Olympiad%20in%20Informatics%2C%20doesn%27t%20like%20broken%20trees.%5Cn%5CnThe%20tree%20is%20broken%20if%20there%20is%20such%20an%20edge%20the%20strength%20of%20which%20is%20less%20than%20the%20sum%20of%20weight%20of%20subtree%27s%20edges%20to%20which%20it%20leads.%5Cn%5CnIt%20is%20allowed%20to%20reduce%20weight%20of%20any%20edge%20by%20arbitrary%20integer%20value%2C%20but%20then%20the%20strength%20of%20its%20edge%20is%20reduced%20by%20the%20same%20value.%20It%20means%20if%20the%20weight%20of%20the%20edge%20is%20%24%2010%20%24%20%2C%20and%20the%20strength%20is%20%24%2012%20%24%20%2C%20then%20by%20the%20reducing%20the%20weight%20by%20%24%207%20%24%20its%20weight%20will%20equal%20%24%203%20%24%20%2C%20and%20the%20strength%20will%20equal%20%24%205%20%24%20.%5Cn%5CnIt%20is%20not%20allowed%20to%20increase%20the%20weight%20of%20the%20edge.%5Cn%5CnYour%20task%20is%20to%20get%20the%20tree%2C%20which%20is%20not%20broken%2C%20by%20reducing%20the%20weight%20of%20edges%20of%20the%20given%20tree%2C%20and%20also%20all%20edged%20should%20have%20the%20positive%20weight%2C%20moreover%2C%20the%20total%20weight%20of%20all%20edges%20should%20be%20as%20large%20as%20possible.%5Cn%5CnIt%20is%20obvious%20that%20the%20strength%20of%20edges%20can%20not%20be%20negative%2C%20however%20it%20can%20equal%20zero%20if%20the%20weight%20of%20the%20subtree%20equals%20zero.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20the%20integer%20%24%20n%20%24%20%28%20%24%201%3C%3Dn%3C%3D2%5Cu00b710%5E%7B5%7D%20%24%20%29%20%5Cu2014%20the%20number%20of%20vertices%20in%20the%20tree.%20The%20next%20%24%20n-1%20%24%20lines%20contains%20the%20description%20of%20edges.%20Each%20line%20contains%20four%20integers%20%24%20x%20%24%20%2C%20%24%20y%20%24%20%2C%20%24%20w%20%24%20%2C%20%24%20p%20%24%20%28%20%24%201%3C%3Dx%2Cy%3C%3Dn%2C1%3C%3Dw%3C%3D10%5E%7B9%7D%2C0%3C%3Dp%3C%3D10%5E%7B9%7D%20%24%20%29%2C%20where%20%24%20x%20%24%20and%20%24%20y%20%24%20%5Cu2014%20vertices%20which%20connect%20the%20edge%20%28the%20vertex%20number%20%24%20x%20%24%20is%20the%20parent%20of%20the%20vertex%20number%20%24%20y%20%24%20%29%2C%20%24%20w%20%24%20and%20%24%20p%20%24%20are%20the%20weight%20and%20the%20strength%20of%20the%20edge%2C%20accordingly.%20It%20is%20guaranteed%20that%20the%20edges%20describe%20the%20tree%20with%20the%20root%20in%20the%20vertex%20%24%201%20%24%20.%22%2C%22outputFormat%22%3A%22If%20it%20is%20impossible%20to%20get%20unbroken%20tree%20from%20the%20given%20tree%2C%20print%20-1%20in%20the%20only%20line.%5Cn%5CnOtherwise%2C%20the%20output%20data%20should%20contain%20%24%20n%20%24%20lines%3A%5Cn%5CnIn%20the%20first%20line%20print%20the%20number%20%24%20n%20%24%20%5Cu2014%20the%20number%20of%20vertices%20on%20the%20tree.%5Cn%5CnIn%20the%20next%20%24%20n-1%20%24%20lines%20print%20the%20description%20of%20edges%20of%20the%20resulting%20tree.%20Each%20line%20should%20contain%20four%20integers%20%24%20x%20%24%20%2C%20%24%20y%20%24%20%2C%20%24%20w%20%24%20%2C%20%24%20p%20%24%20%28%20%24%201%3C%3Dx%2Cy%3C%3Dn%2C1%3C%3Dw%3C%3D10%5E%7B9%7D%2C0%3C%3Dp%3C%3D10%5E%7B9%7D%20%24%20%29%2C%20where%20%24%20x%20%24%20and%20%24%20y%20%24%20%5Cu2014%20vertices%2C%20which%20the%20edge%20connects%20%28the%20vertex%20number%20%24%20x%20%24%20is%20the%20parent%20of%20the%20vertex%20number%20%24%20y%20%24%20%29%2C%20%24%20w%20%24%20and%20%24%20p%20%24%20are%20the%20new%20weight%20and%20the%20strength%20of%20the%20edge%2C%20accordingly.%5Cn%5CnPrint%20edges%20in%20the%20same%20order%20as%20they%20are%20given%20in%20input%20data%3A%20the%20first%20two%20integers%20of%20each%20line%20should%20not%20be%20changed.%22%2C%22samples%22%3A%5B%5B%223%5Cn1%203%205%207%5Cn3%202%204%203%5Cn%22%2C%223%5Cn1%203%205%207%5Cn3%202%204%203%5Cn%22%5D%2C%5B%224%5Cn1%203%202%203%5Cn3%204%205%201%5Cn3%202%203%203%5Cn%22%2C%22-1%22%5D%2C%5B%225%5Cn1%202%202%204%5Cn2%204%201%209%5Cn4%205%205%206%5Cn4%203%204%208%5Cn%22%2C%225%5Cn1%202%202%204%5Cn2%204%201%209%5Cn4%205%201%202%5Cn4%203%202%206%5Cn%22%5D%2C%5B%227%5Cn1%202%205%202%5Cn2%203%204%203%5Cn1%204%203%207%5Cn4%205%204%201%5Cn4%206%203%202%5Cn6%207%201%206%5Cn%22%2C%227%5Cn1%202%205%202%5Cn2%203%202%201%5Cn1%204%203%207%5Cn4%205%203%200%5Cn4%206%203%202%5Cn6%207%201%206%5Cn%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B4000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F758%5C%2FE%22%2C%22id%22%3A%22758E%22%7D%2C%22translation%22%3A%22%5Cu9898%5Cu9762%5Cuff1a%5Cn%5Cn%5Cu7ed9%5Cu5b9a%5Cu4e00%5Cu68f5%5Cu6709n%5Cu4e2a%5Cu8282%5Cu70b9%5Cu7684%5Cu6811%5Cuff0c%5Cu5176%5Cu4e2d%5Cu4e00%5Cu53f7%5Cu70b9%5Cu662f%5Cu6839%5Cu3002%5Cu6bcf%5Cu6761%5Cu8fb9%5Cu6709%5Cu91cd%5Cu91cf%5Cu548c%5Cu5f3a%5Cu5ea6%5Cu3002%5Cu5982%5Cu679c%5Cu4e00%5Cu6761%5Cu8fb9%5Cu7684%5Cu5f3a%5Cu5ea6%5Cu5c0f%5Cu4e8e%5Cu8fd9%5Cu6761%5Cu8fb9%5Cu6df1%5Cu5ea6%5Cu8f83%5Cu5927%5Cu7684%5Cu70b9%5Cu7684%5Cu5b50%5Cu6811%5Cu5185%5Cu6240%5Cu6709%5Cu8fb9%5Cu91cd%5Cu91cf%5Cu548c%5Cuff0c%5Cu5219%5Cu8fd9%5Cu6761%5Cu8fb9%5Cu4f1a%5Cu65ad%5Cu88c2%5Cu3002%5Cu4f60%5Cu53ef%5Cu4ee5%5Cu964d%5Cu4f4e%5Cu4e00%5Cu4e9b%5Cu8fb9%5Cu7684%5Cu91cd%5Cu91cf%5Cuff0c%5Cu4e14%5Cu88ab%5Cu964d%5Cu4f4e%5Cu91cd%5Cu91cf%5Cu7684%5Cu8fb9%5Cu4f1a%5Cu635f%5Cu5931%5Cu7b49%5Cu91cf%5Cu7684%5Cu5f3a%5Cu5ea6%5Cu3002%5Cu6bcf%5Cu6761%5Cu8fb9%5Cu7684%5Cu6700%5Cu7ec8%5Cu91cd%5Cu91cf%5Cu5fc5%5Cu987b%5Cu4e3a%5Cu6b63%5Cu6574%5Cu6570%5Cuff0c%5Cu5f3a%5Cu5ea6%5Cu5fc5%5Cu987b%5Cu4e3a%5Cu975e%5Cu8d1f%5Cu6574%5Cu6570%5Cu3002%5Cu8be2%5Cu95ee%5Cu81f3%5Cu5c11%5Cu8981%5Cu964d%5Cu4f4e%5Cu591a%5Cu5c11%5Cu91cd%5Cu91cf%5Cuff0c%5Cu6216%5Cu8005%5Cu8f93%5Cu51fa-1%5Cu8868%5Cu793a%5Cu8fd9%5Cu68f5%5Cu6811%5Cu65e0%5Cu8bba%5Cu5982%5Cu4f55%5Cu90fd%5Cu4f1a%5Cu65ad%5Cu88c2%5Cu3002%5Cu672c%5Cu9898%5Cu914d%5Cu6709SPJ%5Cn%5Cn%5Cu8f93%5Cu5165%5Cu683c%5Cu5f0f%5Cuff1a%5Cn%5Cu7b2c%5Cu4e00%5Cu884c%5Cu4e00%5Cu4e2a%5Cu6570n%5Cu8868%5Cu793a%5Cu8282%5Cu70b9%5Cu6570%5Cu91cf%5Cn%5Cu63a5%5Cu4e0b%5Cu6765n-1%5Cu884c%5Cu6bcf%5Cu884c%5Cu56db%5Cu4e2a%5Cu6570x%2Cy%2Cw%2Cp%5Cu8868%5Cu793ax%5Cu662fy%5Cu7684%5Cu7236%5Cu4eb2%5Cu8282%5Cu70b9%3B%5Cu8fd9%5Cu6761%5Cu8fb9%5Cu7684%5Cu91cd%5Cu91cfw%5Cu4ee5%5Cu53ca%5Cu5f3a%5Cu5ea6p%5Cn%5Cn%5Cu8f93%5Cu51fa%5Cu683c%5Cu5f0f%5Cuff1a%5Cn%5Cu5982%5Cu679c%5Cu4e0d%5Cu5b58%5Cu5728%5Cu6ee1%5Cu8db3%5Cu6761%5Cu4ef6%5Cu7684%5Cu6811%5Cu5219%5Cu8f93%5Cu51fa-1%5Cn%5Cu5426%5Cu5219%5Cu7b2c%5Cu4e00%5Cu884c%5Cu8f93%5Cu51fa%5Cu4e00%5Cu4e2a%5Cu6570n%5Cu8868%5Cu793a%5Cu8282%5Cu70b9%5Cu6570%5Cu91cf%5Cn%5Cu63a5%5Cu4e0b%5Cu6765n-1%5Cu884c%5Cu6bcf%5Cu884c%5Cu56db%5Cu4e2a%5Cu6570%5Cuff0c%5Cu683c%5Cu5f0f%5Cu540c%5Cu8f93%5Cu5165%5Cu683c%5Cu5f0f%5Cuff0c%5Cu8868%5Cu793a%5Cu6700%5Cu7ec8%5Cu6811%5Cu7684%5Cu5f62%5Cu6001%5Cn%5Cu8f93%5Cu51fa%5Cu7684%5Cu6811%5Cu5fc5%5Cu987b%5Cu4fdd%5Cu8bc1%5Cu964d%5Cu4f4e%5Cu7684%5Cu91cd%5Cu91cf%5Cu548c%5Cu6700%5Cu5c0f%5Cu4e14%5Cu6ca1%5Cu6709%5Cu8fb9%5Cu4f1a%5Cu65ad%5Cu88c2%5Cn%5Cn%5Cn%5Cu7531%20%40%5Cu6d41%5Cu98ce%5Cu4e4b%5Cu56de%5Cu96ea%20%5Cu63d0%5Cu4f9b%5Cu7ffb%5Cu8bd1%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A3%2C%22totalAccepted%22%3A3%2C%22pid%22%3A%22CF758E%22%2C%22title%22%3A%22Broken%20Tree%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A43215%2C%22title%22%3A%22%5Cu7ffb%5Cu8bd1%22%2C%22forum%22%3A%7B%22id%22%3A9577%2C%22name%22%3A%22CF758E%20Broken%20Tree%22%2C%22slug%22%3A%22CF758E%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Broken%20Tree%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Broken Tree</h1>
<h2>题意翻译</h2>
<div>题面：
给定一棵有n个节点的树，其中一号点是根。每条边有重量和强度。如果一条边的强度小于这条边深度较大的点的子树内所有边重量和，则这条边会断裂。你可以降低一些边的重量，且被降低重量的边会损失等量的强度。每条边的最终重量必须为正整数，强度必须为非负整数。询问至少要降低多少重量，或者输出-1表示这棵树无论如何都会断裂。本题配有SPJ
输入格式：
第一行一个数n表示节点数量
接下来n-1行每行四个数x,y,w,p表示x是y的父亲节点;这条边的重量w以及强度p
输出格式：
如果不存在满足条件的树则输出-1
否则第一行输出一个数n表示节点数量
接下来n-1行每行四个数，格式同输入格式，表示最终树的形态
输出的树必须保证降低的重量和最小且没有边会断裂
由 @流风之回雪 提供翻译</div>
<h2>题目描述</h2>
<div>You are given a tree that has $ n $ vertices, which are numbered from $ 1 $ to $ n $ , where the vertex number one is the root. Each edge has weight $ w_{i} $ and strength $ p_{i} $ .
Botanist Innokentiy, who is the only member of the jury of the Olympiad in Informatics, doesn't like broken trees.
The tree is broken if there is such an edge the strength of which is less than the sum of weight of subtree's edges to which it leads.
It is allowed to reduce weight of any edge by arbitrary integer value, but then the strength of its edge is reduced by the same value. It means if the weight of the edge is $ 10 $ , and the strength is $ 12 $ , then by the reducing the weight by $ 7 $ its weight will equal $ 3 $ , and the strength will equal $ 5 $ .
It is not allowed to increase the weight of the edge.
Your task is to get the tree, which is not broken, by reducing the weight of edges of the given tree, and also all edged should have the positive weight, moreover, the total weight of all edges should be as large as possible.
It is obvious that the strength of edges can not be negative, however it can equal zero if the weight of the subtree equals zero.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains the integer $ n $ ( $ 1<=n<=2·10^{5} $ ) — the number of vertices in the tree. The next $ n-1 $ lines contains the description of edges. Each line contains four integers $ x $ , $ y $ , $ w $ , $ p $ ( $ 1<=x,y<=n,1<=w<=10^{9},0<=p<=10^{9} $ ), where $ x $ and $ y $ — vertices which connect the edge (the vertex number $ x $ is the parent of the vertex number $ y $ ), $ w $ and $ p $ are the weight and the strength of the edge, accordingly. It is guaranteed that the edges describe the tree with the root in the vertex $ 1 $ .</div>
<h3>输出格式</h3>
<br />
<div>If it is impossible to get unbroken tree from the given tree, print -1 in the only line.
Otherwise, the output data should contain $ n $ lines:
In the first line print the number $ n $ — the number of vertices on the tree.
In the next $ n-1 $ lines print the description of edges of the resulting tree. Each line should contain four integers $ x $ , $ y $ , $ w $ , $ p $ ( $ 1<=x,y<=n,1<=w<=10^{9},0<=p<=10^{9} $ ), where $ x $ and $ y $ — vertices, which the edge connects (the vertex number $ x $ is the parent of the vertex number $ y $ ), $ w $ and $ p $ are the new weight and the strength of the edge, accordingly.
Print edges in the same order as they are given in input data: the first two integers of each line should not be changed.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>3
1 3 5 7
3 2 4 3
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>3
1 3 5 7
3 2 4 3
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>4
1 3 2 3
3 4 5 1
3 2 3 3
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>-1</code></pre>
<h3>输入样例 #3</h3>
<pre><code>5
1 2 2 4
2 4 1 9
4 5 5 6
4 3 4 8
</code></pre>
<h3>输出样例 #3</h3>
<pre><code>5
1 2 2 4
2 4 1 9
4 5 1 2
4 3 2 6
</code></pre>
<h3>输入样例 #4</h3>
<pre><code>7
1 2 5 2
2 3 4 3
1 4 3 7
4 5 4 1
4 6 3 2
6 7 1 6
</code></pre>
<h3>输出样例 #4</h3>
<pre><code>7
1 2 5 2
2 3 2 1
1 4 3 7
4 5 3 0
4 6 3 2
6 7 1 6
</code></pre>
</article>
</div>
</div>
</body>
</html>
