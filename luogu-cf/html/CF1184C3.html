<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Heidi and the Turing Test (Hard) - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573402763:GlJ4ta62pkgNkO5emUe0iN6cVIKSJLorO3TzypxtAtg=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22The%20Cybermen%20have%20again%20outwitted%20the%20Daleks%21%20Unfortunately%2C%20this%20time%20the%20Daleks%20decided%20to%20abandon%20these%20tasks%20altogether%2C%20which%20means%20the%20Doctor%20has%20to%20deal%20with%20them.%5Cn%5CnThe%20Doctor%20can%20handle%20the%20Daleks%20on%20his%20own%2C%20but%20Heidi%20now%20has%20to%20make%20sure%20that%20the%20Cybermen%20are%20kept%20busy%20with%20this%20next%20task.%5Cn%5CnThere%20are%20%24%20k%20%24%20rings%20on%20a%20plane.%20For%20each%20ring%2C%20%24%20n%20%24%20points%20are%20uniformly%20sampled%20with%20a%20small%20random%20noise.%20The%20task%20is%20to%20recover%20the%20rings%20given%20only%20the%20noisy%20samples.%5Cn%5CnThe%20rings%20and%20the%20samples%20are%20generated%20as%20follows.%20The%20center%20of%20a%20ring%20is%20uniformly%20sampled%20from%20a%20disk%20of%20radius%20%24%201%5C%5C%2C000%5C%5C%2C000%20%24%20centered%20at%20the%20origin%2C%20and%20the%20radius%20of%20the%20ring%20is%20uniformly%20sampled%20from%20%24%20%5B250%5C%5C%2C000%2C%20750%5C%5C%2C000%5D%20%24%20.%20Let%20%24%20R%20%24%20be%20a%20ring%20with%20center%20%24%20%28x%2C%20y%29%20%24%20and%20radius%20%24%20r%20%24%20.%20To%20sample%20a%20point%20from%20%24%20R%20%24%20%2C%20an%20angle%20%24%20%5C%5Ctheta%20%24%20is%20uniformly%20sampled%20from%20%24%20%5B0%2C%202%5C%5Cpi%5D%20%24%20and%20a%20distance%20%24%20d%20%24%20is%20uniformly%20sampled%20from%20%24%20%5B0.9r%2C%201.1r%5D%20%24%20.%20The%20coordinates%20of%20the%20sampled%20point%20are%20then%20%24%20%28x%2Bd%5C%5Ccos%28%5C%5Ctheta%29%2C%20y%2Bd%5C%5Csin%28%5C%5Ctheta%29%29%20%24%20rounded%20to%20the%20closest%20integers.%5Cn%5CnThe%20distance%20between%20rings%20is%20measured%20by%20their%20Hausdorff%20distance.%20In%20our%20case%2C%20the%20distance%20between%20two%20rings%20%24%20R_1%2C%20R_2%20%24%20can%20be%20written%20as%20follow.%20Let%20%24%20d%20%24%20be%20the%20distance%20between%20the%20two%20centers%20and%20%24%20r_1%2C%20r_2%20%24%20be%20the%20radii.%20Then%20the%20distance%20is%20%24%20%24%24%24dist%28R_1%2C%20R_2%29%3D%5C%5Cmax%28%5C%5Cmin%28d_%7B--%7D%2C%20d_%7B-%2B%7D%29%2C%5C%5Cmin%28d_%7B%2B-%7D%2C%20d_%7B%2B%2B%7D%29%2C%20%5C%5Cmin%28d_%7B--%7D%2C%20d_%7B%2B-%7D%29%2C%20%5C%5Cmin%28d_%7B-%2B%7D%2C%20d_%7B%2B%2B%7D%29%29%20%24%20%24%20%2C%20where%20%20%24%20d%5C%5C_%7B%2B%2B%7D%3D%7Cd%2Br%5C%5C_1%2Br%5C%5C_2%7C%20%24%20%2C%20%20%24%20d%5C%5C_%7B%2B-%7D%3D%7Cd%2Br%5C%5C_1-r%5C%5C_2%7C%20%24%20%2C%20%20%24%20d%5C%5C_%7B-%2B%7D%3D%7Cd-r%5C%5C_1%2Br%5C%5C_2%7C%20%24%20%2C%20%20%24%20d%5C%5C_%7B--%7D%3D%7Cd-r%5C%5C_1-r%5C%5C_2%7C%20%24%20.%3C%5C%2Fp%3E%3Cp%3EWe%20say%20that%20a%20ring%20%20%24%20R%5C%5C_0%20%24%20%20is%20recovered%20if%20one%20of%20the%20rings%20%20%24%20R%20%24%20%20in%20the%20output%20has%20Hausdorff%20distance%20less%20than%20%20%24%20100%5C%5C%5C%5C%2C000%20%24%20%20from%20%20%24%20R%5C%5C_0%20%24%20.%20%3C%5C%2Fp%3E%3Cp%3EAn%20output%20is%20accepted%20if%20all%20the%20rings%20are%20recovered.%20It%20is%20guaranteed%20that%20the%20distances%20between%20any%20two%20rings%20is%20greater%20than%20%20%24%20600%5C%5C%5C%5C%2C000%24%24%24.%5Cn%5CnRemember%20that%20a%20human%20can%20very%20easily%20solve%20this%20task%2C%20so%20make%20sure%20that%20no%20human%20traitors%20are%20helping%20the%20Cybermen%20complete%20this%20task.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20an%20integer%20%24%20k%20%24%20%28%20%24%201%20%5C%5Cleq%20k%20%5C%5Cleq%204%20%24%20%29%2C%20the%20number%20of%20rings.%5Cn%5CnThe%20second%20line%20contains%20an%20integer%20%24%20n%20%24%20%28%20%24%20100%20%5C%5Cleq%20n%20%5C%5Cleq%201%5C%5C%2C000%20%24%20%29%2C%20the%20number%20of%20samples%20per%20ring.%5Cn%5CnThe%20following%20%24%20n%20%5C%5Ctimes%20k%20%24%20lines%20contain%20the%20samples%2C%20one%20sample%20per%20line.%5Cn%5CnEach%20line%20contains%20a%20pair%20of%20integers%20%24%20x_i%2C%20y_i%20%24%20%2C%20where%20%24%20%28x_i%2C%20y_i%29%20%24%20are%20the%20coordinates%20of%20the%20%24%20i%20%24%20-th%20sample.%22%2C%22outputFormat%22%3A%22%22%2C%22samples%22%3A%5B%5D%2C%22hint%22%3A%22Here%20is%20how%20one%20of%20tests%20with%20%24%20k%3D4%20%24%20and%20%24%20n%3D100%20%24%20looks%20like.%5Cn%5Cn%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF1184C3%5C%2Fd78b71dfb582cda9ad7b1972e1d1931c9fb4a31d.png%29You%20can%20download%20the%20sample%20input%20and%20output%20%5Bhere%5D%28%5C%2F%5C%2Fassets.codeforces.com%5C%2Frounds%5C%2F1184%5C%2Fc1.zip%29.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B15000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F1184%5C%2FC3%22%2C%22id%22%3A%221184C3%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22CF1184C3%22%2C%22title%22%3A%22Heidi%20and%20the%20Turing%20Test%20%28Hard%29%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Heidi%20and%20the%20Turing%20Test%20%28Hard%29%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Heidi and the Turing Test (Hard)</h1>
<h2>题目描述</h2>
<div>The Cybermen have again outwitted the Daleks! Unfortunately, this time the Daleks decided to abandon these tasks altogether, which means the Doctor has to deal with them.
The Doctor can handle the Daleks on his own, but Heidi now has to make sure that the Cybermen are kept busy with this next task.
There are $ k $ rings on a plane. For each ring, $ n $ points are uniformly sampled with a small random noise. The task is to recover the rings given only the noisy samples.
The rings and the samples are generated as follows. The center of a ring is uniformly sampled from a disk of radius $ 1\,000\,000 $ centered at the origin, and the radius of the ring is uniformly sampled from $ [250\,000, 750\,000] $ . Let $ R $ be a ring with center $ (x, y) $ and radius $ r $ . To sample a point from $ R $ , an angle $ \theta $ is uniformly sampled from $ [0, 2\pi] $ and a distance $ d $ is uniformly sampled from $ [0.9r, 1.1r] $ . The coordinates of the sampled point are then $ (x+d\cos(\theta), y+d\sin(\theta)) $ rounded to the closest integers.
The distance between rings is measured by their Hausdorff distance. In our case, the distance between two rings $ R_1, R_2 $ can be written as follow. Let $ d $ be the distance between the two centers and $ r_1, r_2 $ be the radii. Then the distance is $ $$$dist(R_1, R_2)=\max(\min(d_{--}, d_{-+}),\min(d_{+-}, d_{++}), \min(d_{--}, d_{+-}), \min(d_{-+}, d_{++})) $ $ , where $ d\_{++}=|d+r\_1+r\_2| $ , $ d\_{+-}=|d+r\_1-r\_2| $ , $ d\_{-+}=|d-r\_1+r\_2| $ , $ d\_{--}=|d-r\_1-r\_2| $ .</p><p>We say that a ring $ R\_0 $ is recovered if one of the rings $ R $ in the output has Hausdorff distance less than $ 100\\,000 $ from $ R\_0 $ . </p><p>An output is accepted if all the rings are recovered. It is guaranteed that the distances between any two rings is greater than $ 600\\,000$$$.
Remember that a human can very easily solve this task, so make sure that no human traitors are helping the Cybermen complete this task.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains an integer $ k $ ( $ 1 \leq k \leq 4 $ ), the number of rings.
The second line contains an integer $ n $ ( $ 100 \leq n \leq 1\,000 $ ), the number of samples per ring.
The following $ n \times k $ lines contain the samples, one sample per line.
Each line contains a pair of integers $ x_i, y_i $ , where $ (x_i, y_i) $ are the coordinates of the $ i $ -th sample.</div>
<h3>输出格式</h3>
<br />
<div></div>
<h2>输入输出样例</h2>
<i>暂无测试点</i>
<h2>说明</h2>
<div>Here is how one of tests with $ k=4 $ and $ n=100 $ looks like.
![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1184C3/d78b71dfb582cda9ad7b1972e1d1931c9fb4a31d.png)You can download the sample input and output [here](//assets.codeforces.com/rounds/1184/c1.zip).</div>
</article>
</div>
</div>
</body>
</html>
