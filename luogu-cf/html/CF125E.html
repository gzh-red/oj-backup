<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>MST Company - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573390991:045IKqRBsZO1McwnEbJqpKCG1IHF/5BvDZLhELIjerU=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%22%2C%22description%22%3A%22The%20MST%20%28Meaningless%20State%20Team%29%20company%20won%20another%20tender%20for%20an%20important%20state%20reform%20in%20Berland.%5Cn%5CnThere%20are%20%24%20n%20%24%20cities%20in%20Berland%2C%20some%20pairs%20of%20the%20cities%20are%20connected%20by%20roads.%20Each%20road%20has%20its%20price.%20One%20can%20move%20along%20any%20road%20in%20any%20direction.%20The%20MST%20team%20should%20carry%20out%20the%20repair%20works%20on%20some%20set%20of%20roads%20such%20that%20one%20can%20get%20from%20any%20city%20to%20any%20other%20one%20moving%20only%20along%20the%20repaired%20roads.%20Moreover%2C%20this%20set%20should%20contain%20exactly%20%24%20k%20%24%20capital%20roads%20%28that%20is%2C%20the%20roads%20that%20start%20or%20finish%20in%20the%20capital%29.%20The%20number%20of%20the%20capital%20is%201.%5Cn%5CnAs%20the%20budget%20has%20already%20been%20approved%2C%20the%20MST%20Company%20will%20profit%20by%20finding%20the%20set%20with%20minimum%20lengths%20of%20roads.%22%2C%22inputFormat%22%3A%22The%20first%20input%20line%20contains%20three%20integers%20%24%20n%2Cm%2Ck%20%24%20%28%20%24%201%3C%3Dn%3C%3D5000%3B0%3C%3Dm%3C%3D10%5E%7B5%7D%3B0%3C%3Dk%26lt%3B5000%20%24%20%29%2C%20where%20%24%20n%20%24%20is%20the%20number%20of%20cities%20in%20the%20country%2C%20%24%20m%20%24%20is%20the%20number%20of%20roads%20in%20the%20country%2C%20%24%20k%20%24%20is%20the%20number%20of%20capital%20roads%20in%20the%20required%20set.%20Then%20%24%20m%20%24%20lines%20enumerate%20the%20roads%20in%20question.%20Each%20road%20is%20specified%20by%20three%20numbers%20%24%20a_%7Bi%7D%2Cb_%7Bi%7D%2Cw_%7Bi%7D%20%24%20%28%20%24%201%3C%3Da_%7Bi%7D%2Cb_%7Bi%7D%3C%3Dn%20%24%20%3B%20%24%201%3C%3Dw%3C%3D10%5E%7B5%7D%20%24%20%29%2C%20where%20%24%20a_%7Bi%7D%2Cb_%7Bi%7D%20%24%20are%20the%20numbers%20of%20cities%20linked%20by%20a%20road%20and%20%24%20w_%7Bi%7D%20%24%20is%20its%20length.%5Cn%5CnBetween%20each%20pair%20of%20cities%20no%20more%20than%20one%20road%20exists.%20There%20are%20no%20roads%20that%20start%20and%20finish%20in%20one%20city.%20The%20capital%27s%20number%20is%201.%22%2C%22outputFormat%22%3A%22In%20the%20first%20line%20print%20the%20number%20of%20roads%20in%20the%20required%20set.%20The%20second%20line%20should%20contain%20the%20numbers%20of%20roads%20included%20in%20the%20sought%20set.%20If%20the%20sought%20set%20does%20not%20exist%2C%20print%20-1.%22%2C%22samples%22%3A%5B%5B%224%205%202%5Cn1%202%201%5Cn2%203%201%5Cn3%204%201%5Cn1%203%203%5Cn1%204%202%5Cn%22%2C%223%5Cn1%205%202%20%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B8000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F125%5C%2FE%22%2C%22id%22%3A%22125E%22%7D%2C%22translation%22%3A%22%5Cu6c42%5Cu4e00%5Cu79cd%5Cu7279%5Cu6b8a%5Cu7684%5Cu6700%5Cu5c0f%5Cu751f%5Cu6210%5Cu6811%5Cu3002%5Cu7ed9%5Cu5b9a%5Cu4e00%5Cu4e2a%5Cu6709%24n%24%5Cu4e2a%5Cu8282%5Cu70b9%5Cu548c%24m%24%5Cu6761%5Cu8fb9%5Cu7684%5Cu56fe%5Cuff0c%5Cu627e%5Cu51fa%5Cu4e00%5Cu4e2a%5Cu751f%5Cu6210%5Cu6811%5Cu6ee1%5Cu8db3%5Cu4ece%5Cu6839%5Cu8282%5Cu70b9%241%24%5Cu76f4%5Cu63a5%5Cu8fde%5Cu5411%5Cu5176%5Cu4f59%5Cu8282%5Cu70b9%5Cu7684%5Cu8fb9%5Cu8981%5Cu6070%5Cu597d%5Cu662f%24k%24%5Cu6761%5Cuff0c%5Cu5728%5Cu6b64%5Cu6761%5Cu4ef6%5Cu4e0b%5Cu751f%5Cu6210%5Cu6811%5Cu7684%5Cu6743%5Cu503c%5Cu548c%5Cu6700%5Cu5c0f%5Cu3002%5Cn%5Cn%5Cu611f%5Cu8c22%20%40frankchenfu%20%20%5Cu63d0%5Cu4f9b%5Cu7684%5Cu7ffb%5Cu8bd1%5Cu3002%22%2C%22tags%22%3A%5B7%2C113%2C166%2C170%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A424%2C%22totalAccepted%22%3A86%2C%22pid%22%3A%22CF125E%22%2C%22title%22%3A%22MST%20Company%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A147216%2C%22title%22%3A%22hack%26%5Cu6c42%5Cu52a9%5Cu5982%5Cu4f55%5Cu6b63%5Cu786e%5Cu4e8c%5Cu5206%5Cuff08AC%20%5Cu7684%5Cu53c9%5Cu4e86%5Cu4e00%5Cu5927%5Cu7247%5Cu4e86%5Cuff09%22%2C%22forum%22%3A%7B%22id%22%3A12103%2C%22name%22%3A%22CF125E%20MST%20Company%22%2C%22slug%22%3A%22CF125E%22%7D%7D%2C%7B%22id%22%3A136175%2C%22title%22%3A%22%5Cu8fd9%5Cu9898%5Cu7684%5Cu6570%5Cu636e%5Cu6709%5Cu70b9%5Cu6dfc%22%2C%22forum%22%3A%7B%22id%22%3A12103%2C%22name%22%3A%22CF125E%20MST%20Company%22%2C%22slug%22%3A%22CF125E%22%7D%7D%2C%7B%22id%22%3A75018%2C%22title%22%3A%22%5Cu88ab%5Cu81ea%5Cu5df1%5Cu8822%5Cu54edQvQ%22%2C%22forum%22%3A%7B%22id%22%3A12103%2C%22name%22%3A%22CF125E%20MST%20Company%22%2C%22slug%22%3A%22CF125E%22%7D%7D%2C%7B%22id%22%3A39573%2C%22title%22%3A%22%5Cu7ffb%5Cu8bd1%22%2C%22forum%22%3A%7B%22id%22%3A12103%2C%22name%22%3A%22CF125E%20MST%20Company%22%2C%22slug%22%3A%22CF125E%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P2619%22%2C%22title%22%3A%22%5B%5Cu56fd%5Cu5bb6%5Cu96c6%5Cu8bad%5Cu961f2%5DTree%20I%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22CF739E%22%2C%22title%22%3A%22Gosha%20is%20hunting%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF402B%22%2C%22title%22%3A%22Trees%20in%20a%20Row%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF161B%22%2C%22title%22%3A%22Discounts%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22P4383%22%2C%22title%22%3A%22%5B%5Cu516b%5Cu7701%5Cu8054%5Cu80032018%5D%5Cu6797%5Cu514b%5Cu5361%5Cu7279%5Cu6811lct%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22MST%20Company%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>MST Company</h1>
<h2>题意翻译</h2>
<div>求一种特殊的最小生成树。给定一个有$n$个节点和$m$条边的图，找出一个生成树满足从根节点$1$直接连向其余节点的边要恰好是$k$条，在此条件下生成树的权值和最小。
感谢 @frankchenfu 提供的翻译。</div>
<h2>题目描述</h2>
<div>The MST (Meaningless State Team) company won another tender for an important state reform in Berland.
There are $ n $ cities in Berland, some pairs of the cities are connected by roads. Each road has its price. One can move along any road in any direction. The MST team should carry out the repair works on some set of roads such that one can get from any city to any other one moving only along the repaired roads. Moreover, this set should contain exactly $ k $ capital roads (that is, the roads that start or finish in the capital). The number of the capital is 1.
As the budget has already been approved, the MST Company will profit by finding the set with minimum lengths of roads.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first input line contains three integers $ n,m,k $ ( $ 1<=n<=5000;0<=m<=10^{5};0<=k&lt;5000 $ ), where $ n $ is the number of cities in the country, $ m $ is the number of roads in the country, $ k $ is the number of capital roads in the required set. Then $ m $ lines enumerate the roads in question. Each road is specified by three numbers $ a_{i},b_{i},w_{i} $ ( $ 1<=a_{i},b_{i}<=n $ ; $ 1<=w<=10^{5} $ ), where $ a_{i},b_{i} $ are the numbers of cities linked by a road and $ w_{i} $ is its length.
Between each pair of cities no more than one road exists. There are no roads that start and finish in one city. The capital's number is 1.</div>
<h3>输出格式</h3>
<br />
<div>In the first line print the number of roads in the required set. The second line should contain the numbers of roads included in the sought set. If the sought set does not exist, print -1.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>4 5 2
1 2 1
2 3 1
3 4 1
1 3 3
1 4 2
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>3
1 5 2 </code></pre>
</article>
</div>
</div>
</body>
</html>
