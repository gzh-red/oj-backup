<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>C*++ Calculations - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573390179:lRbAn6JHeDz0/y1XoGA9SwhY+rzp7CqvoGZodiChS2A=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22C%5C%5C%2A%2B%2B%20language%20is%20quite%20similar%20to%20C%2B%2B.%20The%20similarity%20manifests%20itself%20in%20the%20fact%20that%20the%20programs%20written%20in%20C%5C%5C%2A%2B%2B%20sometimes%20behave%20unpredictably%20and%20lead%20to%20absolutely%20unexpected%20effects.%20For%20example%2C%20let%27s%20imagine%20an%20arithmetic%20expression%20in%20C%5C%5C%2A%2B%2B%20that%20looks%20like%20this%20%28%20%24%20expression%20%24%20is%20the%20main%20term%29%3A%5Cn%5Cn-%20%24%20expression%20%24%20%3A%3A%3D%20%24%20summand%20%24%20%7C%20%24%20expression%2Bsummand%20%24%20%7C%20%24%20expression-summand%20%24%5Cn-%20%24%20summand%20%24%20%3A%3A%3D%20%24%20increment%20%24%20%7C%20%24%20coefficient%20%24%20%5C%5C%2A%20%24%20increment%20%24%5Cn-%20%24%20increment%20%24%20%3A%3A%3D%20a%2B%2B%20%7C%20%2B%2Ba%5Cn-%20%24%20coefficient%20%24%20%3A%3A%3D%200%7C1%7C2%7C...%7C1000%5Cn%5CnFor%20example%2C%20%5C%225%5C%5C%2Aa%2B%2B-3%5C%5C%2A%2B%2Ba%2Ba%2B%2B%5C%22%20is%20a%20valid%20expression%20in%20C%5C%5C%2A%2B%2B.%5Cn%5CnThus%2C%20we%20have%20a%20sum%20consisting%20of%20several%20summands%20divided%20by%20signs%20%5C%22%2B%5C%22%20or%20%5C%22-%5C%22.%20Every%20summand%20is%20an%20expression%20%5C%22a%2B%2B%5C%22%20or%20%5C%22%2B%2Ba%5C%22%20multiplied%20by%20some%20integer%20coefficient.%20If%20the%20coefficient%20is%20omitted%2C%20it%20is%20suggested%20being%20equal%20to%20%24%201%20%24%20.%5Cn%5CnThe%20calculation%20of%20such%20sum%20in%20C%5C%5C%2A%2B%2B%20goes%20the%20following%20way.%20First%20all%20the%20summands%20are%20calculated%20one%20after%20another%2C%20then%20they%20are%20summed%20by%20the%20usual%20arithmetic%20rules.%20If%20the%20summand%20contains%20%5C%22a%2B%2B%5C%22%2C%20then%20during%20the%20calculation%20first%20the%20value%20of%20the%20%5C%22a%5C%22%20variable%20is%20multiplied%20by%20the%20coefficient%2C%20then%20value%20of%20%5C%22a%5C%22%20is%20increased%20by%20%24%201%20%24%20.%20If%20the%20summand%20contains%20%5C%22%2B%2Ba%5C%22%2C%20then%20the%20actions%20on%20it%20are%20performed%20in%20the%20reverse%20order%3A%20first%20%5C%22a%5C%22%20is%20increased%20by%20%24%201%20%24%20%2C%20then%20%5Cu2014%20multiplied%20by%20the%20coefficient.%5Cn%5CnThe%20summands%20may%20be%20calculated%20in%20any%20order%2C%20that%27s%20why%20sometimes%20the%20result%20of%20the%20calculation%20is%20completely%20unpredictable%21%20Your%20task%20is%20to%20find%20its%20largest%20possible%20value.%22%2C%22inputFormat%22%3A%22The%20first%20input%20line%20contains%20an%20integer%20%24%20a%20%24%20%28%20%24%20-1000%3C%3Da%3C%3D1000%20%24%20%29%20%5Cu2014%20the%20initial%20value%20of%20the%20variable%20%5C%22a%5C%22.%20The%20next%20line%20contains%20an%20expression%20in%20C%5C%5C%2A%2B%2B%20language%20of%20the%20described%20type.%20The%20number%20of%20the%20summands%20in%20the%20expression%20does%20not%20exceed%20%24%201000%20%24%20.%20It%20is%20guaranteed%20that%20the%20line%20describing%20the%20expression%20contains%20no%20spaces%20and%20tabulation.%22%2C%22outputFormat%22%3A%22Output%20a%20single%20number%20%5Cu2014%20the%20maximal%20possible%20value%20of%20the%20expression.%22%2C%22samples%22%3A%5B%5B%221%5Cn5%2Aa%2B%2B-3%2A%2B%2Ba%2Ba%2B%2B%5Cn%22%2C%2211%5Cn%22%5D%2C%5B%223%5Cna%2B%2B%2B%2B%2Ba%5Cn%22%2C%228%5Cn%22%5D%5D%2C%22hint%22%3A%22Consider%20the%20second%20example.%20Initially%20%24%20a%3D3%20%24%20.%20Suppose%20that%20at%20first%20the%20first%20summand%20is%20calculated%2C%20and%20then%20the%20second%20one%20is.%20The%20first%20summand%20gets%20equal%20to%20%24%203%20%24%20%2C%20and%20the%20value%20of%20%24%20a%20%24%20is%20increased%20by%20%24%201%20%24%20.%20At%20the%20calculation%20of%20the%20second%20summand%20%24%20a%20%24%20is%20increased%20once%20more%20%28gets%20equal%20to%20%24%205%20%24%20%29.%20The%20value%20of%20the%20second%20summand%20is%20%24%205%20%24%20%2C%20and%20together%20they%20give%20%24%208%20%24%20.%20If%20we%20calculate%20the%20second%20summand%20first%20and%20the%20first%20summand%20later%2C%20then%20the%20both%20summands%20equals%20to%20%24%204%20%24%20%2C%20and%20the%20result%20is%20%24%208%20%24%20%2C%20too.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B64000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F39%5C%2FA%22%2C%22id%22%3A%2239A%22%7D%2C%22translation%22%3A%22%5Cu8868%5Cu8fbe%5Cu5f0f%5Cu6c42%5Cu548c%5Cuff0c%5Cu548c%5Cu6b63%5Cu5e38%5Cu7684%5Cu8fd0%5Cu7b97%5Cu4e0d%5Cu540c%5Cu7684%5Cu662f%5Cu53ef%5Cu4ee5%5Cu9009%5Cu62e9%5Cu6bcf%5Cu4e2a%5Cu52a0%5Cu6570%5Cu7684%5Cu8fd0%5Cu7b97%5Cu987a%5Cu5e8f%5Cuff0c%5Cu6c42%5Cu6700%5Cu5927%5Cu7684%5Cu503c%5Cu662f%5Cu591a%5Cu5c11%5Cu3002%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A120%2C%22totalAccepted%22%3A28%2C%22pid%22%3A%22CF39A%22%2C%22title%22%3A%22C%2A%2B%2B%20Calculations%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P3232%22%2C%22title%22%3A%22%5BHNOI2013%5D%5Cu6e38%5Cu8d70%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P3812%22%2C%22title%22%3A%22%5Cu3010%5Cu6a21%5Cu677f%5Cu3011%5Cu7ebf%5Cu6027%5Cu57fa%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22CF45G%22%2C%22title%22%3A%22Prime%20Problem%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF7E%22%2C%22title%22%3A%22Defining%20Macros%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22P4301%22%2C%22title%22%3A%22%5BCQOI2013%5D%5Cu65b0Nim%5Cu6e38%5Cu620f%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22C%2A%2B%2B%20Calculations%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573286098;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>C*++ Calculations</h1>
<h2>题意翻译</h2>
<div>表达式求和，和正常的运算不同的是可以选择每个加数的运算顺序，求最大的值是多少。</div>
<h2>题目描述</h2>
<div>C\*++ language is quite similar to C++. The similarity manifests itself in the fact that the programs written in C\*++ sometimes behave unpredictably and lead to absolutely unexpected effects. For example, let's imagine an arithmetic expression in C\*++ that looks like this ( $ expression $ is the main term):
- $ expression $ ::= $ summand $ | $ expression+summand $ | $ expression-summand $
- $ summand $ ::= $ increment $ | $ coefficient $ \* $ increment $
- $ increment $ ::= a++ | ++a
- $ coefficient $ ::= 0|1|2|...|1000
For example, "5\*a++-3\*++a+a++" is a valid expression in C\*++.
Thus, we have a sum consisting of several summands divided by signs "+" or "-". Every summand is an expression "a++" or "++a" multiplied by some integer coefficient. If the coefficient is omitted, it is suggested being equal to $ 1 $ .
The calculation of such sum in C\*++ goes the following way. First all the summands are calculated one after another, then they are summed by the usual arithmetic rules. If the summand contains "a++", then during the calculation first the value of the "a" variable is multiplied by the coefficient, then value of "a" is increased by $ 1 $ . If the summand contains "++a", then the actions on it are performed in the reverse order: first "a" is increased by $ 1 $ , then — multiplied by the coefficient.
The summands may be calculated in any order, that's why sometimes the result of the calculation is completely unpredictable! Your task is to find its largest possible value.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first input line contains an integer $ a $ ( $ -1000<=a<=1000 $ ) — the initial value of the variable "a". The next line contains an expression in C\*++ language of the described type. The number of the summands in the expression does not exceed $ 1000 $ . It is guaranteed that the line describing the expression contains no spaces and tabulation.</div>
<h3>输出格式</h3>
<br />
<div>Output a single number — the maximal possible value of the expression.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>1
5*a++-3*++a+a++
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>11
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>3
a+++++a
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>8
</code></pre>
<h2>说明</h2>
<div>Consider the second example. Initially $ a=3 $ . Suppose that at first the first summand is calculated, and then the second one is. The first summand gets equal to $ 3 $ , and the value of $ a $ is increased by $ 1 $ . At the calculation of the second summand $ a $ is increased once more (gets equal to $ 5 $ ). The value of the second summand is $ 5 $ , and together they give $ 8 $ . If we calculate the second summand first and the first summand later, then the both summands equals to $ 4 $ , and the result is $ 8 $ , too.</div>
</article>
</div>
</div>
</body>
</html>
