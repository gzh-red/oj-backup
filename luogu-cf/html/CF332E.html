<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Binary Key - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573392870:w2vMBMZ45yw7zZPnvWpu/1NvU7q63uCVmakmxa54F/s=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Let%27s%20assume%20that%20%24%20p%20%24%20and%20%24%20q%20%24%20are%20strings%20of%20positive%20length%2C%20called%20the%20container%20and%20the%20key%20correspondingly%2C%20string%20%24%20q%20%24%20only%20consists%20of%20characters%200%20and%201.%20Let%27s%20take%20a%20look%20at%20a%20simple%20algorithm%20that%20extracts%20message%20%24%20s%20%24%20from%20the%20given%20container%20%24%20p%20%24%20%3A%5Cn%5Cn%60%3Cbr%3E%3C%5C%2Fbr%3Ei%20%3D%200%3B%3Cbr%3E%3C%5C%2Fbr%3Ej%20%3D%200%3B%3Cbr%3E%3C%5C%2Fbr%3Es%20%3D%20%3C%3E%3B%3Cbr%3E%3C%5C%2Fbr%3Ewhile%20i%20is%20less%20than%20the%20length%20of%20the%20string%20p%3Cbr%3E%3C%5C%2Fbr%3E%7B%3Cbr%3E%3C%5C%2Fbr%3E%20%20%20%20if%20q%5Bj%5D%20%3D%3D%201%2C%20then%20add%20to%20the%20right%20of%20string%20s%20character%20p%5Bi%5D%3B%3Cbr%3E%3C%5C%2Fbr%3E%20%20%20%20increase%20variables%20i%2C%20j%20by%20one%3B%3Cbr%3E%3C%5C%2Fbr%3E%20%20%20%20if%20the%20value%20of%20the%20variable%20j%20equals%20the%20length%20of%20the%20string%20q%2C%20then%20j%20%3D%200%3B%20%3Cbr%3E%3C%5C%2Fbr%3E%7D%3Cbr%3E%3C%5C%2Fbr%3E%60In%20the%20given%20pseudocode%20%24%20i%20%24%20%2C%20%24%20j%20%24%20are%20integer%20variables%2C%20%24%20s%20%24%20is%20a%20string%2C%20%27%3D%27%20is%20an%20assignment%20operator%2C%20%27%3D%3D%27%20is%20a%20comparison%20operation%2C%20%27%5C%5C%5B%5C%5C%5D%27%20is%20the%20operation%20of%20obtaining%20the%20string%20character%20with%20the%20preset%20index%2C%20%27%3C%3E%27%20is%20an%20empty%20string.%20We%20suppose%20that%20in%20all%20strings%20the%20characters%20are%20numbered%20starting%20from%20zero.%5Cn%5CnWe%20understand%20that%20implementing%20such%20algorithm%20is%20quite%20easy%2C%20so%20your%20task%20is%20going%20to%20be%20slightly%20different.%20You%20need%20to%20construct%20the%20lexicographically%20minimum%20key%20of%20length%20%24%20k%20%24%20%2C%20such%20that%20when%20it%20is%20used%2C%20the%20algorithm%20given%20above%20extracts%20message%20%24%20s%20%24%20from%20container%20%24%20p%20%24%20%28otherwise%20find%20out%20that%20such%20key%20doesn%27t%20exist%29.%22%2C%22inputFormat%22%3A%22The%20first%20two%20lines%20of%20the%20input%20are%20non-empty%20strings%20%24%20p%20%24%20and%20%24%20s%20%24%20%28%20%24%201%3C%3D%7Cp%7C%3C%3D10%5E%7B6%7D%20%24%20%2C%20%24%201%3C%3D%7Cs%7C%3C%3D200%20%24%20%29%2C%20describing%20the%20container%20and%20the%20message%2C%20correspondingly.%20The%20strings%20can%20contain%20any%20characters%20with%20the%20ASCII%20codes%20from%2032%20to%20126%2C%20inclusive.%5Cn%5CnThe%20third%20line%20contains%20a%20single%20integer%20%24%20k%20%24%20%28%20%24%201%3C%3Dk%3C%3D2000%29%20%24%20%5Cu2014%20the%20key%27s%20length.%22%2C%22outputFormat%22%3A%22Print%20the%20required%20key%20%28string%20of%20length%20%24%20k%20%24%20%2C%20consisting%20only%20of%20characters%200%20and%201%29.%20If%20the%20key%20doesn%27t%20exist%2C%20print%20the%20single%20character%200.%22%2C%22samples%22%3A%5B%5B%22abacaba%5Cnaba%5Cn6%5Cn%22%2C%22100001%5Cn%22%5D%2C%5B%22abacaba%5Cnaba%5Cn3%5Cn%22%2C%220%5Cn%22%5D%5D%2C%22hint%22%3A%22String%20%24%20x%3Dx_%7B1%7Dx_%7B2%7D...%5C%5C%20x_%7Bp%7D%20%24%20is%20lexicographically%20smaller%20than%20string%20%24%20y%3Dy_%7B1%7Dy_%7B2%7D...%5C%5C%20y_%7Bq%7D%20%24%20%2C%20if%20either%20%24%20p%26lt%3Bq%20%24%20and%20%24%20x_%7B1%7D%3Dy_%7B1%7D%2Cx_%7B2%7D%3Dy_%7B2%7D%2C...%5C%5C%20%2Cx_%7Bp%7D%3Dy_%7Bp%7D%20%24%20%2C%20or%20there%20exists%20such%20integer%20%24%20r%20%24%20%28%20%24%200%3C%3Dr%26lt%3Bmin%28p%2Cq%29%29%20%24%20that%20%24%20x_%7B1%7D%3Dy_%7B1%7D%2Cx_%7B2%7D%3Dy_%7B2%7D%2C...%5C%5C%20%2Cx_%7Br%7D%3Dy_%7Br%7D%20%24%20and%20%24%20x_%7Br%2B1%7D%26lt%3By_%7Br%2B1%7D%20%24%20.%20Symbols%20are%20compared%20according%20to%20their%20ASCII%20codes.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B4000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F332%5C%2FE%22%2C%22id%22%3A%22332E%22%7D%2C%22translation%22%3A%22%5Cu7ed9%5Cu4f60%5Cu4e24%5Cu4e2a%5Cu5b57%5Cu7b26%5Cu4e32p%5Cu548cs%5Cuff0c%5Cu8ba9%5Cu4f60%5Cu6c42%5Cu51fa%5Cu4e00%5Cu4e2a%5Cu5b57%5Cu5178%5Cu5e8f%5Cu5c3d%5Cu91cf%5Cu5c0f%5Cu7684%5Cu957f%5Cu5ea6%5Cu4e3ak%5Cu768401%5Cu4e32%5Cu5bc6%5Cu94a5%5Cuff0c%5Cu80fd%5Cu5c06p%5Cu8f6c%5Cu5316%5Cu4e3as%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu5bc6%5Cu94a5%5Cu7684%5Cu5de5%5Cu4f5c%5Cu65b9%5Cu5f0f%5Cu5982%5Cu4e0b%5Cuff1a%5Cr%5Cn%5Cr%5Cn%5Cu7b2ci%5Cu4f4d%5Cu662f0%5Cuff0c%5Cu8868%5Cu793a%5Cu8fd9%5Cu4e00%5Cu4f4d%5Cu65e0%5Cu7528%5Cuff1b%5Cr%5Cn%20%20%5Cr%5Cn%5Cu7b2ci%5Cu4f4d%5Cu662f1%5Cuff0c%5Cu8868%5Cu793a%5Cu8fd9%5Cu4e00%5Cu4f4d%5Cu6709%5Cu7528%5Cu3002%5Cr%5Cn%20%20%5Cr%5Cn%5Cu82e5%5Cu5bc6%5Cu94a5%5Cu7684%5Cu957f%5Cu5ea6%5Cu6bd4p%5Cu77ed%5Cuff0c%5Cu5219%5Cu53ef%5Cu4ee5%5Cu901a%5Cu8fc7%5Cu5faa%5Cu73af%5Cu7684%5Cu65b9%5Cu5f0f%5Cu8865%5Cu9f50%5Cu3002%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A15%2C%22totalAccepted%22%3A10%2C%22pid%22%3A%22CF332E%22%2C%22title%22%3A%22Binary%20Key%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Binary%20Key%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573295103;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Binary Key</h1>
<h2>题意翻译</h2>
<div>给你两个字符串p和s，让你求出一个字典序尽量小的长度为k的01串密钥，能将p转化为s。
密钥的工作方式如下：
第i位是0，表示这一位无用；
第i位是1，表示这一位有用。
若密钥的长度比p短，则可以通过循环的方式补齐。</div>
<h2>题目描述</h2>
<div>Let's assume that $ p $ and $ q $ are strings of positive length, called the container and the key correspondingly, string $ q $ only consists of characters 0 and 1. Let's take a look at a simple algorithm that extracts message $ s $ from the given container $ p $ :
`<br></br>i = 0;<br></br>j = 0;<br></br>s = <>;<br></br>while i is less than the length of the string p<br></br>{<br></br> if q[j] == 1, then add to the right of string s character p[i];<br></br> increase variables i, j by one;<br></br> if the value of the variable j equals the length of the string q, then j = 0; <br></br>}<br></br>`In the given pseudocode $ i $ , $ j $ are integer variables, $ s $ is a string, '=' is an assignment operator, '==' is a comparison operation, '\[\]' is the operation of obtaining the string character with the preset index, '<>' is an empty string. We suppose that in all strings the characters are numbered starting from zero.
We understand that implementing such algorithm is quite easy, so your task is going to be slightly different. You need to construct the lexicographically minimum key of length $ k $ , such that when it is used, the algorithm given above extracts message $ s $ from container $ p $ (otherwise find out that such key doesn't exist).</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first two lines of the input are non-empty strings $ p $ and $ s $ ( $ 1<=|p|<=10^{6} $ , $ 1<=|s|<=200 $ ), describing the container and the message, correspondingly. The strings can contain any characters with the ASCII codes from 32 to 126, inclusive.
The third line contains a single integer $ k $ ( $ 1<=k<=2000) $ — the key's length.</div>
<h3>输出格式</h3>
<br />
<div>Print the required key (string of length $ k $ , consisting only of characters 0 and 1). If the key doesn't exist, print the single character 0.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>abacaba
aba
6
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>100001
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>abacaba
aba
3
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>0
</code></pre>
<h2>说明</h2>
<div>String $ x=x_{1}x_{2}...\ x_{p} $ is lexicographically smaller than string $ y=y_{1}y_{2}...\ y_{q} $ , if either $ p&lt;q $ and $ x_{1}=y_{1},x_{2}=y_{2},...\ ,x_{p}=y_{p} $ , or there exists such integer $ r $ ( $ 0<=r&lt;min(p,q)) $ that $ x_{1}=y_{1},x_{2}=y_{2},...\ ,x_{r}=y_{r} $ and $ x_{r+1}&lt;y_{r+1} $ . Symbols are compared according to their ASCII codes.</div>
</article>
</div>
</div>
</body>
</html>
