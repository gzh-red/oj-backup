<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Chloe and pleasant prizes - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573397331:Mi0iRQd9SG0QQEWeRC9+Zn6lbAGOI1CKEblFVlVNG3o=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Generous%20sponsors%20of%20the%20olympiad%20in%20which%20Chloe%20and%20Vladik%20took%20part%20allowed%20all%20the%20participants%20to%20choose%20a%20prize%20for%20them%20on%20their%20own.%20Christmas%20is%20coming%2C%20so%20sponsors%20decided%20to%20decorate%20the%20Christmas%20tree%20with%20their%20prizes.%5Cn%5CnThey%20took%20%24%20n%20%24%20prizes%20for%20the%20contestants%20and%20wrote%20on%20each%20of%20them%20a%20unique%20id%20%28integer%20from%20%24%201%20%24%20to%20%24%20n%20%24%20%29.%20A%20gift%20%24%20i%20%24%20is%20characterized%20by%20integer%20%24%20a_%7Bi%7D%20%24%20%5Cu2014%20pleasantness%20of%20the%20gift.%20The%20pleasantness%20of%20the%20gift%20can%20be%20positive%2C%20negative%20or%20zero.%20Sponsors%20placed%20the%20gift%20%24%201%20%24%20on%20the%20top%20of%20the%20tree.%20All%20the%20other%20gifts%20hung%20on%20a%20rope%20tied%20to%20some%20other%20gift%20so%20that%20each%20gift%20hung%20on%20the%20first%20gift%2C%20possibly%20with%20a%20sequence%20of%20ropes%20and%20another%20gifts.%20Formally%2C%20the%20gifts%20formed%20a%20rooted%20tree%20with%20%24%20n%20%24%20vertices.%5Cn%5CnThe%20prize-giving%20procedure%20goes%20in%20the%20following%20way%3A%20the%20participants%20come%20to%20the%20tree%20one%20after%20another%2C%20choose%20any%20of%20the%20remaining%20gifts%20and%20cut%20the%20rope%20this%20prize%20hang%20on.%20Note%20that%20all%20the%20ropes%20which%20were%20used%20to%20hang%20other%20prizes%20on%20the%20chosen%20one%20are%20not%20cut.%20So%20the%20contestant%20gets%20the%20chosen%20gift%20as%20well%20as%20the%20all%20the%20gifts%20that%20hang%20on%20it%2C%20possibly%20with%20a%20sequence%20of%20ropes%20and%20another%20gifts.%5Cn%5CnOur%20friends%2C%20Chloe%20and%20Vladik%2C%20shared%20the%20first%20place%20on%20the%20olympiad%20and%20they%20will%20choose%20prizes%20at%20the%20same%20time%21%20To%20keep%20themselves%20from%20fighting%2C%20they%20decided%20to%20choose%20two%20different%20gifts%20so%20that%20the%20sets%20of%20the%20gifts%20that%20hang%20on%20them%20with%20a%20sequence%20of%20ropes%20and%20another%20gifts%20don%27t%20intersect.%20In%20other%20words%2C%20there%20shouldn%27t%20be%20any%20gift%20that%20hang%20both%20on%20the%20gift%20chosen%20by%20Chloe%20and%20on%20the%20gift%20chosen%20by%20Vladik.%20From%20all%20of%20the%20possible%20variants%20they%20will%20choose%20such%20pair%20of%20prizes%20that%20the%20sum%20of%20pleasantness%20of%20all%20the%20gifts%20that%20they%20will%20take%20after%20cutting%20the%20ropes%20is%20as%20large%20as%20possible.%5Cn%5CnPrint%20the%20maximum%20sum%20of%20pleasantness%20that%20Vladik%20and%20Chloe%20can%20get.%20If%20it%20is%20impossible%20for%20them%20to%20choose%20the%20gifts%20without%20fighting%2C%20print%20Impossible.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20a%20single%20integer%20%24%20n%20%24%20%28%20%24%201%3C%3Dn%3C%3D2%5Cu00b710%5E%7B5%7D%20%24%20%29%20%5Cu2014%20the%20number%20of%20gifts.%5Cn%5CnThe%20next%20line%20contains%20%24%20n%20%24%20integers%20%24%20a_%7B1%7D%2Ca_%7B2%7D%2C...%2Ca_%7Bn%7D%20%24%20%28%20%24%20-10%5E%7B9%7D%3C%3Da_%7Bi%7D%3C%3D10%5E%7B9%7D%20%24%20%29%20%5Cu2014%20the%20pleasantness%20of%20the%20gifts.%5Cn%5CnThe%20next%20%24%20%28n-1%29%20%24%20lines%20contain%20two%20numbers%20each.%20The%20%24%20i%20%24%20-th%20of%20these%20lines%20contains%20integers%20%24%20u_%7Bi%7D%20%24%20and%20%24%20v_%7Bi%7D%20%24%20%28%20%24%201%3C%3Du_%7Bi%7D%2Cv_%7Bi%7D%3C%3Dn%20%24%20%2C%20%24%20u_%7Bi%7D%5Cu2260v_%7Bi%7D%20%24%20%29%20%5Cu2014%20the%20description%20of%20the%20tree%27s%20edges.%20It%20means%20that%20gifts%20with%20numbers%20%24%20u_%7Bi%7D%20%24%20and%20%24%20v_%7Bi%7D%20%24%20are%20connected%20to%20each%20other%20with%20a%20rope.%20The%20gifts%27%20ids%20in%20the%20description%20of%20the%20ropes%20can%20be%20given%20in%20arbirtary%20order%3A%20%24%20v_%7Bi%7D%20%24%20hangs%20on%20%24%20u_%7Bi%7D%20%24%20or%20%24%20u_%7Bi%7D%20%24%20hangs%20on%20%24%20v_%7Bi%7D%20%24%20.%5Cn%5CnIt%20is%20guaranteed%20that%20all%20the%20gifts%20hang%20on%20the%20first%20gift%2C%20possibly%20with%20a%20sequence%20of%20ropes%20and%20another%20gifts.%22%2C%22outputFormat%22%3A%22If%20it%20is%20possible%20for%20Chloe%20and%20Vladik%20to%20choose%20prizes%20without%20fighting%2C%20print%20single%20integer%20%5Cu2014%20the%20maximum%20possible%20sum%20of%20pleasantness%20they%20can%20get%20together.%5Cn%5CnOtherwise%20print%20Impossible.%22%2C%22samples%22%3A%5B%5B%228%5Cn0%205%20-1%204%203%202%206%205%5Cn1%202%5Cn2%204%5Cn2%205%5Cn1%203%5Cn3%206%5Cn6%207%5Cn6%208%5Cn%22%2C%2225%22%5D%2C%5B%224%5Cn1%20-5%201%201%5Cn1%202%5Cn1%204%5Cn2%203%5Cn%22%2C%222%22%5D%2C%5B%221%5Cn-1%5Cn%22%2C%22Impossible%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F743%5C%2FD%22%2C%22id%22%3A%22743D%22%7D%2C%22translation%22%3A%22%5Cu7ed9%5Cu4f60%5Cu4e00%5Cu68f5%5Cu6811%5Cuff0c%5Cu6c42%5Cu4e24%5Cu9897%5Cu4e0d%5Cu76f8%5Cu4ea4%5Cu7684%5Cu5b50%5Cu6811%5Cu4f7f%5Cu5b83%5Cu4eec%5Cu7684%5Cu70b9%5Cu6743%5Cu603b%5Cu548c%5Cu6700%5Cu5927%5Cuff0c%5Cu8f93%5Cu51fa%5Cu6700%5Cu5927%5Cu7684%5Cu70b9%5Cu6743%5Cu548c%5Cu3002%5Cu70b9%5Cu6743%5Cu53ef%5Cu80fd%5Cu4e3a%5Cu8d1f%5Cu3002%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A82%2C%22totalAccepted%22%3A25%2C%22pid%22%3A%22CF743D%22%2C%22title%22%3A%22Chloe%20and%20pleasant%20prizes%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A102229%2C%22title%22%3A%22%5Cu63d0%5Cu4ea4%5Cu7ffb%5Cu8bd1%22%2C%22forum%22%3A%7B%22id%22%3A9650%2C%22name%22%3A%22CF743D%20Chloe%20and%20pleasant%20prizes%22%2C%22slug%22%3A%22CF743D%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22CF500C%22%2C%22title%22%3A%22New%20Year%20Book%20Reading%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF486D%22%2C%22title%22%3A%22Valid%20Sets%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF460C%22%2C%22title%22%3A%22Present%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1096D%22%2C%22title%22%3A%22Easy%20Problem%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1153D%22%2C%22title%22%3A%22Serval%20and%20Rooted%20Tree%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Chloe%20and%20pleasant%20prizes%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573306449;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Chloe and pleasant prizes</h1>
<h2>题意翻译</h2>
<div>给你一棵树，求两颗不相交的子树使它们的点权总和最大，输出最大的点权和。点权可能为负。</div>
<h2>题目描述</h2>
<div>Generous sponsors of the olympiad in which Chloe and Vladik took part allowed all the participants to choose a prize for them on their own. Christmas is coming, so sponsors decided to decorate the Christmas tree with their prizes.
They took $ n $ prizes for the contestants and wrote on each of them a unique id (integer from $ 1 $ to $ n $ ). A gift $ i $ is characterized by integer $ a_{i} $ — pleasantness of the gift. The pleasantness of the gift can be positive, negative or zero. Sponsors placed the gift $ 1 $ on the top of the tree. All the other gifts hung on a rope tied to some other gift so that each gift hung on the first gift, possibly with a sequence of ropes and another gifts. Formally, the gifts formed a rooted tree with $ n $ vertices.
The prize-giving procedure goes in the following way: the participants come to the tree one after another, choose any of the remaining gifts and cut the rope this prize hang on. Note that all the ropes which were used to hang other prizes on the chosen one are not cut. So the contestant gets the chosen gift as well as the all the gifts that hang on it, possibly with a sequence of ropes and another gifts.
Our friends, Chloe and Vladik, shared the first place on the olympiad and they will choose prizes at the same time! To keep themselves from fighting, they decided to choose two different gifts so that the sets of the gifts that hang on them with a sequence of ropes and another gifts don't intersect. In other words, there shouldn't be any gift that hang both on the gift chosen by Chloe and on the gift chosen by Vladik. From all of the possible variants they will choose such pair of prizes that the sum of pleasantness of all the gifts that they will take after cutting the ropes is as large as possible.
Print the maximum sum of pleasantness that Vladik and Chloe can get. If it is impossible for them to choose the gifts without fighting, print Impossible.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains a single integer $ n $ ( $ 1<=n<=2·10^{5} $ ) — the number of gifts.
The next line contains $ n $ integers $ a_{1},a_{2},...,a_{n} $ ( $ -10^{9}<=a_{i}<=10^{9} $ ) — the pleasantness of the gifts.
The next $ (n-1) $ lines contain two numbers each. The $ i $ -th of these lines contains integers $ u_{i} $ and $ v_{i} $ ( $ 1<=u_{i},v_{i}<=n $ , $ u_{i}≠v_{i} $ ) — the description of the tree's edges. It means that gifts with numbers $ u_{i} $ and $ v_{i} $ are connected to each other with a rope. The gifts' ids in the description of the ropes can be given in arbirtary order: $ v_{i} $ hangs on $ u_{i} $ or $ u_{i} $ hangs on $ v_{i} $ .
It is guaranteed that all the gifts hang on the first gift, possibly with a sequence of ropes and another gifts.</div>
<h3>输出格式</h3>
<br />
<div>If it is possible for Chloe and Vladik to choose prizes without fighting, print single integer — the maximum possible sum of pleasantness they can get together.
Otherwise print Impossible.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>8
0 5 -1 4 3 2 6 5
1 2
2 4
2 5
1 3
3 6
6 7
6 8
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>25</code></pre>
<h3>输入样例 #2</h3>
<pre><code>4
1 -5 1 1
1 2
1 4
2 3
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>2</code></pre>
<h3>输入样例 #3</h3>
<pre><code>1
-1
</code></pre>
<h3>输出样例 #3</h3>
<pre><code>Impossible</code></pre>
</article>
</div>
</div>
</body>
</html>
