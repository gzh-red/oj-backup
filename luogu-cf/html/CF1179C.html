<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Serge and Dining Room - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573402675:xF0Gro1WB1OERJDLAAR7gAxDhTrJZm7VULuN62pU8jU=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Serge%20came%20to%20the%20school%20dining%20room%20and%20discovered%20that%20there%20is%20a%20big%20queue%20here.%20There%20are%20%24%20m%20%24%20pupils%20in%20the%20queue.%20He%27s%20not%20sure%20now%20if%20he%20wants%20to%20wait%20until%20the%20queue%20will%20clear%2C%20so%20he%20wants%20to%20know%20which%20dish%20he%20will%20receive%20if%20he%20does.%20As%20Serge%20is%20very%20tired%2C%20he%20asks%20you%20to%20compute%20it%20instead%20of%20him.%5Cn%5CnInitially%20there%20are%20%24%20n%20%24%20dishes%20with%20costs%20%24%20a_1%2C%20a_2%2C%20%5C%5Cldots%2C%20a_n%20%24%20.%20As%20you%20already%20know%2C%20there%20are%20the%20queue%20of%20%24%20m%20%24%20pupils%20who%20have%20%24%20b_1%2C%20%5C%5Cldots%2C%20b_m%20%24%20togrogs%20respectively%20%28pupils%20are%20enumerated%20by%20queue%20order%2C%20i.e%20the%20first%20pupil%20in%20the%20queue%20has%20%24%20b_1%20%24%20togrogs%20and%20the%20last%20one%20has%20%24%20b_m%20%24%20togrogs%29%5Cn%5CnPupils%20think%20that%20the%20most%20expensive%20dish%20is%20the%20most%20delicious%20one%2C%20so%20every%20pupil%20just%20buys%20the%20most%20expensive%20dish%20for%20which%20he%20has%20money%20%28every%20dish%20has%20a%20single%20copy%2C%20so%20when%20a%20pupil%20has%20bought%20it%20nobody%20can%20buy%20it%20later%29%2C%20and%20if%20a%20pupil%20doesn%27t%20have%20money%20for%20any%20dish%2C%20he%20just%20leaves%20the%20queue%20%28so%20brutal%20capitalism...%29%5Cn%5CnBut%20money%20isn%27t%20a%20problem%20at%20all%20for%20Serge%2C%20so%20Serge%20is%20buying%20the%20most%20expensive%20dish%20if%20there%20is%20at%20least%20one%20remaining.%5Cn%5CnMoreover%2C%20Serge%27s%20school%20has%20a%20very%20unstable%20economic%20situation%20and%20the%20costs%20of%20some%20dishes%20or%20number%20of%20togrogs%20of%20some%20pupils%20can%20change.%20More%20formally%2C%20you%20must%20process%20%24%20q%20%24%20queries%3A%5Cn%5Cn-%20change%20%24%20a_i%20%24%20to%20%24%20x%20%24%20.%20It%20means%20that%20the%20price%20of%20the%20%24%20i%20%24%20-th%20dish%20becomes%20%24%20x%20%24%20togrogs.%5Cn-%20change%20%24%20b_i%20%24%20to%20%24%20x%20%24%20.%20It%20means%20that%20the%20%24%20i%20%24%20-th%20pupil%20in%20the%20queue%20has%20%24%20x%20%24%20togrogs%20now.%5Cn%5CnNobody%20leaves%20the%20queue%20during%20those%20queries%20because%20a%20saleswoman%20is%20late.%5Cn%5CnAfter%20every%20query%2C%20you%20must%20tell%20Serge%20price%20of%20the%20dish%20which%20he%20will%20buy%20if%20he%20has%20waited%20until%20the%20queue%20is%20clear%2C%20or%20%24%20-1%20%24%20if%20there%20are%20no%20dishes%20at%20this%20point%2C%20according%20to%20rules%20described%20above.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20integers%20%24%20n%20%24%20and%20%24%20m%20%24%20%28%20%24%201%20%5C%5Cleq%20n%2C%20m%20%5C%5Cleq%20300%5C%5C%20000%20%24%20%29%20%5Cu2014%20number%20of%20dishes%20and%20pupils%20respectively.%20The%20second%20line%20contains%20%24%20n%20%24%20integers%20%24%20a_1%2C%20a_2%2C%20%5C%5Cldots%2C%20a_n%20%24%20%28%20%24%201%20%5C%5Cleq%20a_i%20%5C%5Cleq%2010%5E%7B6%7D%20%24%20%29%20%5Cu2014%20elements%20of%20array%20%24%20a%20%24%20.%20The%20third%20line%20contains%20%24%20m%20%24%20integers%20%24%20b_1%2C%20b_2%2C%20%5C%5Cldots%2C%20b_%7Bm%7D%20%24%20%28%20%24%201%20%5C%5Cleq%20b_i%20%5C%5Cleq%2010%5E%7B6%7D%20%24%20%29%20%5Cu2014%20elements%20of%20array%20%24%20b%20%24%20.%20The%20fourth%20line%20conatins%20integer%20%24%20q%20%24%20%28%20%24%201%20%5C%5Cleq%20q%20%5C%5Cleq%20300%5C%5C%20000%20%24%20%29%20%5Cu2014%20number%20of%20queries.%5Cn%5CnEach%20of%20the%20following%20%24%20q%20%24%20lines%20contains%20as%20follows%3A%5Cn%5Cn-%20if%20a%20query%20changes%20price%20of%20some%20dish%2C%20it%20contains%20%24%201%20%24%20%2C%20and%20two%20integers%20%24%20i%20%24%20and%20%24%20x%20%24%20%28%20%24%201%20%5C%5Cleq%20i%20%5C%5Cleq%20n%20%24%20%2C%20%24%201%20%5C%5Cleq%20x%20%5C%5Cleq%2010%5E%7B6%7D%20%24%20%29%2C%20what%20means%20%24%20a_i%20%24%20becomes%20%24%20x%20%24%20.%5Cn-%20if%20a%20query%20changes%20number%20of%20togrogs%20of%20some%20pupil%2C%20it%20contains%20%24%202%20%24%20%2C%20and%20two%20integers%20%24%20i%20%24%20and%20%24%20x%20%24%20%28%20%24%201%20%5C%5Cleq%20i%20%5C%5Cleq%20m%20%24%20%2C%20%24%201%20%5C%5Cleq%20x%20%5C%5Cleq%2010%5E%7B6%7D%20%24%20%29%2C%20what%20means%20%24%20b_i%20%24%20becomes%20%24%20x%20%24%20.%22%2C%22outputFormat%22%3A%22For%20each%20of%20%24%20q%20%24%20queries%20prints%20the%20answer%20as%20the%20statement%20describes%2C%20the%20answer%20of%20the%20%24%20i%20%24%20-th%20query%20in%20the%20%24%20i%20%24%20-th%20line%20%28the%20price%20of%20the%20dish%20which%20Serge%20will%20buy%20or%20%24%20-1%20%24%20if%20nothing%20remains%29%22%2C%22samples%22%3A%5B%5B%22%5Cn1%201%5Cn1%5Cn1%5Cn1%5Cn1%201%20100%5Cn%22%2C%22%5Cn100%5Cn%22%5D%2C%5B%22%5Cn1%201%5Cn1%5Cn1%5Cn1%5Cn2%201%20100%5Cn%22%2C%22%5Cn-1%5Cn%22%5D%2C%5B%22%5Cn4%206%5Cn1%208%202%204%5Cn3%203%206%201%205%202%5Cn3%5Cn1%201%201%5Cn2%205%2010%5Cn1%201%206%5Cn%22%2C%22%5Cn8%5Cn-1%5Cn4%5Cn%22%5D%5D%2C%22hint%22%3A%22In%20the%20first%20sample%20after%20the%20first%20query%2C%20there%20is%20one%20dish%20with%20price%20%24%20100%20%24%20togrogs%20and%20one%20pupil%20with%20one%20togrog%2C%20so%20Serge%20will%20buy%20the%20dish%20with%20price%20%24%20100%20%24%20togrogs.%5Cn%5CnIn%20the%20second%20sample%20after%20the%20first%20query%2C%20there%20is%20one%20dish%20with%20price%20one%20togrog%20and%20one%20pupil%20with%20%24%20100%20%24%20togrogs%2C%20so%20Serge%20will%20get%20nothing.%5Cn%5CnIn%20the%20third%20sample%20after%20the%20first%20query%2C%20nobody%20can%20buy%20the%20dish%20with%20price%20%24%208%20%24%20%2C%20so%20Serge%20will%20take%20it.%20After%20the%20second%20query%2C%20all%20dishes%20will%20be%20bought%2C%20after%20the%20third%20one%20the%20third%20and%20fifth%20pupils%20will%20by%20the%20first%20and%20the%20second%20dishes%20respectively%20and%20nobody%20will%20by%20the%20fourth%20one.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B4000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F1179%5C%2FC%22%2C%22id%22%3A%221179C%22%7D%2C%22translation%22%3A%22%5Cu6709%24m%24%5Cu4e2a%5Cu4eba%5Cu6392%5Cu961f%24AK%24%20%24n%24%5Cu573a%24IOI%24%5Cuff0c%5Cu6bcf%5Cu573a%24IOI%24%5Cu90fd%5Cu6709%5Cu4e00%5Cu4e2a%5Cu96be%5Cu5ea6%5Cu7cfb%5Cu6570%24a_i%24%5Cuff0c%5Cu6bcf%5Cu4e2a%5Cu4eba%5Cu90fd%5Cu6709%5Cu4e00%5Cu4e2a%5Cu5b9e%5Cu529b%5Cu503c%24b_i%24%5Cuff0c%5Cu4ed6%5Cu4eec%24AK%24%5Cu7684%5Cu65b9%5Cu5f0f%5Cu5982%5Cu4e0b%5Cuff1a%5Cu961f%5Cu5217%5Cu91cc%5Cu7684%5Cu7b2c%5Cu4e00%5Cu4e2a%5Cu4eba%5Cu9009%5Cu53d6%5Cu6240%5Cu6709%24IOI%24%5Cu91cc%5Cu6ee1%5Cu8db3%24a_i%5C%5Cle%20b_1%24%5Cu4e14%24a_i%24%5Cu5c3d%5Cu53ef%5Cu80fd%5Cu5927%5Cu7684%5Cu4e00%5Cu573a%5Cu5e76%24AK%24%2C%5Cu800c%5Cu961f%5Cu5217%5Cu91cc%5Cu7b2c%5Cu4e8c%5Cu4e2a%5Cu4eba%5Cu9009%5Cu53d6%2A%2A%5Cu6ca1%5Cu6709%5Cu88ab%24AK%24%5Cu8fc7%5Cu7684%2A%2A%5Cuff0c%5Cu6ee1%5Cu8db3%24a_i%5C%5Cle%20b_2%24%5Cu4e14%24a_i%24%5Cu5c3d%5Cu53ef%5Cu80fd%5Cu5927%5Cu7684%5Cu4e00%5Cu573a%24AK%24%2C%5Cu7b2c%5Cu4e09%5Cu4e2a%5Cu4eba%5Cu9009%5Cu53d6%2A%2A%5Cu6ca1%5Cu6709%5Cu88ab%24AK%24%5Cu8fc7%5Cu7684%2A%2A%5Cuff0c%5Cu6ee1%5Cu8db3%24a_i%5C%5Cle%20b_3%24%5Cu4e14%24a_i%24%5Cu5c3d%5Cu53ef%5Cu80fd%5Cu5927%5Cu7684%5Cu4e00%5Cu573a%24AK%24%20......%20%5Cu4ee5%5Cu6b64%5Cu7c7b%5Cu63a8%5Cu3002%5Cu5982%5Cu679c%5Cu4e00%5Cu4e2a%5Cu4eba%5Cu6ca1%5Cu6709%5Cu53ef%24AK%24%5Cu7684%24IOI%24%5Cuff0c%5Cu4ed6%5Cu5c31%5Cu4f1a%5Cu79bb%5Cu5f00%5Cu961f%5Cu5217~~%5Cu53bb%5Cu9893%5Cu5e9f~~%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cr%5Cn%5Cu4f46%5Cu662f%2C%24IOI%24%5Cu7684%5Cu96be%5Cu5ea6%5Cu7cfb%5Cu6570%5Cu548c%5Cu9009%5Cu624b%5Cu7684%5Cu5b9e%5Cu529b%5Cu4f1a%5Cu6539%5Cu53d8%5Cu3002%60%5Cu706f%5Cu706b%5Cu4e3f%5Cu8473%5Cu8564%60%20%5Cu7ed9%5Cu4e86%5Cu4f60%24q%24%5Cu6b21%5Cu8be2%5Cu95ee%5Cuff0c%5Cu6bcf%5Cu6b21%5Cu8be2%5Cu95ee%5Cu4fee%5Cu6539%24a_i%24%5Cu6216%24b_i%24%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu5bf9%5Cu4e8e%5Cu6bcf%5Cu6b21%5Cu8be2%5Cu95ee%5Cuff0c%5Cu4ed6%5Cu90fd%5Cu60f3%5Cu77e5%5Cu9053%5Cu5728%5Cu90a3%24m%24%5Cu4e2a%5Cu4eba%5Cu6309%5Cu5e8f%24AK%24%5Cu8fc7%5Cu540e%5Cuff0c%5Cu6240%5Cu6709%5Cu6ca1%5Cu6709%5Cu88ab%24AK%24%5Cu8fc7%5Cu7684%5Cu6bd4%5Cu8d5b%5Cu91cc%5Cuff0c%24a_i%24%5Cu503c%5Cu6700%5Cu5927%5Cu7684%5Cu4e00%5Cu573a%5Cu662f%5Cu591a%5Cu5c11%5Cuff08%5Cu4fbf%5Cu4e8e%5Cu4ed6%5Cu7206%5Cu5207%5Cuff09%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A59%2C%22totalAccepted%22%3A41%2C%22pid%22%3A%22CF1179C%22%2C%22title%22%3A%22Serge%20and%20Dining%20Room%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P5202%22%2C%22title%22%3A%22%5BUSACO19JAN%5DRedistricting%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22CF1179B%22%2C%22title%22%3A%22Tolik%20and%20His%20Uncle%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1198A%22%2C%22title%22%3A%22MP3%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1202A%22%2C%22title%22%3A%22You%20Are%20Given%20Two%20Binary%20Strings...%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22P5528%22%2C%22title%22%3A%22%5BYnoi2012%5DD2T2%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22P%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Serge%20and%20Dining%20Room%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Serge and Dining Room</h1>
<h2>题意翻译</h2>
<div>有$m$个人排队$AK$ $n$场$IOI$，每场$IOI$都有一个难度系数$a_i$，每个人都有一个实力值$b_i$，他们$AK$的方式如下：队列里的第一个人选取所有$IOI$里满足$a_i\le b_1$且$a_i$尽可能大的一场并$AK$,而队列里第二个人选取**没有被$AK$过的**，满足$a_i\le b_2$且$a_i$尽可能大的一场$AK$,第三个人选取**没有被$AK$过的**，满足$a_i\le b_3$且$a_i$尽可能大的一场$AK$ ...... 以此类推。如果一个人没有可$AK$的$IOI$，他就会离开队列~~去颓废~~。
但是,$IOI$的难度系数和选手的实力会改变。`灯火丿葳蕤` 给了你$q$次询问，每次询问修改$a_i$或$b_i$。
对于每次询问，他都想知道在那$m$个人按序$AK$过后，所有没有被$AK$过的比赛里，$a_i$值最大的一场是多少（便于他爆切）</div>
<h2>题目描述</h2>
<div>Serge came to the school dining room and discovered that there is a big queue here. There are $ m $ pupils in the queue. He's not sure now if he wants to wait until the queue will clear, so he wants to know which dish he will receive if he does. As Serge is very tired, he asks you to compute it instead of him.
Initially there are $ n $ dishes with costs $ a_1, a_2, \ldots, a_n $ . As you already know, there are the queue of $ m $ pupils who have $ b_1, \ldots, b_m $ togrogs respectively (pupils are enumerated by queue order, i.e the first pupil in the queue has $ b_1 $ togrogs and the last one has $ b_m $ togrogs)
Pupils think that the most expensive dish is the most delicious one, so every pupil just buys the most expensive dish for which he has money (every dish has a single copy, so when a pupil has bought it nobody can buy it later), and if a pupil doesn't have money for any dish, he just leaves the queue (so brutal capitalism...)
But money isn't a problem at all for Serge, so Serge is buying the most expensive dish if there is at least one remaining.
Moreover, Serge's school has a very unstable economic situation and the costs of some dishes or number of togrogs of some pupils can change. More formally, you must process $ q $ queries:
- change $ a_i $ to $ x $ . It means that the price of the $ i $ -th dish becomes $ x $ togrogs.
- change $ b_i $ to $ x $ . It means that the $ i $ -th pupil in the queue has $ x $ togrogs now.
Nobody leaves the queue during those queries because a saleswoman is late.
After every query, you must tell Serge price of the dish which he will buy if he has waited until the queue is clear, or $ -1 $ if there are no dishes at this point, according to rules described above.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains integers $ n $ and $ m $ ( $ 1 \leq n, m \leq 300\ 000 $ ) — number of dishes and pupils respectively. The second line contains $ n $ integers $ a_1, a_2, \ldots, a_n $ ( $ 1 \leq a_i \leq 10^{6} $ ) — elements of array $ a $ . The third line contains $ m $ integers $ b_1, b_2, \ldots, b_{m} $ ( $ 1 \leq b_i \leq 10^{6} $ ) — elements of array $ b $ . The fourth line conatins integer $ q $ ( $ 1 \leq q \leq 300\ 000 $ ) — number of queries.
Each of the following $ q $ lines contains as follows:
- if a query changes price of some dish, it contains $ 1 $ , and two integers $ i $ and $ x $ ( $ 1 \leq i \leq n $ , $ 1 \leq x \leq 10^{6} $ ), what means $ a_i $ becomes $ x $ .
- if a query changes number of togrogs of some pupil, it contains $ 2 $ , and two integers $ i $ and $ x $ ( $ 1 \leq i \leq m $ , $ 1 \leq x \leq 10^{6} $ ), what means $ b_i $ becomes $ x $ .</div>
<h3>输出格式</h3>
<br />
<div>For each of $ q $ queries prints the answer as the statement describes, the answer of the $ i $ -th query in the $ i $ -th line (the price of the dish which Serge will buy or $ -1 $ if nothing remains)</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>
1 1
1
1
1
1 1 100
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>
100
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>
1 1
1
1
1
2 1 100
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>
-1
</code></pre>
<h3>输入样例 #3</h3>
<pre><code>
4 6
1 8 2 4
3 3 6 1 5 2
3
1 1 1
2 5 10
1 1 6
</code></pre>
<h3>输出样例 #3</h3>
<pre><code>
8
-1
4
</code></pre>
<h2>说明</h2>
<div>In the first sample after the first query, there is one dish with price $ 100 $ togrogs and one pupil with one togrog, so Serge will buy the dish with price $ 100 $ togrogs.
In the second sample after the first query, there is one dish with price one togrog and one pupil with $ 100 $ togrogs, so Serge will get nothing.
In the third sample after the first query, nobody can buy the dish with price $ 8 $ , so Serge will take it. After the second query, all dishes will be bought, after the third one the third and fifth pupils will by the first and the second dishes respectively and nobody will by the fourth one.</div>
</article>
</div>
</div>
</body>
</html>
