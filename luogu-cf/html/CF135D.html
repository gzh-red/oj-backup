<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Cycle - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573391070:L+SEB/2rZfvR/Foj4L/IIzFlaPfaM3isuTQyXZmMHZ0=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Little%20Petya%20very%20much%20likes%20rectangular%20tables%20that%20consist%20of%20characters%20%5C%220%5C%22%20and%20%5C%221%5C%22.%20Recently%20he%20has%20received%20one%20such%20table%20as%20a%20gift%20from%20his%20mother.%20The%20table%20contained%20%24%20n%20%24%20rows%20and%20%24%20m%20%24%20columns.%20The%20rows%20are%20numbered%20from%20top%20to%20bottom%20from%20%24%201%20%24%20to%20%24%20n%20%24%20%2C%20the%20columns%20are%20numbered%20from%20the%20left%20to%20the%20right%20from%20%24%201%20%24%20to%20%24%20m%20%24%20.%20Petya%20immediately%20decided%20to%20find%20the%20longest%20cool%20cycle%20whatever%20it%20takes.%5Cn%5CnA%20cycle%20is%20a%20sequence%20of%20pairwise%20distinct%20cells%20where%20each%20two%20consecutive%20cells%20have%20a%20common%20side%3B%20besides%2C%20the%20first%20cell%20has%20a%20common%20side%20with%20the%20last%20cell.%20A%20cycle%20is%20called%20cool%20if%20it%20fulfills%20all%20the%20following%20conditions%20simultaneously%3A%5Cn%5Cn-%20The%20cycle%20entirely%20consists%20of%20the%20cells%20that%20contain%20%5C%221%5C%22.%5Cn-%20Each%20cell%20that%20belongs%20to%20the%20cycle%2C%20has%20a%20common%20side%20with%20exactly%20two%20other%20cells%20that%20belong%20to%20the%20cycle.%5Cn-%20Each%20cell%20of%20the%20table%20that%20contains%20%5C%221%5C%22%20either%20belongs%20to%20the%20cycle%20or%20is%20positioned%20outside%20of%20it%20%28see%20definition%20below%29.%5Cn%5CnTo%20define%20the%20notion%20of%20%5C%22outside%5C%22%20formally%2C%20let%27s%20draw%20a%20cycle%20on%20a%20plane.%20Let%20each%20cell%20of%20the%20cycle%20%24%20%28i%2Cj%29%20%24%20%28%20%24%20i%20%24%20is%20the%20row%20number%2C%20%24%20j%20%24%20is%20the%20column%20number%29%20correspond%20to%20the%20point%20%24%20%28i%2Cj%29%20%24%20on%20the%20coordinate%20plane.%20Let%20a%20straight%20line%20segment%20join%20each%20pair%20of%20points%20that%20correspond%20to%20the%20cells%20belonging%20to%20the%20cycle%20and%20sharing%20a%20side.%20Thus%2C%20we%20will%20get%20a%20closed%20polyline%20that%20has%20no%20self-intersections%20and%20self-touches.%20The%20polyline%20divides%20the%20plane%20into%20two%20connected%20parts%3A%20the%20part%20of%20an%20infinite%20area%20and%20the%20part%20of%20a%20finite%20area.%20It%20is%20considered%20that%20cell%20%24%20%28r%2Cc%29%20%24%20lies%20outside%20of%20the%20cycle%20if%20it%20does%20not%20belong%20to%20the%20cycle%20and%20the%20corresponding%20point%20on%20the%20plane%20with%20coordinates%20%24%20%28r%2Cc%29%20%24%20lies%20in%20the%20part%20with%20the%20infinite%20area.%5Cn%5CnHelp%20Petya%20to%20find%20the%20length%20of%20the%20longest%20cool%20cycle%20in%20the%20table.%20The%20cycle%20length%20is%20defined%20as%20the%20number%20of%20cells%20that%20belong%20to%20the%20cycle.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20two%20integers%20%24%20n%20%24%20and%20%24%20m%20%24%20%28%20%24%201%3C%3Dn%2Cm%3C%3D1000%20%24%20%29%20%5Cu2014%20the%20number%20of%20rows%20and%20columns%20in%20the%20table%2C%20respectively.%20Each%20of%20the%20following%20%24%20n%20%24%20lines%20contains%20%24%20m%20%24%20characters.%20Each%20character%20can%20be%20either%20%5C%220%5C%22%20or%20%5C%221%5C%22.%22%2C%22outputFormat%22%3A%22Print%20a%20single%20number%20%5Cu2014%20the%20length%20of%20the%20longest%20cool%20cycle%20in%20the%20table.%20If%20such%20cycles%20do%20not%20exist%2C%20print%200.%22%2C%22samples%22%3A%5B%5B%223%203%5Cn111%5Cn101%5Cn111%5Cn%22%2C%228%5Cn%22%5D%2C%5B%225%205%5Cn01010%5Cn10101%5Cn01010%5Cn10101%5Cn01010%5Cn%22%2C%220%5Cn%22%5D%2C%5B%227%207%5Cn1111111%5Cn1000101%5Cn1000101%5Cn1000101%5Cn1000111%5Cn1000001%5Cn1111111%5Cn%22%2C%2224%5Cn%22%5D%2C%5B%225%205%5Cn11111%5Cn10001%5Cn10101%5Cn10001%5Cn11111%5Cn%22%2C%220%5Cn%22%5D%5D%2C%22hint%22%3A%22In%20the%20first%20example%20there%27s%20only%20one%20cycle%20and%20it%20is%20cool.%5Cn%5CnIn%20the%20second%20sample%20there%27s%20no%20cycle%20at%20all.%5Cn%5CnIn%20the%20third%20sample%20there%20are%20two%20cool%20cycles%3A%20their%20lengths%20are%2012%20and%2024.%5Cn%5CnIn%20the%20fourth%20sample%20there%20also%20is%20only%20one%20cycle%20but%20it%20isn%27t%20cool%20as%20there%27s%20a%20cell%20containing%20%5C%221%5C%22%20inside%20this%20cycle.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B3000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F135%5C%2FD%22%2C%22id%22%3A%22135D%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A5%2C%22totalAccepted%22%3A1%2C%22pid%22%3A%22CF135D%22%2C%22title%22%3A%22Cycle%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Cycle%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573295103;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Cycle</h1>
<h2>题目描述</h2>
<div>Little Petya very much likes rectangular tables that consist of characters "0" and "1". Recently he has received one such table as a gift from his mother. The table contained $ n $ rows and $ m $ columns. The rows are numbered from top to bottom from $ 1 $ to $ n $ , the columns are numbered from the left to the right from $ 1 $ to $ m $ . Petya immediately decided to find the longest cool cycle whatever it takes.
A cycle is a sequence of pairwise distinct cells where each two consecutive cells have a common side; besides, the first cell has a common side with the last cell. A cycle is called cool if it fulfills all the following conditions simultaneously:
- The cycle entirely consists of the cells that contain "1".
- Each cell that belongs to the cycle, has a common side with exactly two other cells that belong to the cycle.
- Each cell of the table that contains "1" either belongs to the cycle or is positioned outside of it (see definition below).
To define the notion of "outside" formally, let's draw a cycle on a plane. Let each cell of the cycle $ (i,j) $ ( $ i $ is the row number, $ j $ is the column number) correspond to the point $ (i,j) $ on the coordinate plane. Let a straight line segment join each pair of points that correspond to the cells belonging to the cycle and sharing a side. Thus, we will get a closed polyline that has no self-intersections and self-touches. The polyline divides the plane into two connected parts: the part of an infinite area and the part of a finite area. It is considered that cell $ (r,c) $ lies outside of the cycle if it does not belong to the cycle and the corresponding point on the plane with coordinates $ (r,c) $ lies in the part with the infinite area.
Help Petya to find the length of the longest cool cycle in the table. The cycle length is defined as the number of cells that belong to the cycle.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains two integers $ n $ and $ m $ ( $ 1<=n,m<=1000 $ ) — the number of rows and columns in the table, respectively. Each of the following $ n $ lines contains $ m $ characters. Each character can be either "0" or "1".</div>
<h3>输出格式</h3>
<br />
<div>Print a single number — the length of the longest cool cycle in the table. If such cycles do not exist, print 0.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>3 3
111
101
111
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>8
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>5 5
01010
10101
01010
10101
01010
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>0
</code></pre>
<h3>输入样例 #3</h3>
<pre><code>7 7
1111111
1000101
1000101
1000101
1000111
1000001
1111111
</code></pre>
<h3>输出样例 #3</h3>
<pre><code>24
</code></pre>
<h3>输入样例 #4</h3>
<pre><code>5 5
11111
10001
10101
10001
11111
</code></pre>
<h3>输出样例 #4</h3>
<pre><code>0
</code></pre>
<h2>说明</h2>
<div>In the first example there's only one cycle and it is cool.
In the second sample there's no cycle at all.
In the third sample there are two cool cycles: their lengths are 12 and 24.
In the fourth sample there also is only one cycle but it isn't cool as there's a cell containing "1" inside this cycle.</div>
</article>
</div>
</div>
</body>
</html>
