<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Edge coloring of bipartite graph - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573395851:FhzCBG1gBNx+HFjnnhE05ZLZiA5catbDjXGBCPVtiUg=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22You%20are%20given%20an%20undirected%20bipartite%20graph%20without%20multiple%20edges.%20You%20should%20paint%20the%20edges%20of%20graph%20to%20minimal%20number%20of%20colours%2C%20so%20that%20no%20two%20adjacent%20edges%20have%20the%20same%20colour.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20three%20integers%20%24%20a%2Cb%2Cm%20%24%20%28%20%24%201%3C%3Da%2Cb%3C%3D1000%20%24%20%2C%20%24%200%3C%3Dm%3C%3D10%5E%7B5%7D%20%24%20%29%2C%20%24%20a%20%24%20is%20the%20size%20of%20the%20first%20part%2C%20%24%20b%20%24%20is%20the%20size%20of%20the%20second%20part%2C%20%24%20m%20%24%20is%20the%20number%20of%20edges%20in%20the%20graph.%5Cn%5CnEach%20of%20the%20next%20%24%20m%20%24%20lines%20contains%20two%20integers%20%24%20x%2Cy%20%24%20%28%20%24%201%3C%3Dx%3C%3Da%2C1%3C%3Dy%3C%3Db%20%24%20%29%2C%20where%20%24%20x%20%24%20is%20the%20number%20of%20the%20vertex%20in%20the%20first%20part%20and%20%24%20y%20%24%20is%20the%20number%20of%20the%20vertex%20in%20the%20second%20part.%20It%20is%20guaranteed%20that%20there%20are%20no%20multiple%20edges.%22%2C%22outputFormat%22%3A%22In%20the%20first%20line%20print%20integer%20%24%20c%20%24%20%5Cu2014%20the%20minimal%20number%20of%20colours.%20The%20second%20line%20should%20contain%20%24%20m%20%24%20integers%20from%20%24%201%20%24%20to%20%24%20c%20%24%20%5Cu2014%20the%20colours%20of%20the%20edges%20%28in%20the%20order%20they%20appear%20in%20the%20input%29.%5Cn%5CnIf%20there%20are%20several%20solutions%2C%20you%20can%20print%20any%20one%20of%20them.%22%2C%22samples%22%3A%5B%5B%224%203%205%5Cn1%202%5Cn2%202%5Cn3%202%5Cn4%201%5Cn4%203%5Cn%22%2C%223%5Cn1%202%203%201%202%5Cn%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F600%5C%2FF%22%2C%22id%22%3A%22600F%22%7D%2C%22translation%22%3A%22%23%23%23%23%20%5Cu9898%5Cu610f%5Cr%5Cn%5Cu7ed9%5Cu4f60%5Cu4e00%5Cu4e2a%5Cu65e0%5Cu5411%5Cu7684%5Cu4e8c%5Cu5206%5Cu56fe%5Cu3002%5Cu73b0%5Cu5728%5Cu5c06%5Cu5b83%5Cu7684%5Cu6bcf%5Cu6761%5Cu8fb9%5Cu67d3%5Cu8272%5Cuff0c%5Cu4f7f%5Cu5f97%5Cu4efb%5Cu610f%5Cu4e24%5Cu6761%5Cu76f8%5Cu90bb%5Cuff08%5Cu6709%5Cu516c%5Cu5171%5Cu9876%5Cu70b9%5Cuff09%5Cu7684%5Cu8fb9%5Cu989c%5Cu8272%5Cu4e0d%5Cu540c%5Cu3002%5Cu8bf7%5Cu4f60%5Cu8ba1%5Cu7b97%5Cu4e00%5Cu79cd%5Cu67d3%5Cu8272%5Cu65b9%5Cu6848%5Cuff0c%5Cu4f7f%5Cu5f97%5Cu7528%5Cu5230%5Cu7684%5Cu989c%5Cu8272%5Cu6570%5Cu91cf%5Cu6700%5Cu5c11%5Cu3002%5Cr%5Cn%23%23%23%23%20%5Cu8f93%5Cu5165%5Cu683c%5Cu5f0f%5Cr%5Cn%5Cu7b2c%5Cu4e00%5Cu884c%5Cu5305%5Cu62ec%5Cu4e09%5Cu4e2a%5Cu6574%5Cu6570%5Cuff1a%24a%2Cb%2Cm%281%5C%5Cleq%20a%2Cb%5C%5Cleq1000%2C0%5C%5Cleq%20n%5C%5Cleq10%5E5%29%24%5Cuff0c%5Cu5176%5Cu4e2d%24a%24%5Cu8868%5Cu793a%5Cu5de6%5Cu534a%5Cu90e8%5Cu5206%5Cu7684%5Cu70b9%5Cu6570%5Cuff0c%24b%24%5Cu8868%5Cu793a%5Cu53f3%5Cu534a%5Cu90e8%5Cu5206%5Cu7684%5Cu70b9%5Cu6570%5Cuff0c%24m%24%5Cu8868%5Cu793a%5Cu8fb9%5Cu6570%5Cu3002%5Cr%5Cn%5Cu4e0b%5Cu9762%24m%24%5Cu884c%5Cuff0c%5Cu6bcf%5Cu884c%5Cu4e24%5Cu4e2a%5Cu6574%5Cu6570%24x%2Cy%281%5C%5Cleq%20x%5C%5Cleq%20a%2C1%5C%5Cleq%20y%5C%5Cleq%20b%29%24%5Cuff0c%5Cu8868%5Cu793a%5Cu5de6%5Cu534a%5Cu90e8%5Cu5206%5Cu4e2d%5Cu7f16%5Cu53f7%5Cu4e3a%24x%24%5Cu7684%5Cu70b9%5Cu4e0e%5Cu53f3%5Cu534a%5Cu90e8%5Cu5206%5Cu4e2d%5Cu7f16%5Cu53f7%5Cu4e3a%24y%24%5Cu7684%5Cu70b9%5Cu4e4b%5Cu95f4%5Cu6709%5Cu4e00%5Cu6761%5Cu65e0%5Cu5411%5Cu8fb9%5Cu3002%5Cu8f93%5Cu5165%5Cu4fdd%5Cu8bc1%5Cu6ca1%5Cu6709%5Cu91cd%5Cu8fb9%5Cu3002%5Cr%5Cn%23%23%23%23%20%5Cu8f93%5Cu51fa%5Cu683c%5Cu5f0f%5Cr%5Cn%5Cu7b2c%5Cu4e00%5Cu884c%5Cu4e00%5Cu4e2a%5Cu6574%5Cu6570%24c%24%5Cuff0c%5Cu8868%5Cu793a%5Cu6700%5Cu5c11%5Cu8981%5Cu4f7f%5Cu7528%5Cu591a%5Cu5c11%5Cu79cd%5Cu989c%5Cu8272%5Cuff1b%5Cr%5Cn%5Cu7b2c%5Cu4e8c%5Cu884c%24m%24%5Cu4e2a%5Cu6574%5Cu6570%5Cuff0c%5Cu7b2c%24i%281%5C%5Cleq%20i%5C%5Cleq%20m%29%24%5Cu4e2a%5Cu6574%5Cu6570%24d_i%281%5C%5Cleq%20d_i%5C%5Cleq%20c%29%24%5Cu8868%5Cu793a%5Cu7b2c%24i%24%5Cu6761%5Cu8fb9%5Cu7684%5Cu989c%5Cu8272%5Cu4e3a%24d_i%24%5Cu3002%20%20%5Cr%5Cn%5Cu5982%5Cu679c%5Cu89e3%5Cu4e0d%5Cu552f%5Cu4e00%5Cuff0c%5Cu8f93%5Cu51fa%5Cu4efb%5Cu610f%5Cu4e00%5Cu4e2a%5Cu5373%5Cu53ef%5Cu3002%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A1%2C%22totalAccepted%22%3A1%2C%22pid%22%3A%22CF600F%22%2C%22title%22%3A%22Edge%20coloring%20of%20bipartite%20graph%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Edge%20coloring%20of%20bipartite%20graph%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Edge coloring of bipartite graph</h1>
<h2>题意翻译</h2>
<div>#### 题意
给你一个无向的二分图。现在将它的每条边染色，使得任意两条相邻（有公共顶点）的边颜色不同。请你计算一种染色方案，使得用到的颜色数量最少。
#### 输入格式
第一行包括三个整数：$a,b,m(1\leq a,b\leq1000,0\leq n\leq10^5)$，其中$a$表示左半部分的点数，$b$表示右半部分的点数，$m$表示边数。
下面$m$行，每行两个整数$x,y(1\leq x\leq a,1\leq y\leq b)$，表示左半部分中编号为$x$的点与右半部分中编号为$y$的点之间有一条无向边。输入保证没有重边。
#### 输出格式
第一行一个整数$c$，表示最少要使用多少种颜色；
第二行$m$个整数，第$i(1\leq i\leq m)$个整数$d_i(1\leq d_i\leq c)$表示第$i$条边的颜色为$d_i$。
如果解不唯一，输出任意一个即可。</div>
<h2>题目描述</h2>
<div>You are given an undirected bipartite graph without multiple edges. You should paint the edges of graph to minimal number of colours, so that no two adjacent edges have the same colour.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains three integers $ a,b,m $ ( $ 1<=a,b<=1000 $ , $ 0<=m<=10^{5} $ ), $ a $ is the size of the first part, $ b $ is the size of the second part, $ m $ is the number of edges in the graph.
Each of the next $ m $ lines contains two integers $ x,y $ ( $ 1<=x<=a,1<=y<=b $ ), where $ x $ is the number of the vertex in the first part and $ y $ is the number of the vertex in the second part. It is guaranteed that there are no multiple edges.</div>
<h3>输出格式</h3>
<br />
<div>In the first line print integer $ c $ — the minimal number of colours. The second line should contain $ m $ integers from $ 1 $ to $ c $ — the colours of the edges (in the order they appear in the input).
If there are several solutions, you can print any one of them.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>4 3 5
1 2
2 2
3 2
4 1
4 3
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>3
1 2 3 1 2
</code></pre>
</article>
</div>
</div>
</body>
</html>
