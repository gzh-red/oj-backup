<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Magic Breeding - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573398944:eQP/2KvWoO7CMeknPGmEYXTAMfYKHY/qvfuCqRO4JKE=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Nikita%20and%20Sasha%20play%20a%20computer%20game%20where%20you%20have%20to%20breed%20some%20magical%20creatures.%20Initially%2C%20they%20have%20%24%20k%20%24%20creatures%20numbered%20from%20%24%201%20%24%20to%20%24%20k%20%24%20.%20Creatures%20have%20%24%20n%20%24%20different%20characteristics.%5Cn%5CnSasha%20has%20a%20spell%20that%20allows%20to%20create%20a%20new%20creature%20from%20two%20given%20creatures.%20Each%20of%20its%20characteristics%20will%20be%20equal%20to%20the%20maximum%20of%20the%20corresponding%20characteristics%20of%20used%20creatures.%20Nikita%20has%20a%20similar%20spell%2C%20but%20in%20his%20spell%2C%20each%20characteristic%20of%20the%20new%20creature%20is%20equal%20to%20the%20minimum%20of%20the%20corresponding%20characteristics%20of%20used%20creatures.%20A%20new%20creature%20gets%20the%20smallest%20unused%20number.%5Cn%5CnThey%20use%20their%20spells%20and%20are%20interested%20in%20some%20characteristics%20of%20their%20new%20creatures.%20Help%20them%20find%20out%20these%20characteristics.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20integers%20%24%20n%20%24%20%2C%20%24%20k%20%24%20and%20%24%20q%20%24%20%28%20%24%201%3C%3Dn%3C%3D10%5E%7B5%7D%20%24%20%2C%20%24%201%3C%3Dk%3C%3D12%20%24%20%2C%20%24%201%3C%3Dq%3C%3D10%5E%7B5%7D%20%24%20%29%20%5Cu2014%20number%20of%20characteristics%2C%20creatures%20and%20queries.%5Cn%5CnNext%20%24%20k%20%24%20lines%20describe%20original%20creatures.%20The%20line%20%24%20i%20%24%20contains%20%24%20n%20%24%20numbers%20%24%20a_%7Bi1%7D%2Ca_%7Bi2%7D%2C...%2Ca_%7Bin%7D%20%24%20%28%20%24%201%3C%3Da_%7Bij%7D%3C%3D10%5E%7B9%7D%20%24%20%29%20%5Cu2014%20characteristics%20of%20the%20%24%20i%20%24%20-th%20creature.%5Cn%5CnEach%20of%20the%20next%20%24%20q%20%24%20lines%20contains%20a%20query.%20The%20%24%20i%20%24%20-th%20of%20these%20lines%20contains%20numbers%20%24%20t_%7Bi%7D%20%24%20%2C%20%24%20x_%7Bi%7D%20%24%20and%20%24%20y_%7Bi%7D%20%24%20%28%20%24%201%3C%3Dt_%7Bi%7D%3C%3D3%20%24%20%29.%20They%20denote%20a%20query%3A%5Cn%5Cn-%20%24%20t_%7Bi%7D%3D1%20%24%20means%20that%20Sasha%20used%20his%20spell%20to%20the%20creatures%20%24%20x_%7Bi%7D%20%24%20and%20%24%20y_%7Bi%7D%20%24%20.%5Cn-%20%24%20t_%7Bi%7D%3D2%20%24%20means%20that%20Nikita%20used%20his%20spell%20to%20the%20creatures%20%24%20x_%7Bi%7D%20%24%20and%20%24%20y_%7Bi%7D%20%24%20.%5Cn-%20%24%20t_%7Bi%7D%3D3%20%24%20means%20that%20they%20want%20to%20know%20the%20%24%20y_%7Bi%7D%20%24%20-th%20characteristic%20of%20the%20%24%20x_%7Bi%7D%20%24%20-th%20creature.%20In%20this%20case%20%24%201%3C%3Dy_%7Bi%7D%3C%3Dn%20%24%20.%5Cn%5CnIt%27s%20guaranteed%20that%20all%20creatures%27%20numbers%20are%20valid%2C%20that%20means%20that%20they%20are%20created%20before%20any%20of%20the%20queries%20involving%20them.%22%2C%22outputFormat%22%3A%22For%20each%20query%20with%20%24%20t_%7Bi%7D%3D3%20%24%20output%20the%20corresponding%20characteristic.%22%2C%22samples%22%3A%5B%5B%222%202%204%5Cn1%202%5Cn2%201%5Cn1%201%202%5Cn2%201%202%5Cn3%203%201%5Cn3%204%202%5Cn%22%2C%222%5Cn1%5Cn%22%5D%2C%5B%225%203%208%5Cn1%202%203%204%205%5Cn5%201%202%203%204%5Cn4%205%201%202%203%5Cn1%201%202%5Cn1%202%203%5Cn2%204%205%5Cn3%206%201%5Cn3%206%202%5Cn3%206%203%5Cn3%206%204%5Cn3%206%205%5Cn%22%2C%225%5Cn2%5Cn2%5Cn3%5Cn4%5Cn%22%5D%5D%2C%22hint%22%3A%22In%20the%20first%20sample%2C%20Sasha%20makes%20a%20creature%20with%20number%20%24%203%20%24%20and%20characteristics%20%24%20%282%2C2%29%20%24%20.%20Nikita%20makes%20a%20creature%20with%20number%20%24%204%20%24%20and%20characteristics%20%24%20%281%2C1%29%20%24%20.%20After%20that%20they%20find%20out%20the%20first%20characteristic%20for%20the%20creature%20%24%203%20%24%20and%20the%20second%20characteristic%20for%20the%20creature%20%24%204%20%24%20.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B4000%5D%2C%22memory%22%3A%5B1024000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F878%5C%2FD%22%2C%22id%22%3A%22878D%22%7D%2C%22translation%22%3A%22%5Cu5c3c%5Cu57fa%5Cu5854%5Cu548c%5Cu8428%5Cu838e%5Cu73a9%5Cu7535%5Cu8111%5Cu6e38%5Cu620f%5Cuff0c%5Cu4f60%5Cu9700%5Cu8981%5Cu57f9%5Cu517b%5Cu4e00%5Cu4e9b%5Cu795e%5Cu5947%5Cu751f%5Cu7269%5Cu3002%5Cu8d77%5Cu521d%5Cuff0c%5Cu4ed6%5Cu4eec%5Cu6709%24k%24%5Cu4e2a%5Cu7f16%5Cu53f7%5Cu4ece%20%241%24%20%5Cu5230%20%24k%24%20%5Cu7684%5Cu751f%5Cu7269%5Cu3002%5Cu6bcf%5Cu4e2a%5Cu751f%5Cu7269%5Cu5177%5Cu6709%5Cu4e0d%5Cu540c%5Cu7684%5Cu7279%5Cu5f81%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu8428%5Cu838e%5Cu6709%5Cu4e00%5Cu4e2a%5Cu6cd5%5Cu672f%5Cu80fd%5Cu4ece%5Cu4e24%5Cu4e2a%5Cu7ed9%5Cu5b9a%5Cu7684%5Cu751f%5Cu7269%5Cu4e2d%5Cu521b%5Cu9020%5Cu4e00%5Cu4e2a%5Cu65b0%5Cu751f%5Cu7269%5Cu3002%5Cu5b83%5Cu7684%5Cu6bcf%5Cu4e2a%5Cu7279%5Cu5f81%5Cu5c06%5Cu7b49%5Cu4e8e%5Cu6240%5Cu7528%5Cu751f%5Cu7269%5Cu7684%5Cu76f8%5Cu5e94%5Cu7279%5Cu5f81%5Cu7684%5Cu6700%5Cu5927%5Cu503c%5Cu3002%5Cu5c3c%5Cu57fa%5Cu5854%5Cu6709%5Cu4e00%5Cu4e2a%5Cu7c7b%5Cu4f3c%5Cu7684%5Cu6cd5%5Cu672f%5Cuff0c%5Cu4f46%5Cu5728%5Cu4ed6%5Cu7684%5Cu6cd5%5Cu672f%5Cu4e2d%5Cuff0c%5Cu65b0%5Cu751f%5Cu7269%5Cu7684%5Cu6bcf%5Cu4e2a%5Cu7279%5Cu5f81%5Cu90fd%5Cu7b49%5Cu4e8e%5Cu6240%5Cu7528%5Cu751f%5Cu7269%5Cu7684%5Cu76f8%5Cu5e94%5Cu7279%5Cu5f81%5Cu7684%5Cu6700%5Cu5c0f%5Cu503c%5Cu3002%5Cu65b0%5Cu751f%5Cu7269%5Cu83b7%5Cu5f97%5Cu6700%5Cu5c0f%5Cu7684%5Cu672a%5Cu4f7f%5Cu7528%5Cu6570%5Cu5b57%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu4ed6%5Cu4eec%5Cu4f7f%5Cu7528%5Cu4ed6%5Cu4eec%5Cu7684%5Cu6cd5%5Cu672f%5Cuff0c%5Cu5e76%5Cu5bf9%5Cu4ed6%5Cu4eec%5Cu7684%5Cu65b0%5Cu751f%5Cu7269%5Cu7684%5Cu67d0%5Cu4e9b%5Cu7279%5Cu5f81%5Cu611f%5Cu5174%5Cu8da3%5Cu3002%5Cu5e2e%5Cu52a9%5Cu4ed6%5Cu4eec%5Cu627e%5Cu51fa%5Cu8fd9%5Cu4e9b%5Cu7279%5Cu5f81%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu7b2c%5Cu4e00%5Cu884c%5Cu5305%5Cu542b%5Cu6574%5Cu6570%20%24n%24%20%5Cuff0c%20%24k%24%20%5Cu548c%20%24q%24%20%5Cuff08%241%20%3C%3D%20n%20%3C%3D%2010%20%5E%205%24%20%2C%20%241%20%3C%3D%20k%20%3C%3D%2012%24%20%2C%20%241%20%3C%3D%20q%20%3C%3D%2010%20%5E%205%24%5Cuff09%5Cuff0c%5Cu8868%5Cu793a%5Cu7279%5Cu5f81%5Cuff0c%5Cu751f%5Cu7269%5Cu548c%5Cu67e5%5Cu8be2%5Cu7684%5Cu6570%5Cu91cf%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu63a5%5Cu4e0b%5Cu6765%5Cu7684%20%24k%24%20%5Cu884c%5Cu63cf%5Cu8ff0%5Cu539f%5Cu59cb%5Cu751f%5Cu7269%5Cu3002%5Cu7b2c%20%24i%24%20%5Cu884c%5Cu5305%5Cu542b%20%24n%24%20%5Cu4e2a%5Cu6570%5Cu5b57%5Cr%5Cn%24a_%7Bi%2C1%7D%2Ca_%7Bi%2C2%7D%2C...%2Ca_%7Bi%2Cn%7D%281%20%3C%3D%20a_%7Bi%2Cj%7D%20%3C%3D%2010%20%5E%209%29%24%20%5Cu8868%5Cu793a%5Cu7b2c%20i%20%5Cu4e2a%5Cu751f%5Cu7269%5Cu7684%5Cu7279%5Cu5f81%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu4e0b%5Cu9762%20%24q%24%20%5Cu884c%5Cu4e2d%5Cu7684%5Cu6bcf%5Cu4e00%5Cu884c%5Cu90fd%5Cu5305%5Cu542b%5Cu4e00%5Cu4e2a%5Cu67e5%5Cu8be2%5Cu3002%5Cu8fd9%5Cu4e9b%5Cu884c%5Cu7684%5Cu7b2c%20%24i%24%20%5Cu4e2a%5Cu5305%5Cu542b%5Cu6570%5Cu5b57%20%24t_i%2Cxi%24%20%5Cu548c%20%24%20yi%20%24%20%24%281%20%3C%3D%20t_i%20%3C%3D%203%29%24%20%5Cu3002%5Cu5b83%5Cu4eec%5Cu8868%5Cu793a%5Cu67e5%5Cu8be2%5Cu3002%5Cr%5Cn%5Cr%5Cn%24%20t_i%20%3D%201%20%24%20%5Cu610f%5Cu5473%5Cu7740%5Cu8428%5Cu838e%5Cu5c06%5Cu4ed6%5Cu7684%5Cu5492%5Cu8bed%5Cu7528%5Cu4e8e%5Cu751f%5Cu7269%20%24x_i%24%20%5Cu548c%20%24y_i%24%5Cr%5Cn%5Cr%5Cn%24%20t_i%20%3D%202%20%24%20%5Cu610f%5Cu5473%5Cu7740%5Cu5c3c%5Cu57fa%5Cu5854%5Cu5c06%5Cu4ed6%5Cu7684%5Cu5492%5Cu8bed%5Cu7528%5Cu4e8e%5Cu751f%5Cu7269%20%24x_i%24%20%5Cu548c%20%24y_i%24%5Cr%5Cn%5Cr%5Cn%24%20t_i%20%3D%203%20%24%20%5Cu610f%5Cu5473%5Cu7740%5Cu4ed6%5Cu4eec%5Cu60f3%5Cu77e5%5Cu9053%5Cu7b2c%20%24x_i%24%20%5Cu4e2a%5Cu751f%5Cu7269%5Cu7684%5Cu7b2c%20%24y%24%20%5Cu4e2a%5Cu7279%5Cu5f81%5Cu3002%5Cu5728%5Cu8fd9%5Cu79cd%5Cu60c5%5Cu51b5%5Cu4e0b%5Cuff0c%24%201%20%3C%3D%20y_i%20%3C%3D%20n%20%24%5Cr%5Cn%5Cr%5Cn%5Cu4fdd%5Cu8bc1%5Cu6240%5Cu6709%5Cu751f%5Cu7269%5Cu7684%5Cu6570%5Cu5b57%5Cu90fd%5Cu6709%5Cu6548%5Cuff0c%5Cu8fd9%5Cu610f%5Cu5473%5Cu7740%5Cu5b83%5Cu4eec%5Cu662f%5Cu5728%5Cu6d89%5Cu53ca%5Cu5b83%5Cu4eec%5Cu7684%5Cu4efb%5Cu4f55%5Cu67e5%5Cu8be2%5Cu4e4b%5Cu524d%5Cu521b%5Cu5efa%5Cu7684%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu8f93%5Cu51fa%5Cu683c%5Cu5f0f%5Cuff1a%5Cr%5Cn%5Cu5bf9%5Cu4e8e%5Cu6bcf%5Cu4e2a%20%24%20t_i%20%3D%203%20%24%20%5Cu7684%5Cu67e5%5Cu8be2%5Cuff0c%5Cu8f93%5Cu51fa%5Cu76f8%5Cu5e94%5Cu7684%5Cu7279%5Cu5f81%5Cu3002%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A53%2C%22totalAccepted%22%3A28%2C%22pid%22%3A%22CF878D%22%2C%22title%22%3A%22Magic%20Breeding%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A105493%2C%22title%22%3A%22%5Cu4e00%5Cu4efd%5Cu7ffb%5Cu8bd1%5Cu3002%22%2C%22forum%22%3A%7B%22id%22%3A9059%2C%22name%22%3A%22CF878D%20Magic%20Breeding%22%2C%22slug%22%3A%22CF878D%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22CF914F%22%2C%22title%22%3A%22Substrings%20in%20a%20String%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF878C%22%2C%22title%22%3A%22Tournament%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22SP9534%22%2C%22title%22%3A%22JZPLIT%20-%20Turn%20on%20the%20lights%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22SP%22%7D%2C%7B%22pid%22%3A%22P4587%22%2C%22title%22%3A%22%5BFJOI2016%5D%5Cu795e%5Cu79d8%5Cu6570%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P4823%22%2C%22title%22%3A%22%5BTJOI2013%5D%5Cu62ef%5Cu6551%5Cu5c0f%5Cu77ee%5Cu4eba%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Magic%20Breeding%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Magic Breeding</h1>
<h2>题意翻译</h2>
<div>尼基塔和萨莎玩电脑游戏，你需要培养一些神奇生物。起初，他们有$k$个编号从 $1$ 到 $k$ 的生物。每个生物具有不同的特征。
萨莎有一个法术能从两个给定的生物中创造一个新生物。它的每个特征将等于所用生物的相应特征的最大值。尼基塔有一个类似的法术，但在他的法术中，新生物的每个特征都等于所用生物的相应特征的最小值。新生物获得最小的未使用数字。
他们使用他们的法术，并对他们的新生物的某些特征感兴趣。帮助他们找出这些特征。
第一行包含整数 $n$ ， $k$ 和 $q$ （$1 <= n <= 10 ^ 5$ , $1 <= k <= 12$ , $1 <= q <= 10 ^ 5$），表示特征，生物和查询的数量。
接下来的 $k$ 行描述原始生物。第 $i$ 行包含 $n$ 个数字
$a_{i,1},a_{i,2},...,a_{i,n}(1 <= a_{i,j} <= 10 ^ 9)$ 表示第 i 个生物的特征。
下面 $q$ 行中的每一行都包含一个查询。这些行的第 $i$ 个包含数字 $t_i,xi$ 和 $ yi $ $(1 <= t_i <= 3)$ 。它们表示查询。
$ t_i = 1 $ 意味着萨莎将他的咒语用于生物 $x_i$ 和 $y_i$
$ t_i = 2 $ 意味着尼基塔将他的咒语用于生物 $x_i$ 和 $y_i$
$ t_i = 3 $ 意味着他们想知道第 $x_i$ 个生物的第 $y$ 个特征。在这种情况下，$ 1 <= y_i <= n $
保证所有生物的数字都有效，这意味着它们是在涉及它们的任何查询之前创建的。
输出格式：
对于每个 $ t_i = 3 $ 的查询，输出相应的特征。</div>
<h2>题目描述</h2>
<div>Nikita and Sasha play a computer game where you have to breed some magical creatures. Initially, they have $ k $ creatures numbered from $ 1 $ to $ k $ . Creatures have $ n $ different characteristics.
Sasha has a spell that allows to create a new creature from two given creatures. Each of its characteristics will be equal to the maximum of the corresponding characteristics of used creatures. Nikita has a similar spell, but in his spell, each characteristic of the new creature is equal to the minimum of the corresponding characteristics of used creatures. A new creature gets the smallest unused number.
They use their spells and are interested in some characteristics of their new creatures. Help them find out these characteristics.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains integers $ n $ , $ k $ and $ q $ ( $ 1<=n<=10^{5} $ , $ 1<=k<=12 $ , $ 1<=q<=10^{5} $ ) — number of characteristics, creatures and queries.
Next $ k $ lines describe original creatures. The line $ i $ contains $ n $ numbers $ a_{i1},a_{i2},...,a_{in} $ ( $ 1<=a_{ij}<=10^{9} $ ) — characteristics of the $ i $ -th creature.
Each of the next $ q $ lines contains a query. The $ i $ -th of these lines contains numbers $ t_{i} $ , $ x_{i} $ and $ y_{i} $ ( $ 1<=t_{i}<=3 $ ). They denote a query:
- $ t_{i}=1 $ means that Sasha used his spell to the creatures $ x_{i} $ and $ y_{i} $ .
- $ t_{i}=2 $ means that Nikita used his spell to the creatures $ x_{i} $ and $ y_{i} $ .
- $ t_{i}=3 $ means that they want to know the $ y_{i} $ -th characteristic of the $ x_{i} $ -th creature. In this case $ 1<=y_{i}<=n $ .
It's guaranteed that all creatures' numbers are valid, that means that they are created before any of the queries involving them.</div>
<h3>输出格式</h3>
<br />
<div>For each query with $ t_{i}=3 $ output the corresponding characteristic.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>2 2 4
1 2
2 1
1 1 2
2 1 2
3 3 1
3 4 2
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>2
1
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>5 3 8
1 2 3 4 5
5 1 2 3 4
4 5 1 2 3
1 1 2
1 2 3
2 4 5
3 6 1
3 6 2
3 6 3
3 6 4
3 6 5
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>5
2
2
3
4
</code></pre>
<h2>说明</h2>
<div>In the first sample, Sasha makes a creature with number $ 3 $ and characteristics $ (2,2) $ . Nikita makes a creature with number $ 4 $ and characteristics $ (1,1) $ . After that they find out the first characteristic for the creature $ 3 $ and the second characteristic for the creature $ 4 $ .</div>
</article>
</div>
</div>
</body>
</html>
