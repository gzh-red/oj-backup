<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Defragmentation - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573391495:p0RmY585/QUXTdrO3+s4zKw4Egn4AcjTY1X+ZVqBRQk=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22In%20this%20problem%20you%20have%20to%20implement%20an%20algorithm%20to%20defragment%20your%20hard%20disk.%20The%20hard%20disk%20consists%20of%20a%20sequence%20of%20clusters%2C%20numbered%20by%20integers%20from%20%24%201%20%24%20to%20%24%20n%20%24%20.%20The%20disk%20has%20%24%20m%20%24%20recorded%20files%2C%20the%20%24%20i%20%24%20-th%20file%20occupies%20clusters%20with%20numbers%20%24%20a_%7Bi%2C1%7D%20%24%20%2C%20%24%20a_%7Bi%2C2%7D%20%24%20%2C%20...%2C%20%24%20a_%7Bi%2Cni%7D%20%24%20.%20These%20clusters%20are%20not%20necessarily%20located%20consecutively%20on%20the%20disk%2C%20but%20the%20order%20in%20which%20they%20are%20given%20corresponds%20to%20their%20sequence%20in%20the%20file%20%28cluster%20%24%20a_%7Bi%2C1%7D%20%24%20contains%20the%20first%20fragment%20of%20the%20%24%20i%20%24%20-th%20file%2C%20cluster%20%24%20a_%7Bi%2C2%7D%20%24%20has%20the%20second%20fragment%2C%20etc.%29.%20Also%20the%20disc%20must%20have%20one%20or%20several%20clusters%20which%20are%20free%20from%20files.%5Cn%5CnYou%20are%20permitted%20to%20perform%20operations%20of%20copying%20the%20contents%20of%20cluster%20number%20%24%20i%20%24%20to%20cluster%20number%20%24%20j%20%24%20%28%20%24%20i%20%24%20and%20%24%20j%20%24%20must%20be%20different%29.%20Moreover%2C%20if%20the%20cluster%20number%20%24%20j%20%24%20used%20to%20keep%20some%20information%2C%20it%20is%20lost%20forever.%20Clusters%20are%20not%20cleaned%2C%20but%20after%20the%20defragmentation%20is%20complete%2C%20some%20of%20them%20are%20simply%20declared%20unusable%20%28although%20they%20may%20possibly%20still%20contain%20some%20fragments%20of%20files%29.%5Cn%5CnYour%20task%20is%20to%20use%20a%20sequence%20of%20copy%20operations%20to%20ensure%20that%20each%20file%20occupies%20a%20contiguous%20area%20of%20memory.%20Each%20file%20should%20occupy%20a%20consecutive%20cluster%20section%2C%20the%20files%20must%20follow%20one%20after%20another%20from%20the%20beginning%20of%20the%20hard%20disk.%20After%20defragmentation%20all%20free%20%28unused%29%20clusters%20should%20be%20at%20the%20end%20of%20the%20hard%20disk.%20After%20defragmenting%20files%20can%20be%20placed%20in%20an%20arbitrary%20order.%20Clusters%20of%20each%20file%20should%20go%20consecutively%20from%20first%20to%20last.%20See%20explanatory%20examples%20in%20the%20notes.%5Cn%5CnPrint%20the%20sequence%20of%20operations%20leading%20to%20the%20disk%20defragmentation.%20Note%20that%20you%20do%20not%20have%20to%20minimize%20the%20number%20of%20operations%2C%20but%20it%20should%20not%20exceed%20%24%202n%20%24%20.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20two%20integers%20%24%20n%20%24%20and%20%24%20m%20%24%20%28%20%24%201%3C%3Dn%2Cm%3C%3D200%20%24%20%29%20%5Cu2014%20the%20number%20of%20clusters%20and%20the%20number%20of%20files%2C%20correspondingly.%20Next%20%24%20m%20%24%20lines%20contain%20descriptions%20of%20the%20files.%20The%20first%20number%20in%20the%20line%20is%20%24%20n_%7Bi%7D%20%24%20%28%20%24%20n_%7Bi%7D%3E%3D1%20%24%20%29%2C%20the%20number%20of%20clusters%20occupied%20by%20the%20%24%20i%20%24%20-th%20file.%20Then%20follow%20%24%20n_%7Bi%7D%20%24%20numbers%20%24%20a_%7Bi%2C1%7D%20%24%20%2C%20%24%20a_%7Bi%2C2%7D%20%24%20%2C%20...%2C%20%24%20a_%7Bi%2Cni%7D%20%24%20%28%20%24%201%3C%3Da_%7Bi%2Cj%7D%3C%3Dn%20%24%20%29.%20It%20is%20guaranteed%20that%20each%20cluster%20number%20occurs%20not%20more%20than%20once%20and%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF180A%5C%2F7897c377ebbf2fed61301dcf3f09eac43feea2dc.png%29%2C%20that%20is%2C%20there%20exists%20at%20least%20one%20unused%20cluster.%20Numbers%20on%20each%20line%20are%20separated%20by%20spaces.%22%2C%22outputFormat%22%3A%22In%20the%20first%20line%20print%20a%20single%20integer%20%24%20k%20%24%20%28%20%24%200%3C%3Dk%3C%3D2n%20%24%20%29%20%5Cu2014%20the%20number%20of%20operations%20needed%20to%20defragment%20the%20disk.%20Next%20%24%20k%20%24%20lines%20should%20contain%20the%20operations%27%20descriptions%20as%20%5C%22%20%24%20i%20%24%20%24%20j%20%24%20%5C%22%20%28copy%20the%20contents%20of%20the%20cluster%20number%20%24%20i%20%24%20to%20the%20cluster%20number%20%24%20j%20%24%20%29.%22%2C%22samples%22%3A%5B%5B%227%202%5Cn2%201%202%5Cn3%203%204%205%5Cn%22%2C%220%5Cn%22%5D%2C%5B%227%202%5Cn2%201%203%5Cn3%202%204%205%5Cn%22%2C%223%5Cn2%206%5Cn3%202%5Cn6%203%5Cn%22%5D%5D%2C%22hint%22%3A%22Let%27s%20say%20that%20a%20disk%20consists%20of%20%24%208%20%24%20clusters%20and%20contains%20two%20files.%20The%20first%20file%20occupies%20two%20clusters%20and%20the%20second%20file%20occupies%20three%20clusters.%20Let%27s%20look%20at%20examples%20of%20correct%20and%20incorrect%20positions%20of%20files%20after%20defragmentation.%5Cn%5Cn%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF180A%5C%2F0a7fd13a2d28952fc6df1e435ad515f512782b76.png%29Example%202%3A%20each%20file%20must%20occupy%20a%20contiguous%20area%20of%20memory.%5Cn%5CnExample%203%3A%20the%20order%20of%20files%20to%20each%20other%20is%20not%20important%2C%20at%20first%20the%20second%20file%20can%20be%20written%2C%20and%20then%20%5Cu2014%20the%20first%20one.%5Cn%5CnExample%204%3A%20violating%20the%20order%20of%20file%20fragments%20to%20each%20other%20is%20not%20allowed.%5Cn%5CnExample%205%3A%20unused%20clusters%20should%20be%20located%20at%20the%20end%2C%20and%20in%20this%20example%20the%20unused%20clusters%20are%20%24%203%20%24%20%2C%20%24%207%20%24%20%2C%20%24%208%20%24%20.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F180%5C%2FA%22%2C%22id%22%3A%22180A%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A4%2C%22totalAccepted%22%3A1%2C%22pid%22%3A%22CF180A%22%2C%22title%22%3A%22Defragmentation%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Defragmentation%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Defragmentation</h1>
<h2>题目描述</h2>
<div>In this problem you have to implement an algorithm to defragment your hard disk. The hard disk consists of a sequence of clusters, numbered by integers from $ 1 $ to $ n $ . The disk has $ m $ recorded files, the $ i $ -th file occupies clusters with numbers $ a_{i,1} $ , $ a_{i,2} $ , ..., $ a_{i,ni} $ . These clusters are not necessarily located consecutively on the disk, but the order in which they are given corresponds to their sequence in the file (cluster $ a_{i,1} $ contains the first fragment of the $ i $ -th file, cluster $ a_{i,2} $ has the second fragment, etc.). Also the disc must have one or several clusters which are free from files.
You are permitted to perform operations of copying the contents of cluster number $ i $ to cluster number $ j $ ( $ i $ and $ j $ must be different). Moreover, if the cluster number $ j $ used to keep some information, it is lost forever. Clusters are not cleaned, but after the defragmentation is complete, some of them are simply declared unusable (although they may possibly still contain some fragments of files).
Your task is to use a sequence of copy operations to ensure that each file occupies a contiguous area of memory. Each file should occupy a consecutive cluster section, the files must follow one after another from the beginning of the hard disk. After defragmentation all free (unused) clusters should be at the end of the hard disk. After defragmenting files can be placed in an arbitrary order. Clusters of each file should go consecutively from first to last. See explanatory examples in the notes.
Print the sequence of operations leading to the disk defragmentation. Note that you do not have to minimize the number of operations, but it should not exceed $ 2n $ .</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains two integers $ n $ and $ m $ ( $ 1<=n,m<=200 $ ) — the number of clusters and the number of files, correspondingly. Next $ m $ lines contain descriptions of the files. The first number in the line is $ n_{i} $ ( $ n_{i}>=1 $ ), the number of clusters occupied by the $ i $ -th file. Then follow $ n_{i} $ numbers $ a_{i,1} $ , $ a_{i,2} $ , ..., $ a_{i,ni} $ ( $ 1<=a_{i,j}<=n $ ). It is guaranteed that each cluster number occurs not more than once and ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF180A/7897c377ebbf2fed61301dcf3f09eac43feea2dc.png), that is, there exists at least one unused cluster. Numbers on each line are separated by spaces.</div>
<h3>输出格式</h3>
<br />
<div>In the first line print a single integer $ k $ ( $ 0<=k<=2n $ ) — the number of operations needed to defragment the disk. Next $ k $ lines should contain the operations' descriptions as " $ i $ $ j $ " (copy the contents of the cluster number $ i $ to the cluster number $ j $ ).</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>7 2
2 1 2
3 3 4 5
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>0
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>7 2
2 1 3
3 2 4 5
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>3
2 6
3 2
6 3
</code></pre>
<h2>说明</h2>
<div>Let's say that a disk consists of $ 8 $ clusters and contains two files. The first file occupies two clusters and the second file occupies three clusters. Let's look at examples of correct and incorrect positions of files after defragmentation.
![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF180A/0a7fd13a2d28952fc6df1e435ad515f512782b76.png)Example 2: each file must occupy a contiguous area of memory.
Example 3: the order of files to each other is not important, at first the second file can be written, and then — the first one.
Example 4: violating the order of file fragments to each other is not allowed.
Example 5: unused clusters should be located at the end, and in this example the unused clusters are $ 3 $ , $ 7 $ , $ 8 $ .</div>
</article>
</div>
</div>
</body>
</html>
