<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Exam in BerSU (hard version) - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573402783:TB1P1b8ED7Y41GSER3vEes5B9ZJrwa2g9sDWNK7UdU4=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22The%20only%20difference%20between%20easy%20and%20hard%20versions%20is%20constraints.%5Cn%5CnIf%20you%20write%20a%20solution%20in%20Python%2C%20then%20prefer%20to%20send%20it%20in%20PyPy%20to%20speed%20up%20execution%20time.%5Cn%5CnA%20session%20has%20begun%20at%20Beland%20State%20University.%20Many%20students%20are%20taking%20exams.%5Cn%5CnPolygraph%20Poligrafovich%20is%20going%20to%20examine%20a%20group%20of%20%24%20n%20%24%20students.%20Students%20will%20take%20the%20exam%20one-by-one%20in%20order%20from%20%24%201%20%24%20-th%20to%20%24%20n%20%24%20-th.%20Rules%20of%20the%20exam%20are%20following%3A%5Cn%5Cn-%20The%20%24%20i%20%24%20-th%20student%20randomly%20chooses%20a%20ticket.%5Cn-%20if%20this%20ticket%20is%20too%20hard%20to%20the%20student%2C%20he%20doesn%27t%20answer%20and%20goes%20home%20immediately%20%28this%20process%20is%20so%20fast%20that%20it%27s%20considered%20no%20time%20elapses%29.%20This%20student%20fails%20the%20exam.%5Cn-%20if%20the%20student%20finds%20the%20ticket%20easy%2C%20he%20spends%20exactly%20%24%20t_i%20%24%20minutes%20to%20pass%20the%20exam.%20After%20it%2C%20he%20immediately%20gets%20a%20mark%20and%20goes%20home.%5Cn%5CnStudents%20take%20the%20exam%20in%20the%20fixed%20order%2C%20one-by-one%2C%20without%20any%20interruption.%20At%20any%20moment%20of%20time%2C%20Polygraph%20Poligrafovich%20takes%20the%20answer%20from%20one%20student.%5Cn%5CnThe%20duration%20of%20the%20whole%20exam%20for%20all%20students%20is%20%24%20M%20%24%20minutes%20%28%20%24%20%5C%5Cmax%20t_i%20%5C%5Cle%20M%20%24%20%29%2C%20so%20students%20at%20the%20end%20of%20the%20list%20have%20a%20greater%20possibility%20to%20run%20out%20of%20time%20to%20pass%20the%20exam.%5Cn%5CnFor%20each%20student%20%24%20i%20%24%20%2C%20you%20should%20count%20the%20minimum%20possible%20number%20of%20students%20who%20need%20to%20fail%20the%20exam%20so%20the%20%24%20i%20%24%20-th%20student%20has%20enough%20time%20to%20pass%20the%20exam.%5Cn%5CnFor%20each%20student%20%24%20i%20%24%20%2C%20find%20the%20answer%20independently.%20That%20is%2C%20if%20when%20finding%20the%20answer%20for%20the%20student%20%24%20i_1%20%24%20some%20student%20%24%20j%20%24%20should%20leave%2C%20then%20while%20finding%20the%20answer%20for%20%24%20i_2%20%24%20%28%20%24%20i_2%3Ei_1%20%24%20%29%20the%20student%20%24%20j%20%24%20student%20does%20not%20have%20to%20go%20home.%22%2C%22inputFormat%22%3A%22The%20first%20line%20of%20the%20input%20contains%20two%20integers%20%24%20n%20%24%20and%20%24%20M%20%24%20%28%20%24%201%20%5C%5Cle%20n%20%5C%5Cle%202%20%5C%5Ccdot%2010%5E5%20%24%20%2C%20%24%201%20%5C%5Cle%20M%20%5C%5Cle%202%20%5C%5Ccdot%2010%5E7%20%24%20%29%20%5Cu2014%20the%20number%20of%20students%20and%20the%20total%20duration%20of%20the%20exam%20in%20minutes%2C%20respectively.%5Cn%5CnThe%20second%20line%20of%20the%20input%20contains%20%24%20n%20%24%20integers%20%24%20t_i%20%24%20%28%20%24%201%20%5C%5Cle%20t_i%20%5C%5Cle%20100%20%24%20%29%20%5Cu2014%20time%20in%20minutes%20that%20%24%20i%20%24%20-th%20student%20spends%20to%20answer%20to%20a%20ticket.%5Cn%5CnIt%27s%20guaranteed%20that%20all%20values%20of%20%24%20t_i%20%24%20are%20not%20greater%20than%20%24%20M%20%24%20.%22%2C%22outputFormat%22%3A%22Print%20%24%20n%20%24%20numbers%3A%20the%20%24%20i%20%24%20-th%20number%20must%20be%20equal%20to%20the%20minimum%20number%20of%20students%20who%20have%20to%20leave%20the%20exam%20in%20order%20to%20%24%20i%20%24%20-th%20student%20has%20enough%20time%20to%20pass%20the%20exam.%22%2C%22samples%22%3A%5B%5B%22%5Cn7%2015%5Cn1%202%203%204%205%206%207%5Cn%22%2C%22%5Cn0%200%200%200%200%202%203%20%22%5D%2C%5B%22%5Cn5%20100%5Cn80%2040%2040%2040%2060%5Cn%22%2C%22%5Cn0%201%201%202%203%20%22%5D%5D%2C%22hint%22%3A%22The%20explanation%20for%20the%20example%201.%5Cn%5CnPlease%20note%20that%20the%20sum%20of%20the%20first%20five%20exam%20times%20does%20not%20exceed%20%24%20M%3D15%20%24%20%28the%20sum%20is%20%24%201%2B2%2B3%2B4%2B5%3D15%20%24%20%29.%20Thus%2C%20the%20first%20five%20students%20can%20pass%20the%20exam%20even%20if%20all%20the%20students%20before%20them%20also%20pass%20the%20exam.%20In%20other%20words%2C%20the%20first%20five%20numbers%20in%20the%20answer%20are%20%24%200%20%24%20.%5Cn%5CnIn%20order%20for%20the%20%24%206%20%24%20-th%20student%20to%20pass%20the%20exam%2C%20it%20is%20necessary%20that%20at%20least%20%24%202%20%24%20students%20must%20fail%20it%20before%20%28for%20example%2C%20the%20%24%203%20%24%20-rd%20and%20%24%204%20%24%20-th%2C%20then%20the%20%24%206%20%24%20-th%20will%20finish%20its%20exam%20in%20%24%201%2B2%2B5%2B6%3D14%20%24%20minutes%2C%20which%20does%20not%20exceed%20%24%20M%20%24%20%29.%5Cn%5CnIn%20order%20for%20the%20%24%207%20%24%20-th%20student%20to%20pass%20the%20exam%2C%20it%20is%20necessary%20that%20at%20least%20%24%203%20%24%20students%20must%20fail%20it%20before%20%28for%20example%2C%20the%20%24%202%20%24%20-nd%2C%20%24%205%20%24%20-th%20and%20%24%206%20%24%20-th%2C%20then%20the%20%24%207%20%24%20-th%20will%20finish%20its%20exam%20in%20%24%201%2B3%2B4%2B7%3D15%20%24%20minutes%2C%20which%20does%20not%20exceed%20%24%20M%20%24%20%29.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F1185%5C%2FC2%22%2C%22id%22%3A%221185C2%22%7D%2C%22translation%22%3A%22%5Cu8fd9%5Cu9898%5Cu4e0e%24CF1185C1%24%5Cu4e0d%5Cu540c%5Cu7684%5Cu53ea%5Cu6709%5Cu6570%5Cu636e%5Cu8303%5Cu56f4~~%5Cu5f53%5Cu7136%5Cu96be%5Cu5ea6%5Cu4e5f%5Cu4f1a%5Cu589e%5Cu5927~~%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu5982%5Cu679c%5Cu7528%24Python%24%5Cu63d0%5Cu4ea4%5Cu7684%5Cu8bdd%5Cuff0c%5Cu90a3%5Cu4e48%5Cu6539%5Cu7528%24PyPy%24%5Cu4ea4%5Cu53ef%5Cu4ee5%5Cu52a0%5Cu5feb%5Cu8fd0%5Cu884c%5Cu65f6%5Cu95f4%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu9898%5Cu610f%5Cu4e0e%24CF1185C1%24%5Cu76f8%5Cu540c%5Cuff0c%5Cu70b9%5Cu51fb%5B%5Cu8fd9%5Cu91cc%5D%28https%3A%5C%2F%5C%2Fwww.luogu.org%5C%2Fproblem%5C%2FCF1185C1%29%5Cu67e5%5Cu770b%5Cu9898%5Cu9762%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu8be5%5Cu9898%5Cu5f53%5Cu4e2d%5Cuff0c%241%5C%5Cleqslant%20n%5C%5Cleqslant%202%2A10%5E5%2C1%5C%5Cleqslant%5C%5Cmax%20t_i%5C%5Cleqslant%20m%5C%5Cleqslant2%2A10%5E7%24%5Cu3002%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A17%2C%22totalAccepted%22%3A13%2C%22pid%22%3A%22CF1185C2%22%2C%22title%22%3A%22Exam%20in%20BerSU%20%28hard%20version%29%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A133153%2C%22title%22%3A%22%5Cu7ffb%5Cu8bd1%5Cuff08%5Cu6709%5Cu70b9%5Cu61d2%5Cuff09%22%2C%22forum%22%3A%7B%22id%22%3A38778%2C%22name%22%3A%22CF1185C2%20Exam%20in%20BerSU%20%28hard%20version%29%22%2C%22slug%22%3A%22CF1185C2%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Exam%20in%20BerSU%20%28hard%20version%29%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Exam in BerSU (hard version)</h1>
<h2>题意翻译</h2>
<div>这题与$CF1185C1$不同的只有数据范围~~当然难度也会增大~~。
如果用$Python$提交的话，那么改用$PyPy$交可以加快运行时间。
题意与$CF1185C1$相同，点击[这里](https://www.luogu.org/problem/CF1185C1)查看题面。
该题当中，$1\leqslant n\leqslant 2*10^5,1\leqslant\max t_i\leqslant m\leqslant2*10^7$。</div>
<h2>题目描述</h2>
<div>The only difference between easy and hard versions is constraints.
If you write a solution in Python, then prefer to send it in PyPy to speed up execution time.
A session has begun at Beland State University. Many students are taking exams.
Polygraph Poligrafovich is going to examine a group of $ n $ students. Students will take the exam one-by-one in order from $ 1 $ -th to $ n $ -th. Rules of the exam are following:
- The $ i $ -th student randomly chooses a ticket.
- if this ticket is too hard to the student, he doesn't answer and goes home immediately (this process is so fast that it's considered no time elapses). This student fails the exam.
- if the student finds the ticket easy, he spends exactly $ t_i $ minutes to pass the exam. After it, he immediately gets a mark and goes home.
Students take the exam in the fixed order, one-by-one, without any interruption. At any moment of time, Polygraph Poligrafovich takes the answer from one student.
The duration of the whole exam for all students is $ M $ minutes ( $ \max t_i \le M $ ), so students at the end of the list have a greater possibility to run out of time to pass the exam.
For each student $ i $ , you should count the minimum possible number of students who need to fail the exam so the $ i $ -th student has enough time to pass the exam.
For each student $ i $ , find the answer independently. That is, if when finding the answer for the student $ i_1 $ some student $ j $ should leave, then while finding the answer for $ i_2 $ ( $ i_2>i_1 $ ) the student $ j $ student does not have to go home.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line of the input contains two integers $ n $ and $ M $ ( $ 1 \le n \le 2 \cdot 10^5 $ , $ 1 \le M \le 2 \cdot 10^7 $ ) — the number of students and the total duration of the exam in minutes, respectively.
The second line of the input contains $ n $ integers $ t_i $ ( $ 1 \le t_i \le 100 $ ) — time in minutes that $ i $ -th student spends to answer to a ticket.
It's guaranteed that all values of $ t_i $ are not greater than $ M $ .</div>
<h3>输出格式</h3>
<br />
<div>Print $ n $ numbers: the $ i $ -th number must be equal to the minimum number of students who have to leave the exam in order to $ i $ -th student has enough time to pass the exam.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>
7 15
1 2 3 4 5 6 7
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>
0 0 0 0 0 2 3 </code></pre>
<h3>输入样例 #2</h3>
<pre><code>
5 100
80 40 40 40 60
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>
0 1 1 2 3 </code></pre>
<h2>说明</h2>
<div>The explanation for the example 1.
Please note that the sum of the first five exam times does not exceed $ M=15 $ (the sum is $ 1+2+3+4+5=15 $ ). Thus, the first five students can pass the exam even if all the students before them also pass the exam. In other words, the first five numbers in the answer are $ 0 $ .
In order for the $ 6 $ -th student to pass the exam, it is necessary that at least $ 2 $ students must fail it before (for example, the $ 3 $ -rd and $ 4 $ -th, then the $ 6 $ -th will finish its exam in $ 1+2+5+6=14 $ minutes, which does not exceed $ M $ ).
In order for the $ 7 $ -th student to pass the exam, it is necessary that at least $ 3 $ students must fail it before (for example, the $ 2 $ -nd, $ 5 $ -th and $ 6 $ -th, then the $ 7 $ -th will finish its exam in $ 1+3+4+7=15 $ minutes, which does not exceed $ M $ ).</div>
</article>
</div>
</div>
</body>
</html>
