<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Putting Boxes Together - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573400650:+lZAuKIxXizH4Iil6UbZq+6dfkzuUm1yCWwXASfP8Z4=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22There%20is%20an%20infinite%20line%20consisting%20of%20cells.%20There%20are%20%24%20n%20%24%20boxes%20in%20some%20cells%20of%20this%20line.%20The%20%24%20i%20%24%20-th%20box%20stands%20in%20the%20cell%20%24%20a_i%20%24%20and%20has%20weight%20%24%20w_i%20%24%20.%20All%20%24%20a_i%20%24%20are%20distinct%2C%20moreover%2C%20%24%20a_%7Bi%20-%201%7D%20%3C%20a_i%20%24%20holds%20for%20all%20valid%20%24%20i%20%24%20.%5Cn%5CnYou%20would%20like%20to%20put%20together%20some%20boxes.%20Putting%20together%20boxes%20with%20indices%20in%20the%20segment%20%24%20%5Bl%2C%20r%5D%20%24%20means%20that%20you%20will%20move%20some%20of%20them%20in%20such%20a%20way%20that%20their%20positions%20will%20form%20some%20segment%20%24%20%5Bx%2C%20x%20%2B%20%28r%20-%20l%29%5D%20%24%20.%5Cn%5CnIn%20one%20step%20you%20can%20move%20any%20box%20to%20a%20neighboring%20cell%20if%20it%20isn%27t%20occupied%20by%20another%20box%20%28i.e.%20you%20can%20choose%20%24%20i%20%24%20and%20change%20%24%20a_i%20%24%20by%20%24%201%20%24%20%2C%20all%20positions%20should%20remain%20distinct%29.%20You%20spend%20%24%20w_i%20%24%20units%20of%20energy%20moving%20the%20box%20%24%20i%20%24%20by%20one%20cell.%20You%20can%20move%20any%20box%20any%20number%20of%20times%2C%20in%20arbitrary%20order.%5Cn%5CnSometimes%20weights%20of%20some%20boxes%20change%2C%20so%20you%20have%20queries%20of%20two%20types%3A%5Cn%5Cn1.%20%24%20id%20%24%20%24%20nw%20%24%20%5Cu2014%20weight%20%24%20w_%7Bid%7D%20%24%20of%20the%20box%20%24%20id%20%24%20becomes%20%24%20nw%20%24%20.%5Cn2.%20%24%20l%20%24%20%24%20r%20%24%20%5Cu2014%20you%20should%20compute%20the%20minimum%20total%20energy%20needed%20to%20put%20together%20boxes%20with%20indices%20in%20%24%20%5Bl%2C%20r%5D%20%24%20.%20Since%20the%20answer%20can%20be%20rather%20big%2C%20print%20the%20remainder%20it%20gives%20when%20divided%20by%20%24%201000%5C%5C%2C000%5C%5C%2C007%20%3D%2010%5E9%20%2B%207%20%24%20.%20Note%20that%20the%20boxes%20are%20not%20moved%20during%20the%20query%2C%20you%20only%20should%20compute%20the%20answer.%5Cn%5CnNote%20that%20you%20should%20minimize%20the%20answer%2C%20not%20its%20remainder%20modulo%20%24%2010%5E9%20%2B%207%20%24%20.%20So%20if%20you%20have%20two%20possible%20answers%20%24%202%20%5C%5Ccdot%2010%5E9%20%2B%2013%20%24%20and%20%24%202%20%5C%5Ccdot%2010%5E9%20%2B%2014%20%24%20%2C%20you%20should%20choose%20the%20first%20one%20and%20print%20%24%2010%5E9%20%2B%206%20%24%20%2C%20even%20though%20the%20remainder%20of%20the%20second%20answer%20is%20%24%200%20%24%20.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20two%20integers%20%24%20n%20%24%20and%20%24%20q%20%24%20%28%20%24%201%20%5C%5Cle%20n%2C%20q%20%5C%5Cle%202%20%5C%5Ccdot%2010%5E5%20%24%20%29%20%5Cu2014%20the%20number%20of%20boxes%20and%20the%20number%20of%20queries.%5Cn%5CnThe%20second%20line%20contains%20%24%20n%20%24%20integers%20%24%20a_1%2C%20a_2%2C%20%5C%5Cdots%20a_n%20%24%20%28%20%24%201%20%5C%5Cle%20a_i%20%5C%5Cle%2010%5E9%20%24%20%29%20%5Cu2014%20the%20positions%20of%20the%20boxes.%20All%20%24%20a_i%20%24%20are%20distinct%2C%20%24%20a_%7Bi%20-%201%7D%20%3C%20a_i%20%24%20holds%20for%20all%20valid%20%24%20i%20%24%20.%5Cn%5CnThe%20third%20line%20contains%20%24%20n%20%24%20integers%20%24%20w_1%2C%20w_2%2C%20%5C%5Cdots%20w_n%20%24%20%28%20%24%201%20%5C%5Cle%20w_i%20%5C%5Cle%2010%5E9%20%24%20%29%20%5Cu2014%20the%20initial%20weights%20of%20the%20boxes.%5Cn%5CnNext%20%24%20q%20%24%20lines%20describe%20queries%2C%20one%20query%20per%20line.%5Cn%5CnEach%20query%20is%20described%20in%20a%20single%20line%2C%20containing%20two%20integers%20%24%20x%20%24%20and%20%24%20y%20%24%20.%20If%20%24%20x%20%3C%200%20%24%20%2C%20then%20this%20query%20is%20of%20the%20first%20type%2C%20where%20%24%20id%20%3D%20-x%20%24%20%2C%20%24%20nw%20%3D%20y%20%24%20%28%20%24%201%20%5C%5Cle%20id%20%5C%5Cle%20n%20%24%20%2C%20%24%201%20%5C%5Cle%20nw%20%5C%5Cle%2010%5E9%20%24%20%29.%20If%20%24%20x%20%3E%200%20%24%20%2C%20then%20the%20query%20is%20of%20the%20second%20type%2C%20where%20%24%20l%20%3D%20x%20%24%20and%20%24%20r%20%3D%20y%20%24%20%28%20%24%201%20%5C%5Cle%20l_j%20%5C%5Cle%20r_j%20%5C%5Cle%20n%20%24%20%29.%20%24%20x%20%24%20can%20not%20be%20equal%20to%20%24%200%20%24%20.%22%2C%22outputFormat%22%3A%22For%20each%20query%20of%20the%20second%20type%20print%20the%20answer%20on%20a%20separate%20line.%20Since%20answer%20can%20be%20large%2C%20print%20the%20remainder%20it%20gives%20when%20divided%20by%20%24%201000%5C%5C%2C000%5C%5C%2C007%20%3D%2010%5E9%20%2B%207%20%24%20.%22%2C%22samples%22%3A%5B%5B%225%208%5Cn1%202%206%207%2010%5Cn1%201%201%201%202%5Cn1%201%5Cn1%205%5Cn1%203%5Cn3%205%5Cn-3%205%5Cn-1%2010%5Cn1%204%5Cn2%205%5Cn%22%2C%220%5Cn10%5Cn3%5Cn4%5Cn18%5Cn7%5Cn%22%5D%5D%2C%22hint%22%3A%22Let%27s%20go%20through%20queries%20of%20the%20example%3A%5Cn%5Cn1.%20%24%201%5C%5C%201%20%24%20%5Cu2014%20there%20is%20only%20one%20box%20so%20we%20don%27t%20need%20to%20move%20anything.%5Cn2.%20%24%201%5C%5C%205%20%24%20%5Cu2014%20we%20can%20move%20boxes%20to%20segment%20%24%20%5B4%2C%208%5D%20%24%20%3A%20%24%201%20%5C%5Ccdot%20%7C1%20-%204%7C%20%2B%201%20%5C%5Ccdot%20%7C2%20-%205%7C%20%2B%201%20%5C%5Ccdot%20%7C6%20-%206%7C%20%2B%201%20%5C%5Ccdot%20%7C7%20-%207%7C%20%2B%202%20%5C%5Ccdot%20%7C10%20-%208%7C%20%3D%2010%20%24%20.%5Cn3.%20%24%201%5C%5C%203%20%24%20%5Cu2014%20we%20can%20move%20boxes%20to%20segment%20%24%20%5B1%2C%203%5D%20%24%20.%5Cn4.%20%24%203%5C%5C%205%20%24%20%5Cu2014%20we%20can%20move%20boxes%20to%20segment%20%24%20%5B7%2C%209%5D%20%24%20.%5Cn5.%20%24%20-3%5C%5C%205%20%24%20%5Cu2014%20%24%20w_3%20%24%20is%20changed%20from%20%24%201%20%24%20to%20%24%205%20%24%20.%5Cn6.%20%24%20-1%5C%5C%2010%20%24%20%5Cu2014%20%24%20w_1%20%24%20is%20changed%20from%20%24%201%20%24%20to%20%24%2010%20%24%20.%20The%20weights%20are%20now%20equal%20to%20%24%20w%20%3D%20%5B10%2C%201%2C%205%2C%201%2C%202%5D%20%24%20.%5Cn7.%20%24%201%5C%5C%204%20%24%20%5Cu2014%20we%20can%20move%20boxes%20to%20segment%20%24%20%5B1%2C%204%5D%20%24%20.%5Cn8.%20%24%202%5C%5C%205%20%24%20%5Cu2014%20we%20can%20move%20boxes%20to%20segment%20%24%20%5B5%2C%208%5D%20%24%20.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2500%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F1030%5C%2FF%22%2C%22id%22%3A%221030F%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A60%2C%22totalAccepted%22%3A21%2C%22pid%22%3A%22CF1030F%22%2C%22title%22%3A%22Putting%20Boxes%20Together%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P4097%22%2C%22title%22%3A%22%5BHEOI2013%5DSegment%20%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22CF501D%22%2C%22title%22%3A%22Misha%20and%20Permutations%20Summation%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF940F%22%2C%22title%22%3A%22Machine%20Learning%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1051F%22%2C%22title%22%3A%22The%20Shortest%20Statement%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1034A%22%2C%22title%22%3A%22Enlarge%20GCD%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22CF%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Putting%20Boxes%20Together%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Putting Boxes Together</h1>
<h2>题目描述</h2>
<div>There is an infinite line consisting of cells. There are $ n $ boxes in some cells of this line. The $ i $ -th box stands in the cell $ a_i $ and has weight $ w_i $ . All $ a_i $ are distinct, moreover, $ a_{i - 1} < a_i $ holds for all valid $ i $ .
You would like to put together some boxes. Putting together boxes with indices in the segment $ [l, r] $ means that you will move some of them in such a way that their positions will form some segment $ [x, x + (r - l)] $ .
In one step you can move any box to a neighboring cell if it isn't occupied by another box (i.e. you can choose $ i $ and change $ a_i $ by $ 1 $ , all positions should remain distinct). You spend $ w_i $ units of energy moving the box $ i $ by one cell. You can move any box any number of times, in arbitrary order.
Sometimes weights of some boxes change, so you have queries of two types:
1. $ id $ $ nw $ — weight $ w_{id} $ of the box $ id $ becomes $ nw $ .
2. $ l $ $ r $ — you should compute the minimum total energy needed to put together boxes with indices in $ [l, r] $ . Since the answer can be rather big, print the remainder it gives when divided by $ 1000\,000\,007 = 10^9 + 7 $ . Note that the boxes are not moved during the query, you only should compute the answer.
Note that you should minimize the answer, not its remainder modulo $ 10^9 + 7 $ . So if you have two possible answers $ 2 \cdot 10^9 + 13 $ and $ 2 \cdot 10^9 + 14 $ , you should choose the first one and print $ 10^9 + 6 $ , even though the remainder of the second answer is $ 0 $ .</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains two integers $ n $ and $ q $ ( $ 1 \le n, q \le 2 \cdot 10^5 $ ) — the number of boxes and the number of queries.
The second line contains $ n $ integers $ a_1, a_2, \dots a_n $ ( $ 1 \le a_i \le 10^9 $ ) — the positions of the boxes. All $ a_i $ are distinct, $ a_{i - 1} < a_i $ holds for all valid $ i $ .
The third line contains $ n $ integers $ w_1, w_2, \dots w_n $ ( $ 1 \le w_i \le 10^9 $ ) — the initial weights of the boxes.
Next $ q $ lines describe queries, one query per line.
Each query is described in a single line, containing two integers $ x $ and $ y $ . If $ x < 0 $ , then this query is of the first type, where $ id = -x $ , $ nw = y $ ( $ 1 \le id \le n $ , $ 1 \le nw \le 10^9 $ ). If $ x > 0 $ , then the query is of the second type, where $ l = x $ and $ r = y $ ( $ 1 \le l_j \le r_j \le n $ ). $ x $ can not be equal to $ 0 $ .</div>
<h3>输出格式</h3>
<br />
<div>For each query of the second type print the answer on a separate line. Since answer can be large, print the remainder it gives when divided by $ 1000\,000\,007 = 10^9 + 7 $ .</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>5 8
1 2 6 7 10
1 1 1 1 2
1 1
1 5
1 3
3 5
-3 5
-1 10
1 4
2 5
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>0
10
3
4
18
7
</code></pre>
<h2>说明</h2>
<div>Let's go through queries of the example:
1. $ 1\ 1 $ — there is only one box so we don't need to move anything.
2. $ 1\ 5 $ — we can move boxes to segment $ [4, 8] $ : $ 1 \cdot |1 - 4| + 1 \cdot |2 - 5| + 1 \cdot |6 - 6| + 1 \cdot |7 - 7| + 2 \cdot |10 - 8| = 10 $ .
3. $ 1\ 3 $ — we can move boxes to segment $ [1, 3] $ .
4. $ 3\ 5 $ — we can move boxes to segment $ [7, 9] $ .
5. $ -3\ 5 $ — $ w_3 $ is changed from $ 1 $ to $ 5 $ .
6. $ -1\ 10 $ — $ w_1 $ is changed from $ 1 $ to $ 10 $ . The weights are now equal to $ w = [10, 1, 5, 1, 2] $ .
7. $ 1\ 4 $ — we can move boxes to segment $ [1, 4] $ .
8. $ 2\ 5 $ — we can move boxes to segment $ [5, 8] $ .</div>
</article>
</div>
</div>
</body>
</html>
