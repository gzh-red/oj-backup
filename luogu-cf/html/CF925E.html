<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>May Holidays - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573399489:3nIqJiWo7dbWoPdK5zDd2Nt9b+BQpiZZreRb182ZiJc=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22It%27s%20May%20in%20Flatland%2C%20and%20there%20are%20%24%20m%20%24%20days%20in%20this%20month.%20Despite%20the%20fact%20that%20May%20Holidays%20are%20canceled%20long%20time%20ago%2C%20employees%20of%20some%20software%20company%20still%20have%20a%20habit%20of%20taking%20short%20or%20long%20vacations%20in%20May.%5Cn%5CnOf%20course%2C%20not%20all%20managers%20of%20the%20company%20like%20this.%20There%20are%20%24%20n%20%24%20employees%20in%20the%20company%20that%20form%20a%20tree-like%20structure%20of%20subordination%3A%20each%20employee%20has%20a%20unique%20integer%20id%20%24%20i%20%24%20between%20%24%201%20%24%20and%20%24%20n%20%24%20%2C%20and%20each%20employee%20with%20id%20%24%20i%20%24%20%28except%20the%20head%20manager%20whose%20id%20is%201%29%20has%20exactly%20one%20direct%20manager%20with%20id%20%24%20p_i%20%24%20.%20The%20structure%20of%20subordination%20is%20not%20cyclic%2C%20i.e.%20if%20we%20start%20moving%20from%20any%20employee%20to%20his%20direct%20manager%2C%20then%20we%20will%20eventually%20reach%20the%20head%20manager.%20We%20define%20that%20an%20employee%20%24%20u%20%24%20is%20a%20subordinate%20of%20an%20employee%20%24%20v%20%24%20%2C%20if%20%24%20v%20%24%20is%20a%20direct%20manager%20of%20%24%20u%20%24%20%2C%20or%20the%20direct%20manager%20of%20%24%20u%20%24%20is%20a%20subordinate%20of%20%24%20v%20%24%20.%20Let%20%24%20s_i%20%24%20be%20the%20number%20of%20subordinates%20the%20%24%20i%20%24%20-th%20employee%20has%20%28for%20example%2C%20%24%20s_1%20%3D%20n%20-%201%20%24%20%2C%20because%20all%20employees%20except%20himself%20are%20subordinates%20of%20the%20head%20manager%29.%5Cn%5CnEach%20employee%20%24%20i%20%24%20has%20a%20bearing%20limit%20of%20%24%20t_i%20%24%20%2C%20which%20is%20an%20integer%20between%20%24%200%20%24%20and%20%24%20s_i%20%24%20.%20It%20denotes%20the%20maximum%20number%20of%20the%20subordinates%20of%20the%20%24%20i%20%24%20-th%20employee%20being%20on%20vacation%20at%20the%20same%20moment%20that%20he%20can%20bear.%20If%20at%20some%20moment%20strictly%20more%20than%20%24%20t_i%20%24%20subordinates%20of%20the%20%24%20i%20%24%20-th%20employee%20are%20on%20vacation%2C%20and%20the%20%24%20i%20%24%20-th%20employee%20himself%20is%20not%20on%20a%20vacation%2C%20he%20becomes%20displeased.%5Cn%5CnIn%20each%20of%20the%20%24%20m%20%24%20days%20of%20May%20exactly%20one%20event%20of%20the%20following%20two%20types%20happens%3A%20either%20one%20employee%20leaves%20on%20a%20vacation%20at%20the%20beginning%20of%20the%20day%2C%20or%20one%20employee%20returns%20from%20a%20vacation%20in%20the%20beginning%20of%20the%20day.%20You%20know%20the%20sequence%20of%20events%20in%20the%20following%20%24%20m%20%24%20days.%20Your%20task%20is%20to%20compute%20for%20each%20of%20the%20%24%20m%20%24%20days%20the%20number%20of%20displeased%20employees%20on%20that%20day.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20two%20integers%20%24%20n%20%24%20and%20%24%20m%20%24%20%28%20%24%202%20%5C%5Cleq%20n%2C%20m%20%5C%5Cleq%2010%5E5%20%24%20%29%20%5Cu2014%20the%20number%20of%20employees%20in%20the%20company%20and%20the%20number%20of%20days%20in%20May.%5Cn%5CnThe%20second%20line%20contains%20%24%20n%20-%201%20%24%20integers%20%24%20p_2%2C%20p_3%2C%20%5C%5Cldots%2C%20p_n%20%24%20%28%20%24%201%20%5C%5Cleq%20p_i%20%5C%5Cleq%20n%20%24%20%29%2C%20denoting%20the%20direct%20managers%20of%20employees.%5Cn%5CnThe%20third%20line%20contains%20%24%20n%20%24%20integers%20%24%20t_1%2C%20t_2%2C%20%5C%5Cldots%2C%20t_n%20%24%20%28%20%24%200%20%5C%5Cleq%20t_i%20%5C%5Cleq%20s_i%20%24%20%29%2C%20denoting%20the%20bearing%20limits%20of%20empoyees.%5Cn%5CnThe%20fourth%20line%20contains%20%24%20m%20%24%20integers%20%24%20q_1%2C%20q_2%2C%20%5C%5Cldots%2C%20q_m%20%24%20%28%20%24%201%20%5C%5Cleq%20%7Cq_i%7C%20%5C%5Cleq%20n%20%24%20%2C%20%24%20q_i%20%5C%5Cne%200%20%24%20%29%2C%20denoting%20the%20events.%20If%20%24%20q_i%20%24%20is%20positive%2C%20then%20the%20employee%20with%20id%20%24%20q_i%20%24%20leaves%20for%20a%20vacation%20starting%20from%20this%20day%2C%20if%20%24%20q_i%20%24%20is%20negative%2C%20then%20the%20employee%20%24%20-q_i%20%24%20returns%20from%20a%20vacation%20starting%20from%20this%20day.%20In%20the%20beginning%20of%20May%20no%20employee%20is%20on%20vacation.%20It%20is%20guaranteed%20that%20if%20some%20employee%20leaves%20for%20a%20vacation%2C%20he%20is%20not%20on%20a%20vacation%20at%20the%20moment%20and%20vice%20versa.%22%2C%22outputFormat%22%3A%22Print%20a%20sequence%20of%20%24%20m%20%24%20integers%20%24%20a_1%2C%20a_2%2C%20%5C%5Cldots%2C%20a_m%20%24%20%2C%20where%20%24%20a_i%20%24%20is%20the%20number%20of%20displeased%20employees%20on%20the%20%24%20i%20%24%20-th%20day.%22%2C%22samples%22%3A%5B%5B%227%208%5Cn4%205%201%201%205%205%5Cn0%200%200%201%202%200%200%5Cn2%206%203%207%20-2%204%20-3%201%5Cn%22%2C%221%201%201%202%202%202%201%200%5Cn%22%5D%2C%5B%225%206%5Cn1%202%203%204%5Cn4%200%200%201%200%5Cn1%205%202%203%20-5%20-1%5Cn%22%2C%220%202%201%200%200%200%5Cn%22%5D%5D%2C%22hint%22%3A%22In%20the%20first%20sample%20test%20after%20employee%20with%20id%202%20leaves%20for%20a%20vacation%20at%20the%20first%20day%2C%20the%20head%20manager%20with%20id%201%20becomes%20displeased%20as%20he%20does%20not%20want%20any%20of%20his%20subordinates%20to%20go%20for%20a%20vacation.%20At%20the%20fourth%20day%20employee%20with%20id%205%20becomes%20displeased%20as%20his%20last%20remaining%20employee%20with%20id%207%20leaves%20for%20a%20vacation.%20At%20the%20fifth%20day%20employee%20with%20id%202%20returns%20from%20the%20vacation%2C%20but%20it%20does%20not%20affect%20the%20number%20of%20displeased%20employees%20as%20the%20employees%205%20and%201%20are%20still%20displeased.%20At%20the%20sixth%20day%20employee%20with%20id%203%20returns%20back%20from%20the%20vacation%2C%20preventing%20the%20employee%20with%20id%205%20from%20being%20displeased%20and%20at%20the%20last%20day%20the%20head%20manager%20with%20id%201%20leaves%20for%20a%20vacation%2C%20leaving%20the%20company%20without%20the%20displeased%20people%20at%20all.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B5000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F925%5C%2FE%22%2C%22id%22%3A%22925E%22%7D%2C%22translation%22%3A%22%5Cu6709%5Cu4e00%5Cu68f5%20%24n%24%20%5Cu4e2a%5Cu70b9%5Cu4ee5%20%241%24%20%5Cu4e3a%5Cu6839%5Cu7684%5Cu6811%5Cuff0c%5Cu521d%5Cu59cb%5Cu6240%5Cu6709%5Cu70b9%5Cu90fd%5Cu662f%5Cu767d%5Cu70b9%5Cu3002%5Cu63a5%5Cu4e0b%5Cu6765%5Cu6709%20%24m%24%20%5Cu6b21%5Cu64cd%5Cu4f5c%5Cuff0c%5Cu6bcf%5Cu6b21%5Cu64cd%5Cu4f5c%5Cu7ed9%5Cu5b9a%5Cu4e00%5Cu4e2a%5Cu6570%20%24k%24%5Cuff0c%5Cu82e5%20%24k%3E0%24%5Cuff0c%5Cu5219%5Cu5c06%5Cu7b2c%20%24k%24%20%5Cu4e2a%5Cu70b9%5Cu4ece%5Cu767d%5Cu70b9%5Cu53d8%5Cu6210%5Cu9ed1%5Cu70b9%5Cuff1b%5Cu82e5%20%24k%3C0%24%5Cuff0c%5Cu5219%5Cu5c06%5Cu7b2c%20%24k%24%20%5Cu4e2a%5Cu70b9%5Cu4ece%5Cu9ed1%5Cu70b9%5Cu53d8%5Cu6210%5Cu767d%5Cu70b9%5Cu3002%5Cu540c%5Cu65f6%5Cu6bcf%5Cu4e2a%5Cu70b9%5Cu7ed9%5Cu5b9a%5Cu4e00%5Cu4e2a%5Cu503c%20%24t_i%24%5Cuff0c%2A%2A%5Cu82e5%5Cu4e00%5Cu4e2a%5Cu767d%5Cu70b9%5Cu5b50%5Cu6811%5Cu5185%5Cu9ed1%5Cu70b9%5Cu4e2a%5Cu6570%5Cu5927%5Cu4e8e%20%24t_i%24%2A%2A%5Cuff0c%5Cu5219%5Cu79f0%5Cu8be5%5Cu767d%5Cu70b9%5Cu4e3a%5Cu5173%5Cu952e%5Cu70b9%5Cu3002%5Cu6c42%5Cu6bcf%5Cu6b21%5Cu64cd%5Cu4f5c%5Cu540e%5Cu5173%5Cu952e%5Cu70b9%5Cu7684%5Cu4e2a%5Cu6570%5Cu3002%5Cu4fdd%5Cu8bc1%5Cu64cd%5Cu4f5c%5Cu5408%5Cu6cd5%5Cu3002%5Cr%5Cn%5Cr%5Cn%24n%2Cm%5C%5Cle%2010%5E5%24%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A12%2C%22totalAccepted%22%3A7%2C%22pid%22%3A%22CF925E%22%2C%22title%22%3A%22May%20Holidays%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22May%20Holidays%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>May Holidays</h1>
<h2>题意翻译</h2>
<div>有一棵 $n$ 个点以 $1$ 为根的树，初始所有点都是白点。接下来有 $m$ 次操作，每次操作给定一个数 $k$，若 $k>0$，则将第 $k$ 个点从白点变成黑点；若 $k<0$，则将第 $k$ 个点从黑点变成白点。同时每个点给定一个值 $t_i$，**若一个白点子树内黑点个数大于 $t_i$**，则称该白点为关键点。求每次操作后关键点的个数。保证操作合法。
$n,m\le 10^5$</div>
<h2>题目描述</h2>
<div>It's May in Flatland, and there are $ m $ days in this month. Despite the fact that May Holidays are canceled long time ago, employees of some software company still have a habit of taking short or long vacations in May.
Of course, not all managers of the company like this. There are $ n $ employees in the company that form a tree-like structure of subordination: each employee has a unique integer id $ i $ between $ 1 $ and $ n $ , and each employee with id $ i $ (except the head manager whose id is 1) has exactly one direct manager with id $ p_i $ . The structure of subordination is not cyclic, i.e. if we start moving from any employee to his direct manager, then we will eventually reach the head manager. We define that an employee $ u $ is a subordinate of an employee $ v $ , if $ v $ is a direct manager of $ u $ , or the direct manager of $ u $ is a subordinate of $ v $ . Let $ s_i $ be the number of subordinates the $ i $ -th employee has (for example, $ s_1 = n - 1 $ , because all employees except himself are subordinates of the head manager).
Each employee $ i $ has a bearing limit of $ t_i $ , which is an integer between $ 0 $ and $ s_i $ . It denotes the maximum number of the subordinates of the $ i $ -th employee being on vacation at the same moment that he can bear. If at some moment strictly more than $ t_i $ subordinates of the $ i $ -th employee are on vacation, and the $ i $ -th employee himself is not on a vacation, he becomes displeased.
In each of the $ m $ days of May exactly one event of the following two types happens: either one employee leaves on a vacation at the beginning of the day, or one employee returns from a vacation in the beginning of the day. You know the sequence of events in the following $ m $ days. Your task is to compute for each of the $ m $ days the number of displeased employees on that day.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains two integers $ n $ and $ m $ ( $ 2 \leq n, m \leq 10^5 $ ) — the number of employees in the company and the number of days in May.
The second line contains $ n - 1 $ integers $ p_2, p_3, \ldots, p_n $ ( $ 1 \leq p_i \leq n $ ), denoting the direct managers of employees.
The third line contains $ n $ integers $ t_1, t_2, \ldots, t_n $ ( $ 0 \leq t_i \leq s_i $ ), denoting the bearing limits of empoyees.
The fourth line contains $ m $ integers $ q_1, q_2, \ldots, q_m $ ( $ 1 \leq |q_i| \leq n $ , $ q_i \ne 0 $ ), denoting the events. If $ q_i $ is positive, then the employee with id $ q_i $ leaves for a vacation starting from this day, if $ q_i $ is negative, then the employee $ -q_i $ returns from a vacation starting from this day. In the beginning of May no employee is on vacation. It is guaranteed that if some employee leaves for a vacation, he is not on a vacation at the moment and vice versa.</div>
<h3>输出格式</h3>
<br />
<div>Print a sequence of $ m $ integers $ a_1, a_2, \ldots, a_m $ , where $ a_i $ is the number of displeased employees on the $ i $ -th day.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>7 8
4 5 1 1 5 5
0 0 0 1 2 0 0
2 6 3 7 -2 4 -3 1
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>1 1 1 2 2 2 1 0
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>5 6
1 2 3 4
4 0 0 1 0
1 5 2 3 -5 -1
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>0 2 1 0 0 0
</code></pre>
<h2>说明</h2>
<div>In the first sample test after employee with id 2 leaves for a vacation at the first day, the head manager with id 1 becomes displeased as he does not want any of his subordinates to go for a vacation. At the fourth day employee with id 5 becomes displeased as his last remaining employee with id 7 leaves for a vacation. At the fifth day employee with id 2 returns from the vacation, but it does not affect the number of displeased employees as the employees 5 and 1 are still displeased. At the sixth day employee with id 3 returns back from the vacation, preventing the employee with id 5 from being displeased and at the last day the head manager with id 1 leaves for a vacation, leaving the company without the displeased people at all.</div>
</article>
</div>
</div>
</body>
</html>
