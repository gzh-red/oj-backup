<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Computer Game - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573401199:HERUS8MhUjnk2zNti1czgi3MKw1QngXXHc/aJX1C1MQ=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Ivan%20plays%20some%20computer%20game.%20There%20are%20%24%20n%20%24%20quests%20in%20the%20game.%20Each%20quest%20can%20be%20upgraded%20once%2C%20this%20increases%20the%20reward%20for%20its%20completion.%20Each%20quest%20has%20%24%203%20%24%20parameters%20%24%20a_%7Bi%7D%20%24%20%2C%20%24%20b_%7Bi%7D%20%24%20%2C%20%24%20p_%7Bi%7D%20%24%20%3A%20reward%20for%20completing%20quest%20before%20upgrade%2C%20reward%20for%20completing%20quest%20after%20upgrade%20%28%20%24%20a_%7Bi%7D%20%3C%20b_%7Bi%7D%20%24%20%29%20and%20probability%20of%20successful%20completing%20the%20quest.%5Cn%5CnEach%20second%20Ivan%20can%20try%20to%20complete%20one%20quest%20and%20he%20will%20succeed%20with%20probability%20%24%20p_%7Bi%7D%20%24%20.%20In%20case%20of%20success%20Ivan%20will%20get%20the%20reward%20and%20opportunity%20to%20upgrade%20any%20one%20quest%20%28not%20necessary%20the%20one%20he%20just%20completed%29.%20In%20case%20of%20failure%20he%20gets%20nothing.%20Quests%20do%20not%20vanish%20after%20completing.%5Cn%5CnIvan%20has%20%24%20t%20%24%20seconds.%20He%20wants%20to%20maximize%20expected%20value%20of%20his%20total%20gain%20after%20%24%20t%20%24%20seconds.%20Help%20him%20to%20calculate%20this%20value.%22%2C%22inputFormat%22%3A%22First%20line%20contains%20%24%202%20%24%20integers%20%24%20n%20%24%20%28%20%24%20%201%20%5C%5Cle%20n%20%5C%5Cle%2010%5E%7B5%7D%20%24%20%29%20and%20%24%20t%20%24%20%28%20%24%20%201%20%5C%5Cle%20t%20%5C%5Cle%2010%5E%7B10%7D%20%24%20%29%20%5Cu2014%20number%20of%20quests%20and%20total%20time.%5Cn%5CnFollowing%20%24%20n%20%24%20lines%20contain%20description%20of%20quests.%20Each%20description%20is%20%24%203%20%24%20numbers%20%24%20a_%7Bi%7D%20%24%20%24%20b_%7Bi%7D%20%24%20%24%20p_%7Bi%7D%20%24%20%28%20%24%201%20%5C%5Cle%20a_%7Bi%7D%20%3C%20b_%7Bi%7D%20%5C%5Cle%2010%5E%7B8%7D%20%24%20%2C%20%24%200%20%3C%20p_%7Bi%7D%20%3C%201%20%24%20%29%20%5Cu2014%20reward%20for%20completing%20quest%20before%20upgrade%2C%20reward%20for%20completing%20quest%20after%20upgrade%20and%20probability%20of%20successful%20completing%20of%20quest.%20%24%20a_%7Bi%7D%20%24%20and%20%24%20b_%7Bi%7D%20%24%20are%20integers.%20All%20probabilities%20are%20given%20with%20at%20most%20%24%209%20%24%20decimal%20places.%22%2C%22outputFormat%22%3A%22Print%20the%20expected%20value.%5Cn%5CnYour%20answer%20will%20be%20accepted%20if%20absolute%20or%20relative%20error%20does%20not%20exceed%20%24%2010%5E%7B-6%7D%20%24%20.%20Formally%2C%20let%20your%20answer%20be%20%24%20a%20%24%20%2C%20and%20the%20jury%27s%20answer%20be%20%24%20b%20%24%20.%20Your%20answer%20is%20considered%20correct%20if%20%24%20%5C%5Cfrac%7B%7Ca-b%7C%7D%7Bmax%5Cu2061%28b%2C%20%5C%5C%2C%5C%5C%2C%201%29%7D%20%5C%5Cle%2010%5E%7B-6%7D%20%24%20.%22%2C%22samples%22%3A%5B%5B%223%202%5Cn3%201000%200.5%5Cn1%202%200.48%5Cn3%2020%200.3%5Cn%22%2C%22252.2500000000000%5Cn%22%5D%2C%5B%222%202%5Cn1%201000%200.1%5Cn2%203%200.2%5Cn%22%2C%2220.7200000000000%5Cn%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B3000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F1067%5C%2FD%22%2C%22id%22%3A%221067D%22%7D%2C%22translation%22%3A%22%5Cu6709n%5Cu4e2a%5Cu6e38%5Cu620f%5Cuff0c%5Cu6bcf%5Cu4e2a%5Cu6e38%5Cu620f%5Cu6709%5Cu6536%5Cu76caai%5Cuff0c%5Cu5347%5Cu7ea7%5Cu540e%5Cu7684%5Cu6536%5Cu76cabi%5Cuff0c%5Cu6bcf%5Cu6b21%5Cu6210%5Cu529f%5Cu6982%5Cu7387pi%5Cu3002%5Cu6bcf%5Cu79d2%5Cu53ef%5Cu4ee5%5Cu73a9%5Cu4e00%5Cu4e2a%5Cu6e38%5Cu620f%5Cuff0c%5Cu5982%5Cu679c%5Cu6210%5Cu529f%5Cu5219%5Cu5f97%5Cu5230%5Cu5f53%5Cu524d%5Cu6536%5Cu76ca%5Cuff0c%5Cu5e76%5Cu4e14%5Cu53ef%5Cu4ee5%5Cu5347%5Cu7ea7%5Cu4efb%5Cu610f%5Cu67d0%5Cu4e2a%5Cu6e38%5Cu620f%5Cu3002%5Cu6c42t%5Cu79d2%5Cu540e%5Cu7684%5Cu671f%5Cu671b%5Cu6536%5Cu76ca%5Cu7684%5Cu6700%5Cu5927%5Cu503c%5Cu3002n%5Cu22641e5%5Cuff0ct%5Cu22641e10%5Cuff0ca%3Cb%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A10%2C%22totalAccepted%22%3A7%2C%22pid%22%3A%22CF1067D%22%2C%22title%22%3A%22Computer%20Game%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Computer%20Game%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Computer Game</h1>
<h2>题意翻译</h2>
<div>有n个游戏，每个游戏有收益ai，升级后的收益bi，每次成功概率pi。每秒可以玩一个游戏，如果成功则得到当前收益，并且可以升级任意某个游戏。求t秒后的期望收益的最大值。n≤1e5，t≤1e10，a<b</div>
<h2>题目描述</h2>
<div>Ivan plays some computer game. There are $ n $ quests in the game. Each quest can be upgraded once, this increases the reward for its completion. Each quest has $ 3 $ parameters $ a_{i} $ , $ b_{i} $ , $ p_{i} $ : reward for completing quest before upgrade, reward for completing quest after upgrade ( $ a_{i} < b_{i} $ ) and probability of successful completing the quest.
Each second Ivan can try to complete one quest and he will succeed with probability $ p_{i} $ . In case of success Ivan will get the reward and opportunity to upgrade any one quest (not necessary the one he just completed). In case of failure he gets nothing. Quests do not vanish after completing.
Ivan has $ t $ seconds. He wants to maximize expected value of his total gain after $ t $ seconds. Help him to calculate this value.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>First line contains $ 2 $ integers $ n $ ( $ 1 \le n \le 10^{5} $ ) and $ t $ ( $ 1 \le t \le 10^{10} $ ) — number of quests and total time.
Following $ n $ lines contain description of quests. Each description is $ 3 $ numbers $ a_{i} $ $ b_{i} $ $ p_{i} $ ( $ 1 \le a_{i} < b_{i} \le 10^{8} $ , $ 0 < p_{i} < 1 $ ) — reward for completing quest before upgrade, reward for completing quest after upgrade and probability of successful completing of quest. $ a_{i} $ and $ b_{i} $ are integers. All probabilities are given with at most $ 9 $ decimal places.</div>
<h3>输出格式</h3>
<br />
<div>Print the expected value.
Your answer will be accepted if absolute or relative error does not exceed $ 10^{-6} $ . Formally, let your answer be $ a $ , and the jury's answer be $ b $ . Your answer is considered correct if $ \frac{|a-b|}{max⁡(b, \,\, 1)} \le 10^{-6} $ .</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>3 2
3 1000 0.5
1 2 0.48
3 20 0.3
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>252.2500000000000
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>2 2
1 1000 0.1
2 3 0.2
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>20.7200000000000
</code></pre>
</article>
</div>
</div>
</body>
</html>
