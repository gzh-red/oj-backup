<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Calendar - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573390412:X/Ej6bbFL5fmsyS62TKZWwFKyI56P3ODYFAw+9Xygx8=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%22%2C%22description%22%3A%22BerOilGasDiamondBank%20has%20branches%20in%20%24%20n%20%24%20cities%2C%20at%20that%20%24%20n%20%24%20is%20an%20even%20number.%20The%20bank%20management%20wants%20to%20publish%20a%20calendar%20with%20the%20names%20of%20all%20those%20cities%20written%20in%20two%20columns%3A%20the%20calendar%20should%20consist%20of%20exactly%20%24%20n%5C%2F2%20%24%20lines%20of%20strictly%20equal%20length%2C%20each%20of%20which%20contains%20exactly%20two%20names%20and%20exactly%20one%20separator%20character%20between%20them.%20The%20name%20of%20every%20city%20should%20be%20used%20in%20the%20calendar%20exactly%20once.%20For%20historical%20reasons%20the%20symbol%20%24%20d%20%24%20is%20used%20as%20the%20separator%20of%20words%20in%20the%20calendar.%5Cn%5CnThe%20BerOilGasDiamondBank%20management%20wants%20to%20show%20that%20all%20its%20branches%20are%20equally%20important%20to%20it%2C%20that%27s%20why%20the%20order%20of%20their%20appearance%20in%20the%20calendar%20should%20be%20following%3A%20if%20we%20%5C%22glue%5C%22%28concatinate%29%20all%20the%20%24%20n%5C%2F2%20%24%20calendar%20lines%20%28from%20top%20to%20bottom%29%20to%20make%20a%20single%20line%2C%20then%20the%20lexicographically%20minimal%20line%20is%20obtained.%20No%20separator%20character%20will%20be%20used%20to%20separate%20calendar%20lines.%20For%20example%2C%20if%20the%20lines%20are%20%5C%22bertown%21berville%5C%22%2C%20%5C%22newberville%21bera%5C%22%2C%20then%20the%20resulting%20line%20is%20%5C%22bertown%21bervillenewberville%21bera%5C%22.%20In%20some%20sense%20one%20has%20to%20find%20the%20lexicographically%20minimal%20calendar%2C%20where%20the%20comparison%20of%20calendars%20happens%20line%20by%20line.%5Cn%5CnHelp%20BerOilGasDiamondBank%20and%20construct%20the%20required%20calendar.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20an%20integer%20%24%20n%20%24%20%28%20%24%201%3C%3Dn%3C%3D10%5E%7B4%7D%20%24%20%2C%20%24%20n%20%24%20is%20even%29%20which%20is%20the%20number%20of%20branches.%20Then%20follow%20%24%20n%20%24%20lines%20which%20are%20the%20names%20of%20the%20cities.%20All%20the%20names%20consist%20of%20lowercase%20Latin%20letters%3B%20their%20lengths%20are%20no%20less%20than%201%20and%20no%20more%20than%2010%20symbols.%20The%20next%20line%20contains%20a%20single%20symbol%20%24%20d%20%24%20%28%20%24%20d%20%24%20has%20an%20ASCII-code%20from%2033%20to%20126%20inclusively%2C%20excluding%20lowercase%20Latin%20letters%29%20which%20is%20the%20separator%20between%20words%20in%20the%20calendar%20lines.%20It%20is%20guaranteed%20that%20the%20calendar%20is%20possible%20to%20be%20constructed%20and%20all%20the%20names%20are%20different.%22%2C%22outputFormat%22%3A%22Print%20%24%20n%5C%2F2%20%24%20lines%20of%20similar%20length%20which%20are%20the%20required%20calendar.%20Every%20line%20should%20contain%20exactly%20two%20words%20and%20exactly%20one%20separator%20between%20them.%20If%20there%20are%20several%20solutions%2C%20print%20the%20lexicographically%20minimal%20one.%20The%20lexicographical%20comparison%20of%20lines%20is%20realized%20by%20the%20%5C%22%3C%5C%22%20operator%20in%20the%20modern%20programming%20languages.%22%2C%22samples%22%3A%5B%5B%224%5Cnb%5Cnaa%5Cnhg%5Cnc%5Cn.%5Cn%22%2C%22aa.b%5Cnc.hg%5Cn%22%5D%2C%5B%222%5Cnaa%5Cna%5Cn%21%5Cn%22%2C%22a%21aa%5Cn%22%5D%2C%5B%222%5Cnaa%5Cna%5Cn%7C%5Cn%22%2C%22aa%7Ca%5Cn%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F58%5C%2FD%22%2C%22id%22%3A%2258D%22%7D%2C%22translation%22%3A%22%5Cu7ed9%5Cu5b9a%5Cu4e00%5Cu4e2a%5Cu5076%5Cu6570%24n%24%20%5Cuff0c%24n%24%20%5Cu4e2a%5Cu5b57%5Cu7b26%5Cu4e32%5Cuff0c%5Cu548c%5Cu4e00%5Cu4e2a%5Cu5206%5Cu5272%5Cu5b57%5Cu7b26%24d%24%20%5Cu3002%24d%24%20%5Cu7684ASCII%5Cu503c%5Cu53ef%5Cu80fd%5Cu4ece32%5Cu5230126%5Cu3002%5Cn%5Cn%5Cu4f60%5Cu8981%5Cu5c06%5Cu6240%5Cu6709%24n%24%20%5Cu4e2a%5Cu5b57%5Cu7b26%5Cu4e32%5Cu653e%5Cu5728%24%5C%5Cfrac%20n2%24%20%5Cu884c%5Cuff0c%5Cu6bcf%5Cu884c%5Cu4e24%5Cu4e2a%5Cu5b57%5Cu7b26%5Cu4e32%5Cuff0c%5Cu4e4b%5Cu95f4%5Cu7528%5Cu6070%5Cu597d%5Cu4e00%5Cu4e2a%5Cu5206%5Cu5272%5Cu5b57%5Cu7b26%24d%24%20%5Cu9694%5Cu5f00%5Cu3002%5Cu8fd9%24%5C%5Cfrac%20n2%24%20%5Cu884c%5Cu7684%5Cu957f%5Cu5ea6%5Cu5fc5%5Cu987b%5Cu4e25%5Cu683c%5Cu76f8%5Cu7b49%5Cu3002%5Cn%5Cn%5Cu6c42%5Cu6240%5Cu6709%5Cu5408%5Cu6cd5%5Cu65b9%5Cu6848%5Cu4e2d%5Cuff0c%5Cu5b57%5Cu5178%5Cu5e8f%5Cu6700%5Cu5c0f%5Cu7684%5Cu4e00%5Cu4e2a%5Cu3002%5Cu5b57%5Cu5178%5Cu5e8f%5Cu662f%5Cu6307%5Cu5c06%5Cu6bcf%5Cu884c%5Cu4f9d%5Cu6b21%5Cu62fc%5Cu63a5%5Cu5f97%5Cu5230%5Cu7684%5Cu5b57%5Cu7b26%5Cu4e32%5Cu7684%5Cu5b57%5Cu5178%5Cu5e8f%5Cu3002%5Cn%5CnTranslated%20by%20%40_rqy%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A5%2C%22totalAccepted%22%3A2%2C%22pid%22%3A%22CF58D%22%2C%22title%22%3A%22Calendar%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A32605%2C%22title%22%3A%22%5Cu9898%5Cu610f%5Cu7b80%5Cu8ff0%22%2C%22forum%22%3A%7B%22id%22%3A12407%2C%22name%22%3A%22CF58D%20Calendar%22%2C%22slug%22%3A%22CF58D%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Calendar%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Calendar</h1>
<h2>题意翻译</h2>
<div>给定一个偶数$n$ ，$n$ 个字符串，和一个分割字符$d$ 。$d$ 的ASCII值可能从32到126。
你要将所有$n$ 个字符串放在$\frac n2$ 行，每行两个字符串，之间用恰好一个分割字符$d$ 隔开。这$\frac n2$ 行的长度必须严格相等。
求所有合法方案中，字典序最小的一个。字典序是指将每行依次拼接得到的字符串的字典序。
Translated by @_rqy</div>
<h2>题目描述</h2>
<div>BerOilGasDiamondBank has branches in $ n $ cities, at that $ n $ is an even number. The bank management wants to publish a calendar with the names of all those cities written in two columns: the calendar should consist of exactly $ n/2 $ lines of strictly equal length, each of which contains exactly two names and exactly one separator character between them. The name of every city should be used in the calendar exactly once. For historical reasons the symbol $ d $ is used as the separator of words in the calendar.
The BerOilGasDiamondBank management wants to show that all its branches are equally important to it, that's why the order of their appearance in the calendar should be following: if we "glue"(concatinate) all the $ n/2 $ calendar lines (from top to bottom) to make a single line, then the lexicographically minimal line is obtained. No separator character will be used to separate calendar lines. For example, if the lines are "bertown!berville", "newberville!bera", then the resulting line is "bertown!bervillenewberville!bera". In some sense one has to find the lexicographically minimal calendar, where the comparison of calendars happens line by line.
Help BerOilGasDiamondBank and construct the required calendar.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains an integer $ n $ ( $ 1<=n<=10^{4} $ , $ n $ is even) which is the number of branches. Then follow $ n $ lines which are the names of the cities. All the names consist of lowercase Latin letters; their lengths are no less than 1 and no more than 10 symbols. The next line contains a single symbol $ d $ ( $ d $ has an ASCII-code from 33 to 126 inclusively, excluding lowercase Latin letters) which is the separator between words in the calendar lines. It is guaranteed that the calendar is possible to be constructed and all the names are different.</div>
<h3>输出格式</h3>
<br />
<div>Print $ n/2 $ lines of similar length which are the required calendar. Every line should contain exactly two words and exactly one separator between them. If there are several solutions, print the lexicographically minimal one. The lexicographical comparison of lines is realized by the "<" operator in the modern programming languages.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>4
b
aa
hg
c
.
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>aa.b
c.hg
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>2
aa
a
!
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>a!aa
</code></pre>
<h3>输入样例 #3</h3>
<pre><code>2
aa
a
|
</code></pre>
<h3>输出样例 #3</h3>
<pre><code>aa|a
</code></pre>
</article>
</div>
</div>
</body>
</html>
