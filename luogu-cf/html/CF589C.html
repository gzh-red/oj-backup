<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Polycarp&#039;s Masterpiece - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573395701:MbcvkIOSbwfvAJgI5kJcY+4Gs0blWIoWqOFB4HoBOgk=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Inspired%20by%20success%20of%20Joanne%20Rowling%20and%20her%20fantasy%20series%20of%20Harry%20Potter%2C%20Polycarp%20decided%20to%20create%20his%20own%20masterpiece.%20He%20has%20already%20picked%20a%20name%20for%20his%20future%20bestseller%20%5Cu2014%20string%20%24%20s%20%24%20.%5Cn%5CnPolycarp%20faced%20a%20number%20of%20difficulties%20while%20he%20was%20working%20on%20the%20main%20story%20of%20his%20book%20so%20he%20decided%20to%20become%20Malevich%20in%20a%20literature%20and%20create%20his%20own%20%5C%22Black%20Square%5C%22.%5Cn%5CnChapters%20of%20his%20masterpiece%20were%20written%20by%20Polycarp%20in%20%24%20n%20%24%20days.%20He%20started%20from%20writing%20down%20the%20string%20%24%20s%20%24%20.%20Every%20day%20%28during%20the%20following%20%24%20n%20%24%20days%29%20he%20did%20the%20following%20procedure%3A%20on%20the%20%24%20i%20%24%20-th%20day%20he%20added%20to%20the%20right%20of%20current%20text%20%24%20t%20%24%20its%20%24%20k_%7Bi%7D%20%24%20-th%20circular%20shift.%20It%20means%20that%20every%20day%20content%20of%20his%20masterpiece%20doubled%20in%20size.%5Cn%5CnCircular%20shift%20of%20a%20string%20%24%20r%20%24%20is%20defined%20as%20a%20string%20resulted%20after%20movement%20of%20the%20last%20character%20of%20%24%20r%20%24%20to%20the%20first%20position%20in%20the%20string.%20As%20an%20example%3A%20circular%20shift%20of%20%5Cu00abmasterpiece%5Cu00bb%20is%20%5Cu00abemasterpiec%5Cu00bb.%20The%20%24%20i%20%24%20-th%20circular%20shift%20of%20a%20string%20%24%20r%20%24%20is%20defined%20as%20a%20string%20resulted%20after%20applying%20%24%20i%20%24%20subsequent%20circular%20shifts%20of%20the%20string%20%24%20r%20%24%20%28e.g.%2C%20the%20third%20circular%20shift%20of%20%5Cu00abmasterpiece%5Cu00bb%20is%20%5Cu00abecemasterpi%5Cu00bb%29.%5Cn%5CnAfter%20%24%20n%20%24%20days%20of%20tedious%20work%20Polycarp%20managed%20to%20write%20a%20very%20long%20text%20deserving%20the%20efforts%20made.%20However%2C%20text%20of%20his%20masterpiece%20was%20so%20long%20that%20it%20was%20nearly%20impossible%20to%20do%20any%20analysis%20of%20its%20content.%5Cn%5CnHelp%20Polycarp%20to%20answer%20%24%20m%20%24%20requests%20about%20his%20masterpiece%3A%20for%20the%20%24%20j%20%24%20-th%20request%20you%20will%20need%20to%20find%20how%20many%20times%20a%20letter%20%24%20c_%7Bj%7D%20%24%20is%20contained%20in%20a%20substring%20of%20his%20masterpiece%20starting%20from%20position%20%24%20l_%7Bj%7D%20%24%20and%20ending%20at%20%24%20r_%7Bj%7D%20%24%20inclusively.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20a%20name%20of%20the%20masterpiece%20%5Cu2014%20string%20%24%20s%20%24%20.%20The%20string%20%24%20s%20%24%20contains%20only%20lowercase%20latin%20letters%20and%20its%20length%20is%20between%201%20and%20100%20inclusively.%5Cn%5CnThe%20second%20line%20contains%20a%20pair%20of%20integer%20numbers%20%24%20n%20%24%20and%20%24%20m%20%24%20%24%20%281%3C%3Dn%3C%3D10%5E%7B5%7D%2C1%3C%3Dm%3C%3D10%5E%7B5%7D%29%20%24%20%5Cu2014%20a%20number%20of%20days%20Polycarp%20worked%20on%20his%20masterpiece%20and%20a%20number%20of%20requests%20you%20need%20to%20answer%20for%20the%20text%20respectively.%5Cn%5CnThe%20next%20line%20consists%20of%20%24%20n%20%24%20integer%20numbers%20%24%20k_%7Bi%7D%20%24%20%24%20%280%3C%3Dk_%7Bi%7D%3C%3D100%29%20%24%20%5Cu2014%20circular%20shifts%20used%20during%20%24%20n%20%24%20days%20of%20work.%5Cn%5CnFollowing%20%24%20m%20%24%20lines%20contains%20two%20integer%20numbers%20%24%20l_%7Bj%7D%2Cr_%7Bj%7D%20%24%20and%20a%20lowercase%20latin%20letter%20%24%20c_%7Bj%7D%20%24%20each%20%5Cu2014%20requests%20description.%20For%20each%20request%20you%20need%20to%20count%20number%20of%20times%20letter%20%24%20c_%7Bj%7D%20%24%20is%20contained%20in%20a%20substring%20of%20the%20masterpiece%20from%20position%20%24%20l_%7Bj%7D%20%24%20to%20%24%20r_%7Bj%7D%20%24%20inclusively.%20Positions%20are%20numerated%20starting%20from%20%24%201%20%24%20.%20It%20is%20guaranteed%20that%20%24%201%3C%3Dl_%7Bj%7D%3C%3Dr_%7Bj%7D%3C%3D10%5E%7B18%7D%20%24%20and%20both%20%24%20l_%7Bj%7D%20%24%20and%20%24%20r_%7Bj%7D%20%24%20do%20not%20exceed%20length%20of%20the%20masterpiece.%22%2C%22outputFormat%22%3A%22Output%20should%20contain%20%24%20m%20%24%20lines%2C%20where%20the%20%24%20j%20%24%20-th%20line%20contains%20the%20answer%20on%20the%20%24%20j%20%24%20-th%20request.%22%2C%22samples%22%3A%5B%5B%22masterpiece%5Cn1%203%5Cn3%5Cn1%2022%20m%5Cn9%2014%20e%5Cn8%2015%20p%5Cn%22%2C%222%5Cn4%5Cn0%5Cn%22%5D%2C%5B%22polycarp%5Cn1%202%5Cn0%5Cn2%2015%20p%5Cn1%2016%20p%5Cn%22%2C%222%5Cn4%5Cn%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%5D%2C%22memory%22%3A%5B512000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F589%5C%2FC%22%2C%22id%22%3A%22589C%22%7D%2C%22tags%22%3A%5B2%2C50%2C234%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A2%2C%22totalAccepted%22%3A2%2C%22pid%22%3A%22CF589C%22%2C%22title%22%3A%22Polycarp%27s%20Masterpiece%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Polycarp%27s%20Masterpiece%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573306449;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Polycarp&#039;s Masterpiece</h1>
<h2>题目描述</h2>
<div>Inspired by success of Joanne Rowling and her fantasy series of Harry Potter, Polycarp decided to create his own masterpiece. He has already picked a name for his future bestseller — string $ s $ .
Polycarp faced a number of difficulties while he was working on the main story of his book so he decided to become Malevich in a literature and create his own "Black Square".
Chapters of his masterpiece were written by Polycarp in $ n $ days. He started from writing down the string $ s $ . Every day (during the following $ n $ days) he did the following procedure: on the $ i $ -th day he added to the right of current text $ t $ its $ k_{i} $ -th circular shift. It means that every day content of his masterpiece doubled in size.
Circular shift of a string $ r $ is defined as a string resulted after movement of the last character of $ r $ to the first position in the string. As an example: circular shift of «masterpiece» is «emasterpiec». The $ i $ -th circular shift of a string $ r $ is defined as a string resulted after applying $ i $ subsequent circular shifts of the string $ r $ (e.g., the third circular shift of «masterpiece» is «ecemasterpi»).
After $ n $ days of tedious work Polycarp managed to write a very long text deserving the efforts made. However, text of his masterpiece was so long that it was nearly impossible to do any analysis of its content.
Help Polycarp to answer $ m $ requests about his masterpiece: for the $ j $ -th request you will need to find how many times a letter $ c_{j} $ is contained in a substring of his masterpiece starting from position $ l_{j} $ and ending at $ r_{j} $ inclusively.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains a name of the masterpiece — string $ s $ . The string $ s $ contains only lowercase latin letters and its length is between 1 and 100 inclusively.
The second line contains a pair of integer numbers $ n $ and $ m $ $ (1<=n<=10^{5},1<=m<=10^{5}) $ — a number of days Polycarp worked on his masterpiece and a number of requests you need to answer for the text respectively.
The next line consists of $ n $ integer numbers $ k_{i} $ $ (0<=k_{i}<=100) $ — circular shifts used during $ n $ days of work.
Following $ m $ lines contains two integer numbers $ l_{j},r_{j} $ and a lowercase latin letter $ c_{j} $ each — requests description. For each request you need to count number of times letter $ c_{j} $ is contained in a substring of the masterpiece from position $ l_{j} $ to $ r_{j} $ inclusively. Positions are numerated starting from $ 1 $ . It is guaranteed that $ 1<=l_{j}<=r_{j}<=10^{18} $ and both $ l_{j} $ and $ r_{j} $ do not exceed length of the masterpiece.</div>
<h3>输出格式</h3>
<br />
<div>Output should contain $ m $ lines, where the $ j $ -th line contains the answer on the $ j $ -th request.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>masterpiece
1 3
3
1 22 m
9 14 e
8 15 p
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>2
4
0
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>polycarp
1 2
0
2 15 p
1 16 p
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>2
4
</code></pre>
</article>
</div>
</div>
</body>
</html>
