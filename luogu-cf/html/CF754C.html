<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Vladik and chat - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573397477:+EzwFKMbn1hIrVXtKdJv+S3hiJ1kXPBNVnsbsgYlLlc=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Recently%20Vladik%20discovered%20a%20new%20entertainment%20%5Cu2014%20coding%20bots%20for%20social%20networks.%20He%20would%20like%20to%20use%20machine%20learning%20in%20his%20bots%20so%20now%20he%20want%20to%20prepare%20some%20learning%20data%20for%20them.%5Cn%5CnAt%20first%2C%20he%20need%20to%20download%20%24%20t%20%24%20chats.%20Vladik%20coded%20a%20script%20which%20should%20have%20downloaded%20the%20chats%2C%20however%2C%20something%20went%20wrong.%20In%20particular%2C%20some%20of%20the%20messages%20have%20no%20information%20of%20their%20sender.%20It%20is%20known%20that%20if%20a%20person%20sends%20several%20messages%20in%20a%20row%2C%20they%20all%20are%20merged%20into%20a%20single%20message.%20It%20means%20that%20there%20could%20not%20be%20two%20or%20more%20messages%20in%20a%20row%20with%20the%20same%20sender.%20Moreover%2C%20a%20sender%20never%20mention%20himself%20in%20his%20messages.%5Cn%5CnVladik%20wants%20to%20recover%20senders%20of%20all%20the%20messages%20so%20that%20each%20two%20neighboring%20messages%20will%20have%20different%20senders%20and%20no%20sender%20will%20mention%20himself%20in%20his%20messages.%5Cn%5CnHe%20has%20no%20idea%20of%20how%20to%20do%20this%2C%20and%20asks%20you%20for%20help.%20Help%20Vladik%20to%20recover%20senders%20in%20each%20of%20the%20chats%21%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20single%20integer%20%24%20t%20%24%20%28%20%24%201%3C%3Dt%3C%3D10%20%24%20%29%20%5Cu2014%20the%20number%20of%20chats.%20The%20%24%20t%20%24%20chats%20follow.%20Each%20chat%20is%20given%20in%20the%20following%20format.%5Cn%5CnThe%20first%20line%20of%20each%20chat%20description%20contains%20single%20integer%20%24%20n%20%24%20%28%20%24%201%3C%3Dn%3C%3D100%20%24%20%29%20%5Cu2014%20the%20number%20of%20users%20in%20the%20chat.%5Cn%5CnThe%20next%20line%20contains%20%24%20n%20%24%20space-separated%20distinct%20usernames.%20Each%20username%20consists%20of%20lowercase%20and%20uppercase%20English%20letters%20and%20digits.%20The%20usernames%20can%27t%20start%20with%20a%20digit.%20Two%20usernames%20are%20different%20even%20if%20they%20differ%20only%20with%20letters%27%20case.%20The%20length%20of%20username%20is%20positive%20and%20doesn%27t%20exceed%20%24%2010%20%24%20characters.%5Cn%5CnThe%20next%20line%20contains%20single%20integer%20%24%20m%20%24%20%28%20%24%201%3C%3Dm%3C%3D100%20%24%20%29%20%5Cu2014%20the%20number%20of%20messages%20in%20the%20chat.%20The%20next%20%24%20m%20%24%20line%20contain%20the%20messages%20in%20the%20following%20formats%2C%20one%20per%20line%3A%5Cn%5Cn-%20%3Cusername%3E%3A%3Ctext%3E%20%5Cu2014%20the%20format%20of%20a%20message%20with%20known%20sender.%20The%20username%20should%20appear%20in%20the%20list%20of%20usernames%20of%20the%20chat.%5Cn-%20%3C%3F%3E%3A%3Ctext%3E%20%5Cu2014%20the%20format%20of%20a%20message%20with%20unknown%20sender.%5Cn%5CnThe%20text%20of%20a%20message%20can%20consist%20of%20lowercase%20and%20uppercase%20English%20letter%2C%20digits%2C%20characters%20%27.%27%20%28dot%29%2C%20%27%2C%27%20%28comma%29%2C%20%27%21%27%20%28exclamation%20mark%29%2C%20%27%3F%27%20%28question%20mark%29%20and%20%27%20%27%20%28space%29.%20The%20text%20doesn%27t%20contain%20trailing%20spaces.%20The%20length%20of%20the%20text%20is%20positive%20and%20doesn%27t%20exceed%20%24%20100%20%24%20characters.%5Cn%5CnWe%20say%20that%20a%20text%20mention%20a%20user%20if%20his%20username%20appears%20in%20the%20text%20as%20a%20word.%20In%20other%20words%2C%20the%20username%20appears%20in%20a%20such%20a%20position%20that%20the%20two%20characters%20before%20and%20after%20its%20appearance%20either%20do%20not%20exist%20or%20are%20not%20English%20letters%20or%20digits.%20For%20example%2C%20the%20text%20%5C%22Vasya%2C%20masha13%20and%20Kate%21%5C%22%20can%20mention%20users%20%5C%22Vasya%5C%22%2C%20%5C%22masha13%5C%22%2C%20%5C%22and%5C%22%20and%20%5C%22Kate%5C%22%2C%20but%20not%20%5C%22masha%5C%22.%5Cn%5CnIt%20is%20guaranteed%20that%20in%20each%20chat%20no%20known%20sender%20mention%20himself%20in%20his%20messages%20and%20there%20are%20no%20two%20neighboring%20messages%20with%20the%20same%20known%20sender.%22%2C%22outputFormat%22%3A%22Print%20the%20information%20about%20the%20%24%20t%20%24%20chats%20in%20the%20following%20format%3A%5Cn%5CnIf%20it%20is%20not%20possible%20to%20recover%20senders%2C%20print%20single%20line%20%5C%22Impossible%5C%22%20for%20this%20chat.%20Otherwise%20print%20%24%20m%20%24%20messages%20in%20the%20following%20format%3A%5Cn%5Cn%3Cusername%3E%3A%3Ctext%3E%5Cn%5CnIf%20there%20are%20multiple%20answers%2C%20print%20any%20of%20them.%22%2C%22samples%22%3A%5B%5B%221%5Cn2%5CnVladik%20netman%5Cn2%5Cn%3F%3A%20Hello%2C%20Vladik%21%5Cn%3F%3A%20Hi%5Cn%22%2C%22netman%3A%20Hello%2C%20Vladik%21%5CnVladik%3A%20Hi%5Cn%22%5D%2C%5B%221%5Cn2%5Cnnetman%20vladik%5Cn3%5Cnnetman%3Ahow%20are%20you%3F%5Cn%3F%3Awrong%20message%5Cnvladik%3Aim%20fine%5Cn%22%2C%22Impossible%5Cn%22%5D%2C%5B%222%5Cn3%5Cnnetman%20vladik%20Fedosik%5Cn2%5Cn%3F%3A%20users%20are%20netman%2C%20vladik%2C%20Fedosik%5Cnvladik%3A%20something%20wrong%20with%20this%20chat%5Cn4%5Cnnetman%20tigerrrrr%20banany2001%20klinchuh%5Cn4%5Cn%3F%3A%20tigerrrrr%2C%20banany2001%2C%20klinchuh%2C%20my%20favourite%20team%20ever%2C%20are%20you%20ready%3F%5Cnklinchuh%3A%20yes%2C%20coach%21%5Cn%3F%3A%20yes%2C%20netman%5Cnbanany2001%3A%20yes%20of%20course.%5Cn%22%2C%22Impossible%5Cnnetman%3A%20tigerrrrr%2C%20banany2001%2C%20klinchuh%2C%20my%20favourite%20team%20ever%2C%20are%20you%20ready%3F%5Cnklinchuh%3A%20yes%2C%20coach%21%5Cntigerrrrr%3A%20yes%2C%20netman%5Cnbanany2001%3A%20yes%20of%20course.%5Cn%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F754%5C%2FC%22%2C%22id%22%3A%22754C%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A1%2C%22totalAccepted%22%3A1%2C%22pid%22%3A%22CF754C%22%2C%22title%22%3A%22Vladik%20and%20chat%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Vladik%20and%20chat%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Vladik and chat</h1>
<h2>题目描述</h2>
<div>Recently Vladik discovered a new entertainment — coding bots for social networks. He would like to use machine learning in his bots so now he want to prepare some learning data for them.
At first, he need to download $ t $ chats. Vladik coded a script which should have downloaded the chats, however, something went wrong. In particular, some of the messages have no information of their sender. It is known that if a person sends several messages in a row, they all are merged into a single message. It means that there could not be two or more messages in a row with the same sender. Moreover, a sender never mention himself in his messages.
Vladik wants to recover senders of all the messages so that each two neighboring messages will have different senders and no sender will mention himself in his messages.
He has no idea of how to do this, and asks you for help. Help Vladik to recover senders in each of the chats!</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains single integer $ t $ ( $ 1<=t<=10 $ ) — the number of chats. The $ t $ chats follow. Each chat is given in the following format.
The first line of each chat description contains single integer $ n $ ( $ 1<=n<=100 $ ) — the number of users in the chat.
The next line contains $ n $ space-separated distinct usernames. Each username consists of lowercase and uppercase English letters and digits. The usernames can't start with a digit. Two usernames are different even if they differ only with letters' case. The length of username is positive and doesn't exceed $ 10 $ characters.
The next line contains single integer $ m $ ( $ 1<=m<=100 $ ) — the number of messages in the chat. The next $ m $ line contain the messages in the following formats, one per line:
- <username>:<text> — the format of a message with known sender. The username should appear in the list of usernames of the chat.
- <?>:<text> — the format of a message with unknown sender.
The text of a message can consist of lowercase and uppercase English letter, digits, characters '.' (dot), ',' (comma), '!' (exclamation mark), '?' (question mark) and ' ' (space). The text doesn't contain trailing spaces. The length of the text is positive and doesn't exceed $ 100 $ characters.
We say that a text mention a user if his username appears in the text as a word. In other words, the username appears in a such a position that the two characters before and after its appearance either do not exist or are not English letters or digits. For example, the text "Vasya, masha13 and Kate!" can mention users "Vasya", "masha13", "and" and "Kate", but not "masha".
It is guaranteed that in each chat no known sender mention himself in his messages and there are no two neighboring messages with the same known sender.</div>
<h3>输出格式</h3>
<br />
<div>Print the information about the $ t $ chats in the following format:
If it is not possible to recover senders, print single line "Impossible" for this chat. Otherwise print $ m $ messages in the following format:
<username>:<text>
If there are multiple answers, print any of them.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>1
2
Vladik netman
2
?: Hello, Vladik!
?: Hi
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>netman: Hello, Vladik!
Vladik: Hi
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>1
2
netman vladik
3
netman:how are you?
?:wrong message
vladik:im fine
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>Impossible
</code></pre>
<h3>输入样例 #3</h3>
<pre><code>2
3
netman vladik Fedosik
2
?: users are netman, vladik, Fedosik
vladik: something wrong with this chat
4
netman tigerrrrr banany2001 klinchuh
4
?: tigerrrrr, banany2001, klinchuh, my favourite team ever, are you ready?
klinchuh: yes, coach!
?: yes, netman
banany2001: yes of course.
</code></pre>
<h3>输出样例 #3</h3>
<pre><code>Impossible
netman: tigerrrrr, banany2001, klinchuh, my favourite team ever, are you ready?
klinchuh: yes, coach!
tigerrrrr: yes, netman
banany2001: yes of course.
</code></pre>
</article>
</div>
</div>
</body>
</html>
