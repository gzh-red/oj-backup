<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Tree Requests - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573395491:ksaP4LSrRmxKpN9nGj9pXLWRF+hHm4KFg5oxk9XlRCk=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Roman%20planted%20a%20tree%20consisting%20of%20%24%20n%20%24%20vertices.%20Each%20vertex%20contains%20a%20lowercase%20English%20letter.%20Vertex%20%24%201%20%24%20is%20the%20root%20of%20the%20tree%2C%20each%20of%20the%20%24%20n-1%20%24%20remaining%20vertices%20has%20a%20parent%20in%20the%20tree.%20Vertex%20is%20connected%20with%20its%20parent%20by%20an%20edge.%20The%20parent%20of%20vertex%20%24%20i%20%24%20is%20vertex%20%24%20p_%7Bi%7D%20%24%20%2C%20the%20parent%20index%20is%20always%20less%20than%20the%20index%20of%20the%20vertex%20%28i.e.%2C%20%24%20p_%7Bi%7D%26lt%3Bi%20%24%20%29.%5Cn%5CnThe%20depth%20of%20the%20vertex%20is%20the%20number%20of%20nodes%20on%20the%20path%20from%20the%20root%20to%20%24%20v%20%24%20along%20the%20edges.%20In%20particular%2C%20the%20depth%20of%20the%20root%20is%20equal%20to%20%24%201%20%24%20.%5Cn%5CnWe%20say%20that%20vertex%20%24%20u%20%24%20is%20in%20the%20subtree%20of%20vertex%20%24%20v%20%24%20%2C%20if%20we%20can%20get%20from%20%24%20u%20%24%20to%20%24%20v%20%24%20%2C%20moving%20from%20the%20vertex%20to%20the%20parent.%20In%20particular%2C%20vertex%20%24%20v%20%24%20is%20in%20its%20subtree.%5Cn%5CnRoma%20gives%20you%20%24%20m%20%24%20queries%2C%20the%20%24%20i%20%24%20-th%20of%20which%20consists%20of%20two%20numbers%20%24%20v_%7Bi%7D%20%24%20%2C%20%24%20h_%7Bi%7D%20%24%20.%20Let%27s%20consider%20the%20vertices%20in%20the%20subtree%20%24%20v_%7Bi%7D%20%24%20located%20at%20depth%20%24%20h_%7Bi%7D%20%24%20.%20Determine%20whether%20you%20can%20use%20the%20letters%20written%20at%20these%20vertices%20to%20make%20a%20string%20that%20is%20a%20palindrome.%20The%20letters%20that%20are%20written%20in%20the%20vertexes%2C%20can%20be%20rearranged%20in%20any%20order%20to%20make%20a%20palindrome%2C%20but%20all%20letters%20should%20be%20used.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20two%20integers%20%24%20n%20%24%20%2C%20%24%20m%20%24%20%28%20%24%201%3C%3Dn%2Cm%3C%3D500000%20%24%20%29%20%5Cu2014%20the%20number%20of%20nodes%20in%20the%20tree%20and%20queries%2C%20respectively.%5Cn%5CnThe%20following%20line%20contains%20%24%20n-1%20%24%20integers%20%24%20p_%7B2%7D%2Cp_%7B3%7D%2C...%2Cp_%7Bn%7D%20%24%20%5Cu2014%20the%20parents%20of%20vertices%20from%20the%20second%20to%20the%20%24%20n%20%24%20-th%20%28%20%24%201%3C%3Dp_%7Bi%7D%26lt%3Bi%20%24%20%29.%5Cn%5CnThe%20next%20line%20contains%20%24%20n%20%24%20lowercase%20English%20letters%2C%20the%20%24%20i%20%24%20-th%20of%20these%20letters%20is%20written%20on%20vertex%20%24%20i%20%24%20.%5Cn%5CnNext%20%24%20m%20%24%20lines%20describe%20the%20queries%2C%20the%20%24%20i%20%24%20-th%20line%20contains%20two%20numbers%20%24%20v_%7Bi%7D%20%24%20%2C%20%24%20h_%7Bi%7D%20%24%20%28%20%24%201%3C%3Dv_%7Bi%7D%2Ch_%7Bi%7D%3C%3Dn%20%24%20%29%20%5Cu2014%20the%20vertex%20and%20the%20depth%20that%20appear%20in%20the%20%24%20i%20%24%20-th%20query.%22%2C%22outputFormat%22%3A%22Print%20%24%20m%20%24%20lines.%20In%20the%20%24%20i%20%24%20-th%20line%20print%20%5C%22Yes%5C%22%20%28without%20the%20quotes%29%2C%20if%20in%20the%20%24%20i%20%24%20-th%20query%20you%20can%20make%20a%20palindrome%20from%20the%20letters%20written%20on%20the%20vertices%2C%20otherwise%20print%20%5C%22No%5C%22%20%28without%20the%20quotes%29.%22%2C%22samples%22%3A%5B%5B%226%205%5Cn1%201%201%203%203%5Cnzacccd%5Cn1%201%5Cn3%203%5Cn4%201%5Cn6%201%5Cn1%202%5Cn%22%2C%22Yes%5CnNo%5CnYes%5CnYes%5CnYes%5Cn%22%5D%5D%2C%22hint%22%3A%22String%20%24%20s%20%24%20is%20a%20palindrome%20if%20reads%20the%20same%20from%20left%20to%20right%20and%20from%20right%20to%20left.%20In%20particular%2C%20an%20empty%20string%20is%20a%20palindrome.%5Cn%5CnClarification%20for%20the%20sample%20test.%5Cn%5CnIn%20the%20first%20query%20there%20exists%20only%20a%20vertex%201%20satisfying%20all%20the%20conditions%2C%20we%20can%20form%20a%20palindrome%20%5C%22z%5C%22.%5Cn%5CnIn%20the%20second%20query%20vertices%205%20and%206%20satisfy%20condititions%2C%20they%20contain%20letters%20%5C%22%5Cu0441%5C%22%20and%20%5C%22d%5C%22%20respectively.%20It%20is%20impossible%20to%20form%20a%20palindrome%20of%20them.%5Cn%5CnIn%20the%20third%20query%20there%20exist%20no%20vertices%20at%20depth%201%20and%20in%20subtree%20of%204.%20We%20may%20form%20an%20empty%20palindrome.%5Cn%5CnIn%20the%20fourth%20query%20there%20exist%20no%20vertices%20in%20subtree%20of%206%20at%20depth%201.%20We%20may%20form%20an%20empty%20palindrome.%5Cn%5CnIn%20the%20fifth%20query%20there%20vertices%202%2C%203%20and%204%20satisfying%20all%20conditions%20above%2C%20they%20contain%20letters%20%5C%22a%5C%22%2C%20%5C%22c%5C%22%20and%20%5C%22c%5C%22.%20We%20may%20form%20a%20palindrome%20%5C%22cac%5C%22.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F570%5C%2FD%22%2C%22id%22%3A%22570D%22%7D%2C%22translation%22%3A%22%5Cu7b80%5Cu5316%5Cu7248%3A%5Cn%5Cn%5Cu7ed9%5Cu5b9a%5Cu4e00%5Cu4e2a%5Cu4ee51%5Cu4e3a%5Cu6839%5Cu7684n%5Cu4e2a%5Cu8282%5Cu70b9%5Cu7684%5Cu6811%5Cuff0c%5Cu6bcf%5Cu4e2a%5Cu70b9%5Cu4e0a%5Cu6709%5Cu4e00%5Cu4e2a%5Cu5b57%5Cu6bcd%28a-z%29%5Cuff0c%5Cu6bcf%5Cu4e2a%5Cu70b9%5Cu7684%5Cu6df1%5Cu5ea6%5Cu5b9a%5Cu4e49%5Cu4e3a%5Cu8be5%5Cu8282%5Cu70b9%5Cu52301%5Cu53f7%5Cu8282%5Cu70b9%5Cu8def%5Cu5f84%5Cu4e0a%5Cu7684%5Cu70b9%5Cu6570.%5Cu6bcf%5Cu6b21%5Cu8be2%5Cu95ee%20%24a%2Cb%24%20%5Cu67e5%5Cu8be2%5Cu4ee5a%5Cu4e3a%5Cu6839%5Cu7684%5Cu5b50%5Cu6811%5Cu5185%5Cu6df1%5Cu5ea6%5Cu4e3ab%5Cu7684%5Cu8282%5Cu70b9%5Cu4e0a%5Cu7684%5Cu5b57%5Cu6bcd%5Cu91cd%5Cu65b0%5Cu6392%5Cu5217%5Cu4e4b%5Cu540e%5Cu662f%5Cu5426%5Cu80fd%5Cu6784%5Cu6210%5Cu56de%5Cu6587%5Cu4e32.%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A357%2C%22totalAccepted%22%3A165%2C%22pid%22%3A%22CF570D%22%2C%22title%22%3A%22Tree%20Requests%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A90133%2C%22title%22%3A%22%5Cu8865%5Cu5145%5Cu7ffb%5Cu8bd1%5Cuff1a%5Cu6837%5Cu4f8b%5Cu8bf4%5Cu660e%22%2C%22forum%22%3A%7B%22id%22%3A10396%2C%22name%22%3A%22CF570D%20Tree%20Requests%22%2C%22slug%22%3A%22CF570D%22%7D%7D%2C%7B%22id%22%3A60438%2C%22title%22%3A%22%5Cu7ffb%5Cu8bd1%22%2C%22forum%22%3A%7B%22id%22%3A10396%2C%22name%22%3A%22CF570D%20Tree%20Requests%22%2C%22slug%22%3A%22CF570D%22%7D%7D%2C%7B%22id%22%3A55112%2C%22title%22%3A%22Latex%5Cu6302%5Cu4e86%22%2C%22forum%22%3A%7B%22id%22%3A10396%2C%22name%22%3A%22CF570D%20Tree%20Requests%22%2C%22slug%22%3A%22CF570D%22%7D%7D%2C%7B%22id%22%3A49831%2C%22title%22%3A%22%5Cu7ffb%5Cu8bd1%22%2C%22forum%22%3A%7B%22id%22%3A10396%2C%22name%22%3A%22CF570D%20Tree%20Requests%22%2C%22slug%22%3A%22CF570D%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22CF741D%22%2C%22title%22%3A%22Arpa%5Cu2019s%20letter-marked%20tree%20and%20Mehrdad%5Cu2019s%20Dokhtar-kosh%20paths%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF375D%22%2C%22title%22%3A%22Tree%20and%20Queries%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF246E%22%2C%22title%22%3A%22Blood%20Cousins%20Return%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF208E%22%2C%22title%22%3A%22Blood%20Cousins%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF1009F%22%2C%22title%22%3A%22Dominant%20Indices%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Tree%20Requests%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573306449;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Tree Requests</h1>
<h2>题意翻译</h2>
<div>简化版:
给定一个以1为根的n个节点的树，每个点上有一个字母(a-z)，每个点的深度定义为该节点到1号节点路径上的点数.每次询问 $a,b$ 查询以a为根的子树内深度为b的节点上的字母重新排列之后是否能构成回文串.</div>
<h2>题目描述</h2>
<div>Roman planted a tree consisting of $ n $ vertices. Each vertex contains a lowercase English letter. Vertex $ 1 $ is the root of the tree, each of the $ n-1 $ remaining vertices has a parent in the tree. Vertex is connected with its parent by an edge. The parent of vertex $ i $ is vertex $ p_{i} $ , the parent index is always less than the index of the vertex (i.e., $ p_{i}&lt;i $ ).
The depth of the vertex is the number of nodes on the path from the root to $ v $ along the edges. In particular, the depth of the root is equal to $ 1 $ .
We say that vertex $ u $ is in the subtree of vertex $ v $ , if we can get from $ u $ to $ v $ , moving from the vertex to the parent. In particular, vertex $ v $ is in its subtree.
Roma gives you $ m $ queries, the $ i $ -th of which consists of two numbers $ v_{i} $ , $ h_{i} $ . Let's consider the vertices in the subtree $ v_{i} $ located at depth $ h_{i} $ . Determine whether you can use the letters written at these vertices to make a string that is a palindrome. The letters that are written in the vertexes, can be rearranged in any order to make a palindrome, but all letters should be used.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains two integers $ n $ , $ m $ ( $ 1<=n,m<=500000 $ ) — the number of nodes in the tree and queries, respectively.
The following line contains $ n-1 $ integers $ p_{2},p_{3},...,p_{n} $ — the parents of vertices from the second to the $ n $ -th ( $ 1<=p_{i}&lt;i $ ).
The next line contains $ n $ lowercase English letters, the $ i $ -th of these letters is written on vertex $ i $ .
Next $ m $ lines describe the queries, the $ i $ -th line contains two numbers $ v_{i} $ , $ h_{i} $ ( $ 1<=v_{i},h_{i}<=n $ ) — the vertex and the depth that appear in the $ i $ -th query.</div>
<h3>输出格式</h3>
<br />
<div>Print $ m $ lines. In the $ i $ -th line print "Yes" (without the quotes), if in the $ i $ -th query you can make a palindrome from the letters written on the vertices, otherwise print "No" (without the quotes).</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>6 5
1 1 1 3 3
zacccd
1 1
3 3
4 1
6 1
1 2
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>Yes
No
Yes
Yes
Yes
</code></pre>
<h2>说明</h2>
<div>String $ s $ is a palindrome if reads the same from left to right and from right to left. In particular, an empty string is a palindrome.
Clarification for the sample test.
In the first query there exists only a vertex 1 satisfying all the conditions, we can form a palindrome "z".
In the second query vertices 5 and 6 satisfy condititions, they contain letters "с" and "d" respectively. It is impossible to form a palindrome of them.
In the third query there exist no vertices at depth 1 and in subtree of 4. We may form an empty palindrome.
In the fourth query there exist no vertices in subtree of 6 at depth 1. We may form an empty palindrome.
In the fifth query there vertices 2, 3 and 4 satisfying all conditions above, they contain letters "a", "c" and "c". We may form a palindrome "cac".</div>
</article>
</div>
</div>
</body>
</html>
