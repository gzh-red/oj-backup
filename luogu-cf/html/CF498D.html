<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Traffic Jams in the Land - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573394774:NvZMtsYtklDGtR9atyeL4IN4LkwmYtK+YDafJ7v4D4o=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Some%20country%20consists%20of%20%24%20%28n%2B1%29%20%24%20cities%2C%20located%20along%20a%20straight%20highway.%20Let%27s%20number%20the%20cities%20with%20consecutive%20integers%20from%20%24%201%20%24%20to%20%24%20n%2B1%20%24%20in%20the%20order%20they%20occur%20along%20the%20highway.%20Thus%2C%20the%20cities%20are%20connected%20by%20%24%20n%20%24%20segments%20of%20the%20highway%2C%20the%20%24%20i%20%24%20-th%20segment%20connects%20cities%20number%20%24%20i%20%24%20and%20%24%20i%2B1%20%24%20.%20Every%20segment%20of%20the%20highway%20is%20associated%20with%20a%20positive%20integer%20%24%20a_%7Bi%7D%26gt%3B1%20%24%20%5Cu2014%20the%20period%20of%20traffic%20jams%20appearance%20on%20it.%5Cn%5CnIn%20order%20to%20get%20from%20city%20%24%20x%20%24%20to%20city%20%24%20y%20%24%20%28%20%24%20x%26lt%3By%20%24%20%29%2C%20some%20drivers%20use%20the%20following%20tactics.%5Cn%5CnInitially%20the%20driver%20is%20in%20city%20%24%20x%20%24%20and%20the%20current%20time%20%24%20t%20%24%20equals%20zero.%20Until%20the%20driver%20arrives%20in%20city%20%24%20y%20%24%20%2C%20he%20perfors%20the%20following%20actions%3A%5Cn%5Cn-%20if%20the%20current%20time%20%24%20t%20%24%20is%20a%20multiple%20of%20%24%20a_%7Bx%7D%20%24%20%2C%20then%20the%20segment%20of%20the%20highway%20number%20%24%20x%20%24%20is%20now%20having%20traffic%20problems%20and%20the%20driver%20stays%20in%20the%20current%20city%20for%20one%20unit%20of%20time%20%28formally%20speaking%2C%20we%20assign%20%24%20t%3Dt%2B1%20%24%20%29%3B%5Cn-%20if%20the%20current%20time%20%24%20t%20%24%20is%20not%20a%20multiple%20of%20%24%20a_%7Bx%7D%20%24%20%2C%20then%20the%20segment%20of%20the%20highway%20number%20%24%20x%20%24%20is%20now%20clear%20and%20that%27s%20why%20the%20driver%20uses%20one%20unit%20of%20time%20to%20move%20to%20city%20%24%20x%2B1%20%24%20%28formally%2C%20we%20assign%20%24%20t%3Dt%2B1%20%24%20and%20%24%20x%3Dx%2B1%20%24%20%29.%5Cn%5CnYou%20are%20developing%20a%20new%20traffic%20control%20system.%20You%20want%20to%20consecutively%20process%20%24%20q%20%24%20queries%20of%20two%20types%3A%5Cn%5Cn1.%20determine%20the%20final%20value%20of%20time%20%24%20t%20%24%20after%20the%20ride%20from%20city%20%24%20x%20%24%20to%20city%20%24%20y%20%24%20%28%20%24%20x%26lt%3By%20%24%20%29%20assuming%20that%20we%20apply%20the%20tactics%20that%20is%20described%20above.%20Note%20that%20for%20each%20query%20%24%20t%20%24%20is%20being%20reset%20to%20%24%200%20%24%20.%5Cn2.%20replace%20the%20period%20of%20traffic%20jams%20appearing%20on%20the%20segment%20number%20%24%20x%20%24%20by%20value%20%24%20y%20%24%20%28formally%2C%20assign%20%24%20a_%7Bx%7D%3Dy%20%24%20%29.%5Cn%5CnWrite%20a%20code%20that%20will%20effectively%20process%20the%20queries%20given%20above.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20a%20single%20integer%20%24%20n%20%24%20%28%20%24%201%3C%3Dn%3C%3D10%5E%7B5%7D%20%24%20%29%20%5Cu2014%20the%20number%20of%20highway%20segments%20that%20connect%20the%20%24%20n%2B1%20%24%20cities.%5Cn%5CnThe%20second%20line%20contains%20%24%20n%20%24%20integers%20%24%20a_%7B1%7D%2Ca_%7B2%7D%2C...%2Ca_%7Bn%7D%20%24%20%28%20%24%202%3C%3Da_%7Bi%7D%3C%3D6%20%24%20%29%20%5Cu2014%20the%20periods%20of%20traffic%20jams%20appearance%20on%20segments%20of%20the%20highway.%5Cn%5CnThe%20next%20line%20contains%20a%20single%20integer%20%24%20q%20%24%20%28%20%24%201%3C%3Dq%3C%3D10%5E%7B5%7D%20%24%20%29%20%5Cu2014%20the%20number%20of%20queries%20to%20process.%5Cn%5CnThe%20next%20%24%20q%20%24%20lines%20contain%20the%20descriptions%20of%20the%20queries%20in%20the%20format%20%24%20c%20%24%20%2C%20%24%20x%20%24%20%2C%20%24%20y%20%24%20%28%20%24%20c%20%24%20%5Cu2014%20the%20query%20type%29.%5Cn%5CnIf%20%24%20c%20%24%20is%20character%20%27A%27%2C%20then%20your%20task%20is%20to%20process%20a%20query%20of%20the%20first%20type.%20In%20this%20case%20the%20following%20constraints%20are%20satisfied%3A%20%24%201%3C%3Dx%26lt%3By%3C%3Dn%2B1%20%24%20.%5Cn%5CnIf%20%24%20c%20%24%20is%20character%20%27C%27%2C%20then%20you%20need%20to%20process%20a%20query%20of%20the%20second%20type.%20In%20such%20case%2C%20the%20following%20constraints%20are%20satisfied%3A%20%24%201%3C%3Dx%3C%3Dn%20%24%20%2C%20%24%202%3C%3Dy%3C%3D6%20%24%20.%22%2C%22outputFormat%22%3A%22For%20each%20query%20of%20the%20first%20type%20output%20a%20single%20integer%20%5Cu2014%20the%20final%20value%20of%20time%20%24%20t%20%24%20after%20driving%20from%20city%20%24%20x%20%24%20to%20city%20%24%20y%20%24%20.%20Process%20the%20queries%20in%20the%20order%20in%20which%20they%20are%20given%20in%20the%20input.%22%2C%22samples%22%3A%5B%5B%2210%5Cn2%205%203%202%203%205%203%204%202%204%5Cn10%5CnC%2010%206%5CnA%202%206%5CnA%201%203%5CnC%203%204%5CnA%203%2011%5CnA%204%209%5CnA%205%206%5CnC%207%203%5CnA%208%2010%5CnA%202%205%5Cn%22%2C%225%5Cn3%5Cn14%5Cn6%5Cn2%5Cn4%5Cn4%5Cn%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F498%5C%2FD%22%2C%22id%22%3A%22498D%22%7D%2C%22translation%22%3A%22%5Cu4e00%5Cu4e9b%5Cu56fd%5Cu5bb6%5Cu7531n%2B1%5Cu4e2a%5Cu57ce%5Cu5e02%5Cu7ec4%5Cu6210%5Cuff0c%5Cu8fd9%5Cu4e9b%5Cu57ce%5Cu5e02%5Cu4f4d%5Cu4e8e%5Cu4e00%5Cu4e2a%5Cu7b14%5Cu76f4%5Cu7684%5Cu8def%5Cu4e0a%5Cuff0c%5Cu6211%5Cu4eec%5Cu628a%5Cu6309%5Cu7167%5Cu4ed6%5Cu4eec%5Cu5728%5Cu8def%5Cu4e0a%5Cu7684%5Cu987a%5Cu5e8f%5Cu628a%5Cu8fd9%5Cu4e9b%5Cu57ce%5Cu5e02%5Cu7f16%5Cu53f7%5Cu4e3a1-%5Cuff08n%2B1%5Cuff09%2C%5Cu8fd9%5Cu6837%5Cuff0c%5Cu7b2ci%5Cu4e2a%5Cu7ebf%5Cu6bb5%5Cu8fde%5Cu63a5%5Cu7740%5Cu7b2ci%5Cu548c%5Cu548c%5Cu7b2ci%2B1%5Cu4e2a%5Cu57ce%5Cu5e02%5Cu3002%5Cu6bcf%5Cu4e00%5Cu4e2a%5Cu57ce%5Cu5e02%5Cu6709%5Cu4e00%5Cu4e2a%5Cu62e5%5Cu5835%5Cu503ca%5Bi%5D%5Cuff0c%5Cu5982%5Cu679c%5Cu5f53%5Cu524d%5Cu65f6%5Cu95f4%5Cu80fd%5Cu88aba%5Bi%5D%5Cu6574%5Cu9664%5Cuff0c%5Cu90a3%5Cu4e48%5Cu901a%5Cu8fc7%5Cu8fd9%5Cu6761%5Cu516c%5Cu8def%5Cu9700%5Cu8981%5Cu4e24%5Cu5206%5Cu949f%5Cuff0c%5Cu5426%5Cu5219%5Cu9700%5Cu8981%5Cu4e00%5Cu5206%5Cu949f%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu7ed9%5Cu51fa%5Cu6bcf%5Cu6761%5Cu516c%5Cu8def%5Cu7684a%5Bi%5D%5Cuff0c%5Cu4ee5%5Cu53cam%5Cu6b21%5Cu64cd%5Cu4f5c%5Cr%5Cn%5Cr%5Cn%5Cu64cd%5Cu4f5c%5Cu6709%5Cu4e24%5Cu79cd%5Cuff1a%5Cr%5Cn%5Cr%5Cn1%5Cu3001%20C%20x%20d%5Cuff1a%5Cu628a%5Cu7b2cx%5Cu6761%5Cu8def%5Cu7684%5Cu62e5%5Cu5835%5Cu65f6%5Cu523b%5Cu6539%5Cu6210d%5Cr%5Cn%5Cr%5Cn2%5Cu3001%20A%20x%20y%5Cuff1a%5Cu95eex%5Cu5230y%5Cu57ce%5Cu5e02%5Cu6240%5Cu9700%5Cu8981%5Cu7684%5Cu65f6%5Cu95f4%5Cr%5Cn%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A48%2C%22totalAccepted%22%3A26%2C%22pid%22%3A%22CF498D%22%2C%22title%22%3A%22Traffic%20Jams%20in%20the%20Land%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A121728%2C%22title%22%3A%22%5Cu6551%5Cu6551%5Cu5206%5Cu5757%5Cu8d85%5Cu65f6%5Cu7684%5Cu849f%5Cu84bb%5Cu5427%5Cuff01%22%2C%22forum%22%3A%7B%22id%22%3A10658%2C%22name%22%3A%22CF498D%20Traffic%20Jams%20in%20the%20Land%22%2C%22slug%22%3A%22CF498D%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Traffic%20Jams%20in%20the%20Land%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Traffic Jams in the Land</h1>
<h2>题意翻译</h2>
<div>一些国家由n+1个城市组成，这些城市位于一个笔直的路上，我们把按照他们在路上的顺序把这些城市编号为1-（n+1）,这样，第i个线段连接着第i和和第i+1个城市。每一个城市有一个拥堵值a[i]，如果当前时间能被a[i]整除，那么通过这条公路需要两分钟，否则需要一分钟。
给出每条公路的a[i]，以及m次操作
操作有两种：
1、 C x d：把第x条路的拥堵时刻改成d
2、 A x y：问x到y城市所需要的时间
</div>
<h2>题目描述</h2>
<div>Some country consists of $ (n+1) $ cities, located along a straight highway. Let's number the cities with consecutive integers from $ 1 $ to $ n+1 $ in the order they occur along the highway. Thus, the cities are connected by $ n $ segments of the highway, the $ i $ -th segment connects cities number $ i $ and $ i+1 $ . Every segment of the highway is associated with a positive integer $ a_{i}&gt;1 $ — the period of traffic jams appearance on it.
In order to get from city $ x $ to city $ y $ ( $ x&lt;y $ ), some drivers use the following tactics.
Initially the driver is in city $ x $ and the current time $ t $ equals zero. Until the driver arrives in city $ y $ , he perfors the following actions:
- if the current time $ t $ is a multiple of $ a_{x} $ , then the segment of the highway number $ x $ is now having traffic problems and the driver stays in the current city for one unit of time (formally speaking, we assign $ t=t+1 $ );
- if the current time $ t $ is not a multiple of $ a_{x} $ , then the segment of the highway number $ x $ is now clear and that's why the driver uses one unit of time to move to city $ x+1 $ (formally, we assign $ t=t+1 $ and $ x=x+1 $ ).
You are developing a new traffic control system. You want to consecutively process $ q $ queries of two types:
1. determine the final value of time $ t $ after the ride from city $ x $ to city $ y $ ( $ x&lt;y $ ) assuming that we apply the tactics that is described above. Note that for each query $ t $ is being reset to $ 0 $ .
2. replace the period of traffic jams appearing on the segment number $ x $ by value $ y $ (formally, assign $ a_{x}=y $ ).
Write a code that will effectively process the queries given above.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains a single integer $ n $ ( $ 1<=n<=10^{5} $ ) — the number of highway segments that connect the $ n+1 $ cities.
The second line contains $ n $ integers $ a_{1},a_{2},...,a_{n} $ ( $ 2<=a_{i}<=6 $ ) — the periods of traffic jams appearance on segments of the highway.
The next line contains a single integer $ q $ ( $ 1<=q<=10^{5} $ ) — the number of queries to process.
The next $ q $ lines contain the descriptions of the queries in the format $ c $ , $ x $ , $ y $ ( $ c $ — the query type).
If $ c $ is character 'A', then your task is to process a query of the first type. In this case the following constraints are satisfied: $ 1<=x&lt;y<=n+1 $ .
If $ c $ is character 'C', then you need to process a query of the second type. In such case, the following constraints are satisfied: $ 1<=x<=n $ , $ 2<=y<=6 $ .</div>
<h3>输出格式</h3>
<br />
<div>For each query of the first type output a single integer — the final value of time $ t $ after driving from city $ x $ to city $ y $ . Process the queries in the order in which they are given in the input.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>10
2 5 3 2 3 5 3 4 2 4
10
C 10 6
A 2 6
A 1 3
C 3 4
A 3 11
A 4 9
A 5 6
C 7 3
A 8 10
A 2 5
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>5
3
14
6
2
4
4
</code></pre>
</article>
</div>
</div>
</body>
</html>
