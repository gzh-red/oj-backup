<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Mages and Monsters - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573397911:2iPHDECwjU59bxMIofwkVKhl/O5Zt5J0xphMJHNV1G0=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Vova%20plays%20a%20computer%20game%20known%20as%20Mages%20and%20Monsters.%20Vova%27s%20character%20is%20a%20mage.%20Though%20as%20he%20has%20just%20started%2C%20his%20character%20knows%20no%20spells.%5Cn%5CnVova%27s%20character%20can%20learn%20new%20spells%20during%20the%20game.%20Every%20spell%20is%20characterized%20by%20two%20values%20%24%20x_%7Bi%7D%20%24%20and%20%24%20y_%7Bi%7D%20%24%20%5Cu2014%20damage%20per%20second%20and%20mana%20cost%20per%20second%2C%20respectively.%20Vova%20doesn%27t%20have%20to%20use%20a%20spell%20for%20an%20integer%20amount%20of%20seconds.%20More%20formally%2C%20if%20he%20uses%20a%20spell%20with%20damage%20%24%20x%20%24%20and%20mana%20cost%20%24%20y%20%24%20for%20%24%20z%20%24%20seconds%2C%20then%20he%20will%20deal%20%24%20x%5Cu00b7z%20%24%20damage%20and%20spend%20%24%20y%5Cu00b7z%20%24%20mana%20%28no%20rounding%29.%20If%20there%20is%20no%20mana%20left%20%28mana%20amount%20is%20set%20in%20the%20start%20of%20the%20game%20and%20it%20remains%20the%20same%20at%20the%20beginning%20of%20every%20fight%29%2C%20then%20character%20won%27t%20be%20able%20to%20use%20any%20spells.%20It%20is%20prohibited%20to%20use%20multiple%20spells%20simultaneously.%5Cn%5CnAlso%20Vova%20can%20fight%20monsters.%20Every%20monster%20is%20characterized%20by%20two%20values%20%24%20t_%7Bj%7D%20%24%20and%20%24%20h_%7Bj%7D%20%24%20%5Cu2014%20monster%20kills%20Vova%27s%20character%20in%20%24%20t_%7Bj%7D%20%24%20seconds%20and%20has%20%24%20h_%7Bj%7D%20%24%20health%20points.%20Mana%20refills%20after%20every%20fight%20%28or%20Vova%27s%20character%20revives%20with%20full%20mana%20reserve%29%2C%20so%20previous%20fights%20have%20no%20influence%20on%20further%20ones.%5Cn%5CnVova%27s%20character%20kills%20a%20monster%2C%20if%20he%20deals%20%24%20h_%7Bj%7D%20%24%20damage%20to%20it%20in%20no%20more%20than%20%24%20t_%7Bj%7D%20%24%20seconds%20using%20his%20spells%20%28it%20is%20allowed%20to%20use%20more%20than%20one%20spell%20in%20a%20fight%29%20and%20spending%20no%20more%20mana%20than%20he%20had%20at%20the%20beginning%20of%20the%20fight.%20If%20monster%27s%20health%20becomes%20zero%20exactly%20in%20%24%20t_%7Bj%7D%20%24%20seconds%20%28it%20means%20that%20the%20monster%20and%20Vova%27s%20character%20kill%20each%20other%20at%20the%20same%20time%29%2C%20then%20Vova%20wins%20the%20fight.%5Cn%5CnYou%20have%20to%20write%20a%20program%20which%20can%20answer%20two%20types%20of%20queries%3A%5Cn%5Cn-%20%24%201%20%24%20%24%20x%20%24%20%24%20y%20%24%20%5Cu2014%20Vova%27s%20character%20learns%20new%20spell%20which%20deals%20%24%20x%20%24%20damage%20per%20second%20and%20costs%20%24%20y%20%24%20mana%20per%20second.%5Cn-%20%24%202%20%24%20%24%20t%20%24%20%24%20h%20%24%20%5Cu2014%20Vova%20fights%20the%20monster%20which%20kills%20his%20character%20in%20%24%20t%20%24%20seconds%20and%20has%20%24%20h%20%24%20health%20points.%5Cn%5CnNote%20that%20queries%20are%20given%20in%20a%20different%20form.%20Also%20remember%20that%20Vova%27s%20character%20knows%20no%20spells%20at%20the%20beginning%20of%20the%20game.%5Cn%5CnFor%20every%20query%20of%20second%20type%20you%20have%20to%20determine%20if%20Vova%20is%20able%20to%20win%20the%20fight%20with%20corresponding%20monster.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20two%20integer%20numbers%20%24%20q%20%24%20and%20%24%20m%20%24%20%24%20%282%3C%3Dq%3C%3D10%5E%7B5%7D%2C1%3C%3Dm%3C%3D10%5E%7B12%7D%29%20%24%20%5Cu2014%20the%20number%20of%20queries%20and%20the%20amount%20of%20mana%20at%20the%20beginning%20of%20every%20fight.%5Cn%5Cn%20%24%20i%20%24%20-th%20of%20each%20next%20%24%20q%20%24%20lines%20contains%20three%20numbers%20%24%20k_%7Bi%7D%20%24%20%2C%20%24%20a_%7Bi%7D%20%24%20and%20%24%20b_%7Bi%7D%20%24%20%24%20%281%3C%3Dk_%7Bi%7D%3C%3D2%2C1%3C%3Da_%7Bi%7D%2Cb_%7Bi%7D%3C%3D10%5E%7B6%7D%29%20%24%20.%5Cn%5CnUsing%20them%20you%20can%20restore%20queries%20this%20way%3A%20let%20%24%20j%20%24%20be%20the%20index%20of%20the%20last%20query%20of%20second%20type%20with%20positive%20answer%20%28%20%24%20j%3D0%20%24%20if%20there%20were%20none%20of%20these%29.%5Cn%5Cn-%20If%20%24%20k_%7Bi%7D%3D1%20%24%20%2C%20then%20character%20learns%20spell%20with%20%24%20x%3D%28a_%7Bi%7D%2Bj%29%20%24%20%24%20mod%20%24%20%24%2010%5E%7B6%7D%2B1%20%24%20%2C%20%24%20y%3D%28b_%7Bi%7D%2Bj%29%20%24%20%24%20mod%20%24%20%24%2010%5E%7B6%7D%2B1%20%24%20.%5Cn-%20If%20%24%20k_%7Bi%7D%3D2%20%24%20%2C%20then%20you%20have%20to%20determine%20if%20Vova%20is%20able%20to%20win%20the%20fight%20against%20monster%20with%20%24%20t%3D%28a_%7Bi%7D%2Bj%29%20%24%20%24%20mod%20%24%20%24%2010%5E%7B6%7D%2B1%20%24%20%2C%20%24%20h%3D%28b_%7Bi%7D%2Bj%29%20%24%20%24%20mod%20%24%20%24%2010%5E%7B6%7D%2B1%20%24%20.%22%2C%22outputFormat%22%3A%22For%20every%20query%20of%20second%20type%20print%20YES%20if%20Vova%20is%20able%20to%20win%20the%20fight%20with%20corresponding%20monster%20and%20NO%20otherwise.%22%2C%22samples%22%3A%5B%5B%223%20100%5Cn1%204%209%5Cn2%2019%2049%5Cn2%2019%2049%5Cn%22%2C%22YES%5CnNO%5Cn%22%5D%5D%2C%22hint%22%3A%22In%20first%20example%20Vova%27s%20character%20at%20first%20learns%20the%20spell%20with%20%24%205%20%24%20damage%20and%20%24%2010%20%24%20mana%20cost%20per%20second.%20Next%20query%20is%20a%20fight%20with%20monster%20which%20can%20kill%20character%20in%20%24%2020%20%24%20seconds%20and%20has%20%24%2050%20%24%20health%20points.%20Vova%20kills%20it%20in%20%24%2010%20%24%20seconds%20%28spending%20%24%20100%20%24%20mana%29.%20Next%20monster%20has%20%24%2052%20%24%20health%2C%20so%20Vova%20can%27t%20deal%20that%20much%20damage%20with%20only%20%24%20100%20%24%20mana.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F792%5C%2FF%22%2C%22id%22%3A%22792F%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A32%2C%22totalAccepted%22%3A9%2C%22pid%22%3A%22CF792F%22%2C%22title%22%3A%22Mages%20and%20Monsters%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Mages%20and%20Monsters%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Mages and Monsters</h1>
<h2>题目描述</h2>
<div>Vova plays a computer game known as Mages and Monsters. Vova's character is a mage. Though as he has just started, his character knows no spells.
Vova's character can learn new spells during the game. Every spell is characterized by two values $ x_{i} $ and $ y_{i} $ — damage per second and mana cost per second, respectively. Vova doesn't have to use a spell for an integer amount of seconds. More formally, if he uses a spell with damage $ x $ and mana cost $ y $ for $ z $ seconds, then he will deal $ x·z $ damage and spend $ y·z $ mana (no rounding). If there is no mana left (mana amount is set in the start of the game and it remains the same at the beginning of every fight), then character won't be able to use any spells. It is prohibited to use multiple spells simultaneously.
Also Vova can fight monsters. Every monster is characterized by two values $ t_{j} $ and $ h_{j} $ — monster kills Vova's character in $ t_{j} $ seconds and has $ h_{j} $ health points. Mana refills after every fight (or Vova's character revives with full mana reserve), so previous fights have no influence on further ones.
Vova's character kills a monster, if he deals $ h_{j} $ damage to it in no more than $ t_{j} $ seconds using his spells (it is allowed to use more than one spell in a fight) and spending no more mana than he had at the beginning of the fight. If monster's health becomes zero exactly in $ t_{j} $ seconds (it means that the monster and Vova's character kill each other at the same time), then Vova wins the fight.
You have to write a program which can answer two types of queries:
- $ 1 $ $ x $ $ y $ — Vova's character learns new spell which deals $ x $ damage per second and costs $ y $ mana per second.
- $ 2 $ $ t $ $ h $ — Vova fights the monster which kills his character in $ t $ seconds and has $ h $ health points.
Note that queries are given in a different form. Also remember that Vova's character knows no spells at the beginning of the game.
For every query of second type you have to determine if Vova is able to win the fight with corresponding monster.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains two integer numbers $ q $ and $ m $ $ (2<=q<=10^{5},1<=m<=10^{12}) $ — the number of queries and the amount of mana at the beginning of every fight.
$ i $ -th of each next $ q $ lines contains three numbers $ k_{i} $ , $ a_{i} $ and $ b_{i} $ $ (1<=k_{i}<=2,1<=a_{i},b_{i}<=10^{6}) $ .
Using them you can restore queries this way: let $ j $ be the index of the last query of second type with positive answer ( $ j=0 $ if there were none of these).
- If $ k_{i}=1 $ , then character learns spell with $ x=(a_{i}+j) $ $ mod $ $ 10^{6}+1 $ , $ y=(b_{i}+j) $ $ mod $ $ 10^{6}+1 $ .
- If $ k_{i}=2 $ , then you have to determine if Vova is able to win the fight against monster with $ t=(a_{i}+j) $ $ mod $ $ 10^{6}+1 $ , $ h=(b_{i}+j) $ $ mod $ $ 10^{6}+1 $ .</div>
<h3>输出格式</h3>
<br />
<div>For every query of second type print YES if Vova is able to win the fight with corresponding monster and NO otherwise.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>3 100
1 4 9
2 19 49
2 19 49
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>YES
NO
</code></pre>
<h2>说明</h2>
<div>In first example Vova's character at first learns the spell with $ 5 $ damage and $ 10 $ mana cost per second. Next query is a fight with monster which can kill character in $ 20 $ seconds and has $ 50 $ health points. Vova kills it in $ 10 $ seconds (spending $ 100 $ mana). Next monster has $ 52 $ health, so Vova can't deal that much damage with only $ 100 $ mana.</div>
</article>
</div>
</div>
</body>
</html>
