<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Upgrading Tree - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573398512:r7UvJzUFqe0txQRMw3g08ZkDdYZ6gbkQh2o3bZACiJA=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22You%20are%20given%20a%20tree%20with%20%24%20n%20%24%20vertices%20and%20you%20are%20allowed%20to%20perform%20no%20more%20than%20%24%202n%20%24%20transformations%20on%20it.%20Transformation%20is%20defined%20by%20three%20vertices%20%24%20x%2Cy%2Cy%27%20%24%20and%20consists%20of%20deleting%20edge%20%24%20%28x%2Cy%29%20%24%20and%20adding%20edge%20%24%20%28x%2Cy%27%29%20%24%20.%20Transformation%20%24%20x%2Cy%2Cy%27%20%24%20could%20be%20performed%20if%20all%20the%20following%20conditions%20are%20satisfied%3A%5Cn%5Cn1.%20There%20is%20an%20edge%20%24%20%28x%2Cy%29%20%24%20in%20the%20current%20tree.%5Cn2.%20After%20the%20transformation%20the%20graph%20remains%20a%20tree.%5Cn3.%20After%20the%20deletion%20of%20edge%20%24%20%28x%2Cy%29%20%24%20the%20tree%20would%20consist%20of%20two%20connected%20components.%20Let%27s%20denote%20the%20set%20of%20nodes%20in%20the%20component%20containing%20vertex%20%24%20x%20%24%20by%20%24%20V_%7Bx%7D%20%24%20%2C%20and%20the%20set%20of%20nodes%20in%20the%20component%20containing%20vertex%20%24%20y%20%24%20by%20%24%20V_%7By%7D%20%24%20.%20Then%20condition%20%24%20%7CV_%7Bx%7D%7C%26gt%3B%7CV_%7By%7D%7C%20%24%20should%20be%20satisfied%2C%20i.e.%20the%20size%20of%20the%20component%20with%20%24%20x%20%24%20should%20be%20strictly%20larger%20than%20the%20size%20of%20the%20component%20with%20%24%20y%20%24%20.%5Cn%5CnYou%20should%20minimize%20the%20sum%20of%20squared%20distances%20between%20all%20pairs%20of%20vertices%20in%20a%20tree%2C%20which%20you%20could%20get%20after%20no%20more%20than%20%24%202n%20%24%20transformations%20and%20output%20any%20sequence%20of%20transformations%20leading%20initial%20tree%20to%20such%20state.%5Cn%5CnNote%20that%20you%20don%27t%20need%20to%20minimize%20the%20number%20of%20operations.%20It%20is%20necessary%20to%20minimize%20only%20the%20sum%20of%20the%20squared%20distances.%22%2C%22inputFormat%22%3A%22The%20first%20line%20of%20input%20contains%20integer%20%24%20n%20%24%20%28%20%24%201%3C%3Dn%3C%3D2%5Cu00b710%5E%7B5%7D%20%24%20%29%20%5Cu2014%20number%20of%20vertices%20in%20tree.%5Cn%5CnThe%20next%20%24%20n-1%20%24%20lines%20of%20input%20contains%20integers%20%24%20a%20%24%20and%20%24%20b%20%24%20%28%20%24%201%3C%3Da%2Cb%3C%3Dn%2Ca%5Cu2260b%20%24%20%29%20%5Cu2014%20the%20descriptions%20of%20edges.%20It%20is%20guaranteed%20that%20the%20given%20edges%20form%20a%20tree.%22%2C%22outputFormat%22%3A%22In%20the%20first%20line%20output%20integer%20%24%20k%20%24%20%28%20%24%200%3C%3Dk%3C%3D2n%20%24%20%29%20%5Cu2014%20the%20number%20of%20transformations%20from%20your%20example%2C%20minimizing%20sum%20of%20squared%20distances%20between%20all%20pairs%20of%20vertices.%5Cn%5CnIn%20each%20of%20the%20next%20%24%20k%20%24%20lines%20output%20three%20integers%20%24%20x%2Cy%2Cy%27%20%24%20%5Cu2014%20indices%20of%20vertices%20from%20the%20corresponding%20transformation.%5Cn%5CnTransformations%20with%20%24%20y%3Dy%27%20%24%20are%20allowed%20%28even%20though%20they%20don%27t%20change%20tree%29%20if%20transformation%20conditions%20are%20satisfied.%5Cn%5CnIf%20there%20are%20several%20possible%20answers%2C%20print%20any%20of%20them.%22%2C%22samples%22%3A%5B%5B%223%5Cn3%202%5Cn1%203%5Cn%22%2C%220%5Cn%22%5D%2C%5B%227%5Cn1%202%5Cn2%203%5Cn3%204%5Cn4%205%5Cn5%206%5Cn6%207%5Cn%22%2C%222%5Cn4%203%202%5Cn4%205%206%22%5D%5D%2C%22hint%22%3A%22This%20is%20a%20picture%20for%20the%20second%20sample.%20Added%20edges%20are%20dark%2C%20deleted%20edges%20are%20dotted.%5Cn%5Cn%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF843C%5C%2F5905cec6b2c0826d6ba38e3611ad2a2ba852ba57.png%29%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B4000%5D%2C%22memory%22%3A%5B512000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F843%5C%2FC%22%2C%22id%22%3A%22843C%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22CF843C%22%2C%22title%22%3A%22Upgrading%20Tree%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Upgrading%20Tree%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Upgrading Tree</h1>
<h2>题目描述</h2>
<div>You are given a tree with $ n $ vertices and you are allowed to perform no more than $ 2n $ transformations on it. Transformation is defined by three vertices $ x,y,y' $ and consists of deleting edge $ (x,y) $ and adding edge $ (x,y') $ . Transformation $ x,y,y' $ could be performed if all the following conditions are satisfied:
1. There is an edge $ (x,y) $ in the current tree.
2. After the transformation the graph remains a tree.
3. After the deletion of edge $ (x,y) $ the tree would consist of two connected components. Let's denote the set of nodes in the component containing vertex $ x $ by $ V_{x} $ , and the set of nodes in the component containing vertex $ y $ by $ V_{y} $ . Then condition $ |V_{x}|&gt;|V_{y}| $ should be satisfied, i.e. the size of the component with $ x $ should be strictly larger than the size of the component with $ y $ .
You should minimize the sum of squared distances between all pairs of vertices in a tree, which you could get after no more than $ 2n $ transformations and output any sequence of transformations leading initial tree to such state.
Note that you don't need to minimize the number of operations. It is necessary to minimize only the sum of the squared distances.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line of input contains integer $ n $ ( $ 1<=n<=2·10^{5} $ ) — number of vertices in tree.
The next $ n-1 $ lines of input contains integers $ a $ and $ b $ ( $ 1<=a,b<=n,a≠b $ ) — the descriptions of edges. It is guaranteed that the given edges form a tree.</div>
<h3>输出格式</h3>
<br />
<div>In the first line output integer $ k $ ( $ 0<=k<=2n $ ) — the number of transformations from your example, minimizing sum of squared distances between all pairs of vertices.
In each of the next $ k $ lines output three integers $ x,y,y' $ — indices of vertices from the corresponding transformation.
Transformations with $ y=y' $ are allowed (even though they don't change tree) if transformation conditions are satisfied.
If there are several possible answers, print any of them.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>3
3 2
1 3
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>0
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>7
1 2
2 3
3 4
4 5
5 6
6 7
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>2
4 3 2
4 5 6</code></pre>
<h2>说明</h2>
<div>This is a picture for the second sample. Added edges are dark, deleted edges are dotted.
![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF843C/5905cec6b2c0826d6ba38e3611ad2a2ba852ba57.png)</div>
</article>
</div>
</div>
</body>
</html>
