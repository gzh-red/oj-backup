<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Tachibana Kanade&#039;s Tofu - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573394027:As383W5mwe9R/DWIIThfTPCopkt5Q4+wC/22MqRjbv8=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Tachibana%20Kanade%20likes%20Mapo%20Tofu%20very%20much.%20One%20day%2C%20the%20canteen%20cooked%20all%20kinds%20of%20tofu%20to%20sell%2C%20but%20not%20all%20tofu%20is%20Mapo%20Tofu%2C%20only%20those%20spicy%20enough%20can%20be%20called%20Mapo%20Tofu.%5Cn%5CnEach%20piece%20of%20tofu%20in%20the%20canteen%20is%20given%20a%20%24%20m%20%24%20-based%20number%2C%20all%20numbers%20are%20in%20the%20range%20%24%20%5Bl%2Cr%5D%20%24%20%28%20%24%20l%20%24%20and%20%24%20r%20%24%20being%20%24%20m%20%24%20-based%20numbers%29%2C%20and%20for%20every%20%24%20m%20%24%20-based%20integer%20in%20the%20range%20%24%20%5Bl%2Cr%5D%20%24%20%2C%20there%20exists%20a%20piece%20of%20tofu%20with%20that%20number.%5Cn%5CnTo%20judge%20what%20tofu%20is%20Mapo%20Tofu%2C%20Tachibana%20Kanade%20chose%20%24%20n%20%24%20%24%20m%20%24%20-based%20number%20strings%2C%20and%20assigned%20a%20value%20to%20each%20string.%20If%20a%20string%20appears%20in%20the%20number%20of%20a%20tofu%2C%20the%20value%20of%20the%20string%20will%20be%20added%20to%20the%20value%20of%20that%20tofu.%20If%20a%20string%20appears%20multiple%20times%2C%20then%20the%20value%20is%20also%20added%20that%20many%20times.%20Initially%20the%20value%20of%20each%20tofu%20is%20zero.%5Cn%5CnTachibana%20Kanade%20considers%20tofu%20with%20values%20no%20more%20than%20%24%20k%20%24%20to%20be%20Mapo%20Tofu.%20So%20now%20Tachibana%20Kanade%20wants%20to%20know%2C%20how%20many%20pieces%20of%20tofu%20are%20Mapo%20Tofu%3F%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20three%20integers%20%24%20n%20%24%20%2C%20%24%20m%20%24%20and%20%24%20k%5Cu00a0%281%3C%3Dn%3C%3D200%3B%5Cu00a02%3C%3Dm%3C%3D20%3B%5Cu00a01%3C%3Dk%3C%3D500%29%20%24%20.%20Where%20%24%20n%20%24%20denotes%20the%20number%20of%20strings%2C%20%24%20m%20%24%20denotes%20the%20base%20used%2C%20and%20%24%20k%20%24%20denotes%20the%20limit%20of%20the%20value%20for%20Mapo%20Tofu.%5Cn%5CnThe%20second%20line%20represents%20the%20number%20%24%20l%20%24%20.%20The%20first%20integer%20in%20the%20line%20is%20%24%20len%20%24%20%24%20%281%3C%3Dlen%3C%3D200%29%20%24%20%2C%20describing%20the%20length%20%28number%20of%20digits%20in%20base%20%24%20m%20%24%20%29%20of%20%24%20l%20%24%20.%20Then%20follow%20%24%20len%20%24%20integers%20%24%20a_%7B1%7D%2Ca_%7B2%7D%2C...%2Ca_%7Blen%7D%5Cu00a0%280%3C%3Da_%7Bi%7D%26lt%3Bm%3B%5Cu00a0a_%7B1%7D%26gt%3B0%29%20%24%20separated%20by%20spaces%2C%20representing%20the%20digits%20of%20%24%20l%20%24%20%2C%20with%20%24%20a_%7B1%7D%20%24%20being%20the%20highest%20digit%20and%20%24%20a_%7Blen%7D%20%24%20being%20the%20lowest%20digit.%5Cn%5CnThe%20third%20line%20represents%20the%20number%20%24%20r%20%24%20in%20the%20same%20format%20as%20%24%20l%20%24%20.%20It%20is%20guaranteed%20that%20%24%201%3C%3Dl%3C%3Dr%20%24%20.%5Cn%5CnThen%20follow%20%24%20n%20%24%20lines%2C%20each%20line%20describing%20a%20number%20string.%20The%20%24%20i%20%24%20-th%20line%20contains%20the%20%24%20i%20%24%20-th%20number%20string%20and%20%24%20v_%7Bi%7D%20%24%20%5Cu2014%20the%20value%20of%20the%20%24%20i%20%24%20-th%20string%20%28%20%24%201%3C%3Dv_%7Bi%7D%3C%3D200%20%24%20%29.%20All%20number%20strings%20are%20described%20in%20almost%20the%20same%20format%20as%20%24%20l%20%24%20%2C%20the%20only%20difference%20is%20number%20strings%20may%20contain%20necessary%20leading%20zeros%20%28see%20the%20first%20example%29.%20The%20sum%20of%20the%20lengths%20of%20all%20number%20strings%20does%20not%20exceed%20%24%20200%20%24%20.%22%2C%22outputFormat%22%3A%22Output%20the%20number%20of%20pieces%20of%20Mapo%20Tofu%20modulo%20%24%201000000007%20%24%20%24%20%2810%5E%7B9%7D%2B7%29%20%24%20.%20The%20answer%20should%20be%20a%20decimal%20integer.%22%2C%22samples%22%3A%5B%5B%222%2010%201%5Cn1%201%5Cn3%201%200%200%5Cn1%201%201%5Cn1%200%201%5Cn%22%2C%2297%5Cn%22%5D%2C%5B%222%2010%2012%5Cn2%205%209%5Cn6%206%203%205%204%209%207%5Cn2%200%206%201%5Cn3%206%207%202%201%5Cn%22%2C%22635439%5Cn%22%5D%2C%5B%224%202%206%5Cn6%201%200%201%201%201%200%5Cn6%201%201%200%201%200%200%5Cn1%201%202%5Cn3%200%201%200%205%5Cn4%200%201%201%200%204%5Cn3%201%200%201%202%5Cn%22%2C%222%5Cn%22%5D%5D%2C%22hint%22%3A%22In%20the%20first%20sample%2C%2010%2C%2011%20and%20100%20are%20the%20only%20three%20decimal%20numbers%20in%20%24%20%5B1%2C100%5D%20%24%20with%20a%20value%20greater%20than%201.%20Here%20the%20value%20of%201%20is%201%20but%20not%202%2C%20since%20numbers%20cannot%20contain%20leading%20zeros%20and%20thus%20cannot%20be%20written%20as%20%5C%2201%5C%22.%5Cn%5CnIn%20the%20second%20sample%2C%20no%20numbers%20in%20the%20given%20interval%20have%20a%20value%20greater%20than%2012.%5Cn%5CnIn%20the%20third%20sample%2C%20110000%20and%20110001%20are%20the%20only%20two%20binary%20numbers%20in%20the%20given%20interval%20with%20a%20value%20no%20greater%20than%206.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B5000%5D%2C%22memory%22%3A%5B512000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F433%5C%2FE%22%2C%22id%22%3A%22433E%22%7D%2C%22translation%22%3A%22%23%20%5Cu9898%5Cu76ee%5Cu5927%5Cu610f%5Cr%5Cn%5Cu4f60%5Cu6709%24n%24%5Cu4e2a%24m%24%5Cu8fdb%5Cu5236%5Cu7684%5Cu6837%5Cu672c%5Cu4e32%5Cuff0c%5Cu5982%5Cu679c%5Cu4e00%5Cu4e2a%5Cu6570%5Cu5305%5Cu542b%5Cu5176%5Cu4e2d%5Cu7684%5Cu7b2c%24i%24%5Cu4e2a%5Cuff0c%5Cu5c31%5Cu4f1a%5Cu52a0%5Cu4e0a%24p_i%24%5Cu76f8%5Cu4f3c%5Cu5ea6%28%5Cu591a%5Cu6b21%5Cu5305%5Cu542b%5Cu5c31%5Cu8ba1%5Cu7b97%5Cu591a%5Cu6b21%5Cuff0c%5Cu5305%5Cu542b%5Cu6307%5Cu7684%5Cu662f%5Cu5728%5Cu5176%5Cu4e2d%5Cu8fde%5Cu7eed%5Cu51fa%5Cu73b0%29%5Cuff0c%5Cu95ee%24%5BL%2CR%5D%24%5Cu6709%5Cu591a%5Cu5c11%5Cu6570%5Cu6ee1%5Cu8db3%5Cu76f8%5Cu4f3c%5Cu5ea6%28%24L%2CR%24%5Cu90fd%5Cu662f%24m%24%5Cu8fdb%5Cu5236%5Cu7684%29%5Cu3002%5Cr%5Cn%23%20%5Cu8f93%5Cu5165%5Cr%5Cn%5Cu7b2c%5Cu4e00%5Cu884c%5Cu4e09%5Cu4e2a%5Cu6574%5Cu6570%24n%2Cm%2Ck%24%5Cuff0c%5Cu542b%5Cu4e49%5Cu540c%5Cu9898%5Cu4e2d%5Cu6240%5Cu8ff0%5Cu3002%20%20%5Cr%5Cn%5Cu7b2c%5Cu4e8c%5Cu884c%5Cu7b2c%5Cu4e00%5Cu4e2a%5Cu6570%5Cu5b57%24t%24%5Cuff0c%5Cu8868%5Cu793a%24L%24%28%24m%24%5Cu8fdb%5Cu5236%29%5Cu7684%5Cu957f%5Cu5ea6%5Cuff0c%5Cu63a5%5Cu4e0b%5Cu6765%24t%24%5Cu4e2a%5Cu6574%5Cu6570%5Cu63cf%5Cu8ff0%24L%24%5Cu3002%20%20%5Cr%5Cn%5Cu7b2c%5Cu4e09%5Cu884c%5Cuff0c%5Cu7528%5Cu540c%5Cu6837%5Cu7684%5Cu65b9%5Cu6cd5%5Cu8868%5Cu793a%24R%24%28%24L%24%5Cu548c%24R%24%5Cu65e0%5Cu524d%5Cu5bfc%240%24%29%5Cu3002%20%20%5Cr%5Cn%5Cu63a5%5Cu4e0b%5Cu6765%5Cu7684%24n%24%5Cu884c%5Cuff0c%5Cu6bcf%5Cu884c%5Cu5f00%5Cu59cb%5Cu8f93%5Cu5165%5Cu4e00%5Cu4e2a%5Cu6570%5Cu5b57%5Cu4e32%5Cuff0c%5Cu8868%5Cu793a%5Cu6811%5Cu679d%5Cu6837%5Cu672c%28%5Cu8f93%5Cu5165%5Cu65b9%5Cu5f0f%5Cu548c%24L%24%5Cu76f8%5Cu540c%5Cuff0c%5Cu53ef%5Cu80fd%5Cu6709%5Cu524d%5Cu5bfc%240%24%29%5Cu3002%5Cu7136%5Cu540e%5Cu4e00%5Cu4e2a%5Cu6574%5Cu6570%24p%24%28%5Cu5341%5Cu8fdb%5Cu5236%29%5Cuff0c%5Cu8868%5Cu793a%5Cu8fd9%5Cu4e2a%5Cu6837%5Cu672c%5Cu7684%5Cu76f8%5Cu4f3c%5Cu5ea6%5Cu3002%5Cr%5Cn%23%20%5Cu8f93%5Cu51fa%5Cr%5Cn%5Cu8f93%5Cu51fa%5Cu7b54%5Cu6848%5Cu5bf9%2410%5E9%2B7%24%5Cu53d6%5Cu6a21%5Cu7684%5Cu7ed3%5Cu679c%5Cr%5Cn%23%20%5Cu6837%5Cu4f8b%5Cr%5Cn%5Cu6837%5Cu4f8b%5Cu8f93%5Cu51651%20%20%5Cr%5Cn2%2010%201%20%20%5Cr%5Cn1%201%20%20%5Cr%5Cn3%201%200%200%20%20%5Cr%5Cn1%201%201%20%20%5Cr%5Cn1%200%201%20%20%5Cr%5Cn%5Cu6837%5Cu4f8b%5Cu8f93%5Cu51fa1%20%20%5Cr%5Cn97%5Cr%5Cn%23%20%5Cu6570%5Cu636e%5Cu8303%5Cu56f4%5Cr%5Cn%241%3C%3Dn%3C%3D200%3B%202%3C%3Dm%3C%3D20%3B%201%3C%3Dk%3C%3D500%3B%24%20%20%5Cr%5Cn%241%20%5C%5Cleq%20len%20%5C%5Cleq%20200%3B%201%20%5C%5Cleq%20v_i%20%5C%5Cleq%20200%24%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A14%2C%22totalAccepted%22%3A8%2C%22pid%22%3A%22CF433E%22%2C%22title%22%3A%22Tachibana%20Kanade%27s%20Tofu%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A126505%2C%22title%22%3A%22%5Cu770b%5Cu5b8c%5Cu7ffb%5Cu8bd1%5Cu6211%5Cu4ecd%5Cu7136%5Cu4e0d%5Cu77e5%5Cu9053k%5Cu662f%5Cu4e2a%5Cu4ec0%5Cu4e48%5Cu4e1c%5Cu897f%22%2C%22forum%22%3A%7B%22id%22%3A10921%2C%22name%22%3A%22CF433E%20Tachibana%20Kanade%27s%20Tofu%22%2C%22slug%22%3A%22CF433E%22%7D%7D%2C%7B%22id%22%3A87399%2C%22title%22%3A%22%5Cu548ccf%20%5Cu7684%5Cu8fde%5Cu63a5%5Cu600e%5Cu4e48%5Cu5495%5Cu5495%5Cu4e86%5Cuff1f%22%2C%22forum%22%3A%7B%22id%22%3A10921%2C%22name%22%3A%22CF433E%20Tachibana%20Kanade%27s%20Tofu%22%2C%22slug%22%3A%22CF433E%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Tachibana%20Kanade%27s%20Tofu%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573306449;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Tachibana Kanade&#039;s Tofu</h1>
<h2>题意翻译</h2>
<div># 题目大意
你有$n$个$m$进制的样本串，如果一个数包含其中的第$i$个，就会加上$p_i$相似度(多次包含就计算多次，包含指的是在其中连续出现)，问$[L,R]$有多少数满足相似度($L,R$都是$m$进制的)。
# 输入
第一行三个整数$n,m,k$，含义同题中所述。
第二行第一个数字$t$，表示$L$($m$进制)的长度，接下来$t$个整数描述$L$。
第三行，用同样的方法表示$R$($L$和$R$无前导$0$)。
接下来的$n$行，每行开始输入一个数字串，表示树枝样本(输入方式和$L$相同，可能有前导$0$)。然后一个整数$p$(十进制)，表示这个样本的相似度。
# 输出
输出答案对$10^9+7$取模的结果
# 样例
样例输入1
2 10 1
1 1
3 1 0 0
1 1 1
1 0 1
样例输出1
97
# 数据范围
$1<=n<=200; 2<=m<=20; 1<=k<=500;$
$1 \leq len \leq 200; 1 \leq v_i \leq 200$</div>
<h2>题目描述</h2>
<div>Tachibana Kanade likes Mapo Tofu very much. One day, the canteen cooked all kinds of tofu to sell, but not all tofu is Mapo Tofu, only those spicy enough can be called Mapo Tofu.
Each piece of tofu in the canteen is given a $ m $ -based number, all numbers are in the range $ [l,r] $ ( $ l $ and $ r $ being $ m $ -based numbers), and for every $ m $ -based integer in the range $ [l,r] $ , there exists a piece of tofu with that number.
To judge what tofu is Mapo Tofu, Tachibana Kanade chose $ n $ $ m $ -based number strings, and assigned a value to each string. If a string appears in the number of a tofu, the value of the string will be added to the value of that tofu. If a string appears multiple times, then the value is also added that many times. Initially the value of each tofu is zero.
Tachibana Kanade considers tofu with values no more than $ k $ to be Mapo Tofu. So now Tachibana Kanade wants to know, how many pieces of tofu are Mapo Tofu?</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains three integers $ n $ , $ m $ and $ k (1<=n<=200; 2<=m<=20; 1<=k<=500) $ . Where $ n $ denotes the number of strings, $ m $ denotes the base used, and $ k $ denotes the limit of the value for Mapo Tofu.
The second line represents the number $ l $ . The first integer in the line is $ len $ $ (1<=len<=200) $ , describing the length (number of digits in base $ m $ ) of $ l $ . Then follow $ len $ integers $ a_{1},a_{2},...,a_{len} (0<=a_{i}&lt;m; a_{1}&gt;0) $ separated by spaces, representing the digits of $ l $ , with $ a_{1} $ being the highest digit and $ a_{len} $ being the lowest digit.
The third line represents the number $ r $ in the same format as $ l $ . It is guaranteed that $ 1<=l<=r $ .
Then follow $ n $ lines, each line describing a number string. The $ i $ -th line contains the $ i $ -th number string and $ v_{i} $ — the value of the $ i $ -th string ( $ 1<=v_{i}<=200 $ ). All number strings are described in almost the same format as $ l $ , the only difference is number strings may contain necessary leading zeros (see the first example). The sum of the lengths of all number strings does not exceed $ 200 $ .</div>
<h3>输出格式</h3>
<br />
<div>Output the number of pieces of Mapo Tofu modulo $ 1000000007 $ $ (10^{9}+7) $ . The answer should be a decimal integer.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>2 10 1
1 1
3 1 0 0
1 1 1
1 0 1
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>97
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>2 10 12
2 5 9
6 6 3 5 4 9 7
2 0 6 1
3 6 7 2 1
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>635439
</code></pre>
<h3>输入样例 #3</h3>
<pre><code>4 2 6
6 1 0 1 1 1 0
6 1 1 0 1 0 0
1 1 2
3 0 1 0 5
4 0 1 1 0 4
3 1 0 1 2
</code></pre>
<h3>输出样例 #3</h3>
<pre><code>2
</code></pre>
<h2>说明</h2>
<div>In the first sample, 10, 11 and 100 are the only three decimal numbers in $ [1,100] $ with a value greater than 1. Here the value of 1 is 1 but not 2, since numbers cannot contain leading zeros and thus cannot be written as "01".
In the second sample, no numbers in the given interval have a value greater than 12.
In the third sample, 110000 and 110001 are the only two binary numbers in the given interval with a value no greater than 6.</div>
</article>
</div>
</div>
</body>
</html>
