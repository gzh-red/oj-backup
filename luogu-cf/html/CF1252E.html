<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Songwriter - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573403815:8R4kSXxJxWUeXIAFgNyL/SPkV4V7oF77QVucD13uxMU=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Andi%20is%20a%20mathematician%2C%20a%20computer%20scientist%2C%20and%20a%20songwriter.%20After%20spending%20so%20much%20time%20writing%20songs%2C%20he%20finally%20writes%20a%20catchy%20melody%20that%20he%20thought%20as%20his%20best%20creation.%20However%2C%20the%20singer%20who%20will%20sing%20the%20song%5C%2Fmelody%20has%20a%20unique%20vocal%20range%2C%20thus%2C%20an%20adjustment%20may%20be%20needed.%5Cn%5CnA%20melody%20is%20defined%20as%20a%20sequence%20of%20%24%20N%20%24%20notes%20which%20are%20represented%20by%20integers.%20Let%20%24%20A%20%24%20be%20the%20original%20melody%20written%20by%20Andi.%20Andi%20needs%20to%20adjust%20%24%20A%20%24%20into%20a%20new%20melody%20%24%20B%20%24%20such%20that%20for%20every%20%24%20i%20%24%20where%20%24%201%20%5C%5Cle%20i%20%3C%20N%20%24%20%3A%5Cn%5Cn-%20If%20%24%20A_i%20%3C%20A_%7Bi%2B1%7D%20%24%20%2C%20then%20%24%20B_i%20%3C%20B_%7Bi%2B1%7D%20%24%20.%5Cn-%20If%20%24%20A_i%20%3D%20A_%7Bi%2B1%7D%20%24%20%2C%20then%20%24%20B_i%20%3D%20B_%7Bi%2B1%7D%20%24%20.%5Cn-%20If%20%24%20A_i%20%3E%20A_%7Bi%2B1%7D%20%24%20%2C%20then%20%24%20B_i%20%3E%20B_%7Bi%2B1%7D%20%24%20.%5Cn-%20%24%20%7CB_i%20-%20B_%7Bi%2B1%7D%7C%20%5C%5Cle%20K%20%24%20%2C%20i.e.%20the%20difference%20between%20two%20successive%20notes%20is%20no%20larger%20than%20%24%20K%20%24%20.%5Cn%5Cn%20Moreover%2C%20the%20singer%20also%20requires%20that%20all%20notes%20are%20within%20her%20vocal%20range%2C%20i.e.%20%24%20L%20%5C%5Cle%20B_i%20%5C%5Cle%20R%20%24%20for%20all%20%24%201%20%5C%5Cle%20i%20%5C%5Cle%20N%20%24%20.Help%20Andi%20to%20determine%20whether%20such%20%24%20B%20%24%20exists%2C%20and%20find%20the%20lexicographically%20smallest%20%24%20B%20%24%20if%20it%20exists.%20A%20melody%20%24%20X%20%24%20is%20lexicographically%20smaller%20than%20melody%20%24%20Y%20%24%20if%20and%20only%20if%20there%20exists%20%24%20j%20%24%20%28%20%24%201%20%5C%5Cle%20j%20%5C%5Cle%20N%20%24%20%29%20such%20that%20%24%20X_i%20%3D%20Y_i%20%24%20for%20all%20%24%20i%20%3C%20j%20%24%20and%20%24%20X_%7Bj%7D%20%3C%20Y_%7Bj%7D%20%24%20.%5Cn%5CnFor%20example%2C%20consider%20a%20melody%20%24%20A%20%3D%20%5C%5C%7B1%2C3%2C5%2C6%2C7%2C8%2C9%2C10%2C3%2C7%2C8%2C9%2C10%2C11%2C12%2C12%5C%5C%7D%20%24%20as%20shown%20in%20the%20following%20figure.%20The%20diagonal%20arrow%20up%20in%20the%20figure%20implies%20that%20%24%20A_i%20%3C%20A_%7Bi%2B1%7D%20%24%20%2C%20the%20straight%20right%20arrow%20implies%20that%20%24%20A_i%20%3D%20A_%7Bi%2B1%7D%20%24%20%2C%20and%20the%20diagonal%20arrow%20down%20implies%20that%20%24%20A_i%20%3E%20A_%7Bi%2B1%7D%20%24%20.%5Cn%5Cn%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF1252E%5C%2Fe498d7b4f78632de9fe4f587d3c868951b8bb1a9.png%29Supposed%20we%20want%20to%20make%20a%20new%20melody%20with%20%24%20L%20%3D%201%20%24%20%2C%20%24%20R%20%3D%208%20%24%20%2C%20and%20%24%20K%20%3D%206%20%24%20.%20The%20new%20melody%20%24%20B%20%3D%20%5C%5C%7B1%2C2%2C3%2C4%2C5%2C6%2C7%2C8%2C2%2C3%2C4%2C5%2C6%2C7%2C8%2C8%5C%5C%7D%20%24%20as%20shown%20in%20the%20figure%20satisfies%20all%20the%20requirements%2C%20and%20it%20is%20the%20lexicographically%20smallest%20possible.%22%2C%22inputFormat%22%3A%22Input%20begins%20with%20a%20line%20containing%20four%20integers%3A%20%24%20N%20%24%20%24%20L%20%24%20%24%20R%20%24%20%24%20K%20%24%20%28%20%24%201%20%5C%5Cle%20N%20%5C%5Cle%20100%5C%5C%2C000%20%24%20%3B%20%24%201%20%5C%5Cle%20L%20%5C%5Cle%20R%20%5C%5Cle%2010%5E9%20%24%20%3B%20%24%201%20%5C%5Cle%20K%20%5C%5Cle%2010%5E9%20%24%20%29%20representing%20the%20number%20of%20notes%20in%20the%20melody%2C%20the%20vocal%20range%20%28%20%24%20L%20%24%20and%20%24%20R%20%24%20%29%2C%20and%20the%20maximum%20difference%20between%20two%20successive%20notes%20in%20the%20new%20melody%2C%20respectively.%20The%20next%20line%20contains%20%24%20N%20%24%20integers%3A%20%24%20A_i%20%24%20%28%20%24%201%20%5C%5Cle%20A_i%20%5C%5Cle%2010%5E9%20%24%20%29%20representing%20the%20original%20melody.%22%2C%22outputFormat%22%3A%22Output%20in%20a%20line%20%24%20N%20%24%20integers%20%28each%20separated%20by%20a%20single%20space%29%20representing%20the%20lexicographically%20smallest%20melody%20satisfying%20all%20the%20requirements%2C%20or%20output%20-1%20if%20there%20is%20no%20melody%20satisfying%20all%20the%20requirements.%20Note%20that%20it%20might%20be%20possible%20that%20the%20lexicographically%20smallest%20melody%20which%20satisfies%20all%20the%20requirements%20to%20be%20the%20same%20as%20the%20original%20melody.%22%2C%22samples%22%3A%5B%5B%22%5Cn16%201%208%206%5Cn1%203%205%206%207%208%209%2010%203%207%208%209%2010%2011%2012%2012%5Cn%22%2C%22%5Cn1%202%203%204%205%206%207%208%202%203%204%205%206%207%208%208%5Cn%22%5D%2C%5B%22%5Cn16%201%208%206%5Cn1%203%205%206%207%208%209%2010%203%207%208%209%2010%2011%2012%2013%5Cn%22%2C%22%5Cn-1%5Cn%22%5D%2C%5B%22%5Cn16%201%2010%2010%5Cn1%203%205%206%207%208%209%2010%203%207%208%209%201%2011%2012%2013%5Cn%22%2C%22%5Cn1%202%203%204%205%206%207%208%201%202%203%204%201%202%203%204%5Cn%22%5D%5D%2C%22hint%22%3A%22Explanation%20for%20the%20sample%20input%5C%2Foutput%20%231%5Cn%5CnThis%20is%20the%20example%20from%20the%20problem%20description.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F1252%5C%2FE%22%2C%22id%22%3A%221252E%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A1%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22CF1252E%22%2C%22title%22%3A%22Songwriter%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Songwriter%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Songwriter</h1>
<h2>题目描述</h2>
<div>Andi is a mathematician, a computer scientist, and a songwriter. After spending so much time writing songs, he finally writes a catchy melody that he thought as his best creation. However, the singer who will sing the song/melody has a unique vocal range, thus, an adjustment may be needed.
A melody is defined as a sequence of $ N $ notes which are represented by integers. Let $ A $ be the original melody written by Andi. Andi needs to adjust $ A $ into a new melody $ B $ such that for every $ i $ where $ 1 \le i < N $ :
- If $ A_i < A_{i+1} $ , then $ B_i < B_{i+1} $ .
- If $ A_i = A_{i+1} $ , then $ B_i = B_{i+1} $ .
- If $ A_i > A_{i+1} $ , then $ B_i > B_{i+1} $ .
- $ |B_i - B_{i+1}| \le K $ , i.e. the difference between two successive notes is no larger than $ K $ .
Moreover, the singer also requires that all notes are within her vocal range, i.e. $ L \le B_i \le R $ for all $ 1 \le i \le N $ .Help Andi to determine whether such $ B $ exists, and find the lexicographically smallest $ B $ if it exists. A melody $ X $ is lexicographically smaller than melody $ Y $ if and only if there exists $ j $ ( $ 1 \le j \le N $ ) such that $ X_i = Y_i $ for all $ i < j $ and $ X_{j} < Y_{j} $ .
For example, consider a melody $ A = \{1,3,5,6,7,8,9,10,3,7,8,9,10,11,12,12\} $ as shown in the following figure. The diagonal arrow up in the figure implies that $ A_i < A_{i+1} $ , the straight right arrow implies that $ A_i = A_{i+1} $ , and the diagonal arrow down implies that $ A_i > A_{i+1} $ .
![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1252E/e498d7b4f78632de9fe4f587d3c868951b8bb1a9.png)Supposed we want to make a new melody with $ L = 1 $ , $ R = 8 $ , and $ K = 6 $ . The new melody $ B = \{1,2,3,4,5,6,7,8,2,3,4,5,6,7,8,8\} $ as shown in the figure satisfies all the requirements, and it is the lexicographically smallest possible.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>Input begins with a line containing four integers: $ N $ $ L $ $ R $ $ K $ ( $ 1 \le N \le 100\,000 $ ; $ 1 \le L \le R \le 10^9 $ ; $ 1 \le K \le 10^9 $ ) representing the number of notes in the melody, the vocal range ( $ L $ and $ R $ ), and the maximum difference between two successive notes in the new melody, respectively. The next line contains $ N $ integers: $ A_i $ ( $ 1 \le A_i \le 10^9 $ ) representing the original melody.</div>
<h3>输出格式</h3>
<br />
<div>Output in a line $ N $ integers (each separated by a single space) representing the lexicographically smallest melody satisfying all the requirements, or output -1 if there is no melody satisfying all the requirements. Note that it might be possible that the lexicographically smallest melody which satisfies all the requirements to be the same as the original melody.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>
16 1 8 6
1 3 5 6 7 8 9 10 3 7 8 9 10 11 12 12
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>
1 2 3 4 5 6 7 8 2 3 4 5 6 7 8 8
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>
16 1 8 6
1 3 5 6 7 8 9 10 3 7 8 9 10 11 12 13
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>
-1
</code></pre>
<h3>输入样例 #3</h3>
<pre><code>
16 1 10 10
1 3 5 6 7 8 9 10 3 7 8 9 1 11 12 13
</code></pre>
<h3>输出样例 #3</h3>
<pre><code>
1 2 3 4 5 6 7 8 1 2 3 4 1 2 3 4
</code></pre>
<h2>说明</h2>
<div>Explanation for the sample input/output #1
This is the example from the problem description.</div>
</article>
</div>
</div>
</body>
</html>
