<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Kay and Snowflake - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573396655:CMLQA4/JAWB2k4R/qFN3oH2pPLTZ28S9OnSOHG8IEiQ=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%22%2C%22description%22%3A%22After%20the%20piece%20of%20a%20devilish%20mirror%20hit%20the%20Kay%27s%20eye%2C%20he%20is%20no%20longer%20interested%20in%20the%20beauty%20of%20the%20roses.%20Now%20he%20likes%20to%20watch%20snowflakes.%5Cn%5CnOnce%20upon%20a%20time%2C%20he%20found%20a%20huge%20snowflake%20that%20has%20a%20form%20of%20the%20tree%20%28connected%20acyclic%20graph%29%20consisting%20of%20%24%20n%20%24%20nodes.%20The%20root%20of%20tree%20has%20index%20%24%201%20%24%20.%20Kay%20is%20very%20interested%20in%20the%20structure%20of%20this%20tree.%5Cn%5CnAfter%20doing%20some%20research%20he%20formed%20%24%20q%20%24%20queries%20he%20is%20interested%20in.%20The%20%24%20i%20%24%20-th%20query%20asks%20to%20find%20a%20centroid%20of%20the%20subtree%20of%20the%20node%20%24%20v_%7Bi%7D%20%24%20.%20Your%20goal%20is%20to%20answer%20all%20queries.%5Cn%5CnSubtree%20of%20a%20node%20is%20a%20part%20of%20tree%20consisting%20of%20this%20node%20and%20all%20it%27s%20descendants%20%28direct%20or%20not%29.%20In%20other%20words%2C%20subtree%20of%20node%20%24%20v%20%24%20is%20formed%20by%20nodes%20%24%20u%20%24%20%2C%20such%20that%20node%20%24%20v%20%24%20is%20present%20on%20the%20path%20from%20%24%20u%20%24%20to%20root.%5Cn%5CnCentroid%20of%20a%20tree%20%28or%20a%20subtree%29%20is%20a%20node%2C%20such%20that%20if%20we%20erase%20it%20from%20the%20tree%2C%20the%20maximum%20size%20of%20the%20connected%20component%20will%20be%20at%20least%20two%20times%20smaller%20than%20the%20size%20of%20the%20initial%20tree%20%28or%20a%20subtree%29.%22%2C%22inputFormat%22%3A%22The%20first%20line%20of%20the%20input%20contains%20two%20integers%20%24%20n%20%24%20and%20%24%20q%20%24%20%28%20%24%202%3C%3Dn%3C%3D300000%20%24%20%2C%20%24%201%3C%3Dq%3C%3D300000%20%24%20%29%20%5Cu2014%20the%20size%20of%20the%20initial%20tree%20and%20the%20number%20of%20queries%20respectively.%5Cn%5CnThe%20second%20line%20contains%20%24%20n-1%20%24%20integer%20%24%20p_%7B2%7D%2Cp_%7B3%7D%2C...%2Cp_%7Bn%7D%20%24%20%28%20%24%201%3C%3Dp_%7Bi%7D%3C%3Dn%20%24%20%29%20%5Cu2014%20the%20indices%20of%20the%20parents%20of%20the%20nodes%20from%20%24%202%20%24%20to%20%24%20n%20%24%20.%20Node%20%24%201%20%24%20is%20a%20root%20of%20the%20tree.%20It%27s%20guaranteed%20that%20%24%20p_%7Bi%7D%20%24%20define%20a%20correct%20tree.%5Cn%5CnEach%20of%20the%20following%20%24%20q%20%24%20lines%20contain%20a%20single%20integer%20%24%20v_%7Bi%7D%20%24%20%28%20%24%201%3C%3Dv_%7Bi%7D%3C%3Dn%20%24%20%29%20%5Cu2014%20the%20index%20of%20the%20node%2C%20that%20define%20the%20subtree%2C%20for%20which%20we%20want%20to%20find%20a%20centroid.%22%2C%22outputFormat%22%3A%22For%20each%20query%20print%20the%20index%20of%20a%20centroid%20of%20the%20corresponding%20subtree.%20If%20there%20are%20many%20suitable%20nodes%2C%20print%20any%20of%20them.%20It%27s%20guaranteed%2C%20that%20each%20subtree%20has%20at%20least%20one%20centroid.%22%2C%22samples%22%3A%5B%5B%227%204%5Cn1%201%203%203%205%203%5Cn1%5Cn2%5Cn3%5Cn5%5Cn%22%2C%223%5Cn2%5Cn3%5Cn6%5Cn%22%5D%5D%2C%22hint%22%3A%22%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF685B%5C%2F821209b858c843715556bbbb66f001612969fa03.png%29The%20first%20query%20asks%20for%20a%20centroid%20of%20the%20whole%20tree%20%5Cu2014%20this%20is%20node%20%24%203%20%24%20.%20If%20we%20delete%20node%20%24%203%20%24%20the%20tree%20will%20split%20in%20four%20components%2C%20two%20of%20size%20%24%201%20%24%20and%20two%20of%20size%20%24%202%20%24%20.%5Cn%5CnThe%20subtree%20of%20the%20second%20node%20consists%20of%20this%20node%20only%2C%20so%20the%20answer%20is%20%24%202%20%24%20.%5Cn%5CnNode%20%24%203%20%24%20is%20centroid%20of%20its%20own%20subtree.%5Cn%5CnThe%20centroids%20of%20the%20subtree%20of%20the%20node%20%24%205%20%24%20are%20nodes%20%24%205%20%24%20and%20%24%206%20%24%20%5Cu2014%20both%20answers%20are%20considered%20correct.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B3000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F685%5C%2FB%22%2C%22id%22%3A%22685B%22%7D%2C%22translation%22%3A%22%5Cu8f93%5Cu5165%5Cu4e00%5Cu68f5%5Cu6811%2C%5Cu5224%5Cu65ad%5Cu6bcf%5Cu4e00%5Cu68f5%5Cu5b50%5Cu6811%5Cu7684%5Cu91cd%5Cu5fc3%5Cu662f%5Cu54ea%5Cu4e00%5Cu4e2a%5Cu8282%5Cu70b9.%22%2C%22tags%22%3A%5B111%2C127%2C314%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A408%2C%22totalAccepted%22%3A211%2C%22pid%22%3A%22CF685B%22%2C%22title%22%3A%22Kay%20and%20Snowflake%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A33737%2C%22title%22%3A%22%5Cu7ffb%5Cu8bd1%22%2C%22forum%22%3A%7B%22id%22%3A9906%2C%22name%22%3A%22CF685B%20Kay%20and%20Snowflake%22%2C%22slug%22%3A%22CF685B%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22CF842C%22%2C%22title%22%3A%22Ilya%20And%20The%20Tree%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF813C%22%2C%22title%22%3A%22The%20Tag%20Game%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF739B%22%2C%22title%22%3A%22Alyona%20and%20a%20tree%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF700B%22%2C%22title%22%3A%22Connecting%20Universities%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF682C%22%2C%22title%22%3A%22Alyona%20and%20the%20Tree%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Kay%20and%20Snowflake%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573306449;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Kay and Snowflake</h1>
<h2>题意翻译</h2>
<div>输入一棵树,判断每一棵子树的重心是哪一个节点.</div>
<h2>题目描述</h2>
<div>After the piece of a devilish mirror hit the Kay's eye, he is no longer interested in the beauty of the roses. Now he likes to watch snowflakes.
Once upon a time, he found a huge snowflake that has a form of the tree (connected acyclic graph) consisting of $ n $ nodes. The root of tree has index $ 1 $ . Kay is very interested in the structure of this tree.
After doing some research he formed $ q $ queries he is interested in. The $ i $ -th query asks to find a centroid of the subtree of the node $ v_{i} $ . Your goal is to answer all queries.
Subtree of a node is a part of tree consisting of this node and all it's descendants (direct or not). In other words, subtree of node $ v $ is formed by nodes $ u $ , such that node $ v $ is present on the path from $ u $ to root.
Centroid of a tree (or a subtree) is a node, such that if we erase it from the tree, the maximum size of the connected component will be at least two times smaller than the size of the initial tree (or a subtree).</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line of the input contains two integers $ n $ and $ q $ ( $ 2<=n<=300000 $ , $ 1<=q<=300000 $ ) — the size of the initial tree and the number of queries respectively.
The second line contains $ n-1 $ integer $ p_{2},p_{3},...,p_{n} $ ( $ 1<=p_{i}<=n $ ) — the indices of the parents of the nodes from $ 2 $ to $ n $ . Node $ 1 $ is a root of the tree. It's guaranteed that $ p_{i} $ define a correct tree.
Each of the following $ q $ lines contain a single integer $ v_{i} $ ( $ 1<=v_{i}<=n $ ) — the index of the node, that define the subtree, for which we want to find a centroid.</div>
<h3>输出格式</h3>
<br />
<div>For each query print the index of a centroid of the corresponding subtree. If there are many suitable nodes, print any of them. It's guaranteed, that each subtree has at least one centroid.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>7 4
1 1 3 3 5 3
1
2
3
5
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>3
2
3
6
</code></pre>
<h2>说明</h2>
<div> ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF685B/821209b858c843715556bbbb66f001612969fa03.png)The first query asks for a centroid of the whole tree — this is node $ 3 $ . If we delete node $ 3 $ the tree will split in four components, two of size $ 1 $ and two of size $ 2 $ .
The subtree of the second node consists of this node only, so the answer is $ 2 $ .
Node $ 3 $ is centroid of its own subtree.
The centroids of the subtree of the node $ 5 $ are nodes $ 5 $ and $ 6 $ — both answers are considered correct.</div>
</article>
</div>
</div>
</body>
</html>
