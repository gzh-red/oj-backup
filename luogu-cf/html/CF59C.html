<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Title - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573390417:wp2nJ+DMH03vF+JZMJkL0snUJpa4Vu0bKrtbbtjohZQ=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%22%2C%22description%22%3A%22Vasya%20has%20recently%20finished%20writing%20a%20book.%20Now%20he%20faces%20the%20problem%20of%20giving%20it%20the%20title.%20Vasya%20wants%20the%20title%20to%20be%20vague%20and%20mysterious%20for%20his%20book%20to%20be%20noticeable%20among%20others.%20That%27s%20why%20the%20title%20should%20be%20represented%20by%20a%20single%20word%20containing%20at%20least%20once%20each%20of%20the%20first%20%24%20k%20%24%20Latin%20letters%20and%20not%20containing%20any%20other%20ones.%20Also%2C%20the%20title%20should%20be%20a%20palindrome%2C%20that%20is%20it%20should%20be%20read%20similarly%20from%20the%20left%20to%20the%20right%20and%20from%20the%20right%20to%20the%20left.%5Cn%5CnVasya%20has%20already%20composed%20the%20approximate%20variant%20of%20the%20title.%20You%20are%20given%20the%20title%20template%20%24%20s%20%24%20consisting%20of%20lowercase%20Latin%20letters%20and%20question%20marks.%20Your%20task%20is%20to%20replace%20all%20the%20question%20marks%20by%20lowercase%20Latin%20letters%20so%20that%20the%20resulting%20word%20satisfies%20the%20requirements%2C%20described%20above.%20Each%20question%20mark%20should%20be%20replaced%20by%20exactly%20one%20letter%2C%20it%20is%20not%20allowed%20to%20delete%20characters%20or%20add%20new%20ones%20to%20the%20template.%20If%20there%20are%20several%20suitable%20titles%2C%20choose%20the%20first%20in%20the%20alphabetical%20order%2C%20for%20Vasya%27s%20book%20to%20appear%20as%20early%20as%20possible%20in%20all%20the%20catalogues.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20an%20integer%20%24%20k%20%24%20%28%20%24%201%3C%3Dk%3C%3D26%20%24%20%29%20which%20is%20the%20number%20of%20allowed%20alphabet%20letters.%20The%20second%20line%20contains%20%24%20s%20%24%20which%20is%20the%20given%20template.%20In%20%24%20s%20%24%20only%20the%20first%20%24%20k%20%24%20lowercase%20letters%20of%20Latin%20alphabet%20and%20question%20marks%20can%20be%20present%2C%20the%20length%20of%20%24%20s%20%24%20is%20from%201%20to%20100%20characters%20inclusively.%22%2C%22outputFormat%22%3A%22If%20there%20is%20no%20solution%2C%20print%20IMPOSSIBLE.%20Otherwise%2C%20a%20single%20line%20should%20contain%20the%20required%20title%2C%20satisfying%20the%20given%20template.%20The%20title%20should%20be%20a%20palindrome%20and%20it%20can%20only%20contain%20the%20first%20%24%20k%20%24%20letters%20of%20the%20Latin%20alphabet.%20At%20that%2C%20each%20of%20those%20%24%20k%20%24%20letters%20must%20be%20present%20at%20least%20once.%20If%20there%20are%20several%20suitable%20titles%2C%20print%20the%20lexicographically%20minimal%20one.%5Cn%5CnThe%20lexicographical%20comparison%20is%20performed%20by%20the%20standard%20%3C%20operator%20in%20modern%20programming%20languages.%20The%20line%20%24%20a%20%24%20is%20lexicographically%20smaller%20than%20the%20line%20%24%20b%20%24%20%2C%20if%20exists%20such%20an%20%24%20i%20%24%20%28%20%24%201%3C%3Di%3C%3D%7Cs%7C%20%24%20%29%2C%20that%20%24%20a_%7Bi%7D%20%3C%20b_%7Bi%7D%20%24%20%2C%20and%20for%20any%20%24%20j%20%24%20%28%20%24%201%3C%3Dj%3Ci%20%24%20%29%20%24%20a_%7Bj%7D%3Db_%7Bj%7D%20%24%20.%20%24%20%7Cs%7C%20%24%20stands%20for%20the%20length%20of%20the%20given%20template.%22%2C%22samples%22%3A%5B%5B%223%5Cna%3Fc%5Cn%22%2C%22IMPOSSIBLE%5Cn%22%5D%2C%5B%222%5Cna%3F%3Fa%5Cn%22%2C%22abba%5Cn%22%5D%2C%5B%222%5Cn%3Fb%3Fa%5Cn%22%2C%22abba%5Cn%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F59%5C%2FC%22%2C%22id%22%3A%2259C%22%7D%2C%22translation%22%3A%22%5Cu9898%5Cu76ee%5Cu63cf%5Cu8ff0%5CnVasya%5Cu6700%5Cu8fd1%5Cu5199%5Cu5b8c%5Cu4e86%5Cu4e00%5Cu672c%5Cu4e66%5Cu3002%5Cu73b0%5Cu5728%5Cu4ed6%5Cu9762%5Cu4e34%5Cu7740%5Cu7ed9%5Cu8fd9%5Cu672c%5Cu4e66%5Cu53d6%5Cu4e00%5Cu4e2a%5Cu9898%5Cu76ee%5Cu7684%5Cu95ee%5Cu9898%5Cu3002Vasya%5Cu5e0c%5Cu671b%5Cu8fd9%5Cu672c%5Cu4e66%5Cu7684%5Cu6807%5Cu9898%5Cu662f%5Cu542b%5Cu7cca%5Cu800c%5Cu795e%5Cu79d8%5Cu7684%5Cuff0c%5Cu6765%5Cu4f7f%5Cu4ed6%5Cu7684%5Cu4e66%5Cu5f15%5Cu4eba%5Cu6ce8%5Cu76ee%5Cu3002%5Cu8fd9%5Cu5c31%5Cu662f%5Cu4e3a%5Cu4ec0%5Cu4e48%5Cu6807%5Cu9898%5Cu5e94%5Cu8be5%5Cu7528%5Cu81f3%5Cu5c11k%5Cu4e2a%5Cu5b57%5Cu6bcd%5Cu4e2d%5Cu7684%5Cu4e00%5Cu4e2a%5Cu6765%5Cu8868%5Cu793a%5Cuff0c%5Cu800c%5Cu4e0d%5Cu5305%5Cu542b%5Cu4efb%5Cu4f55%5Cu5176%5Cu4ed6%5Cu7684%5Cu5b57%5Cu6bcd%5Cu3002%5Cu6b64%5Cu5916%5Cuff0c%5Cu6807%5Cu9898%5Cu5e94%5Cu8be5%5Cu662f%5Cu4e00%5Cu4e2a%5Cu56de%5Cu6587%5Cuff0c%5Cu4e5f%5Cu5c31%5Cu662f%5Cu8bf4%5Cuff0c%5Cu6807%5Cu9898%5Cu4ece%5Cu5de6%5Cu5230%5Cu53f3%5Cuff0c%5Cu4ece%5Cu53f3%5Cu5230%5Cu5de6%5Cu6765%5Cu8bfb%5Cu662f%5Cu4e00%5Cu6837%5Cu7684%5Cu3002%5CnVasya%5Cu5df2%5Cu7ecf%5Cu5199%5Cu4e0b%5Cu4e86%5Cu6807%5Cu9898%5Cu7684%5Cu8fd1%5Cu4f3c%5Cu53d8%5Cu4f53%5Cu6a21%5Cu677f%5Cu3002%5Cu4f60%5Cu5f97%5Cu5230%5Cu7684%5Cu6807%5Cu9898%5Cu6a21%5Cu677f%5Cu7531%5Cu5c0f%5Cu5199%5Cu5b57%5Cu6bcd%5Cu548c%5Cu95ee%5Cu53f7%5Cu7ec4%5Cu6210%5Cu3002%5Cu4f60%5Cu7684%5Cu4efb%5Cu52a1%5Cu662f%5Cu7528%5Cu5c0f%5Cu5199%5Cu5b57%5Cu6bcd%5Cu66ff%5Cu6362%5Cu6240%5Cu6709%5Cu7684%5Cu95ee%5Cu53f7%5Cuff0c%5Cu4ee5%5Cu4f7f%5Cu5f97%5Cu7ed3%5Cu679c%5Cu7b26%5Cu5408%5Cu4e0a%5Cu8ff0%5Cu8981%5Cu6c42%5Cu3002%5Cu6bcf%5Cu4e2a%5Cu95ee%5Cu53f7%5Cu5e94%5Cu8be5%5Cu7531%5Cu4e00%5Cu4e2a%5Cu5b57%5Cu6bcd%5Cu66ff%5Cu6362%5Cuff0c%5Cu4e0d%5Cu5141%5Cu8bb8%5Cu5220%5Cu9664%5Cu5b57%5Cu7b26%5Cu6216%5Cu8005%5Cu6dfb%5Cu52a0%5Cu65b0%5Cu7684%5Cu5b57%5Cu7b26%5Cu3002%5Cu5982%5Cu679c%5Cu6709%5Cu51e0%5Cu4e2a%5Cu5408%5Cu9002%5Cu7684%5Cu6807%5Cu9898%5Cuff0c%5Cu9009%5Cu62e9%5Cu5b57%5Cu5178%5Cu5e8f%5Cu6700%5Cu5c0f%5Cu7684%5Cu6807%5Cu9898%5Cuff0c%5Cu5e2e%5Cu52a9Vasya%5Cu5c3d%5Cu53ef%5Cu80fd%5Cu65e9%5Cu5730%5Cu60f3%5Cu51fa%5Cu6807%5Cu9898%5Cu3002%5Cn%5Cu8f93%5Cu5165%5Cu8f93%5Cu51fa%5Cu683c%5Cu5f0f%5Cn%5Cu8f93%5Cu5165%5Cu683c%5Cu5f0f%5Cuff1a%5Cn%5Cu7b2c%5Cu4e00%5Cu884c%5Cu5305%5Cu542b%5Cu4e00%5Cu4e2a%5Cu6574%5Cu6570%20k%5Cuff081%20%5Cu2264%20K%20%5Cu2264%2026%5Cuff09%5Cuff0c%5Cu8fd9%5Cu662f%5Cu5141%5Cu8bb8%5Cu7684%5Cu5b57%5Cu6bcd%5Cu7684%5Cu6570%5Cu91cf%5Cuff08%5Cu8bd1%5Cu6ce8%5Cuff1a%5Cu5982k%3D2%5Cuff0c%5Cu53ea%5Cu6709%5Cu5b57%5Cu6bcda%5Cu548cb%5Cu53ef%5Cu4ee5%5Cu5b58%5Cu5728%5Cuff09%5Cu3002%5Cu7b2c%5Cu4e8c%5Cu884c%5Cu662f%5Cu7ed9%5Cu5b9a%5Cu7684%5Cu6807%5Cu9898%5Cu6a21%5Cu677fs%5Cuff0c%5Cu5728s%5Cu4e2d%5Cu53ea%5Cu80fd%5Cu6709%5Cu524dk%5Cu4e2a%5Cu5c0f%5Cu5199%5Cu5b57%5Cu6bcd%5Cu548c%5Cu95ee%5Cu53f7%5Cu51fa%5Cu73b0%5Cuff0cs%5Cu7684%5Cu957f%5Cu5ea6%5Cu53ef%5Cu80fd%5Cu5305%5Cu542b1%5Cu5230100%5Cu4e2a%5Cu5b57%5Cu7b26%5Cu3002%5Cn%5Cu8f93%5Cu51fa%5Cu683c%5Cu5f0f%5Cuff1a%5Cn%5Cu5982%5Cu679c%5Cu6ca1%5Cu6709%5Cu89e3%5Cu5219%5Cu8f93%5Cu51fa%5Cu201cIMPOSSIBLE%5Cu201d%5Cu3002%5Cu5426%5Cu5219%5Cuff0c%5Cu8f93%5Cu51fa%5Cu4e00%5Cu884c%5Cu4e3a%5Cu6240%5Cu9700%5Cu7684%5Cu6807%5Cu9898%5Cuff0c%5Cu6ee1%5Cu8db3%5Cu7ed9%5Cu5b9a%5Cu7684%5Cu6a21%5Cu677f%5Cu3002%5Cu6807%5Cu9898%5Cu5e94%5Cu8be5%5Cu662f%5Cu4e00%5Cu4e2a%5Cu56de%5Cu6587%5Cuff0c%5Cu5b83%5Cu53ea%5Cu80fd%5Cu5305%5Cu542b%5Cu5b57%5Cu6bcd%5Cu8868%5Cu7684%5Cu524dk%5Cu4e2a%5Cu5b57%5Cu6bcd%5Cu3002%5Cu8fd9%5Cu6837%5Cuff0c%5Cu8fd9k%5Cu4e2a%5Cu5b57%5Cu6bcd%5Cu4e2d%5Cu7684%5Cu6bcf%5Cu4e00%5Cu4e2a%5Cu81f3%5Cu5c11%5Cu5fc5%5Cu987b%5Cu51fa%5Cu73b0%5Cu4e00%5Cu6b21%5Cu3002%5Cu5982%5Cu679c%5Cu6709%5Cu51e0%5Cu4e2a%5Cu5408%5Cu9002%5Cu7684%5Cu6807%5Cu9898%5Cuff0c%5Cu6253%5Cu5370%5Cu5b57%5Cu5178%5Cu5e8f%5Cu6700%5Cu5c0f%5Cu7684%5Cu4e00%5Cu4e2a%5Cu3002%5Cn%5Cu8bcd%5Cu5178%5Cu7684%5Cu6bd4%5Cu8f83%5Cu662f%5Cu5728%5Cu73b0%5Cu4ee3%5Cu7f16%5Cu7a0b%5Cu8bed%5Cu8a00%5Cu6807%5Cu51c6%5Cu7684%3C%5Cu64cd%5Cu4f5c%5Cu7b26%5Cuff08%5Cu5c0f%5Cu4e8e%5Cuff09%5Cu8fdb%5Cu884c%5Cu3002a%5Cu5728%5Cu5b57%5Cu5178%5Cu5e8f%5Cu4e0a%5Cu5c0f%5Cu4e8eb%5Cuff0c%5Cu5982%5Cu679c%5Cu5b58%5Cu5728i%20%5Cuff08%201%5Cu2264i%5Cu2264%7Cs%7C%5Cuff09%5Cuff0c%5Cu90a3%5Cu4e48ai%5Cuff1cbi%5Cuff0c%5Cu5bf9%5Cu4e8e%5Cu4efb%5Cu4f55%5Cu7684j%20%5Cuff08%201%5Cu2264j%5Cuff1ci%5Cuff09%5Cuff0caj%3Dbj%5Cuff0c%5Cu5176%5Cu4e2d%7Cs%7C%5Cu4e3a%5Cu7ed9%5Cu5b9a%5Cu7684%5Cu6a21%5Cu677f%5Cu7684%5Cu957f%5Cu5ea6%5Cu3002%5Cn%5Cn%5Cu611f%5Cu8c22%40MarshalKen%20%5Cu63d0%5Cu4f9b%5Cu7684%5Cu7ffb%5Cu8bd1%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A33%2C%22totalAccepted%22%3A13%2C%22pid%22%3A%22CF59C%22%2C%22title%22%3A%22Title%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A32893%2C%22title%22%3A%22CF59C%20Title%20%5Cu7ffb%5Cu8bd1%22%2C%22forum%22%3A%7B%22id%22%3A12403%2C%22name%22%3A%22CF59C%20Title%22%2C%22slug%22%3A%22CF59C%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Title%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Title</h1>
<h2>题意翻译</h2>
<div>题目描述
Vasya最近写完了一本书。现在他面临着给这本书取一个题目的问题。Vasya希望这本书的标题是含糊而神秘的，来使他的书引人注目。这就是为什么标题应该用至少k个字母中的一个来表示，而不包含任何其他的字母。此外，标题应该是一个回文，也就是说，标题从左到右，从右到左来读是一样的。
Vasya已经写下了标题的近似变体模板。你得到的标题模板由小写字母和问号组成。你的任务是用小写字母替换所有的问号，以使得结果符合上述要求。每个问号应该由一个字母替换，不允许删除字符或者添加新的字符。如果有几个合适的标题，选择字典序最小的标题，帮助Vasya尽可能早地想出标题。
输入输出格式
输入格式：
第一行包含一个整数 k（1 ≤ K ≤ 26），这是允许的字母的数量（译注：如k=2，只有字母a和b可以存在）。第二行是给定的标题模板s，在s中只能有前k个小写字母和问号出现，s的长度可能包含1到100个字符。
输出格式：
如果没有解则输出“IMPOSSIBLE”。否则，输出一行为所需的标题，满足给定的模板。标题应该是一个回文，它只能包含字母表的前k个字母。这样，这k个字母中的每一个至少必须出现一次。如果有几个合适的标题，打印字典序最小的一个。
词典的比较是在现代编程语言标准的<操作符（小于）进行。a在字典序上小于b，如果存在i （ 1≤i≤|s|），那么ai＜bi，对于任何的j （ 1≤j＜i），aj=bj，其中|s|为给定的模板的长度。
感谢@MarshalKen 提供的翻译</div>
<h2>题目描述</h2>
<div>Vasya has recently finished writing a book. Now he faces the problem of giving it the title. Vasya wants the title to be vague and mysterious for his book to be noticeable among others. That's why the title should be represented by a single word containing at least once each of the first $ k $ Latin letters and not containing any other ones. Also, the title should be a palindrome, that is it should be read similarly from the left to the right and from the right to the left.
Vasya has already composed the approximate variant of the title. You are given the title template $ s $ consisting of lowercase Latin letters and question marks. Your task is to replace all the question marks by lowercase Latin letters so that the resulting word satisfies the requirements, described above. Each question mark should be replaced by exactly one letter, it is not allowed to delete characters or add new ones to the template. If there are several suitable titles, choose the first in the alphabetical order, for Vasya's book to appear as early as possible in all the catalogues.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains an integer $ k $ ( $ 1<=k<=26 $ ) which is the number of allowed alphabet letters. The second line contains $ s $ which is the given template. In $ s $ only the first $ k $ lowercase letters of Latin alphabet and question marks can be present, the length of $ s $ is from 1 to 100 characters inclusively.</div>
<h3>输出格式</h3>
<br />
<div>If there is no solution, print IMPOSSIBLE. Otherwise, a single line should contain the required title, satisfying the given template. The title should be a palindrome and it can only contain the first $ k $ letters of the Latin alphabet. At that, each of those $ k $ letters must be present at least once. If there are several suitable titles, print the lexicographically minimal one.
The lexicographical comparison is performed by the standard < operator in modern programming languages. The line $ a $ is lexicographically smaller than the line $ b $ , if exists such an $ i $ ( $ 1<=i<=|s| $ ), that $ a_{i} < b_{i} $ , and for any $ j $ ( $ 1<=j<i $ ) $ a_{j}=b_{j} $ . $ |s| $ stands for the length of the given template.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>3
a?c
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>IMPOSSIBLE
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>2
a??a
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>abba
</code></pre>
<h3>输入样例 #3</h3>
<pre><code>2
?b?a
</code></pre>
<h3>输出样例 #3</h3>
<pre><code>abba
</code></pre>
</article>
</div>
</div>
</body>
</html>
