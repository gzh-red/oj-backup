<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Speckled Band - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573400923:qjsJdFWwex1vT4PD4QghxsIs/OJTWYOEVzrjegq9GQs=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Ildar%20took%20a%20band%20%28a%20thin%20strip%20of%20cloth%29%20and%20colored%20it.%20Formally%2C%20the%20band%20has%20%24%20n%20%24%20cells%2C%20each%20of%20them%20is%20colored%20into%20one%20of%20%24%2026%20%24%20colors%2C%20so%20we%20can%20denote%20each%20color%20with%20one%20of%20the%20lowercase%20letters%20of%20English%20alphabet.%5Cn%5CnIldar%20decided%20to%20take%20some%20segment%20of%20the%20band%20%24%20%5Bl%2C%20r%5D%20%24%20%28%20%24%201%20%5C%5Cle%20l%20%5C%5Cle%20r%20%5C%5Cle%20n%20%24%20%29%20he%20likes%20and%20cut%20it%20from%20the%20band.%20So%20he%20will%20create%20a%20new%20band%20that%20can%20be%20represented%20as%20a%20string%20%24%20t%20%3D%20s_l%20s_%7Bl%2B1%7D%20%5C%5Cldots%20s_r%20%24%20.%5Cn%5CnAfter%20that%20Ildar%20will%20play%20the%20following%20game%3A%20he%20cuts%20the%20band%20%24%20t%20%24%20into%20some%20new%20bands%20and%20counts%20the%20number%20of%20different%20bands%20among%20them.%20Formally%2C%20Ildar%20chooses%20%24%201%20%5C%5Cle%20k%20%5C%5Cle%20%7Ct%7C%20%24%20indexes%20%24%201%20%5C%5Cle%20i_1%20%3C%20i_2%20%3C%20%5C%5Cldots%20%3C%20i_k%20%3D%20%7Ct%7C%20%24%20and%20cuts%20%24%20t%20%24%20to%20%24%20k%20%24%20bands-strings%20%24%20t_1%20t_2%20%5C%5Cldots%20t_%7Bi_1%7D%2C%20t_%7Bi_1%20%2B%201%7D%20%5C%5Cldots%20t_%7Bi_2%7D%2C%20%5C%5Cldots%2C%20%7Bt_%7Bi_%7Bk-1%7D%20%2B%201%7D%7D%20%5C%5Cldots%20t_%7Bi_k%7D%20%24%20and%20counts%20the%20number%20of%20different%20bands%20among%20them.%20He%20wants%20to%20know%20the%20minimal%20possible%20number%20of%20different%20bands%20he%20can%20get%20under%20the%20constraint%20that%20at%20least%20one%20band%20repeats%20at%20least%20two%20times.%20The%20result%20of%20the%20game%20is%20this%20number.%20If%20it%20is%20impossible%20to%20cut%20%24%20t%20%24%20in%20such%20a%20way%2C%20the%20result%20of%20the%20game%20is%20-1.%5Cn%5CnUnfortunately%20Ildar%20hasn%27t%20yet%20decided%20which%20segment%20he%20likes%2C%20but%20he%20has%20%24%20q%20%24%20segments-candidates%20%24%20%5Bl_1%2C%20r_1%5D%20%24%20%2C%20%24%20%5Bl_2%2C%20r_2%5D%20%24%20%2C%20...%2C%20%24%20%5Bl_q%2C%20r_q%5D%20%24%20.%20Your%20task%20is%20to%20calculate%20the%20result%20of%20the%20game%20for%20each%20of%20them.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20one%20integer%20%24%20n%20%24%20%28%20%24%201%20%5C%5Cle%20n%20%5C%5Cle%20200%5C%5C%2C000%20%24%20%29%20%5Cu2014%20the%20length%20of%20the%20band%20Ildar%20has.%5Cn%5CnThe%20second%20line%20contains%20a%20string%20%24%20s%20%24%20consisting%20of%20%24%20n%20%24%20lowercase%20English%20letters%20%5Cu2014%20the%20band%20Ildar%20has.%5Cn%5CnThe%20third%20line%20contains%20a%20single%20integer%20%24%20q%20%24%20%28%20%24%201%20%5C%5Cle%20q%20%5C%5Cle%20200%5C%5C%2C000%20%24%20%29%20%5Cu2014%20the%20number%20of%20segments%20Ildar%20has%20chosen%20as%20candidates.%5Cn%5CnEach%20of%20the%20next%20%24%20q%20%24%20lines%20contains%20two%20integer%20integers%20%24%20l_i%20%24%20and%20%24%20r_i%20%24%20%28%20%24%201%20%5C%5Cle%20l_i%20%5C%5Cle%20r_i%20%5C%5Cle%20n%20%24%20%29%20denoting%20the%20ends%20of%20the%20%24%20i%20%24%20-th%20segment.%22%2C%22outputFormat%22%3A%22Output%20%24%20q%20%24%20lines%2C%20where%20the%20%24%20i%20%24%20-th%20of%20them%20should%20contain%20the%20result%20of%20the%20game%20on%20the%20segment%20%24%20%5Bl_i%2C%20r_i%5D%20%24%20.%22%2C%22samples%22%3A%5B%5B%229%5Cnabcabcdce%5Cn7%5Cn1%206%5Cn4%207%5Cn5%209%5Cn6%209%5Cn1%209%5Cn3%206%5Cn4%204%5Cn%22%2C%221%5Cn-1%5Cn4%5Cn3%5Cn2%5Cn2%5Cn-1%5Cn%22%5D%5D%2C%22hint%22%3A%22Consider%20the%20first%20example.%5Cn%5CnIf%20Ildar%20chooses%20the%20segment%20%24%20%5B1%2C%206%5D%20%24%20%2C%20he%20cuts%20a%20string%20%24%20t%20%3D%20abcabc%20%24%20.%20If%20he%20cuts%20%24%20t%20%24%20into%20two%20bands%20%24%20abc%20%24%20and%20%24%20abc%20%24%20%2C%20the%20band%20%24%20abc%20%24%20repeats%20two%20times%20and%20the%20number%20of%20different%20tapes%20is%20%24%201%20%24%20.%20So%2C%20the%20result%20of%20this%20game%20is%20%24%201%20%24%20.%5Cn%5CnIf%20Ildar%20chooses%20the%20segment%20%24%20%5B4%2C%207%5D%20%24%20%2C%20he%20cuts%20a%20string%20%24%20t%20%3D%20abcd%20%24%20.%20It%20is%20impossible%20to%20cut%20this%20band%20in%20such%20a%20way%20that%20there%20is%20at%20least%20one%20band%20repeating%20at%20least%20two%20times.%20So%2C%20the%20result%20of%20this%20game%20is%20%24%20-1%20%24%20.%5Cn%5CnIf%20Ildar%20chooses%20the%20segment%20%24%20%5B3%2C%206%5D%20%24%20%2C%20he%20cuts%20a%20string%20%24%20t%20%3D%20cabc%20%24%20.%20If%20he%20cuts%20%24%20t%20%24%20into%20three%20bands%20%24%20c%20%24%20%2C%20%24%20ab%20%24%20and%20%24%20c%20%24%20%2C%20the%20band%20%24%20c%20%24%20repeats%20two%20times%20and%20the%20number%20of%20different%20bands%20is%20%24%202%20%24%20.%20So%2C%20the%20result%20of%20this%20game%20is%20%24%202%20%24%20.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B7000%5D%2C%22memory%22%3A%5B512000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F1043%5C%2FG%22%2C%22id%22%3A%221043G%22%7D%2C%22translation%22%3A%22%5Cu7ed9%5Cu4f60%5Cu4e00%5Cu4e2a%5Cu957f%5Cu4e3a%24n%24%5Cuff08%24n%3C%3D2%2A10%5E5%24%5Cuff09%5Cu7684%5Cu5c0f%5Cu5199%5Cu5b57%5Cu6bcd%5Cu5b57%5Cu7b26%5Cu4e32%24S%24%5Cuff0c%5Cu518d%5Cu7ed9%24q%24%5Cuff08%24q%3C%3D2%2A10%5E5%29%24%5Cu4e2a%5Cu8be2%5Cu95ee%5Cuff0c%5Cu6bcf%5Cu6b21%5Cu7ed9%5Cu4e00%5Cu4e2a%5Cu533a%5Cu95f4%24%5Bl%2Cr%5D%24%5Cuff0c%5Cu4f60%5Cu9700%5Cu8981%5Cu628a%24S%5Bl%2Cr%5D%24%5Cu8fd9%5Cu4e2a%5Cu5b50%5Cu4e32%5Cu5212%5Cu5206%5Cu6210%5Cu82e5%5Cu5e72%5Cu6bb5%5Cu4f7f%5Cu5f97%5Cu81f3%5Cu5c11%5Cu6709%5Cu4e24%5Cu4e2a%5Cu6bb5%5Cu662f%5Cu76f8%5Cu540c%5Cu7684%5Cuff0c%5Cu4f60%5Cu9700%5Cu8981%5Cu6784%5Cu9020%5Cu4e00%5Cu79cd%5Cu5206%5Cu6bb5%5Cu65b9%5Cu5f0f%5Cu4f7f%5Cu5f97%5Cu5212%5Cu5206%5Cu51fa%5Cu7684%5Cu6bb5%5Cu4e2d%2A%2A%5Cu672c%5Cu8d28%5Cu4e0d%5Cu540c%5Cu7684%5Cu6bb5%2A%2A%5Cu6700%5Cu5c11%5Cuff0c%5Cu4f60%5Cu53ea%5Cu8981%5Cu6c42%5Cu8fd9%5Cu4e2a%5Cu6700%5Cu5c0f%5Cu503c%5Cu3002%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A11%2C%22totalAccepted%22%3A1%2C%22pid%22%3A%22CF1043G%22%2C%22title%22%3A%22Speckled%20Band%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Speckled%20Band%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Speckled Band</h1>
<h2>题意翻译</h2>
<div>给你一个长为$n$（$n<=2*10^5$）的小写字母字符串$S$，再给$q$（$q<=2*10^5)$个询问，每次给一个区间$[l,r]$，你需要把$S[l,r]$这个子串划分成若干段使得至少有两个段是相同的，你需要构造一种分段方式使得划分出的段中**本质不同的段**最少，你只要求这个最小值。</div>
<h2>题目描述</h2>
<div>Ildar took a band (a thin strip of cloth) and colored it. Formally, the band has $ n $ cells, each of them is colored into one of $ 26 $ colors, so we can denote each color with one of the lowercase letters of English alphabet.
Ildar decided to take some segment of the band $ [l, r] $ ( $ 1 \le l \le r \le n $ ) he likes and cut it from the band. So he will create a new band that can be represented as a string $ t = s_l s_{l+1} \ldots s_r $ .
After that Ildar will play the following game: he cuts the band $ t $ into some new bands and counts the number of different bands among them. Formally, Ildar chooses $ 1 \le k \le |t| $ indexes $ 1 \le i_1 < i_2 < \ldots < i_k = |t| $ and cuts $ t $ to $ k $ bands-strings $ t_1 t_2 \ldots t_{i_1}, t_{i_1 + 1} \ldots t_{i_2}, \ldots, {t_{i_{k-1} + 1}} \ldots t_{i_k} $ and counts the number of different bands among them. He wants to know the minimal possible number of different bands he can get under the constraint that at least one band repeats at least two times. The result of the game is this number. If it is impossible to cut $ t $ in such a way, the result of the game is -1.
Unfortunately Ildar hasn't yet decided which segment he likes, but he has $ q $ segments-candidates $ [l_1, r_1] $ , $ [l_2, r_2] $ , ..., $ [l_q, r_q] $ . Your task is to calculate the result of the game for each of them.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains one integer $ n $ ( $ 1 \le n \le 200\,000 $ ) — the length of the band Ildar has.
The second line contains a string $ s $ consisting of $ n $ lowercase English letters — the band Ildar has.
The third line contains a single integer $ q $ ( $ 1 \le q \le 200\,000 $ ) — the number of segments Ildar has chosen as candidates.
Each of the next $ q $ lines contains two integer integers $ l_i $ and $ r_i $ ( $ 1 \le l_i \le r_i \le n $ ) denoting the ends of the $ i $ -th segment.</div>
<h3>输出格式</h3>
<br />
<div>Output $ q $ lines, where the $ i $ -th of them should contain the result of the game on the segment $ [l_i, r_i] $ .</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>9
abcabcdce
7
1 6
4 7
5 9
6 9
1 9
3 6
4 4
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>1
-1
4
3
2
2
-1
</code></pre>
<h2>说明</h2>
<div>Consider the first example.
If Ildar chooses the segment $ [1, 6] $ , he cuts a string $ t = abcabc $ . If he cuts $ t $ into two bands $ abc $ and $ abc $ , the band $ abc $ repeats two times and the number of different tapes is $ 1 $ . So, the result of this game is $ 1 $ .
If Ildar chooses the segment $ [4, 7] $ , he cuts a string $ t = abcd $ . It is impossible to cut this band in such a way that there is at least one band repeating at least two times. So, the result of this game is $ -1 $ .
If Ildar chooses the segment $ [3, 6] $ , he cuts a string $ t = cabc $ . If he cuts $ t $ into three bands $ c $ , $ ab $ and $ c $ , the band $ c $ repeats two times and the number of different bands is $ 2 $ . So, the result of this game is $ 2 $ .</div>
</article>
</div>
</div>
</body>
</html>
