<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Composing Of String - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573397742:s5ffgNGVgIxyCAKxIMjUvopVdlP69nN5aMLwo2+DBbA=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Stepan%20has%20a%20set%20of%20%24%20n%20%24%20strings.%20Also%2C%20he%20has%20a%20favorite%20string%20%24%20s%20%24%20.%5Cn%5CnStepan%20wants%20to%20do%20the%20following.%20He%20will%20take%20some%20strings%20of%20his%20set%20and%20write%20them%20down%20one%20after%20another.%20It%20is%20possible%20that%20he%20will%20take%20some%20strings%20more%20than%20once%2C%20and%20will%20not%20take%20some%20of%20them%20at%20all.%5Cn%5CnYour%20task%20is%20to%20determine%20the%20minimum%20number%20of%20strings%20in%20the%20set%20which%20Stepan%20needs%20to%20take%20and%20write%20so%20that%20the%20string%20%24%20s%20%24%20appears%20as%20a%20subsequence%20in%20the%20resulting%20written%20down%20string.%5Cn%5CnFor%20example%2C%20in%20the%20string%20%5C%22abcd%5C%22%20strings%20%5C%22ad%5C%22%2C%20%5C%22acd%5C%22%2C%20%5C%22abcd%5C%22%20appear%20as%20subsequences%2C%20and%20strings%20%5C%22ba%5C%22%2C%20%5C%22abdc%5C%22%20don%27t%20appear%20as%20subsequences.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20the%20integer%20%24%20n%20%24%20%28%20%24%201%3C%3Dn%3C%3D50%20%24%20%29%20%5Cu2014%20the%20number%20of%20strings%20in%20Stepan%27s%20set.%5Cn%5CnThe%20next%20%24%20n%20%24%20lines%20contain%20%24%20n%20%24%20non-empty%20strings%20consisting%20of%20lowercase%20letters%20of%20the%20English%20alphabet.%20The%20length%20of%20each%20of%20these%20strings%20does%20not%20exceed%20%24%2050%20%24%20symbols.%20It%20is%20possible%20that%20some%20strings%20from%20Stepan%27s%20set%20are%20the%20same.%5Cn%5CnThe%20next%20line%20contains%20the%20non-empty%20string%20%24%20s%20%24%20%2C%20consisting%20of%20lowercase%20letters%20of%20the%20English%20alphabet%20%5Cu2014%20Stepan%27s%20favorite%20string.%20The%20length%20of%20this%20string%20doesn%27t%20exceed%20%24%202500%20%24%20symbols.%22%2C%22outputFormat%22%3A%22Print%20the%20minimum%20number%20of%20strings%20which%20Stepan%20should%20take%20from%20the%20set%20and%20write%20them%20down%20one%20after%20another%20so%20that%20the%20string%20%24%20s%20%24%20appears%20as%20a%20subsequence%20in%20the%20resulting%20written%20down%20string.%20Each%20string%20from%20the%20set%20should%20be%20counted%20as%20many%20times%20as%20Stepan%20takes%20it%20from%20the%20set.%5Cn%5CnIf%20the%20answer%20doesn%27t%20exsist%2C%20print%20-1.%22%2C%22samples%22%3A%5B%5B%223%5Cna%5Cnaa%5Cna%5Cnaaa%5Cn%22%2C%222%5Cn%22%5D%2C%5B%224%5Cnab%5Cnaab%5Cnaa%5Cnbb%5Cnbaaab%5Cn%22%2C%223%5Cn%22%5D%2C%5B%222%5Cnaaa%5Cnbbb%5Cnaaacbbb%5Cn%22%2C%22-1%5Cn%22%5D%5D%2C%22hint%22%3A%22In%20the%20first%20test%2C%20Stepan%20can%20take%2C%20for%20example%2C%20the%20third%20and%20the%20second%20strings%20from%20the%20set%2C%20write%20them%20down%2C%20and%20get%20exactly%20his%20favorite%20string.%5Cn%5CnIn%20the%20second%20example%20Stepan%20can%20take%2C%20for%20example%2C%20the%20second%2C%20the%20third%20and%20again%20the%20second%20strings%20from%20the%20set%20and%20write%20them%20down.%20Then%20he%20will%20get%20a%20string%20%5C%22aabaaaab%5C%22%2C%20in%20which%20his%20favorite%20string%20%5C%22baaab%5C%22%20is%20a%20subsequence.%5Cn%5CnIn%20the%20third%20test%20Stepan%20can%20not%20get%20his%20favorite%20string%2C%20because%20it%20contains%20the%20letter%20%5C%22c%5C%22%2C%20which%20is%20not%20presented%20in%20any%20of%20the%20strings%20in%20the%20set.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F774%5C%2FI%22%2C%22id%22%3A%22774I%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22CF774I%22%2C%22title%22%3A%22Composing%20Of%20String%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Composing%20Of%20String%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573306449;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Composing Of String</h1>
<h2>题目描述</h2>
<div>Stepan has a set of $ n $ strings. Also, he has a favorite string $ s $ .
Stepan wants to do the following. He will take some strings of his set and write them down one after another. It is possible that he will take some strings more than once, and will not take some of them at all.
Your task is to determine the minimum number of strings in the set which Stepan needs to take and write so that the string $ s $ appears as a subsequence in the resulting written down string.
For example, in the string "abcd" strings "ad", "acd", "abcd" appear as subsequences, and strings "ba", "abdc" don't appear as subsequences.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains the integer $ n $ ( $ 1<=n<=50 $ ) — the number of strings in Stepan's set.
The next $ n $ lines contain $ n $ non-empty strings consisting of lowercase letters of the English alphabet. The length of each of these strings does not exceed $ 50 $ symbols. It is possible that some strings from Stepan's set are the same.
The next line contains the non-empty string $ s $ , consisting of lowercase letters of the English alphabet — Stepan's favorite string. The length of this string doesn't exceed $ 2500 $ symbols.</div>
<h3>输出格式</h3>
<br />
<div>Print the minimum number of strings which Stepan should take from the set and write them down one after another so that the string $ s $ appears as a subsequence in the resulting written down string. Each string from the set should be counted as many times as Stepan takes it from the set.
If the answer doesn't exsist, print -1.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>3
a
aa
a
aaa
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>2
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>4
ab
aab
aa
bb
baaab
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>3
</code></pre>
<h3>输入样例 #3</h3>
<pre><code>2
aaa
bbb
aaacbbb
</code></pre>
<h3>输出样例 #3</h3>
<pre><code>-1
</code></pre>
<h2>说明</h2>
<div>In the first test, Stepan can take, for example, the third and the second strings from the set, write them down, and get exactly his favorite string.
In the second example Stepan can take, for example, the second, the third and again the second strings from the set and write them down. Then he will get a string "aabaaaab", in which his favorite string "baaab" is a subsequence.
In the third test Stepan can not get his favorite string, because it contains the letter "c", which is not presented in any of the strings in the set.</div>
</article>
</div>
</div>
</body>
</html>
