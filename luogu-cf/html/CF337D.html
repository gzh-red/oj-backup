<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Book of Evil - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573392968:mzxURYk0GTZtiT8eRj6oIQFfa7gKGAnC6wfe4O771Dc=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%22%2C%22description%22%3A%22Paladin%20Manao%20caught%20the%20trail%20of%20the%20ancient%20Book%20of%20Evil%20in%20a%20swampy%20area.%20This%20area%20contains%20%24%20n%20%24%20settlements%20numbered%20from%201%20to%20%24%20n%20%24%20.%20Moving%20through%20the%20swamp%20is%20very%20difficult%2C%20so%20people%20tramped%20exactly%20%24%20n-1%20%24%20paths.%20Each%20of%20these%20paths%20connects%20some%20pair%20of%20settlements%20and%20is%20bidirectional.%20Moreover%2C%20it%20is%20possible%20to%20reach%20any%20settlement%20from%20any%20other%20one%20by%20traversing%20one%20or%20several%20paths.%5Cn%5CnThe%20distance%20between%20two%20settlements%20is%20the%20minimum%20number%20of%20paths%20that%20have%20to%20be%20crossed%20to%20get%20from%20one%20settlement%20to%20the%20other%20one.%20Manao%20knows%20that%20the%20Book%20of%20Evil%20has%20got%20a%20damage%20range%20%24%20d%20%24%20.%20This%20means%20that%20if%20the%20Book%20of%20Evil%20is%20located%20in%20some%20settlement%2C%20its%20damage%20%28for%20example%2C%20emergence%20of%20ghosts%20and%20werewolves%29%20affects%20other%20settlements%20at%20distance%20%24%20d%20%24%20or%20less%20from%20the%20settlement%20where%20the%20Book%20resides.%5Cn%5CnManao%20has%20heard%20of%20%24%20m%20%24%20settlements%20affected%20by%20the%20Book%20of%20Evil.%20Their%20numbers%20are%20%24%20p_%7B1%7D%2Cp_%7B2%7D%2C...%2Cp_%7Bm%7D%20%24%20.%20Note%20that%20the%20Book%20may%20be%20affecting%20other%20settlements%20as%20well%2C%20but%20this%20has%20not%20been%20detected%20yet.%20Manao%20wants%20to%20determine%20which%20settlements%20may%20contain%20the%20Book.%20Help%20him%20with%20this%20difficult%20task.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20three%20space-separated%20integers%20%24%20n%20%24%20%2C%20%24%20m%20%24%20and%20%24%20d%20%24%20%28%20%24%201%3C%3Dm%3C%3Dn%3C%3D100000%3B%5Cu00a00%3C%3Dd%3C%3Dn-1%20%24%20%29.%20The%20second%20line%20contains%20%24%20m%20%24%20distinct%20space-separated%20integers%20%24%20p_%7B1%7D%2Cp_%7B2%7D%2C...%2Cp_%7Bm%7D%20%24%20%28%20%24%201%3C%3Dp_%7Bi%7D%3C%3Dn%20%24%20%29.%20Then%20%24%20n-1%20%24%20lines%20follow%2C%20each%20line%20describes%20a%20path%20made%20in%20the%20area.%20A%20path%20is%20described%20by%20a%20pair%20of%20space-separated%20integers%20%24%20a_%7Bi%7D%20%24%20and%20%24%20b_%7Bi%7D%20%24%20representing%20the%20ends%20of%20this%20path.%22%2C%22outputFormat%22%3A%22Print%20a%20single%20number%20%5Cu2014%20the%20number%20of%20settlements%20that%20may%20contain%20the%20Book%20of%20Evil.%20It%20is%20possible%20that%20Manao%20received%20some%20controversial%20information%20and%20there%20is%20no%20settlement%20that%20may%20contain%20the%20Book.%20In%20such%20case%2C%20print%200.%22%2C%22samples%22%3A%5B%5B%226%202%203%5Cn1%202%5Cn1%205%5Cn2%203%5Cn3%204%5Cn4%205%5Cn5%206%5Cn%22%2C%223%5Cn%22%5D%5D%2C%22hint%22%3A%22Sample%201.%20The%20damage%20range%20of%20the%20Book%20of%20Evil%20equals%203%20and%20its%20effects%20have%20been%20noticed%20in%20settlements%201%20and%202.%20Thus%2C%20it%20can%20be%20in%20settlements%203%2C%204%20or%205.%5Cn%5Cn%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF337D%5C%2Fbb5982168a46056c0b6c7bf34dd6accd73b10df3.png%29%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F337%5C%2FD%22%2C%22id%22%3A%22337D%22%7D%2C%22translation%22%3A%22%5Cn%5Cn%5Cu6709%5Cu4e00%5Cu68f5%5Cu6811%5Cu6709%20n%5Cu4e2a%5Cu8282%5Cu70b9%5Cuff0c%5Cu5176%5Cu4e2d%5Cu6709%20m%5Cu4e2a%5Cu8282%5Cu70b9%5Cu53d1%5Cu73b0%5Cu4e86%5Cu602a%5Cu7269%5Cu3002%20%5Cu5df2%5Cu77e5%5Cu6811%5Cu4e0a%5Cu6709%5Cu4e00%5Cu672c%5Cu9b54%5Cu6cd5%5Cu4e66%5Cuff0c%5Cu9b54%5Cu6cd5%5Cu4e66%5Cu53ef%5Cu4ee5%5Cu8ba9%5Cu5230%5Cu5176%5Cu8ddd%5Cu79bb%5Cu5c0f%5Cu4e8e%5Cu7b49%5Cu4e8ed%5Cu7684%5Cu70b9%5Cu51fa%5Cu73b0%5Cu602a%5Cu7269%5Cuff0c%5Cu6c42%5Cu9b54%5Cu6cd5%5Cu4e66%5Cu6240%5Cu5728%5Cu70b9%5Cu6709%5Cu51e0%5Cu79cd%5Cu53ef%5Cu80fd%5Cu3002%5Cn%5Cn%5Cu8f93%5Cu5165%5Cu7b2c%5Cu4e00%5Cu884c%5Cu4e3a3%5Cu4e2a%5Cu6b63%5Cu6574%5Cu6570%20n%20m%20d%5Cn%5Cn%5Cu7b2c%5Cu4e8c%5Cu884c%20m%20%5Cu4e2a%5Cu6574%5Cu6570%5Cuff0c%5Cu4ee5%5Cu7a7a%5Cu683c%5Cu95f4%5Cu9694%5Cuff0c%5Cu8868%5Cu660e%5Cu8fd9%5Cu4e9b%5Cu70b9%5Cu51fa%5Cu73b0%5Cu4e86%5Cu602a%5Cu7269%5Cu3002%5Cn%5Cn%5Cu63a5%5Cu4e0b%5Cu6765%20n%5Cu22121%5Cu884c%5Cuff0c%5Cu6bcf%5Cu884c%5Cu4e24%5Cu4e2a%5Cu6574%5Cu6570%5Cuff0c%5Cu63cf%5Cu8ff0%5Cu6811%5Cu4e0a%5Cu7684%5Cu4e00%5Cu6761%5Cu8fb9%5Cu3002%5Cn%5Cn%5Cu8f93%5Cu51fa%5Cu4e00%5Cu884c%5Cu4e00%5Cu4e2a%5Cu6574%5Cu6570%5Cuff0c%5Cu9b54%5Cu6cd5%5Cu4e66%5Cu6240%5Cu5728%5Cu4f4d%5Cu7f6e%5Cu7684%5Cu53ef%5Cu80fd%5Cu6027%5Cu3002%5Cn%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A279%2C%22totalAccepted%22%3A119%2C%22pid%22%3A%22CF337D%22%2C%22title%22%3A%22Book%20of%20Evil%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A165156%2C%22title%22%3A%22%5Cu4e00%5Cu9053%5Cu6709%5Cu8da3%5Cu7684%5Cu6811%5Cu5f62dp%22%2C%22forum%22%3A%7B%22id%22%3A11289%2C%22name%22%3A%22CF337D%20Book%20of%20Evil%22%2C%22slug%22%3A%22CF337D%22%7D%7D%2C%7B%22id%22%3A33519%2C%22title%22%3A%22%5Cu7ffb%5Cu8bd1%22%2C%22forum%22%3A%7B%22id%22%3A11289%2C%22name%22%3A%22CF337D%20Book%20of%20Evil%22%2C%22slug%22%3A%22CF337D%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22CF842C%22%2C%22title%22%3A%22Ilya%20And%20The%20Tree%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF780C%22%2C%22title%22%3A%22Andryusha%20and%20Colored%20Balloons%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF739B%22%2C%22title%22%3A%22Alyona%20and%20a%20tree%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF486D%22%2C%22title%22%3A%22Valid%20Sets%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22CF161D%22%2C%22title%22%3A%22Distance%20in%20Tree%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22CF%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Book%20of%20Evil%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Book of Evil</h1>
<h2>题意翻译</h2>
<div>
有一棵树有 n个节点，其中有 m个节点发现了怪物。 已知树上有一本魔法书，魔法书可以让到其距离小于等于d的点出现怪物，求魔法书所在点有几种可能。
输入第一行为3个正整数 n m d
第二行 m 个整数，以空格间隔，表明这些点出现了怪物。
接下来 n−1行，每行两个整数，描述树上的一条边。
输出一行一个整数，魔法书所在位置的可能性。
</div>
<h2>题目描述</h2>
<div>Paladin Manao caught the trail of the ancient Book of Evil in a swampy area. This area contains $ n $ settlements numbered from 1 to $ n $ . Moving through the swamp is very difficult, so people tramped exactly $ n-1 $ paths. Each of these paths connects some pair of settlements and is bidirectional. Moreover, it is possible to reach any settlement from any other one by traversing one or several paths.
The distance between two settlements is the minimum number of paths that have to be crossed to get from one settlement to the other one. Manao knows that the Book of Evil has got a damage range $ d $ . This means that if the Book of Evil is located in some settlement, its damage (for example, emergence of ghosts and werewolves) affects other settlements at distance $ d $ or less from the settlement where the Book resides.
Manao has heard of $ m $ settlements affected by the Book of Evil. Their numbers are $ p_{1},p_{2},...,p_{m} $ . Note that the Book may be affecting other settlements as well, but this has not been detected yet. Manao wants to determine which settlements may contain the Book. Help him with this difficult task.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains three space-separated integers $ n $ , $ m $ and $ d $ ( $ 1<=m<=n<=100000; 0<=d<=n-1 $ ). The second line contains $ m $ distinct space-separated integers $ p_{1},p_{2},...,p_{m} $ ( $ 1<=p_{i}<=n $ ). Then $ n-1 $ lines follow, each line describes a path made in the area. A path is described by a pair of space-separated integers $ a_{i} $ and $ b_{i} $ representing the ends of this path.</div>
<h3>输出格式</h3>
<br />
<div>Print a single number — the number of settlements that may contain the Book of Evil. It is possible that Manao received some controversial information and there is no settlement that may contain the Book. In such case, print 0.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>6 2 3
1 2
1 5
2 3
3 4
4 5
5 6
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>3
</code></pre>
<h2>说明</h2>
<div>Sample 1. The damage range of the Book of Evil equals 3 and its effects have been noticed in settlements 1 and 2. Thus, it can be in settlements 3, 4 or 5.
![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF337D/bb5982168a46056c0b6c7bf34dd6accd73b10df3.png)</div>
</article>
</div>
</div>
</body>
</html>
