<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Monsters and Diamonds - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573392730:+rxc9M64L0sKZewckos6xwZvpdXYeLX6DyNoW3CtVYk=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Piegirl%20has%20found%20a%20monster%20and%20a%20book%20about%20monsters%20and%20pies.%20When%20she%20is%20reading%20the%20book%2C%20she%20found%20out%20that%20there%20are%20%24%20n%20%24%20types%20of%20monsters%2C%20each%20with%20an%20ID%20between%20%24%201%20%24%20and%20%24%20n%20%24%20.%20If%20you%20feed%20a%20pie%20to%20a%20monster%2C%20the%20monster%20will%20split%20into%20some%20number%20of%20monsters%20%28possibly%20zero%29%2C%20and%20at%20least%20one%20colorful%20diamond.%20Monsters%20may%20be%20able%20to%20split%20in%20multiple%20ways.%5Cn%5CnAt%20the%20begining%20Piegirl%20has%20exactly%20one%20monster.%20She%20begins%20by%20feeding%20the%20monster%20a%20pie.%20She%20continues%20feeding%20pies%20to%20monsters%20until%20no%20more%20monsters%20are%20left.%20Then%20she%20collects%20all%20the%20diamonds%20that%20were%20created.%5Cn%5CnYou%20will%20be%20given%20a%20list%20of%20split%20rules%20describing%20the%20way%20in%20which%20the%20various%20monsters%20can%20split.%20Every%20monster%20can%20split%20in%20at%20least%20one%20way%2C%20and%20if%20a%20monster%20can%20split%20in%20multiple%20ways%20then%20each%20time%20when%20it%20splits%20Piegirl%20can%20choose%20the%20way%20it%20splits.%5Cn%5CnFor%20each%20monster%2C%20determine%20the%20smallest%20and%20the%20largest%20number%20of%20diamonds%20Piegirl%20can%20possibly%20collect%2C%20if%20initially%20she%20has%20a%20single%20instance%20of%20that%20monster.%20Piegirl%20has%20an%20unlimited%20supply%20of%20pies.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20two%20integers%3A%20%24%20m%20%24%20and%20%24%20n%20%24%20%28%20%24%201%3C%3Dm%2Cn%3C%3D10%5E%7B5%7D%20%24%20%29%2C%20the%20number%20of%20possible%20splits%20and%20the%20number%20of%20different%20monster%20types.%20Each%20of%20the%20following%20%24%20m%20%24%20lines%20contains%20a%20split%20rule.%20Each%20split%20rule%20starts%20with%20an%20integer%20%28a%20monster%20ID%29%20%24%20m_%7Bi%7D%20%24%20%28%20%24%201%3C%3Dm_%7Bi%7D%3C%3Dn%20%24%20%29%2C%20and%20a%20positive%20integer%20%24%20l_%7Bi%7D%20%24%20indicating%20the%20number%20of%20monsters%20and%20diamonds%20the%20current%20monster%20can%20split%20into.%20This%20is%20followed%20by%20%24%20l_%7Bi%7D%20%24%20integers%2C%20with%20positive%20integers%20representing%20a%20monster%20ID%20and%20-1%20representing%20a%20diamond.%5Cn%5CnEach%20monster%20will%20have%20at%20least%20one%20split%20rule.%20Each%20split%20rule%20will%20have%20at%20least%20one%20diamond.%20The%20sum%20of%20%24%20l_%7Bi%7D%20%24%20across%20all%20split%20rules%20will%20be%20at%20most%20%24%2010%5E%7B5%7D%20%24%20.%22%2C%22outputFormat%22%3A%22For%20each%20monster%2C%20in%20order%20of%20their%20IDs%2C%20print%20a%20line%20with%20two%20integers%3A%20the%20smallest%20and%20the%20largest%20number%20of%20diamonds%20that%20can%20possibly%20be%20collected%20by%20starting%20with%20that%20monster.%20If%20Piegirl%20cannot%20possibly%20end%20up%20in%20a%20state%20without%20monsters%2C%20print%20-1%20for%20both%20smallest%20and%20the%20largest%20value.%20If%20she%20can%20collect%20an%20arbitrarily%20large%20number%20of%20diamonds%2C%20print%20-2%20as%20the%20largest%20number%20of%20diamonds.%5Cn%5CnIf%20any%20number%20in%20output%20exceeds%20%24%20314000000%20%24%20%28but%20is%20finite%29%2C%20print%20%24%20314000000%20%24%20instead%20of%20that%20number.%22%2C%22samples%22%3A%5B%5B%226%204%5Cn1%203%20-1%201%20-1%5Cn1%202%20-1%20-1%5Cn2%203%20-1%203%20-1%5Cn2%203%20-1%20-1%20-1%5Cn3%202%20-1%20-1%5Cn4%202%204%20-1%5Cn%22%2C%222%20-2%5Cn3%204%5Cn2%202%5Cn-1%20-1%5Cn%22%5D%2C%5B%223%202%5Cn1%202%201%20-1%5Cn2%202%20-1%20-1%5Cn2%203%202%201%20-1%5Cn%22%2C%22-1%20-1%5Cn2%202%5Cn%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F325%5C%2FC%22%2C%22id%22%3A%22325C%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A24%2C%22totalAccepted%22%3A14%2C%22pid%22%3A%22CF325C%22%2C%22title%22%3A%22Monsters%20and%20Diamonds%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A68419%2C%22title%22%3A%22%5Cu7535%5Cu8111%5Cu7ffb%5Cu8bd1%22%2C%22forum%22%3A%7B%22id%22%3A11332%2C%22name%22%3A%22CF325C%20Monsters%20and%20Diamonds%22%2C%22slug%22%3A%22CF325C%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Monsters%20and%20Diamonds%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573286098;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Monsters and Diamonds</h1>
<h2>题目描述</h2>
<div>Piegirl has found a monster and a book about monsters and pies. When she is reading the book, she found out that there are $ n $ types of monsters, each with an ID between $ 1 $ and $ n $ . If you feed a pie to a monster, the monster will split into some number of monsters (possibly zero), and at least one colorful diamond. Monsters may be able to split in multiple ways.
At the begining Piegirl has exactly one monster. She begins by feeding the monster a pie. She continues feeding pies to monsters until no more monsters are left. Then she collects all the diamonds that were created.
You will be given a list of split rules describing the way in which the various monsters can split. Every monster can split in at least one way, and if a monster can split in multiple ways then each time when it splits Piegirl can choose the way it splits.
For each monster, determine the smallest and the largest number of diamonds Piegirl can possibly collect, if initially she has a single instance of that monster. Piegirl has an unlimited supply of pies.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains two integers: $ m $ and $ n $ ( $ 1<=m,n<=10^{5} $ ), the number of possible splits and the number of different monster types. Each of the following $ m $ lines contains a split rule. Each split rule starts with an integer (a monster ID) $ m_{i} $ ( $ 1<=m_{i}<=n $ ), and a positive integer $ l_{i} $ indicating the number of monsters and diamonds the current monster can split into. This is followed by $ l_{i} $ integers, with positive integers representing a monster ID and -1 representing a diamond.
Each monster will have at least one split rule. Each split rule will have at least one diamond. The sum of $ l_{i} $ across all split rules will be at most $ 10^{5} $ .</div>
<h3>输出格式</h3>
<br />
<div>For each monster, in order of their IDs, print a line with two integers: the smallest and the largest number of diamonds that can possibly be collected by starting with that monster. If Piegirl cannot possibly end up in a state without monsters, print -1 for both smallest and the largest value. If she can collect an arbitrarily large number of diamonds, print -2 as the largest number of diamonds.
If any number in output exceeds $ 314000000 $ (but is finite), print $ 314000000 $ instead of that number.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>6 4
1 3 -1 1 -1
1 2 -1 -1
2 3 -1 3 -1
2 3 -1 -1 -1
3 2 -1 -1
4 2 4 -1
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>2 -2
3 4
2 2
-1 -1
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>3 2
1 2 1 -1
2 2 -1 -1
2 3 2 1 -1
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>-1 -1
2 2
</code></pre>
</article>
</div>
</div>
</body>
</html>
