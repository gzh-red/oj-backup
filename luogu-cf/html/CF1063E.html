<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Lasers and Mirrors - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573401139:PhDWiJEgOQggMtB8TO3upG+Ig/K+ewG1dHgJjpcrloU=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Oleg%20came%20to%20see%20the%20maze%20of%20mirrors.%20The%20maze%20is%20a%20%24%20n%20%24%20by%20%24%20n%20%24%20room%20in%20which%20each%20cell%20is%20either%20empty%20or%20contains%20a%20mirror%20connecting%20opposite%20corners%20of%20this%20cell.%20Mirrors%20in%20this%20maze%20reflect%20light%20in%20a%20perfect%20way%2C%20which%20causes%20the%20interesting%20visual%20effects%20and%20contributes%20to%20the%20loss%20of%20orientation%20in%20the%20maze.%5Cn%5CnOleg%20is%20a%20person%20of%20curious%20nature%2C%20so%20he%20decided%20to%20install%20%24%20n%20%24%20lasers%20facing%20internal%20of%20the%20maze%20on%20the%20south%20wall%20of%20the%20maze.%20On%20the%20north%20wall%20of%20the%20maze%2C%20Oleg%20installed%20%24%20n%20%24%20receivers%2C%20also%20facing%20internal%20of%20the%20maze.%20Let%27s%20number%20lasers%20and%20receivers%20from%20west%20to%20east%20with%20distinct%20integers%20from%20%24%201%20%24%20to%20%24%20n%20%24%20.%20Each%20laser%20sends%20a%20beam%20of%20some%20specific%20kind%20and%20receiver%20with%20number%20%24%20a_i%20%24%20should%20receive%20the%20beam%20sent%20from%20laser%20number%20%24%20i%20%24%20.%20Since%20two%20lasers%27%20beams%20can%27t%20come%20to%20the%20same%20receiver%2C%20these%20numbers%20form%20a%20permutation%20%5Cu2014%20each%20of%20the%20receiver%20numbers%20occurs%20exactly%20once.%5Cn%5CnYou%20came%20to%20the%20maze%20together%20with%20Oleg.%20Help%20him%20to%20place%20the%20mirrors%20in%20the%20initially%20empty%20maze%20so%20that%20the%20maximum%20number%20of%20lasers%27%20beams%20will%20come%20to%20the%20receivers%20they%20should.%20There%20are%20no%20mirrors%20outside%20the%20maze%2C%20so%20if%20the%20laser%20beam%20leaves%20the%20maze%2C%20it%20will%20not%20be%20able%20to%20go%20back.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20a%20single%20integer%20%24%20n%20%24%20%28%20%24%201%20%5C%5Cle%20n%20%5C%5Cle%201000%20%24%20%29%20%5Cu2014%20the%20size%20of%20the%20maze.%5Cn%5CnThe%20second%20line%20contains%20a%20permutation%20of%20%24%20n%20%24%20integers%20%24%20a_i%20%24%20%28%20%24%201%20%5C%5Cle%20a_i%20%5C%5Cle%20n%20%24%20%29%2C%20where%20%24%20a_i%20%24%20defines%20the%20number%20of%20the%20receiver%2C%20to%20which%20the%20beam%20from%20%24%20i%20%24%20-th%20laser%20should%20come.%22%2C%22outputFormat%22%3A%22In%20the%20first%20line%20print%20the%20maximum%20possible%20number%20of%20laser%20beams%2C%20which%20can%20come%20to%20the%20receivers%20they%20should.%5Cn%5CnIn%20the%20next%20%24%20n%20%24%20lines%20of%20length%20%24%20n%20%24%20print%20the%20arrangement%20of%20mirrors%2C%20causing%20such%20number%20of%20laser%20beams%20to%20come%20where%20they%20should.%20If%20the%20corresponding%20cell%20is%20empty%2C%20print%20%5C%22.%5C%22%2C%20otherwise%20print%20%5C%22%5C%2F%5C%22%20or%20%5C%22%5C%5C%5C%5C%5C%22%2C%20depending%20on%20the%20orientation%20of%20the%20mirror.%5Cn%5CnIn%20your%20output%20north%20should%20be%20above%2C%20south%20should%20be%20below%2C%20and%20west%20and%20east%20should%20be%20on%20left%20and%20on%20the%20right%20respectively.%5Cn%5CnIt%20is%20allowed%20for%20laser%20beams%20to%20come%20not%20to%20the%20receivers%20they%20correspond%20to%2C%20but%20they%20are%20not%20counted%20in%20the%20answer.%5Cn%5CnIf%20there%20are%20multiple%20arrangements%20of%20mirrors%20leading%20to%20the%20optimal%20answer%20%5Cu2014%20print%20any%20of%20them.%22%2C%22samples%22%3A%5B%5B%224%5Cn4%201%203%202%5Cn%22%2C%223%5Cn.%5C%5C..%5Cn%5C%5C%5C%5C..%5Cn%5C%2F..%5C%2F%5Cn...%5C%5C%5Cn%22%5D%5D%2C%22hint%22%3A%22The%20picture%20illustrates%20the%20arrangements%20of%20the%20mirrors%20in%20the%20first%20example.%5Cn%5Cn%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FCF1063E%5C%2F19ee8b9d2f31cec8a8e7ae55db512ff2fc59d36c.png%29%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F1063%5C%2FE%22%2C%22id%22%3A%221063E%22%7D%2C%22translation%22%3A%22%5Cu6709%5Cu4e00%5Cu4e2a%24n%2An%24%5Cu7684%5Cu623f%5Cu95f4%5Cuff0c%5Cu623f%5Cu95f4%5Cu4e0b%5Cu65b9%5Cu6709%24n%24%5Cu4e2a%5Cu53d1%5Cu5c04%5Cu6fc0%5Cu5149%5Cu7684%5Cu53d1%5Cu5c04%5Cu5668%5Cuff0c%5Cu4e0a%5Cu65b9%5Cu6709%24n%24%5Cu4e2a%5Cu63a5%5Cu6536%5Cu5668%5Cu5206%5Cu522b%5Cu5bf9%5Cu5e94%5Cu4e00%5Cu4e2a%5Cu4e0d%5Cu540c%5Cu7684%5Cu53d1%5Cu5c04%5Cu5668%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu73b0%5Cu5728%5Cu7ed9%5Cu4f60%5Cu6bcf%5Cu4e2a%5Cu53d1%5Cu5c04%5Cu5668%5Cu5bf9%5Cu5e94%5Cu7684%5Cu63a5%5Cu6536%5Cu5668%5Cu7684%5Cu7f16%5Cu53f7%5Cuff0c%5Cu8bf7%5Cu4f60%5Cu5728%5Cu623f%5Cu95f4%5Cu91cc%5Cu653e%5Cu4e0a%5Cu4e00%5Cu4e9b%5Cu955c%5Cu5b50%5Cuff0c%5Cu4f7f%5Cu5f97%5Cu6709%5Cu6700%5Cu591a%5Cu7684%5Cu63a5%5Cu6536%5Cu5668%5Cu6536%5Cu5230%5Cu5bf9%5Cu5e94%5Cu53d1%5Cu5c04%5Cu5668%5Cu7684%5Cu4fe1%5Cu53f7%5Cu3002%5Cu8981%5Cu6c42%5Cu8f93%5Cu51fa%5Cu6700%5Cu591a%5Cu53ef%5Cu80fd%5Cu6536%5Cu5230%5Cu5bf9%5Cu5e94%5Cu4fe1%5Cu53f7%5Cu7684%5Cu63a5%5Cu6536%5Cu5668%5Cu6570%5Cu76ee%5Cuff0c%5Cu5e76%5Cu4e14%5Cu8f93%5Cu51fa%5Cu6b64%5Cu65f6%5Cu623f%5Cu95f4%5Cu5bf9%5Cu5e94%5Cu7684%5Cu5e03%5Cu5c40%5Cu3002%5Cu5176%5Cu4e2d%27.%27%5Cu8868%5Cu793a%5Cu7a7a%5Cu5730%5Cuff0c%27%5C%2F%27%2C%27%5C%5C%27%5Cu5206%5Cu522b%5Cu8868%5Cu793a%5Cu4e0d%5Cu540c%5Cu671d%5Cu5411%5Cu7684%5Cu955c%5Cu5b50%5Cu3002%5Cuff08%5Cu53ef%5Cu4ee5%5Cu7ed3%5Cu5408%5Cu9898%5Cu56fe%5Cu7406%5Cu89e3%5Cuff09%5Cu5141%5Cu8bb8%5Cu63a5%5Cu6536%5Cu5668%5Cu63a5%5Cu6536%5Cu975e%5Cu5bf9%5Cu5e94%5Cu53d1%5Cu5c04%5Cu5668%5Cu7684%5Cu4fe1%5Cu53f7%5Cuff0c%5Cu4f46%5Cu8fd9%5Cu79cd%5Cu60c5%5Cu51b5%5Cu4e0d%5Cu8ba1%5Cu5165%5Cu7b54%5Cu6848%5Cu3002%5Cu591a%5Cu79cd%5Cu7b54%5Cu6848%5Cu8f93%5Cu51fa%5Cu4e00%5Cu79cd%5Cu5373%5Cu53ef%5Cu3002%20%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A12%2C%22totalAccepted%22%3A6%2C%22pid%22%3A%22CF1063E%22%2C%22title%22%3A%22Lasers%20and%20Mirrors%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Lasers%20and%20Mirrors%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Lasers and Mirrors</h1>
<h2>题意翻译</h2>
<div>有一个$n*n$的房间，房间下方有$n$个发射激光的发射器，上方有$n$个接收器分别对应一个不同的发射器。
现在给你每个发射器对应的接收器的编号，请你在房间里放上一些镜子，使得有最多的接收器收到对应发射器的信号。要求输出最多可能收到对应信号的接收器数目，并且输出此时房间对应的布局。其中'.'表示空地，'/','\'分别表示不同朝向的镜子。（可以结合题图理解）允许接收器接收非对应发射器的信号，但这种情况不计入答案。多种答案输出一种即可。 </div>
<h2>题目描述</h2>
<div>Oleg came to see the maze of mirrors. The maze is a $ n $ by $ n $ room in which each cell is either empty or contains a mirror connecting opposite corners of this cell. Mirrors in this maze reflect light in a perfect way, which causes the interesting visual effects and contributes to the loss of orientation in the maze.
Oleg is a person of curious nature, so he decided to install $ n $ lasers facing internal of the maze on the south wall of the maze. On the north wall of the maze, Oleg installed $ n $ receivers, also facing internal of the maze. Let's number lasers and receivers from west to east with distinct integers from $ 1 $ to $ n $ . Each laser sends a beam of some specific kind and receiver with number $ a_i $ should receive the beam sent from laser number $ i $ . Since two lasers' beams can't come to the same receiver, these numbers form a permutation — each of the receiver numbers occurs exactly once.
You came to the maze together with Oleg. Help him to place the mirrors in the initially empty maze so that the maximum number of lasers' beams will come to the receivers they should. There are no mirrors outside the maze, so if the laser beam leaves the maze, it will not be able to go back.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains a single integer $ n $ ( $ 1 \le n \le 1000 $ ) — the size of the maze.
The second line contains a permutation of $ n $ integers $ a_i $ ( $ 1 \le a_i \le n $ ), where $ a_i $ defines the number of the receiver, to which the beam from $ i $ -th laser should come.</div>
<h3>输出格式</h3>
<br />
<div>In the first line print the maximum possible number of laser beams, which can come to the receivers they should.
In the next $ n $ lines of length $ n $ print the arrangement of mirrors, causing such number of laser beams to come where they should. If the corresponding cell is empty, print ".", otherwise print "/" or "\\", depending on the orientation of the mirror.
In your output north should be above, south should be below, and west and east should be on left and on the right respectively.
It is allowed for laser beams to come not to the receivers they correspond to, but they are not counted in the answer.
If there are multiple arrangements of mirrors leading to the optimal answer — print any of them.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>4
4 1 3 2
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>3
.\..
\\..
/../
...\
</code></pre>
<h2>说明</h2>
<div>The picture illustrates the arrangements of the mirrors in the first example.
![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1063E/19ee8b9d2f31cec8a8e7ae55db512ff2fc59d36c.png)</div>
</article>
</div>
</div>
</body>
</html>
