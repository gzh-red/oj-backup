<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Visit of the Great - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573391541:2jl8hPfW9DJL0XRBWILSxGPWFL+sRWBlQo2OTZloFuk=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22The%20Great%20Mushroom%20King%20descended%20to%20the%20dwarves%2C%20but%20not%20everyone%20managed%20to%20see%20him.%20Only%20the%20few%20chosen%20ones%20could%20see%20the%20King.%5Cn%5CnWe%20know%20that%20only%20%24%20LCM%28k%5E%7B2l%7D%2B1%2Ck%5E%7B2l%2B1%7D%2B1%2C...%2Ck%5E%7B2r%7D%2B1%29%20%24%20dwarves%20can%20see%20the%20Great%20Mushroom%20King.%20Numbers%20%24%20k%20%24%20%2C%20%24%20l%20%24%20%2C%20%24%20r%20%24%20are%20chosen%20by%20the%20Great%20Mushroom%20King%20himself%20in%20some%20complicated%20manner%20which%20is%20unclear%20to%20common%20dwarves.%5Cn%5CnThe%20dwarven%20historians%20decided%20to%20document%20all%20visits%20of%20the%20Great%20Mushroom%20King.%20For%20each%20visit%20the%20dwarven%20historians%20know%20three%20integers%20%24%20k_%7Bi%7D%20%24%20%2C%20%24%20l_%7Bi%7D%20%24%20%2C%20%24%20r_%7Bi%7D%20%24%20%2C%20chosen%20by%20the%20Great%20Mushroom%20King%20for%20this%20visit.%20They%20also%20know%20a%20prime%20number%20%24%20p_%7Bi%7D%20%24%20.%20Help%20them%20to%20count%20the%20remainder%20of%20dividing%20the%20number%20of%20dwarves%20who%20can%20see%20the%20King%2C%20by%20number%20%24%20p_%7Bi%7D%20%24%20%2C%20for%20each%20visit.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20the%20single%20integer%20%24%20t%20%24%20%24%20%281%3C%3Dt%3C%3D10%5E%7B5%7D%29%20%24%20%5Cu2014%20the%20number%20of%20the%20King%27s%20visits.%5Cn%5CnEach%20of%20the%20following%20%24%20t%20%24%20input%20lines%20contains%20four%20space-separated%20integers%20%24%20k_%7Bi%7D%20%24%20%2C%20%24%20l_%7Bi%7D%20%24%20%2C%20%24%20r_%7Bi%7D%20%24%20and%20%24%20p_%7Bi%7D%20%24%20%24%20%281%3C%3Dk_%7Bi%7D%3C%3D10%5E%7B6%7D%20%24%20%3B%20%24%200%3C%3Dl_%7Bi%7D%3C%3Dr_%7Bi%7D%3C%3D10%5E%7B18%7D%3B%5Cu00a02%3C%3Dp_%7Bi%7D%3C%3D10%5E%7B9%7D%29%20%24%20%5Cu2014%20the%20numbers%2C%20chosen%20by%20the%20Great%20Mushroom%20King%20and%20the%20prime%20module%2C%20correspondingly.%5Cn%5CnIt%20is%20guaranteed%20that%20for%20all%20visits%20number%20%24%20p_%7Bi%7D%20%24%20is%20prime.%5Cn%5CnPlease%20do%20not%20use%20the%20%25lld%20specifier%20to%20read%20or%20write%2064-bit%20integers%20in%20%5Cu0421%2B%2B.%20It%20is%20preferred%20to%20use%20the%20cin%2C%20cout%20streams%20or%20the%20%25I64d%20specifier.%22%2C%22outputFormat%22%3A%22For%20each%20visit%20print%20the%20answer%20on%20a%20single%20line%20%5Cu2014%20the%20remainder%20of%20dividing%20the%20number%20of%20the%20dwarves%20who%20can%20see%20the%20King%20this%20time%2C%20by%20number%20%24%20p_%7Bi%7D%20%24%20.%20Print%20the%20answers%20for%20the%20visits%20in%20the%20order%2C%20in%20which%20the%20visits%20are%20described%20in%20the%20input.%22%2C%22samples%22%3A%5B%5B%222%5Cn3%201%2010%202%5Cn5%200%204%203%5Cn%22%2C%220%5Cn0%5Cn%22%5D%5D%2C%22hint%22%3A%22We%20consider%20that%20%24%20LCM%28a_%7B1%7D%2Ca_%7B2%7D%2C...%2Ca_%7Bn%7D%29%20%24%20represents%20the%20least%20common%20multiple%20of%20numbers%20%24%20a_%7B1%7D%20%24%20%2C%20%24%20a_%7B2%7D%20%24%20%2C%20%24%20...%20%24%20%2C%20%24%20a_%7Bn%7D%20%24%20.%5Cn%5CnWe%20consider%20that%20%24%20x%5E%7B0%7D%3D1%20%24%20%2C%20for%20any%20%24%20x%20%24%20.%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B3000%5D%2C%22memory%22%3A%5B256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22CodeForces%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fcodeforces.com%5C%2Fproblemset%5C%2Fproblem%5C%2F185%5C%2FD%22%2C%22id%22%3A%22185D%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A6%2C%22totalAccepted%22%3A1%2C%22pid%22%3A%22CF185D%22%2C%22title%22%3A%22Visit%20of%20the%20Great%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Visit%20of%20the%20Great%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Visit of the Great</h1>
<h2>题目描述</h2>
<div>The Great Mushroom King descended to the dwarves, but not everyone managed to see him. Only the few chosen ones could see the King.
We know that only $ LCM(k^{2l}+1,k^{2l+1}+1,...,k^{2r}+1) $ dwarves can see the Great Mushroom King. Numbers $ k $ , $ l $ , $ r $ are chosen by the Great Mushroom King himself in some complicated manner which is unclear to common dwarves.
The dwarven historians decided to document all visits of the Great Mushroom King. For each visit the dwarven historians know three integers $ k_{i} $ , $ l_{i} $ , $ r_{i} $ , chosen by the Great Mushroom King for this visit. They also know a prime number $ p_{i} $ . Help them to count the remainder of dividing the number of dwarves who can see the King, by number $ p_{i} $ , for each visit.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains the single integer $ t $ $ (1<=t<=10^{5}) $ — the number of the King's visits.
Each of the following $ t $ input lines contains four space-separated integers $ k_{i} $ , $ l_{i} $ , $ r_{i} $ and $ p_{i} $ $ (1<=k_{i}<=10^{6} $ ; $ 0<=l_{i}<=r_{i}<=10^{18}; 2<=p_{i}<=10^{9}) $ — the numbers, chosen by the Great Mushroom King and the prime module, correspondingly.
It is guaranteed that for all visits number $ p_{i} $ is prime.
Please do not use the %lld specifier to read or write 64-bit integers in С++. It is preferred to use the cin, cout streams or the %I64d specifier.</div>
<h3>输出格式</h3>
<br />
<div>For each visit print the answer on a single line — the remainder of dividing the number of the dwarves who can see the King this time, by number $ p_{i} $ . Print the answers for the visits in the order, in which the visits are described in the input.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>2
3 1 10 2
5 0 4 3
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>0
0
</code></pre>
<h2>说明</h2>
<div>We consider that $ LCM(a_{1},a_{2},...,a_{n}) $ represents the least common multiple of numbers $ a_{1} $ , $ a_{2} $ , $ ... $ , $ a_{n} $ .
We consider that $ x^{0}=1 $ , for any $ x $ .</div>
</article>
</div>
</div>
</body>
</html>
