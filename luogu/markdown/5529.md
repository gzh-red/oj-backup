# [Ynoi2012]D2T3

## 题目背景

众所周知某top2大学在努力建成世界一流公关学校，简称世界一流大学

作为世界一流大学，不仅要有世界一流的公关能力，还需要有世界一流的调剂能力，世界一流的骗oier签约然后送去修大坝能力，世界一流的gpa计算公式，等等等等！

NMSL：New Method for Student Leveling

THU NMSL

## 题目描述

现在来介绍以下这个大学的gpa计算公式

有n个学生构成了一棵有根树，每个学生有一个gpa

定义一个学生所在的**专业**为仅保留两端学生gpa相同的边时，这个学生所在的连通分量

定义一个专业的**怨气值**是max(dep[a]-dep[b]+1) s.t. a,b是专业中的学生，dep[根]=0，dep[w]=dep[w的父亲]+1

操作1：给出x和y，把学生x的gpa改成y/10

操作2：给出x和y，把学生x所在的专业中所有点gpa改为y/10

操作3：给出x，问学生x的gpa，x所在专业的人数，x所在专业的怨气值

## 输入输出格式

### 输入格式

第一行一个数n

第二行n个数表示每个学生的学长（就是树上节点的父亲），其中第i个数<i，且1节点的学长输入为0 第三行n个数表示每个学生的gpa，这个数是要/10的 第四行一个数m 之后m行，每行一个操作： 1 x y 2 x y 3 x

### 输出格式

对于每个3操作，输出一行三个数，中间用空格隔开，依次表示：学生x的gpa*10，x所在专业的人数，x所在专业的怨气值

## 输入输出样例

### 输入样例 #1

```cpp
10
0 1 1 1 3 4 2 4 2 3
16 20 29 16 23 6 29 21 1 22
10
3 4
3 4
2 6 20
2 1 8
2 2 8
1 9 21
3 6
3 2
1 3 11
1 4 17

```
### 输出样例 #1

```cpp
16 2 2
16 2 2
20 1 1
8 3 2

```
## 说明

Idea：ccz181078，Solution：ccz181078，Code：ccz181078，Data：ccz181078

对于40%的数据，n , m <= 1000

对于另外40%的数据，n , m <= 1e5，gpa至多2种，[0.1,0.2]

对于100%的数据，n , m <= 1e5，gpa至多30种，[0.1,3.0]

这个题里面gpa输入的时候都是*10了的，也就是说我输入的是30，实际上gpa是3，1实际上是0.1，由于gpa又改了所以gpa不是从1.0开始的了。做题来说我们完全可以忽视这个事情，但是在大学里面不能的哦！

emmm也就是说你可以别管什么*10啊/10了，直接把那个东西当gpa算了，反正你也出不了国对吧？gpa有啥用呢~

哦如果你是个oier在考虑去哪里，希望你多考虑一下，而不是无脑凭借自己的印象来做选择，不然你可能和我一样后悔都来不及的~

