# [Ynoi2011]D2T3

## 题目背景

 ![](https://cdn.luogu.com.cn/upload/pic/14446.png)

【为什么会有个女孩，在那种地方？】

女孩子独身一人，站在那里

穿着和服的样子

仿佛一刮起风来就会失足落下去的样子，让人担心

![](https://cdn.luogu.com.cn/upload/pic/14447.png)

## 题目描述

但即便如此，也不能让她睡的

绝对不能让她睡觉啊

为什么

我是为什么

我是为什么让她独自一人啊

![](https://cdn.luogu.com.cn/upload/pic/14448.png)

【太大意了，太大意了】

加奈只不过是一个小女孩而已

通宵不眠该有多难受啊

为什么，为什么我刚才连这点都没有注意到啊？

【快醒醒！我们还什么都没有战胜啊！】

我猛地摇她的肩膀——可她就是不睁眼

【明明这样…你为什么能在这种地方睡着啊…!】

风

诶？

渐渐被红色缩侵染的室外，开始侵透着仿佛能撕裂耳膜般的暴风声

红色

简直就像是在强迫着想要反抗的我们接受绝望一般

暴风声变得越来越大

简直像暴风雨一般

无数的羽毛，密密麻麻地贴上了窗玻璃

这简直像是无数双眼镜正透过窗户，正在窥视着室内的我们

![](https://cdn.luogu.com.cn/upload/pic/14449.png)

给你一棵树，边权为1，有点权

需要支持两个操作：

1 x y z表示把树上x到y这条简单路径的所有点点权都加上z

2 x y表示查询与点x距离 <= 1的所有点里面的第y小点权

## 输入输出格式

### 输入格式

第一行两个数n,m

第二行n个数表示每个点的点权

之后n-1行，每行两个数x,y表示x和y之间连有一条边

之后m行

每行为1 x y z或者2 x y形式

意义如上述

### 输出格式

输出m行，每行一个数表示答案

数据保证每次询问都存在答案

## 输入输出样例

### 输入样例 #1

```cpp
5 5
3 4 3 1 3
1 2
1 3
2 4
3 5
2 1 3
2 1 1
1 1 1 1
2 1 3
1 4 1 1

```
### 输出样例 #1

```cpp
4
3
4

```
## 说明

Idea：nzhtl1477，

Solution：nzhtl1477( $O( nlog^2n/loglogn )$ solution )，negiizhao( $O( nlognlogloglogn )$ solution )，ccz181078( $O( nlogn )$ solution )，

Code：nzhtl1477( $O( nlog^2n/loglogn )$ code )

Data：nzhtl1477( partially uploaded )

subtask1：20% n,m <= 1000

subtask2：10% 树为一条链

subtask3：20% n,m <= 100000

subtask4：30% n,m <= 400000

subtask5：20% n,m <= 1000000

对于100%的数据，n,m<=1000000 , 每次加的数 <= 2000，初始的点权<=2000

【我不想消失，也不想离开啊，可怕，好可怕啊，老师…】

抱歉…

加奈，我昨天太无情了

没能鼓励吓得发抖的你，不，甚至根本没想去这么做。

我真是一个没用的人啊

可是请你相信我

我没有忘记你，也没有觉得你无所谓，更不可能会讨厌你

我最喜欢加奈了，是爱你，我是爱你啊

我非常非常喜欢你，就像对大家那样，非常非常地喜欢你

可是，在你最最痛苦的时候，我却没有温柔的对你，没能为最喜欢的你做些什么

对不起啊，对不起啊，加奈

我真是个差劲的老师

【老师…】

——我让你感到孤独了吧，感到寂寞了吧

——我也让你感到害怕了吧

所以等着吧！我肯定回去救你的！我肯定会把你，把大家都救出来的！

【老师…老师…】

![](https://cdn.luogu.com.cn/upload/pic/14450.png)

加奈哭喊着，用绝不输给正在咆哮的狂风般的声音，哭喊着

【我，会等着的！】

【老师，我非常，非常地喜欢你哦，就像最喜欢的妈妈一样，最喜欢你哦——】

——起风了

一瞬间，我们被风吹得睁不开眼睛

当睁开眼时，

加奈已经在我们面前消失了

