# [yLOI2018] 不老梦

## 题目背景

于万人中万幸得以相逢

刹那间澈净明通

成为我所向披靡的勇气和惶恐

裂山海 堕苍穹

——银临《不老梦》

## 题目描述

扶苏非常喜欢一边听古风歌一边写毒瘤分块题。所以这个题的题面恶意卡了分块。

给你一个序列，这个序列中的每个数字有三个参数:$v_i,a_i,b_i$。这个序列中的数有一个非常神奇的有关时间的性质：每过一个时刻，序列中第$i$个数字的值$v_i$会增加$a_i~\times~b_i$。现在扶苏会对你做出一些询问和对序列进行一些修改。每次询问形如:在第$t$时刻区间$[l,r]$的区间$v$和是多少。每次修改形如在第$t$时刻修改区间$[l,r]$位置的$a$，将之整体加上一个整数$x$。或者在$t$时刻对修改区间$[l,r]$位置的$b$，将之整体加上一个整数$y$，又或者在$t$时刻修改$[l,r]$位置的$v$，将之整体加上一个整数$z$。

规定初始时刻为时刻0。

## 输入输出格式

### 输入格式

第一行是两个整数$n,m$，分别代表序列数的个数以及操作的个数

下面$n$行，每行$3$个整数，第$i$行的整数$v_i,a_i,b_i$分别代表第$i$个位置的三个参数

下面m行，每行第一个数是$opt$，代表操作的种类。

> 对于$opt~=~1$的情况，代表对序列进行一次查询。查询参数形如$t~x~y$，代表查询时刻$t$区间$[x,y]$中$v$的和

>

> 对于$opt~=~2$的情况，代表对序列的$a$进行一次修改操作。修改参数形如$t~x~y~z$，代表在第$t$时刻将区间$[x,y]$中$a$的值加上$z$

>

> 对于$opt~=~3$的情况，代表对序列的$b$进行一次修改操作。修改参数形如$t~x~y~z$，代表在第$t$时刻将区间$[x,y]$中$b$的值加上$z$

>

> 对于$opt~=~4$的情况，代表对序列的$v$进行一次修改操作。修改参数形如$t~x~y~z$，代表在第$t$时刻将区间$[x,y]$中$v$的值加上$z$

数据保证参数$t$是单调递增的，不存在同一时刻有超过一种查询或询问。

### 输出格式

对于每次查询操作，输出一个一行一个整数，代表查询的答案对$100000007$取模的答案。

## 输入输出样例

### 输入样例 #1

```cpp
5 5
1 2 3
4 5 6
7 8 9
10 11 12
13 14 15
2 1 1 3 2 
1 3 2 3
3 4 1 4 -3
4 5 1 3 -5
1 6 1 5
```


### 输出样例 #1

```cpp
377
2708
```


## 说明

各个测试点的数据规模如下表所示：

![qwq](https://cdn.luogu.com.cn/upload/pic/38334.png)

样例解释如下：

![qwq](https://cdn.luogu.com.cn/upload/pic/38337.png)

