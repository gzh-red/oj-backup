# SubString

## 题目描述

给定一个字符串`init`，要求支持两个操作

- 在当前字符串的后面插入一个字符串

- 询问字符串$s$在当前字符串中出现了几次？(作为连续子串)

强制在线。

## 输入输出格式

### 输入格式

第一行一个整数$Q$表示操作个数

第二行一个字符串表示初始字符串`init`

接下来Q行，每行2个字符串`Type`,`Str`

- `Type`是`ADD`，表示在后面插入字符串。

- `Type`是`QUERY`，表示询问某字符串在当前字符串中出现了几次。

为了体现在线操作，你需要维护一个变量`mask`，初始值为$0$

![](https://cdn.luogu.com.cn/upload/pic/51008.png)

读入串`Str`之后，使用这个过程将之解码成真正询问的串`TrueStr`。

询问的时候，对`TrueStr`询问后输出一行答案`Result`

然后$mask=mask \bigoplus Result$

插入的时候，将`TrueStr`插到当前字符串后面即可。

**注意：`ADD`和`QUERY`操作的字符串都需要解压**

### 输出格式

对于每一个`QUERY`操作，输出询问的字符串在当前字符串中出现了几次。

## 输入输出样例

### 输入样例 #1

```cpp
2
A
QUERY B
ADD BBABBBBAAB
```


### 输出样例 #1

```cpp
0
```


## 说明

$|S| \leq 6 \times 10^5$，$Q \leq 10^4$,询问总长度$\leq 3 \times 10^6$

为防止评测过慢，对于测试点2 3 5 6 8 11 时限为3s，其余为1s

