# [COCI 2009] OTOCI / 极地旅行社

## 题目描述

不久之前，Mirko建立了一个旅行社，名叫“极地之梦”。这家旅行社在北极附近购买了N座冰岛，并且提供观光服务。

当地最受欢迎的当然是帝企鹅了，这些小家伙经常成群结队的游走在各个冰岛之间。Mirko的旅行社遭受一次重大打击，以至于观光游轮已经不划算了。旅行社将在冰岛之间建造大桥，并用观光巴士来运载游客。

Mirko希望开发一个电脑程序来管理这些大桥的建造过程，以免有不可预料的错误发生。这些冰岛从1到N标号。一开始时这些岛屿没有大桥连接，并且所有岛上的帝企鹅数量都是知道的。每座岛上的企鹅数量虽然会有所改变，但是始终在[0, 1000]之间。你的程序需要处理以下三种命令：

1. bridge A B：询问结点A与结点B是否连通。如果是则输出“no”。否则输出“yes”，并且在结点A和结点B之间连一条无向边。

2. penguins A X：将结点A对应的权值wA修改为X。

3. excursion A B：如果结点A和结点B不连通，则输出“impossible”。否则输出结点A到结点B的路径上的点对应的权值的和。

给出q个操作，要求在线处理所有操作。

## 输入输出格式

### 输入格式

第一行包含一个整数n(1<=n<=30000)，表示节点的数目。

第二行包含n个整数，第i个整数表示第i个节点初始时对应的权值。

第三行包含一个整数q(1<=q<=300000)，表示操作的数目。

以下q行，每行包含一个操作，操作的类别见题目描述。

任意时刻每个节点对应的权值都是1到1000的整数。

### 输出格式

输出所有bridge操作和excursion操作对应的输出，每个一行。

## 输入输出样例

### 输入样例 #1

```cpp
5
4 2 4 5 6
10
excursion 1 1
excursion 1 2
bridge 1 2
excursion 1 2
bridge 3 4
bridge 3 5
excursion 4 5
bridge 1 3
excursion 2 4
excursion 2 5
```


### 输出样例 #1

```cpp
4
impossible
yes
6
yes
yes
15
yes
15
16
```


### 输入样例 #2

```cpp
6
1 2 3 4 5 6
10
bridge 1 2
bridge 2 3
bridge 4 5
excursion 1 3
excursion 1 5
bridge 3 4
excursion 1 5
penguins 3 10
excursion 1 3
bridge 1 5
```


### 输出样例 #2

```cpp
yes
yes
yes
6
impossible
yes
15
13
no
```


## 说明

数据范围：1<=n<=30000, 1<=q<=300000, 0<=wi<=1000。

