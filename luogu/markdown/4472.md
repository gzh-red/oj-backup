# [BJWC2018]八维

## 题目描述

我们将一个M 行N 列的字符矩阵无限复制，可以得到一个无限字符矩阵。例如，对于以下矩阵

![](https://cdn.luogu.com.cn/upload/pic/17865.png)，

可以无限复制出矩阵

![](https://cdn.luogu.com.cn/upload/pic/17866.png)。

我们认为矩阵是八连通的。八连通， 指矩阵中的每个位置与上下左右和四个斜向(左上、右上、左下、右下) 的位置相邻。因此，从矩阵任意位置出发沿八个方向中的任意一个都可以无限延长。

如果我们随机选择一个位置和一个方向，则可以从此位置开始沿此方向连续选取K 个字符组成一个字符串。问，两次这样操作得到两个相同字符串的概率是多少。(假设随机选择时任意位置是等可能的，任意方向也是等可能的)

## 输入输出格式

### 输入格式

第一行是三个整数M, N, K。

接下来M 行， 每行一个由小写英文字母组成的长度为N 的字符串，即M*N的字符矩阵。保证矩阵中至少出现两种不同字符。

### 输出格式

输出一行，为一个化简后的分数，表示概率。

## 输入输出样例

### 输入样例 #1

```cpp
1 2 2
ab
```


### 输出样例 #1

```cpp
5/16
```


### 输入样例 #2

```cpp
3 3 10
ban
ana
nab
```


### 输出样例 #2

```cpp
2/27
```


## 说明

**【样例解释】**

样例一中，一次操作共有16 种可能，其中得到aa 的概率是1/8,得到ab 的概率是3/8,得到bb 的概率是1/8，得到ba 的概率是3/8。两次操作结果相同的

概率是5/16。

**【数据规模和约定】**

30%的测试数据 ：$M, N ≤ 10,K ≤ 100$。

50%的测试数据： $M = N$。

100%的测试数据 ：$1 ≤ M,N ≤ 500,2 ≤ K ≤ 10^9$。

