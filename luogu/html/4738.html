<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>[CERC2017]Cumulative Code - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573381749:jfr3pNb88FZet2wNgnICvsQ/4rWhIS4ezqBDKmiajFg=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%22%2C%22description%22%3A%22As%20you%20probably%20know%2C%20a%20tree%20is%20a%20graph%20consisting%20of%20%24n%24%20nodes%20and%20%24n%20-%201%24%20undirected%20edges%20in%20which%20any%20two%20nodes%20are%20connected%20by%20exactly%20one%20path.%20In%20a%20labeled%20tree%20each%20node%20is%20labeled%20with%20a%20different%20integer%20between%20%241%24%20and%20%24n%24.%5CnThe%20Pr%5Cu00fcfer%20code%20of%20a%20labeled%20tree%20is%20a%20unique%20sequence%20associated%20with%20the%20tree%2C%20generated%20by%20repeatedly%20removing%20nodes%20from%20the%20tree%20until%20only%20two%20nodes%20remain.%20More%20precisely%2C%20in%20each%20step%20we%20remove%20the%20leaf%20with%20the%20smallest%20label%20and%20append%20the%20label%20of%20its%20neighbour%20to%20the%20end%20of%20the%20code.%20Recall%2C%20a%20leaf%20is%5Cna%20node%20with%20exactly%20one%20neighbour.%20Therefore%2C%20the%20Pr%5Cu00fcfer%20code%20of%20a%20labeled%20tree%20is%20an%20integer%20sequence%20of%20length%20%24n%20-%202%24.%20It%20can%20be%20shown%20that%20the%20original%20tree%20can%20be%20easily%20reconstructed%20from%20its%20Pr%5Cu00fcfer%20code.%5CnThe%20complete%20binary%20tree%20of%20depth%20%24k%24%2C%20denoted%20with%20%24C_k%24%2C%20is%20a%20labeled%20tree%20with%20%242%5Ek%20-%201%24%20nodes%20where%20node%20%24j%24%20is%20connected%20to%20nodes%20%242j%24%20and%20%242j%20%2B%201%24%20for%20all%20%24j%20%3C%202%5E%7Bk-1%7D%24.%20Denote%20the%20Pr%5Cu00fcfer%20code%20of%20%24C_k%24%20with%20%24p_1%2Cp_2%2C...%2C%20p_%7B2%5Ek-3%7D%24.%5CnSince%20the%20Pr%5Cu00fcfer%20code%20of%20%24C_k%24%20can%20be%20quite%20long%2C%20you%20do%20not%20have%20to%20print%20it%20out.%20Instead%2C%20you%20need%20to%20answer%20%24n%24%20questions%20about%20the%20sums%20of%20certain%20elements%20on%20the%20code.%20Each%20question%20consists%20of%20three%20integers%3A%20%24a%2C%20d%24%20and%20%24m%24.%20The%20answer%20is%20the%20sum%20of%20the%20of%20the%20%24C_k%27%24%20s%20Pr%5Cu00fcfer%20code%20elements%20%24p_a%2C%20p_%7Ba%2Bd%7D%2Cp_%7Ba%2B2d%7D%2C...%2Cp_%7Ba%2B%28m-1%29d%7D%24.%5Cn%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20two%20integers%20%24k%24%20and%20%24q%282%20%5C%5Cle%20k%20%5C%5Cle%2030%2C1%20%5C%5Cle%20q%20%5C%5Cle%20300%29%24%20%5Cu2014%20the%20depth%20of%20the%20complete%20binary%20tree%20and%20the%20number%20of%20questions.%20The%20%24j-th%24%20of%20the%20following%20%24q%24%20lines%20contains%20the%20%24j-th%24%20question%3Athree%20positive%20integers%20%24a_j%2Cd_j%24%20and%20%24m_j%24%20such%20that%20%24a_j%2Cd_j%24%20and%20%24a_j%20%2B%20%28m_j%20-%201%29d_j%24%20are%20all%20at%20most%20%242%5Ek%20-%203%24.%5Cn%22%2C%22outputFormat%22%3A%22Output%201%20lines.%20The%20%24j-th%24%20line%20should%20contain%20a%20single%20integer%20%5Cu2014%20the%20answer%20to%20the%20%24j-th%24%20question.%5Cn%22%2C%22samples%22%3A%5B%5B%223%205%5Cn1%201%201%5Cn2%201%201%5Cn3%201%201%5Cn4%201%201%5Cn5%201%201%22%2C%222%5Cn2%5Cn1%5Cn3%5Cn3%22%5D%2C%5B%224%204%5Cn2%201%205%5Cn4%204%203%5Cn4%208%201%5Cn10%203%202%22%2C%2218%5Cn15%5Cn5%5Cn13%22%5D%2C%5B%227%201%5Cn1%201%20125%22%2C%224031%22%5D%5D%2C%22hint%22%3A%22In%20the%20first%20example%20above%2C%20when%20constructing%20the%20Pr%5Cu00fcfer%20code%20for%20%24C_3%24%20the%20nodes%20are%20removed%20in%20the%20following%20order%3A%20%244%2C%205%2C%202%2C%201%2C%206%24.%20Therefore%2C%20the%20Pr%5Cu00fcfer%20code%20of%20%24C_3%24%20is%20%242%2C%202%2C%201%2C%203%2C%203%24.%5Cn%22%2C%22provider%22%3A%7B%22uid%22%3A41051%2C%22name%22%3A%22%5Cu548c%5Cu6cc9%5Cu6b63%5Cu5b97%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3Anull%2C%22isAdmin%22%3Afalse%2C%22color%22%3A%22Blue%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B7000%2C7000%2C7000%2C7000%2C7000%2C7000%2C7000%2C7000%5D%2C%22memory%22%3A%5B512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22tags%22%3A%5B34%2C319%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A6%2C%22totalAccepted%22%3A4%2C%22pid%22%3A%22P4738%22%2C%22title%22%3A%22%5BCERC2017%5DCumulative%20Code%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22P%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22%5BCERC2017%5DCumulative%20Code%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573295103;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>[CERC2017]Cumulative Code</h1>
<h2>题目描述</h2>
<div>As you probably know, a tree is a graph consisting of $n$ nodes and $n - 1$ undirected edges in which any two nodes are connected by exactly one path. In a labeled tree each node is labeled with a different integer between $1$ and $n$.
The Prüfer code of a labeled tree is a unique sequence associated with the tree, generated by repeatedly removing nodes from the tree until only two nodes remain. More precisely, in each step we remove the leaf with the smallest label and append the label of its neighbour to the end of the code. Recall, a leaf is
a node with exactly one neighbour. Therefore, the Prüfer code of a labeled tree is an integer sequence of length $n - 2$. It can be shown that the original tree can be easily reconstructed from its Prüfer code.
The complete binary tree of depth $k$, denoted with $C_k$, is a labeled tree with $2^k - 1$ nodes where node $j$ is connected to nodes $2j$ and $2j + 1$ for all $j < 2^{k-1}$. Denote the Prüfer code of $C_k$ with $p_1,p_2,..., p_{2^k-3}$.
Since the Prüfer code of $C_k$ can be quite long, you do not have to print it out. Instead, you need to answer $n$ questions about the sums of certain elements on the code. Each question consists of three integers: $a, d$ and $m$. The answer is the sum of the of the $C_k'$ s Prüfer code elements $p_a, p_{a+d},p_{a+2d},...,p_{a+(m-1)d}$.
</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains two integers $k$ and $q(2 \le k \le 30,1 \le q \le 300)$ — the depth of the complete binary tree and the number of questions. The $j-th$ of the following $q$ lines contains the $j-th$ question:three positive integers $a_j,d_j$ and $m_j$ such that $a_j,d_j$ and $a_j + (m_j - 1)d_j$ are all at most $2^k - 3$.
</div>
<h3>输出格式</h3>
<br />
<div>Output 1 lines. The $j-th$ line should contain a single integer — the answer to the $j-th$ question.
</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>3 5
1 1 1
2 1 1
3 1 1
4 1 1
5 1 1</code></pre>
<h3>输出样例 #1</h3>
<pre><code>2
2
1
3
3</code></pre>
<h3>输入样例 #2</h3>
<pre><code>4 4
2 1 5
4 4 3
4 8 1
10 3 2</code></pre>
<h3>输出样例 #2</h3>
<pre><code>18
15
5
13</code></pre>
<h3>输入样例 #3</h3>
<pre><code>7 1
1 1 125</code></pre>
<h3>输出样例 #3</h3>
<pre><code>4031</code></pre>
<h2>说明</h2>
<div>In the first example above, when constructing the Prüfer code for $C_3$ the nodes are removed in the following order: $4, 5, 2, 1, 6$. Therefore, the Prüfer code of $C_3$ is $2, 2, 1, 3, 3$.
</div>
</article>
</div>
</div>
</body>
</html>
