<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>[BJOI2019]送别 - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573382467:P9KIg35y4fl0zCjkLmcvKYD8W9PJplM4PUDOBMmJAaE=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%22%2C%22description%22%3A%22%5Cu6cd5%5Cu73de%5Cu662f%5Cu4e2a%5Cu6015%5Cu9ed1%5Cu7684%5Cu5973%5Cu5b69%5Cu5b50%5Cu3002%5Cn%5Cn%5Cu508d%5Cu665a%5Cu4e86%5Cuff0c%5Cu6cd5%5Cu73de%5Cu6240%5Cu53c2%5Cu52a0%5Cu7684%5Cu5b66%5Cu672f%5Cu4f1a%5Cu8bae%5Cu65e9%5Cu5df2%5Cu6563%5Cu4f1a%5Cu3002%5Cu9ece%5Cu745f%5Cu4e5f%5Cu4e0b%5Cu4e86%5Cu8bfe%5Cu8fc7%5Cu6765%5Cu63a5%5Cu6cd5%5Cu73de%5Cu56de%5Cu706b%5Cu8f66%5Cu7ad9%5Cu3002%5Cn%5Cn%5Cu4f46%5Cu662f%5Cu6559%5Cu5b66%5Cu697c%5Cu91cc%5Cu7a81%5Cu7136%5Cu65ad%5Cu7535%5Cu4e86%5Cuff0c%5Cu6cd5%5Cu73de%5Cu9677%5Cu5165%5Cu4e86%5Cu4e00%5Cu7247%5Cu6f06%5Cu9ed1%5Cu4e4b%5Cu4e2d%5Cu3002%5Cn%5Cn%5Cu597d%5Cu5728%5Cu9ece%5Cu745f%5Cu5df2%5Cu7ecf%5Cu5230%5Cu4e86%5Cu6559%5Cu5b66%5Cu697c%5Cu7684%5Cu540c%5Cu4e00%5Cu5c42%5Cu3002%5Cn%5Cn%5Cu7136%5Cu800c%5Cu7531%5Cu4e8e%5Cu6559%5Cu5b66%5Cu697c%5Cu7684%5Cu7ed3%5Cu6784%5Cu8fc7%5Cu4e8e%5Cu590d%5Cu6742%5Cuff0c%5Cu5979%5Cu4eec%5Cu5df2%5Cu7ecf%5Cu8bb0%5Cu4e0d%5Cu8d77%5Cu6559%5Cu5b66%5Cu697c%5Cu7684%5Cu5177%5Cu4f53%5Cu7ed3%5Cu6784%5Cu4e86%5Cu3002%5Cn%5Cu9ece%5Cu745f%5Cu5b66%5Cu6821%5Cu7684%5Cu6559%5Cu5b66%5Cu697c%5Cu6bcf%5Cu5c42%5Cu7684%5Cu7ed3%5Cu6784%5Cu90fd%5Cu975e%5Cu5e38%5Cu5de5%5Cu6574%5Cu3002%5Cn%5Cn%5Cu5f62%5Cu5f0f%5Cu5316%5Cu5730%5Cu8bf4%5Cuff0c%5Cu6559%5Cu5b66%5Cu697c%5Cu7684%5Cu4e00%5Cu5c42%5Cu7684%5Cu5e73%5Cu9762%5Cu7ed3%5Cu6784%5Cu53ef%5Cu4ee5%5Cu753b%5Cu5728%5Cu4e8c%5Cu7ef4%5Cu5e73%5Cu9762%5Cu4e0a%5Cu4ee5%20%24%280%2C0%29%24%20%5Cu4e3a%5Cu5de6%5Cu4e0a%5Cu89d2%5Cu9876%5Cu70b9%5Cuff0c%24%28n%2Cm%29%24%20%5Cu4e3a%5Cu53f3%5Cu4e0b%5Cu89d2%5Cu9876%5Cu70b9%5Cu7684%5Cu5b50%5Cu77e9%5Cu5f62%5Cuff08%5Cu8bb0%5Cu4e3a%20%24%280%2C0%29%20-%20%28n%2Cm%29%24%20%20%5Cu7684%5Cu77e9%5Cu5f62%5Cuff09%5Cu91cc%5Cuff0c%5Cu8fd9%5Cu4e2a%5Cu5b50%5Cu77e9%5Cu5f62%5Cu7684%5Cu56db%5Cu6761%5Cu8fb9%5Cu662f%5Cu6559%5Cu5b66%5Cu697c%5Cu7684%5Cu697c%5Cu4f53%28%5Cu6216%5Cu8005%5Cu8bf4%5Cu662f%5Cu56db%5Cu6bb5%5Cu5df2%5Cu77e5%5Cu4e00%5Cu5b9a%5Cu5b58%5Cu5728%5Cu7684%5Cu5899%29%5Cu3002%5Cn%5Cn%2A%2A%5Cu8bf7%5Cu6ce8%5Cu610f%5Cuff0c%5Cu672c%5Cu9898%5Cu4e2d%5Cu7684%5Cu5750%5Cu6807%5Cu7cfb%5Cu548c%5Cu666e%5Cu901a%5Cu7684%5Cu5e73%5Cu9762%5Cu76f4%5Cu89d2%5Cu5750%5Cu6807%5Cu7cfb%5Cu4e0d%5Cu540c%5Cuff0c%24%280%2C0%29%24%20%5Cu662f%5Cu5de6%5Cu4e0a%5Cu89d2%5Cu7684%5Cu9876%5Cu70b9%5Cu800c%20%24%28n%2Cm%29%24%20%5Cu662f%5Cu53f3%5Cu4e0b%5Cu89d2%5Cu7684%5Cu9876%5Cu70b9%5Cu3002%20%24%28i%2Cj%29%24%20%5Cu8868%5Cu793a%5Cu7684%5Cu662f%5Cu7b2c%20%24i%2B1%24%20%5Cu884c%5Cu7b2c%20%24j%2B1%24%20%5Cu5217%5Cu7684%5Cu9876%5Cu70b9%5Cu800c%5Cu4e0d%5Cu662f%5Cu6a2a%5Cu5750%5Cu6807%5Cu4e3a%20%24i%24%20%5Cu7eb5%5Cu5750%5Cu6807%5Cu4e3a%20%24j%24%20%5Cu7684%5Cu9876%5Cu70b9%5Cu3002%2A%2A%5Cn%5Cn%5Cu6bcf%5Cu4e00%5Cu6bb5%5Cu5899%5Cuff08%5Cu65e0%5Cu6cd5%5Cu901a%5Cu8fc7%5Cu7684%5Cu90e8%5Cu5206%5Cuff09%5Cu662f%5Cu4e00%5Cu6761%5Cu7aef%5Cu70b9%5Cu4e3a%20%24%28i%2Cj%29%24%20%5Cu548c%20%24%28i%27%2Cj%27%29%24%20%5Cu7684%5Cu7ebf%5Cu6bb5%5Cuff0c%5Cu8bb0%5Cu4f5c%20%24%28i%2Cj%29%20-%20%28i%27%2Cj%27%29%24%20%5Cu7684%5Cu5899%5Cuff0c%5Cu5176%5Cu4e2d%20%24%7Ci-i%27%7C%20%2B%20%7Cj-j%27%7C%20%3D1%24%20%5Cu4e14%20%24i%2Ci%27%24%20%5Cu662f%20%24%5B0%2Cn%5D%24%20%5Cu4e2d%5Cu7684%5Cu6574%5Cu6570%5Cuff0c%20%24j%2Cj%27%24%20%5Cu662f%20%24%5B0%2Cm%5D%24%20%5Cu4e2d%5Cu7684%5Cu6574%5Cu6570%5Cuff08%5Cu6bcf%5Cu5f53%5Cu6211%5Cu4eec%5Cu4e4b%5Cu540e%5Cu4f7f%5Cu7528%20%24%28i%2Cj%29%20-%20%28i%27%2Cj%27%29%24%20%5Cu7684%5Cu8bb0%5Cu6cd5%5Cuff0c%5Cu6211%5Cu4eec%5Cu90fd%5Cu4fdd%5Cu8bc1%5Cu6ee1%5Cu8db3%5Cu4e0a%5Cu8ff0%5Cu6240%5Cu6709%5Cu6761%5Cu4ef6%5Cuff09%5Cu3002%5Cn%5Cn%5Cu6cd5%5Cu73de%5Cu77e5%5Cu9053%5Cuff0c%5Cu5bf9%5Cu4e8e%5Cu8fd9%5Cu79cd%5Cu7ed3%5Cu6784%5Cuff0c%5Cu6709%5Cu4e00%5Cu79cd%5Cu529e%5Cu6cd5%5Cu53ef%5Cu80fd%5Cu8ba9%5Cu5979%5Cu627e%5Cu5230%5Cu9ece%5Cu745f%5Cuff1a%5Cu6cd5%5Cu73de%5Cu7528%5Cu5de6%5Cu624b%5Cu6276%5Cu4f4f%5Cu5899%5Cuff0c%5Cu624b%5Cu81c2%5Cu548c%5Cu5899%5Cu9762%5Cu5782%5Cu76f4%5Cuff0c%5Cu4fdd%5Cu6301%5Cu8fd9%5Cu4e2a%5Cu72b6%5Cu6001%5Cu5411%5Cu524d%5Cu65b9%5Cu8d70%5Cuff0c%5Cu5728%5Cu8f6c%5Cu5f2f%5Cu5904%5Cu4e5f%5Cu4fdd%5Cu6301%5Cu5de6%5Cu624b%5Cu4e00%5Cu76f4%5Cu6276%5Cu5899%5Cu7684%5Cu72b6%5Cu6001%5Cu3002%5Cu6309%5Cu7167%5Cu8fd9%5Cu4e2a%5Cu65b9%5Cu6cd5%5Cu5979%5Cu5c31%5Cu53ef%5Cu4ee5%5Cu73af%5Cu7ed5%5Cu4e00%5Cu5468%5Cuff0c%5Cu53ef%5Cu80fd%5Cu4e0e%5Cu9ece%5Cu745f%5Cu76f8%5Cu9047%5Cu3002%5Cn%5Cn%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fpic%5C%2F57058.png%29%5Cn%5Cn%5Cu4e0a%5Cu56fe%5Cu662f%5Cu6837%5Cu4f8b%5Cu8f93%5Cu5165%5Cu4e2d%5Cu7b2c%5Cu4e00%5Cu6b21%5Cu8be2%5Cu95ee%5Cu7684%5Cu6cd5%5Cu73de%5Cu7684%5Cu884c%5Cu8d70%5Cu65b9%5Cu6848%5Cuff0c%5Cu5728%5Cu884c%5Cu8d70%5Cu8fc7%5Cu7a0b%5Cu4e2d%5Cu6cd5%5Cu73de%5Cu7684%5Cu5de6%5Cu624b%5Cu5fc5%5Cu987b%5Cu8d34%5Cu4f4f%5Cu5899%5Cu3002%5Cn%5Cn%5Cu6cd5%5Cu73de%5Cu4e00%5Cu5f00%5Cu59cb%5Cu4f1a%5Cu7ed9%5Cu4f60%5Cu9700%5Cu8981%5Cu7ef4%5Cu62a4%5Cu7684%5Cu521d%5Cu59cb%5Cu7684%28%5Cu8fd9%5Cu5c42%5Cu697c%5Cu7684%29%5Cu7ed3%5Cu6784%5Cuff0c%5Cu4e4b%5Cu540e%5Cu4f1a%5Cu7ed9%5Cu4f60%20%24q%24%20%5Cu4e2a%5Cu8bf7%5Cu6c42%5Cu3002%5Cn%5Cn%2B%20%5Cu64cd%5Cu4f5c%201%20%5Cuff1a%20%5Cu8bfb%5Cu5165%5Cu683c%5Cu5f0f%5Cu5f62%5Cu5982%20%241%20%5C%5C%20x_0%20%5C%5C%20y_0%20%5C%5C%20x_1%20%5C%5C%20x_2%24%5Cuff1a%5Cu6cd5%5Cu73de%5Cu8bf7%5Cu6c42%5Cu5728%5Cu5f53%5Cu524d%5Cu7ed3%5Cu6784%5Cu91cc%5Cu6dfb%5Cu52a0%5Cu4e00%5Cu6bb5%20%24%28x_0%2Cy_0%29%20-%20%28x_1%2Cy_1%29%24%20%5Cu7684%5Cu5899%5Cuff0c%5Cu4fdd%5Cu8bc1%5Cu6b64%5Cu524d%5Cu8fd9%5Cu6bb5%5Cu5899%5Cu4e0d%5Cu5b58%5Cu5728%5Cu4e14%5Cu8fd9%5Cu6bb5%5Cu5899%5Cu4e0d%5Cu5728%20%24%280%2C0%29%20-%20%28n%2Cm%29%24%20%5Cu7684%5Cu5b50%5Cu77e9%5Cu5f62%5Cu7684%5Cu56db%5Cu6761%5Cu8fb9%5Cu4e0a%5Cu3002%5Cn%5Cn%2B%20%5Cu64cd%5Cu4f5c2%5Cuff1a%20%5Cu8bfb%5Cu5165%5Cu683c%5Cu5f0f%5Cu5f62%5Cu5982%20%242%20%5C%5C%20x_0%20%5C%5C%20y_0%20%5C%5C%20x_1%20%5C%5C%20x_2%24%5Cuff1a%5Cu6cd5%5Cu73de%5Cu8bf7%5Cu6c42%5Cu5728%5Cu5f53%5Cu524d%5Cu7ed3%5Cu6784%5Cu91cc%5Cu5220%5Cu9664%5Cu4e00%5Cu6bb5%20%24%28x_0%2Cy_0%29%20-%20%28x_1%2Cy_1%29%24%20%5Cu7684%5Cu5899%5Cuff0c%5Cu4fdd%5Cu8bc1%5Cu6b64%5Cu524d%5Cu8fd9%5Cu6bb5%5Cu5899%5Cu5b58%5Cu5728%5Cu4e14%5Cu8fd9%5Cu6bb5%5Cu5899%5Cu4e0d%5Cu5728%20%24%280%2C0%29%20-%20%28n%2Cm%29%24%20%5Cu7684%5Cu5b50%5Cu77e9%5Cu5f62%5Cu7684%5Cu56db%5Cu6761%5Cu8fb9%5Cu4e0a%5Cu3002%5Cn%5Cn%2B%20%5Cu64cd%5Cu4f5c3%5Cuff1a%20%5Cu8bfb%5Cu5165%5Cu683c%5Cu5f0f%5Cu5f62%5Cu5982%20%243%5C%5C%20x_0%20%5C%5C%20y_0%20%5C%5C%20x_1%5C%5C%20y_1%5C%5C%20d_0%20%5C%5C%20x_2%20%5C%5C%20y_2%20%5C%5C%20x_3%20%5C%5C%20y_3%20%5C%5C%20d_1%24%20%5Cuff1a%5Cu6cd5%5Cu73de%5Cu5f53%5Cu524d%5Cu5728%20%24%28x_0%2Cy_0%29%20-%20%28x_1%2Cy_1%29%24%20%5Cu7684%5Cu5899%5Cu7684%5Cu4e2d%5Cu70b9%5Cu4f4d%5Cu7f6e%20%24%28%5C%5Cfrac%7Bx0%2Bx1%7D%7B2%7D%2C%5C%5Cfrac%7By_0%20%2B%20y_1%7D%7B2%7D%29%24%20%5Cuff0c%20%24d_0%24%20%5Cu662f%5Cu4e00%5Cu4e2a%20%24%5B0%2C1%5D%24%20%5Cu4e2d%5Cu7684%5Cu6574%5Cu6570%5Cuff0c%5Cu7528%5Cu6765%5Cu63cf%5Cu8ff0%5Cu6cd5%5Cu73de%5Cu5728%5Cu5899%5Cu7684%5Cu54ea%5Cu4e00%5Cu4fa7%5Cuff0c%20%24d_0%20%20%3D%200%24%20%5Cu4ee3%5Cu8868%5Cu6cd5%5Cu73de%5Cu5728%5Cu5899%5Cu7684%5Cu5de6%5Cu65b9%5C%2F%5Cu4e0a%5Cu65b9%5Cuff0c%20%24d_0%20%3D%201%24%20%5Cu4ee3%5Cu8868%5Cu53f3%5Cu65b9%5C%2F%5Cu4e0b%5Cu65b9%5Cu3002%5Cu9ece%5Cu745f%5Cu5f53%5Cu524d%5Cu5728%20%24%28x_2%2Cy_2%29%20-%20%28x_3%2Cy_3%29%24%20%5Cu7684%5Cu5899%5Cu7684%5Cu4e2d%5Cu70b9%5Cu4f4d%5Cu7f6e%20%20%24%28%5C%5Cfrac%7Bx2%2Bx3%7D%7B2%7D%2C%5C%5Cfrac%7By_2%2By_3%7D%7B2%7D%29%24%20%5Cu3002%20%24d_1%24%20%5Cu7684%5Cu683c%5Cu5f0f%5Cu548c%20%24d_0%24%20%5Cu76f8%5Cu540c%5Cu3002%5Cu4fdd%5Cu8bc1%20%24%28x_0%2Cy_0%29%20-%20%28x_1%2Cy_1%29%24%20%5Cu548c%20%24%28x_2%2Cy_2%29%20-%20%28x_3%2Cy_3%29%24%20%5Cu8fd9%5Cu4e24%5Cu6bb5%5Cu5899%5Cu5b58%5Cu5728%5Cuff0c%5Cu4e14%5Cu6cd5%5Cu73de%5Cu548c%5Cu9ece%5Cu745f%5Cu7684%5Cu4f4d%5Cu7f6e%5Cu90fd%5Cu843d%5Cu5728%20%24%280%2C0%29%20-%20%28n%2Cm%29%24%20%5Cu7684%5Cu5b50%5Cu77e9%5Cu5f62%5Cu7684%5Cu5185%5Cu90e8%5Cu3002%5Cu6c42%5Cu6cd5%5Cu73de%5Cu6309%5Cu7167%5Cu9898%5Cu76ee%5Cu6240%5Cu8ff0%5Cu7684%5Cu65b9%5Cu6cd5%5Cu627e%5Cu5230%5Cu9ece%5Cu745f%5Cu8981%5Cu8d70%5Cu8fc7%5Cu591a%5Cu5c11%5Cu957f%5Cu5ea6%5Cuff08%20%24%28i%2Cj%29%20-%20%28i%27%2Cj%27%29%24%20%20%5Cu8fd9%5Cu6bb5%5Cu5899%5Cu7684%5Cu957f%5Cu5ea6%5Cu4e3a%20%241%24%5Cuff0c%5Cu534a%5Cu6bb5%5Cu5899%5Cuff08%5Cu7531%5Cu4e8e%5Cu8d77%5Cu70b9%5Cu548c%5Cu7ec8%5Cu70b9%5Cu90fd%5Cu5728%5Cu5899%5Cu7684%5Cu4e2d%5Cu70b9%5Cu5904%5Cuff09%5Cu7684%5Cu957f%5Cu5ea6%5Cu662f%20%20%24%5C%5Cfrac%7B1%7D%7B2%7D%24%20%5Cuff09%5Cu3002%5Cn%5Cn%22%2C%22inputFormat%22%3A%22%5Cu8f93%5Cu5165%5Cu5171%20%242n%2Bq%24%20%5Cu884c%5Cu3002%5Cn%5Cn%5Cu7b2c%5Cu4e00%5Cu884c%5Cu4e09%5Cu4e2a%5Cu6574%5Cu6570%20%24n%24%20%5Cu3001%24m%24%20%5Cu3001%24q%24%20%5Cuff0c%5Cu610f%5Cu4e49%5Cu5982%5Cu9898%5Cu76ee%5Cu4e2d%5Cu6240%5Cu793a%5Cu3002%5Cn%5Cn%5Cu63a5%5Cu4e0b%5Cu6765%5Cu7684%20%24n%24%20%5Cu884c%5Cuff0c%5Cu6bcf%5Cu884c%20%24m-1%24%20%5Cu4e2a%20%24%5B0%2C1%5D%24%20%5Cu4e2d%5Cu7684%5Cu6574%5Cu6570%5Cuff0c%5Cu7b2c%20%24i%24%20%5Cu884c%5Cu7b2c%20%24j%24%20%5Cu5217%5Cu7684%5Cu6574%5Cu6570%5Cu4e3a%20%241%24%20%5Cu8868%5Cu793a%20%24%28i%2Cj%29%20-%20%28i-1%2Cj%29%24%20%5Cu8fd9%5Cu4e00%5Cu6bb5%5Cu6709%5Cu5899%5Cuff0c%5Cu4e3a%20%240%24%20%5Cu5219%5Cu8868%5Cu793a%20%24%28i%2Cj%29%20-%20%28i%20-%201%2Cj%29%24%20%5Cu8fd9%5Cu4e00%5Cu6bb5%5Cu6ca1%5Cu6709%5Cu5899%5Cu3002%5Cn%5Cn%5Cu63a5%5Cu4e0b%5Cu6765%5Cu7684%20%24n-1%24%20%5Cu884c%5Cuff0c%5Cu6bcf%5Cu884c%20%24m%24%20%5Cu4e2a%20%24%5B0%2C1%5D%24%20%5Cu4e2d%5Cu7684%5Cu6574%5Cu6570%5Cuff0c%5Cu7b2c%20%24i%24%20%5Cu884c%5Cu7b2c%20%24j%24%20%5Cu5217%5Cu7684%5Cu6574%5Cu6570%5Cu4e3a%20%241%24%20%5Cu8868%5Cu793a%20%24%28i%2Cj%29%20-%20%28i%2Cj-1%29%24%20%5Cu8fd9%5Cu4e00%5Cu6bb5%5Cu6709%5Cu5899%5Cuff0c%5Cu4e3a%20%240%24%20%5Cu5219%5Cu8868%5Cu793a%20%24%28i%2Cj%29%20-%20%28i%2Cj-1%29%24%20%5Cu8fd9%5Cu4e00%5Cu6bb5%5Cu6ca1%5Cu6709%5Cu5899%5Cu3002%5Cn%5Cn%5Cu63a5%5Cu4e0b%5Cu6765%5Cu7684%20%24q%24%20%5Cu884c%5Cuff0c%5Cu6bcf%5Cu884c%5Cu4e00%5Cu4e2a%5Cu64cd%5Cu4f5c%5Cuff0c%5Cu683c%5Cu5f0f%5Cu5982%5Cu9898%5Cu76ee%5Cu4e2d%5Cu6240%5Cu793a%5Cu3002%22%2C%22outputFormat%22%3A%22%5Cu5bf9%5Cu4e8e%5Cu6bcf%5Cu4e2a%5Cu8be2%5Cu95ee%5Cuff0c%5Cu8f93%5Cu51fa%5Cu6cd5%5Cu73de%5Cu6309%5Cu7167%5Cu9898%5Cu76ee%5Cu6240%5Cu8ff0%5Cu7684%5Cu65b9%5Cu6cd5%5Cu627e%5Cu5230%5Cu9ece%5Cu745f%5Cu8981%5Cu8d70%5Cu8fc7%5Cu591a%5Cu5c11%5Cu957f%5Cu5ea6%5Cuff0c%2A%2A%5Cu5982%5Cu679c%5Cu6cd5%5Cu73de%5Cu6309%5Cu7167%5Cu9898%5Cu76ee%5Cu6240%5Cu8ff0%5Cu7684%5Cu65b9%5Cu6cd5%5Cu65e0%5Cu6cd5%5Cu627e%5Cu5230%5Cu9ece%5Cu745f%5Cu5219%5Cu8f93%5Cu51fa%20%24-1%24%20%5Cu3002%2A%2A%22%2C%22samples%22%3A%5B%5B%223%203%204%5Cn0%200%5Cn1%200%5Cn0%200%5Cn1%200%201%5Cn0%200%201%5Cn3%203%200%203%201%200%200%203%201%203%200%5Cn1%202%201%202%200%5Cn2%201%200%201%201%5Cn3%202%202%202%203%201%201%202%201%203%200%22%2C%2211%5Cn16%22%5D%5D%2C%22hint%22%3A%22%5Cu5bf9%5Cu4e8e%2010%25%20%5Cu7684%5Cu6570%5Cu636e%5Cuff0c%20%245%20%5C%5Cle%20n%2Cm%20%5C%5Cle%2050%24%20%5Cuff0c%20%241%20%5C%5Cle%20q%20%5C%5Cle%20%202000%24%20%5Cu3002%5Cn%5Cn%5Cu5bf9%5Cu4e8e%5Cu53e6%5Cu5916%2030%25%20%5Cu7684%5Cu6570%5Cu636e%5Cuff0c%5Cu6ca1%5Cu6709%201%20%5Cu64cd%5Cu4f5c%5Cu3002%5Cn%5Cn%5Cu5bf9%5Cu4e8e%5Cu53e6%5Cu5916%2030%25%20%5Cu7684%5Cu6570%5Cu636e%5Cuff0c%5Cu4fdd%5Cu8bc1%5Cu5728%5Cu4efb%5Cu610f%5Cu65f6%5Cu523b%5Cu82e5%5Cu6cd5%5Cu73de%5Cu548c%5Cu9ece%5Cu745f%5Cu7ad9%5Cu5728%5Cu4efb%5Cu610f%5Cu8f93%5Cu5165%5Cu683c%5Cu5f0f%5Cu4e2d%5Cu5408%5Cu6cd5%5Cu7684%5Cu4f4d%5Cu7f6e%5Cuff0c%5Cu6cd5%5Cu73de%5Cu90fd%5Cu53ef%5Cu4ee5%5Cu548c%5Cu9ece%5Cu745f%5Cu76f8%5Cu9047%5Cu3002%5Cn%5Cn%5Cu5bf9%5Cu4e8e100%25%5Cu7684%5Cu6570%5Cu636e%5Cuff0c%245%20%5C%5Cle%20n%2Cm%20%5C%5Cle%20500%24%20%5Cuff0c%20%241%20%5C%5Cle%20q%20%5C%5Cle%202%20%5C%5Ctimes%2010%5E5%24%20%5Cu3002%22%2C%22provider%22%3A%7B%22uid%22%3A57601%2C%22name%22%3A%22cqqqwq%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3Anull%2C%22isAdmin%22%3Afalse%2C%22color%22%3A%22Blue%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%2C2000%2C2000%2C2000%2C2000%2C2000%2C2000%2C2000%2C2000%2C2000%2C2000%2C2000%2C2000%2C2000%2C2000%2C2000%2C2000%2C2000%2C2000%2C2000%5D%2C%22memory%22%3A%5B512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22tags%22%3A%5B36%2C48%2C94%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A38%2C%22totalAccepted%22%3A15%2C%22pid%22%3A%22P5321%22%2C%22title%22%3A%22%5BBJOI2019%5D%5Cu9001%5Cu522b%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A157500%2C%22title%22%3A%22%5Cu8bf4%5Cu53e5%5Cu95f2%5Cu8bdd%5Cuff0c%5Cu7ec3%5Cu4e60%5Cu7801%5Cu529b%5Cu7684%5Cu6700%5Cu597d%5Cu65b9%5Cu5f0f%5Cu662f%5Cu2026%5Cu2026%22%2C%22forum%22%3A%7B%22id%22%3A35897%2C%22name%22%3A%22P5321%20%5BBJOI2019%5D%5Cu9001%5Cu522b%22%2C%22slug%22%3A%22P5321%22%7D%7D%2C%7B%22id%22%3A133725%2C%22title%22%3A%22%5Cu9898%5Cu76ee%5Cu80cc%5Cu666f%5Cu597d%5Cu8bc4%5Cuff0c%5Cu9898%5Cu76ee%5Cu5dee%5Cu8bc4%22%2C%22forum%22%3A%7B%22id%22%3A35897%2C%22name%22%3A%22P5321%20%5BBJOI2019%5D%5Cu9001%5Cu522b%22%2C%22slug%22%3A%22P5321%22%7D%7D%2C%7B%22id%22%3A110922%2C%22title%22%3A%22%5Cu51fa%5Cu9898%5Cu4eba%5Cu7684%5Cu7d20%5Cu8d28%5Cu53ef%5Cu89c1%5Cu4e00%5Cu6591%22%2C%22forum%22%3A%7B%22id%22%3A35897%2C%22name%22%3A%22P5321%20%5BBJOI2019%5D%5Cu9001%5Cu522b%22%2C%22slug%22%3A%22P5321%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22%5BBJOI2019%5D%5Cu9001%5Cu522b%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573295103;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>[BJOI2019]送别</h1>
<h2>题目描述</h2>
<div>法珞是个怕黑的女孩子。
傍晚了，法珞所参加的学术会议早已散会。黎瑟也下了课过来接法珞回火车站。
但是教学楼里突然断电了，法珞陷入了一片漆黑之中。
好在黎瑟已经到了教学楼的同一层。
然而由于教学楼的结构过于复杂，她们已经记不起教学楼的具体结构了。
黎瑟学校的教学楼每层的结构都非常工整。
形式化地说，教学楼的一层的平面结构可以画在二维平面上以 $(0,0)$ 为左上角顶点，$(n,m)$ 为右下角顶点的子矩形（记为 $(0,0) - (n,m)$ 的矩形）里，这个子矩形的四条边是教学楼的楼体(或者说是四段已知一定存在的墙)。
**请注意，本题中的坐标系和普通的平面直角坐标系不同，$(0,0)$ 是左上角的顶点而 $(n,m)$ 是右下角的顶点。 $(i,j)$ 表示的是第 $i+1$ 行第 $j+1$ 列的顶点而不是横坐标为 $i$ 纵坐标为 $j$ 的顶点。**
每一段墙（无法通过的部分）是一条端点为 $(i,j)$ 和 $(i',j')$ 的线段，记作 $(i,j) - (i',j')$ 的墙，其中 $|i-i'| + |j-j'| =1$ 且 $i,i'$ 是 $[0,n]$ 中的整数， $j,j'$ 是 $[0,m]$ 中的整数（每当我们之后使用 $(i,j) - (i',j')$ 的记法，我们都保证满足上述所有条件）。
法珞知道，对于这种结构，有一种办法可能让她找到黎瑟：法珞用左手扶住墙，手臂和墙面垂直，保持这个状态向前方走，在转弯处也保持左手一直扶墙的状态。按照这个方法她就可以环绕一周，可能与黎瑟相遇。
![](https://cdn.luogu.com.cn/upload/pic/57058.png)
上图是样例输入中第一次询问的法珞的行走方案，在行走过程中法珞的左手必须贴住墙。
法珞一开始会给你需要维护的初始的(这层楼的)结构，之后会给你 $q$ 个请求。
+ 操作 1 ： 读入格式形如 $1 \ x_0 \ y_0 \ x_1 \ x_2$：法珞请求在当前结构里添加一段 $(x_0,y_0) - (x_1,y_1)$ 的墙，保证此前这段墙不存在且这段墙不在 $(0,0) - (n,m)$ 的子矩形的四条边上。
+ 操作2： 读入格式形如 $2 \ x_0 \ y_0 \ x_1 \ x_2$：法珞请求在当前结构里删除一段 $(x_0,y_0) - (x_1,y_1)$ 的墙，保证此前这段墙存在且这段墙不在 $(0,0) - (n,m)$ 的子矩形的四条边上。
+ 操作3： 读入格式形如 $3\ x_0 \ y_0 \ x_1\ y_1\ d_0 \ x_2 \ y_2 \ x_3 \ y_3 \ d_1$ ：法珞当前在 $(x_0,y_0) - (x_1,y_1)$ 的墙的中点位置 $(\frac{x0+x1}{2},\frac{y_0 + y_1}{2})$ ， $d_0$ 是一个 $[0,1]$ 中的整数，用来描述法珞在墙的哪一侧， $d_0 = 0$ 代表法珞在墙的左方/上方， $d_0 = 1$ 代表右方/下方。黎瑟当前在 $(x_2,y_2) - (x_3,y_3)$ 的墙的中点位置 $(\frac{x2+x3}{2},\frac{y_2+y_3}{2})$ 。 $d_1$ 的格式和 $d_0$ 相同。保证 $(x_0,y_0) - (x_1,y_1)$ 和 $(x_2,y_2) - (x_3,y_3)$ 这两段墙存在，且法珞和黎瑟的位置都落在 $(0,0) - (n,m)$ 的子矩形的内部。求法珞按照题目所述的方法找到黎瑟要走过多少长度（ $(i,j) - (i',j')$ 这段墙的长度为 $1$，半段墙（由于起点和终点都在墙的中点处）的长度是 $\frac{1}{2}$ ）。
</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>输入共 $2n+q$ 行。
第一行三个整数 $n$ 、$m$ 、$q$ ，意义如题目中所示。
接下来的 $n$ 行，每行 $m-1$ 个 $[0,1]$ 中的整数，第 $i$ 行第 $j$ 列的整数为 $1$ 表示 $(i,j) - (i-1,j)$ 这一段有墙，为 $0$ 则表示 $(i,j) - (i - 1,j)$ 这一段没有墙。
接下来的 $n-1$ 行，每行 $m$ 个 $[0,1]$ 中的整数，第 $i$ 行第 $j$ 列的整数为 $1$ 表示 $(i,j) - (i,j-1)$ 这一段有墙，为 $0$ 则表示 $(i,j) - (i,j-1)$ 这一段没有墙。
接下来的 $q$ 行，每行一个操作，格式如题目中所示。</div>
<h3>输出格式</h3>
<br />
<div>对于每个询问，输出法珞按照题目所述的方法找到黎瑟要走过多少长度，**如果法珞按照题目所述的方法无法找到黎瑟则输出 $-1$ 。**</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>3 3 4
0 0
1 0
0 0
1 0 1
0 0 1
3 3 0 3 1 0 0 3 1 3 0
1 2 1 2 0
2 1 0 1 1
3 2 2 2 3 1 1 2 1 3 0</code></pre>
<h3>输出样例 #1</h3>
<pre><code>11
16</code></pre>
<h2>说明</h2>
<div>对于 10% 的数据， $5 \le n,m \le 50$ ， $1 \le q \le 2000$ 。
对于另外 30% 的数据，没有 1 操作。
对于另外 30% 的数据，保证在任意时刻若法珞和黎瑟站在任意输入格式中合法的位置，法珞都可以和黎瑟相遇。
对于100%的数据，$5 \le n,m \le 500$ ， $1 \le q \le 2 \times 10^5$ 。</div>
</article>
</div>
</div>
</body>
</html>
