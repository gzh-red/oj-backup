<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>[NOI2008]奥运物流 - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573381139:YvMeUVwZ70m2k9ZvEBPxCjyBrPASE3yUMiCchHVXIcs=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%22%2C%22description%22%3A%222008%20%5Cu5317%5Cu4eac%5Cu5965%5Cu8fd0%5Cu4f1a%5Cu5373%5Cu5c06%5Cu5f00%5Cu5e55%5Cuff0c%5Cu4e3e%5Cu56fd%5Cu4e0a%5Cu4e0b%5Cu90fd%5Cu5728%5Cu4e3a%5Cu8fd9%5Cu4e00%5Cu76db%5Cu4e8b%5Cu505a%5Cu597d%5Cu51c6%5Cu5907%5Cu3002%5Cu4e3a%5Cu4e86%5Cu9ad8%5Cu6548%5Cu7387%5Cu3001%20%5Cu6210%5Cu529f%5Cu5730%5Cu4e3e%5Cu529e%5Cu5965%5Cu8fd0%5Cu4f1a%5Cuff0c%5Cu5bf9%5Cu7269%5Cu6d41%5Cu7cfb%5Cu7edf%5Cu8fdb%5Cu884c%5Cu89c4%5Cu5212%5Cu662f%5Cu5fc5%5Cu4e0d%5Cu53ef%5Cu5c11%5Cu7684%5Cu3002%5Cn%5Cn%5Cu7269%5Cu6d41%5Cu7cfb%5Cu7edf%5Cu7531%5Cu82e5%5Cu5e72%5Cu7269%5Cu6d41%5Cu57fa%5Cu7ad9%5Cu7ec4%5Cu6210%5Cuff0c%5Cu4ee5%201%5Cu2026N%20%5Cu8fdb%5Cu884c%5Cu7f16%5Cu53f7%5Cu3002%5Cu6bcf%5Cu4e2a%5Cu7269%5Cu6d41%5Cu57fa%5Cu7ad9%20i%20%5Cu90fd%5Cu6709%5Cu4e14%20%5Cu4ec5%5Cu6709%5Cu4e00%5Cu4e2a%5Cu540e%5Cu7ee7%5Cu57fa%5Cu7ad9%20Si%5Cuff0c%5Cu800c%5Cu53ef%5Cu4ee5%5Cu6709%5Cu591a%5Cu4e2a%5Cu524d%5Cu9a71%5Cu57fa%5Cu7ad9%5Cu3002%5Cu57fa%5Cu7ad9%20i%20%5Cu4e2d%5Cu9700%5Cu8981%5Cu7ee7%5Cu7eed%5Cu8fd0%5Cu8f93%5Cu7684%5Cu7269%5Cu8d44%5Cu90fd%20%5Cu5c06%5Cu88ab%5Cu8fd0%5Cu5f80%5Cu540e%5Cu7ee7%5Cu57fa%5Cu7ad9%20Si%5Cuff0c%5Cu663e%5Cu7136%5Cu4e00%5Cu4e2a%5Cu7269%5Cu6d41%5Cu57fa%5Cu7ad9%5Cu7684%5Cu540e%5Cu7ee7%5Cu57fa%5Cu7ad9%5Cu4e0d%5Cu80fd%5Cu662f%5Cu5176%5Cu672c%5Cu8eab%5Cu3002%5Cu7f16%5Cu53f7%5Cu4e3a%201%20%5Cu7684%20%5Cu7269%5Cu6d41%5Cu57fa%5Cu7ad9%5Cu79f0%5Cu4e3a%5Cu63a7%5Cu5236%5Cu57fa%5Cu7ad9%5Cuff0c%5Cu4ece%5Cu4efb%5Cu4f55%5Cu7269%5Cu6d41%5Cu57fa%5Cu7ad9%5Cu90fd%5Cu53ef%5Cu5c06%5Cu7269%5Cu8d44%5Cu8fd0%5Cu5f80%5Cu63a7%5Cu5236%5Cu57fa%5Cu7ad9%5Cu3002%5Cu6ce8%5Cu610f%20%5Cu63a7%5Cu5236%5Cu57fa%20%5Cu7ad9%5Cu4e5f%5Cu6709%5Cu540e%5Cu7ee7%5Cu57fa%5Cu7ad9%5Cuff0c%5Cu4ee5%5Cu4fbf%5Cu5728%5Cu9700%5Cu8981%5Cu65f6%5Cu8fdb%5Cu884c%5Cu7269%5Cu8d44%5Cu7684%5Cu6d41%5Cu901a%5Cu3002%5Cu5728%5Cu7269%5Cu6d41%5Cu7cfb%5Cu7edf%5Cu4e2d%5Cuff0c%5Cu9ad8%5Cu53ef%5Cu9760%5Cu6027%5Cu4e0e%5Cu4f4e%20%5Cu6210%5Cu672c%5Cu662f%5Cu4e3b%5Cu8981%5Cu8bbe%5Cu8ba1%5Cu76ee%5Cu3002%5Cu5bf9%5Cu4e8e%5Cu57fa%5Cu7ad9%20i%5Cuff0c%5Cu6211%5Cu4eec%5Cu5b9a%5Cu4e49%5Cu5176%5Cu201c%5Cu53ef%5Cu9760%5Cu6027%5Cu201d%20%28%29%20R%20i%20%5Cu5982%5Cu4e0b%5Cuff1a%20%5Cn%5Cu8bbe%5Cu7269%5Cu6d41%5Cu57fa%5Cu7ad9%20i%20%5Cu6709%20w%20%5Cu4e2a%5Cu524d%5Cu9a71%5Cu57fa%5Cu7ad9%20P1%2CP2%2C...%2CPw%20%5Cuff0c%5Cu5373%5Cu8fd9%5Cu4e9b%5Cu57fa%5Cu7ad9%5Cu4ee5%20i%20%5Cu4e3a%5Cu540e%5Cu7ee7%5Cu57fa%5Cu7ad9%5Cuff0c%5Cu5219%5Cu57fa%20%5Cu7ad9%20i%20%5Cu7684%5Cu53ef%5Cu9760%5Cu6027%20R%28i%29%5Cu6ee1%5Cu8db3%5Cu4e0b%5Cu5f0f%5Cuff1a%20%5Cn%24%24R%28i%29%3DC_i%2Bk%20%5C%5Csum_%7Bj%3D1%7D%5E%7Bw%7DR%28P_j%29%24%24%5Cn%5Cn%5Cu5176%5Cu4e2d%20Ci%5Cu548c%20k%20%5Cu90fd%5Cu662f%5Cu5e38%5Cu5b9e%5Cu6570%5Cu4e14%5Cu6052%5Cu4e3a%5Cu6b63%5Cuff0c%5Cu4e14%5Cu6709%20k%20%5Cu5c0f%5Cu4e8e%201%5Cu3002%5Cn%5Cn%5Cu6574%5Cu4e2a%5Cu7cfb%5Cu7edf%5Cu7684%5Cu53ef%5Cu9760%5Cu6027%5Cu4e0e%5Cu63a7%5Cu5236%5Cu57fa%5Cu7ad9%5Cu7684%5Cu53ef%5Cu9760%5Cu6027%5Cu6b63%5Cu76f8%5Cu5173%5Cuff0c%5Cu6211%5Cu4eec%5Cu7684%5Cu76ee%5Cu6807%5Cu662f%5Cu901a%5Cu8fc7%5Cu4fee%5Cu6539%5Cu7269%5Cu6d41%20%5Cu7cfb%5Cu7edf%5Cuff0c%5Cu5373%5Cu66f4%5Cu6539%5Cu67d0%5Cu4e9b%5Cu57fa%5Cu7ad9%5Cu7684%5Cu540e%5Cu7ee7%5Cu57fa%5Cu7ad9%5Cuff0c%5Cu4f7f%5Cu5f97%5Cu63a7%5Cu5236%5Cu57fa%5Cu7ad9%5Cu7684%5Cu53ef%5Cu9760%5Cu6027%20R%281%29%5Cu5c3d%5Cu91cf%5Cu5927%5Cu3002%5Cu4f46%5Cu7531%5Cu4e8e%20%5Cu7ecf%5Cu8d39%5Cu9650%5Cu5236%5Cuff0c%5Cu6700%5Cu591a%5Cu53ea%5Cu80fd%5Cu4fee%5Cu6539%20m%20%5Cu4e2a%5Cu57fa%5Cu7ad9%5Cu7684%5Cu540e%5Cu7ee7%5Cu57fa%5Cu7ad9%5Cuff0c%5Cu5e76%5Cu4e14%5Cuff0c%5Cu63a7%5Cu5236%5Cu57fa%5Cu7ad9%5Cu7684%5Cu540e%5Cu7ee7%5Cu57fa%5Cu7ad9%5Cu4e0d%20%5Cu53ef%5Cu88ab%5Cu4fee%5Cu6539%5Cu3002%5Cu56e0%5Cu800c%5Cu6211%5Cu4eec%5Cu6240%5Cu9762%5Cu4e34%5Cu7684%5Cu95ee%5Cu9898%5Cu5c31%5Cu662f%5Cuff0c%5Cu5982%5Cu4f55%5Cu4fee%5Cu6539%5Cu4e0d%5Cu8d85%5Cu8fc7%20m%20%5Cu4e2a%5Cu57fa%5Cu7ad9%5Cu7684%5Cu540e%5Cu7ee7%5Cuff0c%5Cu4f7f%20%5Cu5f97%5Cu63a7%5Cu5236%5Cu57fa%5Cu7ad9%5Cu7684%5Cu53ef%5Cu9760%5Cu6027%20R%281%29%5Cu6700%5Cu5927%5Cu5316%5Cu3002%22%2C%22inputFormat%22%3A%22%5Cu7b2c%5Cu4e00%5Cu884c%5Cu5305%5Cu542b%5Cu4e24%5Cu4e2a%5Cu6574%5Cu6570%5Cu4e0e%5Cu4e00%5Cu4e2a%5Cu5b9e%5Cu6570%5Cuff0cN%2C%20m%2C%20k%5Cu3002%5Cu5176%5Cu4e2d%20N%20%5Cu8868%5Cu793a%5Cu57fa%20%5Cu7ad9%5Cu6570%5Cu76ee%5Cuff0cm%20%5Cu8868%5Cu793a%5Cu6700%5Cu591a%5Cu53ef%5Cu4fee%5Cu6539%5Cu7684%5Cu540e%5Cu7ee7%5Cu57fa%5Cu7ad9%5Cu6570%5Cu76ee%5Cuff0ck%20%5Cu5206%5Cu522b%5Cu4e3a%5Cu53ef%5Cu9760%5Cu6027%5Cu5b9a%5Cu4e49%5Cu4e2d%5Cu7684%5Cu5e38%5Cu6570%5Cu3002%5Cn%5Cn%5Cu7b2c%5Cu4e8c%5Cu884c%5Cu5305%5Cu542b%20N%20%5Cu4e2a%5Cu6574%5Cu6570%5Cuff0c%5Cu5206%5Cu522b%5Cu662f%20S1%2C%20S2%5Cu2026SN%5Cuff0c%5Cu5373%5Cu6bcf%5Cu4e00%5Cu4e2a%5Cu57fa%5Cu7ad9%5Cu7684%5Cu540e%5Cu7ee7%5Cu57fa%5Cu7ad9%5Cu7f16%5Cu53f7%5Cu3002%5Cn%5Cn%5Cu7b2c%5Cu4e09%5Cu884c%5Cu5305%5Cu542b%20N%20%5Cu4e2a%5Cu6b63%5Cu5b9e%5Cu6570%5Cuff0c%5Cu5206%5Cu522b%5Cu662f%20C1%2C%20C2%5Cu2026CN%5Cuff0c%5Cu4e3a%5Cu53ef%5Cu9760%5Cu6027%5Cu5b9a%5Cu4e49%5Cu4e2d%5Cu7684%5Cu5e38%5Cu6570%5Cu3002%22%2C%22outputFormat%22%3A%22%5Cu4ec5%5Cu5305%5Cu542b%5Cu4e00%5Cu4e2a%5Cu5b9e%5Cu6570%5Cuff0c%5Cu4e3a%5Cu53ef%5Cu5f97%5Cu5230%5Cu7684%5Cu6700%5Cu5927%20R%281%29%5Cu3002%5Cu7cbe%5Cu786e%5Cu5230%5Cu5c0f%5Cu6570%5Cu70b9%5Cu4e24%20%5Cu4f4d%5Cu3002%22%2C%22samples%22%3A%5B%5B%224%201%200.5%20%20%5Cn2%203%201%203%20%5Cn10.0%2010.0%2010.0%2010.0%22%2C%2230.00%20%5Cn%22%5D%5D%2C%22hint%22%3A%22%5Cu3010%5Cu6837%5Cu4f8b%5Cu8bf4%5Cu660e%5Cu3011%20%5Cn%5Cu539f%5Cu6709%5Cu7269%5Cu6d41%5Cu7cfb%5Cu7edf%5Cu5982%5Cu5de6%5Cu56fe%5Cu6240%5Cu793a%5Cuff0c4%20%5Cu4e2a%5Cu7269%5Cu6d41%5Cu57fa%5Cu7ad9%5Cu7684%5Cu53ef%5Cu9760%5Cu6027%5Cu4f9d%5Cu6b21%5Cu4e3a%2022.8571%5Cuff0c21.4286%5Cuff0c%2025.7143%5Cuff0c10%5Cu3002%5Cn%5Cn%5Cn%5Cn%5Cu6700%5Cu4f18%5Cu65b9%5Cu6848%5Cu4e3a%5Cu5c06%202%20%5Cu53f7%5Cu57fa%5Cu7ad9%5Cu7684%5Cu540e%5Cu7ee7%5Cu57fa%5Cu7ad9%5Cu6539%5Cu4e3a%201%20%5Cu53f7%5Cu3002%5Cn%5Cn%5Cu6b64%5Cu65f6%204%20%5Cu4e2a%5Cu57fa%5Cu7ad9%20%5Cu7684%5Cu53ef%5Cu9760%5Cu6027%5Cu4f9d%5Cu6b21%5Cu4e3a%2030%5Cuff0c25%5Cuff0c15%5Cuff0c10%5Cu3002%5Cn%5Cu672c%5Cu9898%5Cu7684%5Cu6570%5Cu636e%5Cuff0c%5Cu5177%5Cu6709%5Cu5982%5Cu4e0b%5Cu5206%5Cu5e03%5Cuff1a%20%5Cn%5Cn%5Cu6d4b%5Cu8bd5%5Cu6570%5Cu636e%5Cu7f16%5Cu53f7%7CN%7CM%5Cn-%7C-%7C-%5Cn1%7C%5Cu22646%7C%5Cu22646%5Cn2%7C%5Cu226412%7C%5Cu226412%5Cn3%7C%5Cu226460%7C0%5Cn4%7C%5Cu226460%7C1%5Cn5%7C%5Cu226460%7CN-2%5Cn6~10%7C%5Cu226460%7C%5Cu226460%5Cn%5Cn%20%5Cu5bf9%5Cu4e8e%5Cu6240%5Cu6709%5Cu7684%5Cu6570%5Cu636e%5Cuff0c%5Cu6ee1%5Cu8db3%20m%20%5Cu2264%20N%20%5Cu2264%2060%5Cuff0cCi%20%5Cu2264%20106%5Cuff0c0.3%20%5Cu2264%20k%20%3C%201%5Cuff0c%5Cu8bf7%5Cu4f7f%5Cu7528%5Cu53cc%5Cu7cbe%5Cu5ea6%5Cu5b9e%20%5Cu6570%5Cuff0c%5Cu65e0%5Cu9700%5Cu8003%5Cu8651%5Cu7531%5Cu6b64%5Cu5e26%5Cu6765%5Cu7684%5Cu8bef%5Cu5dee%5Cu3002%22%2C%22provider%22%3A%7B%22uid%22%3A19%2C%22name%22%3A%22CCF_NOI%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3Anull%2C%22isAdmin%22%3Afalse%2C%22color%22%3A%22Gray%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%5D%2C%22memory%22%3A%5B128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22tags%22%3A%5B25%2C77%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A239%2C%22totalAccepted%22%3A127%2C%22pid%22%3A%22P4202%22%2C%22title%22%3A%22%5BNOI2008%5D%5Cu5965%5Cu8fd0%5Cu7269%5Cu6d41%20%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P1758%22%2C%22title%22%3A%22%5BNOI2009%5D%5Cu7ba1%5Cu9053%5Cu53d6%5Cu73e0%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P4201%22%2C%22title%22%3A%22%5BNOI2008%5D%5Cu8bbe%5Cu8ba1%5Cu8def%5Cu7ebf%20%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P4203%22%2C%22title%22%3A%22%5BNOI2008%5D%5Cu7cd6%5Cu679c%5Cu96e8%20%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P4528%22%2C%22title%22%3A%22%5BCTSC2008%5D%5Cu56fe%5Cu817e%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P4684%22%2C%22title%22%3A%22%5BIOI2008%5D%20Fish%20%5Cu9c7c%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22%5BNOI2008%5D%5Cu5965%5Cu8fd0%5Cu7269%5Cu6d41%20%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573286098;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>[NOI2008]奥运物流 </h1>
<h2>题目描述</h2>
<div>2008 北京奥运会即将开幕，举国上下都在为这一盛事做好准备。为了高效率、 成功地举办奥运会，对物流系统进行规划是必不可少的。
物流系统由若干物流基站组成，以 1…N 进行编号。每个物流基站 i 都有且 仅有一个后继基站 Si，而可以有多个前驱基站。基站 i 中需要继续运输的物资都 将被运往后继基站 Si，显然一个物流基站的后继基站不能是其本身。编号为 1 的 物流基站称为控制基站，从任何物流基站都可将物资运往控制基站。注意 控制基 站也有后继基站，以便在需要时进行物资的流通。在物流系统中，高可靠性与低 成本是主要设计目。对于基站 i，我们定义其“可靠性” () R i 如下：
设物流基站 i 有 w 个前驱基站 P1,P2,...,Pw ，即这些基站以 i 为后继基站，则基 站 i 的可靠性 R(i)满足下式：
$$R(i)=C_i+k \sum_{j=1}^{w}R(P_j)$$
其中 Ci和 k 都是常实数且恒为正，且有 k 小于 1。
整个系统的可靠性与控制基站的可靠性正相关，我们的目标是通过修改物流 系统，即更改某些基站的后继基站，使得控制基站的可靠性 R(1)尽量大。但由于 经费限制，最多只能修改 m 个基站的后继基站，并且，控制基站的后继基站不 可被修改。因而我们所面临的问题就是，如何修改不超过 m 个基站的后继，使 得控制基站的可靠性 R(1)最大化。</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>第一行包含两个整数与一个实数，N, m, k。其中 N 表示基 站数目，m 表示最多可修改的后继基站数目，k 分别为可靠性定义中的常数。
第二行包含 N 个整数，分别是 S1, S2…SN，即每一个基站的后继基站编号。
第三行包含 N 个正实数，分别是 C1, C2…CN，为可靠性定义中的常数。</div>
<h3>输出格式</h3>
<br />
<div>仅包含一个实数，为可得到的最大 R(1)。精确到小数点两 位。</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>4 1 0.5  
2 3 1 3 
10.0 10.0 10.0 10.0</code></pre>
<h3>输出样例 #1</h3>
<pre><code>30.00 
</code></pre>
<h2>说明</h2>
<div>【样例说明】
原有物流系统如左图所示，4 个物流基站的可靠性依次为 22.8571，21.4286， 25.7143，10。
最优方案为将 2 号基站的后继基站改为 1 号。
此时 4 个基站 的可靠性依次为 30，25，15，10。
本题的数据，具有如下分布：
测试数据编号|N|M
-|-|-
1|≤6|≤6
2|≤12|≤12
3|≤60|0
4|≤60|1
5|≤60|N-2
6~10|≤60|≤60
对于所有的数据，满足 m ≤ N ≤ 60，Ci ≤ 106，0.3 ≤ k < 1，请使用双精度实 数，无需考虑由此带来的误差。</div>
</article>
</div>
</div>
</body>
</html>
