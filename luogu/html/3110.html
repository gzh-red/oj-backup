<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>[USACO14DEC]驮运Piggy Back - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573376418:B3ArTM5v+C+MQJhQ/1eYdhc7L4mbyxvaTMcOkLOhNDE=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%22%2C%22description%22%3A%22Bessie%20and%20her%20sister%20Elsie%20graze%20in%20different%20fields%20during%20the%20day%2C%20and%20in%20the%20evening%20they%20both%20want%20to%20walk%20back%20to%20the%20barn%20to%20rest.%20Being%20clever%20bovines%2C%20they%20come%20up%20with%20a%20plan%20to%20minimize%20the%20total%20amount%20of%20energy%20they%20both%20spend%20while%20walking.%5Cn%5CnBessie%20spends%20B%20units%20of%20energy%20when%20walking%20from%20a%20field%20to%20an%20adjacent%20field%2C%20and%20Elsie%20spends%20E%20units%20of%20energy%20when%20she%20walks%20to%20an%20adjacent%20field.%20%20However%2C%20if%20Bessie%20and%20Elsie%20are%20together%20in%20the%20same%20field%2C%20Bessie%20can%20carry%20Elsie%20on%20her%20shoulders%20and%20both%20can%20move%20to%20an%20adjacent%20field%20while%20spending%20only%20P%20units%20of%20energy%20%28where%20P%20might%20be%20considerably%20less%20than%20B%2BE%2C%20the%20amount%20Bessie%20and%20Elsie%20would%20have%20spent%20individually%20walking%20to%20the%20adjacent%20field%29.%20%20If%20P%20is%20very%20small%2C%20the%20most%20energy-efficient%20solution%20may%20involve%20Bessie%20and%20Elsie%20traveling%20to%20a%20common%20meeting%20field%2C%20then%20traveling%20together%20piggyback%20for%20the%20rest%20of%20the%20journey%20to%20the%20barn.%20%20Of%20course%2C%20if%20P%20is%20large%2C%20it%20may%20still%20make%20the%20most%20sense%20for%20Bessie%20and%20Elsie%20to%20travel%5Cn%5Cnseparately.%20%20On%20a%20side%20note%2C%20Bessie%20and%20Elsie%20are%20both%20unhappy%20with%20the%20term%20%5C%22piggyback%5C%22%2C%20as%20they%20don%27t%20see%20why%20the%20pigs%20on%20the%20farm%20should%20deserve%20all%20the%20credit%20for%20this%20remarkable%20form%20of%5Cn%5Cntransportation.%5Cn%5CnGiven%20B%2C%20E%2C%20and%20P%2C%20as%20well%20as%20the%20layout%20of%20the%20farm%2C%20please%20compute%20the%20minimum%20amount%20of%20energy%20required%20for%20Bessie%20and%20Elsie%20to%20reach%20the%20barn.%5Cn%5CnBessie%20%5Cu548c%20Elsie%5Cu5728%5Cu4e0d%5Cu540c%5Cu7684%5Cu533a%5Cu57df%5Cu653e%5Cu7267%5Cuff0c%5Cu4ed6%5Cu4eec%5Cu5e0c%5Cu671b%5Cu82b1%5Cu8d39%5Cu6700%5Cu5c0f%5Cu7684%5Cu80fd%5Cu91cf%5Cu8fd4%5Cu56de%5Cu8c37%5Cu4ed3%5Cu3002%5Cu4ece%5Cu4e00%5Cu4e2a%5Cu533a%5Cu57df%5Cu8d70%5Cu5230%5Cu4e00%5Cu4e2a%5Cu76f8%5Cu8fde%5Cu533a%5Cu57df%5Cuff0cBessie%5Cu8981%5Cu82b1%5Cu8d39B%5Cu5355%5Cu4f4d%5Cu7684%5Cu80fd%5Cu91cf%5Cuff0cElsie%5Cu8981%5Cu82b1%5Cu8d39E%5Cu5355%5Cu4f4d%5Cu7684%5Cu80fd%5Cu91cf%5Cu3002%5Cn%5Cn%5Cn%5Cu5982%5Cu679c%5Cu67d0%5Cu6b21%5Cu4ed6%5Cu4eec%5Cu4e24%5Cu8d70%5Cu5230%5Cu540c%5Cu4e00%5Cu4e2a%5Cu533a%5Cu57df%5Cuff0cBessie%20%5Cu53ef%5Cu4ee5%5Cu80cc%5Cu7740%20Elsie%5Cu8d70%5Cu8def%5Cuff0c%5Cu82b1%5Cu8d39P%5Cu5355%5Cu4f4d%5Cu7684%5Cu80fd%5Cu91cf%5Cu8d70%5Cu5230%5Cu53e6%5Cu5916%5Cu4e00%5Cu4e2a%5Cu76f8%5Cu8fde%5Cu7684%5Cu533a%5Cu57df%5Cu3002%5Cu5f53%5Cu7136%5Cuff0c%5Cu5b58%5Cu5728P%3EB%2BE%5Cu7684%5Cu60c5%5Cu51b5%5Cu3002%5Cn%5Cn%5Cn%5Cu76f8%5Cu9047%5Cu540e%5Cuff0c%5Cu4ed6%5Cu4eec%5Cu53ef%5Cu4ee5%5Cu4e00%5Cu76f4%5Cu80cc%5Cu7740%5Cu8d70%5Cuff0c%5Cu4e5f%5Cu53ef%5Cu4ee5%5Cu72ec%5Cu7acb%5Cu5206%5Cu5f00%5Cu3002%5Cn%22%2C%22inputFormat%22%3A%22INPUT%3A%20%28file%20piggyback.in%29%20%5Cn%5CnThe%20first%20line%20of%20input%20contains%20the%20positive%20integers%20B%2C%20E%2C%20P%2C%20N%2C%20and%20M.%20%20All%20of%20these%20are%20at%20most%2040%2C000.%20%20B%2C%20E%2C%20and%20P%20are%20described%20above.%20N%20is%20the%20number%20of%20fields%20in%20the%20farm%20%28numbered%201..N%2C%20where%20N%20%3E%3D%203%29%2C%20and%20M%20is%20the%20number%20of%20connections%20between%20fields.%20%20Bessie%20and%20Elsie%20start%20in%20fields%201%20and%202%2C%20respectively.%20%20The%20barn%20resides%20in%20field%20N.%20%5Cn%5CnThe%20next%20M%20lines%20in%20the%20input%20each%20describe%20a%20connection%20between%20a%20pair%20of%20different%20fields%2C%20specified%20by%20the%20integer%20indices%20of%20the%20two%20fields.%20%20Connections%20are%20bi-directional.%20%20It%20is%20always%20possible%20to%20travel%20from%20field%201%20to%20field%20N%2C%20and%20field%202%20to%20field%20N%2C%20along%20a%20series%20of%20such%20connections.%5Cn%22%2C%22outputFormat%22%3A%22OUTPUT%3A%20%28file%20piggyback.out%29%20%5Cn%5CnA%20single%20integer%20specifying%20the%20minimum%20amount%20of%20energy%20Bessie%20and%5Cn%5CnElsie%20collectively%20need%20to%20spend%20to%20reach%20the%20barn.%20%20In%20the%20example%5Cn%5Cnshown%20here%2C%20Bessie%20travels%20from%201%20to%204%20and%20Elsie%20travels%20from%202%20to%203%5Cn%5Cnto%204.%20%20Then%2C%20they%20travel%20together%20from%204%20to%207%20to%208.%5Cn%22%2C%22samples%22%3A%5B%5B%224%204%205%208%208%20%5Cn1%204%20%5Cn2%203%20%5Cn3%204%20%5Cn4%207%20%5Cn2%205%20%5Cn5%206%20%5Cn6%208%20%5Cn7%208%20%22%2C%2222%20%5Cn%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A20%2C%22name%22%3A%22FarmerJohn2%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3Anull%2C%22isAdmin%22%3Afalse%2C%22color%22%3A%22Gray%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%5D%2C%22memory%22%3A%5B128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22tags%22%3A%5B31%2C46%2C126%2C160%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A1400%2C%22totalAccepted%22%3A751%2C%22pid%22%3A%22P3110%22%2C%22title%22%3A%22%5BUSACO14DEC%5D%5Cu9a6e%5Cu8fd0Piggy%20Back%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22P%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A145765%2C%22title%22%3A%22%5Cu4e0a%5Cu8f66%5Cu5426%3F%22%2C%22forum%22%3A%7B%22id%22%3A2226%2C%22name%22%3A%22P3110%20%5BUSACO14DEC%5D%5Cu9a6e%5Cu8fd0Piggy%20Back%22%2C%22slug%22%3A%22P3110%22%7D%7D%2C%7B%22id%22%3A124941%2C%22title%22%3A%22%5Cu6570%5Cu636e%5Cu8303%5Cu56f4%5Cu6709%5Cu8bef%5Cuff1f%5Cuff1f%22%2C%22forum%22%3A%7B%22id%22%3A2226%2C%22name%22%3A%22P3110%20%5BUSACO14DEC%5D%5Cu9a6e%5Cu8fd0Piggy%20Back%22%2C%22slug%22%3A%22P3110%22%7D%7D%2C%7B%22id%22%3A109911%2C%22title%22%3A%22%5Cu840c%5Cu65b0%5Cu6c42%5Cu52a9%5Cuff0c%5Cu53c8wa%5Cu53c8t%22%2C%22forum%22%3A%7B%22id%22%3A2226%2C%22name%22%3A%22P3110%20%5BUSACO14DEC%5D%5Cu9a6e%5Cu8fd0Piggy%20Back%22%2C%22slug%22%3A%22P3110%22%7D%7D%2C%7B%22id%22%3A99006%2C%22title%22%3A%22%5Cu4e0d%5Cu8bba%5Cu849f%5Cu84bb%5Cu5927%5Cu4f6c%5Cu90fd%5Cu6765%5Cu770b%5Cu770b%5Cu5427%20%5Cu252d%5Cu252e%5Cufe4f%5Cu252d%5Cu252e%22%2C%22forum%22%3A%7B%22id%22%3A2226%2C%22name%22%3A%22P3110%20%5BUSACO14DEC%5D%5Cu9a6e%5Cu8fd0Piggy%20Back%22%2C%22slug%22%3A%22P3110%22%7D%7D%2C%7B%22id%22%3A63663%2C%22title%22%3A%22%5Cu4f2a%5Cu9898%5Cu89e3%22%2C%22forum%22%3A%7B%22id%22%3A2226%2C%22name%22%3A%22P3110%20%5BUSACO14DEC%5D%5Cu9a6e%5Cu8fd0Piggy%20Back%22%2C%22slug%22%3A%22P3110%22%7D%7D%2C%7B%22id%22%3A43134%2C%22title%22%3A%22%5Cu8f93%5Cu5165%5Cu8f93%5Cu51fa%5Cu5927%5Cu610f%22%2C%22forum%22%3A%7B%22id%22%3A2226%2C%22name%22%3A%22P3110%20%5BUSACO14DEC%5D%5Cu9a6e%5Cu8fd0Piggy%20Back%22%2C%22slug%22%3A%22P3110%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P1608%22%2C%22title%22%3A%22%5Cu8def%5Cu5f84%5Cu7edf%5Cu8ba1%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P2502%22%2C%22title%22%3A%22%5BHAOI2006%5D%5Cu65c5%5Cu884c%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P3627%22%2C%22title%22%3A%22%5BAPIO2009%5D%5Cu62a2%5Cu63a0%5Cu8ba1%5Cu5212%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P2939%22%2C%22title%22%3A%22%5BUSACO09FEB%5D%5Cu6539%5Cu9020%5Cu8defRevamping%20Trails%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P3111%22%2C%22title%22%3A%22%5BUSACO14DEC%5D%5Cu725b%5Cu6162%5Cu8dd1Cow%20Jog_Sliver%22%2C%22difficulty%22%3A3%2C%22type%22%3A%22P%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22%5BUSACO14DEC%5D%5Cu9a6e%5Cu8fd0Piggy%20Back%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>[USACO14DEC]驮运Piggy Back</h1>
<h2>题目描述</h2>
<div>Bessie and her sister Elsie graze in different fields during the day, and in the evening they both want to walk back to the barn to rest. Being clever bovines, they come up with a plan to minimize the total amount of energy they both spend while walking.
Bessie spends B units of energy when walking from a field to an adjacent field, and Elsie spends E units of energy when she walks to an adjacent field. However, if Bessie and Elsie are together in the same field, Bessie can carry Elsie on her shoulders and both can move to an adjacent field while spending only P units of energy (where P might be considerably less than B+E, the amount Bessie and Elsie would have spent individually walking to the adjacent field). If P is very small, the most energy-efficient solution may involve Bessie and Elsie traveling to a common meeting field, then traveling together piggyback for the rest of the journey to the barn. Of course, if P is large, it may still make the most sense for Bessie and Elsie to travel
separately. On a side note, Bessie and Elsie are both unhappy with the term "piggyback", as they don't see why the pigs on the farm should deserve all the credit for this remarkable form of
transportation.
Given B, E, and P, as well as the layout of the farm, please compute the minimum amount of energy required for Bessie and Elsie to reach the barn.
Bessie 和 Elsie在不同的区域放牧，他们希望花费最小的能量返回谷仓。从一个区域走到一个相连区域，Bessie要花费B单位的能量，Elsie要花费E单位的能量。
如果某次他们两走到同一个区域，Bessie 可以背着 Elsie走路，花费P单位的能量走到另外一个相连的区域。当然，存在P>B+E的情况。
相遇后，他们可以一直背着走，也可以独立分开。
</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>INPUT: (file piggyback.in)
The first line of input contains the positive integers B, E, P, N, and M. All of these are at most 40,000. B, E, and P are described above. N is the number of fields in the farm (numbered 1..N, where N >= 3), and M is the number of connections between fields. Bessie and Elsie start in fields 1 and 2, respectively. The barn resides in field N.
The next M lines in the input each describe a connection between a pair of different fields, specified by the integer indices of the two fields. Connections are bi-directional. It is always possible to travel from field 1 to field N, and field 2 to field N, along a series of such connections.
</div>
<h3>输出格式</h3>
<br />
<div>OUTPUT: (file piggyback.out)
A single integer specifying the minimum amount of energy Bessie and
Elsie collectively need to spend to reach the barn. In the example
shown here, Bessie travels from 1 to 4 and Elsie travels from 2 to 3
to 4. Then, they travel together from 4 to 7 to 8.
</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>4 4 5 8 8 
1 4 
2 3 
3 4 
4 7 
2 5 
5 6 
6 8 
7 8 </code></pre>
<h3>输出样例 #1</h3>
<pre><code>22 
</code></pre>
</article>
</div>
</div>
</body>
</html>
