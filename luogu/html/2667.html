<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>[TJOI2012]防御 - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573375739:r5TerVbk8sh0YSMuBKj6HEcjuYl5d2NiyCAgNS5cfWk=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%22%2C%22description%22%3A%22%5Cu5728%5Cu4e00%5Cu4e2a%5Cu5854%5Cu9632%5Cu5c0f%5Cu6e38%5Cu620f%5Cu4e2d%5Cuff0c%5Cu6709%5Cu5f88%5Cu591a%5Cu9632%5Cu7ebf%5Cu3002%20%5Cu6bcf%5Cu6761%5Cu9632%5Cu7ebf%5Cu7531%5Cu4e00%5Cu6392n%5Cu4e2a%5Cu72ec%5Cu7acb%5Cu7684%5Cu9632%5Cu5fa1%5Cu4f53%5B1%20%3A%20n%5D%5Cu8fdb%5Cu884c%5Cu9632%5Cu5fa1%5Cu3002%5Cn%5Cn%5Cu6e38%5Cu620f%5Cu8fc7%5Cu7a0b%5Cu4e2d%5Cuff0c%5Cu4f1a%5Cu4e0d%5Cu65ad%5Cu6709%5Cu654c%5Cu4eba%5Cu5bf9%5Cu9632%5Cu7ebf%5Cu8fdb%5Cu884c%5Cu653b%5Cu51fb%5Cuff0c%5Cu6bcf%5Cu6b21%5Cu653b%5Cu51fb%5Cu4f1a%5Cu6307%5Cu5b9a%5Cu9632%5Cu5fa1%5Cu4f53%5Bl%20%3A%20r%5D%5Cu8fdb%5Cu884c%5Cu653b%5Cu51fb%5Cu529b%5Cu4e3aa%5Cu7684%5Cu653b%5Cu51fb%5Cu3002%20%5Cu7b2c%5Cu4e00%5Cu9632%5Cu7ebf%5Cu5177%5Cu6709%5Cu62a4%5Cu7532%5Cuff0c%5Cu62a4%5Cu7532%5Cu627f%5Cu53d7%5Cu653b%5Cu51fb%5Cu540e%5Cuff0c%5Cu5bf9%5Cu5e94%5Cu7684%5Cu9632%5Cu5fa1%5Cu4f53%5Cu6240%5Cu53d7%5Cu5230%5Cu7684%5Cu4f24%5Cu5bb3%5Cu4e3a%5Cu653b%5Cu51fb%5Cu529b%5Cuff0c%5Cu4f46%5Cu62a4%5Cu7532%5Cu627f%5Cu53d7%5Cu7684%5Cu4f24%5Cu5bb3%5Cu603b%5Cu91cf%5Cu5230%5Cu8fbe%5Cu4e00%5Cu5b9a%5Cu7a0b%5Cu5ea6%5Cu540e%5Cu5c31%5Cu4f1a%5Cu7834%5Cu788e%5Cuff0c%5Cu6b64%5Cu65f6%5Cu9632%5Cu5fa1%5Cu4f53%5Cu6240%5Cu53d7%5Cu7684%5Cu4f24%5Cu5bb3%5Cu52a0%5Cu500d%5Cu3002%20%5Cu76ee%5Cu524d%5Cu7b2c%5Cu4e00%5Cu9632%5Cu7ebf%5Cu7684%5Cu529b%5Cu91cf%5Cu5145%5Cu8db3%5Cuff0c%5Cu73a9%5Cu5bb6%5Cu81f4%5Cu529b%5Cu4e8e%5Cu5bf9%5Cu540e%5Cu9762%5Cu7684%5Cu9632%5Cu7ebf%5Cu7684%5Cu5efa%5Cu8bbe%5Cuff0c%5Cu4e0d%5Cu8fc7%5Cu4e3a%5Cu786e%5Cu8ba4%5Cu6e38%5Cu620f%5Cu8fdb%5Cu5ea6%5Cu548c%5Cu7b2c%5Cu4e00%5Cu9632%5Cu7ebf%5Cu7684%5Cu60c5%5Cu51b5%5Cuff0c%5Cu73a9%5Cu5bb6%5Cu4f1a%5Cu4e0d%5Cu65f6%5Cu5730%5Cu5c06%5Cu9f20%5Cu6807%5Cu79fb%5Cu52a8%5Cu5230%5Cu7b2c%5Cu4e00%5Cu9632%5Cu7ebf%5Cu7684%5Cu67d0%5Cu4e2a%5Cu9632%5Cu5fa1%5Cu4f53%5Cu4e0a%5Cuff0c%5Cu4ee5%5Cu67e5%5Cu770b%5Cu5176%5Cu6240%5Cu53d7%5Cu5230%5Cu7684%5Cu4f24%5Cu5bb3%5Cu3002%5Cn%22%2C%22inputFormat%22%3A%22%5Cu7b2c%5Cu4e00%5Cu884c%5Cuff0c%5Cu4e24%5Cu4e2a%5Cu6574%5Cu6570n%3B%20q%5Cuff0c%5Cu5206%5Cu522b%5Cu8868%5Cu793a%5Cu9632%5Cu5fa1%5Cu4f53%5Cu4e2a%5Cu6570%5Cu4ee5%5Cu53ca%5Cu653b%5Cu51fb%5Cu548c%5Cu67e5%5Cu8be2%5Cu7684%5Cu603b%5Cu6570%5Cu3002%5Cn%5Cn%5Cu7b2c%5Cu4e8c%5Cu884c%5Cuff0c%20n%5Cu4e2a%5Cu6570%5Cuff0c%5Cu8868%5Cu793a%5Cu6bcf%5Cu4e2a%5Cu9632%5Cu5fa1%5Cu4f53%5Cu62a4%5Cu7532%5Cu7684%5Cu627f%5Cu53d7%5Cu80fd%5Cu529bpi%5Cu3002%5Cn%5Cn%5Cu63a5%5Cu4e0b%5Cu6765%20q%20%5Cu884c%5Cuff0c%5Cu6bcf%5Cu884c%5Cu53ef%5Cu80fd%5Cu5177%5Cu6709%5Cu5982%5Cu4e0b%5Cu5f62%5Cu5f0f%5Cn%5CnA%20l%20r%20a%20%5Cu8868%5Cu793a%5Cu5bf9%5Cu9632%5Cu5fa1%5Cu4f53%24l%2Cl%2B1%2C%5C%5Ccdots%2Cr%24%5Cu8fdb%5Cu884c%5Cu653b%5Cu51fb%5Cu529b%5Cu4e3aa%5Cu7684%5Cu653b%5Cu51fb%5Cn%5CnQ%20x%20%5Cu8868%5Cu793a%5Cu67e5%5Cu8be2%5Cu9632%5Cu5fa1%5Cu4f53x%5Cu76ee%5Cu524d%5Cu6240%5Cu53d7%5Cu5230%5Cu7684%5Cu4f24%5Cu5bb3%5Cuff0c%5Cu521d%5Cu59cb%5Cu65f6%5Cu4f24%5Cu5bb3%5Cu4e3a0%5Cn%22%2C%22outputFormat%22%3A%22%5Cu4e00%5Cu884c%5Cuff0c%5Cu4e00%5Cu4e2a%5Cu6574%5Cu6570%5Cuff0c%5Cu8868%5Cu793a%5Cu6240%5Cu6709%5Cu67e5%5Cu8be2%5Cu7ed3%5Cu679c%5Cu4e4b%5Cu548c%5Cu5bf91%2C000%2C000%2C009%5Cu7684%5Cu4f59%5Cu6570%5Cn%22%2C%22samples%22%3A%5B%5B%225%207%5Cn3%201%204%201%202%5CnA%201%203%202%5CnQ%202%5CnA%201%204%201%5CnQ%201%5CnA%201%204%201%5CnQ%202%5CnQ%201%22%2C%2216%22%5D%5D%2C%22hint%22%3A%22%23%23%5Cu6837%5Cu4f8b%5Cu89e3%5Cu91ca%5Cn%5Cn3%5C%2F0%201%5C%2F0%204%5C%2F0%201%5C%2F0%202%5C%2F0%5Cn%5Cn%5BA%201%203%202%5D%5Cn%5Cn1%5C%2F2%202%202%5C%2F2%201%5C%2F0%202%5C%2F0%5Cn%5Cn%5BQ%202%5D%20%21%202%5Cn%5Cn%5BA%201%204%201%5D%5Cn%5Cn3%204%201%5C%2F3%201%202%5C%2F0%5Cn%5Cn%5BQ%201%5D%20-%3E%203%5Cn%5Cn%5BA%201%204%201%5D%5Cn%5Cn5%206%204%203%202%5C%2F0%5Cn%5Cn%5BQ%202%5D%20-%3E%206%5Cn%5Cn%5BQ%201%5D%20-%3E%205%5Cn%5Cn%23%23%5Cu6570%5Cu636e%5Cu8303%5Cu56f4%5Cn%5Cn30%25%5Cu7684%5Cu6570%5Cu636e%5Cuff0c%20q%20%5Cu2264%201000%5Cn%5Cn100%25%5Cu7684%5Cu6570%5Cu636e%5Cuff0c%201%20%5Cu2264%20n%20%5Cu2264%20100000%5Cuff0c%201%20%5Cu2264%20q%20%5Cu2264%20100000%5Cuff0c%200%20%5Cu2264%20pi%20%5Cu2264%201000000%5Cuff0c%200%20%5Cu2264%20a%20%5Cu2264%2010000%5Cn%22%2C%22provider%22%3A%7B%22uid%22%3A5037%2C%22name%22%3A%22elijahqi%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3Anull%2C%22isAdmin%22%3Afalse%2C%22color%22%3A%22Blue%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%5D%2C%22memory%22%3A%5B128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22tags%22%3A%5B29%2C48%2C319%2C328%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A965%2C%22totalAccepted%22%3A210%2C%22pid%22%3A%22P2667%22%2C%22title%22%3A%22%5BTJOI2012%5D%5Cu9632%5Cu5fa1%22%2C%22difficulty%22%3A4%2C%22type%22%3A%22P%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A84005%2C%22title%22%3A%22%5Cu8be2%5Cu95ee%5Cu9898%5Cu610f%22%2C%22forum%22%3A%7B%22id%22%3A1967%2C%22name%22%3A%22P2667%20%5BTJOI2012%5D%5Cu9632%5Cu5fa1%22%2C%22slug%22%3A%22P2667%22%7D%7D%2C%7B%22id%22%3A67587%2C%22title%22%3A%22%5Cu521a%5Cu6539%5Cu9898%5Cu9762%5Cuff1f%22%2C%22forum%22%3A%7B%22id%22%3A1967%2C%22name%22%3A%22P2667%20%5BTJOI2012%5D%5Cu9632%5Cu5fa1%22%2C%22slug%22%3A%22P2667%22%7D%7D%2C%7B%22id%22%3A19206%2C%22title%22%3A%22%5Cu8fd9%5Cu9053%5Cu9898%5Cu597d%5Cu50cf%5Cu548cP1218%20%5Cu7279%5Cu6b8a%5Cu7684%5Cu8d28%5Cu6570%5Cu808b%5Cu9aa8%20%5Cu91cd%5Cu590d%5Cu4e86...%22%2C%22forum%22%3A%7B%22id%22%3A1967%2C%22name%22%3A%22P2667%20%5BTJOI2012%5D%5Cu9632%5Cu5fa1%22%2C%22slug%22%3A%22P2667%22%7D%7D%2C%7B%22id%22%3A18460%2C%22title%22%3A%22%5Cu8d85%5Cu65f6%5Cuff01%5Cuff01%5Cuff01%5Cuff01%5Cuff01%22%2C%22forum%22%3A%7B%22id%22%3A1967%2C%22name%22%3A%22P2667%20%5BTJOI2012%5D%5Cu9632%5Cu5fa1%22%2C%22slug%22%3A%22P2667%22%7D%7D%2C%7B%22id%22%3A16807%2C%22title%22%3A%22%5Cu4e3a%5Cu4ec0%5Cu4e48%5Cu4f1a%5Cu7206%5Cu5185%5Cu5b58%5Cuff1f%5Cuff01%5Cuff01%5Cuff01%5Cu6c42%5Cu6559%5Cuff01%5Cuff01%22%2C%22forum%22%3A%7B%22id%22%3A1967%2C%22name%22%3A%22P2667%20%5BTJOI2012%5D%5Cu9632%5Cu5fa1%22%2C%22slug%22%3A%22P2667%22%7D%7D%2C%7B%22id%22%3A10282%2C%22title%22%3A%22%5Cu8d85%5Cu65f6%5Cuff0130%5Cu5206%5Cu3002%5Cu3002%5Cu3002%5Cu3002%5Cu3002%5Cu3002%22%2C%22forum%22%3A%7B%22id%22%3A1967%2C%22name%22%3A%22P2667%20%5BTJOI2012%5D%5Cu9632%5Cu5fa1%22%2C%22slug%22%3A%22P2667%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P1082%22%2C%22title%22%3A%22%5Cu540c%5Cu4f59%5Cu65b9%5Cu7a0b%22%2C%22difficulty%22%3A4%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P1782%22%2C%22title%22%3A%22%5Cu65c5%5Cu884c%5Cu5546%5Cu7684%5Cu80cc%5Cu5305%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P2269%22%2C%22title%22%3A%22%5BHNOI2002%5D%5Cu9ad8%5Cu8d28%5Cu91cf%5Cu7684%5Cu6570%5Cu636e%5Cu4f20%5Cu8f93%22%2C%22difficulty%22%3A4%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P2674%22%2C%22title%22%3A%22%5Cu300a%5Cu77bf%5Cu8469%5Cu7684%5Cu6570%5Cu5b57%5Cu6e38%5Cu620f%5Cu300bT2-%5Cu591a%5Cu8fb9%5Cu5f62%5Cu6570%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22CF1209C%22%2C%22title%22%3A%22Paint%20the%20Digits%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22%5BTJOI2012%5D%5Cu9632%5Cu5fa1%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>[TJOI2012]防御</h1>
<h2>题目描述</h2>
<div>在一个塔防小游戏中，有很多防线。 每条防线由一排n个独立的防御体[1 : n]进行防御。
游戏过程中，会不断有敌人对防线进行攻击，每次攻击会指定防御体[l : r]进行攻击力为a的攻击。 第一防线具有护甲，护甲承受攻击后，对应的防御体所受到的伤害为攻击力，但护甲承受的伤害总量到达一定程度后就会破碎，此时防御体所受的伤害加倍。 目前第一防线的力量充足，玩家致力于对后面的防线的建设，不过为确认游戏进度和第一防线的情况，玩家会不时地将鼠标移动到第一防线的某个防御体上，以查看其所受到的伤害。
</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>第一行，两个整数n; q，分别表示防御体个数以及攻击和查询的总数。
第二行， n个数，表示每个防御体护甲的承受能力pi。
接下来 q 行，每行可能具有如下形式
A l r a 表示对防御体$l,l+1,\cdots,r$进行攻击力为a的攻击
Q x 表示查询防御体x目前所受到的伤害，初始时伤害为0
</div>
<h3>输出格式</h3>
<br />
<div>一行，一个整数，表示所有查询结果之和对1,000,000,009的余数
</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>5 7
3 1 4 1 2
A 1 3 2
Q 2
A 1 4 1
Q 1
A 1 4 1
Q 2
Q 1</code></pre>
<h3>输出样例 #1</h3>
<pre><code>16</code></pre>
<h2>说明</h2>
<div>##样例解释
3/0 1/0 4/0 1/0 2/0
[A 1 3 2]
1/2 2 2/2 1/0 2/0
[Q 2] ! 2
[A 1 4 1]
3 4 1/3 1 2/0
[Q 1] -> 3
[A 1 4 1]
5 6 4 3 2/0
[Q 2] -> 6
[Q 1] -> 5
##数据范围
30%的数据， q ≤ 1000
100%的数据， 1 ≤ n ≤ 100000， 1 ≤ q ≤ 100000， 0 ≤ pi ≤ 1000000， 0 ≤ a ≤ 10000
</div>
</article>
</div>
</div>
</body>
</html>
