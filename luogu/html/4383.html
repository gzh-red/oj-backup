<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>[八省联考2018]林克卡特树lct - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573381346:LAF1WTu9YQMM47qeTjeexbBAuiAZPmiIDw6YomBB/Cs=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%23%5Cu8b66%5Cu544a%5Cuff1a%5Cu6ee5%5Cu7528%5Cu672c%5Cu9898%5Cu8bc4%5Cu6d4b%5Cu5c06%5Cu5c01%5Cu53f7%22%2C%22description%22%3A%22%5Cu5c0fL%20%5Cu6700%5Cu8fd1%5Cu6c89%5Cu8ff7%5Cu4e8e%5Cu585e%5Cu5c14%5Cu8fbe%5Cu4f20%5Cu8bf4%5Cuff1a%5Cu8352%5Cu91ce%5Cu4e4b%5Cu606f%5Cuff08The%20Legend%20of%20Zelda%3A%20Breath%20of%20The%20Wild%5Cuff09%5Cu65e0%5Cu6cd5%5Cu81ea%5Cu62d4%5Cuff0c%5Cu4ed6%5Cu5c24%5Cu5176%5Cu559c%5Cu6b22%5Cu6e38%5Cu620f%5Cu4e2d%5Cu7684%5Cu8ff7%5Cu4f60%5Cu6311%5Cu6218%5Cu3002%5Cn%5Cn%5Cu6e38%5Cu620f%5Cu4e2d%5Cu6709%5Cu4e00%5Cu4e2a%5Cu53eb%5Cu505a%5Cu201cLCT%5Cu201d%20%5Cu7684%5Cu6311%5Cu6218%5Cuff0c%5Cu5b83%5Cu7684%5Cu89c4%5Cu5219%5Cu662f%5Cu8fd9%5Cu6837%5Cu5b50%5Cu7684%5Cuff1a%5Cu73b0%5Cu5728%5Cu6709%5Cu4e00%5Cu4e2aN%20%5Cu4e2a%5Cu70b9%5Cu7684%5Cn%5Cu6811%5Cuff08Tree%5Cuff09%5Cuff0c%5Cu6bcf%5Cu6761%5Cu8fb9%5Cu6709%5Cu4e00%5Cu4e2a%5Cu6574%5Cu6570%5Cu8fb9%5Cu6743vi%20%5Cuff0c%5Cu82e5vi%20%3E%3D%200%5Cuff0c%5Cu8868%5Cu793a%5Cu8d70%5Cu8fd9%5Cu6761%5Cu8fb9%5Cu4f1a%5Cu83b7%5Cu5f97vi%20%5Cu7684%5Cu6536%5Cu76ca%5Cuff1b%5Cu82e5vi%20%3C%200%20%5Cuff0c%5Cu5219%5Cu8868%5Cu793a%5Cu8d70%5Cu8fd9%5Cu6761%5Cu8fb9%5Cu9700%5Cu8981%5Cu652f%5Cu4ed8-%20vi%20%5Cu7684%5Cu8fc7%5Cu8def%5Cu8d39%5Cu3002%5Cu5c0fL%20%5Cu9700%5Cu8981%5Cu63a7%5Cu5236%5Cu4e3b%5Cu89d2Link%20%5Cu5207%5Cu6389%5Cuff08Cut%5Cuff09%5Cu6811%5Cu4e0a%5Cu7684%20%5Cu6070%5Cu597dK%20%5Cu6761%5Cu8fb9%5Cuff0c%5Cu7136%5Cu540e%5Cu518d%5Cu8fde%5Cu63a5%20K%20%5Cu6761%5Cu8fb9%5Cu6743%5Cu4e3a%200%20%5Cu7684%5Cu8fb9%5Cuff0c%5Cu5f97%5Cu5230%5Cu4e00%5Cu68f5%5Cu65b0%5Cu7684%5Cu6811%5Cu3002%5Cu63a5%5Cu7740%5Cuff0c%5Cu4ed6%5Cu4f1a%5Cu9009%5Cu62e9%5Cu6811%5Cu4e0a%5Cu7684%5Cu4e24%5Cu4e2a%5Cu70b9p%3B%20q%20%5Cuff0c%5Cu5e76%5Cu6cbf%5Cu7740%5Cu6811%5Cu4e0a%5Cu8fde%5Cu63a5%5Cu8fd9%5Cu4e24%5Cu70b9%5Cu7684%5Cu7b80%5Cu5355%5Cu8def%5Cu5f84%5Cu4ecep%20%5Cu8d70%5Cu5230q%20%5Cuff0c%5Cu5e76%5Cu4e3a%5Cu7ecf%5Cu8fc7%5Cu7684%5Cu6bcf%5Cu6761%5Cu8fb9%5Cu652f%5Cu4ed8%5Cu8fc7%5Cu8def%5Cu8d39%5C%2F%20%5Cu83b7%5Cu53d6%5Cu76f8%5Cu5e94%5Cu6536%5Cu76ca%5Cu3002%5Cn%5Cn%5Cu6d77%5Cu62c9%5Cu9c81%5Cu5927%5Cu9646%5Cu4e4b%5Cu795eTemporaryDO%20%5Cu60f3%5Cu8003%5Cu9a8c%5Cu4e00%5Cu4e0bLink%5Cu3002%5Cu4ed6%5Cu544a%5Cu8bc9Link%5Cuff0c%5Cu5982%5Cu679cLink%20%5Cu80fd%5Cu5207%5Cu6389%5Cn%5Cu5408%5Cu9002%5Cu7684%5Cu8fb9%5Cu3001%5Cu9009%5Cu62e9%5Cu5408%5Cu9002%5Cu7684%5Cu8def%5Cu5f84%5Cu4ece%5Cu800c%5Cu4f7f%20%5Cu603b%5Cu6536%5Cu76ca%20-%20%5Cu603b%5Cu8fc7%5Cu8def%5Cu8d39%5Cu6700%5Cu5927%5Cu5316%5Cu7684%5Cu8bdd%5Cuff0c%5Cu5c31%5Cu628a%5Cu4f20%5Cu8bf4%5Cu4e2d%5Cu7684%5Cu5927%5Cu5e08%5Cu4e4b%5Cu5251%5Cu9001%5Cu7ed9%5Cu4ed6%5Cu3002%5Cn%5Cn%5Cu5c0f%20L%20%5Cu60f3%5Cu5f97%5Cu5230%5Cu5927%5Cu5e08%5Cu4e4b%5Cu5251%5Cuff0c%5Cu4e8e%5Cu662f%5Cu4ed6%5Cu627e%5Cu5230%5Cu4e86%5Cu4f60%5Cu6765%5Cu5e2e%5Cu5fd9%5Cuff0c%5Cu8bf7%5Cu4f60%5Cu544a%5Cu8bc9%5Cu4ed6%5Cuff0cLink%20%5Cu80fd%5Cu5f97%5Cu5230%5Cu7684%20%5Cu603b%5Cu6536%5Cu76ca%20-%20%5Cu603b%5Cu8fc7%5Cu8def%5Cu8d39%5Cu6700%5Cu5927%5Cu662f%5Cu591a%5Cu5c11%5Cu3002%22%2C%22inputFormat%22%3A%22%5Cu4ece%5Cu6587%5Cu4ef6lct.in%20%5Cu4e2d%5Cu8bfb%5Cu5165%5Cu6570%5Cu636e%5Cu3002%5Cn%5Cn%5Cu8f93%5Cu5165%5Cu7b2c%5Cu4e00%5Cu884c%5Cu5305%5Cu542b%5Cu4e24%5Cu4e2a%5Cu6b63%5Cu6574%5Cu6570N%3B%20K%5Cuff0c%5Cu4fdd%5Cu8bc10%20%3C%3D%20K%20%3C%20N%20%3C%3D%203%2A%2410%5E5%24%5Cu3002%5Cn%5Cn%5Cu63a5%5Cu4e0b%5Cu6765N%20-%201%20%5Cu884c%5Cuff0c%5Cu6bcf%5Cu884c%5Cu5305%5Cu542b%5Cu4e09%5Cu4e2a%5Cu6574%5Cu6570xi%3B%20yi%3B%20vi%5Cuff0c%5Cu8868%5Cu793a%5Cu7b2ci%20%5Cu6761%5Cu8fb9%5Cu8fde%5Cu63a5%5Cu56fe%5Cu4e2d%5Cu7684xi%3B%20yi%20%5Cu4e24%5Cu70b9%5Cuff0c%5Cn%5Cu5b83%5Cu7684%5Cu8fb9%5Cu6743%5Cu4e3avi%5Cu3002%22%2C%22outputFormat%22%3A%22%5Cu8f93%5Cu51fa%5Cu5230%5Cu6587%5Cu4ef6lct.out%20%5Cu4e2d%5Cu3002%5Cn%5Cn%5Cu8f93%5Cu51fa%5Cu4e00%5Cu884c%5Cu4e00%5Cu4e2a%5Cu6574%5Cu6570%5Cuff0c%5Cu8868%5Cu793a%5Cu7b54%5Cu6848%5Cu3002%22%2C%22samples%22%3A%5B%5B%225%201%5Cn1%202%203%5Cn2%203%205%5Cn2%204%20-3%5Cn4%205%206%22%2C%2214%22%5D%5D%2C%22hint%22%3A%22%5Cu3010%5Cu6837%5Cu4f8b1%20%5Cu89e3%5Cu91ca%5Cu3011%5Cn%5Cn%5Cu4e00%5Cu79cd%5Cu53ef%5Cu80fd%5Cu7684%5Cu6700%5Cu4f18%5Cu65b9%5Cu6848%5Cu4e3a%5Cuff1a%5Cu5207%5Cu6389%282%3B%204%3B%20%3F3%29%20%5Cu8fd9%5Cu6761%5Cu8fb9%5Cuff0c%5Cu8fde%5Cu63a5%283%3B%204%3B%200%29%20%5Cu8fd9%5Cu6761%5Cu8fb9%5Cuff0c%5Cu9009%5Cu62e9%28p%3B%20q%29%20%3D%20%281%3B%205%29%5Cu3002%5Cn%5Cn%5Cu2022%20%5Cu5bf9%5Cu4e8e10%25%20%5Cu7684%5Cu6570%5Cu636e%5Cuff0ck%20%3D%200%20%3B%5Cn%5Cn%5Cu2022%20%5Cu5bf9%5Cu4e8e%5Cu53e6%5Cu591610%25%20%5Cu7684%5Cu6570%5Cu636e%5Cuff0ck%20%3D%201%20%3B%5Cn%5Cn%5Cu2022%20%5Cu5bf9%5Cu4e8e%5Cu53e6%5Cu591615%25%20%5Cu7684%5Cu6570%5Cu636e%5Cuff0ck%20%3D%202%20%3B%5Cn%5Cn%5Cu2022%20%5Cu5bf9%5Cu4e8e%5Cu53e6%5Cu591625%25%20%5Cu7684%5Cu6570%5Cu636e%5Cuff0ck%20%3C%3D%20100%20%3B%5Cn%5Cn%5Cu2022%20%5Cu5bf9%5Cu4e8e%5Cu5176%5Cu4ed6%5Cu6570%5Cu636e%5Cuff0c%5Cu6ca1%5Cu6709%5Cu7279%5Cu6b8a%5Cu7ea6%5Cu5b9a%5Cu3002%5Cn%5Cn%5Cu5bf9%5Cu4e8e%5Cu5168%5Cu90e8%5Cu7684%5Cu6d4b%5Cu8bd5%5Cu6570%5Cu636e%5Cuff0c%5Cu4fdd%5Cu8bc1%5Cu67091%20%3C%3D%20N%20%3C%3D%203%20%2A%20%2410%5E5%24%3B%201%20%3C%3D%20xi%3B%20yi%20%3C%3D%20N%3B%20%7Cvi%7C%20%3C%3D%20%2410%5E6%24%20%5Cu3002%5Cn%5Cn%5Cu3010%5Cu63d0%5Cu793a%5Cu3011%5Cn%5Cn%5Cu9898%5Cu76ee%5Cu5e76%5Cu4e0d%5Cu96be%5Cu3002%22%2C%22provider%22%3A%7B%22uid%22%3A8457%2C%22name%22%3A%22chen_zhe%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22Aya%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A6%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B10000%2C10000%2C10000%2C10000%2C10000%2C10000%2C10000%2C10000%2C10000%2C10000%2C10000%2C10000%2C10000%2C10000%2C10000%2C10000%2C10000%2C10000%2C10000%2C10000%5D%2C%22memory%22%3A%5B1024000%2C1024000%2C1024000%2C1024000%2C1024000%2C1024000%2C1024000%2C1024000%2C1024000%2C1024000%2C1024000%2C1024000%2C1024000%2C1024000%2C1024000%2C1024000%2C1024000%2C1024000%2C1024000%2C1024000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22tags%22%3A%5B3%2C35%2C48%2C111%2C213%2C319%2C330%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A1912%2C%22totalAccepted%22%3A534%2C%22pid%22%3A%22P4383%22%2C%22title%22%3A%22%5B%5Cu516b%5Cu7701%5Cu8054%5Cu80032018%5D%5Cu6797%5Cu514b%5Cu5361%5Cu7279%5Cu6811lct%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A113936%2C%22title%22%3A%2285%5Cu5206%5Cu871c%5Cu6c41WA%5Cu4e09%5Cu4e2a%5Cu70b9%5Cu6c42%5Cu52a9%22%2C%22forum%22%3A%7B%22id%22%3A24949%2C%22name%22%3A%22P4383%20%5B%5Cu516b%5Cu7701%5Cu8054%5Cu80032018%5D%5Cu6797%5Cu514b%5Cu5361%5Cu7279%5Cu6811lct%22%2C%22slug%22%3A%22P4383%22%7D%7D%2C%7B%22id%22%3A113787%2C%22title%22%3A%22%5Cu9707%5Cu60ca%5Cuff01%5Cu67d0%5Cu840c%5Cu65b0%5Cu5c45%5Cu7136......%22%2C%22forum%22%3A%7B%22id%22%3A24949%2C%22name%22%3A%22P4383%20%5B%5Cu516b%5Cu7701%5Cu8054%5Cu80032018%5D%5Cu6797%5Cu514b%5Cu5361%5Cu7279%5Cu6811lct%22%2C%22slug%22%3A%22P4383%22%7D%7D%2C%7B%22id%22%3A105176%2C%22title%22%3A%22%5Cu840c%5Cu65b0%5Cu521d%5Cu5b66OI%2C%5Cu6c42%5Cu6551%22%2C%22forum%22%3A%7B%22id%22%3A24949%2C%22name%22%3A%22P4383%20%5B%5Cu516b%5Cu7701%5Cu8054%5Cu80032018%5D%5Cu6797%5Cu514b%5Cu5361%5Cu7279%5Cu6811lct%22%2C%22slug%22%3A%22P4383%22%7D%7D%2C%7B%22id%22%3A99535%2C%22title%22%3A%22%5Cu5199%5Cu8fd9%5Cu4e2a%5Cu9898%5Cu771f%5Cu7684%5Cu53ef%5Cu4ee5%5Cu5f97%5Cu5230%5Cu5927%5Cu5e08%5Cu4e4b%5Cu5251%5Cuff01%22%2C%22forum%22%3A%7B%22id%22%3A24949%2C%22name%22%3A%22P4383%20%5B%5Cu516b%5Cu7701%5Cu8054%5Cu80032018%5D%5Cu6797%5Cu514b%5Cu5361%5Cu7279%5Cu6811lct%22%2C%22slug%22%3A%22P4383%22%7D%7D%2C%7B%22id%22%3A62213%2C%22title%22%3A%22LOJ%20AC%20luogu%20RE%5Cuff1f%22%2C%22forum%22%3A%7B%22id%22%3A24949%2C%22name%22%3A%22P4383%20%5B%5Cu516b%5Cu7701%5Cu8054%5Cu80032018%5D%5Cu6797%5Cu514b%5Cu5361%5Cu7279%5Cu6811lct%22%2C%22slug%22%3A%22P4383%22%7D%7D%2C%7B%22id%22%3A39253%2C%22title%22%3A%22%5Cu8c01%5Cu80fd%5Cu544a%5Cu8bc9%5Cu6211%5Cu4e3a%5Cu4ec0%5Cu4e48%5Cu7a7a%5Cu95f4%5Cu5f00%5Cu4e0d%5Cu52301024MB%22%2C%22forum%22%3A%7B%22id%22%3A24949%2C%22name%22%3A%22P4383%20%5B%5Cu516b%5Cu7701%5Cu8054%5Cu80032018%5D%5Cu6797%5Cu514b%5Cu5361%5Cu7279%5Cu6811lct%22%2C%22slug%22%3A%22P4383%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22CF321E%22%2C%22title%22%3A%22Ciel%20and%20Gondolas%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22P4365%22%2C%22title%22%3A%22%5B%5Cu4e5d%5Cu7701%5Cu8054%5Cu80032018%5D%5Cu79d8%5Cu5bc6%5Cu88ad%5Cu51fbcoat%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P4382%22%2C%22title%22%3A%22%5B%5Cu516b%5Cu7701%5Cu8054%5Cu80032018%5D%5Cu5288%5Cu914d%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P4384%22%2C%22title%22%3A%22%5B%5Cu516b%5Cu7701%5Cu8054%5Cu80032018%5D%5Cu5236%5Cu80e1%5Cu7a9c%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P4770%22%2C%22title%22%3A%22%5BNOI2018%5D%5Cu4f60%5Cu7684%5Cu540d%5Cu5b57%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22%5B%5Cu516b%5Cu7701%5Cu8054%5Cu80032018%5D%5Cu6797%5Cu514b%5Cu5361%5Cu7279%5Cu6811lct%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573286098;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>[八省联考2018]林克卡特树lct</h1>
<h2>题目背景</h2>
<div>#警告：滥用本题评测将封号</div>
<h2>题目描述</h2>
<div>小L 最近沉迷于塞尔达传说：荒野之息（The Legend of Zelda: Breath of The Wild）无法自拔，他尤其喜欢游戏中的迷你挑战。
游戏中有一个叫做“LCT” 的挑战，它的规则是这样子的：现在有一个N 个点的
树（Tree），每条边有一个整数边权vi ，若vi >= 0，表示走这条边会获得vi 的收益；若vi < 0 ，则表示走这条边需要支付- vi 的过路费。小L 需要控制主角Link 切掉（Cut）树上的 恰好K 条边，然后再连接 K 条边权为 0 的边，得到一棵新的树。接着，他会选择树上的两个点p; q ，并沿着树上连接这两点的简单路径从p 走到q ，并为经过的每条边支付过路费/ 获取相应收益。
海拉鲁大陆之神TemporaryDO 想考验一下Link。他告诉Link，如果Link 能切掉
合适的边、选择合适的路径从而使 总收益 - 总过路费最大化的话，就把传说中的大师之剑送给他。
小 L 想得到大师之剑，于是他找到了你来帮忙，请你告诉他，Link 能得到的 总收益 - 总过路费最大是多少。</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>从文件lct.in 中读入数据。
输入第一行包含两个正整数N; K，保证0 <= K < N <= 3*$10^5$。
接下来N - 1 行，每行包含三个整数xi; yi; vi，表示第i 条边连接图中的xi; yi 两点，
它的边权为vi。</div>
<h3>输出格式</h3>
<br />
<div>输出到文件lct.out 中。
输出一行一个整数，表示答案。</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>5 1
1 2 3
2 3 5
2 4 -3
4 5 6</code></pre>
<h3>输出样例 #1</h3>
<pre><code>14</code></pre>
<h2>说明</h2>
<div>【样例1 解释】
一种可能的最优方案为：切掉(2; 4; ?3) 这条边，连接(3; 4; 0) 这条边，选择(p; q) = (1; 5)。
• 对于10% 的数据，k = 0 ;
• 对于另外10% 的数据，k = 1 ;
• 对于另外15% 的数据，k = 2 ;
• 对于另外25% 的数据，k <= 100 ;
• 对于其他数据，没有特殊约定。
对于全部的测试数据，保证有1 <= N <= 3 * $10^5$; 1 <= xi; yi <= N; |vi| <= $10^6$ 。
【提示】
题目并不难。</div>
</article>
</div>
</div>
</body>
</html>
