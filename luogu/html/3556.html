<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>[POI2013]MOR-Tales of seafaring - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573377040:4iIK2mV7Noka3m4dIMivwjD2AOAXKuu8vkL9j9b15rA=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%22%2C%22description%22%3A%22Young%20Bytensson%20loves%20to%20hang%20out%20in%20the%20port%20tavern%2C%20where%20he%20often%20%20%20%20listens%20to%20the%20sea%20dogs%20telling%20their%20tales%20of%20seafaring.%5Cn%5CnInitially%2C%20he%20believed%20them%20all%2C%20however%20incredible%20they%20sounded.%5Cn%5CnOver%20time%20though%2C%20he%20became%20suspicious.%5Cn%5CnHe%20has%20decided%20to%20write%20a%20program%20that%20will%20verify%20if%20there%20may%20be%20%20%20%20any%20grain%20of%20truth%20in%20those%20tall%20stories.%5Cn%5CnBytensson%20reasoned%20that%20while%20he%20cannot%20tell%20if%20the%20sailors%20indeed%20%20%20%20weathered%20all%20those%20storms%2C%20he%20can%20at%20least%20find%20out%20if%20their%20travel%20%20%20%20itineraries%20make%20sense.%5Cn%5CnThis%20is%20a%20task%20for%20a%20programmer%2C%20which%20Bytensson%2C%20unfortunately%2C%20is%20not.%5Cn%5CnHelp%20him%20out%21%5Cn%5CnThere%20are%20%24n%24%20ports%20and%20%24m%24%20waterways%20connecting%20them%20in%20the%20waters%20%20%20%20frequented%20by%20the%20sailors%20Bytensson%20listened%20to.%5Cn%5CnIf%20there%20is%20a%20waterway%20between%20two%20ports%2C%20then%20sailing%20from%20one%20to%20the%20%20%20%20other%20is%20possible.%20%20Any%20waterway%20can%20be%20sailed%20in%20both%20%20%20%20directions.%5Cn%5CnBytensson%20got%20to%20know%20%24k%24%20seafaring%20tales.%5Cn%5CnEach%20tells%20of%20a%20sailor%20who%20began%20his%20journey%20in%20one%20port%2C%20%20%20%20sailed%20a%20number%20of%20waterways%2C%20and%20ended%20up%20in%20another%20port%2C%20%20%20%20which%20may%20have%20been%20the%20one%20he%20initially%20set%20sail%20from.%5Cn%5CnThe%20sailor%20in%20question%20may%20have%20sailed%20through%20the%20same%20waterway%20%20%20%20many%20times%2C%20each%20time%20in%20any%20direction.%5Cn%5Cn%5Cu7ed9n%5Cu4e2a%5Cu70b9m%5Cu6761%5Cu8fb9%5Cu65e0%5Cu5411%5Cu56fe%5Cuff0c%5Cu6bcf%5Cu6b21%5Cu8be2%5Cu95ee%5Cu4e24%5Cu4e2a%5Cu70b9%5Cu4e4b%5Cu95f4%5Cu662f%5Cu5426%5Cu6709%5Cu957f%5Cu5ea6%5Cu4e3ad%5Cu7684%5Cu8def%5Cu5f84%5Cuff08%5Cu4e0d%5Cu4e00%5Cu5b9a%5Cu662f%5Cu7b80%5Cu5355%5Cu8def%5Cu5f84%5Cuff09%5Cn%22%2C%22inputFormat%22%3A%22In%20the%20first%20line%20of%20the%20standard%20input%2C%20there%20are%20three%20integers%2C%20%24n%24%2C%24m%24%20and%20%24k%24%20%28%242%5C%5Cle%20n%5C%5Cle%205%5C%5C%20000%24%2C%20%241%5C%5Cle%20m%5C%5Cle%205%5C%5C%20000%24%2C%20%241%5C%5Cle%20k%5C%5Cle%201%5C%5C%20000%5C%5C%20000%24%29.%5Cn%5CnThese%20denote%2C%20respectively%3A%20the%20number%20of%20ports%20in%20the%20waters%20%20%20%20%20%20frequented%20by%20the%20sailors%20who%20told%20Bytensson%20their%20stories%2Cthe%20number%20of%20waterways%2C%20and%20the%20number%20of%20tales.%5Cn%5CnThe%20%24m%24%20lines%20that%20follow%20specify%20the%20waterways.%5Cn%5CnA%20single%20waterway%27s%20description%20consists%20of%20a%20single%20line%20that%20contains%20two%20integers%2C%20%24a%24%20and%20%24b%24%20%28%241%5C%5Cle%20a%2Cb%5C%5Cle%20n%24%2C%24a%5C%5Cne%20b%24%29%2C%20separated%20by%20a%20single%20space%3B%20these%20specify%20the%20numbers%20of%20ports%20at%20the%20two%20ends%20of%20this%20particular%20waterway.%5Cn%5CnThe%20%24k%24%20lines%20that%20follow%20specify%20the%20tales%20that%20Bytensson%20has%20heard.%20A%20single%20tale%27s%20description%20consists%20of%20a%20single%20line%20with%20three%20integers%2C%24s%24%2C%24t%24%2Cand%20%24d%24%20%28%241%5C%5Cle%20s%2Ct%5C%5Cle%20n%24%2C%241%5C%5Cle%20d%5C%5Cle%201%5C%5C%20000%5C%5C%20000%5C%5C%20000%24%20%29%2C%20separated%20by%20single%20spaces.%20These%20indicate%20that%20the%20tale%27s%20protagonist%20set%20sail%20from%20port%20no.%20%24s%24%20%2C%20ended%20the%20journey%20in%20port%20no.%20%24t%24%20%2C%20and%20sailed%20exactly%20%24d%24%20times%20through%20various%20waterways.%5Cn%22%2C%22outputFormat%22%3A%22Your%20program%20should%20print%20exactly%20%24k%24%20lines%20to%20the%20standard%20output%3B%20the%20%24i%24-th%20of%20them%20should%20contain%20the%20word%20TAK%20%28Polish%20for%20yes%29%20if%20the%20journey%20described%20in%20the%20%24i%24-th%20tale%28in%20input%20order%29%20could%20have%20taken%20place.%5Cn%5CnIf%20it%20could%20not%2C%20then%20the%20line%20should%20contain%20the%20word%20NIE%20%28Polish%20for%20no%29.%5Cn%22%2C%22samples%22%3A%5B%5B%228%207%204%5Cn1%202%5Cn2%203%5Cn3%204%5Cn5%206%5Cn6%207%5Cn7%208%5Cn8%205%5Cn2%203%201%5Cn1%204%201%5Cn5%205%208%5Cn1%208%2010%5Cn%22%2C%22TAK%5CnNIE%5CnTAK%5CnNIE%5Cn%22%5D%5D%2C%22hint%22%3A%22%5Cu7ed9n%5Cu4e2a%5Cu70b9m%5Cu6761%5Cu8fb9%5Cu65e0%5Cu5411%5Cu56fe%5Cuff0c%5Cu6bcf%5Cu6b21%5Cu8be2%5Cu95ee%5Cu4e24%5Cu4e2a%5Cu70b9%5Cu4e4b%5Cu95f4%5Cu662f%5Cu5426%5Cu6709%5Cu957f%5Cu5ea6%5Cu4e3ad%5Cu7684%5Cu8def%5Cu5f84%5Cuff08%5Cu4e0d%5Cu4e00%5Cu5b9a%5Cu662f%5Cu7b80%5Cu5355%5Cu8def%5Cu5f84%5Cuff09%5Cn%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%5D%2C%22memory%22%3A%5B128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22tags%22%3A%5B6%2C30%2C57%2C319%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A573%2C%22totalAccepted%22%3A157%2C%22pid%22%3A%22P3556%22%2C%22title%22%3A%22%5BPOI2013%5DMOR-Tales%20of%20seafaring%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P3524%22%2C%22title%22%3A%22%5BPOI2011%5DIMP-Party%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P3554%22%2C%22title%22%3A%22%5BPOI2013%5DLUK-Triumphal%20arch%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P3558%22%2C%22title%22%3A%22%5BPOI2013%5DBAJ-Bytecomputer%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P3569%22%2C%22title%22%3A%22%5BPOI2014%5DKAR-Cards%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P3588%22%2C%22title%22%3A%22%5BPOI2015%5DPUS%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22%5BPOI2013%5DMOR-Tales%20of%20seafaring%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573286098;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>[POI2013]MOR-Tales of seafaring</h1>
<h2>题目描述</h2>
<div>Young Bytensson loves to hang out in the port tavern, where he often listens to the sea dogs telling their tales of seafaring.
Initially, he believed them all, however incredible they sounded.
Over time though, he became suspicious.
He has decided to write a program that will verify if there may be any grain of truth in those tall stories.
Bytensson reasoned that while he cannot tell if the sailors indeed weathered all those storms, he can at least find out if their travel itineraries make sense.
This is a task for a programmer, which Bytensson, unfortunately, is not.
Help him out!
There are $n$ ports and $m$ waterways connecting them in the waters frequented by the sailors Bytensson listened to.
If there is a waterway between two ports, then sailing from one to the other is possible. Any waterway can be sailed in both directions.
Bytensson got to know $k$ seafaring tales.
Each tells of a sailor who began his journey in one port, sailed a number of waterways, and ended up in another port, which may have been the one he initially set sail from.
The sailor in question may have sailed through the same waterway many times, each time in any direction.
给n个点m条边无向图，每次询问两个点之间是否有长度为d的路径（不一定是简单路径）
</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>In the first line of the standard input, there are three integers, $n$,$m$ and $k$ ($2\le n\le 5\ 000$, $1\le m\le 5\ 000$, $1\le k\le 1\ 000\ 000$).
These denote, respectively: the number of ports in the waters frequented by the sailors who told Bytensson their stories,the number of waterways, and the number of tales.
The $m$ lines that follow specify the waterways.
A single waterway's description consists of a single line that contains two integers, $a$ and $b$ ($1\le a,b\le n$,$a\ne b$), separated by a single space; these specify the numbers of ports at the two ends of this particular waterway.
The $k$ lines that follow specify the tales that Bytensson has heard. A single tale's description consists of a single line with three integers,$s$,$t$,and $d$ ($1\le s,t\le n$,$1\le d\le 1\ 000\ 000\ 000$ ), separated by single spaces. These indicate that the tale's protagonist set sail from port no. $s$ , ended the journey in port no. $t$ , and sailed exactly $d$ times through various waterways.
</div>
<h3>输出格式</h3>
<br />
<div>Your program should print exactly $k$ lines to the standard output; the $i$-th of them should contain the word TAK (Polish for yes) if the journey described in the $i$-th tale(in input order) could have taken place.
If it could not, then the line should contain the word NIE (Polish for no).
</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>8 7 4
1 2
2 3
3 4
5 6
6 7
7 8
8 5
2 3 1
1 4 1
5 5 8
1 8 10
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>TAK
NIE
TAK
NIE
</code></pre>
<h2>说明</h2>
<div>给n个点m条边无向图，每次询问两个点之间是否有长度为d的路径（不一定是简单路径）
</div>
</article>
</div>
</div>
</body>
</html>
