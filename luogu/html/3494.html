<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>[POI2009]KOD-The Code - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573376964:fmf3280L9T6jX/iJc0LqPZxdpvU84dhwx9LDKas2dOs=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%22%2C%22description%22%3A%22The%20Byteotian%20Institute%20of%20Telecommunication%20%28BIT%29%20sets%20standards%20for%20data%20transmission%20in%20telecommunication%20networks%20all%20over%20Byteotia.%5Cn%5CnByteasar%2C%20one%20of%20the%20engineers%20employed%20at%20BIT%2C%20works%20on%20prefix%20codes%20-%20a%20certain%20way%20of%20representing%20characters.%5Cn%5CnFor%20each%20and%20every%20character%20of%20the%20Byteotian%20alphabet%20there%20is%20a%20corresponding%20sequence%20of%20bits%2C%20called%20the%20code%20word%20of%20that%20character.%5Cn%5CnThe%20code%20words%20of%20all%20characters%20have%20the%20following%20properties%3A%5Cn%5CnNone%20of%20the%20code%20words%20is%20a%20prefix%20%28i.e.%20a%20leading%20%20%20%20%20%20%20fragment%29%20of%20another%20code%20word.%5Cn%5CnFor%20example%2C%20if%20010010%20is%20the%20code%20word%20of%20the%20letter%20%20%20A%2C%20then%20neither%20the%20bit%20sequence%200%2C%20%20%2001%2C%20010%2C%20%200100%20nor%2001001%20%20%20is%20a%20code%20word%20of%20another%20letter.%5Cn%5CnLikewise%2C%200100100%2C%200100101%20and%20longer%20%20%20sequences%20starting%20with%20010010%20are%20not%20code%20words.%5Cn%5CnIf%20a%20given%20bit%20sequence%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI16%5C%2Fkod-en-tex.1.png%29%20is%20a%20prefix%20of%20another%20code%20word%2C%20%20%20%20%20%20%20but%20not%20the%20complete%20code%2C%20then%20each%20of%20the%20bit%20sequences%20%20%20%20%20%20%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI16%5C%2Fkod-en-tex.2.png%29%20and%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI16%5C%2Fkod-en-tex.3.png%29%20%28that%20is%2C%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI16%5C%2Fkod-en-tex.4.png%29%20with%20zero%20or%20one%20%20%20%20%20%20%20appended%20at%20the%20end%29%20is%20a%20prefix%20of%20some%20code%20word%2C%20or%20the%20%20%20%20%20%20%20complete%20code%20word.%5Cn%5CnFor%20example%2C%20if%200100%20is%20the%20prefix%20of%20the%20code%20word%20of%20the%20%20%20%20%20%20%20letter%20A%2C%20then%2001000%20and%2001001%20each%20%20%20%20%20%20%20is%20a%20prefix%20of%20some%20code%20word%2C%20or%20a%20complete%20code%20word.%5Cn%5CnLet%20us%20consider%20the%20following%20exemplary%20prefix%20code%20for%20the%20alphabet%20consisting%20of%20the%20characters%20%20%20%20A%2C%20B%2C%20C%2C%20D%20and%20E%3A%5Cn%5Cncharactercode%20word%20%20%20%20A00%20%20%20%20B10%20%20%20%20C11%20%20%20%20D010%20%20%20%20E011%20%20%20%20%20%20%20%20%20Encoding%20a%20sequence%20of%20characters%20with%20a%20prefix%20code%20consists%20in%20concatenating%20the%20code%20words%20of%20its%20successive%20characters.%5Cn%5CnFor%20example%2C%20the%20encoding%20of%20the%20sequence%20BACAEBABAE%20is%201000110001110001000011.%5Cn%5CnByteasar%20noticed%20that%20if%20some%20leading%20bits%20are%20lost%2C%20the%20sequence%20may%20be%20decoded%20wrong%2C%20or%20it%20may%20even%20be%20not%20decoded%20at%20all.%5Cn%5CnFor%20example%2C%20if%20five%20initial%20bits%20of%20the%20sequence%20given%20above%20are%20removed%2C%20the%20resulting%20sequence%2010001110001000011%20will%20be%20decoded%20as%20BACBABAE.%5Cn%5CnThe%20last%20five%20letter%20%28BABAE%29%20are%20correct%2C%20but%20the%20first%20three%20%28BAC%29%20are%20not.%5Cn%5CnByteasar%20further%20noticed%20that%20all%20the%20letters%20after%20the%20first%20E%20are%20decoded%20correct.%5Cn%5CnHe%20concluded%20that%20whenever%20all%20the%20bits%20of%20the%20code%20word%20of%20E%20are%20intact%2C%20all%20the%20characters%20succeeding%20E%20will%20be%20decoded%20correct.%5Cn%5CnThe%20same%20holds%20for%20every%20encoded%20sequence%20obtained%20from%20one%20that%20contains%20E.%5Cn%5CnHe%20also%20noticed%20that%20the%20letter%20D%20shares%20this%20feature%2C%20but%20A%2C%20B%20and%20C%20do%20not.%5Cn%5CnBecause%20of%20the%20properties%20of%20the%20code%20words%20of%20E%20and%20D%20Byteasar%20called%20them%20synchronising%20code%20words.%5Cn%5CnHe%20trusted%20you%20with%20the%20task%20of%20writing%20a%20programme%20that%20finds%20all%20the%20synchronising%20code%20words%20of%20a%20given%20prefix%20code.%5Cn%5CnTo%20save%20some%20time%2C%20he%20intends%20to%20present%20you%20all%20the%20code%20words%20on%20his%20binary%20monitor.%5Cn%5CnThis%20interesting%20device%20has%20four%20buttons%3A%5Cn%5Cn0%20-%20append%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fim%5Cu2026%5Cn%22%2C%22inputFormat%22%3A%22In%20the%20first%20line%20of%20the%20standard%20input%20there%20is%20an%20integer%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI16%5C%2Fkod-en-tex.7.png%29%20%20%20%20%20%20%28%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI16%5C%2Fkod-en-tex.8.png%29%29%20denoting%20the%20number%20of%20buttons%20pressed%20%20%20%20%20%20by%20Byteasar.%5Cn%5CnIn%20the%20following%20line%20an%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI16%5C%2Fkod-en-tex.9.png%29%20letters%20long%20string%20consisting%20of%20the%20%20%20%20%20%20characters%20%270%27%2C%20%271%27%2C%20%27B%27%20and%20%20%20%20%20%20%27X%27%20is%20given%3B%20the%20characters%20correspond%20to%20the%20buttons%2C%20%20%20%20%20%20of%20course.%5Cn%5CnEach%20time%20the%20button%20X%20is%20pressed%2C%20a%20code%20word%20is%20%20%20%20%20%20completed%20and%20another%20one%20starts.%5Cn%5CnThe%20code%20words%20are%20numbered%20starting%20with%201.%5Cn%5CnThe%20sum%20of%20lengths%20of%20all%20code%20words%20will%20not%20exceed%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI16%5C%2Fkod-en-tex.10.png%29.%5Cn%22%2C%22outputFormat%22%3A%22The%20number%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI16%5C%2Fkod-en-tex.11.png%29%20of%20synchronising%20code%20words%20should%20be%20printed%20out%20in%20the%20%20%20%20%20first%20line%20of%20the%20standard%20output.%5Cn%5CnThe%20following%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI16%5C%2Fkod-en-tex.12.png%29%20lines%20should%20contain%20the%20numbers%20of%20code%20words%20that%20%20are%20synchronising%20in%20increasing%20order%2C%20each%20in%20a%20separate%20line.%5Cn%5CnIf%20the%20given%20prefix%20code%20contains%20no%20synchronising%20code%20words%2C%20the%20first%20%20line%20should%20contain%20the%20number%200%2C%20and%20no%20more%20lines%20should%20follow.%5Cn%22%2C%22samples%22%3A%5B%5B%2221%5Cn11XB0XBB00XB11XB0XBBB%5Cn%22%2C%222%5Cn4%5Cn5%5Cn%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%5D%2C%22memory%22%3A%5B128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22tags%22%3A%5B26%2C57%2C127%2C319%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A5%2C%22totalAccepted%22%3A2%2C%22pid%22%3A%22P3494%22%2C%22title%22%3A%22%5BPOI2009%5DKOD-The%20Code%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22P%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A111772%2C%22title%22%3A%22%5Cu7ffb%5Cu8bd1%22%2C%22forum%22%3A%7B%22id%22%3A2582%2C%22name%22%3A%22P3494%20%5BPOI2009%5DKOD-The%20Code%22%2C%22slug%22%3A%22P3494%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22%5BPOI2009%5DKOD-The%20Code%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573286098;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>[POI2009]KOD-The Code</h1>
<h2>题目描述</h2>
<div>The Byteotian Institute of Telecommunication (BIT) sets standards for data transmission in telecommunication networks all over Byteotia.
Byteasar, one of the engineers employed at BIT, works on prefix codes - a certain way of representing characters.
For each and every character of the Byteotian alphabet there is a corresponding sequence of bits, called the code word of that character.
The code words of all characters have the following properties:
None of the code words is a prefix (i.e. a leading fragment) of another code word.
For example, if 010010 is the code word of the letter A, then neither the bit sequence 0, 01, 010, 0100 nor 01001 is a code word of another letter.
Likewise, 0100100, 0100101 and longer sequences starting with 010010 are not code words.
If a given bit sequence ![](http://main.edu.pl/images/OI16/kod-en-tex.1.png) is a prefix of another code word, but not the complete code, then each of the bit sequences ![](http://main.edu.pl/images/OI16/kod-en-tex.2.png) and ![](http://main.edu.pl/images/OI16/kod-en-tex.3.png) (that is, ![](http://main.edu.pl/images/OI16/kod-en-tex.4.png) with zero or one appended at the end) is a prefix of some code word, or the complete code word.
For example, if 0100 is the prefix of the code word of the letter A, then 01000 and 01001 each is a prefix of some code word, or a complete code word.
Let us consider the following exemplary prefix code for the alphabet consisting of the characters A, B, C, D and E:
charactercode word A00 B10 C11 D010 E011 Encoding a sequence of characters with a prefix code consists in concatenating the code words of its successive characters.
For example, the encoding of the sequence BACAEBABAE is 1000110001110001000011.
Byteasar noticed that if some leading bits are lost, the sequence may be decoded wrong, or it may even be not decoded at all.
For example, if five initial bits of the sequence given above are removed, the resulting sequence 10001110001000011 will be decoded as BACBABAE.
The last five letter (BABAE) are correct, but the first three (BAC) are not.
Byteasar further noticed that all the letters after the first E are decoded correct.
He concluded that whenever all the bits of the code word of E are intact, all the characters succeeding E will be decoded correct.
The same holds for every encoded sequence obtained from one that contains E.
He also noticed that the letter D shares this feature, but A, B and C do not.
Because of the properties of the code words of E and D Byteasar called them synchronising code words.
He trusted you with the task of writing a programme that finds all the synchronising code words of a given prefix code.
To save some time, he intends to present you all the code words on his binary monitor.
This interesting device has four buttons:
0 - append ![](http://main.edu.pl/im…
</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>In the first line of the standard input there is an integer ![](http://main.edu.pl/images/OI16/kod-en-tex.7.png) (![](http://main.edu.pl/images/OI16/kod-en-tex.8.png)) denoting the number of buttons pressed by Byteasar.
In the following line an ![](http://main.edu.pl/images/OI16/kod-en-tex.9.png) letters long string consisting of the characters '0', '1', 'B' and 'X' is given; the characters correspond to the buttons, of course.
Each time the button X is pressed, a code word is completed and another one starts.
The code words are numbered starting with 1.
The sum of lengths of all code words will not exceed ![](http://main.edu.pl/images/OI16/kod-en-tex.10.png).
</div>
<h3>输出格式</h3>
<br />
<div>The number ![](http://main.edu.pl/images/OI16/kod-en-tex.11.png) of synchronising code words should be printed out in the first line of the standard output.
The following ![](http://main.edu.pl/images/OI16/kod-en-tex.12.png) lines should contain the numbers of code words that are synchronising in increasing order, each in a separate line.
If the given prefix code contains no synchronising code words, the first line should contain the number 0, and no more lines should follow.
</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>21
11XB0XBB00XB11XB0XBBB
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>2
4
5
</code></pre>
</article>
</div>
</div>
</body>
</html>
