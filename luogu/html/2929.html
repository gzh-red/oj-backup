<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>[USACO09HOL]传输延迟Transmission Delay - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573376158:0gugRDCD3fmKA4cVJwhN0NgLLUyfGS1wyCmJxbrSyL0=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%22%2C%22description%22%3A%22Farmer%20John%20has%20taken%20to%20yodeling%20from%20the%20top%20of%20the%20barn%20in%20order%20to%20communicate%20with%20the%20cows%20out%20in%20the%20pastures.%20Being%20bovine%20and%20all%2C%20cows%20can%20hear%20binary%20messages%20%280%27s%20and%201%27s%29%20but%20have%20trouble%20with%20perfect%20communications%20because%20FJ%27s%20yodeling%20echoes%20off%20the%20silo.%20In%20fact%2C%20in%20a%20sequence%20of%20N%20%281%20%3C%3D%20N%20%3C%3D%202%2C000%29%20bits%2C%20Bessie%20will%20always%20receive%20a%20sequence%20of%20N%20bits%2C%20with%20the%20same%20number%20of%200s%20and%201s%2C%20but%20each%200%20or%201%20might%20be%20delayed.%5Cn%5CnPrecisely%20speaking%2C%20for%20a%20given%20number%20D%20%280%20%3C%3D%20D%20%3C%20N%29%2C%20the%20i-th%20bit%20might%20be%20heard%20as%20the%20j-th%20one%20as%20long%20as%20%7Ci%20-%20j%7C%20%3C%3D%20D%20%28in%20other%20words%2C%20no%20bit%20appears%20in%20a%20position%20farther%20than%20distance%20D%20from%20its%20original%20position%29.%20%5CnConsider%20the%20following%20message%20as%20an%20example%3A%200110.%20Four%20possible%20messages%20might%20be%20heard%20if%20D%20%3D%201%3A%200101%2C%200110%2C%201001%2C%20and%201010.%5Cn%5CnGiven%20the%20message%20to%20be%20yodeled%20by%20FJ%2C%20along%20with%20two%20numbers%20D%20and%20K%20%281%20%3C%3D%20K%20%3C%3D%20100%2C000%2C000%29%2C%20determine%20the%20number%20of%20different%20messages%20that%20might%20be%20heard%20by%20Bessie%2C%20modulo%20100%2C000%2C000.%20Also%20determine%20the%20K-th%20smallest%20such%20message%20in%20lexicographical%20order%20%28in%20binary%20representation%2C%20with%200%20coming%20before%201%29.%20It%20is%20guaranteed%20that%20K%20will%20be%20no%20larger%20than%20the%20number%20of%20different%20possible%20messages.%5Cn%5CnMEMORY%20LIMIT%3A%2032%20MB%5Cn%5CnTIME%20LIMIT%3A%202%20seconds%5Cn%5CnFEEDBACK%3A%20Your%20first%2050%20submissions%20for%20this%20problem%20will%20be%20run%20on%20some%20of%20the%20official%20test%20data%2C%20and%20you%20will%20receive%20a%20summary%20of%20the%20results.%5Cn%5Cn%5Cu7ea6%5Cu7ff0%5Cu5728%5Cu5c4b%5Cu9876%5Cu4e0a%5Cu5531%5Cu6b4c%5Cuff0c%5Cu4ee5%5Cu6b64%5Cu6765%5Cu4e0e%5Cu5976%5Cu725b%5Cu4eec%5Cu4ea4%5Cu6d41%5Cuff0e%5Cu4f46%5Cu662f%5Cu5976%5Cu725b%5Cu4eec%5Cu7684%5Cu542c%5Cu529b%5Cu5f88%5Cu5947%5Cu602a%5Cuff0c%5Cu5979%5Cu4eec%5Cu53ea%5Cu80fd%5Cu542c%5Cu5230%5Cu7ea6%5Cu7ff0%5Cu7684%5Cu6b4c%5Cu58f0%5Cu53d8%5Cu62100%5Cu548c1%5Cu6784%5Cu6210%5Cu7684%5Cu4fe1%5Cu606f%5Cu4e32%5Cu65f6%5Cu7684%5Cu6837%5Cu5b50%5Cuff0e%20%20%20%20%5Cu7ea6%5Cu7ff0%5Cu7684%5Cu58f0%5Cu97f3%5Cu91cc%5Cu6709N%281%5Cu2264N%5Cu22642000%29%5Cu4e2a0%5Cu62161%5Cuff0c%5Cu5976%5Cu725b%5Cu542c%5Cu5230%5Cu7684%5Cu4e5f%5Cu662fN%5Cu4e2a%5Cuff0c%5Cu800c%5Cu4e140%5Cu548c1%5Cu7684%5Cu6570%5Cu91cf%5Cu4e0d%5Cu4f1a%5Cu53d8%5Cu5316%5Cuff0c%5Cu4f46%5Cu662f%5Cu4e00%5Cu90e8%5Cu52060%5Cu62161%5Cu53ef%5Cu80fd%5Cu504f%5Cu79bb%5Cu539f%5Cu6765%5Cu7684%5Cu4f4d%5Cu7f6e%5Cuff0c%5Cu8fd9%5Cu5c31%5Cu662f%5Cu7ea6%5Cu7ff0%5Cu7684%5Cu6b4c%5Cu58f0%5Cu5728%5Cu4f20%5Cu8f93%5Cu65f6%5Cu53d1%5Cu751f%5Cu7684%5Cu201c%5Cu4f20%5Cu8f93%5Cu5ef6%5Cu8fdf%5Cu201d%5Cu73b0%5Cu8c61%5Cuff0e0%5Cu62161%5Cu7684%5Cu504f%5Cu79bb%5Cu8ddd%5Cu79bb%5Cu4e0d%5Cu4f1a%5Cu8d85%5Cu8fc7D%28O%5Cu2264D%3CN%29%5Cuff0c%5Cu4e5f%5Cu5c31%5Cu662f%5Cu8bf4%5Cu67d0%5Cu4e00%5Cu4e2a%5Cu7801%5Cu7684%5Cu539f%5Cu672c%5Cu4f4d%5Cu7f6e%5Cu548c%5Cu73b0%5Cu5728%5Cu7684%5Cu4f4d%5Cu7f6e%5Cu4e4b%5Cu5dee%5Cu7684%5Cu7edd%5Cu5bf9%5Cu503c%5Cu4e0d%5Cu5927%5Cu4e8eD.%5Cn%5Cn%5Cu6bd4%5Cu5982%5Cuff0c%5Cu5bf9%5Cu4e8e0110%5Cuff0cD%3D1%5Cuff0c%5Cu4f20%5Cu8f93%5Cu5ef6%5Cu8fdf%5Cu53d1%5Cu751f%5Cu540e%5Cu53ef%5Cu80fd%5Cu51fa%5Cu73b00101%5Cuff0c0110%5Cuff0c1001%5Cuff0c1010%5Cu8fd9%5Cu56db%5Cu79cd%5Cu4e32%5Cuff0e%5Cn%5Cn%5Cu7ed9%5Cu51fa%5Cu7ea6%5Cu7ff0%5Cu6b4c%5Cu58f0%5Cu768401%5Cu4e32%5Cu5f62%5Cu5f0f%5Cu548c%5Cu4e00%5Cu4e2a%5Cu6574%5Cu6570K%281%5Cu2264K%5Cu2264108%29%5Cuff0c%5Cu8bf7%5Cu8ba1%5Cu7b97%5Cu4f20%5Cu8f93%5Cu5ef6%5Cu8fdf%5Cu53d1%5Cu751f%5Cu540e%5Cu4e00%5Cu5171%5Cu6709%5Cu591a%5Cu5c11%5Cu79cd%5Cu53ef%5Cu80fd%5Cu768401%5Cu4e32%5Cuff0c%5Cu4ee5%5Cu53ca%5Cu5176%5Cu4e2d%5Cu7b2cK%5Cu5927%5Cu7684%5Cu4e32%5Cu662f%5Cu4ec0%5Cu4e48%5Cuff0e%5Cn%22%2C%22inputFormat%22%3A%22%5C%5C%2A%20Line%201%3A%20Three%20space-separated%20integers%3A%20N%2C%20D%2C%20and%20K%5Cn%5Cn%5C%5C%2A%20Line%202%3A%20FJ%27s%20binary%20message%2C%20containing%20exactly%20N%20bits%5Cn%22%2C%22outputFormat%22%3A%22%5C%5C%2A%20Line%201%3A%20The%20number%20of%20different%20possible%20messages%20that%20can%20heard%20by%20Bessie%2C%20mod%20100%2C000%2C000%5Cn%5Cn%5C%5C%2A%20Line%202%3A%20The%20K-th%20smallest%20such%20message%20%28in%20binary%20representation%29%5Cn%5CnNote%20that%20if%20your%20program%27s%20first%20line%20of%20output%20is%20correct%20but%20the%20second%20line%20of%20output%20is%20either%20missing%20or%20wrong%2C%20you%20will%20receive%2040%25%20of%20the%20points%20for%20that%20test%20case.%5Cn%22%2C%22samples%22%3A%5B%5B%224%201%203%20%5Cn0110%20%5Cn%22%2C%224%20%5Cn1001%20%5Cn%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A20%2C%22name%22%3A%22FarmerJohn2%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3Anull%2C%22isAdmin%22%3Afalse%2C%22color%22%3A%22Gray%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%5D%2C%22memory%22%3A%5B128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22tags%22%3A%5B26%2C46%2C319%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A149%2C%22totalAccepted%22%3A37%2C%22pid%22%3A%22P2929%22%2C%22title%22%3A%22%5BUSACO09HOL%5D%5Cu4f20%5Cu8f93%5Cu5ef6%5Cu8fdfTransmission%20Delay%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22P%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A130988%2C%22title%22%3A%22%5Cu8fd9%5Cu9898WA%5Cu4e0d%5Cu6b62%5Cu7684%5Cu6ce8%5Cu610f%5Cu4e86%22%2C%22forum%22%3A%7B%22id%22%3A2058%2C%22name%22%3A%22P2929%20%5BUSACO09HOL%5D%5Cu4f20%5Cu8f93%5Cu5ef6%5Cu8fdfTransmission%20Delay%22%2C%22slug%22%3A%22P2929%22%7D%7D%2C%7B%22id%22%3A24905%2C%22title%22%3A%22%5Cu90a3%5Cu4e3a%5Cu4ec0%5Cu4e480011%5Cu548c1100%5Cu4e0d%5Cu53ef%5Cu4ee5%22%2C%22forum%22%3A%7B%22id%22%3A2058%2C%22name%22%3A%22P2929%20%5BUSACO09HOL%5D%5Cu4f20%5Cu8f93%5Cu5ef6%5Cu8fdfTransmission%20Delay%22%2C%22slug%22%3A%22P2929%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P2408%22%2C%22title%22%3A%22%5Cu4e0d%5Cu540c%5Cu5b50%5Cu4e32%5Cu4e2a%5Cu6570%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P2921%22%2C%22title%22%3A%22%5BUSACO08DEC%5D%5Cu5728%5Cu519c%5Cu573a%5Cu4e07%5Cu5723%5Cu8282Trick%20or%20Treat%20on%20the%20Farm%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P2928%22%2C%22title%22%3A%22%5BUSACO09HOL%5D%5Cu725b%5Cu7684%5Cu6253%5Cu624bCattle%20Bruisers%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P2930%22%2C%22title%22%3A%22%5BUSACO09HOL%5D%5Cu5047%5Cu671f%5Cu7ed8%5Cu753bHoliday%20Painting%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P2954%22%2C%22title%22%3A%22%5BUSACO09OPEN%5D%5Cu79fb%5Cu52a8%5Cu725b%5Cu68daGrazing2%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22P%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22%5BUSACO09HOL%5D%5Cu4f20%5Cu8f93%5Cu5ef6%5Cu8fdfTransmission%20Delay%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573286098;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>[USACO09HOL]传输延迟Transmission Delay</h1>
<h2>题目描述</h2>
<div>Farmer John has taken to yodeling from the top of the barn in order to communicate with the cows out in the pastures. Being bovine and all, cows can hear binary messages (0's and 1's) but have trouble with perfect communications because FJ's yodeling echoes off the silo. In fact, in a sequence of N (1 <= N <= 2,000) bits, Bessie will always receive a sequence of N bits, with the same number of 0s and 1s, but each 0 or 1 might be delayed.
Precisely speaking, for a given number D (0 <= D < N), the i-th bit might be heard as the j-th one as long as |i - j| <= D (in other words, no bit appears in a position farther than distance D from its original position).
Consider the following message as an example: 0110. Four possible messages might be heard if D = 1: 0101, 0110, 1001, and 1010.
Given the message to be yodeled by FJ, along with two numbers D and K (1 <= K <= 100,000,000), determine the number of different messages that might be heard by Bessie, modulo 100,000,000. Also determine the K-th smallest such message in lexicographical order (in binary representation, with 0 coming before 1). It is guaranteed that K will be no larger than the number of different possible messages.
MEMORY LIMIT: 32 MB
TIME LIMIT: 2 seconds
FEEDBACK: Your first 50 submissions for this problem will be run on some of the official test data, and you will receive a summary of the results.
约翰在屋顶上唱歌，以此来与奶牛们交流．但是奶牛们的听力很奇怪，她们只能听到约翰的歌声变成0和1构成的信息串时的样子． 约翰的声音里有N(1≤N≤2000)个0或1，奶牛听到的也是N个，而且0和1的数量不会变化，但是一部分0或1可能偏离原来的位置，这就是约翰的歌声在传输时发生的“传输延迟”现象．0或1的偏离距离不会超过D(O≤D<N)，也就是说某一个码的原本位置和现在的位置之差的绝对值不大于D. 比如，对于0110，D=1，传输延迟发生后可能出现0101，0110，1001，1010这四种串． 给出约翰歌声的01串形式和一个整数K(1≤K≤108)，请计算传输延迟发生后一共有多少种可能的01串，以及其中第K大的串是什么． </div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>\* Line 1: Three space-separated integers: N, D, and K
\* Line 2: FJ's binary message, containing exactly N bits
</div>
<h3>输出格式</h3>
<br />
<div>\* Line 1: The number of different possible messages that can heard by Bessie, mod 100,000,000
\* Line 2: The K-th smallest such message (in binary representation)
Note that if your program's first line of output is correct but the second line of output is either missing or wrong, you will receive 40% of the points for that test case.
</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>4 1 3 
0110 
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>4 
1001 
</code></pre>
</article>
</div>
</div>
</body>
</html>
