<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>[POI2010]MOS-Bridges - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573376983:OHU3EQMPPwaJMKOMX8+mTx1hxypMbCwAAxKhKAitI3M=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%22%2C%22description%22%3A%22San%20Bytecisco%20is%20a%20beautifully%20situated%20coastal%20town.%5Cn%5CnIt%20consists%20of%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI17%5C%2Fmos-en-tex.1.png%29%20small%2C%20yet%20densely%20populated%20islands%2C%20%20numbered%20from%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI17%5C%2Fmos-en-tex.2.png%29%20to%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI17%5C%2Fmos-en-tex.3.png%29.%5Cn%5CnCertain%20islands%20are%20connected%20with%20bridges%2C%20used%20for%20%28bidirectional%29%20%20road%20traffic.%5Cn%5CnEach%20pair%20of%20islands%20can%20be%20connected%20with%20at%20most%20one%20bridge.%5Cn%5CnThe%20islands%20are%20connected%20in%20such%20a%20way%20that%20every%20island%20can%20be%20reached%20%20from%20every%20other%20by%20using%20the%20bridges%20only.%5Cn%5CnByteasar%20and%20Bytie%20are%20going%20for%20a%20bike%20trip%20in%20San%20Bytecisco.%5Cn%5CnThe%20will%20start%20their%20ride%20at%20the%20island%20no.%201.%5Cn%5CnThey%20intend%20to%20visit%20every%20island%2C%20while%20passing%20along%20every%20bridge%20once%20%20and%20ending%20the%20trip%20where%20it%20began%2C%20i.e.%2C%20the%20island%20no.%201.%5Cn%5CnBeing%20quite%20seasoned%20riders%2C%20they%20expect%20some%20serious%20trouble%20from...%20the%20wind%21%5Cn%5CnAfter%20all%2C%20it%20is%20very%20windy%20along%20the%20coast%2C%20and%20especially%20so%20on%20the%20bridges%20between%20%20the%20islands.%20Obviously%2C%20depending%20on%20its%20speed%20and%20direction%2C%20the%20wind%20makes%20it%20%20hard%20to%20cross%20the%20bridge%20in%20different%20extent%20for%20either%20direction.%5Cn%5CnFor%20simplicity%20we%20will%20assume%20for%20every%20bridge%20and%20direction%20of%20crossing%2C%20%20the%20opposing%20wind%20speed%20is%20constant.%5Cn%5CnHelp%20Byteasar%20and%20Bytie%20to%20find%20a%20route%20as%20they%20desire%20that%20will%20in%20addition%20%20be%20the%20least%20tiresome.%20Byteasar%20and%20Bytie%20agreed%20on%20the%20maximum%20opposing%20wind%20speed%20as%20%20a%20measure%20of%20a%20route%27s%20tiresomeness.%5Cn%5Cn%5Cn%22%2C%22inputFormat%22%3A%22In%20the%20first%20line%20of%20the%20standard%20input%20there%20are%20two%20integers%20separated%20by%20a%20single%20space%3A%20%24n%24%20and%20%24m%24%20%28%242%20%5C%5Cle%20n%20%5C%5Cle%201000%24%2C%20%241%20%5C%5Cle%20m%20%5C%5Cle%202000%29%2C%20denoting%20the%20number%20of%20islands%20and%20the%20number%20of%20bridges%20in%20San%20Bytecisco%20respectively.%20The%20islands%20are%20numbered%20from%201%20to%20n%2C%20while%20the%20bridges%20from%201%20to%20m.%20The%20following%20%20lines%20specify%20the%20bridges.%20The%20line%20no.%28%24n%2B1%24%29%20%20contains%20four%20integers%20%24a_i%2Cb_i%2Cl_i%2Cp_i%24%20%28%241%5C%5Cle%20l_i%2Cp_i%20%5C%5Cle%201000%24%29%2C%20separated%20by%20single%20spaces.%20These%20denote%20that%20the%20bridge%20no.%20%24i%24%20connects%20the%20islands%20no.%20%24a%24%20and%20%24b%24.%20The%20opposing%20wind%20speeds%20are%20%20when%20one%20goes%20moves%20from%20%20to%20%2C%20and%20%20if%20one%20goes%20from%20%24a%24%20to%20%24b%24.%22%2C%22outputFormat%22%3A%22If%20there%20is%20no%20route%20satisfying%20the%20requirements%20of%20the%20daring%20two%20riders%2C%20%20%20the%20first%20and%20only%20line%20of%20the%20standard%20output%20should%20hold%20the%20word%20NIE%20%20%20%28no%20in%20Polish%29.%5Cn%5CnOtherwise%2C%20the%20output%20should%20have%20two%20lines%2C%20specifying%20the%20least%20tiresome%20route%20%20%20over%20San%20Bytecisco.%5Cn%5CnThe%20first%20line%20should%20hold%20the%20maximum%20opposing%20wind%20speed%20for%20that%20route%2C%20i.e.%2C%20%20%20the%20number%20we%20wish%20to%20minimize.%5Cn%5CnThe%20second%20line%20should%20hold%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI17%5C%2Fmos-en-tex.28.png%29%20integers%2C%20separated%20by%20single%20spaces%2C%20giving%20%20%20the%20numbers%20of%20successive%20bridges%20one%20crosses%20on%20the%20least%20tiresome%20route.%5Cn%5CnShould%20there%20be%20more%20than%20one%20least%20tiresome%20route%2C%20your%20program%20can%20pick%20one%20%20%20arbitrarily.%5Cn%22%2C%22samples%22%3A%5B%5B%224%204%5Cn1%202%202%204%5Cn2%203%203%204%5Cn3%204%204%204%5Cn4%201%205%204%22%2C%224%5Cn4%203%202%201%22%5D%5D%2C%22hint%22%3A%22%242%20%5C%5Cle%20n%20%5C%5Cle%201000%24%5Cuff0c%241%20%5C%5Cle%20m%20%5C%5Cle%2020000%24%5Cuff0c%241%20%5C%5Cle%20a_i%2Cb_i%20%5C%5Cle%20n%24%5Cuff0c%24a_i%20%5C%5Cneq%20b_i%24%5Cuff0c%241%20%5C%5Cle%20l_i%2Cp_i%20%5C%5Cle%201000%24%5Cn%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%5D%2C%22memory%22%3A%5B128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22translation%22%3A%22%5Cu5728%5Cu4e00%5Cu4e2a%5Cu65e0%5Cu5411%5Cu56fe%5Cu4e2d%5Cu627e%5Cu4e00%5Cu6761%5Cu6700%5Cu5927%5Cu8fb9%5Cu6743%5Cu6700%5Cu5c0f%5Cu7684%5Cu6b27%5Cu62c9%5Cu56de%5Cu8def%5Cu3002%22%2C%22tags%22%3A%5B27%2C45%2C57%2C182%2C194%2C319%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A108%2C%22totalAccepted%22%3A1%2C%22pid%22%3A%22P3511%22%2C%22title%22%3A%22%5BPOI2010%5DMOS-Bridges%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22P%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A92683%2C%22title%22%3A%22%5Cu6c42%5Cu4e2aspj%22%2C%22forum%22%3A%7B%22id%22%3A2594%2C%22name%22%3A%22P3511%20%5BPOI2010%5DMOS-Bridges%22%2C%22slug%22%3A%22P3511%22%7D%7D%2C%7B%22id%22%3A71052%2C%22title%22%3A%22%5Cu8fd9%5Cu9053%5Cu9898%5Cu662f%5Cu4e0d%5Cu662f%5Cu7f3aSPJ%5Cu554a%22%2C%22forum%22%3A%7B%22id%22%3A2594%2C%22name%22%3A%22P3511%20%5BPOI2010%5DMOS-Bridges%22%2C%22slug%22%3A%22P3511%22%7D%7D%2C%7B%22id%22%3A64872%2C%22title%22%3A%22%5Cu8fd9%5Cu9898%5Cu6570%5Cu636e%5Cu5e94%5Cu8be5%5Cu6709%5Cu95ee%5Cu9898%22%2C%22forum%22%3A%7B%22id%22%3A2594%2C%22name%22%3A%22P3511%20%5BPOI2010%5DMOS-Bridges%22%2C%22slug%22%3A%22P3511%22%7D%7D%2C%7B%22id%22%3A62471%2C%22title%22%3A%22%5Cu9898%5Cu76ee%5Cu7ffb%5Cu8bd1%5Cu6709%5Cu95ee%5Cu9898%22%2C%22forum%22%3A%7B%22id%22%3A2594%2C%22name%22%3A%22P3511%20%5BPOI2010%5DMOS-Bridges%22%2C%22slug%22%3A%22P3511%22%7D%7D%2C%7B%22id%22%3A44224%2C%22title%22%3A%22%5Cu662f%5Cu4e0d%5Cu662f%5Cu8fd9%5Cu9898%5Cu6570%5Cu636e%5Cu6709%5Cu95ee%5Cu9898%5Cu554a%22%2C%22forum%22%3A%7B%22id%22%3A2594%2C%22name%22%3A%22P3511%20%5BPOI2010%5DMOS-Bridges%22%2C%22slug%22%3A%22P3511%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P1240%22%2C%22title%22%3A%22%5Cu8bf8%5Cu4faf%5Cu5b89%5Cu7f6e%22%2C%22difficulty%22%3A4%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P1600%22%2C%22title%22%3A%22%5Cu5929%5Cu5929%5Cu7231%5Cu8dd1%5Cu6b65%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P4401%22%2C%22title%22%3A%22%5BIOI2007%5DMiners%20%5Cu77ff%5Cu5de5%5Cu914d%5Cu9910%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P4646%22%2C%22title%22%3A%22%5BIOI2007%5D%20flood%20%5Cu6d2a%5Cu6c34%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22%5BPOI2010%5DMOS-Bridges%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>[POI2010]MOS-Bridges</h1>
<h2>题意翻译</h2>
<div>在一个无向图中找一条最大边权最小的欧拉回路。</div>
<h2>题目描述</h2>
<div>San Bytecisco is a beautifully situated coastal town.
It consists of ![](http://main.edu.pl/images/OI17/mos-en-tex.1.png) small, yet densely populated islands, numbered from ![](http://main.edu.pl/images/OI17/mos-en-tex.2.png) to ![](http://main.edu.pl/images/OI17/mos-en-tex.3.png).
Certain islands are connected with bridges, used for (bidirectional) road traffic.
Each pair of islands can be connected with at most one bridge.
The islands are connected in such a way that every island can be reached from every other by using the bridges only.
Byteasar and Bytie are going for a bike trip in San Bytecisco.
The will start their ride at the island no. 1.
They intend to visit every island, while passing along every bridge once and ending the trip where it began, i.e., the island no. 1.
Being quite seasoned riders, they expect some serious trouble from... the wind!
After all, it is very windy along the coast, and especially so on the bridges between the islands. Obviously, depending on its speed and direction, the wind makes it hard to cross the bridge in different extent for either direction.
For simplicity we will assume for every bridge and direction of crossing, the opposing wind speed is constant.
Help Byteasar and Bytie to find a route as they desire that will in addition be the least tiresome. Byteasar and Bytie agreed on the maximum opposing wind speed as a measure of a route's tiresomeness.
</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>In the first line of the standard input there are two integers separated by a single space: $n$ and $m$ ($2 \le n \le 1000$, $1 \le m \le 2000), denoting the number of islands and the number of bridges in San Bytecisco respectively. The islands are numbered from 1 to n, while the bridges from 1 to m. The following lines specify the bridges. The line no.($n+1$) contains four integers $a_i,b_i,l_i,p_i$ ($1\le l_i,p_i \le 1000$), separated by single spaces. These denote that the bridge no. $i$ connects the islands no. $a$ and $b$. The opposing wind speeds are when one goes moves from to , and if one goes from $a$ to $b$.</div>
<h3>输出格式</h3>
<br />
<div>If there is no route satisfying the requirements of the daring two riders, the first and only line of the standard output should hold the word NIE (no in Polish).
Otherwise, the output should have two lines, specifying the least tiresome route over San Bytecisco.
The first line should hold the maximum opposing wind speed for that route, i.e., the number we wish to minimize.
The second line should hold ![](http://main.edu.pl/images/OI17/mos-en-tex.28.png) integers, separated by single spaces, giving the numbers of successive bridges one crosses on the least tiresome route.
Should there be more than one least tiresome route, your program can pick one arbitrarily.
</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>4 4
1 2 2 4
2 3 3 4
3 4 4 4
4 1 5 4</code></pre>
<h3>输出样例 #1</h3>
<pre><code>4
4 3 2 1</code></pre>
<h2>说明</h2>
<div>$2 \le n \le 1000$，$1 \le m \le 20000$，$1 \le a_i,b_i \le n$，$a_i \neq b_i$，$1 \le l_i,p_i \le 1000$
</div>
</article>
</div>
</div>
</body>
</html>
