<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>[USACO12DEC]逃跑的BarnRunning Away From… - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573376357:qe/7zhzcYHmgbzmYkpmNEM1b8s+IAqZXO+xN1GIb8JI=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%22%2C%22description%22%3A%22It%27s%20milking%20time%20at%20Farmer%20John%27s%20farm%2C%20but%20the%20cows%20have%20all%20run%20away%21%20Farmer%20John%20needs%20to%20round%20them%20all%20up%2C%20and%20needs%20your%20help%20in%20the%20search.%5Cn%5CnFJ%27s%20farm%20is%20a%20series%20of%20N%20%281%20%3C%3D%20N%20%3C%3D%20200%2C000%29%20pastures%20numbered%201...N%20connected%20by%20N%20-%201%20bidirectional%20paths.%20The%20barn%20is%20located%20at%20pasture%201%2C%20and%20it%20is%20possible%20to%20reach%20any%20pasture%20from%20the%20barn.%5Cn%5CnFJ%27s%20cows%20were%20in%20their%20pastures%20this%20morning%2C%20but%20who%20knows%20where%20they%20ran%20to%20by%20now.%20FJ%20does%20know%20that%20the%20cows%20only%20run%20away%20from%20the%20barn%2C%20and%20they%20are%20too%20lazy%20to%20run%20a%20distance%20of%20more%20than%20L.%20For%20every%20pasture%2C%20FJ%20wants%20to%20know%20how%20many%20different%20pastures%20cows%20starting%20in%20that%20pasture%20could%20have%20ended%20up%20in.%5Cn%5CnNote%3A%2064-bit%20integers%20%28int64%20in%20Pascal%2C%20long%20long%20in%20C%5C%2FC%2B%2B%20and%20long%20in%20Java%29%20are%20needed%20to%20store%20the%20distance%20values.%5Cn%5Cn%5Cu7ed9%5Cu51fa%5Cu4ee51%5Cu53f7%5Cu70b9%5Cu4e3a%5Cu6839%5Cu7684%5Cu4e00%5Cu68f5%5Cu6709%5Cu6839%5Cu6811%5Cuff0c%5Cu95ee%5Cu6bcf%5Cu4e2a%5Cu70b9%5Cu7684%5Cu5b50%5Cu6811%5Cu4e2d%5Cu4e0e%5Cu5b83%5Cu8ddd%5Cu79bb%5Cu5c0f%5Cu4e8e%5Cu7b49%5Cu4e8el%5Cu7684%5Cu70b9%5Cu6709%5Cu591a%5Cu5c11%5Cu4e2a%5Cu3002%5Cn%22%2C%22inputFormat%22%3A%22%5C%5C%2A%20Line%201%3A%202%20integers%2C%20N%20and%20L%20%281%20%3C%3D%20N%20%3C%3D%20200%2C000%2C%201%20%3C%3D%20L%20%3C%3D%2010%5E18%29%5Cn%5Cn%5C%5C%2A%20Lines%202..N%3A%20The%20ith%20line%20contains%20two%20integers%20p%5C%5C_i%20and%20l%5C%5C_i.%20p%5C%5C_i%20%281%20%3C%3D%20p%5C%5C_i%20%3C%20i%29%20is%20the%20%20first%20pasture%20on%20the%20shortest%20path%20between%20pasture%20i%20and%20the%20barn%2C%20and%20l%5C%5C_i%20%20%281%20%3C%3D%20l%5C%5C_i%20%3C%3D%2010%5E12%29%20is%20the%20length%20of%20that%20path.%5Cn%22%2C%22outputFormat%22%3A%22%5C%5C%2A%20Lines%201..N%3A%20One%20number%20per%20line%2C%20the%20number%20on%20line%20i%20is%20the%20number%20pastures%20that%20can%20be%20%20reached%20from%20pasture%20i%20by%20taking%20roads%20that%20lead%20strictly%20farther%20away%20from%20%20the%20barn%20%28pasture%201%29%20whose%20total%20length%20does%20not%20exceed%20L.%5Cn%22%2C%22samples%22%3A%5B%5B%224%205%20%5Cn1%204%20%5Cn2%203%20%5Cn1%205%20%5Cn%22%2C%223%20%5Cn2%20%5Cn1%20%5Cn1%20%5Cn%22%5D%5D%2C%22hint%22%3A%22Cows%20from%20pasture%201%20can%20hide%20at%20pastures%201%2C%202%2C%20and%204.%5Cn%5CnCows%20from%20pasture%202%20can%20hide%20at%20pastures%202%20and%203.%5Cn%5CnPasture%203%20and%204%20are%20as%20far%20from%20the%20barn%20as%20possible%2C%20and%20the%20cows%20can%20hide%20there.%5Cn%22%2C%22provider%22%3A%7B%22uid%22%3A20%2C%22name%22%3A%22FarmerJohn2%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3Anull%2C%22isAdmin%22%3Afalse%2C%22color%22%3A%22Gray%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%5D%2C%22memory%22%3A%5B128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22tags%22%3A%5B29%2C46%2C127%2C233%2C235%2C319%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A1169%2C%22totalAccepted%22%3A427%2C%22pid%22%3A%22P3066%22%2C%22title%22%3A%22%5BUSACO12DEC%5D%5Cu9003%5Cu8dd1%5Cu7684BarnRunning%20Away%20From%5Cu2026%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A22879%2C%22title%22%3A%22%5Cu6807%5Cu7b7e%5Cu5206%5Cu7c7b%5Cu6709%5Cu6bd2%5Cu5427%22%2C%22forum%22%3A%7B%22id%22%3A1956%2C%22name%22%3A%22P3066%20%5BUSACO12DEC%5D%5Cu9003%5Cu8dd1%5Cu7684BarnRunning%20Away%20From%5Cu2026%22%2C%22slug%22%3A%22P3066%22%7D%7D%2C%7B%22id%22%3A4781%2C%22title%22%3A%22%5Cu9898%5Cu76ee%5Cu63cf%5Cu8ff0%5Cu6709%5Cu8bef%22%2C%22forum%22%3A%7B%22id%22%3A1956%2C%22name%22%3A%22P3066%20%5BUSACO12DEC%5D%5Cu9003%5Cu8dd1%5Cu7684BarnRunning%20Away%20From%5Cu2026%22%2C%22slug%22%3A%22P3066%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P1552%22%2C%22title%22%3A%22%5BAPIO2012%5D%5Cu6d3e%5Cu9063%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P3261%22%2C%22title%22%3A%22%5BJLOI2015%5D%5Cu57ce%5Cu6c60%5Cu653b%5Cu5360%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P3567%22%2C%22title%22%3A%22%5BPOI2014%5DKUR-Couriers%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P3899%22%2C%22title%22%3A%22%5B%5Cu6e56%5Cu5357%5Cu96c6%5Cu8bad%5D%5Cu8c08%5Cu7b11%5Cu98ce%5Cu751f%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P4197%22%2C%22title%22%3A%22Peaks%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22%5BUSACO12DEC%5D%5Cu9003%5Cu8dd1%5Cu7684BarnRunning%20Away%20From%5Cu2026%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573286098;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>[USACO12DEC]逃跑的BarnRunning Away From…</h1>
<h2>题目描述</h2>
<div>It's milking time at Farmer John's farm, but the cows have all run away! Farmer John needs to round them all up, and needs your help in the search.
FJ's farm is a series of N (1 <= N <= 200,000) pastures numbered 1...N connected by N - 1 bidirectional paths. The barn is located at pasture 1, and it is possible to reach any pasture from the barn.
FJ's cows were in their pastures this morning, but who knows where they ran to by now. FJ does know that the cows only run away from the barn, and they are too lazy to run a distance of more than L. For every pasture, FJ wants to know how many different pastures cows starting in that pasture could have ended up in.
Note: 64-bit integers (int64 in Pascal, long long in C/C++ and long in Java) are needed to store the distance values.
给出以1号点为根的一棵有根树，问每个点的子树中与它距离小于等于l的点有多少个。
</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>\* Line 1: 2 integers, N and L (1 <= N <= 200,000, 1 <= L <= 10^18)
\* Lines 2..N: The ith line contains two integers p\_i and l\_i. p\_i (1 <= p\_i < i) is the first pasture on the shortest path between pasture i and the barn, and l\_i (1 <= l\_i <= 10^12) is the length of that path.
</div>
<h3>输出格式</h3>
<br />
<div>\* Lines 1..N: One number per line, the number on line i is the number pastures that can be reached from pasture i by taking roads that lead strictly farther away from the barn (pasture 1) whose total length does not exceed L.
</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>4 5 
1 4 
2 3 
1 5 
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>3 
2 
1 
1 
</code></pre>
<h2>说明</h2>
<div>Cows from pasture 1 can hide at pastures 1, 2, and 4.
Cows from pasture 2 can hide at pastures 2 and 3.
Pasture 3 and 4 are as far from the barn as possible, and the cows can hide there.
</div>
</article>
</div>
</div>
</body>
</html>
