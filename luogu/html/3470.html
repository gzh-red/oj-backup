<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>[POI2008]BBB-BBB - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573376933:GAvgsh4O10nS5UgKZcAWBRXksSQRXI1tcB40VEKn/z4=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%22%2C%22description%22%3A%22Byteasar%20has%20an%20account%20at%20The%20Byteotian%20Bit%20Bank%20%28BBB%20in%20short%29.%5Cn%5CnAt%20the%20beginning%20there%20were%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI15%5C%2Fbbb-en-tex.1.png%29%20and%20at%20the%20end%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI15%5C%2Fbbb-en-tex.2.png%29%20bythalers%20in%20the%20%20%20account.%5Cn%5CnEach%20transaction%20was%20either%20a%20deposit%20or%20a%20withdrawal%20of%20one%20bythaler.%5Cn%5CnThe%20account%27s%20balance%20was%20never%20negative.%5Cn%5CnA%20bank%20teller%20has%20prepared%20a%20bank%20statement%3A%20a%20strip%20of%20paper%20with%20%20%20a%20sequence%20of%20pluses%20and%20minuses%20in%20it%20%20%20%28a%20plus%20denotes%20a%20deposit%20while%20minus%20a%20withdrawal%20of%20one%20bythaler%29.%5Cn%5CnSoon%20it%20turned%20out%2C%20that%20some%20transactions%20were%20not%20entered%20correctly.%5Cn%5CnThe%20bank%20teller%20cannot%20print%20another%20statement%2C%20but%20has%20to%20correct%20the%20%20%20one%20already%20printed%20instead.%5Cn%5CnThe%20statement%20needs%20not%20be%20consistent%20with%20the%20truth%2C%20it%20will%20suffice%20%20%20if%20the%20sequence%20of%20transactions%20satisfies%20the%20following%20two%20conditions%3A%5Cn%5Cnthe%20final%20balance%20is%20consistent%20with%20the%20initial%20balance%20%20%20%20%20%20%20and%20the%20sequence%20of%20transactions%20in%20the%20statement%2C%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20according%20to%20the%20sequence%20of%20transactions%20in%20the%20statement%2C%20the%20%20%20%20%20%20%20account%27s%20balance%20was%20never%20negative.%5Cn%5CnYou%20are%20to%20calculate%20the%20minimum%20amount%20of%20time%20the%20bank%20teller%20needs%20to%20%20%20correct%20the%20bank%20statement.%5Cn%5CnThe%20bank%20teller%20can%3A%5Cn%5Cnin%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI15%5C%2Fbbb-en-tex.3.png%29%20seconds%20turn%20an%20arbitrarily%20chosen%20transaction%20to%20its%20%20%20%20%20%20%20opposite%2C%20or%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20in%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI15%5C%2Fbbb-en-tex.4.png%29%20seconds%20remove%20the%20last%20transaction%20and%20put%20it%20at%20the%20beginning%20of%20the%20statement.%5Cn%5CnIf%2C%20for%20example%2C%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI15%5C%2Fbbb-en-tex.5.png%29%2C%20then%20--%2B%2B-%2B-%2B%2B-%2B-%2B%20is%20a%20correct%20%20%20statement.%5Cn%5CnOn%20the%20other%20hand%20the%20statement%20---%2B%2B%2B%2B%2B%2B%20is%20incorrect%2C%20%20%20because%20the%20account%27s%20balance%20would%20become%20negative%20after%20the%20third%20%20%20transaction%2C%20and%20furthermore%20the%20final%20balance%20should%20be%203%2C%20not%205.%5Cn%5CnIt%20can%20be%2C%20however%2C%20corrected%20by%20turning%20the%20second%20to%20last%20symbol%20to%20its%20%20%20opposite%20and%20placing%20the%20last%20transaction%20at%20the%20beginning%20of%20the%20statement.%5Cn%5CnTask%20%20%20%20%20Write%20a%20programme%20that%3A%5Cn%5Cnreads%20the%20current%20bank%20statement%20for%20Byteasar%27s%20account%20%20%20%20%20%20%20%20%20%28a%20sequence%20of%20pluses%20and%20minuses%29%20as%20well%20as%20the%20numbers%20%20%20%20%20%20%20%20%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI15%5C%2Fbbb-en-tex.6.png%29%2C%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI15%5C%2Fbbb-en-tex.7.png%29%2C%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI15%5C%2Fbbb-en-tex.8.png%29%20and%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI15%5C%2Fbbb-en-tex.9.png%29%20from%20the%20standard%20input.%5Cn%5Cnwrites%20out%20to%20the%20standard%20output%20the%20minimum%20number%20of%20seconds%20%20%20%20%20%20%20%20%20needed%20to%20correct%20the%20statement%20in%20a%20way%20such%20that%20the%20initial%20%20%20%20%20%20%20%20%20and%20final%20balance%20are%20consistent%20and%20that%20the%20balance%20is%20never%20%20%20%20%20%20%20%20%20negative.%5Cn%5Cn%5Cu7ed9%5Cu5b9a%5Cu4e00%5Cu4e2a%5Cu7531%2B1%5Cu548c%5Cu22121%5Cu6784%5Cu6210%5Cu7684%5Cu957f%5Cu5ea6%5Cu4e3an%5Cu7684%5Cu5e8f%5Cu5217%5Cuff0c%5Cu63d0%5Cu4f9b%5Cu4e24%5Cu79cd%5Cu64cd%5Cu4f5c%5Cuff1a%5Cn%5Cn1.%5Cu5c06%5Cu67d0%5Cu4e00%5Cu4f4d%5Cu53d6%5Cu53cd%5Cuff0c%5Cu82b1%5Cu9500%5Cu4e3ax%5Cn%5Cn2.%5Cu5c06%5Cu6700%5Cu540e%5Cu4e00%5Cu4f4d%5Cu79fb%5Cu52a8%5Cu5230%5Cu7b2c%5Cu4e00%5Cu4f4d%5Cuff0c%5Cu82b1%5Cu9500%5Cu4e3ay%5Cn%5Cn%5Cu8981%5Cu6c42%5Cu6700%5Cu7ec8p%2Bsumn%3Dq%5Cuff0c%5Cu4e14p%2Bsumi%5Cu22650%281%5Cu2264i%5Cu2264n%29%5Cuff0c%5Cu6c42%5Cu6700%5Cu5c0f%5Cu82b1%5Cu9500%5Cn%5Cnsumi%5Cu4e3a1-i%5Cu7684%5Cu524d%5Cu7f00%5Cu548c%5Cn%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%205%20integers%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI15%5C%2Fbbb-en-tex.10.png%29%2C%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI15%5C%2Fbbb-en-tex.11.png%29%2C%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI15%5C%2Fbbb-en-tex.12.png%29%2C%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI15%5C%2Fbbb-en-tex.13.png%29%20and%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI15%5C%2Fbbb-en-tex.14.png%29%20%20%20%20%20%28%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI15%5C%2Fbbb-en-tex.15.png%29%2C%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI15%5C%2Fbbb-en-tex.16.png%29%2C%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI15%5C%2Fbbb-en-tex.17.png%29%29%2C%20%20%20%20%20%20%20%20%20%20separated%20by%20single%20spaces%20and%20denoting%20respectively%3A%5Cn%5Cnthe%20number%20of%20transactions%20done%20by%20Byteasar%2C%20initial%20and%20final%20account%20%20%20%20%20balance%20and%20the%20number%20of%20seconds%20needed%20to%20perform%20a%20single%20turn%20%20%20%20%20%28change%20of%20sign%29%20and%20move%20of%20transaction%20to%20the%20beginning.%5Cn%5CnThe%20second%20line%20contains%20a%20sequence%20of%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI15%5C%2Fbbb-en-tex.18.png%29%20signs%20%28each%20a%20plus%20%20%20%20%20or%20a%20minus%29%2C%20with%20no%20spaces%20in-between.%5Cn%22%2C%22outputFormat%22%3A%22The%20first%20and%20last%20output%20line%20should%20contain%20one%20integer%2C%20%20%20%20%20the%20minimum%20number%20of%20seconds%20needed%20to%20correct%20the%20statement.%20If%20no%20%20%20%20%20corrections%20are%20necessary%2C%20the%20number%20is%20zero.%5Cn%5CnYou%20may%20assume%20that%20a%20proper%20sequence%20of%20modifications%20exists%20for%20each%20%20%20%20%20test%20data.%5Cn%22%2C%22samples%22%3A%5B%5B%229%202%203%202%201%5Cn---%2B%2B%2B%2B%2B%2B%5Cn%22%2C%223%5Cn%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%5D%2C%22memory%22%3A%5B128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22tags%22%3A%5B25%2C56%2C57%2C319%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A284%2C%22totalAccepted%22%3A110%2C%22pid%22%3A%22P3470%22%2C%22title%22%3A%22%5BPOI2008%5DBBB-BBB%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A153090%2C%22title%22%3A%22%5Cu5173%5Cu4e8e%5Cu9898%5Cu76ee%5Cuff1a%5Cu7ffb%5Cu8bd1%22%2C%22forum%22%3A%7B%22id%22%3A2564%2C%22name%22%3A%22P3470%20%5BPOI2008%5DBBB-BBB%22%2C%22slug%22%3A%22P3470%22%7D%7D%2C%7B%22id%22%3A147181%2C%22title%22%3A%22%5Cu8fd9%5Cu4e2a%5Cu9898%5Cu76ee%5Cu7684%5Cu8f93%5Cu5165%5Cu8f93%5Cu51fa%5Cu683c%5Cu5f0f...%22%2C%22forum%22%3A%7B%22id%22%3A2564%2C%22name%22%3A%22P3470%20%5BPOI2008%5DBBB-BBB%22%2C%22slug%22%3A%22P3470%22%7D%7D%2C%7B%22id%22%3A24731%2C%22title%22%3A%22%5Cu9898%5Cu76ee%5Cu6709%5Cu8bef%5Cu3002%22%2C%22forum%22%3A%7B%22id%22%3A2564%2C%22name%22%3A%22P3470%20%5BPOI2008%5DBBB-BBB%22%2C%22slug%22%3A%22P3470%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P3084%22%2C%22title%22%3A%22%5BUSACO13OPEN%5D%5Cu7167%5Cu7247Photo%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P3469%22%2C%22title%22%3A%22%5BPOI2008%5DBLO-Blockade%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P4197%22%2C%22title%22%3A%22Peaks%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P5601%22%2C%22title%22%3A%22%5Cu5c0fD%5Cu4e0e%5Cu7b14%5Cu8bd5%22%2C%22difficulty%22%3A1%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22CF1251A%22%2C%22title%22%3A%22Broken%20Keyboard%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22%5BPOI2008%5DBBB-BBB%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573286098;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>[POI2008]BBB-BBB</h1>
<h2>题目描述</h2>
<div>Byteasar has an account at The Byteotian Bit Bank (BBB in short).
At the beginning there were ![](http://main.edu.pl/images/OI15/bbb-en-tex.1.png) and at the end ![](http://main.edu.pl/images/OI15/bbb-en-tex.2.png) bythalers in the account.
Each transaction was either a deposit or a withdrawal of one bythaler.
The account's balance was never negative.
A bank teller has prepared a bank statement: a strip of paper with a sequence of pluses and minuses in it (a plus denotes a deposit while minus a withdrawal of one bythaler).
Soon it turned out, that some transactions were not entered correctly.
The bank teller cannot print another statement, but has to correct the one already printed instead.
The statement needs not be consistent with the truth, it will suffice if the sequence of transactions satisfies the following two conditions:
the final balance is consistent with the initial balance and the sequence of transactions in the statement, according to the sequence of transactions in the statement, the account's balance was never negative.
You are to calculate the minimum amount of time the bank teller needs to correct the bank statement.
The bank teller can:
in ![](http://main.edu.pl/images/OI15/bbb-en-tex.3.png) seconds turn an arbitrarily chosen transaction to its opposite, or in ![](http://main.edu.pl/images/OI15/bbb-en-tex.4.png) seconds remove the last transaction and put it at the beginning of the statement.
If, for example, ![](http://main.edu.pl/images/OI15/bbb-en-tex.5.png), then --++-+-++-+-+ is a correct statement.
On the other hand the statement ---++++++ is incorrect, because the account's balance would become negative after the third transaction, and furthermore the final balance should be 3, not 5.
It can be, however, corrected by turning the second to last symbol to its opposite and placing the last transaction at the beginning of the statement.
Task Write a programme that:
reads the current bank statement for Byteasar's account (a sequence of pluses and minuses) as well as the numbers ![](http://main.edu.pl/images/OI15/bbb-en-tex.6.png), ![](http://main.edu.pl/images/OI15/bbb-en-tex.7.png), ![](http://main.edu.pl/images/OI15/bbb-en-tex.8.png) and ![](http://main.edu.pl/images/OI15/bbb-en-tex.9.png) from the standard input.
writes out to the standard output the minimum number of seconds needed to correct the statement in a way such that the initial and final balance are consistent and that the balance is never negative.
给定一个由+1和−1构成的长度为n的序列，提供两种操作：
1.将某一位取反，花销为x
2.将最后一位移动到第一位，花销为y
要求最终p+sumn=q，且p+sumi≥0(1≤i≤n)，求最小花销
sumi为1-i的前缀和
</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains 5 integers ![](http://main.edu.pl/images/OI15/bbb-en-tex.10.png), ![](http://main.edu.pl/images/OI15/bbb-en-tex.11.png), ![](http://main.edu.pl/images/OI15/bbb-en-tex.12.png), ![](http://main.edu.pl/images/OI15/bbb-en-tex.13.png) and ![](http://main.edu.pl/images/OI15/bbb-en-tex.14.png) (![](http://main.edu.pl/images/OI15/bbb-en-tex.15.png), ![](http://main.edu.pl/images/OI15/bbb-en-tex.16.png), ![](http://main.edu.pl/images/OI15/bbb-en-tex.17.png)), separated by single spaces and denoting respectively:
the number of transactions done by Byteasar, initial and final account balance and the number of seconds needed to perform a single turn (change of sign) and move of transaction to the beginning.
The second line contains a sequence of ![](http://main.edu.pl/images/OI15/bbb-en-tex.18.png) signs (each a plus or a minus), with no spaces in-between.
</div>
<h3>输出格式</h3>
<br />
<div>The first and last output line should contain one integer, the minimum number of seconds needed to correct the statement. If no corrections are necessary, the number is zero.
You may assume that a proper sequence of modifications exists for each test data.
</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>9 2 3 2 1
---++++++
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>3
</code></pre>
</article>
</div>
</div>
</body>
</html>
