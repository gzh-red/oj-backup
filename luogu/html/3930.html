<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>SAC E#1 - 一道大水题 Knight - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573380847:91fMlRMyWsKdvqrYuD7ooD2fr4Szj9Bswrgz/aU6pNM=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%5Cu6bd2%5Cu5976%5Cu8272%5Cu548cF91%5Cu662f%5Cu597d%5Cu670b%5Cu53cb%5Cu3002%5Cn%22%2C%22description%22%3A%22%5Cu4ed6%5Cu4eec%5Cu7ecf%5Cu5e38%5Cu5728%5Cu4e00%5Cu8d77%5Cu73a9%5Cu4e00%5Cu4e2a%5Cu6e38%5Cu620f%5Cuff0c%5Cu4e0d%5Cuff0c%5Cu4e0d%5Cu662f%5Cu661f%5Cu9645%5Cu4e89%5Cu9738%5Cuff0c%5Cu662f%5Cu56fd%5Cu9645%5Cu8c61%5Cu68cb%5Cu3002%5Cn%5Cn%5Cu6bd2%5Cu5976%5Cu8272%5Cu89c9%5Cu5f97F91%5Cu662f%5Cu4e00%5Cu53ea%5Cu9e21%5Cu3002%5Cu4ed6%5Cu5728%5Cu4e00%5Cu4e2an%5Cu00d7n%5Cu7684%5Cu68cb%5Cu76d8%5Cu4e0a%5Cu7528%5Cu9ed1%5Cu8272%5Cu7684%5Cu57ce%5Cu5821%5Cuff08%5Cu8f66%5Cuff09%5Cu3001%5Cu9a91%5Cu58eb%5Cuff08%5Cu9a6c%5Cuff09%5Cu3001%5Cu4e3b%5Cu6559%5Cuff08%5Cu8c61%5Cuff09%5Cu3001%5Cu7687%5Cu540e%5Cuff08%5Cu526f%5Cuff09%5Cu3001%5Cu56fd%5Cu738b%5Cuff08%5Cu5e05%5Cuff09%5Cu3001%5Cu58eb%5Cu5175%5Cuff08%5Cu5352%5Cuff09%5Cu6446%5Cu4e86%5Cu4e00%5Cu4e2a%5Cu9635%5Cu3002%5Cn%5Cn%5Cu7136%5Cu800cF91%5Cu89c9%5Cu5f97%5Cu6bd2%5Cu5976%5Cu8272%5Cu662f%5Cu4e00%5Cu53ea%5Cu9e21%5Cu3002%5Cu4ed6%5Cu53d1%5Cu8d77%5Cu4e86%5Cu6311%5Cu6218%5Cuff1a%5Cu4ed6%5Cu8981%5Cu64cd%5Cu7eb5%5Cu4e00%5Cu4e2a%5Cu767d%5Cu8272%5Cu9a91%5Cu58eb%5Cuff0c%5Cu4e0d%5Cu7ecf%5Cu8fc7%5Cu4efb%5Cu4f55%5Cu4e00%5Cu4e2a%5Cu68cb%5Cu5b50%5Cu7684%5Cu653b%5Cu51fb%5Cu8303%5Cu56f4%5Cuff08F91%5Cu53ef%5Cu4ee5%5Cu8fde%5Cu7eed%5Cu884c%5Cu52a8%5Cuff0c%5Cu800c%5Cu6bd2%5Cu5976%5Cu8272%5Cu7684%5Cu68cb%5Cu5b50%5Cu4e0d%5Cu4f1a%5Cu52a8%5Cuff0c%5Cu9664%5Cu975e%5Cu767d%5Cu9a91%5Cu58eb%5Cu8fdb%5Cu5165%5Cu4e86%5Cu5bf9%5Cu65b9%5Cu7684%5Cu653b%5Cu51fb%5Cu8303%5Cu56f4%5Cuff09%5Cuff0c%5Cu5e76%5Cu51fb%5Cu6740%5Cu6bd2%5Cu5976%5Cu8272%5Cu7684%5Cu56fd%5Cu738b%5Cuff08%5Cu5373%5Cu8fdb%5Cu5165%5Cu9ed1%5Cu56fd%5Cu738b%5Cu6240%5Cu5728%5Cu7684%5Cu4f4d%5Cu7f6e%5Cuff09%5Cu3002%5Cn%5Cn%5Cu8bf7%5Cu544a%5Cu8bc9F91%5Cu4ed6%5Cu6700%5Cu5c11%5Cu9700%5Cu8981%5Cu591a%5Cu5c11%5Cu6b65%5Cu9aa4%5Cu6765%5Cu5b8c%5Cu6210%5Cu8fd9%5Cu4e00%5Cu9879%5Cu58ee%5Cu4e3e%5Cu3002%5Cn%5Cn%5Cn%5Cu6ce8%5Cu610f%5Cuff1a%5Cn%5Cn1.%5Cu5f53F91%5Cu7684%5Cu767d%5Cu9a91%5Cu58eb%5Cu8d70%5Cu5230%5Cu6bd2%5Cu5976%5Cu8272%5Cu7684%5Cu68cb%5Cu5b50%5Cu6240%5Cu5728%5Cu7684%5Cu683c%5Cu5b50%5Cu4e0a%5Cu7684%5Cu65f6%5Cu5019%5Cuff0c%5Cu4f1a%5Cu51fb%5Cu6740%5Cuff08%5Cu5403%5Cu6389%5Cuff09%5Cu8be5%5Cu68cb%5Cu5b50%5Cu3002%5Cu8fd9%5Cu4e2a%5Cu68cb%5Cu5b50%5Cu4e5f%5Cu5c31%5Cu4e0d%5Cu518d%5Cu5bf9F91%5Cu7684%5Cu767d%5Cu9a91%5Cu58eb%5Cu6709%5Cu5a01%5Cu80c1%5Cu4e86%5Cu3002%5Cn%5Cn2.%5Cu5982%5Cu679c%5Cu767d%5Cu9a91%5Cu58eb%5Cu5f00%5Cu573a%5Cu5c31%5Cu5728%5Cu9ed1%5Cu5b50%5Cu7684%5Cu653b%5Cu51fb%5Cu8303%5Cu56f4%5Cu5185%5Cuff0c%5Cu5219%5Cu7acb%5Cu523b%5Cu88ab%5Cu51fb%5Cu6740%5Cu3001F91%5Cu7acb%5Cu523b%5Cu5931%5Cu8d25%5Cu3002%5Cn%5Cn3.%5Cu5373%5Cu4f7f%5Cu767d%5Cu9a91%5Cu58eb%5Cu5728%5Cu653b%5Cu51fb%5Cu738b%5Cu7684%5Cu77ac%5Cu95f4%5Cu8fdb%5Cu5165%5Cu4e86%5Cu5176%5Cu4ed6%5Cu68cb%5Cu5b50%5Cu653b%5Cu51fb%5Cu8303%5Cu56f4%5Cuff08%5Cu5373%5Cu5176%5Cu4ed6%5Cu68cb%5Cu5b50%5Cu201c%5Cu770b%5Cu62a4%5Cu201d%5Cu7740%5Cu738b%5Cu6240%5Cu5728%5Cu7684%5Cu683c%5Cu5b50%5Cuff09%5Cuff0c%5Cu4f9d%5Cu7136%5Cu7b97F91%5Cu83b7%5Cu80dc%5Cu3002%5Cn%5Cn%5Cn%5Cu653b%5Cu51fb%5Cu8303%5Cu56f4%5Cuff1a%5Cn%5Cn%5Cn%5Cu57ce%5Cu5821%5Cuff1a%5Cu6a2a%5Cu3001%5Cu7ad6%5Cu65b9%5Cu5411%5Cu6240%5Cu6709%5Cu4f4d%5Cu7f6e%5Cuff0c%5Cu76f4%5Cu5230%5Cu88ab%5Cu4e00%5Cu4e2a%5Cu5176%5Cu4ed6%5Cu68cb%5Cu5b50%5Cu963b%5Cu62e6%5Cu3002%5Cn%5Cn%60%60%60cpp%5Cn..%23..%5Cn..%23..%5Cn%23%23C%23%23%5Cn..%23..%5Cn..%23..%5Cn%60%60%60%5Cn%5Cn%5Cu9a91%5Cu58eb%5Cuff1a%5Cu6a2a2%5Cu7ad61%5Cu6216%5Cu8005%5Cu6a2a1%5Cu7ad62%5Cu7684%5Cu6240%5Cu6709%5Cu4f4d%5Cu7f6e%5Cuff08%5Cu6700%5Cu591a8%5Cu4e2a%5Cuff0c%5Cu7c7b%5Cu4f3c%5Cu65e5%5Cu5b57%5Cuff09%5Cu3002%5Cn%5Cn%60%60%60cpp%5Cn.%23.%23.%5Cn%23...%23%5Cn..K..%5Cn%23...%23%5Cn.%23.%23.%5Cn%60%60%60%5Cn%5Cn%5Cu4e3b%5Cu6559%5Cuff1a%5Cu659c%5Cu5411%5Cuff0845%5Cu00b0%5Cuff09%5Cu6240%5Cu6709%5Cu4f4d%5Cu7f6e%5Cuff0c%5Cu76f4%5Cu5230%5Cu88ab%5Cu4e00%5Cu4e2a%5Cu5176%5Cu4ed6%5Cu68cb%5Cu5b50%5Cu963b%5Cu62e6%5Cu3002%5Cn%5Cn%60%60%60cpp%5Cn%23...%23%5Cn.%23.%23.%5Cn..B..%5Cn.%23.%23.%5Cn%23...%23%5Cn%60%60%60%5Cn%5Cn%5Cu7687%5Cu540e%5Cuff1a%5Cu57ce%5Cu5821%5Cu548c%5Cu4e3b%5Cu6559%5Cu7684%5Cu7ed3%5Cu5408%5Cu4f53%5Cuff08%5Cu65e2%5Cu80fd%5Cu6a2a%5C%2F%5Cu7ad6%5Cu5411%5Cu653b%5Cu51fb%5Cuff0c%5Cu4e5f%5Cu80fd45%5Cu00b0%5Cu89d2%5Cu659c%5Cu5411%5Cu653b%5Cu51fb%5Cuff0c%5Cu76f4%5Cu5230%5Cu88ab%5Cu5176%5Cu4ed6%5Cu68cb%5Cu5b50%5Cu963b%5Cu6321%5Cuff09%5Cu3002%5Cn%5Cn%60%60%60cpp%5Cn%23.%23.%23%5Cn.%23%23%23.%5Cn%23%23Q%23%23%5Cn.%23%23%23.%5Cn%23.%23.%23%5Cn%60%60%60%5Cn%5Cn%5Cu56fd%5Cu738b%5Cuff1a%5Cu8eab%5Cu8fb98%5Cu8fde%5Cu901a%5Cu4f4d%5Cu7f6e%5Cu76848%5Cu4e2a%5Cu683c%5Cu5b50%5Cu3002%5Cn%5Cn%60%60%60cpp%5Cn.....%5Cn.%23%23%23.%5Cn.%23X%23.%5Cn.%23%23%23.%5Cn.....%5Cn%60%60%60%5Cn%5Cn%5Cu58eb%5Cu5175%5Cuff1a%5Cu5de6%5Cu4e0b%5Cu65b9%5C%2F%5Cu53f3%5Cu4e0b%5Cu65b9%5Cuff0845%5Cu00b0%5Cuff09%5Cu7684%5Cu683c%5Cu5b50%5Cuff08%5Cu6700%5Cu591a2%5Cu4e2a%5Cuff09%5Cu3002%5Cn%5Cn%60%60%60%60%60%5Cn.....%5Cn.....%5Cn..P..%5Cn.%23.%23.%5Cn.....%5Cn%60%60%60%5Cn%5Cn%5Cu5176%5Cu4e2d%5Cu5b57%5Cu6bcd%5Cu8868%5Cu793a%5Cu68cb%5Cu5b50%5Cu7c7b%5Cu578b%5Cuff0c%5Cu53c2%5Cu8003%5Cu8f93%5Cu5165%5Cu683c%5Cu5f0f%5Cu3002%5Cn%5Cn%5Cu2018%23%5Cu2019%5Cu8868%5Cu793a%5Cu53ef%5Cu653b%5Cu51fb%5Cu8303%5Cu56f4%5Cu3002%5Cn%22%2C%22inputFormat%22%3A%22%5Cu8f93%5Cu5165%5Cu5305%5Cu542b%5Cu591a%5Cu7ec4%5Cu6570%5Cu636e%5Cu3002%5Cn%5Cn%5Cu6bcf%5Cu4e00%5Cu7ec4%5Cu6570%5Cu636e%5Cu4e2d%5Cuff0c%5Cu7b2c%5Cu4e00%5Cu884c%5Cu4e00%5Cu4e2a%5Cu6574%5Cu6570n%5Cu8868%5Cu793a%5Cu68cb%5Cu76d8%5Cu89c4%5Cu6a21%5Cu3002%5Cn%5Cn%5Cu63a5%5Cu4e0b%5Cu6765n%5Cu884c%5Cuff0c%5Cu6bcf%5Cu884c%5Cu4e00%5Cu4e2a%5Cu957f%5Cu5ea6%5Cu4e3an%5Cu7684%5Cu5b57%5Cu7b26%5Cu4e32%5Cu3002%5Cu63cf%5Cu8ff0%5Cu68cb%5Cu76d8%5Cu7684%5Cu683c%5Cu5c40%5Cu3002%5Cn%5Cn%5Cu5176%5Cu4e2d%5Cuff1a%5Cn%5Cn.%5Cu8868%5Cu793a%5Cu7a7a%5Cn%5CnO%5Cu8868%5Cu793a%5Cu767d%5Cu9a91%5Cu58eb%5Cn%5CnC%5Cu8868%5Cu793a%5Cu9ed1%5Cu57ce%5Cu5821%5Cn%5CnK%5Cu8868%5Cu793a%5Cu9ed1%5Cu9a91%5Cu58eb%5Cn%5CnB%5Cu8868%5Cu793a%5Cu9ed1%5Cu4e3b%5Cu6559%5Cn%5CnQ%5Cu8868%5Cu793a%5Cu9ed2%5Cu7687%5Cu540e%5Cn%5CnX%5Cu8868%5Cu793a%5Cu9ed1%5Cu56fd%5Cu738b%5Cn%5CnP%5Cu8868%5Cu793a%5Cu9ed1%5Cu58eb%5Cu5175%5Cn%22%2C%22outputFormat%22%3A%22%5Cu5bf9%5Cu4e8e%5Cu6bcf%5Cu4e00%5Cu4e2a%5Cu6d4b%5Cu8bd5%5Cu6570%5Cu636e%5Cuff0c%5Cu6bcf%5Cu884c%5Cu8f93%5Cu51fa%5Cu4e00%5Cu4e2a%5Cu6574%5Cu6570%5Cuff0c%5Cu8868%5Cu793aF91%5Cu7684%5Cu6700%5Cu5c0f%5Cu6b65%5Cu6570%5Cu3002%5Cn%5Cn%5Cu5982%5Cu679c%5Cu65e0%5Cu8bbaF91%5Cu5982%5Cu4f55%5Cu884c%5Cu52a8%5Cu4e5f%5Cu65e0%5Cu6cd5%5Cu51fb%5Cu6740%5Cu9ed1%5Cu56fd%5Cu738b%5Cuff0c%5Cu8f93%5Cu51fa-1%5Cu3002%5Cn%22%2C%22samples%22%3A%5B%5B%228%5Cn...X....%5Cn........%5Cn........%5Cn........%5Cn........%5Cn........%5Cn........%5Cn......O.%22%2C%224%22%5D%2C%5B%228%5Cn......X.%5Cn........%5Cn.O......%5Cn...P.Q.C%5Cn.....B..%5Cn........%5Cn...K....%5Cn........%22%2C%227%22%5D%5D%2C%22hint%22%3A%22%2A%2A%5Cu8f93%5Cu5165%5Cu6700%5Cu591a%5Cu5305%5Cu542b5%5Cu7ec4%5Cu6570%5Cu636e%5Cu3002%2A%2A%5Cn%5Cn%5Cu5bf9%5Cu4e8e20%25%5Cu7684%5Cu6570%5Cu636e%5Cuff0c%5Cu6bd2%5Cu5976%5Cu8272%5Cu53ea%5Cu6709%5Cu56fd%5Cu738b%5Cu3002n%20%3C%3D%208%5Cu3002%5Cn%5Cn%5Cu5bf9%5Cu4e8e30%25%5Cu7684%5Cu6570%5Cu636e%5Cuff0c%5Cu6bd2%5Cu5976%5Cu8272%5Cu53ea%5Cu6709%5Cu56fd%5Cu738b%5Cu3001%5Cu9a91%5Cu58eb%5Cu3002n%20%3C%3D%208%5Cu3002%5Cn%5Cn%5Cu5bf9%5Cu4e8e60%25%5Cu7684%5Cu6570%5Cu636e%5Cuff0c%5Cu6bd2%5Cu5976%5Cu8272%5Cu53ea%5Cu6709%5Cu56fd%5Cu738b%5Cu3001%5Cu9a91%5Cu58eb%5Cu3001%5Cu738b%5Cu540e%5Cu3002n%20%3C%3D%2050%5Cu3002%5Cn%5Cn%5Cu5bf9%5Cu4e8e100%25%5Cu7684%5Cu6570%5Cu636e%5Cuff0c%5Cu6bd2%5Cu5976%5Cu8272%5Cu53ef%5Cu4ee5%5Cu6709%5Cu5168%5Cu595716%5Cu9897%5Cu68cb%5Cu5b50%5Cuff082%5Cu57ce%5Cu5821%5Cuff0c2%5Cu9a91%5Cu58eb%5Cuff0c2%5Cu4e3b%5Cu6559%5Cuff0c1%5Cu540e%5Cuff0c1%5Cu738b%5Cuff0c8%5Cu5175%5Cuff09%5Cu3002n%20%3C%3D%2050%5Cu3002%5Cn%5Cn%5Cn%5Cu6e29%5Cu99a8%5Cu63d0%5Cu793a%5Cuff1a%5Cn%5Cn%5Cu65f6%5Cu95f4%5Cu9650%5Cu5236%5Cu53ef%5Cu80fd%5Cu6bd4%5Cu60f3%5Cu8c61%5Cu4e4b%5Cu4e2d%5Cu8fd8%5Cu8981%5Cu66f4%5Cu7d27%5Cu4e00%5Cu70b9%5Cuff0c%5Cu8bf7%5Cu6ce8%5Cu610f%5Cu5b9e%5Cu73b0%5Cu7ec6%5Cu8282%5Cu4ee5%5Cu4fdd%5Cu8bc1%5Cu6027%5Cu80fd%5Cu3002%5Cn%5Cn%5Cn%5Cn%5Cu6837%5Cu4f8b2%5Cu89e3%5Cu91ca%5Cuff1a%5Cn%5Cn%5Cu4e00%5Cu79cd%5Cu53ef%5Cu884c%5Cu7684%5Cu505a%5Cu6cd5%5Cu662f%5Cuff1a%5Cn%5Cn%60%60%60cpp%5Cn......X.%5Cn.3..6...%5Cn.O5.....%5Cn4.2P.Q.C%5Cn1....B..%5Cn........%5Cn...K....%5Cn........%5Cn%60%60%60%22%2C%22provider%22%3A%7B%22uid%22%3A19487%2C%22name%22%3A%22ProjectWTA%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3Anull%2C%22isAdmin%22%3Afalse%2C%22color%22%3A%22Blue%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B3000%2C3000%2C3000%2C3000%2C3000%2C3000%2C3000%2C3000%2C3000%2C3000%5D%2C%22memory%22%3A%5B512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%5D%7D%2C%22stdCode%22%3A%22%23include%20%3Ciostream%3E%5Cn%23include%20%3Ccstring%3E%5Cn%23include%20%3Ccstdio%3E%5Cn%23include%20%3Cqueue%3E%5Cn%23include%20%3Cunordered_map%3E%5Cn%23include%20%3Cmap%3E%5Cn%23define%20maxn%2050%5Cn%23define%20seed1%201009%5Cn%23define%20seed2%205861%5Cn%23define%20mod1%20998244353%5Cn%23define%20mod2%201000000009%5Cn%5Cnconst%20int%20dx%5B8%5D%20%3D%20%7B2%2C%201%2C%20-1%2C%20-2%2C%20-2%2C%20-1%2C%201%2C%202%7D%3B%5Cnconst%20int%20dy%5B8%5D%20%3D%20%7B1%2C%202%2C%202%2C%201%2C%20-1%2C%20-2%2C%20-2%2C%20-1%7D%3B%5Cnconst%20int%20dxk%5B8%5D%20%3D%20%7B1%2C%201%20%2C0%2C%20-1%2C%20-1%2C%20-1%2C%200%2C%201%7D%3B%5Cnconst%20int%20dyk%5B8%5D%20%3D%20%7B0%2C%201%2C%201%2C%201%2C%200%2C%20-1%2C%20-1%2C%20-1%7D%3B%5Cn%5Cnstruct%20Status%5Cn%7B%5Cn%20%20%20%20enum%20ChessType%5Cn%20%20%20%20%7B%5Cn%20%20%20%20%20%20%20%20EMPTY%2C%5Cn%20%20%20%20%20%20%20%20HERO%2C%5Cn%20%20%20%20%20%20%20%20CASTLE%2C%5Cn%20%20%20%20%20%20%20%20KNIGHT%2C%5Cn%20%20%20%20%20%20%20%20BISHOP%2C%5Cn%20%20%20%20%20%20%20%20QUEEN%2C%5Cn%20%20%20%20%20%20%20%20KING%2C%5Cn%20%20%20%20%20%20%20%20PAWN%5Cn%20%20%20%20%7D%3B%5Cn%5Cn%20%20%20%20int%20map%5Bmaxn%5D%5Bmaxn%5D%3B%5Cn%20%20%20%20int%20x%2C%20y%2C%20dist%2C%20n%3B%5Cn%20%20%20%20long%20long%20hashVal%3B%5Cn%20%20%20%20%5Cn%20%20%20%20inline%20bool%20read%28%29%5Cn%20%20%20%20%7B%5Cn%20%20%20%20%20%20%20%20char%20s%5B60%5D%3B%5Cn%20%20%20%20%20%20%20%20if%20%28scanf%28%5C%22%25d%5C%22%2C%20%26n%29%20%3C%201%29%5Cn%20%20%20%20%20%20%20%20%20%20%20%20return%20false%3B%5Cn%20%20%20%20%20%20%20%20for%20%28int%20i%20%3D%200%3B%20i%20%3C%20n%3B%20i%2B%2B%29%5Cn%20%20%20%20%20%20%20%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20scanf%28%5C%22%25s%5C%22%2C%20s%29%3B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20for%20%28int%20j%20%3D%200%3B%20j%20%3C%20n%3B%20j%2B%2B%29%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28s%5Bj%5D%20%3D%3D%20%27.%27%29%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20map%5Bi%5D%5Bj%5D%20%3D%20EMPTY%3B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%20if%20%28s%5Bj%5D%20%3D%3D%20%27O%27%29%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20map%5Bi%5D%5Bj%5D%20%3D%20HERO%3B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%20%3D%20i%2C%20y%20%3D%20j%3B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%20if%20%28s%5Bj%5D%20%3D%3D%20%27C%27%29%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20map%5Bi%5D%5Bj%5D%20%3D%20CASTLE%3B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%20if%20%28s%5Bj%5D%20%3D%3D%20%27K%27%29%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20map%5Bi%5D%5Bj%5D%20%3D%20KNIGHT%3B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%20if%20%28s%5Bj%5D%20%3D%3D%20%27B%27%29%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20map%5Bi%5D%5Bj%5D%20%3D%20BISHOP%3B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%20if%20%28s%5Bj%5D%20%3D%3D%20%27Q%27%29%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20map%5Bi%5D%5Bj%5D%20%3D%20QUEEN%3B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%20if%20%28s%5Bj%5D%20%3D%3D%20%27X%27%29%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20map%5Bi%5D%5Bj%5D%20%3D%20KING%3B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%20if%20%28s%5Bj%5D%20%3D%3D%20%27P%27%29%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20map%5Bi%5D%5Bj%5D%20%3D%20PAWN%3B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20dist%20%3D%200%3B%5Cn%20%20%20%20%20%20%20%20calcHash%28%29%3B%5Cn%20%20%20%20%20%20%20%20return%20true%3B%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20inline%20bool%20judgeCastle%28int%20a%2C%20int%20b%2C%20int%20TYPE%29%5Cn%20%20%20%20%7B%5Cn%20%20%20%20%20%20%20%20for%20%28int%20i%20%3D%20a%20%2B%201%3B%20i%20%3C%20n%3B%20i%2B%2B%29%5Cn%20%20%20%20%20%20%20%20%20%20%20%20if%20%28map%5Bi%5D%5Bb%5D%20%21%3D%20EMPTY%29%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28map%5Bi%5D%5Bb%5D%20%3D%3D%20TYPE%29%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20true%3B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%3B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20for%20%28int%20i%20%3D%20a%20-%201%3B%20i%20%3E%3D%200%20%3B%20i--%29%5Cn%20%20%20%20%20%20%20%20%20%20%20%20if%20%28map%5Bi%5D%5Bb%5D%20%21%3D%20EMPTY%29%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28map%5Bi%5D%5Bb%5D%20%3D%3D%20TYPE%29%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20true%3B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%3B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20for%20%28int%20i%20%3D%20b%20%2B%201%3B%20i%20%3C%20n%3B%20i%2B%2B%29%5Cn%20%20%20%20%20%20%20%20%20%20%20%20if%20%28map%5Ba%5D%5Bi%5D%20%21%3D%20EMPTY%29%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28map%5Ba%5D%5Bi%5D%20%3D%3D%20TYPE%29%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20true%3B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%3B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20for%20%28int%20i%20%3D%20b%20-%201%3B%20i%20%3E%3D%20n%20%3B%20i--%29%5Cn%20%20%20%20%20%20%20%20%20%20%20%20if%20%28map%5Ba%5D%5Bi%5D%20%21%3D%20EMPTY%29%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28map%5Ba%5D%5Bi%5D%20%3D%3D%20TYPE%29%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20true%3B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%3B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20return%20false%3B%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20inline%20bool%20judgeKnight%28int%20a%2C%20int%20b%2C%20int%20TYPE%29%5Cn%20%20%20%20%7B%5Cn%20%20%20%20%20%20%20%20for%20%28int%20d%20%3D%200%2C%20i%2C%20j%3B%20d%20%3C%20n%3B%20d%2B%2B%29%5Cn%20%20%20%20%20%20%20%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20i%20%3D%20a%20%2B%20dx%5Bd%5D%3B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20j%20%3D%20b%20%2B%20dy%5Bd%5D%3B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20if%20%280%20%3C%3D%20i%20%26%26%20i%20%3C%20n%20%26%26%200%20%3C%3D%20j%20%26%26%20j%20%3C%20n%20%26%26%20map%5Bi%5D%5Bj%5D%20%3D%3D%20TYPE%29%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20true%3B%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20return%20false%3B%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20inline%20bool%20judgeBishop%28int%20a%2C%20int%20b%2C%20int%20TYPE%29%5Cn%20%20%20%20%7B%5Cn%20%20%20%20%20%20%20%20for%20%28int%20i%20%3D%20a%20%2B%201%2C%20j%20%3D%20b%20%2B%201%3B%20i%20%3C%20n%20%26%26%20j%20%3C%20n%3B%20i%2B%2B%2C%20j%2B%2B%29%5Cn%20%20%20%20%20%20%20%20%20%20%20%20if%20%28map%5Bi%5D%5Bj%5D%20%21%3D%20EMPTY%29%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28map%5Bi%5D%5Bj%5D%20%3D%3D%20TYPE%29%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20true%3B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%3B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20for%20%28int%20i%20%3D%20a%20%2B%201%2C%20j%20%3D%20b%20-%201%3B%20i%20%3C%20n%20%26%26%20j%20%3E%3D%200%3B%20i%2B%2B%2C%20j--%29%5Cn%20%20%20%20%20%20%20%20%20%20%20%20if%20%28map%5Bi%5D%5Bj%5D%20%21%3D%20EMPTY%29%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28map%5Bi%5D%5Bj%5D%20%3D%3D%20TYPE%29%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20true%3B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%3B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20for%20%28int%20i%20%3D%20a%20-%201%2C%20j%20%3D%20b%20%2B%201%3B%20i%20%3E%3D%200%20%26%26%20j%20%3C%20n%3B%20i--%2C%20j%2B%2B%29%5Cn%20%20%20%20%20%20%20%20%20%20%20%20if%20%28map%5Bi%5D%5Bj%5D%20%21%3D%20EMPTY%29%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28map%5Bi%5D%5Bj%5D%20%3D%3D%20TYPE%29%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20true%3B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%3B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20for%20%28int%20i%20%3D%20a%20-%201%2C%20j%20%3D%20b%20-%201%3B%20i%20%3E%3D%200%20%26%26%20j%20%3E%3D%200%3B%20i--%2C%20j--%29%5Cn%20%20%20%20%20%20%20%20%20%20%20%20if%20%28map%5Bi%5D%5Bj%5D%20%21%3D%20EMPTY%29%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28map%5Bi%5D%5Bj%5D%20%3D%3D%20TYPE%29%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20true%3B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%3B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20return%20false%3B%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20inline%20bool%20judgeQueen%28int%20a%2C%20int%20b%2C%20int%20TYPE%29%5Cn%20%20%20%20%7B%5Cn%20%20%20%20%20%20%20%20return%20judgeCastle%28a%2C%20b%2C%20TYPE%29%20%7C%7C%20judgeBishop%28a%2C%20b%2C%20TYPE%29%3B%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20inline%20bool%20judgeKing%28int%20a%2C%20int%20b%2C%20int%20TYPE%29%5Cn%20%20%20%20%7B%5Cn%20%20%20%20%20%20%20%20for%28int%20d%20%3D%200%2C%20i%2C%20j%3B%20d%20%3C%208%3B%20d%2B%2B%29%5Cn%20%20%20%20%20%20%20%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20i%20%3D%20a%20%2B%20dxk%5Bd%5D%3B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20j%20%3D%20b%20%2B%20dyk%5Bd%5D%3B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20if%20%280%20%3C%3D%20i%20%26%26%20i%20%3C%20n%20%26%26%200%20%3C%3D%20j%20%26%26%20j%20%3C%20n%20%26%26%20map%5Bi%5D%5Bj%5D%20%3D%3D%20TYPE%29%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20true%3B%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20return%20false%3B%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20inline%20bool%20judgePawn%28int%20a%2C%20int%20b%2C%20int%20TYPE%29%5Cn%20%20%20%20%7B%5Cn%20%20%20%20%20%20%20%20if%20%28a%20%3D%3D%200%29%5Cn%20%20%20%20%20%20%20%20%20%20%20%20return%20false%3B%5Cn%20%20%20%20%20%20%20%20if%20%28b%20%3E%200%20%26%26%20map%5Ba-1%5D%5Bb-1%5D%20%3D%3D%20TYPE%29%5Cn%20%20%20%20%20%20%20%20%20%20%20%20return%20true%3B%5Cn%20%20%20%20%20%20%20%20if%20%28b%20%3C%20n%20%26%26%20map%5Ba-1%5D%5Bb%2B1%5D%20%3D%3D%20TYPE%29%5Cn%20%20%20%20%20%20%20%20%20%20%20%20return%20true%3B%5Cn%20%20%20%20%20%20%20%20return%20false%3B%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20inline%20bool%20judge%28%29%5Cn%20%20%20%20%7B%5Cn%20%20%20%20%20%20%20%20%5C%2F%2A%5Cn%20%20%20%20%20%20%20%20for%20%28int%20i%20%3D%200%3B%20i%20%3C%20n%3B%20i%2B%2B%29%5Cn%20%20%20%20%20%20%20%20for%20%28int%20j%20%3D%200%3B%20j%20%3C%20n%3B%20j%2B%2B%29%5Cn%20%20%20%20%20%20%20%20%20%20%20%20if%20%28judge%28i%2C%20j%29%29%20return%20true%3B%5Cn%20%20%20%20%20%20%20%20return%20false%3B%5Cn%20%20%20%20%20%20%20%20%2A%5C%2F%5Cn%20%20%20%20%20%20%20%20int%20%26a%20%3D%20x%3B%5Cn%20%20%20%20%20%20%20%20int%20%26b%20%3D%20y%3B%5Cn%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20return%20%5Cn%20%20%20%20%20%20%20%20%20%20%20%20judgeCastle%28a%2C%20b%2C%20CASTLE%29%20%7C%7C%5Cn%20%20%20%20%20%20%20%20%20%20%20%20judgeKnight%28a%2C%20b%2C%20KNIGHT%29%20%7C%7C%5Cn%20%20%20%20%20%20%20%20%20%20%20%20judgeBishop%28a%2C%20b%2C%20BISHOP%29%20%7C%7C%5Cn%20%20%20%20%20%20%20%20%20%20%20%20judgeQueen%28a%2C%20b%2C%20QUEEN%29%20%7C%7C%5Cn%20%20%20%20%20%20%20%20%20%20%20%20judgeKing%28a%2C%20b%2C%20KING%29%20%7C%7C%5Cn%20%20%20%20%20%20%20%20%20%20%20%20judgePawn%28a%2C%20b%2C%20PAWN%29%3B%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20inline%20int%20step%28int%20d%29%5Cn%20%20%20%20%7B%5Cn%20%20%20%20%20%20%20%20map%5Bx%5D%5By%5D%20%3D%20EMPTY%3B%5Cn%20%20%20%20%5Cn%20%20%20%20%20%20%20%20x%20%2B%3D%20dx%5Bd%5D%3B%5Cn%20%20%20%20%20%20%20%20y%20%2B%3D%20dy%5Bd%5D%3B%5Cn%20%20%20%20%20%20%20%20dist%2B%2B%3B%5Cn%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20if%20%28x%20%3C%200%20%7C%7C%20x%20%3E%3D%20n%20%7C%7C%20y%20%3C%200%20%7C%7C%20y%20%3E%3D%20n%29%5Cn%20%20%20%20%20%20%20%20%20%20%20%20return%20-1%3B%5Cn%20%20%20%20%20%20%20%20if%20%28map%5Bx%5D%5By%5D%20%3D%3D%20KING%29%5Cn%20%20%20%20%20%20%20%20%20%20%20%20return%201%3B%5Cn%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20map%5Bx%5D%5By%5D%20%3D%20HERO%3B%5Cn%20%20%20%20%20%20%20%20return%20judge%28%29%20%3F%20-1%20%3A%20%28calcHash%28%29%2C%200%29%3B%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20inline%20bool%20operator%20%3C%28const%20Status%20%26b%29%20const%5Cn%20%20%20%20%7B%5Cn%20%20%20%20%20%20%20%20for%20%28int%20i%20%3D%200%3B%20i%20%3C%20n%3B%20i%2B%2B%29%5Cn%20%20%20%20%20%20%20%20for%20%28int%20j%20%3D%200%3B%20j%20%3C%20n%3B%20j%2B%2B%29%5Cn%20%20%20%20%20%20%20%20%20%20%20%20if%20%28map%5Bi%5D%5Bj%5D%20%21%3D%20b.map%5Bi%5D%5Bj%5D%29%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20map%5Bi%5D%5Bj%5D%20%3C%20b.map%5Bi%5D%5Bj%5D%3B%5Cn%20%20%20%20%20%20%20%20return%20false%3B%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20inline%20bool%20operator%20%3D%3D%20%28const%20Status%20%26s%29%20const%5Cn%20%20%20%20%7B%5Cn%20%20%20%20%20%20%20%20return%20hashVal%20%3D%3D%20s.hashVal%3B%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20inline%20void%20calcHash%28%29%5Cn%20%20%20%20%7B%5Cn%20%20%20%20%20%20%20%20long%20long%20tmp%20%3D%200%3B%5Cn%20%20%20%20%20%20%20%20for%20%28int%20i%20%3D%200%3B%20i%20%3C%20n%3B%20i%2B%2B%29%5Cn%20%20%20%20%20%20%20%20for%20%28int%20j%20%3D%200%3B%20j%20%3C%20n%3B%20j%2B%2B%29%5Cn%20%20%20%20%20%20%20%20%20%20%20%20tmp%20%3D%20%28tmp%20%2A%20seed1%20%2B%20map%5Bi%5D%5Bj%5D%29%20%25%20mod1%3B%5Cn%20%20%20%20%20%20%20%20%5C%2F%2A%5Cn%20%20%20%20%20%20%20%20long%20long%20tmp2%20%3D%200%3B%5Cn%20%20%20%20%20%20%20%20for%20%28int%20i%20%3D%200%3B%20i%20%3C%20n%3B%20i%2B%2B%29%5Cn%20%20%20%20%20%20%20%20for%20%28int%20j%20%3D%200%3B%20j%20%3C%20n%3B%20j%2B%2B%29%5Cn%20%20%20%20%20%20%20%20%20%20%20%20tmp2%20%3D%20%28tmp2%20%2A%20seed2%20%2B%20map%5Bi%5D%5Bj%5D%29%20%25%20mod2%3B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20hashVal%20%3D%20%28tmp%20%3C%3C%2032%29%20%7C%20tmp2%3B%5Cn%20%20%20%20%20%20%20%20%2A%5C%2F%5Cn%20%20%20%20%20%20%20%20hashVal%20%3D%20tmp%3B%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20inline%20void%20show%28%29%5Cn%20%20%20%20%7B%5Cn%20%20%20%20%20%20%20%20printf%28%5C%22%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%5C%5Cn%5C%22%29%3B%5Cn%20%20%20%20%20%20%20%20for%20%28int%20i%20%3D%200%3B%20i%20%3C%20n%3B%20i%2B%2B%29%5Cn%20%20%20%20%20%20%20%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20for%20%28int%20j%20%3D%200%3B%20j%20%3C%20n%3B%20j%2B%2B%29%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20putchar%28%270%27%20%2B%20map%5Bi%5D%5Bj%5D%29%3B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20%20%20putchar%28%27%5C%5Cn%27%29%3B%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20printf%28%5C%22%25lld%5C%5Cn%5C%22%2C%20hashVal%29%3B%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%7D%20init%2C%20cur%2C%20next%3B%5Cn%5Cnnamespace%20std%20%20%20%5Cn%7B%20%20%5Cn%20%20%20%20template%20%3C%3E%20%20%5Cn%20%20%20%20struct%20hash%3CStatus%3E%5Cn%20%20%20%20%7B%20%20%5Cn%20%20%20%20%20%20%20%20std%3A%3Asize_t%20operator%28%29%28const%20Status%20%26s%29%20const%20%20%5Cn%20%20%20%20%20%20%20%20%7B%20%20%5Cn%20%20%20%20%20%20%20%20%20%20%20%20using%20std%3A%3Asize_t%3B%20%20%5Cn%20%20%20%20%20%20%20%20%20%20%20%20using%20std%3A%3Ahash%3B%20%20%5Cn%20%20%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%5C%2F%5C%2F%20Compute%20individual%20hash%20values%20for%20first%2C%20%20%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%5C%2F%5C%2F%20second%20and%20third%20and%20combine%20them%20using%20XOR%20%20%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%5C%2F%5C%2F%20and%20bit%20shifting%3A%20%20%5Cn%20%20%5Cn%20%20%20%20%20%20%20%20%20%20%20%20return%20hash%3Clong%20long%3E%28%29%28s.hashVal%29%3B%5Cn%20%20%20%20%20%20%20%20%7D%20%20%5Cn%20%20%20%20%7D%3B%20%20%5Cn%7D%5Cnstd%3A%3Aqueue%3CStatus%3E%20q%3B%5Cnstd%3A%3Aunordered_map%3CStatus%2C%20bool%3E%20vis%3B%5Cn%5C%2F%5C%2Fstd%3A%3Amap%3CStatus%2C%20bool%3E%20vis%3B%5Cn%5Cnint%20val%3B%5Cn%5Cnint%20main%28%29%5Cn%7B%5Cn%20%20%20%20while%20%28init.read%28%29%29%5Cn%20%20%20%20%7B%5Cn%20%20%20%20%5Cn%20%20%20%20%20%20%20%20if%20%28init.judge%28%29%29%5Cn%20%20%20%20%20%20%20%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20printf%28%5C%22-1%5C%5Cn%5C%22%29%3B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20continue%3B%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20vis.clear%28%29%3B%5Cn%20%20%20%20%20%20%20%20while%28%21q.empty%28%29%29%5Cn%20%20%20%20%20%20%20%20%20%20%20%20q.pop%28%29%3B%5Cn%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20q.push%28init%29%3B%5Cn%20%20%20%20%20%20%20%20vis%5Binit%5D%20%3D%20true%3B%5Cn%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20int%20cnt%20%3D%200%3B%5Cn%20%20%20%20%20%20%20%20while%28%21q.empty%28%29%29%5Cn%20%20%20%20%20%20%20%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20cur%20%3D%20q.front%28%29%3B%20q.pop%28%29%3B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20%20%20%20%20for%20%28int%20i%20%3D%200%3B%20i%20%3C%208%3B%20i%2B%2B%29%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20next%20%3D%20cur%3B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20val%20%3D%20next.step%28i%29%3B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5C%2F%5C%2Fprintf%28%5C%22%25d%2C%20%5C%22%2C%20val%29%3B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28val%20%3D%3D%201%29%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%3B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%20if%20%28%21val%20%26%26%20%21vis%5Bnext%5D%29%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20vis%5Bnext%5D%20%3D%20true%3B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20q.push%28next%29%3B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20%20%20cnt%2B%2B%3B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20%20%20%20%20if%20%28val%20%3D%3D%201%29%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%3B%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20if%20%28val%20%3D%3D%201%29%5Cn%20%20%20%20%20%20%20%20%20%20%20%20printf%28%5C%22%25d%5C%5Cn%5C%22%2C%20next.dist%29%3B%5Cn%20%20%20%20%20%20%20%20else%5Cn%20%20%20%20%20%20%20%20%20%20%20%20printf%28%5C%22-1%5C%5Cn%5C%22%29%3B%5Cn%20%20%20%20%7D%5Cn%5Cn%20%20%20%20return%200%3B%5Cn%7D%22%2C%22tags%22%3A%5B81%2C108%2C126%2C151%2C244%2C319%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A1514%2C%22totalAccepted%22%3A151%2C%22pid%22%3A%22P3930%22%2C%22title%22%3A%22SAC%20E%231%20-%20%5Cu4e00%5Cu9053%5Cu5927%5Cu6c34%5Cu9898%20Knight%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22P%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A134273%2C%22title%22%3A%22%5Cu9898%5Cu76ee%5Cu6570%5Cu636e%5Cu8303%5Cu56f4%5Cu6709%5Cu8bef%22%2C%22forum%22%3A%7B%22id%22%3A6558%2C%22name%22%3A%22P3930%20SAC%20E%231%20-%20%5Cu4e00%5Cu9053%5Cu5927%5Cu6c34%5Cu9898%20Knight%22%2C%22slug%22%3A%22P3930%22%7D%7D%2C%7B%22id%22%3A24185%2C%22title%22%3A%22%5Cu9898%5Cu89e3%5Cu6709%5Cu8bef%22%2C%22forum%22%3A%7B%22id%22%3A6558%2C%22name%22%3A%22P3930%20SAC%20E%231%20-%20%5Cu4e00%5Cu9053%5Cu5927%5Cu6c34%5Cu9898%20Knight%22%2C%22slug%22%3A%22P3930%22%7D%7D%2C%7B%22id%22%3A24074%2C%22title%22%3A%22%5Cu65b0%5Cu4eba%5Cu6c42%5Cu52a9%5Cuff0c%5Cu4e00%5Cu9053%5Cu5927%5Cu6c34%5Cu9898%5Cuff0c%5Cu672c%5Cu673aWA%5Cu63d0%5Cu4ea4AC%22%2C%22forum%22%3A%7B%22id%22%3A6558%2C%22name%22%3A%22P3930%20SAC%20E%231%20-%20%5Cu4e00%5Cu9053%5Cu5927%5Cu6c34%5Cu9898%20Knight%22%2C%22slug%22%3A%22P3930%22%7D%7D%2C%7B%22id%22%3A24015%2C%22title%22%3A%22%5Cu6570%5Cu636e%5Cu771f%5Cu7684%5Cu6709%5Cu5751%22%2C%22forum%22%3A%7B%22id%22%3A6558%2C%22name%22%3A%22P3930%20SAC%20E%231%20-%20%5Cu4e00%5Cu9053%5Cu5927%5Cu6c34%5Cu9898%20Knight%22%2C%22slug%22%3A%22P3930%22%7D%7D%2C%7B%22id%22%3A24006%2C%22title%22%3A%22%5Cu8bf7%5Cu95ee%5Cu6570%5Cu636e4%5Cu662f%5Cu4ec0%5Cu4e48%5Cuff0cWA%5Cu4e86%5Cu597d%5Cu4e45%5Cu4e86%22%2C%22forum%22%3A%7B%22id%22%3A6558%2C%22name%22%3A%22P3930%20SAC%20E%231%20-%20%5Cu4e00%5Cu9053%5Cu5927%5Cu6c34%5Cu9898%20Knight%22%2C%22slug%22%3A%22P3930%22%7D%7D%2C%7B%22id%22%3A24000%2C%22title%22%3A%22%5Cu6807%5Cu7a0b%5Cu597d%5Cu50cf%5Cu771f%5Cu7684%5Cu6709%5Cu95ee%5Cu9898%5Cu554a%5Cu3002%5Cu3002%22%2C%22forum%22%3A%7B%22id%22%3A6558%2C%22name%22%3A%22P3930%20SAC%20E%231%20-%20%5Cu4e00%5Cu9053%5Cu5927%5Cu6c34%5Cu9898%20Knight%22%2C%22slug%22%3A%22P3930%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P2602%22%2C%22title%22%3A%22%5BZJOI2010%5D%5Cu6570%5Cu5b57%5Cu8ba1%5Cu6570%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P2900%22%2C%22title%22%3A%22%5BUSACO08MAR%5D%5Cu571f%5Cu5730%5Cu5f81%5Cu7528Land%20Acquisition%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P3250%22%2C%22title%22%3A%22%5BHNOI2016%5D%5Cu7f51%5Cu7edc%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P3810%22%2C%22title%22%3A%22%5Cu3010%5Cu6a21%5Cu677f%5Cu3011%5Cu4e09%5Cu7ef4%5Cu504f%5Cu5e8f%5Cuff08%5Cu964c%5Cu4e0a%5Cu82b1%5Cu5f00%5Cuff09%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P3932%22%2C%22title%22%3A%22%5Cu6d6e%5Cu6e38%5Cu5927%5Cu9646%5Cu768468%5Cu53f7%5Cu5c9b%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22P%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22SAC%20E%231%20-%20%5Cu4e00%5Cu9053%5Cu5927%5Cu6c34%5Cu9898%20Knight%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573286098;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>SAC E#1 - 一道大水题 Knight</h1>
<h2>题目背景</h2>
<div>毒奶色和F91是好朋友。
</div>
<h2>题目描述</h2>
<div>他们经常在一起玩一个游戏，不，不是星际争霸，是国际象棋。
毒奶色觉得F91是一只鸡。他在一个n×n的棋盘上用黑色的城堡（车）、骑士（马）、主教（象）、皇后（副）、国王（帅）、士兵（卒）摆了一个阵。
然而F91觉得毒奶色是一只鸡。他发起了挑战：他要操纵一个白色骑士，不经过任何一个棋子的攻击范围（F91可以连续行动，而毒奶色的棋子不会动，除非白骑士进入了对方的攻击范围），并击杀毒奶色的国王（即进入黑国王所在的位置）。
请告诉F91他最少需要多少步骤来完成这一项壮举。
注意：
1.当F91的白骑士走到毒奶色的棋子所在的格子上的时候，会击杀（吃掉）该棋子。这个棋子也就不再对F91的白骑士有威胁了。
2.如果白骑士开场就在黑子的攻击范围内，则立刻被击杀、F91立刻失败。
3.即使白骑士在攻击王的瞬间进入了其他棋子攻击范围（即其他棋子“看护”着王所在的格子），依然算F91获胜。
攻击范围：
城堡：横、竖方向所有位置，直到被一个其他棋子阻拦。
```cpp
..#..
..#..
##C##
..#..
..#..
```
骑士：横2竖1或者横1竖2的所有位置（最多8个，类似日字）。
```cpp
.#.#.
#...#
..K..
#...#
.#.#.
```
主教：斜向（45°）所有位置，直到被一个其他棋子阻拦。
```cpp
#...#
.#.#.
..B..
.#.#.
#...#
```
皇后：城堡和主教的结合体（既能横/竖向攻击，也能45°角斜向攻击，直到被其他棋子阻挡）。
```cpp
#.#.#
.###.
##Q##
.###.
#.#.#
```
国王：身边8连通位置的8个格子。
```cpp
.....
.###.
.#X#.
.###.
.....
```
士兵：左下方/右下方（45°）的格子（最多2个）。
`````
.....
.....
..P..
.#.#.
.....
```
其中字母表示棋子类型，参考输入格式。
‘#’表示可攻击范围。
</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>输入包含多组数据。
每一组数据中，第一行一个整数n表示棋盘规模。
接下来n行，每行一个长度为n的字符串。描述棋盘的格局。
其中：
.表示空
O表示白骑士
C表示黑城堡
K表示黑骑士
B表示黑主教
Q表示黒皇后
X表示黑国王
P表示黑士兵
</div>
<h3>输出格式</h3>
<br />
<div>对于每一个测试数据，每行输出一个整数，表示F91的最小步数。
如果无论F91如何行动也无法击杀黑国王，输出-1。
</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>8
...X....
........
........
........
........
........
........
......O.</code></pre>
<h3>输出样例 #1</h3>
<pre><code>4</code></pre>
<h3>输入样例 #2</h3>
<pre><code>8
......X.
........
.O......
...P.Q.C
.....B..
........
...K....
........</code></pre>
<h3>输出样例 #2</h3>
<pre><code>7</code></pre>
<h2>说明</h2>
<div>**输入最多包含5组数据。**
对于20%的数据，毒奶色只有国王。n <= 8。
对于30%的数据，毒奶色只有国王、骑士。n <= 8。
对于60%的数据，毒奶色只有国王、骑士、王后。n <= 50。
对于100%的数据，毒奶色可以有全套16颗棋子（2城堡，2骑士，2主教，1后，1王，8兵）。n <= 50。
温馨提示：
时间限制可能比想象之中还要更紧一点，请注意实现细节以保证性能。
样例2解释：
一种可行的做法是：
```cpp
......X.
.3..6...
.O5.....
4.2P.Q.C
1....B..
........
...K....
........
```</div>
</article>
</div>
</div>
</body>
</html>
