<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>[Celeste-A]Black Moonrise - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573382827:oUdYY4EY0nRL4kFdOGqD6B+RRwqn2LtNe6uIZmIbCrQ=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%3E%20%5Cu5e7d%5Cu7075%5Cn%3E%5Cn%3E%20%5Cu4e0d%5Cu5c5e%5Cu4e8e%5Cu8fd9%5Cu4e2a%5Cu4e16%5Cu754c%5Cn%3E%20%5Cn%3E%5Cu4f46%5Cu56e0%5Cu8fd9%5Cu4e2a%5Cu4e16%5Cu754c%5Cu800c%5Cu8bde%5Cu751f%5Cn%3E%5Cn%3E%5Cu6f5c%5Cu85cf%5Cu5728%5Cu79e9%5Cu5e8f%5Cu4e4b%5Cu5916%5Cn%3E%5Cn%3E%24%24%5Cn%3E%5Cn%3E%20%5Cu9192%5Cu6765%5Cu5427%5Cuff0c%5Cu6211%5Cu7684%5Cu5fc3%5Cu662f%5Cu5821%5Cu5792%5Cn%3E%5Cn%3E%5Cu5728%5Cu68a6%5Cu4e2d%5Cu6211%5Cu6613%5Cu53d7%5Cu4f24%5Cu5bb3%22%2C%22description%22%3A%22%5Cu5728%20Madeline%20%5Cu7684%5Cu68a6%5Cu5883%5Cu4e2d%5Cuff0c%5Cu57ce%5Cu5e02%5Cu7684%5Cu8fb9%5Cu5883%5Cu662f%5Cu7531%5Cu5927%5Cu5927%5Cu5c0f%5Cu5c0f%5Cu7684%5Cu5b87%5Cu5b99%5Cu788e%5Cu7247%5Cu6784%5Cu6210%5Cu7684%5Cn%5Cn%5Cu6bcf%5Cu4e2a%5Cu5b87%5Cu5b99%5Cu788e%5Cu7247%5Cu90fd%5Cu6709%5Cu4e00%5Cu5b9a%5Cu7684%5Cu80fd%5Cu91cf%5Cu503c%5Cuff0c%5Cu7531%5Cu4e8e%5Cu788e%5Cu7247%5Cu7684%5Cu5927%5Cu5c0f%5Cu6709%5Cu4e00%5Cu5b9a%5Cu7684%5Cu5dee%5Cu5f02%5Cuff0c%5Cu56e0%5Cu6b64%5Cu5b83%5Cu4eec%5Cu7684%5Cu80fd%5Cu91cf%5Cu503c%5Cu4e5f%5Cu6709%5Cu5927%5Cu6709%5Cu5c0f%5Cn%5CnMadeline%20%5Cu5f88%5Cu4eab%5Cu53d7%5Cu5728%5Cu788e%5Cu7247%5Cu4e4b%5Cu95f4%5Cu7a7f%5Cu68ad%5Cuff0c%5Cu5979%5Cu6bcf%5Cu6b21%5Cu90fd%5Cu4f1a%5Cu9009%5Cu62e9%5Cu4e24%5Cu4e2a%5Cu5b87%5Cu5b99%5Cu788e%5Cu7247%5Cuff0c%5Cu5e76%5Cu83b7%5Cu5f97%5Cu5b83%5Cu4eec%5Cu80fd%5Cu91cf%5Cu503c%5Cu7684%5Cu6700%5Cu5927%5Cu516c%5Cu7ea6%5Cu6570%5Cu7684%5Cu6109%5Cu60a6%5Cu503c%5Cu3002%5Cu6ce8%5Cu610f%5Cu8fd9%5Cu4e24%5Cu4e2a%5Cu5b87%5Cu5b99%5Cu788e%5Cu7247%5Cu53ef%5Cu4ee5%5Cu76f8%5Cu540c%5Cn%5Cn%5Cu5b87%5Cu5b99%5Cu788e%5Cu7247%5Cu6784%5Cu6210%5Cu4e86%5Cu4e00%5Cu6bb5%5Cu5e8f%5Cu5217%24a_1%2Ca_2%2C%5C%5Ccdots%2Ca_n%24%5Cuff0c%5Cu6bcf%5Cu6b21%20Madeline%20%5Cu90fd%5Cu4f1a%5Cu9009%5Cu62e9%5Cu5b83%5Cu7684%5Cu4e00%5Cu4e2a%5Cu533a%5Cu95f4%5Cuff0c%5Cu5bf9%5Cu4e8e%5Cu8fd9%5Cu4e2a%5Cu533a%5Cu95f4%5Cu91cc%5Cu9762%5Cu7684%5Cu4efb%5Cu610f%5Cu4e24%5Cu4e2a%5Cu5b87%5Cu5b99%5Cu788e%5Cu7247%24%28u%2Cv%29%24%5Cuff0c%5Cu5979%5Cu90fd%5Cu4f1a%5Cu8fdb%5Cu884c%5Cu4e00%5Cu6b21%5Cu7a7f%5Cu68ad%5Cu3002%5Cu6ce8%5Cu610f%5Cu8fd9%5Cu91cc%5Cu7684%24%28u%2Cv%29%24%5Cu662f%5Cu6709%5Cu5e8f%5Cu5bf9%5Cn%5Cn%5Cu5f62%5Cu5f0f%5Cu5316%5Cu5730%5Cuff0cMadeline%20%5Cu6bcf%5Cu6b21%5Cu83b7%5Cu5f97%5Cu7684%5Cu6109%5Cu60a6%5Cu503c%5Cu4e3a%5Cn%5Cn%24%24%5C%5Csum_%7Bi%3Dl%7D%5Er%5C%5Csum_%7Bj%3Dl%7D%5Er%20%5C%5Cgcd%28a_i%2Ca_j%29%24%24%5Cn%5Cn%5Cu5f53%20Madeline%20%5Cu4ece%5Cu5979%5Cu7684%5Cu68a6%5Cu4e2d%5Cu88ab%5Cu5524%5Cu9192%5Cu65f6%5Cuff0c%5Cu5979%5Cu53d1%5Cu73b0%5Cu6240%5Cu6709%5Cu7684%5Cu5b87%5Cu5b99%5Cu788e%5Cu7247%5Cu90fd%5Cu6d88%5Cu5931%5Cu4e86%5Cu3002%5Cu5979%5Cu4e0d%5Cu8bb0%5Cu5f97%5Cu5728%5Cu68a6%5Cu4e2d%5Cu6bcf%5Cu6b21%5Cu7a7f%5Cu68ad%5Cu65f6%5Cu83b7%5Cu5f97%5Cu7684%5Cu6109%5Cu60a6%5Cu503c%5Cu662f%5Cu591a%5Cu5c11%5Cuff0c%5Cu53ea%5Cu4f9d%5Cu7a00%5Cu8bb0%5Cu5f97%5Cu5979%5Cu9009%5Cu62e9%5Cu7684%5Cu533a%5Cu95f4%5Cu4e86%5Cu3002%5Cn%5Cn%5Cu4e8e%5Cu662f%5Cu5979%5Cu627e%5Cu5230%5Cu4e86%5Cu4f60%5Cu2014%5Cu2014%5Cu4e00%5Cu4e2a%5Cu4fe1%5Cu606f%5Cu5b66%5Cu5927%5Cu4f6c%5Cuff0c%5Cu8bf7%5Cu4f60%5Cu6839%5Cu636e%5Cu5979%5Cu6bcf%5Cu6b21%5Cu9009%5Cu62e9%5Cu7684%5Cu533a%5Cu95f4%5Cuff0c%5Cu8fd8%5Cu539f%5Cu5979%5Cu5f53%5Cu65f6%5Cu7684%5Cu6109%5Cu60a6%5Cu503c%5Cn%22%2C%22inputFormat%22%3A%22%5Cu7b2c%5Cu4e00%5Cu884c%5Cu4e24%5Cu4e2a%5Cu6b63%5Cu6574%5Cu6570%24n%2Cq%24%5Cuff0c%5Cu5206%5Cu522b%5Cu8868%5Cu793a%5Cu788e%5Cu7247%5Cu4e2a%5Cu6570%5Cu4ee5%5Cu53ca%5Cu8be2%5Cu95ee%5Cu6570%5Cn%5Cn%5Cu7b2c%5Cu4e8c%5Cu884c%5Cu6709%24n%24%5Cu4e2a%5Cu6b63%5Cu6574%5Cu6570%24a_1%2Ca_2%2C%5C%5Ccdots%2Ca_n%24%5Cuff0c%5Cu8868%5Cu793a%5Cu6bcf%5Cu4e2a%5Cu788e%5Cu7247%5Cu7684%5Cu80fd%5Cu91cf%5Cu503c%5Cn%5Cn%5Cu63a5%5Cu4e0b%5Cu6765%24q%24%5Cu884c%5Cuff0c%5Cu6bcf%5Cu884c%5Cu4e24%5Cu4e2a%5Cu6574%5Cu6570%24l_i%2Cr_i%24%5Cuff0c%5Cu8868%5Cu793a%5Cu7b2c%24i%24%5Cu6b21%5Cu8be2%5Cu95ee%20Madeline%20%5Cu9009%5Cu62e9%5Cu7684%5Cu533a%5Cu95f4%22%2C%22outputFormat%22%3A%22%5Cu5bf9%5Cu4e8e%5Cu6bcf%5Cu4e2a%5Cu8be2%5Cu95ee%5Cu8f93%5Cu51fa%5Cu4e00%5Cu884c%5Cuff0c%5Cu8868%5Cu793a%5Cu5728%5Cu8fd9%5Cu6b21%5Cu8be2%5Cu95ee%5Cu4e2d%5Cuff0cMadeline%20%5Cu83b7%5Cu5f97%5Cu7684%5Cu6109%5Cu60a6%5Cu503c%5Cu7684%5Cu603b%5Cu548c%22%2C%22samples%22%3A%5B%5B%225%202%5Cn1%202%203%204%205%5Cn1%202%5Cn2%203%22%2C%225%5Cn7%22%5D%5D%2C%22hint%22%3A%22%5Cu5bf9%5Cu4e8e%2410%5C%5C%25%24%5Cu7684%5Cu6570%5Cu636e%5Cuff0c%5Cu6ee1%5Cu8db3%24n%2Cq%5C%5Cleq%20200%24%5Cn%5Cn%5Cu5bf9%5Cu4e8e%2420%5C%5C%25%24%5Cu7684%5Cu6570%5Cu636e%5Cuff0c%5Cu6ee1%5Cu8db3%24n%2Cq%5C%5Cleq%202250%24%5Cn%5Cn%5Cu5bf9%5Cu4e8e%2440%5C%5C%25%24%5Cu7684%5Cu6570%5Cu636e%5Cuff0c%5Cu6ee1%5Cu8db3%24n%2Cq%5C%5Cleq%204000%24%5Cn%5Cn%5Cu5bf9%5Cu4e8e%24100%5C%5C%25%24%5Cu7684%5Cu6570%5Cu636e%5Cuff0c%5Cu6ee1%5Cu8db3%24n%2Cq%2Ca_i%5C%5Cleq%2010%5E5%24%5Cn%5Cn%2A%2A%5Cu4fdd%5Cu8bc1%5Cu6570%5Cu5217%5Cu548c%5Cu8be2%5Cu95ee%5Cu5747%5Cu4e3a%5Cu968f%5Cu673a%5Cu751f%5Cu6210%2A%2A%22%2C%22provider%22%3A%7B%22uid%22%3A39914%2C%22name%22%3A%22An_Account%22%2C%22slogan%22%3A%22%5Cu7ec3%5Cu4e60%5Cu65f6%5Cu957f%5Cu4e24%5Cu5e74%5Cu534a%5Cu7684%5Cu4e2a%5Cu4eba%5Cu7ec3%5Cu4e60%5Cu751f%22%2C%22badge%22%3Anull%2C%22isAdmin%22%3Afalse%2C%22color%22%3A%22Red%22%2C%22ccfLevel%22%3A9%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%5D%2C%22memory%22%3A%5B128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%5D%7D%2C%22stdCode%22%3A%22%5C%2F%5C%2F%20luogu-judger-enable-o2%5Cn%5C%2F%2A%2A%2A%2A%2A%2A%2A%2A%2A%2A%2A%2A%2A%2A%2A%2A%2A%2A%2A%2A%2A%2A%2A%2A%2A%2A%2A%2A%2A%2A%2A%2A%2A%2A%5Cn%20%2A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2A%5Cn%20%2A%20%20%20%20%20%20Alone%20with%20you.%20%20%20%20%20%20%20%20%20%20%20%2A%5Cn%20%2A%20%20%20%20%20%20For%20D%26M%21%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2A%5Cn%20%2A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2A%5Cn%20%2A%20%20%20%20%20%20--%20Herobrine%20CZM%2C%20%20%20%20%20%20%20%20%20%2A%5Cn%20%2A%20%20%20%20%20%20%20%20%20the%20Internal%20Unreality%20%2A%5Cn%20%2A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2A%5Cn%20%2A%2A%2A%2A%2A%2A%2A%2A%2A%2A%2A%2A%2A%2A%2A%2A%2A%2A%2A%2A%2A%2A%2A%2A%2A%2A%2A%2A%2A%2A%2A%2A%2A%2A%5C%2F%5Cn%5C%2F%5C%2F--------------HEADS----------------%5C%2F%5C%2F%5Cn%23include%20%3Ccstdio%3E%5Cn%23include%20%3Ccstring%3E%5Cn%23include%20%3Calgorithm%3E%5Cn%23include%20%3Ccmath%3E%5Cn%23include%20%3Ccstdlib%3E%5Cn%23include%20%3Cqueue%3E%5Cn%23include%20%3Cvector%3E%5Cn%23include%20%3Cstack%3E%5Cn%23include%20%3Cstring%3E%5Cn%23include%20%3Cmap%3E%5Cn%23include%20%3Cset%3E%5Cnusing%20namespace%20std%3B%5Cn%5C%2F%5C%2F------------CONSTANTS--------------%5C%2F%5C%2F%5Cnconst%20int%20INF%20%3D%200x7fffffff%2CSINF%20%3D%200x3f3f3f3f%3Bconst%20double%20PI%20%3D%203.141592653589793%3Bconst%20long%20long%20LINF%20%3D%200x7fffffffffffffffLL%2CSLINF%20%3D%200x3f3f3f3f3f3f3f3fLL%3B%5Cn%5C%2F%5C%2F--------------LAZY-----------------%5C%2F%5C%2F%5Cntypedef%20long%20long%20LL%3Btypedef%20pair%3Cint%2Cint%3E%20PII%3Btypedef%20unsigned%20long%20long%20ULL%3Btypedef%20long%20double%20LD%3B%5Cn%23define%20MP%28x%2Cy%29%20make_pair%28x%2Cy%29%5Cn%23define%20PB%28x%29%20push_back%28x%29%5Cn%23define%20OPEN%28x%29%20freopen%28x%5C%22.in%5C%22%2C%5C%22r%5C%22%2Cstdin%29%2Cfreopen%28x%5C%22.out%5C%22%2C%5C%22w%5C%22%2Cstdout%29%5Cn%5C%2F%5C%2F-------------FAST%20IO---------------%5C%2F%5C%2F%5Cn%23define%20RD%20%28read%28%29%2C_v%29%5Cn%23define%20RDL%20%28read_ll%28%29%2C_l%29%5Cn%23define%20EF%20%28%21~_f%29%5Cnint%20_v%2C_f%2C_c%3BLL%20_l%3B%5Cnvoid%20read%28%29%7B_c%20%3D%20getchar%28%29%2C_v%20%3D%20_f%20%3D%200%3Bwhile%28_c%20%3C%20%270%27%20%7C%7C%20_c%20%3E%20%279%27%29%7Bif%28_c%20%3D%3D%20-1%29%7B_f%20%3D%20-1%3Breturn%3B%7Delse%20if%28_c%20%3D%3D%20%27-%27%29%7B_f%20%3D%201%3B%7D_c%20%3D%20getchar%28%29%3B%7Dwhile%28_c%20%3C%3D%20%279%27%20%26%26%20_c%20%3E%3D%20%270%27%29%7B_v%20%3D%20%28_v%20%3C%3C%203%29%20%2B%20%28_v%20%3C%3C%201%29%20%2B%20%28_c%20%5E%2048%29%3B_c%20%3D%20getchar%28%29%3B%7Dif%28_f%29%7B_v%20%3D%20-_v%3B%7D%7D%5Cnvoid%20read_ll%28%29%7B_c%20%3D%20getchar%28%29%2C_l%20%3D%20_f%20%3D%200%3Bwhile%28_c%20%3C%20%270%27%20%7C%7C%20_c%20%3E%20%279%27%29%7Bif%28_c%20%3D%3D%20-1%29%7B_f%20%3D%20-1%3Breturn%3B%7Delse%20if%28_c%20%3D%3D%20%27-%27%29%7B_f%20%3D%201%3B%7D_c%20%3D%20getchar%28%29%3B%7Dwhile%28_c%20%3C%3D%20%279%27%20%26%26%20_c%20%3E%3D%20%270%27%29%7B_l%20%3D%20%28_l%20%3C%3C%203%29%20%2B%20%28_l%20%3C%3C%201%29%20%2B%20%28_c%20%5E%2048%29%3B_c%20%3D%20getchar%28%29%3B%7Dif%28_f%29%7B_l%20%3D%20-_l%3B%7D%7D%5Cn%5C%2F%5C%2F-------------MODIFIERS-------------%5C%2F%5C%2F%5Cnconst%20int%20MAXN%20%3D%20100005%2CMAXM%20%3D%20100005%2CMAXK%20%3D%20100005%2CMOD%20%3D%201e9%2B7%3B%5Cnconst%20LD%20EPS%20%3D%201e-8%3B%5Cn%5C%2F%5C%2F-----END%20OF%20AUTO-GENERATED%20CODE----%5C%2F%5C%2F%5Cn%5Cnbool%20vis%5BMAXN%5D%3B%5Cnint%20pri%5BMAXN%5D%2Cprin%2Cmu%5BMAXN%5D%2Cf%5BMAXN%5D%3B%5Cnint%20divs%5BMAXN%5D%5B200%5D%2Cdivn%5BMAXN%5D%3B%5Cn%5Cnvoid%20pre%28%29%7B%5Cn%20%20%20%20mu%5B1%5D%20%3D%201%3B%5Cn%20%20%20%20for%28int%20i%20%3D%202%3Bi%20%3C%20MAXN%3Bi%2B%2B%29%7B%5Cn%20%20%20%20%20%20%20%20if%28%21vis%5Bi%5D%29%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20pri%5Bprin%2B%2B%5D%20%3D%20i%2Cmu%5Bi%5D%20%3D%20-1%3B%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20for%28int%20j%20%3D%200%3Bj%20%3C%20prin%20%26%26%20i%20%2A%20pri%5Bj%5D%20%3C%20MAXN%3Bj%2B%2B%29%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20vis%5Bi%20%2A%20pri%5Bj%5D%5D%20%3D%20true%3B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20if%28%21%28i%20%25%20pri%5Bj%5D%29%29%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%3B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20%20%20mu%5Bi%20%2A%20pri%5Bj%5D%5D%20%3D%20-mu%5Bi%5D%3B%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D%5Cn%20%20%20%20for%28int%20i%20%3D%201%3Bi%20%3C%20MAXN%3Bi%2B%2B%29%7B%5Cn%20%20%20%20%20%20%20%20for%28int%20j%20%3D%20i%3Bj%20%3C%20MAXN%3Bj%20%2B%3D%20i%29%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20f%5Bj%5D%20%2B%3D%20i%20%2A%20mu%5Bj%20%5C%2F%20i%5D%3B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20divs%5Bj%5D%5Bdivn%5Bj%5D%2B%2B%5D%20%3D%20i%3B%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D%5Cn%7D%5Cn%5Cnconst%20int%20SIZ%20%3D%20320%3B%5Cn%5Cnstruct%20Query%7B%5Cn%20%20%20%20int%20l%2Cr%2Cid%3B%5Cn%20%20%20%20bool%20operator%3C%28const%20Query%20%26%20e%29const%7B%5Cn%20%20%20%20%20%20%20%20return%20l%20%5C%2F%20SIZ%20%3C%20e.l%20%5C%2F%20SIZ%20%7C%7C%20%28l%20%5C%2F%20SIZ%20%3D%3D%20e.l%20%5C%2F%20SIZ%20%26%26%20%28%28%28l%20%5C%2F%20SIZ%29%20%26%201%29%20%3F%20r%20%3C%20e.r%20%3A%20r%20%3E%20e.r%29%29%3B%5Cn%20%20%20%20%7D%5Cn%7Dqu%5BMAXN%5D%3B%5Cn%5Cnint%20num%2Cqus%2Cval%5BMAXN%5D%3B%5Cn%5Cnint%20cur%5BMAXN%5D%3B%5CnLL%20nowans%2Cans%5BMAXN%5D%3B%5Cnint%20l%2Cr%3B%5Cn%5Cnvoid%20insert%28int%20v%29%7B%5Cn%20%20%20%20for%28int%20i%20%3D%200%3Bi%20%3C%20divn%5Bv%5D%3Bi%2B%2B%29%7B%5Cn%20%20%20%20%20%20%20%20nowans%20%2B%3D%20%28%28LL%29%28cur%5Bdivs%5Bv%5D%5Bi%5D%5D%20%2B%201%29%20%2A%20%28cur%5Bdivs%5Bv%5D%5Bi%5D%5D%20%2B%201%29%20-%20%28LL%29cur%5Bdivs%5Bv%5D%5Bi%5D%5D%20%2A%20cur%5Bdivs%5Bv%5D%5Bi%5D%5D%29%20%2A%20f%5Bdivs%5Bv%5D%5Bi%5D%5D%3B%5Cn%20%20%20%20%20%20%20%20cur%5Bdivs%5Bv%5D%5Bi%5D%5D%2B%2B%3B%5Cn%20%20%20%20%7D%5Cn%7D%5Cn%5Cnvoid%20remove%28int%20v%29%7B%5Cn%20%20%20%20for%28int%20i%20%3D%200%3Bi%20%3C%20divn%5Bv%5D%3Bi%2B%2B%29%7B%5Cn%20%20%20%20%20%20%20%20nowans%20%2B%3D%20%28%28LL%29%28cur%5Bdivs%5Bv%5D%5Bi%5D%5D%20-%201%29%20%2A%20%28cur%5Bdivs%5Bv%5D%5Bi%5D%5D%20-%201%29%20-%20%28LL%29cur%5Bdivs%5Bv%5D%5Bi%5D%5D%20%2A%20cur%5Bdivs%5Bv%5D%5Bi%5D%5D%29%20%2A%20f%5Bdivs%5Bv%5D%5Bi%5D%5D%3B%5Cn%20%20%20%20%20%20%20%20cur%5Bdivs%5Bv%5D%5Bi%5D%5D--%3B%5Cn%20%20%20%20%7D%5Cn%7D%5Cn%5Cnvoid%20mo_lsj_orz_tql%28%29%7B%5Cn%20%20%20%20sort%28qu%2Cqu%20%2B%20qus%29%3B%5Cn%20%20%20%20insert%28val%5B0%5D%29%3B%5Cn%20%20%20%20l%20%3D%200%2Cr%20%3D%200%3B%5Cn%20%20%20%20for%28int%20i%20%3D%200%3Bi%20%3C%20qus%3Bi%2B%2B%29%7B%5Cn%20%20%20%20%20%20%20%20while%28l%20%3C%20qu%5Bi%5D.l%29%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20remove%28val%5Bl%5D%29%2Cl%2B%2B%3B%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20while%28l%20%3E%20qu%5Bi%5D.l%29%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20l--%2Cinsert%28val%5Bl%5D%29%3B%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20while%28r%20%3C%20qu%5Bi%5D.r%29%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20r%2B%2B%2Cinsert%28val%5Br%5D%29%3B%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20while%28r%20%3E%20qu%5Bi%5D.r%29%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20remove%28val%5Br%5D%29%2Cr--%3B%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20ans%5Bqu%5Bi%5D.id%5D%20%3D%20nowans%3B%5Cn%20%20%20%20%7D%5Cn%7D%5Cn%5Cnint%20main%28%29%7B%5Cn%20%20%20%20pre%28%29%3B%5Cn%20%20%20%20num%20%3D%20RD%2Cqus%20%3D%20RD%3B%5Cn%20%20%20%20for%28int%20i%20%3D%200%3Bi%20%3C%20num%3Bi%2B%2B%29%7B%5Cn%20%20%20%20%20%20%20%20val%5Bi%5D%20%3D%20RD%3B%5Cn%20%20%20%20%7D%5Cn%20%20%20%20for%28int%20i%20%3D%200%3Bi%20%3C%20qus%3Bi%2B%2B%29%7B%5Cn%20%20%20%20%20%20%20%20qu%5Bi%5D.l%20%3D%20RD%20-%201%2Cqu%5Bi%5D.r%20%3D%20RD%20-%201%2Cqu%5Bi%5D.id%20%3D%20i%3B%5Cn%20%20%20%20%7D%5Cn%20%20%20%20mo_lsj_orz_tql%28%29%3B%5Cn%20%20%20%20for%28int%20i%20%3D%200%3Bi%20%3C%20qus%3Bi%2B%2B%29%7B%5Cn%20%20%20%20%20%20%20%20printf%28%5C%22%25lld%5C%5Cn%5C%22%2Cans%5Bi%5D%29%3B%5Cn%20%20%20%20%7D%5Cn%20%20%20%20return%200%3B%5Cn%7D%5Cn%22%2C%22tags%22%3A%5B108%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A354%2C%22totalAccepted%22%3A33%2C%22pid%22%3A%22P5624%22%2C%22title%22%3A%22%5BCeleste-A%5DBlack%20Moonrise%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P1912%22%2C%22title%22%3A%22%5BNOI2009%5D%5Cu8bd7%5Cu4eba%5Cu5c0fG%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P4074%22%2C%22title%22%3A%22%5BWC2013%5D%5Cu7cd6%5Cu679c%5Cu516c%5Cu56ed%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P5625%22%2C%22title%22%3A%22%5BCeleste-A%5DGood%20Karma%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P5368%22%2C%22title%22%3A%22%5BPKUSC2018%5D%5Cu771f%5Cu5b9e%5Cu6392%5Cu540d%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P5401%22%2C%22title%22%3A%22%5BCTS2019%5D%5Cu73cd%5Cu73e0%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22%5BCeleste-A%5DBlack%20Moonrise%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573286098;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>[Celeste-A]Black Moonrise</h1>
<h2>题目背景</h2>
<div>> 幽灵
>
> 不属于这个世界
>
>但因这个世界而诞生
>
>潜藏在秩序之外
>
>$$
>
> 醒来吧，我的心是堡垒
>
>在梦中我易受伤害</div>
<h2>题目描述</h2>
<div>在 Madeline 的梦境中，城市的边境是由大大小小的宇宙碎片构成的
每个宇宙碎片都有一定的能量值，由于碎片的大小有一定的差异，因此它们的能量值也有大有小
Madeline 很享受在碎片之间穿梭，她每次都会选择两个宇宙碎片，并获得它们能量值的最大公约数的愉悦值。注意这两个宇宙碎片可以相同
宇宙碎片构成了一段序列$a_1,a_2,\cdots,a_n$，每次 Madeline 都会选择它的一个区间，对于这个区间里面的任意两个宇宙碎片$(u,v)$，她都会进行一次穿梭。注意这里的$(u,v)$是有序对
形式化地，Madeline 每次获得的愉悦值为
$$\sum_{i=l}^r\sum_{j=l}^r \gcd(a_i,a_j)$$
当 Madeline 从她的梦中被唤醒时，她发现所有的宇宙碎片都消失了。她不记得在梦中每次穿梭时获得的愉悦值是多少，只依稀记得她选择的区间了。
于是她找到了你——一个信息学大佬，请你根据她每次选择的区间，还原她当时的愉悦值
</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>第一行两个正整数$n,q$，分别表示碎片个数以及询问数
第二行有$n$个正整数$a_1,a_2,\cdots,a_n$，表示每个碎片的能量值
接下来$q$行，每行两个整数$l_i,r_i$，表示第$i$次询问 Madeline 选择的区间</div>
<h3>输出格式</h3>
<br />
<div>对于每个询问输出一行，表示在这次询问中，Madeline 获得的愉悦值的总和</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>5 2
1 2 3 4 5
1 2
2 3</code></pre>
<h3>输出样例 #1</h3>
<pre><code>5
7</code></pre>
<h2>说明</h2>
<div>对于$10\%$的数据，满足$n,q\leq 200$
对于$20\%$的数据，满足$n,q\leq 2250$
对于$40\%$的数据，满足$n,q\leq 4000$
对于$100\%$的数据，满足$n,q,a_i\leq 10^5$
**保证数列和询问均为随机生成**</div>
</article>
</div>
</div>
</body>
</html>
