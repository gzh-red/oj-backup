<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>[POI2012]OKR-A Horrible Poem - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573377015:UlEEDlRP4GrKJ/3bBUDdFxvoYR8/29Jk9cYvjggh1ok=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%5Cu7b2c%5Cu4e00%5Cu884c%5Cu4e00%5Cu4e2a%5Cu6b63%5Cu6574%5Cu6570n%28n%5Cu2264500%20000%29%5Cuff0c%5Cu8868%5Cu793aS%5Cu7684%5Cu957f%5Cu5ea6%5Cu3002%5Cn%5Cn%5Cu7b2c%5Cu4e8c%5Cu884cn%5Cu4e2a%5Cu5c0f%5Cu5199%5Cu82f1%5Cu6587%5Cu5b57%5Cu6bcd%5Cuff0c%5Cu8868%5Cu793a%5Cu5b57%5Cu7b26%5Cu4e32S%5Cu3002%5Cn%5Cn%5Cu7b2c%5Cu4e09%5Cu884c%5Cu4e00%5Cu4e2a%5Cu6b63%5Cu6574%5Cu6570q%28q%5Cu22642%20000%20000%29%5Cuff0c%5Cu8868%5Cu793a%5Cu8be2%5Cu95ee%5Cu6b21%5Cu6570%5Cu3002%5Cn%5Cn%5Cu4e0b%5Cu9762q%5Cu884c%5Cu6bcf%5Cu884c%5Cu4e24%5Cu4e2a%5Cu6b63%5Cu6574%5Cu6570a%2Cb%281%5Cu2264a%5Cu2264b%5Cu2264n%29%2C%5Cu8868%5Cu793a%5Cu8be2%5Cu95ee%5Cu5b57%5Cu7b26%5Cu4e32S%5Ba%5Cu2026b%5D%5Cu7684%5Cu6700%5Cu77ed%5Cu5faa%5Cu73af%5Cu8282%5Cu957f%5Cu5ea6%5Cu3002%22%2C%22description%22%3A%22Bytie%20boy%20has%20to%20learn%20a%20fragment%20of%20a%20certain%20poem%20by%20heart.%20%20The%20poem%2C%20following%20the%20best%20lines%20of%20modern%20art%2C%20is%20a%20long%20string%20%20%20%20consisting%20of%20lowercase%20English%20alphabet%20letters%20only.%20%20Obviously%2C%20it%20sounds%20horrible%2C%20but%20that%20is%20the%20least%20of%20Bytie%27s%20worries.%5Cn%5CnFirst%20and%20foremost%2C%20he%20completely%20forgot%20which%20fragment%20is%20he%20supposed%20to%20learn.%20%20And%20they%20all%20look%20quite%20difficult%20to%20memorize...%5Cn%5CnThere%20is%20hope%2C%20however%3A%20some%20parts%20of%20the%20poem%20exhibit%20certain%20regularity.%20%20In%20particular%2C%20every%20now%20and%20then%20a%20fragment%2C%20say%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI19%5C%2Fokr-en-tex.1.png%29%2C%20%20%20%20is%20but%20a%20multiple%20repetition%20of%20another%20fragment%2C%20say%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI19%5C%2Fokr-en-tex.2.png%29%20%28in%20other%20words%2C%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI19%5C%2Fokr-en-tex.3.png%29%2C%20i.e.%2C%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI19%5C%2Fokr-en-tex.4.png%29%2C%20where%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI19%5C%2Fokr-en-tex.5.png%29%20is%20%20%20%20an%20integer%29.%20%20In%20such%20case%20we%20say%20that%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI19%5C%2Fokr-en-tex.6.png%29%20is%20a%20full%20period%20of%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI19%5C%2Fokr-en-tex.7.png%29%20%28in%20particular%2C%20every%20string%20is%20its%20own%20full%20period%29.%5Cn%5CnIf%20a%20given%20fragment%20has%20a%20short%20full%20period%2C%20Bytie%27s%20task%20will%20be%20easy.%20%20The%20question%20remains...%20which%20fragment%20was%20that%3F%5Cn%5CnMake%20a%20gift%20for%20Bytie%20-%20write%20a%20program%20that%20will%20read%20the%20whole%20poem%20as%20well%20as%20a%20list%20of%20fragments%20that%20Bytie%20suspects%20might%20be%20the%20%20%20%20one%20he%20is%20supposed%20to%20memorize%2C%20and%20for%20each%20of%20them%20determines%20its%20shortest%20full%20period.%5Cn%5Cn%5Cu7ed9%5Cu51fa%5Cu4e00%5Cu4e2a%5Cu7531%5Cu5c0f%5Cu5199%5Cu82f1%5Cu6587%5Cu5b57%5Cu6bcd%5Cu7ec4%5Cu6210%5Cu7684%5Cu5b57%5Cu7b26%5Cu4e32S%5Cuff0c%5Cu518d%5Cu7ed9%5Cu51faq%5Cu4e2a%5Cu8be2%5Cu95ee%5Cuff0c%5Cu8981%5Cu6c42%5Cu56de%5Cu7b54S%5Cu67d0%5Cu4e2a%5Cu5b50%5Cu4e32%5Cu7684%5Cu6700%5Cu77ed%5Cu5faa%5Cu73af%5Cu8282%5Cu3002%5Cn%5Cn%5Cu5982%5Cu679c%5Cu5b57%5Cu7b26%5Cu4e32B%5Cu662f%5Cu5b57%5Cu7b26%5Cu4e32A%5Cu7684%5Cu5faa%5Cu73af%5Cu8282%5Cuff0c%5Cu90a3%5Cu4e48A%5Cu53ef%5Cu4ee5%5Cu7531B%5Cu91cd%5Cu590d%5Cu82e5%5Cu5e72%5Cu6b21%5Cu5f97%5Cu5230%5Cu3002%5Cn%22%2C%22inputFormat%22%3A%22In%20the%20first%20line%20of%20the%20standard%20input%20there%20is%20a%20single%20integer%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI19%5C%2Fokr-en-tex.8.png%29%20%20%20%20%20%20%28%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI19%5C%2Fokr-en-tex.9.png%29%29.%5Cn%5CnIn%20the%20second%20line%20there%20is%20a%20string%20of%20length%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI19%5C%2Fokr-en-tex.10.png%29%20consisting%20of%20lowercase%20English%20alphabet%20letters-the%20poem.%5Cn%5CnWe%20number%20the%20positions%20of%20its%20successive%20characters%20from%201%20to%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI19%5C%2Fokr-en-tex.11.png%29.%5Cn%5CnThe%20next%20line%20holds%20a%20single%20integer%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI19%5C%2Fokr-en-tex.12.png%29%20%28%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI19%5C%2Fokr-en-tex.13.png%29%29%20denoting%20the%20number%20of%20fragments.%5Cn%5CnThen%20the%20following%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI19%5C%2Fokr-en-tex.14.png%29%20lines%20give%20queries%2C%20one%20per%20line.%5Cn%5CnEach%20query%20is%20a%20pair%20of%20integers%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI19%5C%2Fokr-en-tex.15.png%29%20and%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI19%5C%2Fokr-en-tex.16.png%29%20%28%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI19%5C%2Fokr-en-tex.17.png%29%29%2C%20%20%20%20%20%20separated%20by%20a%20single%20space%2C%20such%20that%20the%20answer%20to%20the%20query%20should%20be%20the%20length%20of%20the%20shortest%20full%20period%20of%20the%20poem%27s%20%20%20%20%20%20fragment%20that%20begins%20at%20position%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI19%5C%2Fokr-en-tex.18.png%29%20and%20ends%20at%20position%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI19%5C%2Fokr-en-tex.19.png%29.%5Cn%5CnIn%20tests%20worth%20in%20total%2042%25%20of%20the%20points%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI19%5C%2Fokr-en-tex.20.png%29%20holds%20in%20addition.%5Cn%5CnIn%20some%20of%20those%2C%20worth%2030%25%20of%20points%20in%20total%2C%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI19%5C%2Fokr-en-tex.21.png%29%20holds%20as%20well.%5Cn%22%2C%22outputFormat%22%3A%22Your%20program%20should%20print%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI19%5C%2Fokr-en-tex.22.png%29%20lines%20on%20the%20standard%20output.%5Cn%5CnThe%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI19%5C%2Fokr-en-tex.23.png%29-th%20of%20these%20lines%20should%20hold%20a%20single%20integer%20-%20the%20answer%20to%20the%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI19%5C%2Fokr-en-tex.24.png%29-th%20query.%5Cn%22%2C%22samples%22%3A%5B%5B%228%5Cnaaabcabc%5Cn3%5Cn1%203%5Cn3%208%5Cn4%208%22%2C%221%5Cn3%5Cn5%22%5D%5D%2C%22hint%22%3A%22%5Cu7ed9%5Cu51fa%5Cu4e00%5Cu4e2a%5Cu7531%5Cu5c0f%5Cu5199%5Cu82f1%5Cu6587%5Cu5b57%5Cu6bcd%5Cu7ec4%5Cu6210%5Cu7684%5Cu5b57%5Cu7b26%5Cu4e32S%5Cuff0c%5Cu518d%5Cu7ed9%5Cu51faq%5Cu4e2a%5Cu8be2%5Cu95ee%5Cuff0c%5Cu8981%5Cu6c42%5Cu56de%5Cu7b54S%5Cu67d0%5Cu4e2a%5Cu5b50%5Cu4e32%5Cu7684%5Cu6700%5Cu77ed%5Cu5faa%5Cu73af%5Cu8282%5Cu3002%5Cn%5Cn%5Cu5982%5Cu679c%5Cu5b57%5Cu7b26%5Cu4e32B%5Cu662f%5Cu5b57%5Cu7b26%5Cu4e32A%5Cu7684%5Cu5faa%5Cu73af%5Cu8282%5Cuff0c%5Cu90a3%5Cu4e48A%5Cu53ef%5Cu4ee5%5Cu7531B%5Cu91cd%5Cu590d%5Cu82e5%5Cu5e72%5Cu6b21%5Cu5f97%5Cu5230%5Cu3002%5Cn%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%5D%2C%22memory%22%3A%5B128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22tags%22%3A%5B29%2C57%2C235%2C319%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A1836%2C%22totalAccepted%22%3A480%2C%22pid%22%3A%22P3538%22%2C%22title%22%3A%22%5BPOI2012%5DOKR-A%20Horrible%20Poem%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A136840%2C%22title%22%3A%22%5Cu5173%5Cu4e8e__gcd%22%2C%22forum%22%3A%7B%22id%22%3A2716%2C%22name%22%3A%22P3538%20%5BPOI2012%5DOKR-A%20Horrible%20Poem%22%2C%22slug%22%3A%22P3538%22%7D%7D%2C%7B%22id%22%3A135888%2C%22title%22%3A%22%5Cu81ea%5Cu95ed%5Cu4e86qwq%22%2C%22forum%22%3A%7B%22id%22%3A2716%2C%22name%22%3A%22P3538%20%5BPOI2012%5DOKR-A%20Horrible%20Poem%22%2C%22slug%22%3A%22P3538%22%7D%7D%2C%7B%22id%22%3A135826%2C%22title%22%3A%22%5Cu6211%5Cu662f%5Cu771f%5Cu7684%5Cu4f5b%5Cu4e86%22%2C%22forum%22%3A%7B%22id%22%3A2716%2C%22name%22%3A%22P3538%20%5BPOI2012%5DOKR-A%20Horrible%20Poem%22%2C%22slug%22%3A%22P3538%22%7D%7D%2C%7B%22id%22%3A132298%2C%22title%22%3A%22%5Cu81ea%5Cu95ed%5Cu4e86qwq%22%2C%22forum%22%3A%7B%22id%22%3A2716%2C%22name%22%3A%22P3538%20%5BPOI2012%5DOKR-A%20Horrible%20Poem%22%2C%22slug%22%3A%22P3538%22%7D%7D%2C%7B%22id%22%3A132193%2C%22title%22%3A%22%5Cu81ea%5Cu95ed%5Cu4e86qwq%22%2C%22forum%22%3A%7B%22id%22%3A2716%2C%22name%22%3A%22P3538%20%5BPOI2012%5DOKR-A%20Horrible%20Poem%22%2C%22slug%22%3A%22P3538%22%7D%7D%2C%7B%22id%22%3A113019%2C%22title%22%3A%22%5Cu4ec0%5Cu4e48%2A%2A%2A%2A%2A%2A%2A%5Cu9898%22%2C%22forum%22%3A%7B%22id%22%3A2716%2C%22name%22%3A%22P3538%20%5BPOI2012%5DOKR-A%20Horrible%20Poem%22%2C%22slug%22%3A%22P3538%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P3435%22%2C%22title%22%3A%22%5BPOI2006%5DOKR-Periods%20of%20Words%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P3498%22%2C%22title%22%3A%22%5BPOI2010%5DKOR-Beads%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P3501%22%2C%22title%22%3A%22%5BPOI2010%5DANT-Antisymmetry%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22SP15569%22%2C%22title%22%3A%22STC02%20-%20Antisymmetry%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22SP%22%7D%2C%7B%22pid%22%3A%22P4391%22%2C%22title%22%3A%22%5BBOI2009%5DRadio%20Transmission%20%5Cu65e0%5Cu7ebf%5Cu4f20%5Cu8f93%22%2C%22difficulty%22%3A3%2C%22type%22%3A%22P%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22%5BPOI2012%5DOKR-A%20Horrible%20Poem%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573286098;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>[POI2012]OKR-A Horrible Poem</h1>
<h2>题目背景</h2>
<div>第一行一个正整数n(n≤500 000)，表示S的长度。
第二行n个小写英文字母，表示字符串S。
第三行一个正整数q(q≤2 000 000)，表示询问次数。
下面q行每行两个正整数a,b(1≤a≤b≤n),表示询问字符串S[a…b]的最短循环节长度。</div>
<h2>题目描述</h2>
<div>Bytie boy has to learn a fragment of a certain poem by heart. The poem, following the best lines of modern art, is a long string consisting of lowercase English alphabet letters only. Obviously, it sounds horrible, but that is the least of Bytie's worries.
First and foremost, he completely forgot which fragment is he supposed to learn. And they all look quite difficult to memorize...
There is hope, however: some parts of the poem exhibit certain regularity. In particular, every now and then a fragment, say ![](http://main.edu.pl/images/OI19/okr-en-tex.1.png), is but a multiple repetition of another fragment, say ![](http://main.edu.pl/images/OI19/okr-en-tex.2.png) (in other words, ![](http://main.edu.pl/images/OI19/okr-en-tex.3.png), i.e., ![](http://main.edu.pl/images/OI19/okr-en-tex.4.png), where ![](http://main.edu.pl/images/OI19/okr-en-tex.5.png) is an integer). In such case we say that ![](http://main.edu.pl/images/OI19/okr-en-tex.6.png) is a full period of ![](http://main.edu.pl/images/OI19/okr-en-tex.7.png) (in particular, every string is its own full period).
If a given fragment has a short full period, Bytie's task will be easy. The question remains... which fragment was that?
Make a gift for Bytie - write a program that will read the whole poem as well as a list of fragments that Bytie suspects might be the one he is supposed to memorize, and for each of them determines its shortest full period.
给出一个由小写英文字母组成的字符串S，再给出q个询问，要求回答S某个子串的最短循环节。
如果字符串B是字符串A的循环节，那么A可以由B重复若干次得到。
</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>In the first line of the standard input there is a single integer ![](http://main.edu.pl/images/OI19/okr-en-tex.8.png) (![](http://main.edu.pl/images/OI19/okr-en-tex.9.png)).
In the second line there is a string of length ![](http://main.edu.pl/images/OI19/okr-en-tex.10.png) consisting of lowercase English alphabet letters-the poem.
We number the positions of its successive characters from 1 to ![](http://main.edu.pl/images/OI19/okr-en-tex.11.png).
The next line holds a single integer ![](http://main.edu.pl/images/OI19/okr-en-tex.12.png) (![](http://main.edu.pl/images/OI19/okr-en-tex.13.png)) denoting the number of fragments.
Then the following ![](http://main.edu.pl/images/OI19/okr-en-tex.14.png) lines give queries, one per line.
Each query is a pair of integers ![](http://main.edu.pl/images/OI19/okr-en-tex.15.png) and ![](http://main.edu.pl/images/OI19/okr-en-tex.16.png) (![](http://main.edu.pl/images/OI19/okr-en-tex.17.png)), separated by a single space, such that the answer to the query should be the length of the shortest full period of the poem's fragment that begins at position ![](http://main.edu.pl/images/OI19/okr-en-tex.18.png) and ends at position ![](http://main.edu.pl/images/OI19/okr-en-tex.19.png).
In tests worth in total 42% of the points ![](http://main.edu.pl/images/OI19/okr-en-tex.20.png) holds in addition.
In some of those, worth 30% of points in total, ![](http://main.edu.pl/images/OI19/okr-en-tex.21.png) holds as well.
</div>
<h3>输出格式</h3>
<br />
<div>Your program should print ![](http://main.edu.pl/images/OI19/okr-en-tex.22.png) lines on the standard output.
The ![](http://main.edu.pl/images/OI19/okr-en-tex.23.png)-th of these lines should hold a single integer - the answer to the ![](http://main.edu.pl/images/OI19/okr-en-tex.24.png)-th query.
</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>8
aaabcabc
3
1 3
3 8
4 8</code></pre>
<h3>输出样例 #1</h3>
<pre><code>1
3
5</code></pre>
<h2>说明</h2>
<div>给出一个由小写英文字母组成的字符串S，再给出q个询问，要求回答S某个子串的最短循环节。
如果字符串B是字符串A的循环节，那么A可以由B重复若干次得到。
</div>
</article>
</div>
</div>
</body>
</html>
