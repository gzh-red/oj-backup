<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>[CCC 2018]最大战略储备 - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573381829:VpbViVsrdHCbYEvQQpTkvaXpWbgWB5MJirHJHwl/bSI=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%22%2C%22description%22%3A%22%2A%2A%5Cu9898%5Cu76ee%5Cu8bd1%5Cu81ea%20%5BCCC%202018%5D%28https%3A%5C%2F%5C%2Fcemc.math.uwaterloo.ca%5C%2Fcontests%5C%2Fcomputing%5C%2F2018%5C%2F%29%20S5%5Cu300c%5BMaximum%20Strategic%20Savings%5D%28https%3A%5C%2F%5C%2Fcemc.math.uwaterloo.ca%5C%2Fcontests%5C%2Fcomputing%5C%2F2018%5C%2Fstage%25201%5C%2FseniorEF.pdf%29%5Cu300d%2A%2A%5Cn%5Cn%5Cu6709%20%24N%24%20%5Cu4e2a%5Cu661f%5Cu7403%5Cuff0c%5Cu7f16%5Cu53f7%5Cu4e3a%20%241%5C%5Cldots%20N%24%5Cu3002%5Cu6bcf%5Cu4e2a%5Cu661f%5Cu7403%5Cu6709%20%24M%24%20%5Cu5ea7%5Cu57ce%5Cu5e02%5Cuff0c%5Cu7f16%5Cu53f7%5Cu4e3a%20%241%5C%5Cldots%20M%24%5Cu3002%5Cu6211%5Cu4eec%5Cu5c06%20%24e%24%20%5Cu661f%5Cu7403%5Cu4e0a%5Cu7684%5Cu57ce%5Cu5e02%20%24f%24%20%5Cu8bb0%5Cu4f5c%20%24%28e%2C%5C%5C%2Cf%29%24%5Cu3002%5Cn%5Cn%5Cu6709%20%24N%5C%5Ctimes%20P%24%20%5Cu6761%5Cu53cc%5Cu5411%5Cu822a%5Cu7ebf%5Cuff0c%5Cu5bf9%5Cu4e8e%5Cu6bcf%5Cu4e2a%5Cu661f%5Cu7403%20%24e%281%5C%5Cle%20e%5C%5Cle%20N%29%24%5Cuff0c%5Cu6709%20%24P%24%20%5Cu6761%5Cu822a%5Cu7ebf%5Cuff0c%5Cu7f16%5Cu53f7%5Cu4e3a%20%241%24%20%5Cu5230%20%24P%24%5Cu3002%5Cu7b2c%20%24i%24%20%5Cu6761%5Cu822a%5Cu7ebf%5Cu8fde%5Cu63a5%5Cu57ce%5Cu5e02%20%24%28e%2C%5C%5C%2Ca_i%29%24%20%5Cu548c%20%24%28e%2C%5C%5C%2Cb_i%29%24%5Cuff0c%5Cu4e14%5Cu6bcf%5Cu5929%5Cu9700%5Cu8981%5Cu82b1%5Cu8d39%20%24c_i%24%20%5Cu7684%5Cu4ee3%5Cu4ef7%5Cu7ef4%5Cu62a4%5Cu3002%5Cn%5Cn%5Cu6709%20%24M%5C%5Ctimes%20Q%24%20%5Cu4e2a%5Cu53cc%5Cu5411%5Cu6e2f%5Cu53e3%5Cu3002%5Cu5bf9%5Cu4e8e%5Cu6240%5Cu6709%5Cu7f16%5Cu53f7%5Cu4e3a%20%24f%281%5C%5Cle%20f%5C%5Cle%20M%29%24%20%5Cu7684%5Cu57ce%5Cu5e02%5Cuff0c%5Cu6709%20%24Q%24%20%5Cu4e2a%5Cu6e2f%5Cu53e3%5Cuff0c%5Cu7f16%5Cu53f7%5Cu4e3a%20%241%24%20%5Cu5230%20%24Q%24%5Cu3002%5Cu7b2c%20%24j%24%20%5Cu4e2a%5Cu6e2f%5Cu53e3%5Cu53ef%5Cu4ee5%5Cu8fde%5Cu63a5%5Cu57ce%5Cu5e02%20%24%28x_j%2C%5C%5C%2Cf%29%24%20%5Cu548c%20%24%28y_j%2C%5C%5C%2Cf%29%24%5Cuff0c%5Cu4e14%5Cu6bcf%5Cu5929%5Cu9700%5Cu8981%5Cu82b1%5Cu8d39%20%24z_j%24%20%5Cu7684%5Cu4ee3%5Cu4ef7%5Cu7ef4%5Cu62a4%5Cu3002%5Cn%5Cn%5Cu73b0%5Cu5728%5Cu9700%5Cu8981%5Cu62c6%5Cu9664%5Cu4e00%5Cu4e9b%5Cu6e2f%5Cu53e3%5Cu548c%5Cuff08%5Cu6216%5Cuff09%5Cu53d6%5Cu6d88%5Cu4e00%5Cu4e9b%5Cu822a%5Cu7ebf%5Cuff0c%5Cu4f7f%5Cu5f97%5Cu57ce%5Cu5e02%5Cu4e4b%5Cu95f4%5Cu4ecd%5Cu80fd%5Cu4fdd%5Cu6301%5Cu8054%5Cu901a%5Cuff0c%5Cu4e14%5Cu8282%5Cu7701%5Cu7684%5Cu4ee3%5Cu4ef7%5Cu4e4b%5Cu548c%5Cu6700%5Cu5927%5Cu3002%22%2C%22inputFormat%22%3A%22%5Cu7b2c%5Cu4e00%5Cu884c%5Cu56db%5Cu4e2a%5Cu6574%5Cu6570%5Cuff0c%5Cu5206%5Cu522b%5Cu4e3a%20%24N%2C%5C%5C%2CM%2C%5C%5C%2CP%2C%5C%5C%2CQ%5C%5C%20%280%5C%5Cle%20N%2C%5C%5C%2CM%2C%5C%5C%2CP%2C%5C%5C%2CQ%5C%5Cle10%5E5%29%24%5Cu3002%5Cn%5Cn%5Cu63a5%5Cu4e0b%5Cu6765%20%24P%24%20%5Cu884c%5Cuff0c%5Cu6bcf%5Cu884c%5Cu4e09%5Cu4e2a%5Cu6574%5Cu6570%20%24a_i%2C%5C%5C%2Cb_i%2C%5C%5C%2Cc_i%281%5C%5Cle%20a_i%2C%5C%5C%2Cb_i%5C%5Cle%20M%2C%5C%5C%2C1%5C%5Cle%20c_i%5C%5Cle10%5E8%29%24%5Cu3002%5Cn%5Cn%5Cu518d%5Cu63a5%5Cu4e0b%5Cu6765%20%24Q%24%20%5Cu884c%5Cuff0c%5Cu6bcf%5Cu884c%5Cu4e09%5Cu4e2a%5Cu6574%5Cu6570%20%24x_j%2C%5C%5C%2Cy_j%2C%5C%5C%2Cz_j%281%5C%5Cle%20x_j%2C%5C%5C%2Cy_j%5C%5Cle%20N%2C%5C%5C%2C1%5C%5Cle%20z_j%5C%5Cle%2010%5E8%29%24%5Cu3002%5Cn%5Cn%5Cu6570%5Cu636e%5Cu4fdd%5Cu8bc1%5Cu57ce%5Cu5e02%5Cu4e4b%5Cu95f4%5Cu4e24%5Cu4e24%5Cu8054%5Cu901a%5Cuff0c%5Cu53ef%5Cu80fd%5Cu6709%5Cu91cd%5Cu8fb9%5Cu6216%5Cu81ea%5Cu73af%5Cu3002%22%2C%22outputFormat%22%3A%22%5Cu8f93%5Cu51fa%5Cu4e00%5Cu884c%5Cu4e00%5Cu4e2a%5Cu6574%5Cu6570%5Cu8868%5Cu793a%5Cu6bcf%5Cu5929%5Cu6700%5Cu591a%5Cu80fd%5Cu8282%5Cu7701%5Cu7684%5Cu4ee3%5Cu4ef7%5Cu4e4b%5Cu548c%5Cu3002%22%2C%22samples%22%3A%5B%5B%222%202%201%202%5Cn1%202%201%5Cn2%201%201%5Cn2%201%201%22%2C%223%22%5D%2C%5B%222%203%204%201%5Cn2%203%205%5Cn3%202%207%5Cn1%202%206%5Cn1%201%208%5Cn2%201%205%22%2C%2241%22%5D%5D%2C%22hint%22%3A%22%23%23%23%23%20%5Cu6837%5Cu4f8b%202%20%5Cu89e3%5Cu91ca%5Cn%5Cu4e00%5Cu79cd%5Cu53ef%5Cu884c%5Cu7684%5Cu6700%5Cu4f18%5Cu89e3%5Cu662f%5Cu5173%5Cu95ed%5Cu57ce%5Cu5e02%20%24%281%2C%5C%5C%2C1%29%24%20%5Cu4e0e%20%24%281%2C1%29%24%5Cu3001%24%282%2C%5C%5C%2C1%29%24%20%5Cu4e0e%20%24%282%2C%5C%5C%2C1%29%24%5Cu3001%24%281%2C%5C%5C%2C1%29%24%20%5Cu4e0e%20%24%281%2C%5C%5C%2C2%29%24%5Cu3001%24%281%2C%5C%5C%2C3%29%24%20%5Cu4e0e%20%24%281%2C%5C%5C%2C2%29%24%5Cu3001%24%282%2C%5C%5C%2C3%29%24%20%5Cu4e0e%20%24%282%2C%5C%5C%2C2%29%24%20%5Cu4e4b%5Cu95f4%5Cu7684%5Cu822a%5Cu7ebf%5Cuff1b%5Cu5e76%5Cu5173%5Cu95ed%5Cu57ce%5Cu5e02%20%24%282%2C%5C%5C%2C3%29%24%20%5Cu4e0e%20%24%281%2C%5C%5C%2C3%29%24%20%5Cu95f4%5Cu7684%5Cu6e2f%5Cu53e3%5Cu3002%5Cu6700%5Cu7ec8%5Cu53ef%5Cu4ee5%5Cu8282%5Cu7701%20%248%20%2B%208%20%2B%206%20%2B%207%20%2B%207%20%2B%205%20%3D%2041%24%20%5Cu7684%5Cu4ee3%5Cu4ef7%5Cu3002%5Cn%5Cn%5Cu5bf9%5Cu4e8e%20%24%5C%5Cfrac%7B2%7D%7B15%7D%24%20%5Cu7684%5Cu6570%5Cu636e%5Cuff0c%24P%2C%5C%5C%2CQ%5C%5Cle100%24%5Cuff0c%5Cu4e14%5Cu5bf9%5Cu4e8e%5Cu6240%5Cu6709%5Cu7684%20%241%5C%5Cle%20i%5C%5Cle%20P%24%5Cuff0c%5Cu90fd%5Cu6709%20%24c_i%3D1%24%5Cuff1b%5Cu5bf9%5Cu4e8e%5Cu6240%5Cu6709%5Cu7684%20%241%5C%5Cle%20j%5C%5Cle%20Q%24%5Cuff0c%5Cu90fd%5Cu6709%20%24z_j%3D1%24%5Cuff1b%5Cn%5Cn%5Cu5bf9%5Cu4e8e%5Cu53e6%5Cu5916%20%24%5C%5Cfrac%7B2%7D%7B15%7D%24%20%5Cu7684%5Cu6570%5Cu636e%5Cuff0c%24P%2C%5C%5C%2CQ%5C%5Cle%20200%24%5Cuff1b%5Cn%5Cn%5Cu5bf9%5Cu4e8e%5Cu53e6%5Cu5916%20%24%5C%5Cfrac%7B5%7D%7B15%7D%24%20%5Cu7684%5Cu6570%5Cu636e%5Cuff0c%24N%2C%5C%5C%2CM%5C%5Cle%20200%24%5Cuff1b%5Cn%5Cn%5Cu5bf9%5Cu4e8e%5Cu5168%5Cu90e8%5Cu7684%5Cu6570%5Cu636e%5Cuff0c%241%5C%5Cle%20N%2C%5C%5C%2CM%2C%5C%5C%2CP%2C%5C%5C%2CQ%5C%5Cle10%5E5%24%5Cu3002%22%2C%22provider%22%3A%7B%22uid%22%3A35485%2C%22name%22%3A%22Hatsune_Miku%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3Anull%2C%22isAdmin%22%3Afalse%2C%22color%22%3A%22Blue%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%5D%2C%22memory%22%3A%5B256000%2C256000%2C256000%2C256000%2C256000%2C256000%2C256000%2C256000%2C256000%2C256000%2C256000%2C256000%2C256000%2C256000%2C256000%2C256000%2C256000%2C256000%2C256000%2C256000%2C256000%2C256000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22tags%22%3A%5B35%2C319%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A130%2C%22totalAccepted%22%3A42%2C%22pid%22%3A%22P4809%22%2C%22title%22%3A%22%5BCCC%202018%5D%5Cu6700%5Cu5927%5Cu6218%5Cu7565%5Cu50a8%5Cu5907%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P4493%22%2C%22title%22%3A%22%5BHAOI2018%5D%5Cu5b57%5Cu4e32%5Cu8986%5Cu76d6%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P4655%22%2C%22title%22%3A%22%5BCEOI2017%5DBuilding%20Bridges%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P4745%22%2C%22title%22%3A%22%5BCERC2017%5DGambling%20Guide%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P4804%22%2C%22title%22%3A%22%5BCCC%202016%5D%5Cu751f%5Cu547d%5Cu4e2d%5Cu7684%5Cu5706%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P4805%22%2C%22title%22%3A%22%5BCCC%202016%5D%5Cu5408%5Cu5e76%5Cu996d%5Cu56e2%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22P%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22%5BCCC%202018%5D%5Cu6700%5Cu5927%5Cu6218%5Cu7565%5Cu50a8%5Cu5907%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>[CCC 2018]最大战略储备</h1>
<h2>题目描述</h2>
<div>**题目译自 [CCC 2018](https://cemc.math.uwaterloo.ca/contests/computing/2018/) S5「[Maximum Strategic Savings](https://cemc.math.uwaterloo.ca/contests/computing/2018/stage%201/seniorEF.pdf)」**
有 $N$ 个星球，编号为 $1\ldots N$。每个星球有 $M$ 座城市，编号为 $1\ldots M$。我们将 $e$ 星球上的城市 $f$ 记作 $(e,\,f)$。
有 $N\times P$ 条双向航线，对于每个星球 $e(1\le e\le N)$，有 $P$ 条航线，编号为 $1$ 到 $P$。第 $i$ 条航线连接城市 $(e,\,a_i)$ 和 $(e,\,b_i)$，且每天需要花费 $c_i$ 的代价维护。
有 $M\times Q$ 个双向港口。对于所有编号为 $f(1\le f\le M)$ 的城市，有 $Q$ 个港口，编号为 $1$ 到 $Q$。第 $j$ 个港口可以连接城市 $(x_j,\,f)$ 和 $(y_j,\,f)$，且每天需要花费 $z_j$ 的代价维护。
现在需要拆除一些港口和（或）取消一些航线，使得城市之间仍能保持联通，且节省的代价之和最大。</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>第一行四个整数，分别为 $N,\,M,\,P,\,Q\ (0\le N,\,M,\,P,\,Q\le10^5)$。
接下来 $P$ 行，每行三个整数 $a_i,\,b_i,\,c_i(1\le a_i,\,b_i\le M,\,1\le c_i\le10^8)$。
再接下来 $Q$ 行，每行三个整数 $x_j,\,y_j,\,z_j(1\le x_j,\,y_j\le N,\,1\le z_j\le 10^8)$。
数据保证城市之间两两联通，可能有重边或自环。</div>
<h3>输出格式</h3>
<br />
<div>输出一行一个整数表示每天最多能节省的代价之和。</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>2 2 1 2
1 2 1
2 1 1
2 1 1</code></pre>
<h3>输出样例 #1</h3>
<pre><code>3</code></pre>
<h3>输入样例 #2</h3>
<pre><code>2 3 4 1
2 3 5
3 2 7
1 2 6
1 1 8
2 1 5</code></pre>
<h3>输出样例 #2</h3>
<pre><code>41</code></pre>
<h2>说明</h2>
<div>#### 样例 2 解释
一种可行的最优解是关闭城市 $(1,\,1)$ 与 $(1,1)$、$(2,\,1)$ 与 $(2,\,1)$、$(1,\,1)$ 与 $(1,\,2)$、$(1,\,3)$ 与 $(1,\,2)$、$(2,\,3)$ 与 $(2,\,2)$ 之间的航线；并关闭城市 $(2,\,3)$ 与 $(1,\,3)$ 间的港口。最终可以节省 $8 + 8 + 6 + 7 + 7 + 5 = 41$ 的代价。
对于 $\frac{2}{15}$ 的数据，$P,\,Q\le100$，且对于所有的 $1\le i\le P$，都有 $c_i=1$；对于所有的 $1\le j\le Q$，都有 $z_j=1$；
对于另外 $\frac{2}{15}$ 的数据，$P,\,Q\le 200$；
对于另外 $\frac{5}{15}$ 的数据，$N,\,M\le 200$；
对于全部的数据，$1\le N,\,M,\,P,\,Q\le10^5$。</div>
</article>
</div>
</div>
</body>
</html>
