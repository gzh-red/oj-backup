<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>[Celeste-B]Farewell to Mount Celeste - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573382758:CUK11QrctuFdbqD6lTTaUtviWk/TUzWH37e2twLz78w=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%3E%20Sever%20the%20Skyline%5Cn%5Cn%3E%20Black%20Moonrise%5Cn%5Cn%3E%20Good%20Karma%5Cn%5Cn%3E%20Golden%20Feather%5Cn%5Cn%3E%20Mirror%20Magic%5Cn%5Cn%3E%20Center%20of%20the%20Earth%5Cn%5Cn%3E%20No%20More%20Running%5Cn%5Cn%3E%20And...%5Cn%5Cn%3E%20Say%20Goodbye.%22%2C%22description%22%3A%22%5Cu5728%5Cu5206%5Cu522b%5Cu7684%5Cu5bb4%5Cu4f1a%5Cu4e0a%5Cuff0c%5Cu670b%5Cu53cb%5Cu4eec%5Cu62ff%5Cu51fa%5Cu4ed6%5Cu4eec%5Cu628a%5Cu591a%5Cu5f69%5Cu7684%5Cu73e0%5Cu5b50%5Cu4e32%5Cu6210%5Cu7684%5Cu5f69%5Cu8272%5Cu7684%5Cu9879%5Cu94fe%5Cu3002%5Cn%5Cn%5Cu9879%5Cu94fe%5Cu5728%5Cu5915%5Cu9633%5Cu7684%5Cu4f59%5Cu6656%5Cu91cc%5Cu95ea%5Cu95ea%5Cu53d1%5Cu5149%5Cuff0c%5Cu4ed4%5Cu7ec6%5Cu4e00%5Cu770b%5Cuff0c%5Cu9879%5Cu94fe%5Cu5468%5Cu56f4%5Cu7adf%5Cu7136%5Cu5df2%5Cu7ecf%5Cu805a%5Cu96c6%5Cu4e86%5Cu8bb8%5Cu591a%5Cu9e1f%5Cu513f%5Cuff0c%5Cu9e1f%5Cu513f%5Cu4eec%5Cu5e26%5Cu7740%20Madeline%20%5Cu4e0e%5Cu5979%5Cu7684%5Cu670b%5Cu53cb%5Cu4eec%5Cu6765%5Cu5230%5Cu4e86%5Cu4e00%5Cu5904%5Cu4ed6%5Cu4eec%5Cu4e0d%5Cu66fe%5Cu6765%5Cu8fc7%5Cu7684%5Cu5730%5Cu65b9%5Cuff0c%5Cu8fd9%5Cu91cc%5Cu6c47%5Cu805a%5Cu7740%5Cu597d%5Cu5927%5Cu4e00%5Cu7fa4%5Cu9e1f%5Cuff0c%5Cu4f3c%5Cu4e4e%5Cu60f3%5Cu8981%5Cu5411%5Cu4ed6%5Cu4eec%5Cu8868%5Cu8fbe%5Cu4e9b%5Cu4ec0%5Cu4e48%5Cu3002%5Cn%5Cn%5Cu7ecf%5Cu8fc7%20Madeline%20%5Cu4ed4%5Cu7ec6%5Cu5730%5Cu89c2%5Cu5bdf%5Cuff0c%5Cu5b83%5Cu53d1%5Cu73b0%5Cu4e00%5Cu4e9b%5Cu9e1f%5Cu513f%5Cu4eec%5Cu98de%5Cu52a8%5Cu7684%5Cu65b9%5Cu5f0f%5Cu597d%5Cu50cf%5Cu6392%5Cu6210%5Cu4e86%5Cu4e00%5Cu4e2a%5Cu6709%5Cu5e8f%5Cu7684%5Cu5f0f%5Cu5b50%5Cuff0c%5Cu800c%5Cu53e6%5Cu4e00%5Cu4e9b%5Cu9e1f%5Cu513f%5Cu98de%5Cu52a8%5Cu7684%5Cu65b9%5Cu5f0f%5Cu5219%5Cu662f%5Cu4e00%5Cu4e9b%5Cu7b26%5Cu53f7%5Cuff0c%5Cu7b26%5Cu53f7%5Cu8868%5Cu8fbe%5Cu7740%5Cu4e00%5Cu4e2a%5Cu95ee%5Cu9898%5Cu3002%5Cn%5Cn%5Cu9e1f%5Cu513f%5Cu4eec%5Cu8868%5Cu8fbe%5Cu7684%5Cu95ee%5Cu9898%5Cu662f%5Cu8fd9%5Cu6837%5Cu7684%5Cuff1a%5Cn%5Cn%5Cu9e1f%5Cu513f%5Cu4eec%5Cu7ec4%5Cu6210%5Cu7684%5Cu5f0f%5Cu5b50%5Cu4f1a%5Cu7531%20%60%28%60%2C%60%29%60%2C%60%5E%60%2C%60%26%60%2C%60%7C%60%2C%600%60%2C%601%60%20%5Cu548c%5Cu5c0f%5Cu5199%5Cu5b57%5Cu6bcd%5Cu6784%5Cu6210%5Cuff0c%5Cu5e76%5Cu4e14%5Cu662f%5Cu4e00%5Cu4e2a%5Cu8868%5Cu8fbe%5Cu5f0f%5Cu3002%5Cn%5Cn%5Cu5176%5Cu4e2d%5Cuff1a%5Cn%5Cn-%20%60%28%60%2C%60%29%60%20%5Cu8868%5Cu793a%5Cu62ec%5Cu53f7%5Cuff0c%5Cu5728%5Cu62ec%5Cu53f7%5Cu4e2d%5Cu7684%5Cu8fd0%5Cu7b97%5Cu4f18%5Cu5148%5Cu7ea7%5Cu63d0%5Cu9ad8%5Cu3002%5Cn%5Cn-%20%60%26%60%2C%60%7C%60%2C%60%5E%60%20%5Cu8868%5Cu793a%20%60%5Cu4e0e%60%2C%60%5Cu6216%60%2C%60%5Cu5f02%5Cu6216%60%20%5Cu4e09%5Cu79cd%5Cu4f4d%5Cu8fd0%5Cu7b97%5Cuff0c%5Cu8fd9%5Cu4e09%5Cu79cd%5Cu8fd0%5Cu7b97%2A%2A%5Cu4f18%5Cu5148%5Cu7ea7%5Cu76f8%5Cu540c%2A%2A%5Cn%5Cn-%20%600%60%2C%601%60%20%5Cu5373%5Cu4e3a%20%600%60%2C%601%60%5Cn%5Cn-%20%5Cu5c0f%5Cu5199%5Cu5b57%5Cu6bcd%5Cu8868%5Cu793a%5Cu53d8%5Cu91cf%5Cuff0c%5Cu591a%5Cu6b21%5Cu51fa%5Cu73b0%5Cu7684%5Cu540c%5Cu4e00%5Cu5c0f%5Cu5199%5Cu5b57%5Cu6bcd%5Cu8868%5Cu793a%2A%2A%5Cu4e0d%5Cu540c%2A%2A%5Cu7684%5Cu53d8%5Cu91cf%5Cuff0c%5Cu4e00%5Cu4e2a%5Cu53d8%5Cu91cf%5Cu53d6%5Cu503c%20%600%60%20%5Cu6216%20%601%60%5Cn%5Cn-%20%5Cu8868%5Cu8fbe%5Cu5f0f%5Cu7684%5Cu5b9a%5Cu4e49%5Cu5982%5Cu4e0b%5Cuff1a%5Cn%5Cn%20%20%20%20-%20%5Cu4e00%5Cu4e2a%5Cu53d8%5Cu91cf%2C%600%60%2C%601%60%20%5Cu5747%5Cu4e3a%5Cu8868%5Cu8fbe%5Cu5f0f%5Cn%20%20%20%20-%20%5Cu82e5%20%24T%24%20%5Cu662f%5Cu8868%5Cu8fbe%5Cu5f0f%5Cuff0c%5Cu5219%20%24%28T%29%24%20%5Cu662f%5Cu8868%5Cu8fbe%5Cu5f0f%5Cn%20%20%20%20-%20%5Cu82e5%20%24S%24%2C%24T%24%20%5Cu662f%5Cu8868%5Cu8fbe%5Cu5f0f%5Cuff0c%5Cu5219%24S%5C%5C%26T%24%2C%24S%7CT%24%2C%24S%5C%5C%20%5C%5Chat%7B%7D%5C%5C%20T%24%5Cu5747%5Cu4e3a%5Cu8868%5Cu8fbe%5Cu5f0f%5Cn%20%20%20%20-%20%5Cu4f8b%5Cu5982%5Cuff0c%24%281%5C%5C%20%5C%5Chat%7B%7D%5C%5C%201%5C%5C%260%29%24%20%5Cu662f%5Cu4e00%5Cu4e2a%5Cu8868%5Cu8fbe%5Cu5f0f%5Cuff0c%5Cu5e76%5Cu4e14%5Cu8fd0%5Cu7b97%5Cu7ed3%5Cu679c%5Cu4e3a%20%240%24%5Cuff0c%5Cu4f46%20%24%281%5C%5C%260%24%20%5Cu4e0d%5Cu662f%5Cu4e00%5Cu4e2a%5Cu8868%5Cu8fbe%5Cu5f0f%5Cn%5Cn%5Cu9e1f%5Cu513f%5Cu4eec%5Cu8ba4%5Cu4e3a%5Cuff0c%5Cu8981%5Cu80fd%5Cu7b97%5Cu51fa%20%241%24%20%5Cu7684%5Cu8868%5Cu8fbe%5Cu5f0f%5Cu624d%5Cu662f%5Cu4f18%5Cu7f8e%5Cu7684%5Cuff0c%5Cu5b9a%5Cu4e49%5Cu4e00%5Cu4e2a%5Cu8868%5Cu8fbe%5Cu5f0f%5Cu7684%5Cu4f18%5Cu7f8e%5Cu5ea6%5Cu4e3a%5Cu5728%5Cu8fd9%5Cu4e2a%5Cu8868%5Cu8fbe%5Cu5f0f%5Cu6240%5Cu6709%20%24v%24%20%5Cu4e2a%5Cu53d8%5Cu91cf%5Cu7684%20%242%5Ev%24%20%5Cu79cd%5Cu53d6%5Cu503c%5Cu4e2d%5Cu80fd%5Cu7b97%5Cu51fa%20%241%24%20%5Cu7684%5Cu65b9%5Cu6848%5Cu6570%5Cu3002%5Cn%5Cn%5Cu9e1f%5Cu513f%5Cu4eec%5Cu8fd8%5Cu8ba4%5Cu4e3a%5Cuff0c%5Cu4e00%5Cu4e2a%5Cu8868%5Cu8fbe%5Cu5f0f%5Cu7684%5Cu548c%5Cu8c10%5Cu5ea6%5Cu662f%5Cu8fd9%5Cu4e2a%5Cu8868%5Cu8fbe%5Cu5f0f%5Cu7684%5Cu6240%5Cu6709%2A%2A%5Cu5b50%5Cu8fde%5Cu7eed%5Cu8868%5Cu8fbe%5Cu5f0f%2A%2A%5Cu7684%5Cu4f18%5Cu7f8e%5Cu5ea6%5Cu7684%5Cu548c%5Cu3002%28%5Cu5305%5Cu542b%5Cu81ea%5Cu8eab%29%5Cn%5Cn%5Cu9e1f%5Cu513f%5Cu4eec%5Cu8fd8%5Cu662f%5Cu5584%5Cu53d8%5Cu7684%5Cuff0c%5Cu5b83%5Cu4eec%5Cu4f1a%5Cu65f6%5Cu4e0d%5Cu65f6%5Cu6539%5Cu53d8%5Cu4e00%5Cu4e2a%5Cu4f4d%5Cu7f6e%5Cu7684%5Cu5b57%5Cu7b26%5Cuff0c%5Cu4f46%5Cu662f%5Cu5b83%5Cu4eec%5Cu5411%20Madeline%20%5Cu548c%5Cu5979%5Cu7684%5Cu670b%5Cu53cb%5Cu4eec%5Cu4fdd%5Cu8bc1%5Cu5b83%5Cu4eec%5Cu4e0d%5Cu4f1a%5Cu6539%5Cu53d8%5Cu62ec%5Cu53f7%5Cuff0c%5Cu5e76%5Cu4e14%5Cu8fdb%5Cu884c%5Cu4fee%5Cu6539%5Cu4e4b%5Cu540e%5Cu6574%5Cu4e2a%5Cu4e32%5Cu4ecd%5Cu7136%5Cu662f%5Cu4e00%5Cu4e2a%5Cu8868%5Cu8fbe%5Cu5f0f%5Cu3002%5Cn%5Cn%5Cu4f60%5Cu80fd%5Cu5e2e%5Cu52a9%20Madeline%20%5Cu548c%5Cu5979%5Cu7684%5Cu670b%5Cu53cb%5Cu4eec%5Cu7b97%5Cu51fa%5Cu6bcf%5Cu6b21%5Cu4fee%5Cu6539%5Cu540e%5Cu6574%5Cu4e2a%5Cu8868%5Cu8fbe%5Cu5f0f%5Cu7684%5Cu548c%5Cu8c10%5Cu5ea6%5Cu5417%5Cuff1f%5Cn%5Cn%5Cu9e1f%5Cu513f%5Cu4eec%5Cu8fd8%5Cu8bf4%5Cuff0c%5Cu56e0%5Cu4e3a%5Cu8868%5Cu8fbe%5Cu5f0f%5Cu53ef%5Cu80fd%5Cu592a%5Cu548c%5Cu8c10%5Cu4e86%5Cuff0c%5Cu56e0%5Cu6b64%20Madeline%20%5Cu53ef%5Cu4ee5%5Cu53ea%5Cu56de%5Cu7b54%5Cu548c%5Cu8c10%5Cu5ea6%5Cu5bf9%20%24998244353%24%20%5Cu53d6%5Cu6a21%5Cu540e%5Cu7684%5Cu503c%5Cu3002%22%2C%22inputFormat%22%3A%22%5Cu7b2c%5Cu4e00%5Cu884c%5Cu4e3a%5Cu4e00%5Cu4e2a%5Cu6570%20%24m%24%20%2C%5Cu8868%5Cu793a%5Cu4fee%5Cu6539%5Cu6570%5Cn%5Cn%5Cu7b2c%5Cu4e8c%5Cu884c%5Cu4e3a%5Cu4e00%5Cu4e2a%5Cu5b57%5Cu7b26%5Cu4e32%5Cuff0c%5Cu8868%5Cu793a%5Cu521d%5Cu59cb%5Cu8868%5Cu8fbe%5Cu5f0f%5Cn%5Cn%5Cu4e4b%5Cu540e%20%24m%24%20%5Cu884c%5Cuff0c%5Cu6bcf%5Cu4e00%5Cu884c%5Cu4e00%5Cu4e2a%5Cu6570%20%24a%24%20%5Cu548c%5Cu4e00%5Cu4e2a%5Cu5b57%5Cu7b26%20%24b%24%20%5Cuff0c%5Cu8868%5Cu793a%5Cu9e1f%5Cu513f%5Cu4eec%5Cu5c06%20%24a%24%20%5Cu4f4d%5Cu7f6e%5Cu5b57%5Cu7b26%5Cu53d8%5Cu6210%20%24b%24%20%5Cn%5Cn%5Cu5728%5Cu8f93%5Cu5165%5Cu7684%5Cu8868%5Cu8fbe%5Cu5f0f%5Cu4e2d%5Cuff0c%5Cu4e00%5Cu4e2a%5Cu5c0f%5Cu5199%5Cu5b57%5Cu6bcd%5Cu4ee3%5Cu8868%5Cu4e00%5Cu4e2a%5Cu53d8%5Cu91cf%5Cu3002%28%5Cu6ce8%5Cu610f%5Cu4e00%5Cu4e2a%5Cu5b57%5Cu6bcd%5Cu53ef%5Cu80fd%5Cu51fa%5Cu73b0%5Cu591a%5Cu6b21%5Cuff0c%5Cu4f46%5Cu4ee3%5Cu8868%2A%2A%5Cu4e0d%5Cu540c%2A%2A%5Cu53d8%5Cu91cf%29%22%2C%22outputFormat%22%3A%22%24m%24%20%5Cu884c%5Cuff0c%5Cu7b2c%20%24i%24%20%5Cu884c%5Cu4e3a%5Cu7b2c%20%24i%24%20%5Cu6b21%5Cu4fee%5Cu6539%5Cu540e%5Cu7684%5Cu6743%5Cu503c%5Cu3002%5Cu7531%5Cu4e8e%5Cu548c%5Cu8c10%5Cu5ea6%5Cu53ef%5Cu80fd%5Cu5f88%5Cu5927%5Cuff0c%5Cu4f60%5Cu9700%5Cu8981%5Cu5bf9%20%24998244353%24%20%5Cu53d6%5Cu6a21%5Cu3002%22%2C%22samples%22%3A%5B%5B%225%5Cn%281%26b%29%5Cn3%20%7C%5Cn2%20a%5Cn3%20%26%5Cn3%20%5E%5Cn4%201%22%2C%226%5Cn8%5Cn4%5Cn6%5Cn4%22%5D%2C%5B%2210%5Cn1%7Ca%261%26%280%260%7C1%29%261%5E1%5Ea%5Cn1%200%5Cn10%201%5Cn2%20%26%5Cn1%20a%5Cn14%20%5E%5Cn4%20%7C%5Cn17%200%5Cn4%20%5E%5Cn15%20a%5Cn15%201%5Cn%22%2C%2229%5Cn30%5Cn27%5Cn35%5Cn35%5Cn43%5Cn35%5Cn35%5Cn56%5Cn35%22%5D%2C%5B%2230%5Cn0%7C0%260%5E%28a%26a%26%281%5E0%260%5E0%29%5E0%261%29%7C0%26a%7C1%7C%28a%26a%7C0%7C1%7C0%5Ea%260%26a%7C%28a%5E0%261%7Ca%7Ca%29%5Ea%7Ca%260%260%29%5Ea%5Cn71%201%5Cn51%200%5Cn57%200%5Cn65%20%26%5Cn26%20%7C%5Cn5%20a%5Cn71%20a%5Cn56%20%7C%5Cn4%20%26%5Cn41%20%5E%5Cn52%20%7C%5Cn52%20%5E%5Cn59%20a%5Cn44%200%5Cn54%20%5E%5Cn65%20%26%5Cn51%20a%5Cn36%201%5Cn16%20%5E%5Cn1%201%5Cn52%20%5E%5Cn2%20%7C%5Cn59%200%5Cn58%20%7C%5Cn37%20%5E%5Cn55%201%5Cn10%201%5Cn26%20%5E%5Cn18%20%7C%5Cn44%200%5Cn%22%2C%2221323%5Cn10686%5Cn5360%5Cn5360%5Cn5360%5Cn8469%5Cn16277%5Cn16277%5Cn16277%5Cn16277%5Cn16277%5Cn16277%5Cn16277%5Cn8223%5Cn8253%5Cn8253%5Cn16354%5Cn8359%5Cn8385%5Cn8394%5Cn8394%5Cn8394%5Cn4262%5Cn4262%5Cn4262%5Cn4262%5Cn2430%5Cn2430%5Cn2430%5Cn2430%22%5D%2C%5B%2220%5Cna%5E1%260%5E1%5E1%261%26a%261%5Ea%7C1%26a%7C0%26a%5Ea%5E1%5Ea%5E0%261%5Ea%26a%7Ca%7C1%5E0%7Ca%7C0%5E1%5Ea%7C0%5E0%261%261%26a%26a%7C0%5E0%26a%261%26a%7Ca%26a%5Ea%7C0%5Ea%5Ea%7Ca%5E1%7Ca%7C1%5Ea%7C0%7Ca%5E0%260%260%7Ca%7Ca%7Ca%5E0%5E1%260%5E1%26a%7C1%260%5Cn8%20%5E%5Cn28%20%7C%5Cn100%20%5E%5Cn119%20a%5Cn40%20%26%5Cn105%201%5Cn31%201%5Cn125%201%5Cn53%201%5Cn98%20%26%5Cn98%20%26%5Cn98%20%26%5Cn52%20%26%5Cn2%20%5E%5Cn38%20%7C%5Cn6%20%5E%5Cn58%20%5E%5Cn106%20%7C%5Cn12%20%5E%5Cn57%201%22%2C%22957521426%5Cn957521583%5Cn874091659%5Cn57281108%5Cn57278566%5Cn140708493%5Cn120472431%5Cn120472431%5Cn561701787%5Cn551192201%5Cn551192201%5Cn551192201%5Cn551120577%5Cn551120577%5Cn551121853%5Cn551121853%5Cn551178140%5Cn656274015%5Cn656274025%5Cn656222855%22%5D%5D%2C%22hint%22%3A%22%5Cu8bbe%20%24n%24%20%5Cu4e3a%5Cu8868%5Cu8fbe%5Cu5f0f%5Cu4e2d%5Cu53d8%5Cu91cf%5Cu548c%20%240%2C1%24%20%5Cu7684%5Cu4e2a%5Cu6570%5Cuff0c%24len%24%20%5Cu4e3a%5Cu8868%5Cu8fbe%5Cu5f0f%5Cu957f%5Cu5ea6%5Cn%5Cn%5Cu6709subtask%5Cn%5Cn%5Cu5bf9%5Cu4e8e%20%24%205%5C%5C%25%20%24%20%5Cu7684%5Cu6570%5Cu636e%2C%20%24%20n%20%5C%5Cleq%2012%20%2C%20len%20%5C%5Cleq%2050%20%2C%20m%20%5C%5Cleq%2050%20%24%2C1s%5Cn%5Cn%5Cu5bf9%5Cu4e8e%5Cu989d%5Cu5916%20%24%2010%5C%5C%25%20%24%20%5Cu7684%5Cu6570%5Cu636e%2C%20%24%20n%20%5C%5Cleq%20150%2Clen%20%5C%5Cleq%20400%2Cm%20%5C%5Cleq%20200%24%5Cn%5Cn%5Cu5bf9%5Cu4e8e%5Cu989d%5Cu5916%20%24%2010%5C%5C%25%20%24%20%5Cu7684%5Cu6570%5Cu636e%2C%20%24%20n%20%5C%5Cleq%2010%5E5%2Clen%20%5C%5Cleq%202%5C%5Ctimes%2010%5E5%2Cm%20%5C%5Cleq%2010%24%20%2C%5Cu6ca1%5Cu6709%5Cu62ec%5Cu53f7%5Cn%5Cn%5Cu5bf9%5Cu4e8e%5Cu989d%5Cu5916%20%24%2010%5C%5C%25%20%24%20%5Cu7684%5Cu6570%5Cu636e%2C%20%24%20n%20%5C%5Cleq%2010%5E5%2Clen%20%5C%5Cleq%202%5C%5Ctimes%2010%5E5%2Cm%20%5C%5Cleq%2010%5E5%20%24%20%2C%5Cu6ca1%5Cu6709%5Cu62ec%5Cu53f7%5Cn%5Cn%5Cu5bf9%5Cu4e8e%5Cu524d%20%24%2050%5C%5C%25%20%24%20%5Cu7684%5Cu6570%5Cu636e%2C%20%24%20n%20%5C%5Cleq%2010%5E5%2Clen%20%5C%5Cleq%204%5C%5Ctimes%2010%5E5%2Cm%20%5C%5Cleq%2010%5E5%20%24%20%2C%5Cu4fdd%5Cu8bc1%5Cu62ec%5Cu53f7%5Cu968f%5Cu673a%5Cu751f%5Cu6210%5Cn%5Cn%5Cu5bf9%5Cu4e8e%20%24%20100%5C%5C%25%20%24%20%5Cu7684%5Cu6570%5Cu636e%2C%20%24%20n%20%5C%5Cleq%2010%5E5%2Clen%20%5C%5Cleq%204%5C%5Ctimes%2010%5E5%2Cm%20%5C%5Cleq%2010%5E5%20%2Clen-2%5C%5Ctimes%20n%20%5C%5Cleq%202%20%5C%5Ctimes%2010%5E5%24%20%5Cn%5Cn%5Cu5bf9%5Cu4e8e%5Cu540e%20%24%2095%5C%5C%25%20%24%20%5Cu7684%5Cu6570%5Cu636e%5Cuff0c%5Cu65f6%5Cu9650%5Cu4e3a3s%5Cn%5Cnupd%3A%5Cu65f6%5Cu9650%5Cu6539%5Cu4e3a%5Cu524d25%251s%5Cuff0c%5Cu540e75%254.25s%28%5Cu5982%5Cu679c%5Cu6709%5Cu4eba%5Cu524d25%25%5Cu88ab%5Cu5361%5Cu8bf7%5Cu79c1%5Cu4fe1%5Cu6211%29%22%2C%22provider%22%3A%7B%22uid%22%3A27329%2C%22name%22%3A%22137_345_2814%22%2C%22slogan%22%3A%22qwq%22%2C%22badge%22%3Anull%2C%22isAdmin%22%3Afalse%2C%22color%22%3A%22Orange%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C4250%2C4250%2C4250%2C4250%2C4250%2C4250%2C4250%2C4250%2C4250%2C4250%2C4250%2C4250%5D%2C%22memory%22%3A%5B512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%5D%7D%2C%22stdCode%22%3A%22%23include%3Ccstdio%3E%5Cn%23include%3Cvector%3E%5Cn%23include%3Calgorithm%3E%5Cn%23include%3Cmap%3E%5Cn%23include%3Ccstring%3E%5Cnusing%20namespace%20std%3B%5Cn%23define%20N%20400500%5Cn%23define%20mod%20998244353%5Cnvector%3Cint%3E%20sn%5BN%5D%3B%5Cnint%20ct%2Cst%5BN%5D%2Cn%2Crb%2Ca%3B%5Cnstruct%20edge%7Bint%20t%2Cnext%3B%7Ded%5BN%2A2%5D%3B%5Cnint%20head%5BN%5D%2Ccnt%2Ctp%5BN%5D%2Csz%5BN%5D%2Cid%5BN%5D%2Ctid%5BN%5D%2Cson%5BN%5D%2Clson%5BN%5D%2Ced1%5BN%5D%2Creal_ans%2Cfaid%5BN%5D%2Cfa%5BN%5D%3B%5Cnvoid%20adde%28int%20f%2Cint%20t%29%7Bed%5B%2B%2Bcnt%5D%3D%28edge%29%7Bt%2Chead%5Bf%5D%7D%3Bhead%5Bf%5D%3Dcnt%3Bed%5B%2B%2Bcnt%5D%3D%28edge%29%7Bf%2Chead%5Bt%5D%7D%3Bhead%5Bt%5D%3Dcnt%3B%7D%5Cnvoid%20dfs1%28int%20u%2Cint%20fa%29%5Cn%7B%5Cn%5Ctsz%5Bu%5D%3D1%3B%5Cn%5Ctfor%28int%20i%3Dhead%5Bu%5D%3Bi%3Bi%3Ded%5Bi%5D.next%29%5Cn%5Ctif%28ed%5Bi%5D.t%21%3Dfa%29%5Cn%5Ct%7B%5Cn%5Ct%5Ctdfs1%28ed%5Bi%5D.t%2Cu%29%3B%5Cn%5Ct%5Ctif%28sz%5Bed%5Bi%5D.t%5D%3Esz%5Bson%5Bu%5D%5D%29son%5Bu%5D%3Ded%5Bi%5D.t%3B%5Cn%5Ct%5Ctsz%5Bu%5D%2B%3Dsz%5Bed%5Bi%5D.t%5D%3B%5Cn%5Ct%7D%5Cn%7D%5Cnint%20dfs2%28int%20u%2Cint%20v%2Cint%20fa%29%5Cn%7B%5Cn%5Cted1%5Bu%5D%3Du%3B%5Cn%5Cttp%5Bu%5D%3Dv%3Bid%5Bu%5D%3D%2B%2Bct%3Btid%5Bct%5D%3Du%3B%5Cn%5Ctif%28son%5Bu%5D%29ed1%5Bu%5D%3Ddfs2%28son%5Bu%5D%2Cv%2Cu%29%3B%5Cn%5Ctfor%28int%20i%3Dhead%5Bu%5D%3Bi%3Bi%3Ded%5Bi%5D.next%29%5Cn%5Ctif%28ed%5Bi%5D.t%21%3Dfa%26%26ed%5Bi%5D.t%21%3Dson%5Bu%5D%29%5Cn%5Ctdfs2%28ed%5Bi%5D.t%2Ced%5Bi%5D.t%2Cu%29%3B%5Cn%5Ctreturn%20ed1%5Bu%5D%3B%5Cn%7D%5Cnint%20as1%5BN%5D%5B2%5D%2Cas2%5BN%5D%5B2%5D%3B%5Cnstruct%20mat%7Bint%20s%5B2%5D%5B2%5D%3Bmat%28%29%7Bs%5B0%5D%5B0%5D%3Ds%5B0%5D%5B1%5D%3Ds%5B1%5D%5B0%5D%3Ds%5B1%5D%5B1%5D%3D0%3B%7Dmat%28int%20x%2Cint%20y%2Cint%20z%2Cint%20w%29%7Bs%5B0%5D%5B0%5D%3Dx%3Bs%5B0%5D%5B1%5D%3Dy%3Bs%5B1%5D%5B0%5D%3Dz%3Bs%5B1%5D%5B1%5D%3Dw%3B%7D%5Cnfriend%20mat%20operator%20%2A%28mat%20a%2Cmat%20b%29%7Breturn%20%28mat%29%7B%281ll%2Aa.s%5B0%5D%5B0%5D%2Ab.s%5B0%5D%5B0%5D%2B1ll%2Aa.s%5B0%5D%5B1%5D%2Ab.s%5B1%5D%5B0%5D%29%25mod%2C%281ll%2Aa.s%5B0%5D%5B0%5D%2Ab.s%5B0%5D%5B1%5D%2B1ll%2Aa.s%5B0%5D%5B1%5D%2Ab.s%5B1%5D%5B1%5D%29%25mod%2C%5Cn%281ll%2Aa.s%5B1%5D%5B0%5D%2Ab.s%5B0%5D%5B0%5D%2B1ll%2Aa.s%5B1%5D%5B1%5D%2Ab.s%5B1%5D%5B0%5D%29%25mod%2C%281ll%2Aa.s%5B1%5D%5B0%5D%2Ab.s%5B0%5D%5B1%5D%2B1ll%2Aa.s%5B1%5D%5B1%5D%2Ab.s%5B1%5D%5B1%5D%29%25mod%7D%3B%7D%5Cnfriend%20mat%20operator%20%2B%28mat%20a%2Cmat%20b%29%7Breturn%20%28mat%29%7B%28a.s%5B0%5D%5B0%5D%2Bb.s%5B0%5D%5B0%5D%29%25mod%2C%28a.s%5B0%5D%5B1%5D%2Bb.s%5B0%5D%5B1%5D%29%25mod%2C%28a.s%5B1%5D%5B0%5D%2Bb.s%5B1%5D%5B0%5D%29%25mod%2C%28a.s%5B1%5D%5B1%5D%2Bb.s%5B1%5D%5B1%5D%29%25mod%7D%3B%7D%5Cn%7D%3B%5Cnstruct%20num%7Bint%20s%5B2%5D%3Bnum%28%29%7Bs%5B1%5D%3Ds%5B0%5D%3D0%3B%7D%3Bnum%28int%20a%2Cint%20b%29%7Bs%5B0%5D%3Da%3Bs%5B1%5D%3Db%3B%7D%7D%3B%5Cnstruct%20node%7Bint%20l%2Cr%2Cop%3Bnum%20s1%3Bmat%20lm%2Crm%2Csu%3B%7De%5BN%2A4%5D%3B%5Cnint%20ct1%2Cct2%3B%5Cnstruct%20fuc1%7Bnum%20a%3Bmat%20b%3B%7D%3B%5Cnstruct%20fuc2%7Bmat%20a%2Cb%3B%7D%3B%5Cnstruct%20segt1%7B%5Cn%5Ctint%20lb%3B%5Cn%5Ctvoid%20pushup%28int%20x%29%5Cn%5Ct%7B%5Cn%5Ct%5Cte%5Bx%2Blb%5D.su%3De%5Bx%2A2%2Blb%5D.su%2Ae%5Bx%2A2%2B1%2Blb%5D.su%3B%5Cn%5Ct%5Cte%5Bx%2Blb%5D.lm%3De%5Bx%2A2%2B1%2Blb%5D.lm%2Be%5Bx%2A2%2Blb%5D.lm%2Ae%5Bx%2A2%2B1%2Blb%5D.su%3B%5Cn%5Ct%5Cte%5Bx%2Blb%5D.rm%3De%5Bx%2A2%2Blb%5D.rm%2Be%5Bx%2A2%2Blb%5D.su%2Ae%5Bx%2A2%2B1%2Blb%5D.rm%3B%5Cn%5Ct%5Cte%5Bx%2Blb%5D.s1%3D%28num%29%7B%281ll%2Ae%5Bx%2A2%2Blb%5D.s1.s%5B0%5D%2Ae%5Bx%2A2%2B1%2Blb%5D.su.s%5B0%5D%5B0%5D%2B1ll%2Ae%5Bx%2A2%2Blb%5D.s1.s%5B1%5D%2Ae%5Bx%2A2%2B1%2Blb%5D.su.s%5B1%5D%5B0%5D%2Be%5Bx%2A2%2B1%2Blb%5D.s1.s%5B0%5D%29%25mod%2C%281ll%2Ae%5Bx%2A2%2Blb%5D.s1.s%5B0%5D%2Ae%5Bx%2A2%2B1%2Blb%5D.su.s%5B0%5D%5B1%5D%2B1ll%2Ae%5Bx%2A2%2Blb%5D.s1.s%5B1%5D%2Ae%5Bx%2A2%2B1%2Blb%5D.su.s%5B1%5D%5B1%5D%2Be%5Bx%2A2%2B1%2Blb%5D.s1.s%5B1%5D%29%25mod%7D%3B%5Cn%5Ct%7D%5Cn%5Ctvoid%20build%28int%20x%2Cint%20l%2Cint%20r%2Cint%20id%29%5Cn%5Ct%7B%5Cn%5Ct%5Cte%5Bx%2Blb%5D.l%3Dl%3Be%5Bx%2Blb%5D.r%3Dr%3B%5Cn%5Ct%5Ctif%28l%3D%3Dr%29%5Cn%5Ct%5Ct%7B%5Cn%5Ct%5Ct%5Ctif%28l%3D%3D1%29%5Cn%5Ct%5Ct%5Ct%7B%5Cn%5Ct%5Ct%5Ct%5Ctint%20tp%3Dsn%5Bid%5D%5B0%5D%2Csa%2Csb%3B%5Cn%5Ct%5Ct%5Ct%5Ctif%28tp%3D%3D-4%29sa%3D1%2Csb%3D0%3B%5Cn%5Ct%5Ct%5Ct%5Ctelse%20if%28tp%3D%3D-5%29sa%3D0%2Csb%3D1%3B%5Cn%5Ct%5Ct%5Ct%5Ctelse%20if%28tp%3D%3D-6%29sa%3Dsb%3D1%3B%5Cn%5Ct%5Ct%5Ct%5Ctelse%20sa%3Das1%5Btp%5D%5B0%5D%2Csb%3Das1%5Btp%5D%5B1%5D%3B%5Cn%5Ct%5Ct%5Ct%5Cte%5Bx%2Blb%5D.s1%3D%28num%29%7Bsa%2Csb%7D%3B%5Cn%5Ct%5Ct%5Ct%5Cte%5Bx%2Blb%5D.lm%3De%5Bx%2Blb%5D.rm%3De%5Bx%2Blb%5D.su%3D%28mat%29%7Bsa%2Csb%2C0%2C0%7D%3B%5Cn%5Ct%5Ct%5Ct%7D%5Cn%5Ct%5Ct%5Ctelse%5Cn%5Ct%5Ct%5Ct%7B%5Cn%5Ct%5Ct%5Ct%5Ctint%20tp%3Dsn%5Bid%5D%5Bl%2A2-2%5D%2Csa%2Csb%3B%5Cn%5Ct%5Ct%5Ct%5Ctif%28tp%3D%3D-4%29sa%3D1%2Csb%3D0%3B%5Cn%5Ct%5Ct%5Ct%5Ctelse%20if%28tp%3D%3D-5%29sa%3D0%2Csb%3D1%3B%5Cn%5Ct%5Ct%5Ct%5Ctelse%20if%28tp%3D%3D-6%29sa%3Dsb%3D1%3B%5Cn%5Ct%5Ct%5Ct%5Ctelse%20sa%3Das1%5Btp%5D%5B0%5D%2Csb%3Das1%5Btp%5D%5B1%5D%3B%5Cn%5Ct%5Ct%5Ct%5Cte%5Bx%2Blb%5D.s1%3D%28num%29%7Bsa%2Csb%7D%3B%5Cn%5Ct%5Ct%5Ct%5Ctint%20st%3Dsn%5Bid%5D%5Bl%2A2-3%5D%3B%5Cn%5Ct%5Ct%5Ct%5Ctif%28st%3D%3D-1%29e%5Bx%2Blb%5D.lm%3De%5Bx%2Blb%5D.rm%3De%5Bx%2Blb%5D.su%3D%28mat%29%7B%28sa%2Bsb%29%25mod%2C0%2Csa%2Csb%7D%3B%5Cn%5Ct%5Ct%5Ct%5Ctif%28st%3D%3D-2%29e%5Bx%2Blb%5D.lm%3De%5Bx%2Blb%5D.rm%3De%5Bx%2Blb%5D.su%3D%28mat%29%7Bsa%2Csb%2C0%2C%28sa%2Bsb%29%25mod%7D%3B%5Cn%5Ct%5Ct%5Ct%5Ctif%28st%3D%3D-3%29e%5Bx%2Blb%5D.lm%3De%5Bx%2Blb%5D.rm%3De%5Bx%2Blb%5D.su%3D%28mat%29%7Bsa%2Csb%2Csb%2Csa%7D%3B%5Cn%5Ct%5Ct%5Ct%7D%5Cn%5Ct%5Ct%5Ctreturn%3B%5Cn%5Ct%5Ct%7D%5Cn%5Ct%5Ctint%20mid%3D%28l%2Br%29%3E%3E1%3B%5Cn%5Ct%5Ctbuild%28x%3C%3C1%2Cl%2Cmid%2Cid%29%3B%5Cn%5Ct%5Ctbuild%28x%3C%3C1%7C1%2Cmid%2B1%2Cr%2Cid%29%3B%5Cn%5Ct%5Ctpushup%28x%29%3B%5Cn%5Ct%7D%5Cn%5Ctvoid%20modify%28int%20x%2Cint%20v%2Cint%20id%29%5Cn%5Ct%7B%5Cn%5Ct%5Ctif%28e%5Bx%2Blb%5D.l%3D%3De%5Bx%2Blb%5D.r%29%5Cn%5Ct%5Ct%7B%5Cn%5Ct%5Ct%5Ctif%28e%5Bx%2Blb%5D.l%3D%3D1%29%5Cn%5Ct%5Ct%5Ct%7B%5Cn%5Ct%5Ct%5Ct%5Ctint%20tp%3Dsn%5Bid%5D%5B0%5D%2Csa%2Csb%3B%5Cn%5Ct%5Ct%5Ct%5Ctif%28tp%3D%3D-4%29sa%3D1%2Csb%3D0%3B%5Cn%5Ct%5Ct%5Ct%5Ctelse%20if%28tp%3D%3D-5%29sa%3D0%2Csb%3D1%3B%5Cn%5Ct%5Ct%5Ct%5Ctelse%20if%28tp%3D%3D-6%29sa%3Dsb%3D1%3B%5Cn%5Ct%5Ct%5Ct%5Ctelse%20sa%3Das1%5Btp%5D%5B0%5D%2Csb%3Das1%5Btp%5D%5B1%5D%3B%5Cn%5Ct%5Ct%5Ct%5Cte%5Bx%2Blb%5D.s1%3D%28num%29%7Bsa%2Csb%7D%3B%5Cn%5Ct%5Ct%5Ct%5Cte%5Bx%2Blb%5D.lm%3De%5Bx%2Blb%5D.rm%3De%5Bx%2Blb%5D.su%3D%28mat%29%7Bsa%2Csb%2C0%2C0%7D%3B%5Cn%5Ct%5Ct%5Ct%7D%5Cn%5Ct%5Ct%5Ctelse%5Cn%5Ct%5Ct%5Ct%7B%5Cn%5Ct%5Ct%5Ct%5Ctint%20tp%3Dsn%5Bid%5D%5Be%5Bx%2Blb%5D.l%2A2-2%5D%2Csa%2Csb%3B%5Cn%5Ct%5Ct%5Ct%5Ctif%28tp%3D%3D-4%29sa%3D1%2Csb%3D0%3B%5Cn%5Ct%5Ct%5Ct%5Ctelse%20if%28tp%3D%3D-5%29sa%3D0%2Csb%3D1%3B%5Cn%5Ct%5Ct%5Ct%5Ctelse%20if%28tp%3D%3D-6%29sa%3Dsb%3D1%3B%5Cn%5Ct%5Ct%5Ct%5Ctelse%20sa%3Das1%5Btp%5D%5B0%5D%2Csb%3Das1%5Btp%5D%5B1%5D%3B%5Cn%5Ct%5Ct%5Ct%5Cte%5Bx%2Blb%5D.s1%3D%28num%29%7Bsa%2Csb%7D%3B%5Cn%5Ct%5Ct%5Ct%5Ctint%20st%3Dsn%5Bid%5D%5Be%5Bx%2Blb%5D.l%2A2-3%5D%3B%5Cn%5Ct%5Ct%5Ct%5Ctif%28st%3D%3D-1%29e%5Bx%2Blb%5D.lm%3De%5Bx%2Blb%5D.rm%3De%5Bx%2Blb%5D.su%3D%28mat%29%7B%28sa%2Bsb%29%25mod%2C0%2Csa%2Csb%7D%3B%5Cn%5Ct%5Ct%5Ct%5Ctif%28st%3D%3D-2%29e%5Bx%2Blb%5D.lm%3De%5Bx%2Blb%5D.rm%3De%5Bx%2Blb%5D.su%3D%28mat%29%7Bsa%2Csb%2C0%2C%28sa%2Bsb%29%25mod%7D%3B%5Cn%5Ct%5Ct%5Ct%5Ctif%28st%3D%3D-3%29e%5Bx%2Blb%5D.lm%3De%5Bx%2Blb%5D.rm%3De%5Bx%2Blb%5D.su%3D%28mat%29%7Bsa%2Csb%2Csb%2Csa%7D%3B%5Cn%5Ct%5Ct%5Ct%7D%5Cn%5Ct%5Ct%5Ctreturn%3B%5Cn%5Ct%5Ct%7D%5Cn%5Ct%5Ctint%20mid%3D%28e%5Bx%2Blb%5D.l%2Be%5Bx%2Blb%5D.r%29%3E%3E1%3B%5Cn%5Ct%5Ctif%28mid%3E%3Dv%29modify%28x%3C%3C1%2Cv%2Cid%29%3B%5Cn%5Ct%5Ctelse%20modify%28x%3C%3C1%7C1%2Cv%2Cid%29%3B%5Cn%5Ct%5Ctpushup%28x%29%3B%5Cn%5Ct%7D%5Cn%5Ctfuc1%20queryl%28int%20x%2Cint%20l%2Cint%20r%29%5Cn%5Ct%7B%5Cn%5Ct%5Ctif%28e%5Bx%2Blb%5D.l%3D%3Dl%26%26e%5Bx%2Blb%5D.r%3D%3Dr%29return%20%28fuc1%29%7Be%5Bx%2Blb%5D.s1%2Ce%5Bx%2Blb%5D.su%7D%3B%5Cn%5Ct%5Ctint%20mid%3D%28e%5Bx%2Blb%5D.l%2Be%5Bx%2Blb%5D.r%29%3E%3E1%3B%5Cn%5Ct%5Ctif%28mid%3E%3Dr%29return%20queryl%28x%3C%3C1%2Cl%2Cr%29%3B%5Cn%5Ct%5Ctelse%20if%28mid%3Cl%29return%20queryl%28x%3C%3C1%7C1%2Cl%2Cr%29%3B%5Cn%5Ct%5Ctelse%5Cn%5Ct%5Ct%7B%5Cn%5Ct%5Ct%5Ctfuc1%20a%3Dqueryl%28x%3C%3C1%2Cl%2Cmid%29%2Cb%3Dqueryl%28x%3C%3C1%7C1%2Cmid%2B1%2Cr%29%3B%5Cn%5Ct%5Ct%5Ctint%20sa%3D%281ll%2Aa.a.s%5B0%5D%2Ab.b.s%5B0%5D%5B0%5D%2B1ll%2Aa.a.s%5B1%5D%2Ab.b.s%5B1%5D%5B0%5D%2Bb.a.s%5B0%5D%29%25mod%2Csb%3D%281ll%2Aa.a.s%5B0%5D%2Ab.b.s%5B0%5D%5B1%5D%2B1ll%2Aa.a.s%5B1%5D%2Ab.b.s%5B1%5D%5B1%5D%2Bb.a.s%5B1%5D%29%25mod%3B%5Cn%5Ct%5Ct%5Ctreturn%20%28fuc1%29%7B%28num%29%7Bsa%2Csb%7D%2Ca.b%2Ab.b%7D%3B%5Cn%5Ct%5Ct%7D%5Cn%5Ct%7D%5Cn%5Ctfuc2%20queryr%28int%20x%2Cint%20l%2Cint%20r%29%5Cn%5Ct%7B%5Cn%5Ct%5Ctif%28e%5Bx%2Blb%5D.l%3D%3Dl%26%26e%5Bx%2Blb%5D.r%3D%3Dr%29return%20%28fuc2%29%7Be%5Bx%2Blb%5D.rm%2Ce%5Bx%2Blb%5D.su%7D%3B%5Cn%5Ct%5Ctint%20mid%3D%28e%5Bx%2Blb%5D.l%2Be%5Bx%2Blb%5D.r%29%3E%3E1%3B%5Cn%5Ct%5Ctif%28mid%3E%3Dr%29return%20queryr%28x%3C%3C1%2Cl%2Cr%29%3B%5Cn%5Ct%5Ctelse%20if%28mid%3Cl%29return%20queryr%28x%3C%3C1%7C1%2Cl%2Cr%29%3B%5Cn%5Ct%5Ctelse%5Cn%5Ct%5Ct%7B%5Cn%5Ct%5Ct%5Ctfuc2%20a%3Dqueryr%28x%3C%3C1%2Cl%2Cmid%29%2Cb%3Dqueryr%28x%3C%3C1%7C1%2Cmid%2B1%2Cr%29%3B%5Cn%5Ct%5Ct%5Ctreturn%20%28fuc2%29%7Ba.a%2Ba.b%2Ab.a%2Ca.b%2Ab.b%7D%3B%5Cn%5Ct%5Ct%7D%5Cn%5Ct%7D%5Cn%5Ctvoid%20init%28int%20id%2Cint%20n%29%5Cn%5Ct%7B%5Cn%5Ct%5Ctlb%3D%2B%2Bct1%3B%5Cn%5Ct%5Ctbuild%281%2C1%2Cn%2Cid%29%3B%5Cn%5Ct%5Ctct1%2B%3Dn%2A4%2B1%3B%5Cn%5Ct%7D%5Cn%7Ds%5BN%5D%3B%5Cnstruct%20divide%7B%5Cn%5Ctmap%3Clong%20long%2Clong%20long%3E%20tp%3B%5Cn%5Ctint%20id1%2Cas1%2Cas2%2Cv1%2Cn1%3B%5Cn%5Ctpair%3Cint%2Cint%3E%20fz%28int%20l%2Cint%20r%29%5Cn%5Ct%7B%5Cn%5Ct%5Ctif%28l%3D%3Dr%29%5Cn%5Ct%5Ct%7B%5Cn%5Ct%5Ct%5Ctfuc1%20tp1%3Ds%5Bid1%5D.queryl%281%2Cl%2Cl%29%3B%5Cn%5Ct%5Ct%5Cttp%5B1ll%2Al%2A10000000%2Br%5D%3D1ll%2Atp1.a.s%5B0%5D%2A1000000000%2Btp1.a.s%5B1%5D%3B%5Cn%5Ct%5Ct%5Ctreturn%20make_pair%28tp1.a.s%5B0%5D%2Ctp1.a.s%5B1%5D%29%3B%5Cn%5Ct%5Ct%7D%5Cn%5Ct%5Ctint%20mid%3D%28l%2Br%29%3E%3E1%3B%5Cn%5Ct%5Ctfuc1%20tp1%3Ds%5Bid1%5D.queryl%281%2Cl%2Cmid%29%3B%5Cn%5Ct%5Ctfuc2%20tp2%3Ds%5Bid1%5D.queryr%281%2Cmid%2B1%2Cr%29%3B%5Cn%5Ct%5Ctint%20s1%3D%281ll%2Atp1.a.s%5B0%5D%2Atp2.a.s%5B0%5D%5B0%5D%2B1ll%2Atp1.a.s%5B1%5D%2Atp2.a.s%5B1%5D%5B0%5D%29%25mod%2Cs2%3D%281ll%2Atp1.a.s%5B0%5D%2Atp2.a.s%5B0%5D%5B1%5D%2B1ll%2Atp1.a.s%5B1%5D%2Atp2.a.s%5B1%5D%5B1%5D%29%25mod%3B%5Cn%5Ct%5Cttp%5B1ll%2Al%2A10000000%2Br%5D%3D1ll%2As1%2A1000000000%2Bs2%3B%5Cn%5Ct%5Ctpair%3Cint%2Cint%3E%20as1%3Dfz%28l%2Cmid%29%2Cas2%3Dfz%28mid%2B1%2Cr%29%3B%5Cn%5Ct%5Cts1%3D%28%28long%20long%29s1%2Bas1.first%2Bas2.first%29%25mod%2Cs2%3D%28%28long%20long%29s2%2Bas1.second%2Bas2.second%29%25mod%3B%5Cn%5Ct%5Ctreturn%20make_pair%28s1%2Cs2%29%3B%5Cn%5Ct%7D%5Cn%5Ctvoid%20init%28int%20n%2Cint%20id%2Cint%20v%29%5Cn%5Ct%7B%5Cn%5Ct%5Cts%5Bid%5D.init%28id%2Cn%29%3B%5Cn%5Ct%5Ctas1%3Das2%3D0%3B%5Cn%5Ct%5Cttp.clear%28%29%3B%5Cn%5Ct%5Ctid1%3Did%3Bv1%3Dv%3Bn1%3Dn%3B%5Cn%5Ct%5Ctif%28v%3E1%29%7Bpair%3Cint%2Cint%3E%20t1%3Dfz%281%2Cv-1%29%3Bas1%3Dt1.first%2Cas2%3Dt1.second%3B%7D%5Cn%5Ct%5Ctif%28v%21%3Dn%29%7Bpair%3Cint%2Cint%3E%20t2%3Dfz%28v%2B1%2Cn%29%3Bas1%3D%28as1%2Bt2.first%29%25mod%2Cas2%3D%28as2%2Bt2.second%29%25mod%3B%7D%5Cn%5Ct%7D%5Cn%5Ctvoid%20modify%28int%20l%2Cint%20r%2Cint%20v%29%5Cn%5Ct%7B%5Cn%5Ct%5Ctlong%20long%20st1%3Dtp%5B1ll%2Al%2A10000000%2Br%5D%3B%5Cn%5Ct%5Ctas1%3D%28as1-st1%5C%2F1000000000%2Bmod%29%25mod%3B%5Cn%5Ct%5Ctas2%3D%28as2-st1%251000000000%2Bmod%29%25mod%3B%5Cn%5Ct%5Ctif%28l%3D%3Dr%29%7Bs%5Bid1%5D.modify%281%2Cl%2Cid1%29%3Bfuc1%20tp1%3Ds%5Bid1%5D.queryl%281%2Cl%2Cl%29%3Btp%5B1ll%2Al%2A10000000%2Br%5D%3D1ll%2Atp1.a.s%5B0%5D%2A1000000000%2Btp1.a.s%5B1%5D%3Bas1%3D%28as1%2Btp1.a.s%5B0%5D%29%25mod%3Bas2%3D%28as2%2Btp1.a.s%5B1%5D%29%25mod%3Breturn%3B%7D%5Cn%5Ct%5Ctint%20mid%3D%28l%2Br%29%3E%3E1%3B%5Cn%5Ct%5Ctif%28mid%3E%3Dv%29modify%28l%2Cmid%2Cv%29%3B%5Cn%5Ct%5Ctelse%20modify%28mid%2B1%2Cr%2Cv%29%3B%5Cn%5Ct%5Ctfuc1%20tp1%3Ds%5Bid1%5D.queryl%281%2Cl%2Cmid%29%3B%5Cn%5Ct%5Ctfuc2%20tp2%3Ds%5Bid1%5D.queryr%281%2Cmid%2B1%2Cr%29%3B%5Cn%5Ct%5Ctint%20s1%3D%281ll%2Atp1.a.s%5B0%5D%2Atp2.a.s%5B0%5D%5B0%5D%2B1ll%2Atp1.a.s%5B1%5D%2Atp2.a.s%5B1%5D%5B0%5D%29%25mod%2Cs2%3D%281ll%2Atp1.a.s%5B0%5D%2Atp2.a.s%5B0%5D%5B1%5D%2B1ll%2Atp1.a.s%5B1%5D%2Atp2.a.s%5B1%5D%5B1%5D%29%25mod%3B%5Cn%5Ct%5Cttp%5B1ll%2Al%2A10000000%2Br%5D%3D1ll%2As1%2A1000000000%2Bs2%3B%5Cn%5Ct%5Ctas1%3D%28as1%2Bs1%29%25mod%3B%5Cn%5Ct%5Ctas2%3D%28as2%2Bs2%29%25mod%3B%5Cn%5Ct%7D%5Cn%7Dd%5BN%5D%3B%5Cnstruct%20mat2%7Bint%20s%5B2%5D%5B4%5D%3Bfriend%20mat2%20operator%20%2A%28mat2%20a%2Cmat2%20b%29%5Cn%7Breturn%20%28mat2%29%7B%281ll%2Aa.s%5B0%5D%5B0%5D%2Ab.s%5B0%5D%5B0%5D%2B1ll%2Aa.s%5B0%5D%5B1%5D%2Ab.s%5B1%5D%5B0%5D%29%25mod%2C%281ll%2Aa.s%5B0%5D%5B0%5D%2Ab.s%5B0%5D%5B1%5D%2B1ll%2Aa.s%5B0%5D%5B1%5D%2Ab.s%5B1%5D%5B1%5D%29%25mod%2C%28a.s%5B0%5D%5B2%5D%2B1ll%2Aa.s%5B0%5D%5B1%5D%2Ab.s%5B1%5D%5B2%5D%2B1ll%2Aa.s%5B0%5D%5B0%5D%2Ab.s%5B0%5D%5B2%5D%29%25mod%2C%28a.s%5B0%5D%5B3%5D%2B1ll%2Aa.s%5B0%5D%5B1%5D%2Ab.s%5B1%5D%5B3%5D%2B1ll%2Aa.s%5B0%5D%5B0%5D%2Ab.s%5B0%5D%5B3%5D%29%25mod%2C%5Cn%281ll%2Aa.s%5B1%5D%5B0%5D%2Ab.s%5B0%5D%5B0%5D%2B1ll%2Aa.s%5B1%5D%5B1%5D%2Ab.s%5B1%5D%5B0%5D%29%25mod%2C%281ll%2Aa.s%5B1%5D%5B0%5D%2Ab.s%5B0%5D%5B1%5D%2B1ll%2Aa.s%5B1%5D%5B1%5D%2Ab.s%5B1%5D%5B1%5D%29%25mod%2C%28a.s%5B1%5D%5B2%5D%2B1ll%2Aa.s%5B1%5D%5B1%5D%2Ab.s%5B1%5D%5B2%5D%2B1ll%2Aa.s%5B1%5D%5B0%5D%2Ab.s%5B0%5D%5B2%5D%29%25mod%2C%28a.s%5B1%5D%5B3%5D%2B1ll%2Aa.s%5B1%5D%5B1%5D%2Ab.s%5B1%5D%5B3%5D%2B1ll%2Aa.s%5B1%5D%5B0%5D%2Ab.s%5B0%5D%5B3%5D%29%25mod%7D%3B%5Cn%7D%7D%3B%5Cnstruct%20node2%7Bint%20l%2Cr%3Bmat2%20sb%3B%7De2%5BN%2A4%5D%3B%5Cnstruct%20segt2%7B%5Cn%5Ctvoid%20pushup%28int%20x%29%7Be2%5Bx%5D.sb%3De2%5Bx%2A2%2B1%5D.sb%2Ae2%5Bx%2A2%5D.sb%3B%7D%5Cn%5Ctvoid%20update%28int%20x%29%5Cn%5Ct%7B%5Cn%5Ct%5Ctint%20s1%3De2%5Bx%5D.l%2Cst%3Dtid%5Bs1%5D%3B%5Cn%5Ct%5Ctmemset%28e2%5Bx%5D.sb.s%2C0%2Csizeof%28e2%5Bx%5D.sb.s%29%29%3B%5Cn%5Ct%5Ctif%28%21son%5Bst%5D%29return%3B%5Cn%5Ct%5Ctif%28sn%5Bst%5D.size%28%29%3D%3D1%29%5Cn%5Ct%5Cte2%5Bx%5D.sb.s%5B0%5D%5B0%5D%3De2%5Bx%5D.sb.s%5B1%5D%5B1%5D%3De2%5Bx%5D.sb.s%5B0%5D%5B2%5D%3De2%5Bx%5D.sb.s%5B1%5D%5B3%5D%3D1%3B%5Cn%5Ct%5Ctelse%20if%28lson%5Bst%5D%3D%3D1%29%5Cn%5Ct%5Ct%7B%5Cn%5Ct%5Ct%5Ctfuc2%20tp%3Ds%5Bst%5D.queryr%281%2C2%2Csn%5Bst%5D.size%28%29%5C%2F2%2B1%29%3B%5Cn%5Ct%5Ct%5Cte2%5Bx%5D.sb.s%5B0%5D%5B0%5D%3Dtp.b.s%5B0%5D%5B0%5D%3B%5Cn%5Ct%5Ct%5Cte2%5Bx%5D.sb.s%5B0%5D%5B1%5D%3Dtp.b.s%5B0%5D%5B1%5D%3B%5Cn%5Ct%5Ct%5Cte2%5Bx%5D.sb.s%5B1%5D%5B0%5D%3Dtp.b.s%5B1%5D%5B0%5D%3B%5Cn%5Ct%5Ct%5Cte2%5Bx%5D.sb.s%5B1%5D%5B1%5D%3Dtp.b.s%5B1%5D%5B1%5D%3B%5Cn%5Ct%5Ct%5Cte2%5Bx%5D.sb.s%5B0%5D%5B2%5D%3D%28tp.a.s%5B0%5D%5B0%5D%2B1%29%25mod%3B%5Cn%5Ct%5Ct%5Cte2%5Bx%5D.sb.s%5B0%5D%5B3%5D%3Dtp.a.s%5B0%5D%5B1%5D%3B%5Cn%5Ct%5Ct%5Cte2%5Bx%5D.sb.s%5B1%5D%5B2%5D%3Dtp.a.s%5B1%5D%5B0%5D%3B%5Cn%5Ct%5Ct%5Cte2%5Bx%5D.sb.s%5B1%5D%5B3%5D%3D%28tp.a.s%5B1%5D%5B1%5D%2B1%29%25mod%3B%5Cn%5Ct%5Ct%7D%5Cn%5Ct%5Ctelse%20if%28lson%5Bst%5D%3D%3Dsn%5Bst%5D.size%28%29%5C%2F2%2B1%29%5Cn%5Ct%5Ct%7B%5Cn%5Ct%5Ct%5Ctint%20tp%3Dsn%5Bst%5D%5Bsn%5Bst%5D.size%28%29-2%5D%3B%5Cn%5Ct%5Ct%5Ctfuc1%20tp1%3Ds%5Bst%5D.queryl%281%2C1%2Csn%5Bst%5D.size%28%29%5C%2F2%29%3B%5Cn%5Ct%5Ct%5Ctif%28tp%3D%3D-1%29%5Cn%5Ct%5Ct%5Ct%7B%5Cn%5Ct%5Ct%5Ct%5Cte2%5Bx%5D.sb.s%5B0%5D%5B0%5D%3D%28tp1.b.s%5B0%5D%5B0%5D%2Btp1.b.s%5B0%5D%5B1%5D%29%25mod%3B%5Cn%5Ct%5Ct%5Ct%5Cte2%5Bx%5D.sb.s%5B0%5D%5B1%5D%3D0%3B%5Cn%5Ct%5Ct%5Ct%5Cte2%5Bx%5D.sb.s%5B1%5D%5B0%5D%3Dtp1.b.s%5B0%5D%5B0%5D%3B%5Cn%5Ct%5Ct%5Ct%5Cte2%5Bx%5D.sb.s%5B1%5D%5B1%5D%3Dtp1.b.s%5B0%5D%5B1%5D%3B%5Cn%5Ct%5Ct%5Ct%5Cte2%5Bx%5D.sb.s%5B0%5D%5B2%5D%3D%28tp1.a.s%5B0%5D%2Btp1.a.s%5B1%5D%2B1%29%25mod%3B%5Cn%5Ct%5Ct%5Ct%5Cte2%5Bx%5D.sb.s%5B0%5D%5B3%5D%3D0%3B%5Cn%5Ct%5Ct%5Ct%5Cte2%5Bx%5D.sb.s%5B1%5D%5B2%5D%3Dtp1.a.s%5B0%5D%3B%5Cn%5Ct%5Ct%5Ct%5Cte2%5Bx%5D.sb.s%5B1%5D%5B3%5D%3D%28tp1.a.s%5B1%5D%2B1%29%25mod%3B%5Cn%5Ct%5Ct%5Ct%7D%5Cn%5Ct%5Ct%5Ctif%28tp%3D%3D-2%29%5Cn%5Ct%5Ct%5Ct%7B%5Cn%5Ct%5Ct%5Ct%5Cte2%5Bx%5D.sb.s%5B0%5D%5B0%5D%3Dtp1.b.s%5B0%5D%5B0%5D%3B%5Cn%5Ct%5Ct%5Ct%5Cte2%5Bx%5D.sb.s%5B0%5D%5B1%5D%3Dtp1.b.s%5B0%5D%5B1%5D%3B%5Cn%5Ct%5Ct%5Ct%5Cte2%5Bx%5D.sb.s%5B1%5D%5B0%5D%3D0%3B%5Cn%5Ct%5Ct%5Ct%5Cte2%5Bx%5D.sb.s%5B1%5D%5B1%5D%3D%28tp1.b.s%5B0%5D%5B0%5D%2Btp1.b.s%5B0%5D%5B1%5D%29%25mod%3B%5Cn%5Ct%5Ct%5Ct%5Cte2%5Bx%5D.sb.s%5B0%5D%5B2%5D%3D%28tp1.a.s%5B0%5D%2B1%29%25mod%3B%5Cn%5Ct%5Ct%5Ct%5Cte2%5Bx%5D.sb.s%5B0%5D%5B3%5D%3Dtp1.a.s%5B1%5D%3B%5Cn%5Ct%5Ct%5Ct%5Cte2%5Bx%5D.sb.s%5B1%5D%5B2%5D%3D0%3B%5Cn%5Ct%5Ct%5Ct%5Cte2%5Bx%5D.sb.s%5B1%5D%5B3%5D%3D%28tp1.a.s%5B1%5D%2Btp1.a.s%5B0%5D%2B1%29%25mod%3B%5Cn%5Ct%5Ct%5Ct%7D%5Cn%5Ct%5Ct%5Ctif%28tp%3D%3D-3%29%5Cn%5Ct%5Ct%5Ct%7B%5Cn%5Ct%5Ct%5Ct%5Cte2%5Bx%5D.sb.s%5B0%5D%5B0%5D%3Dtp1.b.s%5B0%5D%5B0%5D%3B%5Cn%5Ct%5Ct%5Ct%5Cte2%5Bx%5D.sb.s%5B0%5D%5B1%5D%3Dtp1.b.s%5B0%5D%5B1%5D%3B%5Cn%5Ct%5Ct%5Ct%5Cte2%5Bx%5D.sb.s%5B1%5D%5B0%5D%3Dtp1.b.s%5B0%5D%5B1%5D%3B%5Cn%5Ct%5Ct%5Ct%5Cte2%5Bx%5D.sb.s%5B1%5D%5B1%5D%3Dtp1.b.s%5B0%5D%5B0%5D%3B%5Cn%5Ct%5Ct%5Ct%5Cte2%5Bx%5D.sb.s%5B0%5D%5B2%5D%3D%28tp1.a.s%5B0%5D%2B1%29%25mod%3B%5Cn%5Ct%5Ct%5Ct%5Cte2%5Bx%5D.sb.s%5B0%5D%5B3%5D%3Dtp1.a.s%5B1%5D%3B%5Cn%5Ct%5Ct%5Ct%5Cte2%5Bx%5D.sb.s%5B1%5D%5B2%5D%3Dtp1.a.s%5B1%5D%3B%5Cn%5Ct%5Ct%5Ct%5Cte2%5Bx%5D.sb.s%5B1%5D%5B3%5D%3D%28tp1.a.s%5B0%5D%2B1%29%25mod%3B%5Cn%5Ct%5Ct%5Ct%7D%5Cn%5Ct%5Ct%7D%5Cn%5Ct%5Ctelse%5Cn%5Ct%5Ct%7B%5Cn%5Ct%5Ct%5Ctint%20tp%3Dsn%5Bst%5D%5B2%2Alson%5Bst%5D-3%5D%3B%5Cn%5Ct%5Ct%5Ctfuc1%20tp1%3Ds%5Bst%5D.queryl%281%2C1%2Clson%5Bst%5D-1%29%3B%5Cn%5Ct%5Ct%5Ctif%28tp%3D%3D-1%29%5Cn%5Ct%5Ct%5Ct%7B%5Cn%5Ct%5Ct%5Ct%5Cte2%5Bx%5D.sb.s%5B0%5D%5B0%5D%3D%28tp1.b.s%5B0%5D%5B0%5D%2Btp1.b.s%5B0%5D%5B1%5D%29%25mod%3B%5Cn%5Ct%5Ct%5Ct%5Cte2%5Bx%5D.sb.s%5B0%5D%5B1%5D%3D0%3B%5Cn%5Ct%5Ct%5Ct%5Cte2%5Bx%5D.sb.s%5B1%5D%5B0%5D%3Dtp1.b.s%5B0%5D%5B0%5D%3B%5Cn%5Ct%5Ct%5Ct%5Cte2%5Bx%5D.sb.s%5B1%5D%5B1%5D%3Dtp1.b.s%5B0%5D%5B1%5D%3B%5Cn%5Ct%5Ct%5Ct%5Cte2%5Bx%5D.sb.s%5B0%5D%5B2%5D%3D%28tp1.a.s%5B0%5D%2Btp1.a.s%5B1%5D%2B1%29%25mod%3B%5Cn%5Ct%5Ct%5Ct%5Cte2%5Bx%5D.sb.s%5B0%5D%5B3%5D%3D0%3B%5Cn%5Ct%5Ct%5Ct%5Cte2%5Bx%5D.sb.s%5B1%5D%5B2%5D%3Dtp1.a.s%5B0%5D%3B%5Cn%5Ct%5Ct%5Ct%5Cte2%5Bx%5D.sb.s%5B1%5D%5B3%5D%3D%28tp1.a.s%5B1%5D%2B1%29%25mod%3B%5Cn%5Ct%5Ct%5Ct%7D%5Cn%5Ct%5Ct%5Ctif%28tp%3D%3D-2%29%5Cn%5Ct%5Ct%5Ct%7B%5Cn%5Ct%5Ct%5Ct%5Cte2%5Bx%5D.sb.s%5B0%5D%5B0%5D%3Dtp1.b.s%5B0%5D%5B0%5D%3B%5Cn%5Ct%5Ct%5Ct%5Cte2%5Bx%5D.sb.s%5B0%5D%5B1%5D%3Dtp1.b.s%5B0%5D%5B1%5D%3B%5Cn%5Ct%5Ct%5Ct%5Cte2%5Bx%5D.sb.s%5B1%5D%5B0%5D%3D0%3B%5Cn%5Ct%5Ct%5Ct%5Cte2%5Bx%5D.sb.s%5B1%5D%5B1%5D%3D%28tp1.b.s%5B0%5D%5B0%5D%2Btp1.b.s%5B0%5D%5B1%5D%29%25mod%3B%5Cn%5Ct%5Ct%5Ct%5Cte2%5Bx%5D.sb.s%5B0%5D%5B2%5D%3D%28tp1.a.s%5B0%5D%2B1%29%25mod%3B%5Cn%5Ct%5Ct%5Ct%5Cte2%5Bx%5D.sb.s%5B0%5D%5B3%5D%3Dtp1.a.s%5B1%5D%3B%5Cn%5Ct%5Ct%5Ct%5Cte2%5Bx%5D.sb.s%5B1%5D%5B2%5D%3D0%3B%5Cn%5Ct%5Ct%5Ct%5Cte2%5Bx%5D.sb.s%5B1%5D%5B3%5D%3D%28tp1.a.s%5B1%5D%2Btp1.a.s%5B0%5D%2B1%29%25mod%3B%5Cn%5Ct%5Ct%5Ct%7D%5Cn%5Ct%5Ct%5Ctif%28tp%3D%3D-3%29%5Cn%5Ct%5Ct%5Ct%7B%5Cn%5Ct%5Ct%5Ct%5Cte2%5Bx%5D.sb.s%5B0%5D%5B0%5D%3Dtp1.b.s%5B0%5D%5B0%5D%3B%5Cn%5Ct%5Ct%5Ct%5Cte2%5Bx%5D.sb.s%5B0%5D%5B1%5D%3Dtp1.b.s%5B0%5D%5B1%5D%3B%5Cn%5Ct%5Ct%5Ct%5Cte2%5Bx%5D.sb.s%5B1%5D%5B0%5D%3Dtp1.b.s%5B0%5D%5B1%5D%3B%5Cn%5Ct%5Ct%5Ct%5Cte2%5Bx%5D.sb.s%5B1%5D%5B1%5D%3Dtp1.b.s%5B0%5D%5B0%5D%3B%5Cn%5Ct%5Ct%5Ct%5Cte2%5Bx%5D.sb.s%5B0%5D%5B2%5D%3D%28tp1.a.s%5B0%5D%2B1%29%25mod%3B%5Cn%5Ct%5Ct%5Ct%5Cte2%5Bx%5D.sb.s%5B0%5D%5B3%5D%3Dtp1.a.s%5B1%5D%3B%5Cn%5Ct%5Ct%5Ct%5Cte2%5Bx%5D.sb.s%5B1%5D%5B2%5D%3Dtp1.a.s%5B1%5D%3B%5Cn%5Ct%5Ct%5Ct%5Cte2%5Bx%5D.sb.s%5B1%5D%5B3%5D%3D%28tp1.a.s%5B0%5D%2B1%29%25mod%3B%5Cn%5Ct%5Ct%5Ct%7D%5Cn%5Ct%5Ct%5Ctmat2%20wa%3B%5Cn%5Ct%5Ct%5Ctfuc2%20tp2%3Ds%5Bst%5D.queryr%281%2Clson%5Bst%5D%2B1%2Csn%5Bst%5D.size%28%29%5C%2F2%2B1%29%3B%5Cn%5Ct%5Ct%5Ctwa.s%5B0%5D%5B0%5D%3D%281ll%2Ae2%5Bx%5D.sb.s%5B0%5D%5B0%5D%2Atp2.b.s%5B0%5D%5B0%5D%2B1ll%2Ae2%5Bx%5D.sb.s%5B0%5D%5B1%5D%2Atp2.b.s%5B1%5D%5B0%5D%29%25mod%3B%5Cn%5Ct%5Ct%5Ctwa.s%5B0%5D%5B1%5D%3D%281ll%2Ae2%5Bx%5D.sb.s%5B0%5D%5B0%5D%2Atp2.b.s%5B0%5D%5B1%5D%2B1ll%2Ae2%5Bx%5D.sb.s%5B0%5D%5B1%5D%2Atp2.b.s%5B1%5D%5B1%5D%29%25mod%3B%5Cn%5Ct%5Ct%5Ctwa.s%5B1%5D%5B0%5D%3D%281ll%2Ae2%5Bx%5D.sb.s%5B1%5D%5B0%5D%2Atp2.b.s%5B0%5D%5B0%5D%2B1ll%2Ae2%5Bx%5D.sb.s%5B1%5D%5B1%5D%2Atp2.b.s%5B1%5D%5B0%5D%29%25mod%3B%5Cn%5Ct%5Ct%5Ctwa.s%5B1%5D%5B1%5D%3D%281ll%2Ae2%5Bx%5D.sb.s%5B1%5D%5B0%5D%2Atp2.b.s%5B0%5D%5B1%5D%2B1ll%2Ae2%5Bx%5D.sb.s%5B1%5D%5B1%5D%2Atp2.b.s%5B1%5D%5B1%5D%29%25mod%3B%5Cn%5Ct%5Ct%5Ctwa.s%5B0%5D%5B2%5D%3D%281ll%2Ae2%5Bx%5D.sb.s%5B0%5D%5B2%5D%2A%28tp2.a.s%5B0%5D%5B0%5D%2B1%29%2B1ll%2Ae2%5Bx%5D.sb.s%5B0%5D%5B3%5D%2Atp2.a.s%5B1%5D%5B0%5D%29%25mod%3B%5Cn%5Ct%5Ct%5Ctwa.s%5B0%5D%5B3%5D%3D%281ll%2Ae2%5Bx%5D.sb.s%5B0%5D%5B2%5D%2Atp2.a.s%5B0%5D%5B1%5D%2B1ll%2Ae2%5Bx%5D.sb.s%5B0%5D%5B3%5D%2A%28tp2.a.s%5B1%5D%5B1%5D%2B1%29%29%25mod%3B%5Cn%5Ct%5Ct%5Ctwa.s%5B1%5D%5B2%5D%3D%281ll%2Ae2%5Bx%5D.sb.s%5B1%5D%5B2%5D%2A%28tp2.a.s%5B0%5D%5B0%5D%2B1%29%2B1ll%2Ae2%5Bx%5D.sb.s%5B1%5D%5B3%5D%2Atp2.a.s%5B1%5D%5B0%5D%29%25mod%3B%5Cn%5Ct%5Ct%5Ctwa.s%5B1%5D%5B3%5D%3D%281ll%2Ae2%5Bx%5D.sb.s%5B1%5D%5B2%5D%2Atp2.a.s%5B0%5D%5B1%5D%2B1ll%2Ae2%5Bx%5D.sb.s%5B1%5D%5B3%5D%2A%28tp2.a.s%5B1%5D%5B1%5D%2B1%29%29%25mod%3B%5Cn%5Ct%5Ct%5Cte2%5Bx%5D.sb%3Dwa%3B%5Cn%5Ct%5Ct%7D%5Cn%5Ct%7D%5Cn%5Ctvoid%20build%28int%20x%2Cint%20l%2Cint%20r%29%5Cn%5Ct%7B%5Cn%5Ct%5Cte2%5Bx%5D.l%3Dl%3Be2%5Bx%5D.r%3Dr%3B%5Cn%5Ct%5Ctif%28l%3D%3Dr%29%7Bupdate%28x%29%3Breturn%3B%7D%5Cn%5Ct%5Ctint%20mid%3D%28l%2Br%29%3E%3E1%3B%5Cn%5Ct%5Ctbuild%28x%3C%3C1%2Cl%2Cmid%29%3B%5Cn%5Ct%5Ctbuild%28x%3C%3C1%7C1%2Cmid%2B1%2Cr%29%3B%5Cn%5Ct%5Ctpushup%28x%29%3B%5Cn%5Ct%7D%5Cn%5Ctvoid%20modify%28int%20x%2Cint%20v%29%5Cn%5Ct%7B%5Cn%5Ct%5Ctif%28e2%5Bx%5D.l%3D%3De2%5Bx%5D.r%29%7Bupdate%28x%29%3Breturn%3B%7D%5Cn%5Ct%5Ctint%20mid%3D%28e2%5Bx%5D.l%2Be2%5Bx%5D.r%29%3E%3E1%3B%5Cn%5Ct%5Ctif%28mid%3E%3Dv%29modify%28x%3C%3C1%2Cv%29%3B%5Cn%5Ct%5Ctelse%20modify%28x%3C%3C1%7C1%2Cv%29%3B%5Cn%5Ct%5Ctpushup%28x%29%3B%5Cn%5Ct%7D%5Cn%5Ctmat2%20que%28int%20x%2Cint%20l%2Cint%20r%29%5Cn%5Ct%7B%5Cn%5Ct%5Ctif%28e2%5Bx%5D.l%3D%3Dl%26%26e2%5Bx%5D.r%3D%3Dr%29return%20e2%5Bx%5D.sb%3B%5Cn%5Ct%5Ctint%20mid%3D%28e2%5Bx%5D.l%2Be2%5Bx%5D.r%29%3E%3E1%3B%5Cn%5Ct%5Ctif%28mid%3E%3Dr%29return%20que%28x%3C%3C1%2Cl%2Cr%29%3B%5Cn%5Ct%5Ctelse%20if%28mid%3Cl%29return%20que%28x%3C%3C1%7C1%2Cl%2Cr%29%3B%5Cn%5Ct%5Ctelse%20return%20que%28x%3C%3C1%7C1%2Cmid%2B1%2Cr%29%2Aque%28x%3C%3C1%2Cl%2Cmid%29%3B%5Cn%5Ct%7D%5Cn%7Dtr%3B%5Cnchar%20str%5BN%2A10%5D%3B%5Cnint%20bel%5BN%2A10%5D%5B2%5D%2Cct3%3B%5Cnpair%3Cint%2Cint%3E%20calc1%28int%20x%29%5Cn%7B%5Cn%5Ctint%20i%3Dx%3B%5Cn%5Ctif%28sn%5Bi%5D.size%28%29%3E1%29%5Cn%5Ct%7B%5Cn%5Ct%5Ctfuc2%20tp%3Ds%5Bi%5D.queryr%281%2C2%2Csn%5Bi%5D.size%28%29%5C%2F2%2B1%29%3B%5Cn%5Ct%5Ctfuc1%20tp2%3Ds%5Bi%5D.queryl%281%2C1%2C1%29%3B%5Cn%5Ct%5Ctint%20as11%3D%281ll%2Atp2.a.s%5B0%5D%2Atp.b.s%5B0%5D%5B0%5D%2B1ll%2Atp2.a.s%5B1%5D%2Atp.b.s%5B1%5D%5B0%5D%29%25mod%2Cas21%3D%281ll%2Atp2.a.s%5B0%5D%2Atp.b.s%5B0%5D%5B1%5D%2B1ll%2Atp2.a.s%5B1%5D%2Atp.b.s%5B1%5D%5B1%5D%29%25mod%3B%5Cn%5Ct%5Ctas1%5Bi%5D%5B0%5D%3Das11%3Bas1%5Bi%5D%5B1%5D%3Das21%3B%5Cn%5Ct%5Ctreturn%20make_pair%28as11%2Cas21%29%3B%5Cn%5Ct%7D%5Cn%5Ctelse%5Cn%5Ct%7B%5Cn%5Ct%5Ctfuc1%20tp2%3Ds%5Bi%5D.queryl%281%2C1%2C1%29%3B%5Cn%5Ct%5Ctreturn%20make_pair%28tp2.a.s%5B0%5D%2Ctp2.a.s%5B1%5D%29%3B%5Cn%5Ct%7D%5Cn%7D%5Cnpair%3Cpair%3Cint%2Cint%3E%2Cpair%3Cint%2Cint%3E%20%3E%20calc2%28int%20x%29%5Cn%7B%5Cn%5Ctint%20st%3Ded1%5Bx%5D%3B%5Cn%5Ctif%28st%3D%3Dx%29%5Cn%5Ct%7B%5Cn%5Ct%5Ctpair%3Cint%2Cint%3E%20fuc1%3Dcalc1%28st%29%3B%5Cn%5Ct%5Ctint%20tp1%3Dd%5Bst%5D.as1%2Ctp2%3Dd%5Bst%5D.as2%3B%5Cn%5Ct%5Ctreturn%20make_pair%28make_pair%28tp1%2Ctp2%29%2Cfuc1%29%3B%5Cn%5Ct%7D%5Cn%5Ctmat2%20fuc%3Dtr.que%281%2Cid%5Bx%5D%2Cid%5Bst%5D-1%29%3B%5Cn%5Ctpair%3Cint%2Cint%3E%20fuc1%3Dcalc1%28st%29%3B%5Cn%5Ctint%20tp1%3Dd%5Bst%5D.as1%2Ctp2%3Dd%5Bst%5D.as2%3B%5Cn%5Ctreturn%20make_pair%28make_pair%28%28tp1%2B1ll%2Afuc1.first%2Afuc.s%5B0%5D%5B2%5D%2B1ll%2Afuc1.second%2Afuc.s%5B1%5D%5B2%5D%29%25mod%2C%28tp2%2B1ll%2Afuc1.first%2Afuc.s%5B0%5D%5B3%5D%2B1ll%2Afuc1.second%2Afuc.s%5B1%5D%5B3%5D%29%25mod%29%2C%5Cn%5Ctmake_pair%28%281ll%2Afuc1.first%2Afuc.s%5B0%5D%5B0%5D%2B1ll%2Afuc1.second%2Afuc.s%5B1%5D%5B0%5D%29%25mod%2C%281ll%2Afuc1.first%2Afuc.s%5B0%5D%5B1%5D%2B1ll%2Afuc1.second%2Afuc.s%5B1%5D%5B1%5D%29%25mod%29%29%3B%5Cn%7D%5Cnvoid%20init%28%29%5Cn%7B%5Cn%5Ctint%20le%3Dstrlen%28str%2B1%29%3B%5Cn%5Ctfor%28int%20i%3D1%3Bi%3C%3Dle%3Bi%2B%2B%29%5Cn%5Ct%7B%5Cn%5Ct%5Ctif%28str%5Bi%5D%3D%3D%27%28%27%29st%5B%2B%2Brb%5D%3D%2B%2Bct3%2Csn%5Bst%5Brb-1%5D%5D.push_back%28ct3%29%2Cadde%28ct3%2Cst%5Brb-1%5D%29%2Cfaid%5Bct3%5D%3Dsn%5Bst%5Brb-1%5D%5D.size%28%29%5C%2F2%2B1%2Cfa%5Bct3%5D%3Dst%5Brb-1%5D%3B%5Cn%5Ct%5Ctelse%20if%28str%5Bi%5D%3D%3D%27%29%27%29rb--%3B%5Cn%5Ct%5Ctelse%20if%28str%5Bi%5D%3D%3D%27%26%27%29sn%5Bst%5Brb%5D%5D.push_back%28-1%29%3B%5Cn%5Ct%5Ctelse%20if%28str%5Bi%5D%3D%3D%27%7C%27%29sn%5Bst%5Brb%5D%5D.push_back%28-2%29%3B%5Cn%5Ct%5Ctelse%20if%28str%5Bi%5D%3D%3D%27%5E%27%29sn%5Bst%5Brb%5D%5D.push_back%28-3%29%3B%5Cn%5Ct%5Ctelse%20if%28str%5Bi%5D%3D%3D%270%27%29sn%5Bst%5Brb%5D%5D.push_back%28-4%29%3B%5Cn%5Ct%5Ctelse%20if%28str%5Bi%5D%3D%3D%271%27%29sn%5Bst%5Brb%5D%5D.push_back%28-5%29%3B%5Cn%5Ct%5Ctelse%20sn%5Bst%5Brb%5D%5D.push_back%28-6%29%3B%5Cn%5Ct%5Ctbel%5Bi%5D%5B0%5D%3Dst%5Brb%5D%3B%5Cn%5Ct%5Ctbel%5Bi%5D%5B1%5D%3Dsn%5Bst%5Brb%5D%5D.size%28%29-1%3B%5Cn%5Ct%7D%5Cn%5Ctdfs1%281%2C0%29%3Bdfs2%281%2C1%2C0%29%3B%5Cn%5Ctfor%28int%20i%3D1%3Bi%3C%3Dct%3Bi%2B%2B%29if%28son%5Bi%5D%29%5Cn%5Ctfor%28int%20j%3D0%3Bj%3Csn%5Bi%5D.size%28%29%3Bj%2B%2B%29if%28sn%5Bi%5D%5Bj%5D%3D%3Dson%5Bi%5D%29lson%5Bi%5D%3Dj%5C%2F2%2B1%3B%5Cn%5Ctfor%28int%20i%3Dct%3Bi%3E%3D1%3Bi--%29%5Cn%5Ct%7B%5Cn%5Ct%5Cts%5Bi%5D.init%28i%2Csn%5Bi%5D.size%28%29%5C%2F2%2B1%29%3B%5Cn%5Ct%5Ctif%28sn%5Bi%5D.size%28%29%3E1%29%5Cn%5Ct%5Ct%7B%5Cn%5Ct%5Ct%5Ctfuc2%20tp%3Ds%5Bi%5D.queryr%281%2C2%2Csn%5Bi%5D.size%28%29%5C%2F2%2B1%29%3B%5Cn%5Ct%5Ct%5Ctfuc1%20tp2%3Ds%5Bi%5D.queryl%281%2C1%2C1%29%3B%5Cn%5Ct%5Ct%5Ctint%20as11%3D%281ll%2Atp2.a.s%5B0%5D%2Atp.b.s%5B0%5D%5B0%5D%2B1ll%2Atp2.a.s%5B1%5D%2Atp.b.s%5B1%5D%5B0%5D%29%25mod%2Cas21%3D%281ll%2Atp2.a.s%5B0%5D%2Atp.b.s%5B0%5D%5B1%5D%2B1ll%2Atp2.a.s%5B1%5D%2Atp.b.s%5B1%5D%5B1%5D%29%25mod%3B%5Cn%5Ct%5Ct%5Ctas1%5Bi%5D%5B0%5D%3Das11%3Bas1%5Bi%5D%5B1%5D%3Das21%3B%5Cn%5Ct%5Ct%7D%5Cn%5Ct%5Ctelse%5Cn%5Ct%5Ct%7B%5Cn%5Ct%5Ct%5Ctfuc1%20tp2%3Ds%5Bi%5D.queryl%281%2C1%2C1%29%3B%5Cn%5Ct%5Ct%5Ctas1%5Bi%5D%5B0%5D%3Dtp2.a.s%5B0%5D%2Cas1%5Bi%5D%5B1%5D%3Dtp2.a.s%5B1%5D%3B%5Cn%5Ct%5Ct%7D%5Cn%5Ct%7D%5Cn%5Cttr.build%281%2C1%2Cct3%29%3B%5Cn%5Ctfor%28int%20i%3D1%3Bi%3C%3Dct%3Bi%2B%2B%29%5Cn%5Ctd%5Bi%5D.init%28sn%5Bi%5D.size%28%29%5C%2F2%2B1%2Ci%2Clson%5Bi%5D%29%2Creal_ans%3D%28real_ans%2Bd%5Bi%5D.fz%281%2Csn%5Bi%5D.size%28%29%5C%2F2%2B1%29.second%29%25mod%3B%5Cn%5Ctfor%28int%20i%3D1%3Bi%3C%3Dct%3Bi%2B%2B%29if%28tp%5Bi%5D%3D%3Di%29%5Cn%5Ct%7B%5Cn%5Ct%5Ctpair%3Cpair%3Cint%2Cint%3E%2Cpair%3Cint%2Cint%3E%20%3E%20s2%3Dcalc2%28i%29%3B%5Cn%5Ct%5Ctas2%5Bi%5D%5B0%5D%3Ds2.first.first%3B%5Cn%5Ct%5Ctas2%5Bi%5D%5B1%5D%3Ds2.first.second%3B%5Cn%5Ct%7D%5Cn%7D%5Cnvoid%20modify%28int%20x%2Cint%20v%29%5Cn%7B%5Cn%5Ctint%20las%3Dv%3B%5Cn%5Ctwhile%28x%29%5Cn%5Ct%7B%5Cn%5Ct%5Ctif%28x%21%3Ded1%5Bx%5D%29real_ans%3D%28real_ans-d%5Bx%5D.as2%2Bmod%29%25mod%3B%5Cn%5Ct%5Ctif%28las%21%3Dlson%5Bx%5D%29%5Cn%5Ct%5Ctif%28las%3Clson%5Bx%5D%29d%5Bx%5D.modify%281%2Clson%5Bx%5D-1%2Clas%29%3B%5Cn%5Ct%5Ctelse%20d%5Bx%5D.modify%28lson%5Bx%5D%2B1%2Csn%5Bx%5D.size%28%29%5C%2F2%2B1%2Clas%29%3B%5Cn%5Ct%5Ctif%28x%21%3Ded1%5Bx%5D%29real_ans%3D%28real_ans%2Bd%5Bx%5D.as2%29%25mod%3B%5Cn%5Ct%5Cttr.modify%281%2Cid%5Bx%5D%29%3B%5Cn%5Ct%5Ctreal_ans%3D%28real_ans-as2%5Btp%5Bx%5D%5D%5B1%5D%2Bmod%29%25mod%3B%5Cn%5Ct%5Ctpair%3Cpair%3Cint%2Cint%3E%2Cpair%3Cint%2Cint%3E%20%3E%20tp2%3Dcalc2%28tp%5Bx%5D%29%3B%5Cn%5Ct%5Ctas1%5Btp%5Bx%5D%5D%5B0%5D%3Dtp2.second.first%3B%5Cn%5Ct%5Ctas1%5Btp%5Bx%5D%5D%5B1%5D%3Dtp2.second.second%3B%5Cn%5Ct%5Ctas2%5Btp%5Bx%5D%5D%5B0%5D%3Dtp2.first.first%3B%5Cn%5Ct%5Ctas2%5Btp%5Bx%5D%5D%5B1%5D%3Dtp2.first.second%3B%5Cn%5Ct%5Ctreal_ans%3D%28real_ans%2Bas2%5Btp%5Bx%5D%5D%5B1%5D%29%25mod%3B%5Cn%5Ct%5Ctx%3Dtp%5Bx%5D%3B%5Cn%5Ct%5Ctlas%3Dfaid%5Bx%5D%3B%5Cn%5Ct%5Ctx%3Dfa%5Bx%5D%3B%5Cn%5Ct%7D%5Cn%7D%5Cnsigned%20main%28%29%5Cn%7B%5Cn%5Ctstr%5B1%5D%3D%27%28%27%3B%5Cn%5Ctscanf%28%5C%22%25d%25s%5C%22%2C%26n%2Cstr%2B2%29%3B%5Cn%5Ctinit%28%29%3B%5Cn%5Ctwhile%28n--%29%5Cn%5Ct%7B%5Cn%5Ct%5Ctscanf%28%5C%22%25d%25s%5C%22%2C%26a%2Cstr%29%3Ba%2B%2B%3B%5Cn%5Ct%5Ctif%28str%5B0%5D%3D%3D%27%26%27%29sn%5Bbel%5Ba%5D%5B0%5D%5D%5Bbel%5Ba%5D%5B1%5D%5D%3D-1%3B%5Cn%5Ct%5Ctelse%20if%28str%5B0%5D%3D%3D%27%7C%27%29sn%5Bbel%5Ba%5D%5B0%5D%5D%5Bbel%5Ba%5D%5B1%5D%5D%3D-2%3B%5Cn%5Ct%5Ctelse%20if%28str%5B0%5D%3D%3D%27%5E%27%29sn%5Bbel%5Ba%5D%5B0%5D%5D%5Bbel%5Ba%5D%5B1%5D%5D%3D-3%3B%5Cn%5Ct%5Ctelse%20if%28str%5B0%5D%3D%3D%270%27%29sn%5Bbel%5Ba%5D%5B0%5D%5D%5Bbel%5Ba%5D%5B1%5D%5D%3D-4%3B%5Cn%5Ct%5Ctelse%20if%28str%5B0%5D%3D%3D%271%27%29sn%5Bbel%5Ba%5D%5B0%5D%5D%5Bbel%5Ba%5D%5B1%5D%5D%3D-5%3B%5Cn%5Ct%5Ctelse%20sn%5Bbel%5Ba%5D%5B0%5D%5D%5Bbel%5Ba%5D%5B1%5D%5D%3D-6%3B%5Cn%5Ct%5Ctmodify%28bel%5Ba%5D%5B0%5D%2C%28bel%5Ba%5D%5B1%5D%2B1%29%5C%2F2%2B1%29%3B%5Cn%5Ct%5Ctprintf%28%5C%22%25d%5C%5Cn%5C%22%2Creal_ans%29%3B%5Cn%5Ct%7D%5Cn%7D%22%2C%22tags%22%3A%5B3%2C108%2C149%2C228%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A38%2C%22totalAccepted%22%3A5%2C%22pid%22%3A%22P5565%22%2C%22title%22%3A%22%5BCeleste-B%5DFarewell%20to%20Mount%20Celeste%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22%5BCeleste-B%5DFarewell%20to%20Mount%20Celeste%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573295103;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>[Celeste-B]Farewell to Mount Celeste</h1>
<h2>题目背景</h2>
<div>> Sever the Skyline
> Black Moonrise
> Good Karma
> Golden Feather
> Mirror Magic
> Center of the Earth
> No More Running
> And...
> Say Goodbye.</div>
<h2>题目描述</h2>
<div>在分别的宴会上，朋友们拿出他们把多彩的珠子串成的彩色的项链。
项链在夕阳的余晖里闪闪发光，仔细一看，项链周围竟然已经聚集了许多鸟儿，鸟儿们带着 Madeline 与她的朋友们来到了一处他们不曾来过的地方，这里汇聚着好大一群鸟，似乎想要向他们表达些什么。
经过 Madeline 仔细地观察，它发现一些鸟儿们飞动的方式好像排成了一个有序的式子，而另一些鸟儿飞动的方式则是一些符号，符号表达着一个问题。
鸟儿们表达的问题是这样的：
鸟儿们组成的式子会由 `(`,`)`,`^`,`&`,`|`,`0`,`1` 和小写字母构成，并且是一个表达式。
其中：
- `(`,`)` 表示括号，在括号中的运算优先级提高。
- `&`,`|`,`^` 表示 `与`,`或`,`异或` 三种位运算，这三种运算**优先级相同**
- `0`,`1` 即为 `0`,`1`
- 小写字母表示变量，多次出现的同一小写字母表示**不同**的变量，一个变量取值 `0` 或 `1`
- 表达式的定义如下：
- 一个变量,`0`,`1` 均为表达式
- 若 $T$ 是表达式，则 $(T)$ 是表达式
- 若 $S$,$T$ 是表达式，则$S\&T$,$S|T$,$S\ \hat{}\ T$均为表达式
- 例如，$(1\ \hat{}\ 1\&0)$ 是一个表达式，并且运算结果为 $0$，但 $(1\&0$ 不是一个表达式
鸟儿们认为，要能算出 $1$ 的表达式才是优美的，定义一个表达式的优美度为在这个表达式所有 $v$ 个变量的 $2^v$ 种取值中能算出 $1$ 的方案数。
鸟儿们还认为，一个表达式的和谐度是这个表达式的所有**子连续表达式**的优美度的和。(包含自身)
鸟儿们还是善变的，它们会时不时改变一个位置的字符，但是它们向 Madeline 和她的朋友们保证它们不会改变括号，并且进行修改之后整个串仍然是一个表达式。
你能帮助 Madeline 和她的朋友们算出每次修改后整个表达式的和谐度吗？
鸟儿们还说，因为表达式可能太和谐了，因此 Madeline 可以只回答和谐度对 $998244353$ 取模后的值。</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>第一行为一个数 $m$ ,表示修改数
第二行为一个字符串，表示初始表达式
之后 $m$ 行，每一行一个数 $a$ 和一个字符 $b$ ，表示鸟儿们将 $a$ 位置字符变成 $b$
在输入的表达式中，一个小写字母代表一个变量。(注意一个字母可能出现多次，但代表**不同**变量)</div>
<h3>输出格式</h3>
<br />
<div>$m$ 行，第 $i$ 行为第 $i$ 次修改后的权值。由于和谐度可能很大，你需要对 $998244353$ 取模。</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>5
(1&amp;b)
3 |
2 a
3 &amp;
3 ^
4 1</code></pre>
<h3>输出样例 #1</h3>
<pre><code>6
8
4
6
4</code></pre>
<h3>输入样例 #2</h3>
<pre><code>10
1|a&amp;1&amp;(0&amp;0|1)&amp;1^1^a
1 0
10 1
2 &amp;
1 a
14 ^
4 |
17 0
4 ^
15 a
15 1
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>29
30
27
35
35
43
35
35
56
35</code></pre>
<h3>输入样例 #3</h3>
<pre><code>30
0|0&amp;0^(a&amp;a&amp;(1^0&amp;0^0)^0&amp;1)|0&amp;a|1|(a&amp;a|0|1|0^a&amp;0&amp;a|(a^0&amp;1|a|a)^a|a&amp;0&amp;0)^a
71 1
51 0
57 0
65 &amp;
26 |
5 a
71 a
56 |
4 &amp;
41 ^
52 |
52 ^
59 a
44 0
54 ^
65 &amp;
51 a
36 1
16 ^
1 1
52 ^
2 |
59 0
58 |
37 ^
55 1
10 1
26 ^
18 |
44 0
</code></pre>
<h3>输出样例 #3</h3>
<pre><code>21323
10686
5360
5360
5360
8469
16277
16277
16277
16277
16277
16277
16277
8223
8253
8253
16354
8359
8385
8394
8394
8394
4262
4262
4262
4262
2430
2430
2430
2430</code></pre>
<h3>输入样例 #4</h3>
<pre><code>20
a^1&amp;0^1^1&amp;1&amp;a&amp;1^a|1&amp;a|0&amp;a^a^1^a^0&amp;1^a&amp;a|a|1^0|a|0^1^a|0^0&amp;1&amp;1&amp;a&amp;a|0^0&amp;a&amp;1&amp;a|a&amp;a^a|0^a^a|a^1|a|1^a|0|a^0&amp;0&amp;0|a|a|a^0^1&amp;0^1&amp;a|1&amp;0
8 ^
28 |
100 ^
119 a
40 &amp;
105 1
31 1
125 1
53 1
98 &amp;
98 &amp;
98 &amp;
52 &amp;
2 ^
38 |
6 ^
58 ^
106 |
12 ^
57 1</code></pre>
<h3>输出样例 #4</h3>
<pre><code>957521426
957521583
874091659
57281108
57278566
140708493
120472431
120472431
561701787
551192201
551192201
551192201
551120577
551120577
551121853
551121853
551178140
656274015
656274025
656222855</code></pre>
<h2>说明</h2>
<div>设 $n$ 为表达式中变量和 $0,1$ 的个数，$len$ 为表达式长度
有subtask
对于 $ 5\% $ 的数据, $ n \leq 12 , len \leq 50 , m \leq 50 $,1s
对于额外 $ 10\% $ 的数据, $ n \leq 150,len \leq 400,m \leq 200$
对于额外 $ 10\% $ 的数据, $ n \leq 10^5,len \leq 2\times 10^5,m \leq 10$ ,没有括号
对于额外 $ 10\% $ 的数据, $ n \leq 10^5,len \leq 2\times 10^5,m \leq 10^5 $ ,没有括号
对于前 $ 50\% $ 的数据, $ n \leq 10^5,len \leq 4\times 10^5,m \leq 10^5 $ ,保证括号随机生成
对于 $ 100\% $ 的数据, $ n \leq 10^5,len \leq 4\times 10^5,m \leq 10^5 ,len-2\times n \leq 2 \times 10^5$
对于后 $ 95\% $ 的数据，时限为3s
upd:时限改为前25%1s，后75%4.25s(如果有人前25%被卡请私信我)</div>
</article>
</div>
</div>
</body>
</html>
