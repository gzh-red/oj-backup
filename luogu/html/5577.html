<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>[CmdOI2019]算力训练 - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573382771:uRyIjo5XwOZqjgJhFtF4ifl4K4geObYyNi8AQG97MXE=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%28%5Cu672c%5Cu9898%5Cu65f6%5Cu9650%5Cu7ecf%5Cu8fc7%5Cu8f83%5Cu5927%5Cu8c03%5Cu6574%2C%5Cu4f46%5Cu8fd8%5Cu662f%5Cu5728std%5Cu8017%5Cu65f6%5Cu76844%5Cu500d%5Cu4ee5%5Cu4e0a%2C%5Cu5982%5Cu679c%5Cu89c9%5Cu5f97%5Cu5361%5Cu5e38%5Cu6570%2C%5Cu53ef%5Cu4ee5%5Cu79c1%5Cu4fe1%5Cu51fa%5Cu9898%5Cu4eba%29%5Cn%5Cn%5Cu6700%5Cu8fd1%2C%5Cu51fa%5Cu9898%5Cu4eba%5Cu5feb%5Cu4e50%5Cu5730%5Cu5b66%5Cu4e60%5Cu4e86%5Cu5982%5Cu4f55%5Cu89e3%5Cu4e00%5Cu5143%5Cu4e8c%5Cu6b21%5Cu65b9%5Cu7a0b%5Cu3002%5Cn%5Cn%5Cu7136%5Cu800c%5Cu7531%5Cu4e8e%5Cu4e00%5Cu6574%5Cu4e2a%5Cu6691%5Cu5047%5Cu7684%5Cu6478%5Cu9c7c%2C%5Cu4ed6%5Cu7684%5Cu8ba1%5Cu7b97%5Cu80fd%5Cu529b%5Cu5947%5Cu5dee%5Cu65e0%5Cu6bd4%2C%5Cu628a%5Cu4e66%5Cu4e0a%5Cu7684%245%24%5Cu9053%5Cu4f8b%5Cu9898%5Cu7b97%5Cu9519%5Cu4e86%243%24%5Cu9053%5Cu3002%5Cn%5Cn%5Cu88ab%5Cu6012%5Cu65a5%5Cu4e86%5Cu4e00%5Cu756a%5C%22simple%5C%22%5Cu4e4b%5Cu540e%2C%5Cu4ed6%5Cu5f00%5Cu59cb%5Cu4e86%5Cu7b97%5Cu529b%5Cu8bad%5Cu7ec3%5Cu3002%22%2C%22description%22%3A%22%5Cu665a%5Cu4e0a%5Cu5728%5Cu5bbf%5Cu820d%5Cu91cc%2C%5Cu51fa%5Cu9898%5Cu4eba%5Cu68a6%5Cu89c1%5Cu4e86%5Cu4e00%5Cu4e2a%5Cu4f7f%5Cu7528%24k%24%5Cu8fdb%5Cu5236%5Cu7684%5Cu56fd%5Cu5ea6%2C%5Cu5165%5Cu4e61%5Cu968f%5Cu4fd7%5Cu561b%2C%5Cu51fa%5Cu9898%5Cu4eba%5Cu5728%5Cu8fd9%5Cu91cc%5Cu4e5f%5Cu4f7f%5Cu7528%24k%24%5Cu8fdb%5Cu5236%5Cu3002%5Cn%5Cn%5Cu5f53%5Cu7136%2C%5Cu8fd9%5Cu4e2a%5Cu56fd%5Cu5ea6%5Cu91cc%5Cu9762%5Cu7684%5Cu4eba%5Cu4e5f%5Cu61c2%5Cu6570%5Cu5b66%2C%5Cu6240%5Cu4ee5%5Cu51fa%5Cu9898%5Cu4eba%5Cu5e76%5Cu6ca1%5Cu6709%5Cu9003%5Cu6389%5Cu7b97%5Cu529b%5Cu8bad%5Cu7ec3%5Cu3002%5Cn%5Cn%5Cu4ed6%5Cu5728%5Cu7eb8%5Cu6761%5Cu4e0a%5Cu5199%5Cu4e86%24n%24%5Cu4e2a%24k%24%5Cu8fdb%5Cu5236%5Cu81ea%5Cu7136%5Cu6570%2C%5Cu7531%5Cu4e8e%5Cu4ed6%5Cu5f88%5Cu61d2%2C%5Cu8fd9%5Cu4e9b%5Cu6570%5Cu7684%5Cu4f4d%5Cu6570%5Cu4e0d%5Cu4f1a%5Cu592a%5Cu591a%2C%5Cu90fd%5Cu4e0d%5Cu4f1a%5Cu8d85%5Cu8fc7%24m%24%5Cu4f4d%5Cu3002%5Cn%5Cn%5Cu4e3a%5Cu4e86%5Cu8bad%5Cu7ec3%5Cu7b97%5Cu529b%2C%5Cu4ed6%5Cu6bcf%5Cu6b21%5Cu4f1a%2A%2A%5Cu968f%5Cu610f%5Cu53d6%5Cu51fa%5Cu4e00%5Cu4e2a%5Cu5b50%5Cu5e8f%5Cu5217%2A%2A%28%5Cu6ce8%5Cu610f%5Cu53ef%5Cu4ee5%5Cu4e00%5Cu4e2a%5Cu6570%5Cu90fd%5Cu4e0d%5Cu9009%29%2C%5Cu7136%5Cu540e%5Cu628a%5Cu8fd9%5Cu4e9b%5Cu6570%5Cu90fd%5Cu52a0%5Cu8d77%5Cu6765%5Cu3002%5Cn%5Cn%5Cu4ed6%5Cu53c8%5Cu89c9%5Cu5f97%5Cu8fdb%5Cu4f4d%5Cu592a%5Cu9ebb%5Cu70e6%5Cu4e86%2C%5Cu5e72%5Cu8106%5Cu89c4%5Cu5b9a%2A%2A%5Cu52a0%5Cu6cd5%5Cu4e0d%5Cu8fdb%5Cu4f4d%2A%2A%5Cu3002%5Cn%5Cn%5Cu7b97%5Cu4e86%5Cu51e0%5Cu6b21%5Cu4e4b%5Cu540e%2C%5Cu4ed6%5Cu7a81%5Cu7136%5Cu5f88%5Cu60f3%5Cu77e5%5Cu9053%5Cu81ea%5Cu5df1%5Cu5f97%5Cu5230%5Cu6bcf%5Cu4e2a%5Cu6570%5Cu7684%5Cu65b9%5Cu6848%5Cu6570%5Cu662f%5Cu591a%5Cu5c11%2C%5Cu53ef%5Cu662f%5Cu4ed6%5Cu592a%5Cu83dc%5Cu4e86%2C%5Cu53c8%5Cu4e0d%5Cu4f1a%5Cu7b97%2C%5Cu51a5%5Cu601d%5Cu82e6%5Cu60f3%5Cu4e00%5Cu756a%5Cu4e4b%5Cu540e%2C%5Cu7a81%5Cu7136%5Cu88ab%5Cu8d77%5Cu5e8a%5Cu94c3%5Cu62c9%5Cu51fa%5Cu4e86%5Cu68a6%5Cu5883%5Cu3002%5Cn%5Cn%5Cu4ed6%5Cu89c9%5Cu5f97%5Cu8fd9%5Cu4e2a%5Cu95ee%5Cu9898%5Cu5f88%5Cu6709%5Cu8da3%2C%5Cu53ea%5Cu597d%5Cu6c42%5Cu52a9%5Cu4e8e%5Cu5355%5Cu624b%5Cu8650%5Cu66b4%5Cu65e0%5Cu6570%5Cu4ee3%5Cu6570%5Cu9898%5Cu7684%5Cu4f60%2C%5Cu6765%5Cu5e2e%5Cu5fd9%5Cu8ba1%5Cu7b97%5Cu4e00%5Cu4e0b%5Cu3002%22%2C%22inputFormat%22%3A%22%5Cu7b2c%5Cu4e00%5Cu884c%5Cu4e09%5Cu4e2a%5Cu6574%5Cu6570%24n%2Ck%2Cm%24%2C%5Cu610f%5Cu4e49%5Cu4e3a%5Cu9898%5Cu76ee%5Cu4e2d%5Cu6240%5Cu8ff0%5Cu3002%5Cn%5Cn%5Cu7b2c%5Cu4e8c%5Cu884c%24n%24%5Cu4e2a%5Cu6574%5Cu6570%2C%5Cu4e4b%5Cu95f4%5Cu7528%5Cu7a7a%5Cu683c%5Cu9694%5Cu5f00%2C%5Cu8868%5Cu793a%5Cu7eb8%5Cu6761%5Cu4e0a%5Cu7684%5Cu6570%5Cu5b57%5Cu3002%5Cn%5Cn%28%2A%2A%5Cu6ce8%5Cu610f%2A%2A%2C%5Cu7eb8%5Cu6761%5Cu4e0a%5Cu7684%5Cu6570%5Cu5747%5Cu4e3a%24k%24%5Cu8fdb%5Cu5236%5Cu6570%29%22%2C%22outputFormat%22%3A%22%5Cu5171%24k%5Em%24%5Cu884c%2C%5Cu4f60%5Cu9700%5Cu8981%5Cu5728%5Cu7b2c%24i%24%5Cu884c%5Cu8f93%5Cu51fa%5Cu5f97%5Cu5230%24i-1%24%5Cu7684%5Cu65b9%5Cu6848%5Cu6570%5Cuff0c%5Cu6a21998244353%5Cu3002%22%2C%22samples%22%3A%5B%5B%223%205%201%5Cn1%202%203%22%2C%222%5Cn2%5Cn1%5Cn2%5Cn1%22%5D%2C%5B%22%5Cu89c1%20https%3A%5C%2F%5C%2Fwww.luogu.org%5C%2Fpaste%5C%2F66c0e63u%22%2C%22%5Cu89c1%20https%3A%5C%2F%5C%2Fwww.luogu.org%5C%2Fpaste%5C%2F66c0e63u%22%5D%2C%5B%22%5Cu89c1%20https%3A%5C%2F%5C%2Fwww.luogu.org%5C%2Fpaste%5C%2Fv1mi6fc5%22%2C%22%5Cu89c1%20https%3A%5C%2F%5C%2Fwww.luogu.org%5C%2Fpaste%5C%2Fv1mi6fc5%22%5D%5D%2C%22hint%22%3A%22%7C%20%5Cu6d4b%5Cu8bd5%5Cu70b9%5Cu7f16%5Cu53f7%20%7C%20%5Cu3000n%5Cu3000%20%7C%20%5Cu3000k%5Cu3000%20%7C%20%5Cu3000m%5Cu3000%20%7C%20%5Cu603b%5Cu5206%5Cu6570%20%7C%5Cn%7C%20%3A--%3A%20%7C%20%3A--%3A%20%7C%20%3A--%3A%20%7C%20%3A--%3A%20%7C%20%3A--%3A%20%7C%5Cn%7C%201%20%7C%2020%20%7C%205%20%7C%204%20%7C%205%20%7C%5Cn%7C%202%20%7C%201000%20%7C%205%20%7C%204%20%7C%205%20%7C%5Cn%7C%203~4%20%7C%20%2410%5E6%24%20%7C%205%20%7C%205%20%7C%2010%20%7C%5Cn%7C%205%20%7C%20%2410%5E6%24%20%7C%205%20%7C%206%20%7C%2010%20%7C%5Cn%7C%206~7%20%7C%20%2410%5E6%24%20%7C%205%20%7C%207%20%7C%2020%20%7C%5Cn%7C%208%20%7C%2020%20%7C%206%20%7C%204%20%7C%205%20%7C%5Cn%7C%209%20%7C%201000%20%7C%206%20%7C%204%20%7C%205%20%7C%5Cn%7C%2010~11%20%7C%20%2410%5E6%24%20%7C%206%20%7C%204%20%7C%2010%20%7C%5Cn%7C%2012~14%20%7C%20%2410%5E6%24%20%7C%206%20%7C%206%20%7C%2030%20%7C%5Cn%5Cn%2A%2A%5Cu6837%5Cu4f8b%5Cu89e3%5Cu91ca%3A%2A%2A%5Cn%5Cn%5Cu5bf9%5Cu4e8e%5Cu6837%5Cu4f8b1%5Cuff0c%5Cu5171%5Cu67098%5Cu79cd%5Cu9009%5Cu53d6%5Cu5b50%5Cu5e8f%5Cu5217%5Cu7684%5Cu65b9%5Cu6cd5%5Cuff1a%5Cn%5Cn1.%5Cu4ec0%5Cu4e48%5Cu90fd%5Cu4e0d%5Cu9009%5Cuff0c%5Cu548c%5Cu4e3a0%5Cn%5Cn2.%5Cu90091%5Cuff0c%5Cu548c%5Cu4e3a1%5Cn%5Cn3.%5Cu90092%5Cuff0c%5Cu548c%5Cu4e3a2%5Cn%5Cn4.%5Cu90093%5Cuff0c%5Cu548c%5Cu4e3a3%5Cn%5Cn5.%5Cu90091%2B2%5Cuff0c%5Cu548c%5Cu4e3a3%5Cn%5Cn6.%5Cu90091%2B3%5Cuff0c%5Cu548c%5Cu4e3a4%5Cn%5Cn7.%5Cu90092%2B3%5Cuff0c%5Cu548c%5Cu4e3a0%20%5Cuff08%5Cu7531%5Cu4e8e%5Cu662f5%5Cu8fdb%5Cu5236%5Cuff0c%5Cu672c%5Cu6765%5Cu8981%5Cu53d8%5Cu621010%5Cu7684%5Cuff0c%5Cu4f46%5Cu662f%5Cu4e0d%5Cu8fdb%5Cu4f4d%5Cu5c31%5Cu53ea%5Cu5269%5Cu4e0b0%5Cu4e86%5Cuff09%5Cn%5Cn8.%5Cu90091%2B2%2B3%5Cuff0c%5Cu548c%5Cu4e3a1%5Cn%5Cn%5Cu7efc%5Cu4e0a%5Cuff0c%5Cu5f97%5Cu5230%600%2C1%2C2%2C3%2C4%60%5Cu7684%5Cu65b9%5Cu6848%5Cu6570%5Cu5206%5Cu522b%5Cu662f%602%2C2%2C1%2C2%2C1%60%5Cu3002%22%2C%22provider%22%3A%7B%22uid%22%3A58705%2C%22name%22%3A%22command_block%22%2C%22slogan%22%3A%22%5Cu901d%5Cu53bb%5Cu5728%5Cu8ffd%5Cu5fc6%5Cu4e2d%5Cu5347%5Cu534e%5Cu4e3a%5Cu6c38%5Cu6052%5Cu3002%22%2C%22badge%22%3Anull%2C%22isAdmin%22%3Afalse%2C%22color%22%3A%22Red%22%2C%22ccfLevel%22%3A7%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B800%2C800%2C800%2C800%2C800%2C800%2C800%2C800%2C800%2C800%2C800%2C800%2C800%2C800%5D%2C%22memory%22%3A%5B128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22tags%22%3A%5B326%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A146%2C%22totalAccepted%22%3A15%2C%22pid%22%3A%22P5577%22%2C%22title%22%3A%22%5BCmdOI2019%5D%5Cu7b97%5Cu529b%5Cu8bad%5Cu7ec3%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A162737%2C%22title%22%3A%22%5Cu8fd9%5Cu662f%20k%5Em%20polylog%20%5Cu7684%5Cu505a%5Cu6cd5%5Cu5417%5Cuff1f%22%2C%22forum%22%3A%7B%22id%22%3A41221%2C%22name%22%3A%22P5577%20%5BCmdOI2019%5D%5Cu7b97%5Cu529b%5Cu8bad%5Cu7ec3%22%2C%22slug%22%3A%22P5577%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P1081%22%2C%22title%22%3A%22%5Cu5f00%5Cu8f66%5Cu65c5%5Cu884c%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P2507%22%2C%22title%22%3A%22%5BSCOI2008%5D%5Cu914d%5Cu5bf9%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P4022%22%2C%22title%22%3A%22%5BCTSC2012%5D%5Cu719f%5Cu6089%5Cu7684%5Cu6587%5Cu7ae0%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P5373%22%2C%22title%22%3A%22%5Cu3010%5Cu6a21%5Cu677f%5Cu3011%5Cu591a%5Cu9879%5Cu5f0f%5Cu590d%5Cu5408%5Cu51fd%5Cu6570%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P5576%22%2C%22title%22%3A%22%5BCmdOI2019%5D%5Cu53e3%5Cu5934%5Cu7985%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22%5BCmdOI2019%5D%5Cu7b97%5Cu529b%5Cu8bad%5Cu7ec3%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573286098;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>[CmdOI2019]算力训练</h1>
<h2>题目背景</h2>
<div>(本题时限经过较大调整,但还是在std耗时的4倍以上,如果觉得卡常数,可以私信出题人)
最近,出题人快乐地学习了如何解一元二次方程。
然而由于一整个暑假的摸鱼,他的计算能力奇差无比,把书上的$5$道例题算错了$3$道。
被怒斥了一番"simple"之后,他开始了算力训练。</div>
<h2>题目描述</h2>
<div>晚上在宿舍里,出题人梦见了一个使用$k$进制的国度,入乡随俗嘛,出题人在这里也使用$k$进制。
当然,这个国度里面的人也懂数学,所以出题人并没有逃掉算力训练。
他在纸条上写了$n$个$k$进制自然数,由于他很懒,这些数的位数不会太多,都不会超过$m$位。
为了训练算力,他每次会**随意取出一个子序列**(注意可以一个数都不选),然后把这些数都加起来。
他又觉得进位太麻烦了,干脆规定**加法不进位**。
算了几次之后,他突然很想知道自己得到每个数的方案数是多少,可是他太菜了,又不会算,冥思苦想一番之后,突然被起床铃拉出了梦境。
他觉得这个问题很有趣,只好求助于单手虐暴无数代数题的你,来帮忙计算一下。</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>第一行三个整数$n,k,m$,意义为题目中所述。
第二行$n$个整数,之间用空格隔开,表示纸条上的数字。
(**注意**,纸条上的数均为$k$进制数)</div>
<h3>输出格式</h3>
<br />
<div>共$k^m$行,你需要在第$i$行输出得到$i-1$的方案数，模998244353。</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>3 5 1
1 2 3</code></pre>
<h3>输出样例 #1</h3>
<pre><code>2
2
1
2
1</code></pre>
<h3>输入样例 #2</h3>
<pre><code>见 https://www.luogu.org/paste/66c0e63u</code></pre>
<h3>输出样例 #2</h3>
<pre><code>见 https://www.luogu.org/paste/66c0e63u</code></pre>
<h3>输入样例 #3</h3>
<pre><code>见 https://www.luogu.org/paste/v1mi6fc5</code></pre>
<h3>输出样例 #3</h3>
<pre><code>见 https://www.luogu.org/paste/v1mi6fc5</code></pre>
<h2>说明</h2>
<div>| 测试点编号 | 　n　 | 　k　 | 　m　 | 总分数 |
| :--: | :--: | :--: | :--: | :--: |
| 1 | 20 | 5 | 4 | 5 |
| 2 | 1000 | 5 | 4 | 5 |
| 3~4 | $10^6$ | 5 | 5 | 10 |
| 5 | $10^6$ | 5 | 6 | 10 |
| 6~7 | $10^6$ | 5 | 7 | 20 |
| 8 | 20 | 6 | 4 | 5 |
| 9 | 1000 | 6 | 4 | 5 |
| 10~11 | $10^6$ | 6 | 4 | 10 |
| 12~14 | $10^6$ | 6 | 6 | 30 |
**样例解释:**
对于样例1，共有8种选取子序列的方法：
1.什么都不选，和为0
2.选1，和为1
3.选2，和为2
4.选3，和为3
5.选1+2，和为3
6.选1+3，和为4
7.选2+3，和为0 （由于是5进制，本来要变成10的，但是不进位就只剩下0了）
8.选1+2+3，和为1
综上，得到`0,1,2,3,4`的方案数分别是`2,2,1,2,1`。</div>
</article>
</div>
</div>
</body>
</html>
