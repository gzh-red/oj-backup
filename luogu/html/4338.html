<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>[ZJOI2018]历史 - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573381295:SH64XJoEf8eLpzL+aie9iqProBkVDDpt09hIDuy42Rc=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%5Cu4e5d%5Cu6761%5Cu53ef%5Cu601c%5Cu662f%5Cu4e00%5Cu4e2a%5Cu70ed%5Cu7231%5Cu9605%5Cu8bfb%5Cu7684%5Cu5973%5Cu5b69%5Cu5b50%5Cu3002%22%2C%22description%22%3A%22%5Cu8fd9%5Cu4e2a%5Cu4e16%5Cu754c%5Cu6709%20n%20%5Cu4e2a%5Cu57ce%5Cu5e02%5Cuff0c%5Cu8fd9%20n%20%5Cu4e2a%5Cu57ce%5Cu5e02%5Cu88ab%5Cu6070%5Cu597d%20%24n-1%24%20%5Cu6761%5Cu53cc%5Cu5411%5Cu9053%5Cu8def%5Cu8054%5Cu901a%5Cuff0c%5Cu5373%5Cu4efb%5Cu610f%5Cu4e24%5Cu4e2a%5Cu57ce%5Cu5e02%5Cu90fd%5Cu53ef%5Cu4ee5%20%5Cu4e92%5Cu76f8%5Cu5230%5Cu8fbe%5Cu3002%5Cu540c%5Cu65f6%5Cu57ce%5Cu5e02%201%20%5Cu5750%5Cu843d%5Cu5728%5Cu4e16%5Cu754c%5Cu7684%5Cu4e2d%5Cu5fc3%5Cuff0c%5Cu5360%5Cu9886%5Cu4e86%5Cu8fd9%5Cu4e2a%5Cu57ce%5Cu5e02%5Cu5c31%5Cu79f0%5Cu9738%5Cu4e86%5Cu8fd9%5Cu4e2a%5Cu4e16%5Cu754c%5Cu3002%5Cn%5Cn%5Cu5728%5Cu6700%5Cu5f00%5Cu59cb%5Cuff0c%5Cu8fd9%20n%20%5Cu4e2a%5Cu57ce%5Cu5e02%5Cu90fd%5Cu4e0d%5Cu5728%5Cu4efb%5Cu4f55%5Cu56fd%5Cu5bb6%5Cu7684%5Cu63a7%5Cu5236%5Cu4e4b%5Cu4e0b%5Cuff0c%5Cu4f46%5Cu662f%5Cu968f%5Cu7740%5Cu793e%5Cu4f1a%5Cu7684%5Cu53d1%5Cu5c55%5Cuff0c%5Cu4e00%5Cu4e9b%5Cu57ce%5Cu5e02%5Cu4f1a%5Cu5d1b%20%5Cu8d77%5Cu5f62%5Cu6210%5Cu56fd%5Cu5bb6%5Cu5e76%5Cu593a%5Cu53d6%5Cu4e16%5Cu754c%5Cu7684%5Cu9738%5Cu6743%5Cu3002%5Cu4e3a%5Cu4e86%5Cu65b9%5Cu4fbf%5Cuff0c%5Cu6211%5Cu4eec%5Cu6807%5Cu8bb0%5Cu7b2c%20i%20%5Cu4e2a%5Cu57ce%5Cu5e02%5Cu5d1b%5Cu8d77%5Cu4ea7%5Cu751f%5Cu7684%5Cu56fd%5Cu5bb6%5Cu4e3a%5Cu7b2c%20i%20%5Cu4e2a%5Cu56fd%5Cu5bb6%5Cu3002%20%5Cu5728%5Cu7b2c%20i%20%5Cu4e2a%5Cu57ce%5Cu5e02%5Cu5d1b%5Cu8d77%5Cu7684%5Cu8fc7%5Cu7a0b%5Cu4e2d%5Cuff0c%5Cu7b2c%20i%20%5Cu4e2a%5Cu56fd%5Cu5bb6%5Cu4f1a%5Cu53d6%5Cu5f97%5Cu57ce%5Cu5e02%20i%20%5Cu5230%5Cu57ce%5Cu5e02%201%20%5Cu8def%5Cu5f84%5Cu4e0a%5Cu6240%5Cu6709%5Cu57ce%5Cu5e02%5Cu7684%5Cu63a7%5Cu5236%5Cu6743%5Cu3002%5Cn%5Cn%5Cu65b0%5Cu7684%5Cu57ce%5Cu5e02%5Cu7684%5Cu5d1b%5Cu8d77%5Cu5f80%5Cu5f80%5Cu610f%5Cu5473%5Cu7740%5Cu6218%5Cu4e89%5Cu4e0e%5Cu6b7b%5Cu4ea1%5Cuff0c%5Cu82e5%5Cu7b2c%20i%20%5Cu4e2a%5Cu56fd%5Cu5bb6%5Cu5728%5Cu5d1b%5Cu8d77%5Cu4e2d%5Cuff0c%5Cu9700%5Cu8981%5Cu53d6%5Cu5f97%5Cu4e00%5Cu4e2a%5Cu539f%5Cu672c%5Cu88ab%5Cu56fd%20%5Cu5bb6%20%24j%28j%20%5Cu2260%20i%29%24%20%5Cu63a7%5Cu5236%5Cu7684%5Cu57ce%5Cu5e02%5Cu7684%5Cu63a7%5Cu5236%5Cu6743%5Cuff0c%5Cu90a3%5Cu4e48%5Cu56fd%5Cu5bb6%20i%20%5Cu5c31%5Cu5fc5%5Cu987b%5Cu5411%5Cu56fd%5Cu5bb6%20j%20%5Cu5ba3%5Cu6218%5Cu5e76%5Cu8fdb%5Cu884c%5Cu6218%5Cu4e89%5Cu3002%5Cn%5Cn%5Cu73b0%5Cu5728%5Cuff0c%5Cu53ef%5Cu601c%5Cu77e5%5Cu9053%5Cu4e86%5Cuff0c%5Cu5728%5Cu5386%5Cu53f2%5Cu4e0a%5Cuff0c%5Cu7b2c%20i%20%5Cu4e2a%5Cu57ce%5Cu5e02%5Cu4e00%5Cu5171%5Cu5d1b%5Cu8d77%5Cu4e86%20%24a_i%24%20%5Cu6b21%5Cu3002%5Cu4f46%5Cu662f%5Cu8fd9%5Cu4e9b%5Cu4e8b%5Cu4ef6%5Cu53d1%5Cu751f%5Cu7684%5Cu76f8%5Cu5bf9%5Cu987a%20%5Cu5e8f%5Cu5df2%5Cu7ecf%5Cu65e0%5Cu4ece%5Cu8003%5Cu7a76%5Cu4e86%5Cuff0c%5Cu552f%5Cu4e00%5Cu7684%5Cu4fe1%5Cu606f%5Cu662f%5Cuff0c%5Cu5728%5Cu4e00%5Cu4e2a%5Cu57ce%5Cu5e02%5Cu5d1b%5Cu8d77%5Cu79f0%5Cu9738%5Cu4e16%5Cu754c%5Cu4e4b%5Cu524d%5Cuff0c%5Cu65b0%5Cu7684%5Cu57ce%5Cu5e02%5Cu662f%5Cu4e0d%5Cu4f1a%5Cu5d1b%5Cu8d77%5Cu7684%5Cu3002%20%5Cn%5Cn%5Cu6218%5Cu4e89%5Cu5bf9%5Cu4eba%5Cu6c11%5Cu6765%5Cu8bf4%5Cu662f%5Cu707e%5Cu96be%5Cu6027%5Cu7684%5Cu3002%5Cu53ef%5Cu601c%5Cu5b9a%5Cu4e49%5Cu4e00%5Cu6b21%5Cu5d1b%5Cu8d77%5Cu7684%5Cu707e%5Cu96be%5Cu5ea6%5Cu4e3a%5Cu5d1b%5Cu8d77%5Cu7684%5Cu8fc7%5Cu7a0b%5Cu4e2d%5Cu4f1a%5Cu548c%5Cu591a%5Cu5c11%5Cu4e0d%5Cu540c%5Cu7684%5Cu56fd%5Cu5bb6%5Cu8fdb%5Cu884c%5Cu6218%5Cu4e89%5Cuff08%5Cu548c%5Cu540c%5Cu4e00%5Cu4e2a%5Cu56fd%5Cu5bb6%5Cu8fdb%5Cu884c%5Cu591a%5Cu6b21%5Cu6218%5Cu4e89%5Cu53ea%5Cu4f1a%5Cu88ab%5Cu8ba1%5Cu5165%5Cu4e00%5Cu6b21%5Cuff09%5Cu3002%5Cu53ef%5Cu601c%5Cu60f3%5Cu8981%5Cu77e5%5Cu9053%5Cuff0c%5Cu5728%5Cu6240%5Cu6709%5Cu53ef%5Cu80fd%5Cu7684%5Cu5d1b%20%5Cu8d77%5Cu987a%5Cu5e8f%5Cu4e2d%5Cuff0c%5Cu707e%5Cu96be%5Cu5ea6%5Cu4e4b%5Cu548c%5Cu6700%5Cu5927%5Cu662f%5Cu591a%5Cu5c11%5Cu3002%5Cn%5Cn%5Cu540c%5Cu65f6%5Cuff0c%5Cu5728%5Cu8003%5Cu53e4%5Cu5b66%5Cu5bb6%5Cu7684%5Cu52aa%5Cu529b%5Cu4e0b%5Cuff0c%5Cu8d8a%5Cu6765%5Cu8d8a%5Cu591a%5Cu7684%5Cu5386%5Cu53f2%5Cu8d44%5Cu6599%5Cu88ab%5Cu53d1%5Cu6398%5Cu4e86%5Cu51fa%5Cu6765%5Cuff0c%5Cu6839%5Cu636e%5Cu8fd9%5Cu4e9b%5Cu65b0%5Cu7684%5Cu8d44%5Cu6599%5Cuff0c%5Cu53ef%5Cu601c%5Cu4f1a%5Cu5bf9%20%24a_i%24%20%5Cu8fdb%5Cu884c%5Cu4e00%5Cu4e9b%5Cu4fee%5Cu6b63%5Cu3002%5Cu5177%5Cu4f53%5Cu6765%5Cu8bf4%5Cuff0c%5Cu53ef%5Cu601c%5Cu4f1a%5Cu5bf9%20%24a_i%24%20%5Cu8fdb%5Cu884c%5Cu4e00%5Cu4e9b%5Cu64cd%5Cu4f5c%5Cuff0c%5Cu6bcf%5Cu6b21%5Cu4f1a%5Cu5c06%20%24a_x%24%20%5Cu52a0%5Cu4e0a%20w%5Cu3002%5Cu5979%5Cu5e0c%5Cu671b%20%5Cu5728%5Cu6bcf%5Cu6b21%5Cu4fee%5Cu6539%5Cu4e4b%5Cu540e%5Cuff0c%5Cu90fd%5Cu80fd%5Cu8ba1%5Cu7b97%5Cu5f97%5Cu5230%5Cu6700%5Cu5927%5Cu7684%5Cu707e%5Cu96be%5Cu5ea6%5Cu3002%5Cn%5Cn%5Cu7136%5Cu800c%5Cu53ef%5Cu601c%5Cu5bf9%5Cu590d%5Cu6742%5Cu7684%5Cu8ba1%5Cu7b97%5Cu5e76%5Cu4e0d%5Cu611f%5Cu5174%5Cu8da3%5Cuff0c%5Cu56e0%5Cu6b64%5Cu5979%5Cu60f3%5Cu8ba9%5Cu4f60%5Cu6765%5Cu5e2e%5Cu5979%5Cu8ba1%5Cu7b97%5Cu4e00%5Cu4e0b%5Cu8fd9%5Cu4e9b%5Cu6570%5Cu503c%5Cu3002%5Cn%5Cu5bf9%5Cu9898%5Cu9762%5Cu7684%5Cu4e00%5Cu4e9b%5Cu8865%5Cu5145%5Cuff1a%5Cn%5Cn-%20%5Cu540c%5Cu4e00%5Cu4e2a%5Cu57ce%5Cu5e02%5Cu591a%5Cu6b21%5Cu5d1b%5Cu8d77%5Cu5f62%5Cu6210%5Cu7684%5Cu56fd%5Cu5bb6%5Cu662f%5Cu540c%5Cu4e00%5Cu4e2a%5Cu56fd%5Cu5bb6%5Cuff0c%5Cu8fd9%5Cu610f%5Cu5473%5Cu7740%5Cu540c%5Cu4e00%5Cu4e2a%5Cu57ce%5Cu5e02%5Cu8fde%5Cu7eed%5Cu5d1b%5Cu8d77%5Cu4e24%5Cu6b21%5Cu662f%5Cu4e0d%5Cu4f1a%20%5Cu548c%5Cu4efb%5Cu4f55%5Cu56fd%5Cu5bb6%5Cu5f00%5Cu6218%5Cu7684%5Cuff1a%5Cu56e0%5Cu4e3a%5Cu8fd9%5Cu4e9b%5Cu57ce%5Cu5e02%5Cu539f%5Cu6765%5Cu5c31%5Cu5728%5Cu5b83%5Cu7684%5Cu63a7%5Cu5236%5Cu4e4b%5Cu4e0b%5Cu3002%5Cn-%20%5Cu5728%5Cu5386%5Cu53f2%5Cu7684%5Cu6f14%5Cu53d8%5Cu8fc7%5Cu7a0b%5Cu4e2d%5Cuff0c%5Cu7b2c%20i%20%5Cu4e2a%5Cu56fd%5Cu5bb6%5Cu53ef%5Cu80fd%5Cu4f1a%5Cu6709%5Cu4e00%5Cu6bb5%5Cu65f6%5Cu95f4%5Cu6ca1%5Cu6709%5Cu4efb%5Cu4f55%5Cu57ce%5Cu5e02%5Cu7684%5Cu63a7%5Cu5236%5Cu6743%5Cu3002%5Cu4f46%5Cu662f%5Cu8fd9%5Cu5e76%5Cu4e0d%20%5Cu610f%5Cu5473%5Cu7740%5Cu7b2c%20i%20%5Cu4e2a%5Cu56fd%5Cu5bb6%5Cu706d%5Cu4ea1%5Cu4e86%5Cuff0c%5Cu5728%5Cu57ce%5Cu5e02%20i%20%5Cu5d1b%5Cu8d77%5Cu7684%5Cu65f6%5Cu5019%5Cuff0c%5Cu7b2c%20i%20%5Cu4e2a%5Cu56fd%5Cu5bb6%5Cu4ecd%5Cu7136%5Cu4f1a%5Cu53d6%5Cu5f97%201%20%5Cu5230%20i%20%5Cu8def%5Cu5f84%5Cu4e0a%5Cu7684%5Cu57ce%5Cu5e02%5Cu7684%5Cu63a7%5Cu5236%5Cu6743%5Cu3002%22%2C%22inputFormat%22%3A%22%5Cu7b2c%5Cu4e00%5Cu884c%5Cu8f93%5Cu5165%5Cu4e24%5Cu4e2a%5Cu6574%5Cu6570%20n%2Cm%20%5Cu8868%5Cu793a%5Cu57ce%5Cu5e02%5Cu4e2a%5Cu6570%5Cu548c%5Cu64cd%5Cu4f5c%5Cu4e2a%5Cu6570%5Cu3002%20%5Cn%5Cn%5Cu7b2c%5Cu4e8c%5Cu884c%5Cu8f93%5Cu5165%20n%20%5Cu4e2a%5Cu6574%5Cu6570%5Cu8868%5Cu793a%20ai%20%5Cu7684%5Cu521d%5Cu59cb%5Cu503c%5Cu3002%20%5Cu63a5%5Cu4e0b%5Cu6765%20n%20%5Cu2212%201%20%5Cu884c%5Cuff0c%5Cu6bcf%5Cu884c%5Cu8f93%5Cu5165%5Cu4e24%5Cu4e2a%5Cu6574%5Cu6570%20%24u_i%2C%20v_i%281%5C%5Cleq%20ui%2C%20vi%20%5C%5Cleq%20n%29%24%20%5Cu63cf%5Cu8ff0%5Cu4e86%5Cu4e00%5Cu6761%5Cu9053%5Cu8def%5Cu3002%20%5Cn%5Cn%5Cu63a5%5Cu4e0b%5Cu6765%20m%20%5Cu884c%5Cu6bcf%5Cu884c%5Cu8f93%5Cu5165%5Cu4e24%5Cu4e2a%5Cu6574%5Cu6570%20%24x_i%24%2C%20%24w_i%24%20%5Cu8868%5Cu793a%5Cu5c06%20%24a_%7Bx_i%7D%24%5Cn%5Cu52a0%5Cu4e0a%20%24w_i%24%5Cu3002%22%2C%22outputFormat%22%3A%22%5Cu8f93%5Cu51fa%5Cu5171%20%24m%2B1%24%20%5Cu884c%5Cuff0c%5Cu7b2c%5Cu4e00%5Cu884c%5Cu8868%5Cu793a%5Cu521d%5Cu59cb%5Cu7684%20ai%20%5Cu7684%5Cu7b54%5Cu6848%5Cuff0c%5Cu63a5%5Cu4e0b%5Cu6765%20m%20%5Cu884c%5Cu6bcf%5Cu884c%5Cu8868%5Cu793a%5Cu8fd9%5Cu6b21%5Cu4fee%5Cu6b63%5Cu540e%5Cu7684%5Cu7b54%5Cu6848%5Cu3002%22%2C%22samples%22%3A%5B%5B%225%203%20%5Cn1%201%201%201%201%20%5Cn1%202%20%5Cn1%203%20%5Cn2%204%20%5Cn2%205%20%5Cn2%201%20%5Cn3%201%5Cn4%201%22%2C%226%20%5Cn7%20%5Cn9%5Cn10%22%5D%5D%2C%22hint%22%3A%22%5Cu5728%5Cu4fee%5Cu6b63%5Cu5f00%5Cu59cb%5Cu4e4b%5Cu524d%5Cuff0c%5Cu5982%5Cu679c%5Cu6309%5Cu7167%5Cu6240%5Cu5728%5Cu57ce%5Cu5e02%204%2C%201%2C%205%2C%203%2C%202%20%5Cu7684%5Cu987a%5Cu5e8f%5Cu5d1b%5Cu8d77%5Cuff0c%5Cu90a3%5Cu4e48%5Cu4f9d%5Cu6b21%5Cu4f1a%5Cu548c%200%2C%201%2C%202%2C%201%2C%202%20%5Cu4e2a%20%5Cu56fd%5Cu5bb6%5Cu8fdb%5Cu884c%5Cu6218%5Cu4e89%5Cu3002%5Cn%5Cn%5Cu8fd9%5Cu65f6%5Cu4e00%5Cu5171%5Cu4f1a%5Cu4ea7%5Cu751f%206%20%5Cu5bf9%5Cu654c%5Cu5bf9%5Cu5173%5Cu7cfb%5Cu3002%5Cu53ef%5Cu4ee5%5Cu8bc1%5Cu660e%5Cu8fd9%5Cu662f%5Cu6240%5Cu6709%5Cu5d1b%5Cu8d77%5Cu987a%5Cu5e8f%5Cu4e2d%5Cu7684%5Cu6700%5Cu5927%5Cu503c%5Cu3002%5Cn%5Cn%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fpic%5C%2F16016.png%29%22%2C%22provider%22%3A%7B%22uid%22%3A4223%2C%22name%22%3A%22jiry_2%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3Anull%2C%22isAdmin%22%3Afalse%2C%22color%22%3A%22Blue%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%2C2000%2C2000%2C2000%2C2000%2C2000%2C2000%2C2000%2C2000%2C2000%5D%2C%22memory%22%3A%5B512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22tags%22%3A%5B35%2C48%2C88%2C228%2C229%2C318%2C319%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A851%2C%22totalAccepted%22%3A319%2C%22pid%22%3A%22P4338%22%2C%22title%22%3A%22%5BZJOI2018%5D%5Cu5386%5Cu53f2%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A61564%2C%22title%22%3A%22RE%5Cu7684%5Cu770b%5Cu8fc7%5Cu6765%5Cuff01%22%2C%22forum%22%3A%7B%22id%22%3A24604%2C%22name%22%3A%22P4338%20%5BZJOI2018%5D%5Cu5386%5Cu53f2%22%2C%22slug%22%3A%22P4338%22%7D%7D%2C%7B%22id%22%3A61550%2C%22title%22%3A%22%5Cu6709%5Cu4ec0%5Cu4e48%5Cu529e%5Cu6cd5%5Cu561b%5Cuff1f%5Cuff1f%5Cuff1f%22%2C%22forum%22%3A%7B%22id%22%3A24604%2C%22name%22%3A%22P4338%20%5BZJOI2018%5D%5Cu5386%5Cu53f2%22%2C%22slug%22%3A%22P4338%22%7D%7D%2C%7B%22id%22%3A60957%2C%22title%22%3A%22BZOJ%5Cu548cUOJ%5Cu4e0aAC%5Cuff0c%5Cu6d1b%5Cu8c3780%5Cu5206%5Cuff0c%5Cu4e00%5Cu6761%5Cu94fe%5Cu7684%5Cu70b9RE%5Cu6389%22%2C%22forum%22%3A%7B%22id%22%3A24604%2C%22name%22%3A%22P4338%20%5BZJOI2018%5D%5Cu5386%5Cu53f2%22%2C%22slug%22%3A%22P4338%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P5354%22%2C%22title%22%3A%22%5BYnoi2017%5D%5Cu7531%5Cu4e43%5Cu7684OJ%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22SP16549%22%2C%22title%22%3A%22QTREE6%20-%20Query%20on%20a%20tree%20VI%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22SP%22%7D%2C%7B%22pid%22%3A%22P4337%22%2C%22title%22%3A%22%5BZJOI2018%5D%5Cu7ebf%5Cu56fe%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P4339%22%2C%22title%22%3A%22%5BZJOI2018%5D%5Cu8ff7%5Cu5bab%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P4707%22%2C%22title%22%3A%22%5Cu91cd%5Cu8fd4%5Cu73b0%5Cu4e16%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22%5BZJOI2018%5D%5Cu5386%5Cu53f2%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>[ZJOI2018]历史</h1>
<h2>题目背景</h2>
<div>九条可怜是一个热爱阅读的女孩子。</div>
<h2>题目描述</h2>
<div>这个世界有 n 个城市，这 n 个城市被恰好 $n-1$ 条双向道路联通，即任意两个城市都可以 互相到达。同时城市 1 坐落在世界的中心，占领了这个城市就称霸了这个世界。
在最开始，这 n 个城市都不在任何国家的控制之下，但是随着社会的发展，一些城市会崛 起形成国家并夺取世界的霸权。为了方便，我们标记第 i 个城市崛起产生的国家为第 i 个国家。 在第 i 个城市崛起的过程中，第 i 个国家会取得城市 i 到城市 1 路径上所有城市的控制权。
新的城市的崛起往往意味着战争与死亡，若第 i 个国家在崛起中，需要取得一个原本被国 家 $j(j ≠ i)$ 控制的城市的控制权，那么国家 i 就必须向国家 j 宣战并进行战争。
现在，可怜知道了，在历史上，第 i 个城市一共崛起了 $a_i$ 次。但是这些事件发生的相对顺 序已经无从考究了，唯一的信息是，在一个城市崛起称霸世界之前，新的城市是不会崛起的。
战争对人民来说是灾难性的。可怜定义一次崛起的灾难度为崛起的过程中会和多少不同的国家进行战争（和同一个国家进行多次战争只会被计入一次）。可怜想要知道，在所有可能的崛 起顺序中，灾难度之和最大是多少。
同时，在考古学家的努力下，越来越多的历史资料被发掘了出来，根据这些新的资料，可怜会对 $a_i$ 进行一些修正。具体来说，可怜会对 $a_i$ 进行一些操作，每次会将 $a_x$ 加上 w。她希望 在每次修改之后，都能计算得到最大的灾难度。
然而可怜对复杂的计算并不感兴趣，因此她想让你来帮她计算一下这些数值。
对题面的一些补充：
- 同一个城市多次崛起形成的国家是同一个国家，这意味着同一个城市连续崛起两次是不会 和任何国家开战的：因为这些城市原来就在它的控制之下。
- 在历史的演变过程中，第 i 个国家可能会有一段时间没有任何城市的控制权。但是这并不 意味着第 i 个国家灭亡了，在城市 i 崛起的时候，第 i 个国家仍然会取得 1 到 i 路径上的城市的控制权。</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>第一行输入两个整数 n,m 表示城市个数和操作个数。
第二行输入 n 个整数表示 ai 的初始值。 接下来 n − 1 行，每行输入两个整数 $u_i, v_i(1\leq ui, vi \leq n)$ 描述了一条道路。
接下来 m 行每行输入两个整数 $x_i$, $w_i$ 表示将 $a_{x_i}$
加上 $w_i$。</div>
<h3>输出格式</h3>
<br />
<div>输出共 $m+1$ 行，第一行表示初始的 ai 的答案，接下来 m 行每行表示这次修正后的答案。</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>5 3 
1 1 1 1 1 
1 2 
1 3 
2 4 
2 5 
2 1 
3 1
4 1</code></pre>
<h3>输出样例 #1</h3>
<pre><code>6 
7 
9
10</code></pre>
<h2>说明</h2>
<div>在修正开始之前，如果按照所在城市 4, 1, 5, 3, 2 的顺序崛起，那么依次会和 0, 1, 2, 1, 2 个 国家进行战争。
这时一共会产生 6 对敌对关系。可以证明这是所有崛起顺序中的最大值。
![](https://cdn.luogu.com.cn/upload/pic/16016.png)</div>
</article>
</div>
</div>
</body>
</html>
