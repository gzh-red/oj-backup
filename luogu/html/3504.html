<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>[POI2010]OWC-Sheep - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573376976:jR5pCOfTLP2s4IIqR7ONDRf7cvwzMAZcqK6IVsq4P2o=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%22%2C%22description%22%3A%22The%20habitants%20of%20the%20Byteotian%20Highland%20bred%20sheep%20for%20centuries.%5Cn%5CnEvery%20sane%20shepherd%20has%20a%20fenced%20pasture%20in%20the%20shape%20of%20a%20convex1%20polygon%20%20%20%20for%20the%20sheep%20to%20graze%20on.%5Cn%5CnEvery%20sane%20sheep%20in%20turn%20has%20its%20own%20favourite%20feeding%20spot%20on%20the%20pasture%20where%20it%20spends%20all%20days.%5Cn%5CnSometimes%20however%2C%20the%20sheep%20want%20to%20play.%20As%20they%20play%20in%20pairs%2C%20every%20shepherd%20keeps%20an%20even%20number%20of%20sheep%2C%20%20%20%20so%20that%20his%20every%20sheep%20has%20a%20partner%20to%20play%20with.%5Cn%5CnThe%20shepherds%20are%20concerned%20about%20a%20decree%20recently%20issued%20by%20the%20Byteburg%27s%20High%20Commissioner%20for%20Agriculture.%5Cn%5CnThe%20decree%20states%20that%20as%20of%20the%20next%20year%20the%20sheep%20can%20only%20graze%20on%20triangle-shaped%20pastures.%5Cn%5CnThus%20every%20shepherd%20whose%20pasture%20is%20an%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI17%5C%2Fowc-en-tex.1.png%29-gon%20for%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI17%5C%2Fowc-en-tex.2.png%29%20is%20to%20partition%20it%20into%20triangles%20by%20putting%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI17%5C%2Fowc-en-tex.3.png%29%20%20%20%20fences%20inside.%5Cn%5CnEach%20single%20new%20fence%2C%20of%20course%2C%20is%20going%20to%20be%20a%20segment%20connecting%20two%20vertices%20of%20the%20polygon%20%28pasture%29.%5Cn%5CnAdditionally%2C%20the%20fences%20can%20intersect%20only%20in%20these%20vertices.%5Cn%5CnA%20shepherd%20who%20does%20not%20fulfil%20these%20requirements%20will%20no%20longer%20be%20subsidized.%5Cn%5CnByteasar%2C%20as%20a%20shepherd%2C%20has%20to%20decide%20on%20a%20way%20of%20partitioning%20his%20pasture.%5Cn%5CnIn%20fact%2C%20he%20is%20unsure%20how%20many%20partitions%20are%20possible.%20He%20is%20only%20interested%20in%20such%20partitions%20%20%20%20that%20no%20fence%20is%20drawn%20through%20a%20favourite%20spot%20of%20any%20sheep%2C%20and%20such%20that%20every%20resulting%20triangle%20%20%20%20contains%20the%20favourite%20spots%20of%20an%20even%20number%20of%20sheep%2C%20so%20that%20these%20sheep%20can%20play%20in%20pairs.%5Cn%5CnHelp%20Byteasar%20by%20writing%20a%20program%20that%20calculates%20the%20number%20of%20such%20partitions%21%5Cn%22%2C%22inputFormat%22%3A%22The%20first%20line%20of%20the%20standard%20input%20contains%20three%20integers%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI17%5C%2Fowc-en-tex.4.png%29%2C%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI17%5C%2Fowc-en-tex.5.png%29%20and%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI17%5C%2Fowc-en-tex.6.png%29%20%20%20%20%28%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI17%5C%2Fowc-en-tex.7.png%29%2C%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI17%5C%2Fowc-en-tex.8.png%29%2C%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI17%5C%2Fowc-en-tex.9.png%29%2C%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI17%5C%2Fowc-en-tex.10.png%29%29%2C%20%20%20%20separated%20by%20single%20spaces%2C%20that%20denote%20respectively%3A%5Cn%5Cnthe%20number%20of%20vertices%20of%20the%20polygon%20forming%20the%20pasture%2C%20%20%20%20the%20number%20of%20the%20sheep%2C%20and%20a%20certain%20positive%20integer%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI17%5C%2Fowc-en-tex.11.png%29.%5Cn%5CnEach%20of%20the%20following%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI17%5C%2Fowc-en-tex.12.png%29%20lines%20contains%20two%20integers%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI17%5C%2Fowc-en-tex.13.png%29%20and%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI17%5C%2Fowc-en-tex.14.png%29%20%20%20%20%28%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI17%5C%2Fowc-en-tex.15.png%29%29%2C%20separated%20by%20a%20single%20space%2C%20%20%20%20de%5Cu2026%5Cn%22%2C%22outputFormat%22%3A%22Your%20program%20should%20print%20one%20integer%20on%20the%20standard%20output%2C%20%20%20%20namely%20the%20remainder%20of%20division%20by%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI17%5C%2Fowc-en-tex.22.png%29%20of%20the%20number%20of%20partitions%20of%20the%20pasture%20in%20triangles%2C%20%20%20%20such%20that%20no%20fence%20is%20drawn%20through%20a%20favourite%20spot%20of%20any%20sheep%2C%20and%20every%20resulting%20triangle%20%20%20%20contains%20the%20favourite%20spots%20of%20an%20even%20number%20of%20sheep.%5Cn%22%2C%22samples%22%3A%5B%5B%225%204%2010%5Cn5%205%5Cn3%200%5Cn-1%20-1%5Cn-3%204%5Cn1%2010%5Cn1%200%5Cn-1%200%5Cn1%206%5Cn-2%205%22%2C%223%22%5D%5D%2C%22hint%22%3A%22%244%5C%5Cle%20n%5C%5Cle%20600%24%5Cuff0c%242%5C%5Cle%20k%24%5Cuff0c%24m%5C%5Cle%2020%5C%5C%20000%24%5Cuff0c%242%5C%5Cmid%20k%24%5Cuff0c%24-15%5C%5C%20000%5C%5Cle%20x_i%2Cy_i%2Cp_i%2Cq_i%5C%5Cle%2015%5C%5C%20000%24%20%5Cuff0c%5Cu7267%5Cu573a%5Cu7684%5Cu9876%5Cu70b9%5Cu5750%5Cu6807%5Cu6309%5Cu987a%5Cu65f6%5Cu9488%5Cu987a%5Cu5e8f%5Cu7ed9%5Cu51fa%5Cuff0c%5Cu4fdd%5Cu8bc1%5Cu7f8a%5Cu4e25%5Cu683c%5Cu5728%5Cu591a%5Cu8fb9%5Cu5f62%5Cu5185%5Cu90e8%5Cu3002%20%5Cn%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B4000%2C4000%2C4000%2C4000%2C4000%2C4000%2C4000%2C4000%2C4000%2C4000%5D%2C%22memory%22%3A%5B128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22translation%22%3A%22%5Cu7ed9%5Cu4e00%5Cu4e2an%5Cu4e2a%5Cu70b9%5Cu7684%5Cu51f8%5Cu591a%5Cu8fb9%5Cu5f62%5Cuff0c%5Cu518d%5Cu7ed9%5Cu51fak%5Cu4e2a%5Cu5728%5Cu591a%5Cu8fb9%5Cu5f62%5Cu5185%5Cu7684%5Cu70b9%5Cuff0c%5Cu8981%5Cu6c42%5Cu4f60%5Cu628a%5Cu591a%5Cu8fb9%5Cu5f62%5Cu5212%5Cu5206%5Cu6210%5Cu4e09%5Cu89d2%5Cu5f62%5Cuff0c%5Cu4f7f%5Cu5f97%5Cu6bcf%5Cu4e2a%5Cu4e09%5Cu89d2%5Cu5f62%5Cu5185%5Cu90fd%5Cu6709%5Cu5076%5Cu6570%5Cu4e2a%5Cu70b9%5Cuff0c%5Cu4e14%5Cu4e09%5Cu89d2%5Cu5f62%5Cu8fb9%5Cu4e0a%5Cu4e0d%5Cu80fd%5Cu6709%5Cu70b9%5Cu3002%5Cn%22%2C%22tags%22%3A%5B3%2C27%2C57%2C319%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A54%2C%22totalAccepted%22%3A23%2C%22pid%22%3A%22P3504%22%2C%22title%22%3A%22%5BPOI2010%5DOWC-Sheep%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A39996%2C%22title%22%3A%22%5Cu8fd9%5Cu4e5f%5Cu592a%5Cu5361%5Cu5e38%5Cu4e86%5Cu5427%22%2C%22forum%22%3A%7B%22id%22%3A2590%2C%22name%22%3A%22P3504%20%5BPOI2010%5DOWC-Sheep%22%2C%22slug%22%3A%22P3504%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P2569%22%2C%22title%22%3A%22%5BSCOI2010%5D%5Cu80a1%5Cu7968%5Cu4ea4%5Cu6613%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P3177%22%2C%22title%22%3A%22%5BHAOI2015%5D%5Cu6811%5Cu4e0a%5Cu67d3%5Cu8272%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P3515%22%2C%22title%22%3A%22%5BPOI2011%5DLightning%20Conductor%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P3920%22%2C%22title%22%3A%22%5BWC2014%5D%5Cu7d2b%5Cu8346%5Cu82b1%5Cu4e4b%5Cu604b%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P5325%22%2C%22title%22%3A%22%5Cu3010%5Cu6a21%5Cu677f%5Cu3011Min_25%5Cu7b5b%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22%5BPOI2010%5DOWC-Sheep%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>[POI2010]OWC-Sheep</h1>
<h2>题意翻译</h2>
<div>给一个n个点的凸多边形，再给出k个在多边形内的点，要求你把多边形划分成三角形，使得每个三角形内都有偶数个点，且三角形边上不能有点。
</div>
<h2>题目描述</h2>
<div>The habitants of the Byteotian Highland bred sheep for centuries.
Every sane shepherd has a fenced pasture in the shape of a convex1 polygon for the sheep to graze on.
Every sane sheep in turn has its own favourite feeding spot on the pasture where it spends all days.
Sometimes however, the sheep want to play. As they play in pairs, every shepherd keeps an even number of sheep, so that his every sheep has a partner to play with.
The shepherds are concerned about a decree recently issued by the Byteburg's High Commissioner for Agriculture.
The decree states that as of the next year the sheep can only graze on triangle-shaped pastures.
Thus every shepherd whose pasture is an ![](http://main.edu.pl/images/OI17/owc-en-tex.1.png)-gon for ![](http://main.edu.pl/images/OI17/owc-en-tex.2.png) is to partition it into triangles by putting ![](http://main.edu.pl/images/OI17/owc-en-tex.3.png) fences inside.
Each single new fence, of course, is going to be a segment connecting two vertices of the polygon (pasture).
Additionally, the fences can intersect only in these vertices.
A shepherd who does not fulfil these requirements will no longer be subsidized.
Byteasar, as a shepherd, has to decide on a way of partitioning his pasture.
In fact, he is unsure how many partitions are possible. He is only interested in such partitions that no fence is drawn through a favourite spot of any sheep, and such that every resulting triangle contains the favourite spots of an even number of sheep, so that these sheep can play in pairs.
Help Byteasar by writing a program that calculates the number of such partitions!
</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line of the standard input contains three integers ![](http://main.edu.pl/images/OI17/owc-en-tex.4.png), ![](http://main.edu.pl/images/OI17/owc-en-tex.5.png) and ![](http://main.edu.pl/images/OI17/owc-en-tex.6.png) (![](http://main.edu.pl/images/OI17/owc-en-tex.7.png), ![](http://main.edu.pl/images/OI17/owc-en-tex.8.png), ![](http://main.edu.pl/images/OI17/owc-en-tex.9.png), ![](http://main.edu.pl/images/OI17/owc-en-tex.10.png)), separated by single spaces, that denote respectively:
the number of vertices of the polygon forming the pasture, the number of the sheep, and a certain positive integer ![](http://main.edu.pl/images/OI17/owc-en-tex.11.png).
Each of the following ![](http://main.edu.pl/images/OI17/owc-en-tex.12.png) lines contains two integers ![](http://main.edu.pl/images/OI17/owc-en-tex.13.png) and ![](http://main.edu.pl/images/OI17/owc-en-tex.14.png) (![](http://main.edu.pl/images/OI17/owc-en-tex.15.png)), separated by a single space, de…
</div>
<h3>输出格式</h3>
<br />
<div>Your program should print one integer on the standard output, namely the remainder of division by ![](http://main.edu.pl/images/OI17/owc-en-tex.22.png) of the number of partitions of the pasture in triangles, such that no fence is drawn through a favourite spot of any sheep, and every resulting triangle contains the favourite spots of an even number of sheep.
</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>5 4 10
5 5
3 0
-1 -1
-3 4
1 10
1 0
-1 0
1 6
-2 5</code></pre>
<h3>输出样例 #1</h3>
<pre><code>3</code></pre>
<h2>说明</h2>
<div>$4\le n\le 600$，$2\le k$，$m\le 20\ 000$，$2\mid k$，$-15\ 000\le x_i,y_i,p_i,q_i\le 15\ 000$ ，牧场的顶点坐标按顺时针顺序给出，保证羊严格在多边形内部。
</div>
</article>
</div>
</div>
</body>
</html>
