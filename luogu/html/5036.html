<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>随机生成树 - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573382112:KGEKFcqo4Ey6e/LhmYMAhOOw9lXLe8lat72HuJI43g8=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%40%5Cu845b%5Cu519b%20%5Cu6539%5Cu7f16%5Cu7684%5Cu6c34%5Cu9898%5Cn%5Cn%22%2C%22description%22%3A%22rainheavy%5Cu5728%5Cu7eb8%5Cu4e0a%5Cu753b%5Cu4e86N%5Cu4e2a%5Cu70b9%5Cuff08%5Cu4ece1%5Cu5230N%5Cu7f16%5Cu53f7%5Cuff09%5Cuff0c%5Cu6bcf%5Cu4e2a%5Cu70b9%5Cu7684%5Cu989c%5Cu8272%5Cu7528%5Cu4e00%5Cu4e2a%5Cu6574%5Cu6570%5Cu63cf%5Cu8ff0%5Cu3002rainheavy%5Cu51b3%5Cu5b9a%5Cu7528%5Cu8fd9N%5Cu4e2a%5Cu70b9%5Cu968f%5Cu673a%5Cu751f%5Cu6210%5Cu4e00%5Cu68f5%5Cu6811%5Cuff0c%5Cu751f%5Cu6210%5Cu7684%5Cu89c4%5Cu5219%5Cu5982%5Cu4e0b%5Cuff1a%5Cn%5Cn%5Cu5bf9%5Cu4e8e2%5Cu53f7%5Cu70b9%5Cu5230N%5Cu53f7%5Cu70b9%5Cuff0c%5Cu6bcf%5Cu4e2a%5Cu70b9%5Cu968f%5Cu673a%5Cu6307%5Cu5b9a%5Cu8fde%5Cu63a5%5Cu4e00%5Cu4e2a%5Cu70b9%5Cu3002i%5Cu53f7%5Cu70b9%282%20%3C%3D%20i%20%3C%3D%20N%29%5Cu7684%5Cu8fde%5Cu7684%5Cu70b9%5Cu5728i%5Cu7684%5Cu7ea6%5Cu6570%5Cu4e2d%5Cu548ci%5Cu7684%5Cu500d%5Cu6570%5Cu4e2d%5Cu4e0d%5Cu8d85%5Cu8fc7N%5Cu7684%5Cu4e2d%5Cu968f%5Cu673a%5Cu6311%5Cu9009%5Cu4e00%5Cu4e2a%5Cu3002%5Cuff08%5Cu4f8b%5Cu5982N%3D30%5Cu65f610%5Cu53f7%5Cu70b9%5Cu7684%5Cu53ef%5Cu4ee5%5Cu8fde%5Cu63a51%5Cu53f7%5Cuff0c2%5Cu53f7%5Cuff0c5%5Cu53f7%5Cuff0c20%5Cu53f7%5Cuff0c30%5Cu53f7%5Cuff09%5Cn%5Cn%5Cu751f%5Cu6210%5Cu7684%5Cu6811%5Cu4e2d%5Cu4e0d%5Cu80fd%5Cu6709%5Cu91cd%5Cu8fb9%5Cuff08%5Cu4e0d%5Cu7136%5Cu5c31%5Cu4e0d%5Cu53eb%5Cu6811%5Cu4e86%5Cuff09%5Cn%5Cn%5Cu6811%5Cu751f%5Cu6210%5Cu5b8c%5Cu4e4b%5Cu540e%5Cuff0crainheavy%5Cu53ef%5Cu4ee5%5Cu8ba1%5Cu7b97%5Cu51fa%5Cu8fd9%5Cu4e2a%5Cu6811%5Cu6709%5Cu591a%5Cu5c11%5Cu4e2a%5Cu8054%5Cu901a%5Cu5757%5Cuff0c%5Cu4e00%5Cu4e2a%5Cu8054%5Cu901a%5Cu5757%5Cu662f%5Cu4e00%5Cu4e9b%5Cu70b9%5Cu7684%5Cu96c6%5Cu5408%5Cuff0c%5Cu9700%5Cu8981%5Cu6ee1%5Cu8db3%5Cu4ee5%5Cu4e0b%5Cu4e24%5Cu4e2a%5Cu6761%5Cu4ef6%5Cuff1a%5Cn%5Cn1%5Cu3001%5Cu4ece%5Cu96c6%5Cu5408%5Cu4e2d%5Cu4efb%5Cu53d6%5Cu4e24%5Cu4e2a%5Cu70b9%5Cu90fd%5Cu6ee1%5Cu8db3%5Cuff1a%5Cu4e24%5Cu4e2a%5Cu70b9%5Cu989c%5Cu8272%5Cu76f8%5Cu540c%5Cuff0c%5Cu4e14%5Cu8fd9%5Cu4e24%5Cu4e2a%5Cu70b9%5Cu4e4b%5Cu95f4%5Cu5b58%5Cu5728%5Cu4e00%5Cu6761%5Cu6811%5Cu8fb9%5Cu7ec4%5Cu6210%5Cu7684%5Cu8def%5Cu5f84%5Cuff0c%5Cu8def%5Cu5f84%5Cu4e0a%5Cu7684%5Cu6240%5Cu6709%5Cu70b9%5Cu90fd%5Cu548c%5Cu8fd9%5Cu4e24%5Cu4e2a%5Cu70b9%5Cu989c%5Cu8272%5Cu76f8%5Cu540c%5Cn%5Cn2%5Cu3001%5Cu5bf9%5Cu4e8e%5Cu96c6%5Cu5408%5Cu4e2d%5Cu7684%5Cu4efb%5Cu610f%5Cu4e00%5Cu4e2a%5Cu70b9%5Cu548c%5Cu96c6%5Cu5408%5Cu5916%5Cu7684%5Cu4efb%5Cu610f%5Cu4e00%5Cu4e2a%5Cu70b9%5Cuff1a%5Cu4e24%5Cu70b9%5Cu8981%5Cu4e48%5Cu4e0d%5Cu540c%5Cu8272%5Cuff0c%5Cu8981%5Cu4e48%5Cu4e0d%5Cu5b58%5Cu5728%5Cu4e00%5Cu6761%5Cu6811%5Cu8fb9%5Cu7ec4%5Cu6210%5Cu7684%5Cu8def%5Cu5f84%5Cu4f7f%5Cu5f97%5Cu8def%5Cu5f84%5Cu4e0a%5Cu6240%5Cu6709%5Cu70b9%5Cu90fd%5Cu548c%5Cu8fd9%5Cu4e24%5Cu4e2a%5Cu70b9%5Cu540c%5Cu8272%5Cu3002%5Cn%5Cnrainheavy%5Cu5e0c%5Cu671b%5Cu8ba1%5Cu7b97%5Cu51fa%5Cu751f%5Cu6210%5Cu7684%5Cu6811%5Cu4e2d%5Cu8054%5Cu901a%5Cu5757%5Cu4e2a%5Cu6570%5Cu6700%5Cu591a%5Cu65f6%5Cuff0c%5Cu9700%5Cu8981%5Cu8fde%5Cu63a5%5Cu54ea%5Cu4e9b%5Cu8fb9%5Cuff0c%5Cu4f46%5Cu662frainheavy%5Cu592a%5Cu5f3a%5Cu4e86%5Cuff0c%5Cu4e0d%5Cu5c51%5Cu4e8e%5Cu505a%5Cu8fd9%5Cu79cd%5Cu8fa3%5Cu9e21%5Cu9898%5Cu76ee%5Cuff0c~~%5Cu66f4%5Cu91cd%5Cu8981%5Cu7684%5Cu662f%5Cu4ed6%5Cu8981%5Cu53bbAK%20IOI~~%5Cuff0c%5Cu4e8e%5Cu662f%5Cu5c31%5Cu628a%5Cu9898%5Cu76ee%5Cu6254%5Cu7ed9%5Cu4e86%5Cu4f60%5Cn%5Cn%5Cu6ce8%5Cuff1a%5Cu8fb9%5Cu7684%5Cu987a%5Cu5e8f%5Cn%5Cn1.%5Cu9996%5Cu5148%5Cuff0c%5Cu6ee1%5Cu8db3%5Cu8fde%5Cu901a%5Cu5757%5Cu4e2a%5Cu6570%5Cu6700%5Cu591a%5Cu7684%5Cu4f18%5Cu5148%5Cuff08%5Cu5373%5Cu5bf9%5Cu4e8e%5Cu751f%5Cu6210%5Cu8fde%5Cu901a%5Cu5757%5Cu6709%5Cu8d21%5Cu732e%5Cu7684%5Cu4f18%5Cu5148%5Cuff09%5Cn%5Cn2.%5Cu540c%5Cu6837%5Cu6ee1%5Cu8db3%5Cu6761%5Cu4ef61%5Cu65f6%5Cuff0c%5Cu8fde%5Cu63a5%5Cu7684%5Cu4e24%5Cu4e2a%5Cu70b9%5Cu7f16%5Cu53f7%5Cu4e4b%5Cu548c%5Cu8f83%5Cu5c0f%5Cu7684%5Cu8fb9%5Cu4f18%5Cu5148%5Cuff08%5Cu5982%5Cu6ee1%5Cu8db3%5Cu6761%5Cu4ef61%5Cu65f6%5Cuff0c%5Cu8fde%5Cu63a53%5Cu53f7%5Cu70b9%5Cu548c5%5Cu53f7%5Cu70b9%5Cu7684%5Cu8fb9%5Cu6bd4%5Cu8fde%5Cu63a54%5Cu53f7%5Cu70b9%5Cu548c5%5Cu53f7%5Cu70b9%5Cu7684%5Cu8fb9%5Cu4f18%5Cu5148%5Cuff09%5Cn%5Cn3.%5Cu540c%5Cu65f6%5Cu6ee1%5Cu8db3%5Cu6761%5Cu4ef62%5Cu65f6%5Cuff0c%5Cu8fde%5Cu63a5%5Cu7684%5Cu4e24%5Cu4e2a%5Cu70b9%5Cu7f16%5Cu53f7%5Cu7684%5Cu4e4b%5Cu4e2d%5Cu8f83%5Cu5c0f%5Cu7684%5Cu4e00%5Cu4e2a%5Cu8f83%5Cu5c0f%5Cu7684%5Cu8fb9%5Cu4f18%5Cu5148%5Cuff08%5Cu5982%5Cu6ee1%5Cu8db3%5Cu6761%5Cu4ef62%5Cu65f6%5Cuff0c%5Cu8fde%5Cu63a52%5Cu53f7%5Cu70b9%5Cu548c6%5Cu53f7%5Cu70b9%5Cu7684%5Cu8fb9%5Cu6bd4%5Cu8fde%5Cu63a53%5Cu53f7%5Cu70b9%5Cu548c5%5Cu53f7%5Cu70b9%5Cu7684%5Cu8fb9%5Cu4f18%5Cu5148%5Cuff09%22%2C%22inputFormat%22%3A%22%5Cu7b2c%5Cu4e00%5Cu884c%5Cu4e00%5Cu4e2a%5Cu6574%5Cu6570N%5Cu4ee3%5Cu8868%5Cu70b9%5Cu6570%5Cn%5Cn%5Cu7b2c%5Cu4e8c%5Cu884cN%5Cu4e2a%5Cu6574%5Cu6570%5Cuff0c%5Cu7b2ci%5Cu4e2a%5Cu6574%5Cu6570%24c_i%24%5Cu4ee3%5Cu8868%5Cu7b2ci%5Cu4e2a%5Cu70b9%5Cu7684%5Cu989c%5Cu8272%5Cn%22%2C%22outputFormat%22%3A%22%5Cu8f93%5Cu51fa%5Cu5171n-1%5Cu884c%5Cuff0c%5Cu6bcf%5Cu884c%5Cu4e24%5Cu4e2a%5Cu6574%5Cu6570x%2Cy%5Cu8868%5Cu793a%5Cu9700%5Cu8981%5Cu4e00%5Cu6761%5Cu8fb9%5Cu8fde%5Cu63a5%5Cu70b9x%5Cu548c%5Cu70b9y%5Cuff08%5Cu8981%5Cu6c42x%3Cy%5Cuff0c%5Cu4e14%5Cu8f93%5Cu51fa%5Cu7684%5Cu987a%5Cu5e8f%5Cu6ee1%5Cu8db3%5Cu9898%5Cu76ee%5Cu63cf%5Cu8ff0%5Cu4e2d%5Cu8fb9%5Cu7684%5Cu987a%5Cu5e8f%5Cuff09%5Cn%5CnTip%5Cuff1a%5Cu7531%5Cu4e8e%5Cu8f93%5Cu51fa%5Cu8f83%5Cu591a%5Cuff0c%5Cu5efa%5Cu8bae%5Cu7528%5Cu5feb%5Cu901f%5Cu8f93%5Cu51fa%5Cuff08%5Cu4e0d%5Cu4f1a%5Cu5c31%5Cu7b97%5Cu4e86%5Cu9876%5Cu591aT%5Cu6389%5Cu561b%5Cu5bf9%5Cu4e0d%5Cu5bf9%5Cuff09%22%2C%22samples%22%3A%5B%5B%224%5Cn3%202%203%202%22%2C%221%202%5Cn1%204%5Cn1%203%22%5D%5D%2C%22hint%22%3A%22%5Cu5bf9%5Cu4e8e%5Cu6837%5Cu4f8b%5Cu7684%5Cu89e3%5Cu91ca%5Cuff1a%5Cu56e0%5Cu4e3a2%5Cu53f7%5Cu30014%5Cu53f7%5Cu70b9%5Cu4f1a%5Cu5bf9%5Cu751f%5Cu6210%5Cu8054%5Cu901a%5Cu5757%5Cu6709%5Cu8d21%5Cu732e%5Cuff083%5Cu53f7%5Cu4f60%5Cu8fde%5Cu4e86%5Cu4e5f%5Cu6ca1%5Cu7528%5Cuff09%5Cuff0c%5Cu53c8%5Cu56e0%5Cu4e3a1%2B2%3C1%2B4%5Cuff0c%5Cu6240%5Cu4ee51%202%5Cu6bd41%204%5Cu4f18%5Cu5148%5Cu8f93%5Cu51fa%5Cuff0c%5Cu6700%5Cu540e%5Cu518d%5Cu8f93%5Cu51fa1%203%5Cn%5Cn%5Cn%5Cu5bf9%5Cu4e8e30%25%5Cu7684%5Cu6570%5Cu636e%2C%202%20%3C%3D%20N%20%3C%3D%2010%5Cn%5Cn%5Cu5bf9%5Cu4e8e60%25%5Cu7684%5Cu6570%5Cu636e%2C%202%20%3C%3D%20N%20%3C%3D%205000%5Cn%5Cn%5Cu5bf9%5Cu4e8e80%25%5Cu7684%5Cu6570%5Cu636e%2C%202%20%3C%3D%20N%20%3C%3D%20200000%5Cn%5Cn%5Cu5bf9%5Cu4e8e100%25%5Cu7684%5Cu6570%5Cu636e%2C%202%20%3C%3D%20N%20%3C%3D%20500000%5Cuff0c1%3C%3D%5Cu989c%5Cu8272%3C%3D1e9%5Cuff08%5Cu53cd%5Cu6b63%5Cu591a%5Cu4e86%5Cu4e5f%5Cu6ca1%5Cu7528%5Cuff09%22%2C%22provider%22%3A%7B%22uid%22%3A107547%2C%22name%22%3A%22%5Cu03c0%5Cu9171%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3Anull%2C%22isAdmin%22%3Afalse%2C%22color%22%3A%22Blue%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B3000%2C3000%2C3000%2C3000%2C3000%2C3000%2C3000%2C3000%2C3000%2C3000%5D%2C%22memory%22%3A%5B128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22tags%22%3A%5B1%2C111%2C175%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A187%2C%22totalAccepted%22%3A45%2C%22pid%22%3A%22P5036%22%2C%22title%22%3A%22%5Cu968f%5Cu673a%5Cu751f%5Cu6210%5Cu6811%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P3270%22%2C%22title%22%3A%22%5BJLOI2016%5D%5Cu6210%5Cu7ee9%5Cu6bd4%5Cu8f83%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P4111%22%2C%22title%22%3A%22%5BHEOI2015%5D%5Cu5c0fZ%5Cu7684%5Cu623f%5Cu95f4%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P4234%22%2C%22title%22%3A%22%5Cu6700%5Cu5c0f%5Cu5dee%5Cu503c%5Cu751f%5Cu6210%5Cu6811%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P5000%22%2C%22title%22%3A%22Hillwer%5Cu7f16%5Cu7801%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P5306%22%2C%22title%22%3A%22%5BCOCI2019%5D%20Transport%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22%5Cu968f%5Cu673a%5Cu751f%5Cu6210%5Cu6811%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>随机生成树</h1>
<h2>题目背景</h2>
<div>@葛军 改编的水题
</div>
<h2>题目描述</h2>
<div>rainheavy在纸上画了N个点（从1到N编号），每个点的颜色用一个整数描述。rainheavy决定用这N个点随机生成一棵树，生成的规则如下：
对于2号点到N号点，每个点随机指定连接一个点。i号点(2 <= i <= N)的连的点在i的约数中和i的倍数中不超过N的中随机挑选一个。（例如N=30时10号点的可以连接1号，2号，5号，20号，30号）
生成的树中不能有重边（不然就不叫树了）
树生成完之后，rainheavy可以计算出这个树有多少个联通块，一个联通块是一些点的集合，需要满足以下两个条件：
1、从集合中任取两个点都满足：两个点颜色相同，且这两个点之间存在一条树边组成的路径，路径上的所有点都和这两个点颜色相同
2、对于集合中的任意一个点和集合外的任意一个点：两点要么不同色，要么不存在一条树边组成的路径使得路径上所有点都和这两个点同色。
rainheavy希望计算出生成的树中联通块个数最多时，需要连接哪些边，但是rainheavy太强了，不屑于做这种辣鸡题目，~~更重要的是他要去AK IOI~~，于是就把题目扔给了你
注：边的顺序
1.首先，满足连通块个数最多的优先（即对于生成连通块有贡献的优先）
2.同样满足条件1时，连接的两个点编号之和较小的边优先（如满足条件1时，连接3号点和5号点的边比连接4号点和5号点的边优先）
3.同时满足条件2时，连接的两个点编号的之中较小的一个较小的边优先（如满足条件2时，连接2号点和6号点的边比连接3号点和5号点的边优先）</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>第一行一个整数N代表点数
第二行N个整数，第i个整数$c_i$代表第i个点的颜色
</div>
<h3>输出格式</h3>
<br />
<div>输出共n-1行，每行两个整数x,y表示需要一条边连接点x和点y（要求x<y，且输出的顺序满足题目描述中边的顺序） Tip：由于输出较多，建议用快速输出（不会就算了顶多T掉嘛对不对）</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>4
3 2 3 2</code></pre>
<h3>输出样例 #1</h3>
<pre><code>1 2
1 4
1 3</code></pre>
<h2>说明</h2>
<div>对于样例的解释：因为2号、4号点会对生成联通块有贡献（3号你连了也没用），又因为1+2<1+4，所以1 2比1 4优先输出，最后再输出1 3
对于30%的数据, 2 <= N <= 10
对于60%的数据, 2 <= N <= 5000
对于80%的数据, 2 <= N <= 200000
对于100%的数据, 2 <= N <= 500000，1<=颜色<=1e9（反正多了也没用）</div>
</article>
</div>
</div>
</body>
</html>
