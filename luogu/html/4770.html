<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>[NOI2018]你的名字 - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573381783:thHRW7OPaJOdGJ60u0+1Ma3MxpvzHhJ08VFwGPwdEno=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%5Cu5b9e%5Cu529b%5Cu5f3a%5Cu5927%5Cu7684%5Cu5c0fA%20%5Cu88ab%5Cu9009%5Cu4e3a%5Cu4e86ION2018%20%5Cu7684%5Cu51fa%5Cu9898%5Cu4eba%5Cuff0c%5Cu73b0%5Cu5728%5Cu4ed6%5Cu9700%5Cu8981%5Cu89e3%5Cu51b3%5Cu9898%5Cu76ee%5Cu7684%5Cu547d%5Cu540d%5Cu95ee%5Cu9898%5Cu3002%22%2C%22description%22%3A%22%5Cu5c0fA%20%5Cu88ab%5Cu9009%5Cu4e3a%5Cu4e86ION2018%20%5Cu7684%5Cu51fa%5Cu9898%5Cu4eba%5Cuff0c%5Cu4ed6%5Cu7cbe%5Cu5fc3%5Cu51c6%5Cu5907%5Cu4e86%5Cu4e00%5Cu9053%5Cu8d28%5Cu91cf%5Cu5341%5Cu5206%5Cu9ad8%5Cu7684%5Cu9898%5Cu76ee%5Cuff0c%5Cu4e14%5Cu5df2%5Cu7ecf%5Cu628a%5Cu9664%5Cu4e86%5Cu9898%5Cu76ee%5Cu547d%5Cu540d%5Cu4ee5%5Cu5916%5Cu7684%5Cu5de5%5Cu4f5c%5Cu90fd%5Cu505a%5Cu597d%5Cu4e86%5Cu3002%5Cn%5Cn%5Cu7531%5Cu4e8eION%20%5Cu5df2%5Cu7ecf%5Cu4e3e%5Cu529e%5Cu4e86%5Cu5f88%5Cu591a%5Cu5c4a%5Cuff0c%5Cu6240%5Cu4ee5%5Cu5728%5Cu9898%5Cu76ee%5Cu547d%5Cu540d%5Cu4e0a%5Cu4e5f%5Cu662f%5Cu6709%5Cu89c4%5Cu5b9a%5Cu7684%5Cuff0cION%20%5Cu547d%5Cu9898%5Cu624b%5Cu518c%5Cu89c4%5Cu5b9a%5Cuff1a%5Cu6bcf%5Cu5e74%5Cu7531%5Cu547d%5Cu9898%5Cu59d4%5Cu5458%5Cu4f1a%5Cu89c4%5Cu5b9a%5Cu4e00%5Cu4e2a%5Cu5c0f%5Cu5199%5Cu5b57%5Cu6bcd%5Cu5b57%5Cu7b26%5Cu4e32%5Cuff0c%5Cu6211%5Cu4eec%5Cu79f0%5Cu4e4b%5Cu4e3a%5Cu90a3%5Cu4e00%5Cu5e74%5Cu7684%5Cu547d%5Cu540d%5Cu4e32%5Cuff0c%5Cu8981%5Cu6c42%5Cu6bcf%5Cu9053%5Cu9898%5Cu7684%5Cu540d%5Cu5b57%5Cu5fc5%5Cu987b%5Cu662f%5Cu90a3%5Cu4e00%5Cu5e74%5Cu7684%5Cu547d%5Cu540d%5Cu4e32%5Cu7684%5Cu4e00%5Cu4e2a%5Cu975e%5Cu7a7a%5Cu8fde%5Cu7eed%5Cu5b50%5Cu4e32%5Cuff0c%5Cu4e14%5Cu4e0d%5Cu80fd%5Cu548c%5Cu524d%5Cu4e00%5Cu5e74%5Cu7684%5Cu4efb%5Cu4f55%5Cu4e00%5Cu9053%5Cu9898%5Cu76ee%5Cu7684%5Cu540d%5Cu5b57%5Cu76f8%5Cu540c%5Cu3002%5Cn%5Cn%5Cu7531%5Cu4e8e%5Cu4e00%5Cu4e9b%5Cu7279%5Cu6b8a%5Cu7684%5Cu539f%5Cu56e0%5Cuff0c%5Cu5c0fA%20%5Cu4e0d%5Cu77e5%5Cu9053ION2017%20%5Cu6bcf%5Cu9053%5Cu9898%5Cu7684%5Cu540d%5Cu5b57%5Cuff0c%5Cu4f46%5Cu662f%5Cu4ed6%5Cu901a%5Cu8fc7%5Cu4e00%5Cu4e9b%5Cu7279%5Cu6b8a%5Cu624b%5Cu6bb5%5Cu5f97%5Cu5230%5Cu4e86ION2017%20%5Cu7684%5Cu547d%5Cu540d%5Cu4e32%5Cuff0c%5Cu73b0%5Cu5728%5Cu5c0fA%20%5Cu6709Q%20%5Cu6b21%5Cu8be2%5Cu95ee%5Cuff1a%5Cu6bcf%5Cu6b21%5Cu7ed9%5Cu5b9aION2017%20%5Cu7684%5Cu547d%5Cu540d%5Cu4e32%5Cu548cION2018%20%5Cu7684%5Cu547d%5Cu540d%5Cu4e32%5Cuff0c%5Cu6c42%5Cu6709%5Cu51e0%5Cu79cd%5Cu9898%5Cu76ee%5Cu7684%5Cu547d%5Cu540d%5Cuff0c%5Cu4f7f%5Cu5f97%5Cu8fd9%5Cu4e2a%5Cu540d%5Cu5b57%5Cu4e00%5Cu5b9a%5Cu6ee1%5Cu8db3%5Cu547d%5Cu9898%5Cu59d4%5Cu5458%5Cu4f1a%5Cu7684%5Cu89c4%5Cu5b9a%5Cuff0c%5Cu5373%5Cu662fION2018%20%5Cu7684%5Cu547d%5Cu540d%5Cu4e32%5Cu7684%5Cu4e00%5Cu4e2a%5Cu975e%5Cu7a7a%5Cu8fde%5Cu7eed%5Cu5b50%5Cu4e32%5Cu4e14%5Cu4e00%5Cu5b9a%5Cu4e0d%5Cu4f1a%5Cu548cION2017%20%5Cu7684%5Cu4efb%5Cu4f55%5Cu4e00%5Cu9053%5Cu9898%5Cu76ee%5Cu7684%5Cu540d%5Cu5b57%5Cu76f8%5Cu540c%5Cu3002%5Cn%5Cn%5Cu7531%5Cu4e8e%5Cu4e00%5Cu4e9b%5Cu7279%5Cu6b8a%5Cu539f%5Cu56e0%5Cuff0c%5Cu6240%5Cu6709%5Cu8be2%5Cu95ee%5Cu7ed9%5Cu51fa%5Cu7684ION2017%20%5Cu7684%5Cu547d%5Cu540d%5Cu4e32%5Cu90fd%5Cu662f%5Cu67d0%5Cu4e2a%5Cu4e32%5Cu7684%5Cu8fde%5Cu7eed%5Cu5b50%5Cu4e32%5Cuff0c%5Cu8be6%5Cu7ec6%5Cu53ef%5Cu89c1%5Cu8f93%5Cu5165%5Cu683c%5Cu5f0f%5Cu3002%5Cn%5Cn%22%2C%22inputFormat%22%3A%22%5Cu7b2c%5Cu4e00%5Cu884c%5Cu4e00%5Cu4e2a%5Cu5b57%5Cu7b26%5Cu4e32S%20%5Cuff0c%5Cu4e4b%5Cu540e%5Cu8be2%5Cu95ee%5Cu7ed9%5Cu51fa%5Cu7684ION2017%20%5Cu7684%5Cu547d%5Cu540d%5Cu4e32%5Cu90fd%5Cu662fS%20%5Cu7684%5Cu8fde%5Cu7eed%5Cu5b50%5Cu4e32%5Cu3002%5Cn%5Cu7b2c%5Cu4e8c%5Cu884c%5Cu4e00%5Cu4e2a%5Cu6b63%5Cu6574%5Cu6570Q%5Cuff0c%5Cu8868%5Cu793a%5Cu8be2%5Cu95ee%5Cu6b21%5Cu6570%5Cu3002%5Cn%5Cu63a5%5Cu4e0b%5Cu6765Q%20%5Cu884c%5Cuff0c%5Cu6bcf%5Cu884c%5Cu6709%5Cu4e00%5Cu4e2a%5Cu5b57%5Cu7b26%5Cu4e32T%20%5Cu548c%5Cu4e24%5Cu4e2a%5Cu6b63%5Cu6574%5Cu6570%24l%2Cr%24%5Cuff0c%5Cu8868%5Cu793a%5Cu8be2%5Cu95ee%5Cu5982%5Cu679cION2017%20%5Cu7684%5Cn%5Cu547d%5Cu540d%5Cu4e32%5Cu662f%24S%20%5Bl..r%5D%24%5Cuff0cION2018%20%5Cu7684%5Cu547d%5Cu540d%5Cu4e32%5Cu662fT%20%5Cu7684%5Cu8bdd%5Cuff0c%5Cu6709%5Cu51e0%5Cu79cd%5Cu547d%5Cu540d%5Cu65b9%5Cu5f0f%5Cu4e00%5Cu5b9a%5Cu6ee1%5Cu8db3%5Cu89c4%5Cu5b9a%5Cu3002%22%2C%22outputFormat%22%3A%22%5Cu8f93%5Cu51faQ%20%5Cu884c%5Cuff0c%5Cu7b2ci%20%5Cu884c%5Cu4e00%5Cu4e2a%5Cu975e%5Cu8d1f%5Cu6574%5Cu6570%5Cu8868%5Cu793a%5Cu7b2ci%20%5Cu4e2a%5Cu8be2%5Cu95ee%5Cu7684%5Cu7b54%5Cu6848%5Cu3002%22%2C%22samples%22%3A%5B%5B%22scbamgepe%5Cn3%5Cnsmape%202%207%5Cnsbape%203%208%5Cnsgepe%201%209%22%2C%2212%5Cn10%5Cn4%22%5D%5D%2C%22hint%22%3A%22%5Cu6d4b%5Cu8bd5%5Cu70b9%5Cu3000%5Cu3000.%7C%24S%24%5Cu7684%5Cu7edd%5Cu5bf9%5Cu503c%24%5C%5Cleq%24%5Cu3000%5Cu3000.%7C%24Q%5C%5Cleq%20%24%5Cu3000%5Cu3000.%7C%24%5C%5Csum%20%24T%5Cu7684%5Cu7edd%5Cu5bf9%5Cu503c%24%5C%5Cleq%20%24%5Cu3000%5Cu3000.%7C%5Cu5176%5Cu4ed6%5Cu9650%5Cu5236%5Cn-%7C-%7C-%7C-%7C-%7C-%7C-%5Cn1%7C%24200%24%7C%24200%24%7C%2440000%24%7C%24T%5C%5Cleq%20200%24%5Cn2%7C%241000%24%7C%24200%24%7C%2440000%24%7C%24T%5C%5Cleq%20200%24%5Cn3%7C%241000%24%7C%24200%24%7C%2440000%24%7C%24T%5C%5Cleq%20200%24%5Cn4%7C%241000%24%7C%24200%24%7C%245%20%5C%5Ctimes%2010%5E5%24%7C%5Cu65e0%5Cn5%7C%241000%24%7C%24200%24%7C%245%20%5C%5Ctimes%2010%5E5%24%7C%5Cu65e0%5Cn6%7C%245%20%5C%5Ctimes%2010%5E5%24%7C%241%24%7C%245%20%5C%5Ctimes%2010%5E5%24%7C%5Cu65e0%5Cn7%7C%245%20%5C%5Ctimes%2010%5E5%24%7C%241%24%7C%245%20%5C%5Ctimes%2010%5E5%24%7C%5Cu65e0%5Cn8%7C%2410%5E5%24%7C%2410%5E5%24%7C%242%20%5C%5Ctimes%2010%5E5%24%7C%5Cu65e0%5Cn9%7C%2410%5E5%24%7C%2410%5E5%24%7C%242%20%5C%5Ctimes%2010%5E5%24%7C%5Cu5b57%5Cu7b26%5Cu4e32%5Cu968f%5Cu673a%5Cn10%7C%242%20%5C%5Ctimes%2010%5E5%24%7C%2410%5E5%24%7C%244%20%5C%5Ctimes%2010%5E5%24%7C%5Cu65e0%5Cn11%7C%242%20%5C%5Ctimes%2010%5E5%24%7C%2410%5E5%24%7C%244%20%5C%5Ctimes%2010%5E5%24%7C%5Cu5b57%5Cu7b26%5Cu4e32%5Cu968f%5Cu673a%5Cn12%7C%243%20%5C%5Ctimes%2010%5E5%24%7C%2410%5E5%24%7C%246%20%5C%5Ctimes%2010%5E5%24%7C%5Cu65e0%5Cn13%7C%243%20%5C%5Ctimes%2010%5E5%24%7C%2410%5E5%24%7C%246%20%5C%5Ctimes%2010%5E5%24%7C%5Cu5b57%5Cu7b26%5Cu4e32%5Cu968f%5Cu673a%5Cn14%7C%244%20%5C%5Ctimes%2010%5E5%24%7C%2410%5E5%24%7C%248%20%5C%5Ctimes%2010%5E5%24%7C%5Cu65e0%5Cn15%7C%244%20%5C%5Ctimes%2010%5E5%24%7C%2410%5E5%24%7C%248%20%5C%5Ctimes%2010%5E5%24%7C%5Cu5b57%5Cu7b26%5Cu4e32%5Cu968f%5Cu673a%5Cn16%7C%245%20%5C%5Ctimes%2010%5E5%24%7C%2410%5E5%24%7C%2410%5E6%24%7C%5Cu65e0%5Cn17%7C%245%20%5C%5Ctimes%2010%5E5%24%7C%2410%5E5%24%7C%2410%5E6%24%7C%5Cu5b57%5Cu7b26%5Cu4e32%5Cu968f%5Cu673a%5Cn18%7C%242%20%5C%5Ctimes%2010%5E5%24%7C%2410%5E5%24%7C%2410%5E6%24%7C%5Cu65e0%5Cn19%7C%243%20%5C%5Ctimes%2010%5E5%24%7C%2410%5E5%24%7C%2410%5E6%24%7C%5Cu65e0%5Cn20%7C%244%20%5C%5Ctimes%2010%5E5%24%7C%2410%5E5%24%7C%2410%5E6%24%7C%5Cu65e0%5Cn21%7C%245%20%5C%5Ctimes%2010%5E5%24%7C%2410%5E5%24%7C%2410%5E6%24%7C%5Cu65e0%5Cn22%7C%245%20%5C%5Ctimes%2010%5E5%24%7C%2410%5E5%24%7C%2410%5E6%24%7C%5Cu65e0%5Cn23%7C%245%20%5C%5Ctimes%2010%5E5%24%7C%2410%5E5%24%7C%2410%5E6%24%7C%5Cu65e0%5Cn24%7C%245%20%5C%5Ctimes%2010%5E5%24%7C%2410%5E5%24%7C%2410%5E6%24%7C%5Cu65e0%5Cn25%7C%245%20%5C%5Ctimes%2010%5E5%24%7C%2410%5E5%24%7C%2410%5E6%24%7C%5Cu65e0%5Cn%5Cn%5Cu5bf9%5Cu4e8e%5Cu524d17%5Cu4e2a%5Cu6d4b%5Cu8bd5%5Cu70b9%5Cu7684%5Cu6240%5Cu6709%5Cu8be2%5Cu95ee%5Cu6709%24l%3D1%2Cr%3D%7CS%7C%24%5Cn%5Cn%5Cu5bf9%5Cu4e8e%5Cu6240%5Cu6709%5Cu6570%5Cu636e%5Cuff0c%5Cu4fdd%5Cu8bc1%20%241%5C%5Cleq%20l%20%5C%5Cleq%20r%20%5C%5Cleq%20%7CS%7C%24%2C%241%5C%5Cleq%20%7CT%7C%5C%5Cleq%205%20%5C%5Ctimes%2010%5E5%24%22%2C%22provider%22%3A%7B%22uid%22%3A8457%2C%22name%22%3A%22chen_zhe%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22Aya%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A6%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B5000%2C5000%2C5000%2C5000%2C5000%2C5000%2C5000%2C5000%2C5000%2C5000%2C5000%2C5000%2C5000%2C5000%2C5000%2C5000%2C5000%2C5000%2C5000%2C5000%2C5000%2C5000%2C5000%2C5000%2C5000%5D%2C%22memory%22%3A%5B1280000%2C1280000%2C1280000%2C1280000%2C1280000%2C1280000%2C1280000%2C1280000%2C1280000%2C1280000%2C1280000%2C1280000%2C1280000%2C1280000%2C1280000%2C1280000%2C1280000%2C1280000%2C1280000%2C1280000%2C1280000%2C1280000%2C1280000%2C1280000%2C1280000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22tags%22%3A%5B35%2C42%2C77%2C101%2C108%2C303%2C319%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A3247%2C%22totalAccepted%22%3A723%2C%22pid%22%3A%22P4770%22%2C%22title%22%3A%22%5BNOI2018%5D%5Cu4f60%5Cu7684%5Cu540d%5Cu5b57%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A145447%2C%22title%22%3A%22%5Cu6c42%5Cu52a9%22%2C%22forum%22%3A%7B%22id%22%3A27411%2C%22name%22%3A%22P4770%20%5BNOI2018%5D%5Cu4f60%5Cu7684%5Cu540d%5Cu5b57%22%2C%22slug%22%3A%22P4770%22%7D%7D%2C%7B%22id%22%3A137639%2C%22title%22%3A%22%5Cu9898%5Cu9762%5Cu51fa%5Cu9505%22%2C%22forum%22%3A%7B%22id%22%3A27411%2C%22name%22%3A%22P4770%20%5BNOI2018%5D%5Cu4f60%5Cu7684%5Cu540d%5Cu5b57%22%2C%22slug%22%3A%22P4770%22%7D%7D%2C%7B%22id%22%3A122405%2C%22title%22%3A%22%5Cu6211%5Cu611f%5Cu89c9%5Cu8fd9%5Cu9053%5Cu9898%5Cu5f88%5Cu5bb9%5Cu6613%5Cu56e0%5Cu4e3a%5Cu5b9e%5Cu73b0%5Cu65b9%5Cu6cd5%5Cu4e0d%5Cu597d%5Cu800c%5Cu53d8%5Cu6210%5Cu4e24%5Cu4e2alog%22%2C%22forum%22%3A%7B%22id%22%3A27411%2C%22name%22%3A%22P4770%20%5BNOI2018%5D%5Cu4f60%5Cu7684%5Cu540d%5Cu5b57%22%2C%22slug%22%3A%22P4770%22%7D%7D%2C%7B%22id%22%3A117277%2C%22title%22%3A%22%5Cu6709%5Cu507f%5Cu5f81%5Cu6c42%5Cu4f18%5Cu5316%22%2C%22forum%22%3A%7B%22id%22%3A27411%2C%22name%22%3A%22P4770%20%5BNOI2018%5D%5Cu4f60%5Cu7684%5Cu540d%5Cu5b57%22%2C%22slug%22%3A%22P4770%22%7D%7D%2C%7B%22id%22%3A108861%2C%22title%22%3A%22WA96%5Cu5206%5Cu7b2c21%5Cu4e2a%5Cu70b9%5Cu9519%5Cu7684%5Cu6233%5Cu8fd9%5Cu91cc%5Cuff01%22%2C%22forum%22%3A%7B%22id%22%3A27411%2C%22name%22%3A%22P4770%20%5BNOI2018%5D%5Cu4f60%5Cu7684%5Cu540d%5Cu5b57%22%2C%22slug%22%3A%22P4770%22%7D%7D%2C%7B%22id%22%3A108166%2C%22title%22%3A%22WA68%5Cu5206%5Cu6c42%5Cu52a9%5Cuff01%5Cu6211%5Cu5199%5Cu7684%5Cu4e8b%5Cu6ee1%5Cu5206%5Cu7b97%5Cu6cd5%5Cuff01%22%2C%22forum%22%3A%7B%22id%22%3A27411%2C%22name%22%3A%22P4770%20%5BNOI2018%5D%5Cu4f60%5Cu7684%5Cu540d%5Cu5b57%22%2C%22slug%22%3A%22P4770%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P2178%22%2C%22title%22%3A%22%5BNOI2015%5D%5Cu54c1%5Cu9152%5Cu5927%5Cu4f1a%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P3649%22%2C%22title%22%3A%22%5BAPIO2014%5D%5Cu56de%5Cu6587%5Cu4e32%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P4769%22%2C%22title%22%3A%22%5BNOI2018%5D%5Cu5192%5Cu6ce1%5Cu6392%5Cu5e8f%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P4774%22%2C%22title%22%3A%22%5BNOI2018%5D%5Cu5c60%5Cu9f99%5Cu52c7%5Cu58eb%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P4775%22%2C%22title%22%3A%22%5BNOI2018%5D%5Cu60c5%5Cu62a5%5Cu4e2d%5Cu5fc3%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22%5BNOI2018%5D%5Cu4f60%5Cu7684%5Cu540d%5Cu5b57%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573295103;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>[NOI2018]你的名字</h1>
<h2>题目背景</h2>
<div>实力强大的小A 被选为了ION2018 的出题人，现在他需要解决题目的命名问题。</div>
<h2>题目描述</h2>
<div>小A 被选为了ION2018 的出题人，他精心准备了一道质量十分高的题目，且已经把除了题目命名以外的工作都做好了。
由于ION 已经举办了很多届，所以在题目命名上也是有规定的，ION 命题手册规定：每年由命题委员会规定一个小写字母字符串，我们称之为那一年的命名串，要求每道题的名字必须是那一年的命名串的一个非空连续子串，且不能和前一年的任何一道题目的名字相同。
由于一些特殊的原因，小A 不知道ION2017 每道题的名字，但是他通过一些特殊手段得到了ION2017 的命名串，现在小A 有Q 次询问：每次给定ION2017 的命名串和ION2018 的命名串，求有几种题目的命名，使得这个名字一定满足命题委员会的规定，即是ION2018 的命名串的一个非空连续子串且一定不会和ION2017 的任何一道题目的名字相同。
由于一些特殊原因，所有询问给出的ION2017 的命名串都是某个串的连续子串，详细可见输入格式。
</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>第一行一个字符串S ，之后询问给出的ION2017 的命名串都是S 的连续子串。
第二行一个正整数Q，表示询问次数。
接下来Q 行，每行有一个字符串T 和两个正整数$l,r$，表示询问如果ION2017 的
命名串是$S [l..r]$，ION2018 的命名串是T 的话，有几种命名方式一定满足规定。</div>
<h3>输出格式</h3>
<br />
<div>输出Q 行，第i 行一个非负整数表示第i 个询问的答案。</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>scbamgepe
3
smape 2 7
sbape 3 8
sgepe 1 9</code></pre>
<h3>输出样例 #1</h3>
<pre><code>12
10
4</code></pre>
<h2>说明</h2>
<div>测试点　　.|$S$的绝对值$\leq$　　.|$Q\leq $　　.|$\sum $T的绝对值$\leq $　　.|其他限制
-|-|-|-|-|-|-
1|$200$|$200$|$40000$|$T\leq 200$
2|$1000$|$200$|$40000$|$T\leq 200$
3|$1000$|$200$|$40000$|$T\leq 200$
4|$1000$|$200$|$5 \times 10^5$|无
5|$1000$|$200$|$5 \times 10^5$|无
6|$5 \times 10^5$|$1$|$5 \times 10^5$|无
7|$5 \times 10^5$|$1$|$5 \times 10^5$|无
8|$10^5$|$10^5$|$2 \times 10^5$|无
9|$10^5$|$10^5$|$2 \times 10^5$|字符串随机
10|$2 \times 10^5$|$10^5$|$4 \times 10^5$|无
11|$2 \times 10^5$|$10^5$|$4 \times 10^5$|字符串随机
12|$3 \times 10^5$|$10^5$|$6 \times 10^5$|无
13|$3 \times 10^5$|$10^5$|$6 \times 10^5$|字符串随机
14|$4 \times 10^5$|$10^5$|$8 \times 10^5$|无
15|$4 \times 10^5$|$10^5$|$8 \times 10^5$|字符串随机
16|$5 \times 10^5$|$10^5$|$10^6$|无
17|$5 \times 10^5$|$10^5$|$10^6$|字符串随机
18|$2 \times 10^5$|$10^5$|$10^6$|无
19|$3 \times 10^5$|$10^5$|$10^6$|无
20|$4 \times 10^5$|$10^5$|$10^6$|无
21|$5 \times 10^5$|$10^5$|$10^6$|无
22|$5 \times 10^5$|$10^5$|$10^6$|无
23|$5 \times 10^5$|$10^5$|$10^6$|无
24|$5 \times 10^5$|$10^5$|$10^6$|无
25|$5 \times 10^5$|$10^5$|$10^6$|无
对于前17个测试点的所有询问有$l=1,r=|S|$
对于所有数据，保证 $1\leq l \leq r \leq |S|$,$1\leq |T|\leq 5 \times 10^5$</div>
</article>
</div>
</div>
</body>
</html>
