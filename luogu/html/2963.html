<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>[USACO09NOV]牛救援Cow Rescue - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573376205:1YJZwqKylYriprnq+0SZBiMdCNcYecVYCB/oIHWEjMo=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%22%2C%22description%22%3A%22Bessie%20is%20trapped%20in%20a%20triangular%20maze%20with%20N%20rows%20%281%20%3C%3D%20N%20%3C%3D%5Cn%5Cn1%2C000%2C000%29.%20A%20three%20row%20maze%20is%20shown%20below%3A%5Cn%5CnThe%20i%27th%20row%20of%20the%20maze%20contains%202%5C%5C%2Ai-1%20triangles.%20Numbering%20from%20the%20left%2C%20the%20triangles%20are%20named%20%28i%2C1%29%2C%20%28i%2C2%29%2C%20and%20so%20on.%5Cn%5CnBessie%20can%20travel%20to%20the%20%28often%20three%29%20triangles%20which%20share%20an%20edge%20with%20her%20current%20triangle.%20For%20example%2C%20if%20she%20is%20at%20%283%2C%203%29%2C%20she%20can%20travel%20to%20%283%2C%202%29%2C%20%283%2C%204%29%20and%20%284%2C%204%29.%20Bessie%20takes%20one%20minute%20to%20travel%20from%20one%20triangle%20to%20the%20next.%5Cn%5CnFJ%20has%20learned%20the%20Bessie%20is%20trapped%20and%20knows%20by%20tracking%20her%20iPhone%20that%20she%20starts%20her%20exit%20trek%20at%20triangle%20%28Si%2CSj%29.%20FJ%27s%20love%20for%20Bessie%20knows%20no%20bounds%20so%20he%20wants%20her%20back%20in%20the%20minimum%20possible%20time.%5Cn%5CnThe%20maze%20has%20M%20%281%20%3C%3D%20M%20%3C%3D%2010%2C000%29%20exits%20found%20in%20locations%20throughout%20the%20set%20of%20triangles.%20Any%20one%20of%20these%20will%20enable%20Bessie%20to%20escape.%20Once%20she%20enters%20an%20exit%20triangle%2C%20she%20leaves%20the%20maze%20in%20just%20one%20more%20minute.%5Cn%5CnFind%20the%20minimum%20time%20in%20minutes%2C%20T%2C%20required%20for%20Bessie%20to%20exit%20the%20maze%20and%20report%20the%20optimal%20exit%20location%20she%20uses%2C%20%28OUTi%2C%20OUTj%29.%20If%20more%20than%20one%20location%20requires%20only%20T%20minutes%2C%20output%20the%20location%20with%20the%20smallest%20row.%20If%20two%20optimal%20rows%20are%20the%20same%2C%20output%20the%20one%20with%20smaller%20column.%5Cn%5Cn%5Cu8d1d%5Cu5e0c%5Cu88ab%5Cu56f0%5Cu5728%5Cu4e00%5Cu4e2a%5Cu4e09%5Cu89d2%5Cu5f62%5Cu7684%5Cu8ff7%5Cu5bab%5Cu4e4b%5Cu4e2d%5Cu3002%5Cu8fd9%5Cu4e2a%5Cu8ff7%5Cu5bab%5Cu6709N%5Cu884c%5Cuff081%20%3C%3D%20N%20%3C%3D%201000000%5Cuff09%5Cu3002%5Cu6bd4%5Cu5982%5Cu4e0b%5Cu56fe%5Cu662f%5Cu4e00%5Cu4e2a3%5Cu884c%5Cu7684%5Cu8ff7%5Cu5bab%5Cu3002%20%20%5Cu8ff7%5Cu5bab%5Cu7684%5Cu7b2ci%5Cu884c%5Cu67092%5C%5C%2Ai-1%5Cu4e2a%5Cu4e09%5Cu89d2%5Cu5f62%5Cuff0c%5Cu4ece%5Cu5de6%5Cu5230%5Cu53f3%5Cu5206%5Cu522b%5Cu7f16%5Cu53f7%5Cu4e3a%5Cuff08i%5Cuff0c1%5Cuff09%5Cu3001%5Cuff08i%5Cuff0c2%5Cuff09%5Cu7b49%5Cu7b49%5Cu3002%5Cn%5Cn%5Cu8d1d%5Cu5e0c%5Cu6bcf%5Cu6b21%5Cu53ef%5Cu4ee5%5Cu4ece%5Cu4e00%5Cu4e2a%5Cu4e09%5Cu89d2%5Cu5f62%5Cu8d70%5Cu5230%5Cu4efb%5Cu610f%5Cu4e00%5Cu4e2a%5Cu4e00%5Cu4e2a%5Cu8ddf%5Cu5f53%5Cu524d%5Cu7684%5Cu4e09%5Cu89d2%5Cu5f62%5Cu6709%5Cu90bb%5Cu8fb9%5Cu7684%5Cu4e09%5Cu89d2%5Cu5f62%5Cu3002%5Cn%5Cn%5Cu6bd4%5Cu5982%5Cu8bf4%5Cuff0c%5Cu5982%5Cu679c%5Cu5979%5Cu76ee%5Cu524d%5Cu5904%5Cu4e8e%5Cu4e09%5Cu89d2%5Cu5f62%5Cuff083%5Cuff0c3%5Cuff09%5Cuff0c%5Cu90a3%5Cu9ebd%5Cuff0c%5Cu5979%5Cu53ef%5Cu4ee5%5Cu8d70%5Cu5230%5Cu4e09%5Cu89d2%5Cu5f62%5Cuff083%5Cuff0c2%5Cuff09%5Cu3001%5Cuff083%5Cuff0c4%5Cuff09%5Cu548c%5Cuff084%5Cuff0c4%5Cuff09%5Cu3002%5Cu8d1d%5Cu5e0c%5Cu6bcf%5Cu6b21%5Cu9700%5Cu8981%5Cu4e00%5Cu5206%5Cu949f%5Cu7684%5Cu65f6%5Cu95f4%5Cu6765%5Cu79fb%5Cu52a8%5Cu5230%5Cu4e0b%5Cu4e00%5Cu4e2a%5Cu4e09%5Cu89d2%5Cu5f62%5Cu3002%20%20%5Cu519c%5Cu592b%5Cu7ea6%5Cu7ff0%5Cu53d1%5Cu73b0%5Cu8d1d%5Cu5e0c%5Cu88ab%5Cu56f0%5Cu4e86%5Cuff01%5Cu4e8e%5Cu662f%5Cu5979%5Cu8ddf%5Cu8e2a%5Cu8d1d%5Cu5e0c%5Cu7684iPhone%5Cu624b%5Cu673a%5Cuff08%5Cu53ef%5Cu601c%5Cu7684%5Cu89e6%5Cu6478%5Cu5c4f%5Cuff5e%5Cuff09%5Cuff0c%5Cu5f97%5Cu77e5%5Cu8d1d%5Cu5e0c%5Cu76ee%5Cu524d%5Cu5904%5Cu4e8e%5Cu4e09%5Cu89d2%5Cu5f62%5Cuff08Si%5Cuff0cSj%5Cuff09%5Cu3002%5Cn%5Cn%5Cu56e0%5Cu4e3a%5Cu7ea6%5Cu7ff0%5Cu5bf9%5Cu8d1d%5Cu5e0c%5Cu6709%5Cu8457%5Cu65e0%5Cu7a77%5Cu65e0%5Cu5c3d%5Cu7684%5Cu6d53%5Cu6d53%5Cu7231%5Cu610f%5Cuff0c%5Cu6240%5Cu4ee5%5Cu4ed6%5Cu5e0c%5Cu671b%5Cu8d1d%5Cu5e0c%5Cu80fd%5Cu5c3d%5Cu53ef%5Cu80fd%5Cu5feb%5Cu5730%5Cu56de%5Cu5230%5Cu4ed6%5Cu7684%5Cu8eab%5Cu8fb9%5Cu3002%20%5Cu5728%5Cu8ff7%5Cu5bab%5Cu7684%5Cu4e09%5Cu89d2%5Cu5f62%5Cu4e4b%5Cu4e2d%5Cuff0c%5Cu6709M%5Cuff081%20%3C%3D%20M%20%3C%3D%2010000%5Cuff09%5Cu4e2a%5Cu662f%5Cu51fa%5Cu53e3%5Cu3002%5Cu5728%5Cu4efb%5Cu4f55%5Cu4e00%5Cu4e2a%5Cu51fa%5Cu53e3%5Cu90fd%5Cu53ef%5Cu4ee5%5Cu8ba9%5Cu8d1d%5Cu5e0c%5Cu9003%5Cu79bb%5Cu8ff7%5Cu5bab%5Cu3002%5Cu4e00%5Cu65e6%5Cu8d1d%5Cu5e0c%5Cu8fdb%5Cu5165%5Cu4e00%5Cu4e2a%5Cu4f5c%5Cu4e3a%5Cu51fa%5Cu53e3%5Cu7684%5Cu4e09%5Cu89d2%5Cu5f62%5Cuff0c%5Cu5979%5Cu7528%5Cu591a%5Cu4e00%5Cu5206%5Cu949f%5Cu5c31%5Cu53ef%5Cu4ee5%5Cu9003%5Cu79bb%5Cu8fd9%5Cu4e2a%5Cu8ff7%5Cu5bab%5Cu3002%20%5Cu627e%5Cu5230%5Cu4e00%5Cu4e2a%5Cu53ef%5Cu4ee5%5Cu8ba9%5Cu8d1d%5Cu5e0c%5Cu9003%5Cu79bb%5Cu8ff7%5Cu5bab%5Cu6700%5Cu5c0f%5Cu65f6%5Cu95f4T%5Cuff0c%5Cu5e76%5Cu8f93%5Cu51fa%5Cu5979%5Cu5e94%5Cu8be5%5Cu4ece%5Cu54ea%5Cu4e00%5Cu4e2a%5Cu51fa%5Cu53e3%5Cu9003%5Cu79bb%5Cu8ff7%5Cu5bab%5Cuff0c%5Cu8fd9%5Cu4e2a%5Cu51fa%5Cu53e3%5Cu8bb0%5Cu4e3a%5Cuff08OUTi%5Cuff0cOUTj%5Cuff09%5Cu3002%5Cn%5Cn%5Cu5982%5Cu679c%5Cu6709%5Cu591a%5Cu4e2a%5Cu51fa%5Cu53e3%5Cu540c%5Cu65f6%5Cu9700%5Cu8981%5Cu65f6%5Cu95f4T%5Cuff0c%5Cu8f93%5Cu51fa%5Cu90a3%5Cu4e2a%5Cu884c%5Cu7684%5Cu7f16%5Cu53f7%5Cu5c0f%5Cu7684%5Cu51fa%5Cu53e3%5Cuff0c%5Cu5982%5Cu679c%5Cu4ecd%5Cu7136%5Cu6709%5Cu591a%5Cu4e2a%5Cu51fa%5Cu53e3%5Cuff0c%5Cu8f93%5Cu51fa%5Cu90a3%5Cu4e2a%5Cu5217%5Cu7684%5Cu7f16%5Cu53f7%5Cu5c0f%5Cu7684%5Cu3002%5Cn%22%2C%22inputFormat%22%3A%22%5C%5C%2A%20Line%201%3A%20Two%20space-separated%20integers%3A%20N%20and%20M%5Cn%5Cn%5C%5C%2A%20Line%202%3A%20Two%20space-separated%20integers%3A%20Si%20and%20Sj%5Cn%5Cn%5C%5C%2A%20Lines%203..M%2B2%3A%20Line%20i%2B2%20contains%20two%20space-separated%20integers%20that%20are%20the%20triangle%20location%20of%20exit%20i%3A%20Ei%20and%20Ej%5Cn%22%2C%22outputFormat%22%3A%22%5C%5C%2A%20Line%201%3A%20Two%20space-separated%20integers%3A%20OUTi%20and%20OUTj%5Cn%5Cn%5C%5C%2A%20Line%202%3A%20A%20single%20integer%3A%20T%5Cn%22%2C%22samples%22%3A%5B%5B%224%202%20%5Cr%5Cn2%201%20%5Cr%5Cn3%205%20%5Cr%5Cn4%204%20%5Cr%5Cn%22%2C%224%204%20%5Cr%5Cn4%20%5Cr%5Cn%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A20%2C%22name%22%3A%22FarmerJohn2%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3Anull%2C%22isAdmin%22%3Afalse%2C%22color%22%3A%22Gray%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%5D%2C%22memory%22%3A%5B128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22tags%22%3A%5B7%2C26%2C46%2C253%2C276%2C319%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A86%2C%22totalAccepted%22%3A35%2C%22pid%22%3A%22P2963%22%2C%22title%22%3A%22%5BUSACO09NOV%5D%5Cu725b%5Cu6551%5Cu63f4Cow%20Rescue%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P2039%22%2C%22title%22%3A%22%5BAHOI2009%5D%5Cu8df3%5Cu68cb%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P3620%22%2C%22title%22%3A%22%5BAPIO%5C%2FCTSC%202007%5D%5Cu6570%5Cu636e%5Cu5907%5Cu4efd%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P3574%22%2C%22title%22%3A%22%5BPOI2014%5DFAR-FarmCraft%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22CF487E%22%2C%22title%22%3A%22Tourists%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22UVA1411%22%2C%22title%22%3A%22Ants%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22UVA%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22%5BUSACO09NOV%5D%5Cu725b%5Cu6551%5Cu63f4Cow%20Rescue%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>[USACO09NOV]牛救援Cow Rescue</h1>
<h2>题目描述</h2>
<div>Bessie is trapped in a triangular maze with N rows (1 <= N <=
1,000,000). A three row maze is shown below:
The i'th row of the maze contains 2\*i-1 triangles. Numbering from the left, the triangles are named (i,1), (i,2), and so on.
Bessie can travel to the (often three) triangles which share an edge with her current triangle. For example, if she is at (3, 3), she can travel to (3, 2), (3, 4) and (4, 4). Bessie takes one minute to travel from one triangle to the next.
FJ has learned the Bessie is trapped and knows by tracking her iPhone that she starts her exit trek at triangle (Si,Sj). FJ's love for Bessie knows no bounds so he wants her back in the minimum possible time.
The maze has M (1 <= M <= 10,000) exits found in locations throughout the set of triangles. Any one of these will enable Bessie to escape. Once she enters an exit triangle, she leaves the maze in just one more minute.
Find the minimum time in minutes, T, required for Bessie to exit the maze and report the optimal exit location she uses, (OUTi, OUTj). If more than one location requires only T minutes, output the location with the smallest row. If two optimal rows are the same, output the one with smaller column.
贝希被困在一个三角形的迷宫之中。这个迷宫有N行（1 <= N <= 1000000）。比如下图是一个3行的迷宫。 迷宫的第i行有2\*i-1个三角形，从左到右分别编号为（i，1）、（i，2）等等。
贝希每次可以从一个三角形走到任意一个一个跟当前的三角形有邻边的三角形。
比如说，如果她目前处于三角形（3，3），那麽，她可以走到三角形（3，2）、（3，4）和（4，4）。贝希每次需要一分钟的时间来移动到下一个三角形。 农夫约翰发现贝希被困了！于是她跟踪贝希的iPhone手机（可怜的触摸屏～），得知贝希目前处于三角形（Si，Sj）。
因为约翰对贝希有著无穷无尽的浓浓爱意，所以他希望贝希能尽可能快地回到他的身边。 在迷宫的三角形之中，有M（1 <= M <= 10000）个是出口。在任何一个出口都可以让贝希逃离迷宫。一旦贝希进入一个作为出口的三角形，她用多一分钟就可以逃离这个迷宫。 找到一个可以让贝希逃离迷宫最小时间T，并输出她应该从哪一个出口逃离迷宫，这个出口记为（OUTi，OUTj）。
如果有多个出口同时需要时间T，输出那个行的编号小的出口，如果仍然有多个出口，输出那个列的编号小的。
</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>\* Line 1: Two space-separated integers: N and M
\* Line 2: Two space-separated integers: Si and Sj
\* Lines 3..M+2: Line i+2 contains two space-separated integers that are the triangle location of exit i: Ei and Ej
</div>
<h3>输出格式</h3>
<br />
<div>\* Line 1: Two space-separated integers: OUTi and OUTj
\* Line 2: A single integer: T
</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>4 2 
2 1 
3 5 
4 4 
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>4 4 
4 
</code></pre>
</article>
</div>
</div>
</body>
</html>
