<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>[POI2008]POC-Trains - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573376934:9hqLhTYESbT3ipMfNK/4EbOgtqrimoapvpFDxW1ik0Q=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%22%2C%22description%22%3A%22The%20Trains%20of%20Colour%20Parade%20begins%20tomorrow%20in%20Byteotia.%5Cn%5CnIntense%20preparations%20are%20already%20in%20progress%20at%20the%20station%27s%20auxiliary%20tracks.%20There%20are%20%24n%24%20parallel%20tracks%20at%20the%20station%2C%20numbered%20from%20%241%24%20to%20%24n%24.%20The%20train%20no.%20%24i%24%20occupies%20the%20%24i%5E%7Bth%7D%24%20track.%5Cn%5CnEvery%20train%20consists%20of%20%24l%24%20cars%20and%20each%20car%20is%20painted%20with%20one%20of%2026%20colours%20%28denoted%20by%20non-capital%20letters%20of%20the%20English%20alphabet%29.%5Cn%5CnWe%20say%20that%20two%20trains%20look%20the%20same%2C%20if%20their%20corresponding%20cars%20are%20painted%20the%20same%20colour.%5Cn%5CnThroughout%20the%20parade%20a%20crane%20will%20switch%20places%20of%20certain%20pairs%20of%20cars.%20The%20real%20parade%2C%20however%2C%20will%20take%20place%20tomorrow.%5Cn%5CnToday%20the%20train%20dispatcher%2C%20Byteasar%2C%20watched%20the%20general%20rehearsal%20%20%20%20closely.%20He%20even%20wrote%20down%20the%20sequence%20of%20car%20swaps.%5Cn%5CnByteasar%20particularly%20dislikes%20many%20trains%20looking%20the%20same.%5Cn%5CnFor%20each%20train%20%24p%24%20he%20would%20like%20to%20calculate%20the%20maximum%20number%20%20%20%20of%20trains%20that%20at%20some%20moment%20look%20the%20same%20as%20the%20train%20%24p%24%20at%20the%20very%20same%20moment.%5Cn%5Cn%23%23%20Task%5Cn%5CnWrite%20a%20programme%20that%3A%5Cn%5Cn-%20reads%20descriptions%20of%20the%20trains%20occupying%20tracks%20and%20the%20sequence%20of%20car%20swaps%2C%5Cn%5Cn-%20for%20each%20train%20determines%20the%20maximum%20number%20of%20trains%20that%20look%20the%20same%20as%20it%20at%20certain%20moment%2C%5Cn%5Cn-%20writes%20out%20the%20result.%5Cn%5Cn%5Cn%5Cu7ed9%5Cu51fan%5Cu4e2a%5Cu5b57%5Cu7b26%5Cu4e32%5Cuff0c%5Cu957f%5Cu5ea6%5Cu5747%5Cu4e3alen%5Cuff1b%5Cn%5Cn%5Cu6709m%5Cu6b21%5Cu64cd%5Cu4f5c%5Cuff0c%5Cu6bcf%5Cu6b21%5Cu5c06%5Cu4e24%5Cu4e2a%5Cu5b57%5Cu7b26%5Cu4ea4%5Cu6362%5Cuff1b%5Cn%5Cn%5Cu6c42%5Cu6bcf%5Cu4e2a%5Cu5b57%5Cu7b26%5Cu4e32%5Cu5728%5Cu4efb%5Cu4f55%5Cu65f6%5Cu70b9%5Cu4e0a%5Cuff0c%5Cu4e0e%5Cu76f8%5Cu540c%5Cu7684%5Cu5b83%5Cu6700%5Cu591a%5Cu7684%5Cu5b57%5Cu7b26%5Cu4e32%5Cu4e2a%5Cu6570%5Cuff1b%5Cn%22%2C%22inputFormat%22%3A%22The%20first%20line%20of%20the%20input%20contains%20three%20integers%20%24n%24%2C%20%24l%24%20and%20%24m%24%20%28%242%20%5C%5Cle%20n%20%5C%5Cle%201000%24%2C%20%241%20%5C%5Cle%20l%20%5C%5Cle%20100%24%2C%20%240%20%5C%5Cle%20m%20%5C%5Cle%20100%5C%5C%20000%24%29%2C%20denoting%20respectively%20the%20number%20of%20trains%2C%20their%20common%20length%20and%20the%20number%20of%20car%20swaps.%20The%20following%20%24n%24%20lines%20contain%20descriptions%20of%20the%20trains%20on%20successive%20tracks.%20The%5Cn%5Cn%24k%5E%7Bth%7D%24%20line%20consists%20of%20%24l%24%20small%20letters%20of%20the%20English%20alphabet%20denoting%20the%20colours%20of%20successive%20cars%20of%20the%20%24k%5E%7Bth%7D%24%20train.%20Then%20%24m%24%20lines%20describing%20the%20car%20swaps%20follow%2C%20in%20the%20order%20of%20the%20swaps.%20The%20%24r%5E%7Bth%7D%24%20line%20contains%20four%20integers%20%24p_1%24%2C%20%24w_1%24%2C%20%24p_2%24%2C%20%24w_2%24%20%28%241%20%5C%5Cle%20p_1%2C%20p_2%2C%20%5C%5Cle%20n%24%2C%20%241%20%5C%5Cle%20w_1%2C%20w_2%20%5C%5Cle%20l%24%2C%20%24p_1%20%5C%5Cne%20p_2%24%20or%20%24w_1%20%5C%5Cne%20w_2%24%29%20denoting%20the%20%24r%5E%7Bth%7D%24%20car%20swap-the%20car%20no.%20%24w_1%24%20of%20the%20train%20no.%20%24p_1%24%20is%20swapped%20with%20the%20car%20no.%20%24w_2%24%20of%20the%20train%20no.%20%24p_2%24.%5Cn%22%2C%22outputFormat%22%3A%22Your%20programme%20should%20write%20out%20exactly%20%24n%24%20lines.%20The%20%24k%5E%5Bth%7D%24%20line%20should%20contain%20one%20integer-the%20number%20of%20trains%20looking%20the%20same%20as%20the%20train%20no.%20%24k%24%20at%20certain%20moment.%5Cn%22%2C%22samples%22%3A%5B%5B%225%206%207%5Cnababbd%5Cnabbbbd%5Cnaaabad%5Cncaabbd%5Cncabaad%5Cn2%203%205%204%5Cn5%203%205%205%5Cn3%205%202%202%5Cn1%202%204%203%5Cn2%202%205%201%5Cn1%201%203%203%5Cn4%201%205%206%5Cn%22%2C%223%5Cn3%5Cn3%5Cn2%5Cn3%5Cn%22%5D%5D%2C%22hint%22%3A%22The%20figure%20presents%20the%20successive%20car%20swaps%3A%5Cn%5Cn%60%60%60cpp%5Cntrack%201%3A%20%20ababbd%20%20%20%20ababbd%20%20%20%20ababbd%20%20%20%20ababbd%20%20%20%20aaabbd%20%20%20%20aaabbd%20%20%20%20aaabbd%20%20%20%20aaabbd%5Cntrack%202%3A%20%20abbbbd%20%20%20%20ababbd%20%20%20%20ababbd%20%20%20%20aaabbd%20%20%20%20aaabbd%20%20%20%20acabbd%20%20%20%20acabbd%20%20%20%20acabbd%5Cntrack%203%3A%20%20aaabad%20-%3E%20aaabad%20-%3E%20aaabad%20-%3E%20aaabbd%20-%3E%20aaabbd%20-%3E%20aaabbd%20-%3E%20aaabbd%20-%3E%20aaabbd%5Cntrack%204%3A%20%20caabbd%20%20%20%20caabbd%20%20%20%20caabbd%20%20%20%20caabbd%20%20%20%20cabbbd%20%20%20%20cabbbd%20%20%20%20cabbbd%20%20%20%20dabbbd%5Cntrack%205%3A%20%20cabaad%20%20%20%20cabbad%20%20%20%20caabbd%20%20%20%20caabbd%20%20%20%20caabbd%20%20%20%20aaabbd%20%20%20%20aaabbd%20%20%20%20aaabbc%5Cn%20%20%20%20%20%20%20%20%20%20%20%280%29%20%20%20%20%20%20%20%281%29%20%20%20%20%20%20%20%282%29%20%20%20%20%20%20%20%283%29%20%20%20%20%20%20%20%284%29%20%20%20%20%20%20%20%285%29%20%20%20%20%20%20%20%286%29%20%20%20%20%20%20%20%287%29%5Cn%60%60%60%5Cn%5CnThe%20number%20of%20trains%20looking%20the%20same%20as%20either%20of%20the%20trains%20no.%201%2C%202%20or%203%20was%20maximal%20at%20time%20%284%29%20%28when%20all%20three%20looked%20the%20same%29.%20The%20number%20of%20trains%20looking%20the%20same%20as%20the%20train%20no.%205%20was%20maximal%20at%20time%20%285%29%20and%20%286%29.%20The%20number%20of%20trains%20looking%20the%20same%20as%20the%20train%20no.%204%20was%20maximal%20at%20time%20%282%29.%5Cn%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%5D%2C%22memory%22%3A%5B128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22tags%22%3A%5B25%2C57%2C78%2C219%2C235%2C319%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A211%2C%22totalAccepted%22%3A47%2C%22pid%22%3A%22P3471%22%2C%22title%22%3A%22%5BPOI2008%5DPOC-Trains%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A122387%2C%22title%22%3A%22%5Cu6c42%5Cu52a9%22%2C%22forum%22%3A%7B%22id%22%3A2565%2C%22name%22%3A%22P3471%20%5BPOI2008%5DPOC-Trains%22%2C%22slug%22%3A%22P3471%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P1587%22%2C%22title%22%3A%22%5BNOI2016%5D%5Cu5faa%5Cu73af%5Cu4e4b%5Cu7f8e%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P3285%22%2C%22title%22%3A%22%5BSCOI2014%5D%5Cu65b9%5Cu4f2f%5Cu4f2f%5Cu7684OJ%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P3292%22%2C%22title%22%3A%22%5BSCOI2016%5D%5Cu5e78%5Cu8fd0%5Cu6570%5Cu5b57%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P3475%22%2C%22title%22%3A%22%5BPOI2008%5DPOD-Subdivision%20of%20Kingdom%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P4036%22%2C%22title%22%3A%22%5BJSOI2008%5D%5Cu706b%5Cu661f%5Cu4eba%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22%5BPOI2008%5DPOC-Trains%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>[POI2008]POC-Trains</h1>
<h2>题目描述</h2>
<div>The Trains of Colour Parade begins tomorrow in Byteotia.
Intense preparations are already in progress at the station's auxiliary tracks. There are $n$ parallel tracks at the station, numbered from $1$ to $n$. The train no. $i$ occupies the $i^{th}$ track.
Every train consists of $l$ cars and each car is painted with one of 26 colours (denoted by non-capital letters of the English alphabet).
We say that two trains look the same, if their corresponding cars are painted the same colour.
Throughout the parade a crane will switch places of certain pairs of cars. The real parade, however, will take place tomorrow.
Today the train dispatcher, Byteasar, watched the general rehearsal closely. He even wrote down the sequence of car swaps.
Byteasar particularly dislikes many trains looking the same.
For each train $p$ he would like to calculate the maximum number of trains that at some moment look the same as the train $p$ at the very same moment.
## Task
Write a programme that:
- reads descriptions of the trains occupying tracks and the sequence of car swaps,
- for each train determines the maximum number of trains that look the same as it at certain moment,
- writes out the result.
给出n个字符串，长度均为len；
有m次操作，每次将两个字符交换；
求每个字符串在任何时点上，与相同的它最多的字符串个数；
</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line of the input contains three integers $n$, $l$ and $m$ ($2 \le n \le 1000$, $1 \le l \le 100$, $0 \le m \le 100\ 000$), denoting respectively the number of trains, their common length and the number of car swaps. The following $n$ lines contain descriptions of the trains on successive tracks. The
$k^{th}$ line consists of $l$ small letters of the English alphabet denoting the colours of successive cars of the $k^{th}$ train. Then $m$ lines describing the car swaps follow, in the order of the swaps. The $r^{th}$ line contains four integers $p_1$, $w_1$, $p_2$, $w_2$ ($1 \le p_1, p_2, \le n$, $1 \le w_1, w_2 \le l$, $p_1 \ne p_2$ or $w_1 \ne w_2$) denoting the $r^{th}$ car swap-the car no. $w_1$ of the train no. $p_1$ is swapped with the car no. $w_2$ of the train no. $p_2$.
</div>
<h3>输出格式</h3>
<br />
<div>Your programme should write out exactly $n$ lines. The $k^[th}$ line should contain one integer-the number of trains looking the same as the train no. $k$ at certain moment.
</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>5 6 7
ababbd
abbbbd
aaabad
caabbd
cabaad
2 3 5 4
5 3 5 5
3 5 2 2
1 2 4 3
2 2 5 1
1 1 3 3
4 1 5 6
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>3
3
3
2
3
</code></pre>
<h2>说明</h2>
<div>The figure presents the successive car swaps:
```cpp
track 1: ababbd ababbd ababbd ababbd aaabbd aaabbd aaabbd aaabbd
track 2: abbbbd ababbd ababbd aaabbd aaabbd acabbd acabbd acabbd
track 3: aaabad -> aaabad -> aaabad -> aaabbd -> aaabbd -> aaabbd -> aaabbd -> aaabbd
track 4: caabbd caabbd caabbd caabbd cabbbd cabbbd cabbbd dabbbd
track 5: cabaad cabbad caabbd caabbd caabbd aaabbd aaabbd aaabbc
(0) (1) (2) (3) (4) (5) (6) (7)
```
The number of trains looking the same as either of the trains no. 1, 2 or 3 was maximal at time (4) (when all three looked the same). The number of trains looking the same as the train no. 5 was maximal at time (5) and (6). The number of trains looking the same as the train no. 4 was maximal at time (2).
</div>
</article>
</div>
</div>
</body>
</html>
