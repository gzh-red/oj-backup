<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>[POI2011]DYN-Dynamite - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573376997:hI+sHRaOz0v2qXU0gq0dWY7FZ1lIhOcgVh/AV9VBWpA=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%22%2C%22description%22%3A%22The%20Byteotian%20Cave%20is%20composed%20of%20%24n%24%20chambers%20and%20%24n-1%24%20corridors%20that%20%20%20%20%20%20%20connect%20them.%20%20For%20every%20pair%20of%20chambers%20there%20is%20unique%20way%20to%20move%20%20%20%20%20%20%20from%20one%20of%20them%20to%20another%20without%20leaving%20the%20cave.%5Cn%5CnDynamite%20charges%20are%20set%20up%20in%20certain%20chambers.%5Cn%5CnA%20fuse%20is%20laid%20along%20every%20corridor.%5Cn%5CnIn%20every%20chamber%20the%20fuses%20from%20the%20adjacent%20corridors%20meet%20at%20one%20point%2C%20%20%20%20%20%20%20and%20are%20further%20connected%20to%20the%20dynamite%20charge%20if%20there%20is%20one%20in%20the%20%20%20%20%20%20%20chamber.%20%20It%20takes%20exactly%20one%20unit%20of%20time%20for%20the%20fuse%20between%20two%20%20%20%20%20%20%20neighbouring%20chambers%20to%20burn%2C%20and%20the%20dynamite%20charge%20explodes%20in%20the%20%20%20%20%20%20%20instant%20that%20fire%20reaches%20the%20chamber%20it%20is%20inside.%5Cn%5CnWe%20would%20like%20to%20light%20the%20fuses%20in%20some%20%24m%24%20chambers%20%28at%20the%20joints%20of%20%20%20%20%20%20%20fuses%29%20in%20such%20a%20way%20that%20all%20the%20dynamite%20charges%20explode%20in%20the%20shortest%20%20%20%20%20%20%20time%20possible%20since%20the%20fuses%20are%20lit.%20%20Write%20a%20program%20that%20will%20determine%20%20%20%20%20%20%20the%20minimum%20such%20time%20possible.%5Cn%5Cn%5Cu7ed9%5Cu4e00%5Cu68f5%5Cu6811%2C%5Cu4e66%5Cu4e0a%5Cu6709%5Cu4e00%5Cu4e9b%5Cu5173%5Cu952e%5Cu8282%5Cu70b9%5Cuff0c%5Cu8981%5Cu6c42%5Cu4f60%5Cu9009m%5Cu4e2a%5Cu70b9%5Cuff0c%5Cu4f7f%5Cu5f97%5Cu5173%5Cu952e%5Cu8282%5Cu70b9%5Cu5230%5Cu8fd9%5Cu4e9b%5Cu70b9%5Cu4e2d%5Cu8ddd%5Cu79bb%5Cu7684%5Cu6700%5Cu5c0f%5Cu503c%5Cu7684%5Cu6700%5Cu5927%5Cu503c%5Cu6700%5Cu5c0f%5Cuff0c%5Cu6c42%5Cu8fd9%5Cu4e2a%5Cu503c%5Cn%22%2C%22inputFormat%22%3A%22The%20first%20line%20of%20the%20standard%20input%20holds%20two%20integers%20%24n%24%20and%20%24m%24%28%241%5C%5Cle%20m%5C%5Cle%20n%5C%5Cle%20300%5C%5C%20000%24%29%2C%20separated%20by%20a%20single%20space%2C%20that%20denote%2C%20respectively%2C%20the%20number%20of%20chambers%20in%20the%20cave%20and%20the%20number%20of%20chambers%20in%20which%20fire%20can%20be%20set%20to%20the%20fuses.%5Cn%5CnThe%20chambers%20are%20numbered%20from%201%20to%20%24n%24.%5Cn%5CnThe%20next%20line%20contains%20%24n%24%20integers%20%24d_1%2Cd_2%2C%5C%5Ccdots%2Cd_n%24%20%28%24d_i%5C%5Cin%20%5C%5C%7B0%2C1%5C%5C%7D%24%29%2C%20separated%20by%20single%20spaces.%5Cn%5CnIf%20%24d_i%3D1%24%2C%20then%20there%20is%20dynamite%20in%20the%20%24i%24-th%20chamber%2C%20and%20if%20%24d_i%3D0%24%2C%20there%20is%20none.The%20following%20%24n-1%24%20lines%20specify%20the%20corridors%20of%20the%20cave.%20Each%20of%20them%20holds%20two%20integers%20%24a%2Cb%24%28%241%5C%5Cle%20a%3Cb%5C%5Cle%20n%24%29%2C%20separated%20by%20a%20single%20space%2C%20denoting%20that%20there%20is%20a%20corridor%20connecting%20the%20chambers%20%24a%24%20and%20%24b%24.%20Every%20corridor%20appears%20exactly%20once%20in%20the%20description.%5Cn%5CnYou%20may%20assume%20that%20in%20tests%20worth%2010%25%20of%20the%20points%20it%20holds%20additionally%20that%20%24n%5C%5Cle%2010%24%20%2C%20while%20in%20tests%20worth%2040%25%20of%20the%20points%20it%20holds%20that%20%24n%5C%5Cle%201%5C%5C%20000%24%5Cn%22%2C%22outputFormat%22%3A%22The%20first%20and%20only%20line%20of%20the%20standard%20output%20should%20hold%20a%20single%20%20%20%20%20%20%20%20%20integer%2C%20equal%20to%20the%20minimum%20time%20it%20takes%20from%20lighting%20the%20fuses%20%20%20%20%20%20%20%20%20to%20the%20explosion%20of%20all%20the%20charges.%5Cn%22%2C%22samples%22%3A%5B%5B%227%202%5Cn1%200%201%201%200%201%201%5Cn1%203%5Cn2%203%5Cn3%204%5Cn4%205%5Cn5%206%5Cn5%207%22%2C%221%5Cn%22%5D%5D%2C%22hint%22%3A%22%5Cu7ed9%5Cu4e00%5Cu68f5%5Cu6811%2C%5Cu4e66%5Cu4e0a%5Cu6709%5Cu4e00%5Cu4e9b%5Cu5173%5Cu952e%5Cu8282%5Cu70b9%5Cuff0c%5Cu8981%5Cu6c42%5Cu4f60%5Cu9009m%5Cu4e2a%5Cu70b9%5Cuff0c%5Cu4f7f%5Cu5f97%5Cu5173%5Cu952e%5Cu8282%5Cu70b9%5Cu5230%5Cu8fd9%5Cu4e9b%5Cu70b9%5Cu4e2d%5Cu8ddd%5Cu79bb%5Cu7684%5Cu6700%5Cu5c0f%5Cu503c%5Cu7684%5Cu6700%5Cu5927%5Cu503c%5Cu6700%5Cu5c0f%5Cuff0c%5Cu6c42%5Cu8fd9%5Cu4e2a%5Cu503c%5Cn%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%5D%2C%22memory%22%3A%5B128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22tags%22%3A%5B7%2C28%2C45%2C57%2C152%2C319%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A864%2C%22totalAccepted%22%3A253%2C%22pid%22%3A%22P3523%22%2C%22title%22%3A%22%5BPOI2011%5DDYN-Dynamite%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A84954%2C%22title%22%3A%22%5Cu8c01%5Cu80fd%5Cu89e3%5Cu91ca%5Cu4e00%5Cu4e0b%5Cu9898%5Cu610f%5Cu554a%5Cu3002%5Cu3002%22%2C%22forum%22%3A%7B%22id%22%3A2603%2C%22name%22%3A%22P3523%20%5BPOI2011%5DDYN-Dynamite%22%2C%22slug%22%3A%22P3523%22%7D%7D%2C%7B%22id%22%3A46404%2C%22title%22%3A%22%5Cu542c%5Cu8bf4%5Cu8fd9%5Cu4e2a%5Cu9898%5Cu6709%5Cu4e2aO%5Cuff08n%5Cuff09%5Cu7684%5Cu7b97%5Cu6cd5%5Cuff1f%22%2C%22forum%22%3A%7B%22id%22%3A2603%2C%22name%22%3A%22P3523%20%5BPOI2011%5DDYN-Dynamite%22%2C%22slug%22%3A%22P3523%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P3942%22%2C%22title%22%3A%22%5Cu5c06%5Cu519b%5Cu4ee4%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P3177%22%2C%22title%22%3A%22%5BHAOI2015%5D%5Cu6811%5Cu4e0a%5Cu67d3%5Cu8272%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P3527%22%2C%22title%22%3A%22%5BPOI2011%5DMET-Meteors%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P3554%22%2C%22title%22%3A%22%5BPOI2013%5DLUK-Triumphal%20arch%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22SP10264%22%2C%22title%22%3A%22METEORS%20-%20Meteors%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22SP%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22%5BPOI2011%5DDYN-Dynamite%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573286098;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>[POI2011]DYN-Dynamite</h1>
<h2>题目描述</h2>
<div>The Byteotian Cave is composed of $n$ chambers and $n-1$ corridors that connect them. For every pair of chambers there is unique way to move from one of them to another without leaving the cave.
Dynamite charges are set up in certain chambers.
A fuse is laid along every corridor.
In every chamber the fuses from the adjacent corridors meet at one point, and are further connected to the dynamite charge if there is one in the chamber. It takes exactly one unit of time for the fuse between two neighbouring chambers to burn, and the dynamite charge explodes in the instant that fire reaches the chamber it is inside.
We would like to light the fuses in some $m$ chambers (at the joints of fuses) in such a way that all the dynamite charges explode in the shortest time possible since the fuses are lit. Write a program that will determine the minimum such time possible.
给一棵树,书上有一些关键节点，要求你选m个点，使得关键节点到这些点中距离的最小值的最大值最小，求这个值
</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line of the standard input holds two integers $n$ and $m$($1\le m\le n\le 300\ 000$), separated by a single space, that denote, respectively, the number of chambers in the cave and the number of chambers in which fire can be set to the fuses.
The chambers are numbered from 1 to $n$.
The next line contains $n$ integers $d_1,d_2,\cdots,d_n$ ($d_i\in \{0,1\}$), separated by single spaces.
If $d_i=1$, then there is dynamite in the $i$-th chamber, and if $d_i=0$, there is none.The following $n-1$ lines specify the corridors of the cave. Each of them holds two integers $a,b$($1\le a<b\le n$), separated by a single space, denoting that there is a corridor connecting the chambers $a$ and $b$. Every corridor appears exactly once in the description. You may assume that in tests worth 10% of the points it holds additionally that $n\le 10$ , while in tests worth 40% of the points it holds that $n\le 1\ 000$ </div>
<h3>输出格式</h3>
<br />
<div>The first and only line of the standard output should hold a single integer, equal to the minimum time it takes from lighting the fuses to the explosion of all the charges.
</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>7 2
1 0 1 1 0 1 1
1 3
2 3
3 4
4 5
5 6
5 7</code></pre>
<h3>输出样例 #1</h3>
<pre><code>1
</code></pre>
<h2>说明</h2>
<div>给一棵树,书上有一些关键节点，要求你选m个点，使得关键节点到这些点中距离的最小值的最大值最小，求这个值
</div>
</article>
</div>
</div>
</body>
</html>
