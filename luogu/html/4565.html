<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>[CTSC2018]暴力写挂 - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573381561:ph9xeWNepgXQIsxOcbEV923bnzV+r+FK/8DFgOJ5uso=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%22%2C%22description%22%3A%22temporaryDO%20%5Cu662f%5Cu4e00%5Cu4e2a%5Cu5f88%5Cu83dc%5Cu7684%20OIer%20%5Cu3002%5Cu5728%204%20%5Cu6708%5Cuff0c%5Cu4ed6%5Cu5728%5Cu7701%5Cu961f%5Cu9009%5Cu62d4%5Cu8d5b%5Cu7684%5Cu8003%5Cu573a%5Cu4e0a%5Cu89c1%5Cu5230%5Cu4e86%5Cu300a%5Cu6797%5Cu514b%5Cu5361%5Cu7279%5Cu6811%5Cu300b%5Cu4e00%5Cu9898%5Cuff0c%5Cu5176%5Cu4e2d%20%24k%20%3D%200%24%20%5Cu7684%5Cu90e8%5Cu5206%5Cu5206%5Cu662f%5Cu6c42%5Cu6811%20%24T%24%20%5Cu4e0a%5Cu7684%5Cu6700%5Cu957f%5Cu94fe%5Cu3002%5Cu53ef%5Cu601c%5Cu7684%20temporaryDO%20%5Cu5e76%5Cu4e0d%5Cu4f1a%5Cu505a%5Cu8fd9%5Cu9053%5Cu9898%5Cuff0c%5Cu4ed6%5Cu5728%5Cu8003%5Cu573a%5Cu4e0a%5Cu6293%5Cu732b%5Cu8033%5Cu6320%5Cu732b%5Cu816e%5Cu90fd%5Cu60f3%5Cu4e0d%5Cu51fa%5Cu4e00%5Cu70b9%5Cu601d%5Cu8def%5Cu3002%5Cn%5Cn%5Cu8fd9%5Cu65f6%5Cuff0c%5Cu5584%5Cu826f%5Cu7684%5Cu677f%5Cu677f%5Cu51fa%5Cu73b0%5Cu5728%5Cu4e86%5Cu7a7a%5Cu4e2d%5Cuff0c%5Cu4ed6%5Cu7684%5Cu8eab%5Cu4e0a%5Cu53d1%5Cu51fa%5Cu7480%5Cu74a8%5Cu5374%5Cu67d4%5Cu548c%5Cu7684%5Cu5149%5Cu8292%5Cuff0c%5Cu8361%5Cu6f3e%5Cu5728%5Cu8003%5Cu573a%5Cu4e0a%5Cu3002%5Cu201c%5Cu9898%5Cu76ee%5Cu5e76%5Cu4e0d%5Cu96be%5Cu3002%5Cu201d%20%5Cu677f%5Cu677f%5Cu8bf4%5Cu3002%5Cu90a3%5Cu5145%5Cu6ee1%5Cu78c1%5Cu6027%5Cu7684%5Cu58f0%5Cu97f3%5Cuff0c%5Cu8ba9%20temporaryDO%20%5Cu5168%5Cu8eab%5Cu5145%5Cu6ee1%5Cu4e86%5Cu529b%5Cu91cf%5Cu3002%5Cn%5Cn%5Cu4ed6%5Cu51b3%5Cu5b9a%5Cuff1a%5Cu5199%5Cu4e00%5Cu4e2a%5Cu679a%5Cu4e3e%5Cu70b9%5Cu5bf9%5Cu6c42%20LCA%20%5Cu7b97%5Cu8ddd%5Cu79bb%5Cu7684%20%24k%20%3D%200%24%20%5Cu7684%20%24O%28n%5E2%5C%5C%20log%5C%5C%20n%29%24%20%5Cu7684%5Cu90e8%5Cu5206%5Cu5206%5Cu7a0b%5Cu5e8f%5Cuff01%5Cu4e8e%5Cu662f%5Cuff0c%20temporaryDO%20%5Cu9009%5Cu62e9%5Cu4ee5%20%241%24%20%5Cu4e3a%5Cu6839%5Cuff0c%5Cu5efa%5Cu7acb%5Cu4e86%5Cu6c42%20LCA%20%5Cu7684%5Cu6811%5Cu94fe%5Cu5256%5Cu5206%5Cu7ed3%5Cu6784%5Cuff0c%5Cu7136%5Cu540e%5Cu5199%5Cu4e86%5Cu4e8c%5Cu91cd%20for%20%5Cu5faa%5Cu73af%5Cu679a%5Cu4e3e%5Cu70b9%5Cu5bf9%5Cu3002%5Cn%5Cn%5Cu7136%5Cu800c%5Cuff0c%5Cu83dc%5Cu83dc%5Cu7684%20temporaryDO%20%5Cu4e0d%5Cu5c0f%5Cu5fc3%5Cu5f00%5Cu5c0f%5Cu4e86%5Cu6570%5Cu7ec4%5Cuff0c%5Cu4e8e%5Cu662f%5Cu6570%5Cu7ec4%5Cu8d8a%5Cu754c%5Cu5230%5Cu4e86%5Cu4e00%5Cu7247%5Cu795e%5Cu79d8%5Cu7684%5Cu5185%5Cu5b58%5Cu533a%5Cu57df%5Cu3002%5Cu4f46%5Cu6070%5Cu597d%5Cu7684%5Cu662f%5Cuff0c%5Cu90a3%5Cu7247%5Cu5185%5Cu5b58%5Cu533a%5Cu57df%5Cu5b58%5Cu50a8%5Cu7684%5Cu533a%5Cu57df%5Cu6070%5Cu597d%5Cu662f%5Cu53e6%5Cu4e00%5Cu68f5%5Cu6811%20%24T%27%24%20%5Cu3002%5Cu8fd9%5Cu6837%5Cu4e00%5Cu6765%5Cuff0c%5Cu7a0b%5Cu5e8f%5Cu5e76%5Cu6ca1%5Cu6709%20RE%20%5Cuff0c%5Cu4f46%5Cu4ed6%5Cu6c42%20%24x%24%20%5Cu548c%20%24y%24%20%5Cu7684%5Cu8ddd%5Cu79bb%5Cu7684%5Cu65f6%5Cu5019%5Cuff0c%5Cu8ba1%5Cu7b97%5Cu7684%5Cu662f%20%5Cn%5Cn%24%24%20%5C%5Cmathrm%7Bdepth%7D%28x%29%20%2B%20%5C%5Cmathrm%7Bdepth%7D%28y%29%20-%20%20%28%7B%5C%5Cmathrm%7Bdepth%7D%28%5C%5Cmathrm%7BLCA%7D%28x%2Cy%29%29%7D%2B%7B%5C%5Cmathrm%7Bdepth%27%7D%28%5C%5Cmathrm%7BLCA%27%7D%28x%2Cy%29%29%7D%29%24%24%5Cn%5Cn%5Cn%5Cn%5Cu6700%5Cu540e%5Cu7a0b%5Cu5e8f%5Cu4f1a%5Cu8f93%5Cu51fa%5Cu6bcf%5Cu4e00%5Cu5bf9%5Cu70b9%5Cu5bf9%24i%2C%20j%20%28i%20%5C%5Cle%20j%29%24%20%5Cu7684%5Cu5982%5Cu4e0a%5Cu5b9a%5Cu4e49%5Cu7684%5Cu201c%5Cu8ddd%5Cu79bb%5Cu201d%20%5Cu7684%5Cu6700%5Cu5927%5Cu503c%5Cu3002%5CntemporaryDO%20%5Cu7684%5Cu7a0b%5Cu5e8f%5Cu5728%5Cu8bc4%5Cu6d4b%5Cu65f6%5Cu5149%5Cu8363%5Cu5730%5Cu7206%5Cu96f6%5Cu4e86%5Cu3002%5Cu4f46%5Cu4ed6%5Cu5e76%5Cu4e0d%5Cu670d%5Cu6c14%5Cuff0c%5Cu4ed6%5Cu51b3%5Cu5b9a%5Cu82b1%5Cu597d%5Cu51e0%5Cu5929%5Cu628a%5Cu81ea%5Cu5df1%5Cu7684%5Cu7a0b%5Cu5e8f%5Cu8dd1%5Cu51fa%5Cu6765%5Cu3002%5Cu8bf7%5Cu4f60%5Cu6839%5Cu636e%20%24T%24%20%5Cu548c%20%24T%27%24%20%5Cu5e2e%5Cu5e2e%5Cu53ef%5Cu601c%5Cu7684%20temporaryDO%20%5Cu6c42%5Cu51fa%5Cu4ed6%5Cu7a0b%5Cu5e8f%5Cu7684%5Cu8f93%5Cu51fa%5Cu3002%22%2C%22inputFormat%22%3A%22%5Cu7b2c%5Cu4e00%5Cu884c%5Cu5305%5Cu542b%5Cu4e00%5Cu4e2a%5Cu6574%5Cu6570%20%24n%24%20%5Cuff0c%5Cu8868%5Cu793a%5Cu6811%5Cu4e0a%5Cu7684%5Cu8282%5Cu70b9%5Cu4e2a%5Cu6570%5Cuff1b%20%20%5Cn%5Cu7b2c%20%242%24%20%5Cu5230%5Cu7b2c%20%24n%24%20%5Cu884c%5Cuff0c%5Cu6bcf%5Cu884c%5Cu4e09%5Cu4e2a%5Cu6574%5Cu6570%20%24x%20%2C%20y%20%2C%20v%24%20%5Cuff0c%5Cu8868%5Cu793a%20%24T%24%20%5Cu4e2d%5Cu5b58%5Cu5728%5Cu4e00%5Cu6761%5Cu4ece%20%24x%24%20%5Cu5230%20%24y%24%20%5Cu7684%5Cu8fb9%5Cuff0c%5Cu5176%5Cu957f%5Cu5ea6%5Cu4e3a%20%24v%24%20%5Cuff1b%20%20%20%5Cn%5Cu7b2c%20%24n%20%2B%201%24%20%5Cu5230%5Cu7b2c%20%242n-1%24%20%20%20%5Cuff0c%5Cu6bcf%5Cu884c%5Cu4e09%5Cu4e2a%5Cu6574%5Cu6570%20%24x%20%2C%20y%20%2C%20v%24%20%5Cuff0c%5Cu8868%5Cu793a%20%24T%27%24%20%5Cu4e2d%5Cu5b58%5Cu5728%5Cu4e00%5Cu6761%5Cu4ece%20%24x%24%20%5Cu5230%20%24y%24%20%5Cu7684%5Cu8fb9%5Cuff0c%5Cu5176%5Cu957f%5Cu5ea6%5Cu4e3a%20%24v%24%20%5Cu3002%22%2C%22outputFormat%22%3A%22%5Cu8f93%5Cu51fa%5Cu4e00%5Cu884c%5Cu4e00%5Cu4e2a%5Cu6574%5Cu6570%5Cuff0c%5Cu8868%5Cu793a%20temporaryDO%20%5Cu7684%5Cu7a0b%5Cu5e8f%5Cu7684%5Cu8f93%5Cu51fa%5Cu3002%5Cn%22%2C%22samples%22%3A%5B%5B%226%5Cn1%202%202%5Cn1%203%200%5Cn2%204%201%5Cn2%205%20-7%5Cn3%206%200%5Cn1%202%20-1%5Cn2%203%20-1%5Cn2%205%203%5Cn2%206%20-2%5Cn3%204%208%22%2C%225%5Cn%22%5D%5D%2C%22hint%22%3A%22%23%23%23%20%5Cu6837%5Cu4f8b%5Cu89e3%5Cu91ca%201%5Cn%5Cu70b9%5Cu5bf9%20%24%283%2C%204%29%24%20%5Cu7684%5Cu8ddd%5Cu79bb%5Cu8ba1%5Cu7b97%5Cu4e3a%20%243%20%2B%200%20-%20%280%20%2B%20%28-2%29%29%20%3D%205%24%20%5Cu3002%5Cn%5Cn%23%23%23%20%5Cu6570%5Cu636e%5Cu8303%5Cu56f4%5Cn%5Cu5bf9%5Cu4e8e%5Cu6240%5Cu6709%5Cu6570%5Cu636e%5Cuff0c%20%24n%20%5C%5Cle%20366666%20%2C%20%7Cv%7C%20%5C%5Cle%202017011328%24%20%5Cu3002%20%5Cu8be6%5Cu7ec6%5Cu6570%5Cu636e%5Cu8303%5Cu56f4%5Cu89c1%5Cu4e0b%5Cu8868%5Cuff0c%5Cu8868%5Cu683c%5Cu4e2d%5Cu7684%5Cu201c%5Cu65e0%5Cu201d%20%5Cu8868%5Cu793a%5Cu65e0%5Cu7279%5Cu6b8a%5Cu9650%5Cu5236%5Cu3002%5Cn%5Cn%5Cu6d4b%5Cu8bd5%5Cu70b9%5Cu7f16%5Cu53f7%7C%24n%20%5C%5Cle%24%7Cv%7CT%20%5Cu662f%5Cu4e00%5Cu6761%5Cu94fe%7CT%27%20%5Cu662f%5Cu4e00%5Cu6761%5Cu94fe%5Cn-%7C-%7C-%7C-%7C-%5Cn1%7C36%7C%3D1%7C%5Cu5426%7C%5Cu5426%5Cn2%7C366%7C%3D1%7C%5Cu5426%7C%5Cu5426%5Cn3%7C1388%7C%3E0%7C%5Cu5426%7C%5Cu5426%5Cn4%7C1999%7C%3E0%7C%5Cu5426%7C%5Cu5426%5Cn5%7C2666%7C%3E0%7C%5Cu5426%7C%5Cu5426%5Cn6%7C5666%7C%5Cu65e0%7C%5Cu5426%7C%5Cu5426%5Cn7%7C8666%7C%5Cu65e0%7C%5Cu5426%7C%5Cu5426%5Cn8%7C11111%7C%5Cu65e0%7C%5Cu5426%7C%5Cu5426%5Cn9%7C12345%7C%5Cu65e0%7C%5Cu5426%7C%5Cu5426%5Cn10%7C366666%7C%3E0%7C%5Cu662f%7C%5Cu662f%5Cn11%7C366666%7C%5Cu65e0%7C%5Cu662f%7C%5Cu662f%5Cn12~13%7C366666%7C%3E0%7C%5Cu662f%7C%5Cu5426%5Cn14%7C366666%7C%5Cu65e0%7C%5Cu662f%7C%5Cu5426%5Cn15~16%7C366666%7C%3E0%7C%5Cu5426%7C%5Cu662f%5Cn17%7C366666%7C%5Cu65e0%7C%5Cu5426%7C%5Cu662f%5Cn18~20%7C366666%7C%5Cu65e0%7C%5Cu5426%7C%5Cu5426%5Cn%5Cndepth%28p%29%20%5Cu548c%20depth%27%28p%29%20%5Cu5206%5Cu522b%5Cu8868%5Cu793a%5Cu6811%20%24T%24%20%5Cu3001%20%24T%27%24%20%5Cu4e2d%5Cu70b9%20%241%24%20%5Cu5230%5Cu70b9%20%24p%24%20%5Cu7684%5Cu8ddd%5Cu79bb%5Cuff0c%5Cu8fd9%5Cu91cc%5Cu89c4%5Cu5b9a%5Cuff0c%5Cu8ddd%5Cu79bb%5Cu6307%5Cu7684%5Cu662f%5Cu7ecf%5Cu8fc7%5Cu7684%5Cu8fb9%5Cu7684%5Cu8fb9%5Cu6743%5Cu603b%5Cu548c%5Cuff0c%5Cu5176%5Cu4e2d%20%24%5C%5Cmathrm%7Bdepth%7D%281%29%20%3D%200%24%20%5Cu3002%5CnLCA%28x%2C%20y%29%20%5Cu548c%20LCA%27%28x%2C%20y%29%20%5Cu5206%5Cu522b%5Cu8868%5Cu793a%5Cu6811%20%24T%24%20%5Cu3001%20%24T%27%24%20%5Cu4e2d%5Cu70b9%20%24x%24%20%5Cu4e0e%5Cu70b9%20%24y%24%20%5Cu7684%5Cu6700%5Cu8fd1%5Cu516c%5Cu5171%5Cu7956%5Cu5148%5Cuff0c%5Cu5373%5Cu5728%5Cu4ece%20%24x%24%20%5Cu5230%20%24y%24%20%5Cu7684%5Cu6700%5Cu77ed%5Cu8def%5Cu5f84%5Cu4e0a%5Cu7684%5Cu8ddd%5Cu79bb%5Cu6839%2A%2A%5Cu7ecf%5Cu8fc7%5Cu8fb9%5Cu6570%5Cu6700%5Cu5c11%2A%2A%5Cu7684%5Cu70b9%5Cu3002%22%2C%22provider%22%3A%7B%22uid%22%3A50167%2C%22name%22%3A%22Imagine%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3Anull%2C%22isAdmin%22%3Afalse%2C%22color%22%3A%22Blue%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B4000%2C4000%2C4000%2C4000%2C4000%2C4000%2C4000%2C4000%2C4000%2C4000%2C4000%2C4000%2C4000%2C4000%2C4000%2C4000%2C4000%2C4000%2C4000%2C4000%5D%2C%22memory%22%3A%5B512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22tags%22%3A%5B35%2C42%2C52%2C108%2C112%2C211%2C319%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A870%2C%22totalAccepted%22%3A189%2C%22pid%22%3A%22P4565%22%2C%22title%22%3A%22%5BCTSC2018%5D%5Cu66b4%5Cu529b%5Cu5199%5Cu6302%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A110670%2C%22title%22%3A%22%5Cu5982%5Cu679c%5Cu4f6090%5Cu5206%5Cu2026%5Cu2026%22%2C%22forum%22%3A%7B%22id%22%3A25744%2C%22name%22%3A%22P4565%20%5BCTSC2018%5D%5Cu66b4%5Cu529b%5Cu5199%5Cu6302%22%2C%22slug%22%3A%22P4565%22%7D%7D%2C%7B%22id%22%3A42443%2C%22title%22%3A%22%5Cu9898%5Cu76ee%5Cu63cf%5Cu8ff0%5Cu6709%5Cu8bef%22%2C%22forum%22%3A%7B%22id%22%3A25744%2C%22name%22%3A%22P4565%20%5BCTSC2018%5D%5Cu66b4%5Cu529b%5Cu5199%5Cu6302%22%2C%22slug%22%3A%22P4565%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P1407%22%2C%22title%22%3A%22%5B%5Cu56fd%5Cu5bb6%5Cu96c6%5Cu8bad%5Cu961f%5D%5Cu7a33%5Cu5b9a%5Cu5a5a%5Cu59fb%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P4220%22%2C%22title%22%3A%22%5BWC2018%5D%5Cu901a%5Cu9053%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P4602%22%2C%22title%22%3A%22%5BCTSC2018%5D%5Cu6df7%5Cu5408%5Cu679c%5Cu6c41%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P4566%22%2C%22title%22%3A%22%5BCTSC2018%5D%5Cu9752%5Cu8548%5Cu9886%5Cu4e3b%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P5251%22%2C%22title%22%3A%22%5BLnOI2019%5D%5Cu7b2c%5Cu4e8c%5Cu4ee3%5Cu56fe%5Cu7075%5Cu673a%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22%5BCTSC2018%5D%5Cu66b4%5Cu529b%5Cu5199%5Cu6302%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573295103;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>[CTSC2018]暴力写挂</h1>
<h2>题目描述</h2>
<div>temporaryDO 是一个很菜的 OIer 。在 4 月，他在省队选拔赛的考场上见到了《林克卡特树》一题，其中 $k = 0$ 的部分分是求树 $T$ 上的最长链。可怜的 temporaryDO 并不会做这道题，他在考场上抓猫耳挠猫腮都想不出一点思路。
这时，善良的板板出现在了空中，他的身上发出璀璨却柔和的光芒，荡漾在考场上。“题目并不难。” 板板说。那充满磁性的声音，让 temporaryDO 全身充满了力量。
他决定：写一个枚举点对求 LCA 算距离的 $k = 0$ 的 $O(n^2\ log\ n)$ 的部分分程序！于是， temporaryDO 选择以 $1$ 为根，建立了求 LCA 的树链剖分结构，然后写了二重 for 循环枚举点对。
然而，菜菜的 temporaryDO 不小心开小了数组，于是数组越界到了一片神秘的内存区域。但恰好的是，那片内存区域存储的区域恰好是另一棵树 $T'$ 。这样一来，程序并没有 RE ，但他求 $x$ 和 $y$ 的距离的时候，计算的是
$$ \mathrm{depth}(x) + \mathrm{depth}(y) - ({\mathrm{depth}(\mathrm{LCA}(x,y))}+{\mathrm{depth'}(\mathrm{LCA'}(x,y))})$$
最后程序会输出每一对点对$i, j (i \le j)$ 的如上定义的“距离” 的最大值。
temporaryDO 的程序在评测时光荣地爆零了。但他并不服气，他决定花好几天把自己的程序跑出来。请你根据 $T$ 和 $T'$ 帮帮可怜的 temporaryDO 求出他程序的输出。</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>第一行包含一个整数 $n$ ，表示树上的节点个数；
第 $2$ 到第 $n$ 行，每行三个整数 $x , y , v$ ，表示 $T$ 中存在一条从 $x$ 到 $y$ 的边，其长度为 $v$ ；
第 $n + 1$ 到第 $2n-1$ ，每行三个整数 $x , y , v$ ，表示 $T'$ 中存在一条从 $x$ 到 $y$ 的边，其长度为 $v$ 。</div>
<h3>输出格式</h3>
<br />
<div>输出一行一个整数，表示 temporaryDO 的程序的输出。
</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>6
1 2 2
1 3 0
2 4 1
2 5 -7
3 6 0
1 2 -1
2 3 -1
2 5 3
2 6 -2
3 4 8</code></pre>
<h3>输出样例 #1</h3>
<pre><code>5
</code></pre>
<h2>说明</h2>
<div>### 样例解释 1
点对 $(3, 4)$ 的距离计算为 $3 + 0 - (0 + (-2)) = 5$ 。
### 数据范围
对于所有数据， $n \le 366666 , |v| \le 2017011328$ 。 详细数据范围见下表，表格中的“无” 表示无特殊限制。
测试点编号|$n \le$|v|T 是一条链|T' 是一条链
-|-|-|-|-
1|36|=1|否|否
2|366|=1|否|否
3|1388|>0|否|否
4|1999|>0|否|否
5|2666|>0|否|否
6|5666|无|否|否
7|8666|无|否|否
8|11111|无|否|否
9|12345|无|否|否
10|366666|>0|是|是
11|366666|无|是|是
12~13|366666|>0|是|否
14|366666|无|是|否
15~16|366666|>0|否|是
17|366666|无|否|是
18~20|366666|无|否|否
depth(p) 和 depth'(p) 分别表示树 $T$ 、 $T'$ 中点 $1$ 到点 $p$ 的距离，这里规定，距离指的是经过的边的边权总和，其中 $\mathrm{depth}(1) = 0$ 。
LCA(x, y) 和 LCA'(x, y) 分别表示树 $T$ 、 $T'$ 中点 $x$ 与点 $y$ 的最近公共祖先，即在从 $x$ 到 $y$ 的最短路径上的距离根**经过边数最少**的点。</div>
</article>
</div>
</div>
</body>
</html>
