<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>[USACO08OPEN]寻宝之路Clear And Present Danger - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573376132:3lXZoYw2SG/a8h3gHBUJhvkosDDgZO7r/VP70NMCIf4=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%22%2C%22description%22%3A%22Farmer%20John%20is%20on%20a%20boat%20seeking%20fabled%20treasure%20on%20one%20of%20the%20N%20%281%20%3C%3D%20N%20%3C%3D%20100%29%20islands%20conveniently%20labeled%201..N%20in%20the%20Cowribbean%20Sea.%5Cn%5CnThe%20treasure%20map%20tells%20him%20that%20he%20must%20travel%20through%20a%20certain%20sequence%20A%5C%5C_1%2C%20A%5C%5C_2%2C%20...%2C%20A%5C%5C_M%20of%20M%20%282%20%3C%3D%20M%20%3C%3D%2010%2C000%29%20islands%2C%20starting%20on%20island%201%20and%20ending%20on%20island%20N%20before%20the%20treasure%20will%20appear%20to%20him.%20He%20can%20visit%20these%20and%20other%20islands%20out%20of%20order%20and%20even%20more%20than%20once%2C%20but%20his%20trip%20must%20include%20the%20A%5C%5C_i%20sequence%20in%20the%20order%20specified%20by%20the%20map.%5Cn%5CnFJ%20wants%20to%20avoid%20pirates%20and%20knows%20the%20pirate-danger%20rating%20%280%20%3C%3D%20danger%20%3C%3D%20100%2C000%29%20between%20each%20pair%20of%20islands.%20The%20total%20danger%20rating%20of%20his%20mission%20is%20the%20sum%20of%20the%20danger%20ratings%20of%20all%20the%20paths%20he%20traverses.%5Cn%5CnHelp%20Farmer%20John%20find%20the%20least%20dangerous%20route%20to%20the%20treasure%20that%20satisfies%20the%20treasure%20map%27s%20requirement.%5Cn%5Cn%5Cu519c%5Cu592b%5Cu7ea6%5Cu7ff0%5Cu6b63%5Cu9a7e%5Cu9a76%5Cu4e00%5Cu6761%5Cu5c0f%5Cu8247%5Cu5728%5Cu725b%5Cu52d2%5Cu6bd4%5Cu6d77%5Cu4e0a%5Cu822a%5Cu884c%5Cuff0e%5Cn%5Cn%5Cu6d77%5Cu4e0a%5Cu6709N%281%5Cu2264N%5Cu2264100%29%5Cu4e2a%5Cu5c9b%5Cu5c7f%5Cuff0c%5Cu75281%5Cu5230N%5Cu7f16%5Cu53f7%5Cuff0e%5Cu7ea6%5Cu7ff0%5Cu4ece1%5Cu53f7%5Cu5c0f%5Cu5c9b%5Cu51fa%5Cu53d1%5Cuff0c%5Cu6700%5Cu540e%5Cu5230%5Cu8fbeN%5Cu53f7%5Cu5c0f%5Cu5c9b%5Cuff0e%5Cn%5Cn%5Cu4e00%5Cu5f20%5Cu85cf%5Cu5b9d%5Cu56fe%5Cu4e0a%5Cu8bf4%5Cuff0c%5Cu5982%5Cu679c%5Cu4ed6%5Cu7684%5Cu8def%5Cu7a0b%5Cu4e0a%5Cu7ecf%5Cu8fc7%5Cu7684%5Cu5c0f%5Cu5c9b%5Cu4f9d%5Cu6b21%5Cu51fa%5Cu73b0%5Cu4e86Ai%5Cuff0cA2%5Cuff0c%5Cu2026%5Cuff0cAM%282%5Cu2264M%5Cu226410000%29%5Cu8fd9%5Cu6837%5Cu7684%5Cu5e8f%5Cu5217%5Cuff08%5Cu4e0d%5Cu4e00%5Cu5b9a%5Cu76f8%5Cu90bb%5Cuff09%5Cuff0c%5Cu90a3%5Cu4ed6%5Cu6700%5Cu7ec8%5Cu5c31%5Cu80fd%5Cu627e%5Cu5230%5Cu53e4%5Cu8001%5Cu7684%5Cu5b9d%5Cu85cf%5Cuff0e%20%20%5Cu4f46%5Cu662f%5Cuff0c%5Cu7531%5Cu4e8e%5Cu725b%5Cu52d2%5Cu6bd4%5Cu6d77%5Cu6709%5Cu6d77%5Cu76d7%5Cu51fa%5Cu6ca1%5Cuff0e%5Cu7ea6%5Cu7ff0%5Cu77e5%5Cu9053%5Cu4efb%5Cu610f%5Cu4e24%5Cu4e2a%5Cu5c9b%5Cu5c7f%5Cu4e4b%5Cu95f4%5Cu7684%5Cu822a%5Cu7ebf%5Cu4e0a%5Cu6d77%5Cu76d7%5Cu51fa%5Cu6ca1%5Cu7684%5Cu6982%5Cu7387%5Cuff0c%5Cu4ed6%5Cu7528%5Cu4e00%5Cu4e2a%5Cu5371%5Cu9669%5Cu6307%5Cu6570Dij%280%5Cu2264Dij%5Cu2264100000%29%5Cu6765%5Cu63cf%5Cu8ff0%5Cuff0e%5Cu4ed6%5Cu5e0c%5Cu671b%5Cu4ed6%5Cu7684%5Cu5bfb%5Cu5b9d%5Cu6d3b%5Cu52a8%5Cu7ecf%5Cu8fc7%5Cu7684%5Cu822a%5Cu7ebf%5Cu5371%5Cu9669%5Cu6307%5Cu6570%5Cu4e4b%5Cu548c%5Cu6700%5Cu5c0f%5Cuff0e%5Cu90a3%5Cu4e48%5Cuff0c%5Cu5728%5Cu627e%5Cu5230%5Cu5b9d%5Cu85cf%5Cu7684%5Cu524d%5Cu63d0%5Cu4e0b%5Cuff0c%5Cu8fd9%5Cu4e2a%5Cu6700%5Cu5c0f%5Cu7684%5Cu5371%5Cu9669%5Cu6307%5Cu6570%5Cu662f%5Cu591a%5Cu5c11%5Cu5462%5Cuff1f%5Cn%22%2C%22inputFormat%22%3A%22%5C%5C%2A%20Line%201%3A%20Two%20space-separated%20integers%3A%20N%20and%20M%5Cn%5Cn%5C%5C%2A%20Lines%202..M%2B1%3A%20Line%20i%2B1%20describes%20the%20i%5C%5C_th%20island%20FJ%20must%20visit%20with%20a%20single%20integer%3A%20A%5C%5C_i%5Cn%5Cn%5C%5C%2A%20Lines%20M%2B2..N%2BM%2B1%3A%20Line%20i%2BM%2B1%20contains%20N%20space-separated%20integers%20that%20are%20the%20respective%20danger%20rating%20of%20the%20path%20between%20island%20i%20and%20islands%201%2C%202%2C%20...%2C%20and%20N%2C%20respectively.%20The%20ith%20integer%20is%20always%20zero.%5Cn%22%2C%22outputFormat%22%3A%22%5C%5C%2A%20Line%201%3A%20The%20minimum%20danger%20that%20Farmer%20John%20can%20encounter%20while%20obtaining%20the%20treasure.%5Cn%22%2C%22samples%22%3A%5B%5B%223%204%20%5Cn1%20%5Cn2%20%5Cn1%20%5Cn3%20%5Cn0%205%201%20%5Cn5%200%202%20%5Cn1%202%200%20%5Cn%22%2C%227%20%5Cn%22%5D%5D%2C%22hint%22%3A%22There%20are%203%20islands%20and%20the%20treasure%20map%20requires%20Farmer%20John%20to%20visit%20a%20sequence%20of%204%20islands%20in%20order%3A%20island%201%2C%20island%202%2C%20island%201%20again%2C%20and%20finally%20island%203.%20The%20danger%20ratings%20of%20the%20paths%20are%20given%3A%20the%20paths%20%281%2C%202%29%3B%20%282%2C%203%29%3B%20%283%2C%201%29%20and%20the%20reverse%20paths%20have%20danger%20ratings%20of%205%2C%202%2C%20and%201%2C%20respectively.%5Cn%5Cn%5CnHe%20can%20get%20the%20treasure%20with%20a%20total%20danger%20of%207%20by%20traveling%20in%20the%20sequence%20of%20islands%201%2C%203%2C%202%2C%203%2C%201%2C%20and%203.%20The%20cow%20map%27s%20requirement%20%281%2C%202%2C%201%2C%20and%203%29%20is%20satisfied%20by%20this%20route.%20We%20avoid%20the%20path%20between%20islands%201%20and%202%20because%20it%20has%20a%20large%20danger%20rating.%5Cn%5Cn%5Cu8f93%5Cu5165%5Cu8f93%5Cu51fa%5Cu683c%5Cu5f0f%5Cn%5Cn%5Cn%5Cu8f93%5Cu5165%5Cu683c%5Cu5f0f%5Cuff1a%5Cn%5Cn%5Cn%5Cu7b2c%5Cu4e00%5Cu884c%5Cuff1a%5Cu4e24%5Cu4e2a%5Cu7528%5Cu7a7a%5Cu683c%5Cu9694%5Cu5f00%5Cu7684%5Cu6b63%5Cu6574%5Cu6570N%5Cu548cM%5Cn%5Cn%5Cn%5Cu7b2c%5Cu4e8c%5Cu5230%5Cu7b2cM%2B1%5Cu884c%5Cuff1a%5Cu7b2ci%2B1%5Cu884c%5Cu7528%5Cu4e00%5Cu4e2a%5Cu6574%5Cu6570Ai%5Cu8868%5Cu793aFJ%5Cu5fc5%5Cu987b%5Cu7ecf%5Cu8fc7%5Cu7684%5Cu7b2ci%5Cu4e2a%5Cu5c9b%5Cu5c7f%5Cn%5Cn%5Cn%5Cu7b2cM%2B2%5Cu5230%5Cu7b2cN%2BM%2B1%5Cu884c%5Cuff1a%5Cu7b2ci%2BM%2B1%5Cu884c%5Cu5305%5Cu542bN%5Cu4e2a%5Cu7528%5Cu7a7a%5Cu683c%5Cu9694%5Cu5f00%5Cu7684%5Cu975e%5Cu8d1f%5Cu6574%5Cu6570%5Cu5206%5Cu522b%5Cu8868%5Cu793ai%5Cu53f7%5Cu5c0f%5Cu5c9b%5Cu5230%5Cu7b2c1...N%5Cu53f7%5Cu5c0f%5Cu5c9b%5Cu7684%5Cu822a%5Cu7ebf%5Cu5404%5Cu81ea%5Cu7684%5Cu5371%5Cu9669%5Cu6307%5Cu6570%5Cu3002%5Cu4fdd%5Cu8bc1%5Cu7b2ci%5Cu4e2a%5Cu6570%5Cu662f0%5Cu3002%5Cn%5Cn%5Cu8f93%5Cu51fa%5Cu683c%5Cu5f0f%5Cn%5Cn%5Cn%5Cu7b2c%5Cu4e00%5Cu884c%5Cuff1aFJ%5Cu5728%5Cu627e%5Cu5230%5Cu5b9d%5Cu85cf%5Cu7684%5Cu524d%5Cu63d0%5Cu4e0b%5Cu7ecf%5Cu8fc7%5Cu7684%5Cu822a%5Cu7ebf%5Cu7684%5Cu5371%5Cu9669%5Cu6307%5Cu6570%5Cu4e4b%5Cu548c%5Cu7684%5Cu6700%5Cu5c0f%5Cu503c%5Cu3002%5Cn%5Cn%5Cu8bf4%5Cu660e%5Cn%5Cn%5Cu8fd9%5Cu7ec4%5Cu6570%5Cu636e%5Cu4e2d%5Cu6709%5Cu4e09%5Cu4e2a%5Cu5c9b%5Cu5c7f%5Cuff0c%5Cu85cf%5Cu5b9d%5Cu56fe%5Cu8981%5Cu6c42FJ%5Cu6309%5Cu987a%5Cu5e8f%5Cu7ecf%5Cu8fc7%5Cu56db%5Cu4e2a%5Cu5c9b%5Cu5c7f%5Cuff1a1%5Cu53f7%5Cu5c9b%5Cu5c7f%5Cu30012%5Cu53f7%5Cu5c9b%5Cu5c7f%5Cu3001%5Cu56de%5Cu52301%5Cu53f7%5Cu5c9b%5Cu5c7f%5Cu3001%5Cu6700%5Cu540e%5Cu52303%5Cu53f7%5Cu5c9b%5Cu5c7f%5Cu3002%5Cu6bcf%5Cu6761%5Cu822a%5Cu7ebf%5Cu7684%5Cu5371%5Cu9669%5Cu6307%5Cu6570%5Cu4e5f%5Cu7ed9%5Cu51fa%5Cu4e86%5Cuff1a%5Cu822a%5Cu8def%281%5Cuff0c2%29%5Cu3001%282%5Cuff0c3%29%5Cu3001%283%5Cuff0c1%29%5Cu548c%5Cu5b83%5Cu4eec%5Cu7684%5Cu53cd%5Cu5411%5Cu8def%5Cu5f84%5Cu7684%5Cu5371%5Cu9669%5Cu6307%5Cu6570%5Cu5206%5Cu522b%5Cu662f5%5Cu30012%5Cu30011%5Cu3002%5Cn%5Cn%5CnFJ%5Cu53ef%5Cu4ee5%5Cu901a%5Cu8fc7%5Cu4f9d%5Cu6b21%5Cu7ecf%5Cu8fc71%5Cu30013%5Cu30012%5Cu30013%5Cu30011%5Cu30013%5Cu53f7%5Cu5c9b%5Cu5c7f%5Cu4ee57%5Cu7684%5Cu6700%5Cu5c0f%5Cu603b%5Cu5371%5Cu9669%5Cu6307%5Cu6570%5Cu83b7%5Cu5f97%5Cu5b9d%5Cu85cf%5Cu3002%5Cu8fd9%5Cu6761%5Cu9053%5Cu8def%5Cu6ee1%5Cu8db3%5Cu4e86%5Cu5976%5Cu725b%5Cu5730%5Cu56fe%5Cu7684%5Cu8981%5Cu6c42%5Cuff081%5Cuff0c2%5Cuff0c1%5Cuff0c3%5Cuff09%5Cu3002%5Cu6211%5Cu4eec%5Cu907f%5Cu5f00%5Cu4e861%5Cu53f7%5Cu548c2%5Cu53f7%5Cu5c9b%5Cu5c7f%5Cu4e4b%5Cu95f4%5Cu7684%5Cu822a%5Cu7ebf%5Cuff0c%5Cu56e0%5Cu4e3a%5Cu5b83%5Cu7684%5Cu5371%5Cu9669%5Cu6307%5Cu6570%5Cu592a%5Cu5927%5Cu4e86%5Cu3002%5Cn%5Cn%5Cn%5Cu6ce8%5Cu610f%5Cuff1a%5Cu6d4b%5Cu8bd5%5Cu6570%5Cu636e%5Cu4e2da%5Cu5230b%5Cu7684%5Cu5371%5Cu9669%5Cu6307%5Cu6570%5Cu4e0d%5Cu4e00%5Cu5b9a%5Cu7b49%5Cu4e8eb%5Cu5230a%5Cu7684%5Cu5371%5Cu9669%5Cu6307%5Cu6570%5Cuff01%5Cn%22%2C%22provider%22%3A%7B%22uid%22%3A20%2C%22name%22%3A%22FarmerJohn2%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3Anull%2C%22isAdmin%22%3Afalse%2C%22color%22%3A%22Gray%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%5D%2C%22memory%22%3A%5B128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22translation%22%3A%22%5Cu9898%5Cu76ee%5Cu63cf%5Cu8ff0%5Cn%5Cu519c%5Cu592b%5Cu7ea6%5Cu7ff0%5Cu6b63%5Cu9a7e%5Cu9a76%5Cu4e00%5Cu6761%5Cu5c0f%5Cu8247%5Cu5728%5Cu725b%5Cu52d2%5Cu6bd4%5Cu6d77%5Cu4e0a%5Cu822a%5Cu884c%5Cuff0e%5Cn%5Cn%5Cu6d77%5Cu4e0a%5Cu6709N%281%5Cu2264N%5Cu2264100%29%5Cu4e2a%5Cu5c9b%5Cu5c7f%5Cuff0c%5Cu75281%5Cu5230N%5Cu7f16%5Cu53f7%5Cuff0e%5Cu7ea6%5Cu7ff0%5Cu4ece1%5Cu53f7%5Cu5c0f%5Cu5c9b%5Cu51fa%5Cu53d1%5Cuff0c%5Cu6700%5Cu540e%5Cu5230%5Cu8fbeN%5Cu53f7%5Cu5c0f%5Cu5c9b%5Cuff0e%5Cn%5Cn%5Cu4e00%5Cu5f20%5Cu85cf%5Cu5b9d%5Cu56fe%5Cu4e0a%5Cu8bf4%5Cuff0c%5Cu5982%5Cu679c%5Cu4ed6%5Cu7684%5Cu8def%5Cu7a0b%5Cu4e0a%5Cu7ecf%5Cu8fc7%5Cu7684%5Cu5c0f%5Cu5c9b%5Cu4f9d%5Cu6b21%5Cu51fa%5Cu73b0%5Cu4e86Ai%5Cuff0cA2%5Cuff0c%5Cu2026%5Cuff0cAM%282%5Cu2264M%5Cu226410000%29%5Cu8fd9%5Cu6837%5Cu7684%5Cu5e8f%5Cu5217%5Cuff08%5Cu4e0d%5Cu4e00%5Cu5b9a%5Cu76f8%5Cu90bb%5Cuff09%5Cuff0c%5Cu90a3%5Cu4ed6%5Cu6700%5Cu7ec8%5Cu5c31%5Cu80fd%5Cu627e%5Cu5230%5Cu53e4%5Cu8001%5Cu7684%5Cu5b9d%5Cu85cf%5Cuff0e%20%5Cu4f46%5Cu662f%5Cuff0c%5Cu7531%5Cu4e8e%5Cu725b%5Cu52d2%5Cu6bd4%5Cu6d77%5Cu6709%5Cu6d77%5Cu76d7%5Cu51fa%5Cu6ca1%5Cuff0e%5Cu7ea6%5Cu7ff0%5Cu77e5%5Cu9053%5Cu4efb%5Cu610f%5Cu4e24%5Cu4e2a%5Cu5c9b%5Cu5c7f%5Cu4e4b%5Cu95f4%5Cu7684%5Cu822a%5Cu7ebf%5Cu4e0a%5Cu6d77%5Cu76d7%5Cu51fa%5Cu6ca1%5Cu7684%5Cu6982%5Cu7387%5Cuff0c%5Cu4ed6%5Cu7528%5Cu4e00%5Cu4e2a%5Cu5371%5Cu9669%5Cu6307%5Cu6570Dij%280%5Cu2264Dij%5Cu2264100000%29%5Cu6765%5Cu63cf%5Cu8ff0%5Cuff0e%5Cu4ed6%5Cu5e0c%5Cu671b%5Cu4ed6%5Cu7684%5Cu5bfb%5Cu5b9d%5Cu6d3b%5Cu52a8%5Cu7ecf%5Cu8fc7%5Cu7684%5Cu822a%5Cu7ebf%5Cu5371%5Cu9669%5Cu6307%5Cu6570%5Cu4e4b%5Cu548c%5Cu6700%5Cu5c0f%5Cuff0e%5Cu90a3%5Cu4e48%5Cuff0c%5Cu5728%5Cu627e%5Cu5230%5Cu5b9d%5Cu85cf%5Cu7684%5Cu524d%5Cu63d0%5Cu4e0b%5Cuff0c%5Cu8fd9%5Cu4e2a%5Cu6700%5Cu5c0f%5Cu7684%5Cu5371%5Cu9669%5Cu6307%5Cu6570%5Cu662f%5Cu591a%5Cu5c11%5Cu5462%5Cuff1f%5Cn%5Cn%5Cu8f93%5Cu5165%5Cu8f93%5Cu51fa%5Cu683c%5Cu5f0f%5Cn%5Cu8f93%5Cu5165%5Cu683c%5Cu5f0f%5Cuff1a%5Cn%5Cu7b2c%5Cu4e00%5Cu884c%5Cuff1a%5Cu4e24%5Cu4e2a%5Cu7528%5Cu7a7a%5Cu683c%5Cu9694%5Cu5f00%5Cu7684%5Cu6b63%5Cu6574%5Cu6570N%5Cu548cM%5Cn%5Cn%5Cu7b2c%5Cu4e8c%5Cu5230%5Cu7b2cM%2B1%5Cu884c%5Cuff1a%5Cu7b2ci%2B1%5Cu884c%5Cu7528%5Cu4e00%5Cu4e2a%5Cu6574%5Cu6570Ai%5Cu8868%5Cu793aFJ%5Cu5fc5%5Cu987b%5Cu7ecf%5Cu8fc7%5Cu7684%5Cu7b2ci%5Cu4e2a%5Cu5c9b%5Cu5c7f%5Cn%5Cn%5Cu7b2cM%2B2%5Cu5230%5Cu7b2cN%2BM%2B1%5Cu884c%5Cuff1a%5Cu7b2ci%2BM%2B1%5Cu884c%5Cu5305%5Cu542bN%5Cu4e2a%5Cu7528%5Cu7a7a%5Cu683c%5Cu9694%5Cu5f00%5Cu7684%5Cu975e%5Cu8d1f%5Cu6574%5Cu6570%5Cu5206%5Cu522b%5Cu8868%5Cu793ai%5Cu53f7%5Cu5c0f%5Cu5c9b%5Cu5230%5Cu7b2c1...N%5Cu53f7%5Cu5c0f%5Cu5c9b%5Cu7684%5Cu822a%5Cu7ebf%5Cu5404%5Cu81ea%5Cu7684%5Cu5371%5Cu9669%5Cu6307%5Cu6570%5Cu3002%5Cu4fdd%5Cu8bc1%5Cu7b2ci%5Cu4e2a%5Cu6570%5Cu662f0%5Cu3002%5Cn%5Cn%5Cu8f93%5Cu51fa%5Cu683c%5Cu5f0f%5Cn%5Cu7b2c%5Cu4e00%5Cu884c%5Cuff1aFJ%5Cu5728%5Cu627e%5Cu5230%5Cu5b9d%5Cu85cf%5Cu7684%5Cu524d%5Cu63d0%5Cu4e0b%5Cu7ecf%5Cu8fc7%5Cu7684%5Cu822a%5Cu7ebf%5Cu7684%5Cu5371%5Cu9669%5Cu6307%5Cu6570%5Cu4e4b%5Cu548c%5Cu7684%5Cu6700%5Cu5c0f%5Cu503c%5Cu3002%5Cn%5Cn%5Cu8bf4%5Cu660e%5Cn%5Cu8fd9%5Cu7ec4%5Cu6570%5Cu636e%5Cu4e2d%5Cu6709%5Cu4e09%5Cu4e2a%5Cu5c9b%5Cu5c7f%5Cuff0c%5Cu85cf%5Cu5b9d%5Cu56fe%5Cu8981%5Cu6c42FJ%5Cu6309%5Cu987a%5Cu5e8f%5Cu7ecf%5Cu8fc7%5Cu56db%5Cu4e2a%5Cu5c9b%5Cu5c7f%5Cuff1a1%5Cu53f7%5Cu5c9b%5Cu5c7f%5Cu30012%5Cu53f7%5Cu5c9b%5Cu5c7f%5Cu3001%5Cu56de%5Cu52301%5Cu53f7%5Cu5c9b%5Cu5c7f%5Cu3001%5Cu6700%5Cu540e%5Cu52303%5Cu53f7%5Cu5c9b%5Cu5c7f%5Cu3002%5Cu6bcf%5Cu6761%5Cu822a%5Cu7ebf%5Cu7684%5Cu5371%5Cu9669%5Cu6307%5Cu6570%5Cu4e5f%5Cu7ed9%5Cu51fa%5Cu4e86%5Cuff1a%5Cu822a%5Cu8def%281%5Cuff0c2%29%5Cu3001%282%5Cuff0c3%29%5Cu3001%283%5Cuff0c1%29%5Cu548c%5Cu5b83%5Cu4eec%5Cu7684%5Cu53cd%5Cu5411%5Cu8def%5Cu5f84%5Cu7684%5Cu5371%5Cu9669%5Cu6307%5Cu6570%5Cu5206%5Cu522b%5Cu662f5%5Cu30012%5Cu30011%5Cu3002%5Cn%5CnFJ%5Cu53ef%5Cu4ee5%5Cu901a%5Cu8fc7%5Cu4f9d%5Cu6b21%5Cu7ecf%5Cu8fc71%5Cu30013%5Cu30012%5Cu30013%5Cu30011%5Cu30013%5Cu53f7%5Cu5c9b%5Cu5c7f%5Cu4ee57%5Cu7684%5Cu6700%5Cu5c0f%5Cu603b%5Cu5371%5Cu9669%5Cu6307%5Cu6570%5Cu83b7%5Cu5f97%5Cu5b9d%5Cu85cf%5Cu3002%5Cu8fd9%5Cu6761%5Cu9053%5Cu8def%5Cu6ee1%5Cu8db3%5Cu4e86%5Cu5976%5Cu725b%5Cu5730%5Cu56fe%5Cu7684%5Cu8981%5Cu6c42%5Cuff081%5Cuff0c2%5Cuff0c1%5Cuff0c3%5Cuff09%5Cu3002%5Cu6211%5Cu4eec%5Cu907f%5Cu5f00%5Cu4e861%5Cu53f7%5Cu548c2%5Cu53f7%5Cu5c9b%5Cu5c7f%5Cu4e4b%5Cu95f4%5Cu7684%5Cu822a%5Cu7ebf%5Cuff0c%5Cu56e0%5Cu4e3a%5Cu5b83%5Cu7684%5Cu5371%5Cu9669%5Cu6307%5Cu6570%5Cu592a%5Cu5927%5Cu4e86%5Cu3002%5Cn%5Cn%5Cu6ce8%5Cu610f%5Cuff1a%5Cu6d4b%5Cu8bd5%5Cu6570%5Cu636e%5Cu4e2da%5Cu5230b%5Cu7684%5Cu5371%5Cu9669%5Cu6307%5Cu6570%5Cu4e0d%5Cu4e00%5Cu5b9a%5Cu7b49%5Cu4e8eb%5Cu5230a%5Cu7684%5Cu5371%5Cu9669%5Cu6307%5Cu6570%5Cuff01%5Cn%5CnTranslated%20by%20%40LJC00125%20%22%2C%22tags%22%3A%5B25%2C46%2C160%2C161%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A5151%2C%22totalAccepted%22%3A2776%2C%22pid%22%3A%22P2910%22%2C%22title%22%3A%22%5BUSACO08OPEN%5D%5Cu5bfb%5Cu5b9d%5Cu4e4b%5Cu8defClear%20And%20Present%20Danger%22%2C%22difficulty%22%3A2%2C%22type%22%3A%22P%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A111964%2C%22title%22%3A%22%5Cu5927%5Cu4f6c%5Cu5e2e%5Cu5fd9%5Cu770b%5Cu4e00%5Cu4e0b%5Cuff0c%5Cu95ee%5Cu9898%5Cu8d85%5Cu8be6%5Cu7ec6qwq%22%2C%22forum%22%3A%7B%22id%22%3A2039%2C%22name%22%3A%22P2910%20%5BUSACO08OPEN%5D%5Cu5bfb%5Cu5b9d%5Cu4e4b%5Cu8defClear%20And%20Present%20Danger%22%2C%22slug%22%3A%22P2910%22%7D%7D%2C%7B%22id%22%3A98988%2C%22title%22%3A%22%28O_o%29%3F%3F%20%5Cu5168%5Cu8f93%5Cu51fa0%20%22%2C%22forum%22%3A%7B%22id%22%3A2039%2C%22name%22%3A%22P2910%20%5BUSACO08OPEN%5D%5Cu5bfb%5Cu5b9d%5Cu4e4b%5Cu8defClear%20And%20Present%20Danger%22%2C%22slug%22%3A%22P2910%22%7D%7D%2C%7B%22id%22%3A98263%2C%22title%22%3A%22%5Cu6570%5Cu636e%5Cu6709%5Cu95ee%5Cu9898%5Cu554a%22%2C%22forum%22%3A%7B%22id%22%3A2039%2C%22name%22%3A%22P2910%20%5BUSACO08OPEN%5D%5Cu5bfb%5Cu5b9d%5Cu4e4b%5Cu8defClear%20And%20Present%20Danger%22%2C%22slug%22%3A%22P2910%22%7D%7D%2C%7B%22id%22%3A63325%2C%22title%22%3A%22%5Cu6ce8%5Cu610f%5Cuff01%22%2C%22forum%22%3A%7B%22id%22%3A2039%2C%22name%22%3A%22P2910%20%5BUSACO08OPEN%5D%5Cu5bfb%5Cu5b9d%5Cu4e4b%5Cu8defClear%20And%20Present%20Danger%22%2C%22slug%22%3A%22P2910%22%7D%7D%2C%7B%22id%22%3A56090%2C%22title%22%3A%22%5Cu611f%5Cu89c9%5Cu7ed9%5Cu7684%5Cu6d4b%5Cu8bd5%5Cu6570%5Cu636e%5Cu6709%5Cu95ee%5Cu9898%22%2C%22forum%22%3A%7B%22id%22%3A2039%2C%22name%22%3A%22P2910%20%5BUSACO08OPEN%5D%5Cu5bfb%5Cu5b9d%5Cu4e4b%5Cu8defClear%20And%20Present%20Danger%22%2C%22slug%22%3A%22P2910%22%7D%7D%2C%7B%22id%22%3A36728%2C%22title%22%3A%22%5Cu9898%5Cu76ee%5Cu7ffb%5Cu8bd1%22%2C%22forum%22%3A%7B%22id%22%3A2039%2C%22name%22%3A%22P2910%20%5BUSACO08OPEN%5D%5Cu5bfb%5Cu5b9d%5Cu4e4b%5Cu8defClear%20And%20Present%20Danger%22%2C%22slug%22%3A%22P2910%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P2299%22%2C%22title%22%3A%22Mzc%5Cu548c%5Cu4f53%5Cu59d4%5Cu7684%5Cu4e89%5Cu593a%5Cu6218%22%2C%22difficulty%22%3A3%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P2419%22%2C%22title%22%3A%22%5BUSACO08JAN%5D%5Cu725b%5Cu5927%5Cu8d5bCow%20Contest%22%2C%22difficulty%22%3A3%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P3371%22%2C%22title%22%3A%22%5Cu3010%5Cu6a21%5Cu677f%5Cu3011%5Cu5355%5Cu6e90%5Cu6700%5Cu77ed%5Cu8def%5Cu5f84%5Cuff08%5Cu5f31%5Cu5316%5Cu7248%5Cuff09%22%2C%22difficulty%22%3A3%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P2888%22%2C%22title%22%3A%22%5BUSACO07NOV%5D%5Cu725b%5Cu680fCow%20Hurdles%22%2C%22difficulty%22%3A3%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P2935%22%2C%22title%22%3A%22%5BUSACO09JAN%5D%5Cu6700%5Cu597d%5Cu7684%5Cu5730%5Cu65b9Best%20Spot%22%2C%22difficulty%22%3A3%2C%22type%22%3A%22P%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22%5BUSACO08OPEN%5D%5Cu5bfb%5Cu5b9d%5Cu4e4b%5Cu8defClear%20And%20Present%20Danger%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>[USACO08OPEN]寻宝之路Clear And Present Danger</h1>
<h2>题意翻译</h2>
<div>题目描述
农夫约翰正驾驶一条小艇在牛勒比海上航行．
海上有N(1≤N≤100)个岛屿，用1到N编号．约翰从1号小岛出发，最后到达N号小岛．
一张藏宝图上说，如果他的路程上经过的小岛依次出现了Ai，A2，…，AM(2≤M≤10000)这样的序列（不一定相邻），那他最终就能找到古老的宝藏． 但是，由于牛勒比海有海盗出没．约翰知道任意两个岛屿之间的航线上海盗出没的概率，他用一个危险指数Dij(0≤Dij≤100000)来描述．他希望他的寻宝活动经过的航线危险指数之和最小．那么，在找到宝藏的前提下，这个最小的危险指数是多少呢？
输入输出格式
输入格式：
第一行：两个用空格隔开的正整数N和M
第二到第M+1行：第i+1行用一个整数Ai表示FJ必须经过的第i个岛屿
第M+2到第N+M+1行：第i+M+1行包含N个用空格隔开的非负整数分别表示i号小岛到第1...N号小岛的航线各自的危险指数。保证第i个数是0。
输出格式
第一行：FJ在找到宝藏的前提下经过的航线的危险指数之和的最小值。
说明
这组数据中有三个岛屿，藏宝图要求FJ按顺序经过四个岛屿：1号岛屿、2号岛屿、回到1号岛屿、最后到3号岛屿。每条航线的危险指数也给出了：航路(1，2)、(2，3)、(3，1)和它们的反向路径的危险指数分别是5、2、1。
FJ可以通过依次经过1、3、2、3、1、3号岛屿以7的最小总危险指数获得宝藏。这条道路满足了奶牛地图的要求（1，2，1，3）。我们避开了1号和2号岛屿之间的航线，因为它的危险指数太大了。
注意：测试数据中a到b的危险指数不一定等于b到a的危险指数！
Translated by @LJC00125 </div>
<h2>题目描述</h2>
<div>Farmer John is on a boat seeking fabled treasure on one of the N (1 <= N <= 100) islands conveniently labeled 1..N in the Cowribbean Sea.
The treasure map tells him that he must travel through a certain sequence A\_1, A\_2, ..., A\_M of M (2 <= M <= 10,000) islands, starting on island 1 and ending on island N before the treasure will appear to him. He can visit these and other islands out of order and even more than once, but his trip must include the A\_i sequence in the order specified by the map.
FJ wants to avoid pirates and knows the pirate-danger rating (0 <= danger <= 100,000) between each pair of islands. The total danger rating of his mission is the sum of the danger ratings of all the paths he traverses.
Help Farmer John find the least dangerous route to the treasure that satisfies the treasure map's requirement.
农夫约翰正驾驶一条小艇在牛勒比海上航行．
海上有N(1≤N≤100)个岛屿，用1到N编号．约翰从1号小岛出发，最后到达N号小岛．
一张藏宝图上说，如果他的路程上经过的小岛依次出现了Ai，A2，…，AM(2≤M≤10000)这样的序列（不一定相邻），那他最终就能找到古老的宝藏． 但是，由于牛勒比海有海盗出没．约翰知道任意两个岛屿之间的航线上海盗出没的概率，他用一个危险指数Dij(0≤Dij≤100000)来描述．他希望他的寻宝活动经过的航线危险指数之和最小．那么，在找到宝藏的前提下，这个最小的危险指数是多少呢？
</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>\* Line 1: Two space-separated integers: N and M
\* Lines 2..M+1: Line i+1 describes the i\_th island FJ must visit with a single integer: A\_i
\* Lines M+2..N+M+1: Line i+M+1 contains N space-separated integers that are the respective danger rating of the path between island i and islands 1, 2, ..., and N, respectively. The ith integer is always zero.
</div>
<h3>输出格式</h3>
<br />
<div>\* Line 1: The minimum danger that Farmer John can encounter while obtaining the treasure.
</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>3 4 
1 
2 
1 
3 
0 5 1 
5 0 2 
1 2 0 
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>7 
</code></pre>
<h2>说明</h2>
<div>There are 3 islands and the treasure map requires Farmer John to visit a sequence of 4 islands in order: island 1, island 2, island 1 again, and finally island 3. The danger ratings of the paths are given: the paths (1, 2); (2, 3); (3, 1) and the reverse paths have danger ratings of 5, 2, and 1, respectively.
He can get the treasure with a total danger of 7 by traveling in the sequence of islands 1, 3, 2, 3, 1, and 3. The cow map's requirement (1, 2, 1, and 3) is satisfied by this route. We avoid the path between islands 1 and 2 because it has a large danger rating.
输入输出格式
输入格式：
第一行：两个用空格隔开的正整数N和M
第二到第M+1行：第i+1行用一个整数Ai表示FJ必须经过的第i个岛屿
第M+2到第N+M+1行：第i+M+1行包含N个用空格隔开的非负整数分别表示i号小岛到第1...N号小岛的航线各自的危险指数。保证第i个数是0。
输出格式
第一行：FJ在找到宝藏的前提下经过的航线的危险指数之和的最小值。
说明
这组数据中有三个岛屿，藏宝图要求FJ按顺序经过四个岛屿：1号岛屿、2号岛屿、回到1号岛屿、最后到3号岛屿。每条航线的危险指数也给出了：航路(1，2)、(2，3)、(3，1)和它们的反向路径的危险指数分别是5、2、1。
FJ可以通过依次经过1、3、2、3、1、3号岛屿以7的最小总危险指数获得宝藏。这条道路满足了奶牛地图的要求（1，2，1，3）。我们避开了1号和2号岛屿之间的航线，因为它的危险指数太大了。
注意：测试数据中a到b的危险指数不一定等于b到a的危险指数！
</div>
</article>
</div>
</div>
</body>
</html>
