<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>[CERC2017]Gambling Guide - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573381757:5AT1f4aIS05raacQyw6HZO2iWwidXytPcu40MJz0+9Q=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%22%2C%22description%22%3A%22A%20railroad%20network%20in%20a%20nearby%20country%20consists%20of%20%24n%24%20cities%20numbered%20%241%24%20through%20%24n%24%2C%20and%20%24m%24%20two-way%20railroad%20tracks%20each%20connecting%20two%20different%20cities.%20Tickets%20can%20only%20be%20purchased%20at%20automated%20machines%20installed%20at%20every%20city.%20Unfortunately%2C%20hackers%20have%20tampered%20with%20the%20ticket%20machines%20and%20now%20they%20all%20work%20as%20follows%3A%20when%20a%20single%20coin%20is%20inserted%20in%20the%20machine%20installed%20at%20city%20%24a%24%2C%20the%20machine%20dispenses%20a%20single%20one-way%20ticket%20from%20%24a%24%20to%20a%20random%20neighboring%20city.%20More%20precisely%2C%20the%20destination%20city%20is%20chosen%20uniformly%20at%20random%20among%20all%20cities%20directly%20connected%20to%20a%20with%20a%20railroad%20track.%20Destinations%20on%20different%20tickets%20originating%20in%20the%20same%20city%20are%20independent.%5Cn%5CnA%20computer%20science%20student%20needs%20to%20travel%20from%20city%20%241%24%20%28where%20she%20lives%29%20to%20city%20%24n%24%20%28where%20a%20regional%20programming%20contest%20has%20already%20started%29.%20She%20knows%20how%20the%20machines%20work%20%28but%20of%20course%20cannot%20predict%20the%20random%20choices%29%20and%20has%20a%20map%20of%20the%20railway%20network.%20In%20each%20city%2C%20when%20she%20purchases%20a%20ticket%2C%20she%20can%20either%20immediately%20use%20it%20and%20travel%20to%20the%20destination%20city%20on%20the%20ticket%2C%20or%20discard%20the%20ticket%20and%20purchase%20a%20new%20one.%20She%20can%20keep%20purchasing%20tickets%20indefinitely.%20The%20trip%20is%20finished%20as%20soon%20as%20she%20reaches%20city%20%24n%24.%5Cn%5CnAfter%20doing%20some%20calculations%2C%20she%20has%20devised%20a%20traveling%20strategy%20with%20the%20following%20properties%3A%5Cn%20%20-%20The%20probability%20that%20the%20trip%20will%20eventually%20finish%20is%20%241%24.%5Cn%20%20-%20The%20expected%20number%20of%20coins%20spent%20on%20the%20trip%20is%20the%20smallest%20possible.%5Cn%5CnFind%20the%20expected%20number%20of%20coins%20she%20will%20spend%20on%20the%20trip.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20two%20integers%20%24n%24%20and%20%24m%281%20%5C%5Cle%20n%2Cm%20%5C%5Cle%20300%20000%29%24%20%5Cu2014%20the%20number%20of%20cities%20and%20the%20number%20of%20railroad%20tracks.%20Each%20of%20the%20following%20%24m%24%20lines%20contains%20two%20different%20integers%20%24a%24%20and%20%24b%281%20%5C%5Cle%20a%2C%20b%20%5C%5Cle%20n%29%24%20which%20describe%20a%20railroad%20track%20connecting%20cities%20%24a%24%20and%20%24b%24.%20%5Cn%5CnThere%20will%20be%20at%20most%20one%20railroad%20track%20between%20each%20pair%20of%20cities.%20It%20will%20be%20possible%20to%20reach%20city%20%24n%24%20starting%20from%20city%20%241%24.%22%2C%22outputFormat%22%3A%22Output%20a%20single%20number%20%5Cu2014%20the%20expected%20number%20of%20coins%20spent.%20The%20solution%20will%20be%20accepted%20if%20the%20absolute%20or%20the%20relative%20difference%20from%20the%20judges%20solution%20is%20less%20than%20%2410%5E%7B-6%7D%24.%22%2C%22samples%22%3A%5B%5B%224%204%5Cn1%202%5Cn1%203%5Cn2%204%5Cn3%204%22%2C%223.0000000000%22%5D%2C%5B%225%208%5Cn1%202%5Cn1%203%5Cn1%204%5Cn2%203%5Cn2%204%5Cn3%205%5Cn5%204%5Cn2%205%22%2C%224.1111111111%5Cn%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A41051%2C%22name%22%3A%22%5Cu548c%5Cu6cc9%5Cu6b63%5Cu5b97%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3Anull%2C%22isAdmin%22%3Afalse%2C%22color%22%3A%22Blue%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B3000%2C3000%2C3000%2C3000%2C3000%2C3000%2C3000%2C3000%2C3000%2C3000%2C3000%2C3000%2C3000%2C3000%2C3000%2C3000%2C3000%2C3000%2C3000%2C3000%5D%2C%22memory%22%3A%5B512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22translation%22%3A%22%5Cu4e00%5Cu4e2a%5Cu5728%5Cu90bb%5Cu56fd%5Cu7684%5Cu94c1%5Cu8def%5Cu7cfb%5Cu7edf%5Cu662f%5Cu7531%24n%24%5Cu4e2a%5Cu57ce%5Cu5e02%5Cuff08%5Cu7f16%5Cu53f7%5Cu4ece%241%24%5Cu5230%24n%24%5Cuff09%5Cuff0c%5Cu548c%24m%24%5Cu6761%5Cu8fde%5Cu63a5%5Cu4e24%5Cu4e2a%5Cu4e0d%5Cu540c%5Cu57ce%5Cu5e02%5Cu7684%5Cu53cc%5Cu5411%5Cu94c1%5Cu8def%5Cu7ec4%5Cu6210%5Cu7684%5Cu3002%5Cu94c1%5Cu8def%5Cu7968%5Cu53ea%5Cu80fd%5Cu5728%5Cu5b89%5Cu88c5%5Cu5728%5Cu6bcf%5Cu4e2a%5Cu57ce%5Cu5e02%5Cu7684%5Cu81ea%5Cu52a8%5Cu552e%5Cu7968%5Cu673a%5Cu8d2d%5Cu4e70%5Cu3002%5Cu4e0d%5Cu5e78%5Cu7684%5Cu662f%5Cuff0c%5Cu9ed1%5Cu5ba2%5Cu4eec%5Cu5df2%5Cu7ecf%5Cu7be1%5Cu6539%5Cu4e86%5Cu8fd9%5Cu4e9b%5Cu552e%5Cu7968%5Cu673a%5Cuff0c%5Cu73b0%5Cu5728%5Cu5b83%5Cu4eec%5Cu6709%5Cu4e0b%5Cu9762%5Cu7684%5Cu89c4%5Cu5219%5Cuff1a%5Cn%5Cu5f53%24a%24%5Cu5e02%5Cu7684%5Cu552e%5Cu7968%5Cu673a%5Cu6709%5Cu4e00%5Cu4e2a%5Cu786c%5Cu5e01%5Cu6295%5Cu5165%5Cu65f6%5Cuff0c%5Cu673a%5Cu5668%5Cu4f1a%5Cu53d1%5Cu4e00%5Cu5f20%5Cu4ece%24a%24%5Cu5e02%5Cu5230%5Cu968f%5Cu673a%5Cu4e00%5Cu4e2a%5Cu90bb%5Cu5e02%5Cu7684%5Cu5355%5Cu7a0b%5Cu7968%5Cu3002%5Cu66f4%5Cu7cbe%5Cu786e%5Cu5730%5Cu6765%5Cu8bf4%5Cuff0c%5Cu76ee%5Cu7684%5Cu5730%5Cu57ce%5Cu5e02%5Cu662f%5Cu88ab%5Cu7edf%5Cu4e00%5Cu7684%5Cu3001%5Cu968f%5Cu673a%5Cu7684%5Cu4ece%5Cu6240%5Cu6709%5Cu7531%5Cu51fa%5Cu53d1%5Cu57ce%5Cu5e02%5Cu4e3a%5Cu8d77%5Cu70b9%5Cu7684%5Cu94c1%5Cu8def%5Cu7684%5Cu7ec8%5Cu70b9%5Cu4e2d%5Cu9009%5Cu53d6%5Cu7684%5Cu3002%5Cn%5Cn%5Cu4e00%5Cu4e2a%5Cu7814%5Cu7a76%5Cu8ba1%5Cu7b97%5Cu673a%5Cu79d1%5Cu5b66%5Cu7684%5Cu5b66%5Cu751f%5Cu9700%5Cu8981%5Cu4ece%5Cu57ce%5Cu5e02%241%24%5Cuff08%5Cu5979%5Cu751f%5Cu6d3b%5Cu5728%5Cu90a3%5Cu91cc%5Cuff09%5Cu5230%5Cu57ce%5Cu5e02%24n%24%5Cuff08%5Cu90a3%5Cu91cc%5Cu6b63%5Cu4e3e%5Cu884c%5Cu4e00%5Cu4e2a%5Cu7f16%5Cu7a0b%5Cu6bd4%5Cu8d5b%5Cuff09%5Cu3002%5Cu5979%5Cu77e5%5Cu9053%5Cu673a%5Cu5668%5Cu662f%5Cu600e%5Cu4e48%5Cu5de5%5Cu4f5c%5Cu7684%5Cuff08%5Cu4f46%5Cu5f53%5Cu7136%5Cu5979%5Cu4e0d%5Cu80fd%5Cu9884%5Cu6d4b%5Cu968f%5Cu673a%5Cu7684%5Cu76ee%5Cu7684%5Cu5730%5Cuff09%5Cu5e76%5Cu4e14%5Cu6709%5Cu4e00%5Cu4efd%5Cu94c1%5Cu8def%5Cu7cfb%5Cu7edf%5Cu7684%5Cu5730%5Cu56fe%5Cu3002%5Cu5728%5Cu6bcf%5Cu4e00%5Cu4e2a%5Cu57ce%5Cu5e02%5Cuff0c%5Cu5f53%5Cu5979%5Cu4e70%5Cu4e86%5Cu4e00%5Cu5f20%5Cu7968%5Cu65f6%5Cuff0c%5Cu5979%5Cu53ef%5Cu4ee5%5Cu9009%5Cu62e9%5Cu7acb%5Cu5373%5Cu4f7f%5Cu7528%5Cu5b83%5Cu540e%5Cu5230%5Cu8fbe%5Cu76ee%5Cu7684%5Cu5730%5Cuff0c%5Cu6216%5Cu8005%5Cu662f%5Cu4e22%5Cu6389%5Cu5b83%5Cu5e76%5Cu4e70%5Cu4e00%5Cu5f20%5Cu65b0%5Cu7968%5Cu3002%5Cu5979%5Cu53ef%5Cu4ee5%5Cu65e0%5Cu9650%5Cu5236%5Cu7684%5Cu8d2d%5Cu4e70%5Cu7684%5Cu7968%5Cu3002%5Cu5f53%5Cu5979%5Cu4e00%5Cu5230%5Cu8fben%5Cu57ce%5Cu5e02%5Cuff0c%5Cu65c5%5Cu884c%5Cu5c31%5Cu4f1a%5Cu7ed3%5Cu675f%5Cu3002%5Cn%5Cn%5Cu5728%5Cu505a%5Cu4e86%5Cu4e00%5Cu4e9b%5Cu8ba1%5Cu7b97%5Cu4e4b%5Cu540e%5Cuff0c%5Cu5979%5Cu5236%5Cu5b9a%5Cu4e86%5Cu4e00%5Cu4e2a%5Cu62e5%5Cu6709%5Cu4ee5%5Cu4e0b%5Cu7684%5Cu76ee%5Cu6807%5Cu7684%5Cu65c5%5Cu884c%5Cu8ba1%5Cu5212%5Cuff1a%5Cn-%20%5Cu65c5%5Cu884c%5Cu6700%5Cu7ec8%5Cu5230%5Cu8fbe%5Cu7ec8%5Cu70b9%5Cu7684%5Cu6982%5Cu7387%5Cu4e3a1%5Cn-%20%5Cu9884%5Cu671f%5Cu82b1%5Cu5728%5Cu65c5%5Cu884c%5Cu4e0a%5Cu7684%5Cu786c%5Cu5e01%5Cu8d8a%5Cu5c11%5Cu8d8a%5Cu597d%5Cn%5Cn%5Cu627e%5Cu5230%5Cu8fd9%5Cu4e2a%5Cu9884%5Cu671f%5Cu7684%5Cu5979%5Cu8981%5Cu82b1%5Cu5728%5Cu65c5%5Cu9014%5Cu4e0a%5Cu7684%5Cu786c%5Cu5e01%5Cu6570%5Cn%5Cn%23%23%23%20%5Cu8f93%5Cu5165%5Cu683c%5Cu5f0f%5Cuff1a%5Cn%5Cu7b2c%5Cu4e00%5Cu884c%5Cu5305%5Cu542b%5Cu4e24%5Cu4e2a%5Cu6574%5Cu6570n%5Cu548cm%281%5Cu2264n%2Cm%5Cu2264300000%29%20%5Cuff08%5Cu57ce%5Cu5e02%5Cu7684%5Cu6570%5Cu91cf%5Cu548c%5Cu94c1%5Cu9053%5Cu7684%5Cu6570%5Cu91cf%5Cuff09%5Cu3002%5Cn%5Cn%5Cu63a5%5Cu4e0b%5Cu6765m%5Cu884c%5Cu6bcf%5Cu884c%5Cu5305%5Cu542b%5Cu4e86%5Cu4e24%5Cu4e2a%5Cu4e0d%5Cu540c%5Cu7684%5Cu6574%5Cu6570a%5Cu548cb%281%5Cu2264a%2Cb%5Cu2264n%29%20%5Cuff0c%5Cu63cf%5Cu8ff0%5Cu4e86%5Cu4e00%5Cu6761%5Cu8fde%5Cu63a5a%5Cu5e02%5Cu548cb%5Cu5e02%5Cu7684%5Cu53cc%5Cu5411%5Cu94c1%5Cu8def%5Cn%5Cn%5Cu4e24%5Cu4e2a%5Cu57ce%5Cu5e02%5Cu4e4b%5Cu95f4%5Cu6700%5Cu591a%5Cu53ea%5Cu4f1a%5Cu6709%5Cu4e00%5Cu6761%5Cu94c1%5Cu8def%5Cuff0c%5Cu8f93%5Cu5165%5Cu4fdd%5Cu8bc1%5Cu6709%5Cu4e00%5Cu6761%5Cu4ece%5Cu57ce%5Cu5e021%5Cu5230n%5Cu7684%5Cu8def%5Cu5f84%5Cu3002%5Cn%5Cn%23%23%23%20%5Cu8f93%5Cu51fa%5Cu683c%5Cu5f0f%5Cuff1a%5Cn%5Cu8f93%5Cu51fa%5Cu4e00%5Cu4e2a%5Cu6570%5Cu2014%5Cu2014%5Cu9884%5Cu671f%5Cu7684%5Cu8981%5Cu82b1%5Cu5728%5Cu65c5%5Cu9014%5Cu4e0a%5Cu7684%5Cu786c%5Cu5e01%5Cu6570%5Cu3002%5Cu6b64%5Cu8f93%5Cu51fa%5Cu53ea%5Cu8981%5Cu4e0e%5Cu6b63%5Cu89e3%5Cu7684%5Cu76f8%5Cu5bf9%5Cu5dee%5Cu6216%5Cu7edd%5Cu5bf9%5Cu5dee%5Cu5c0f%5Cu4e8e10%5E%5Cu22126%5Cu5c31%5Cu53ef%5Cu4ee5%5Cu901a%5Cu8fc7%5Cu3002%5Cn%5CnTranslated%20by%20%40s7a9%20%22%2C%22tags%22%3A%5B34%2C107%2C319%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A170%2C%22totalAccepted%22%3A93%2C%22pid%22%3A%22P4745%22%2C%22title%22%3A%22%5BCERC2017%5DGambling%20Guide%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A63914%2C%22title%22%3A%22%5Cu7ffb%5Cu8bd1%5Cu6709%5Cu95ee%5Cu9898%5Cu554a%22%2C%22forum%22%3A%7B%22id%22%3A27197%2C%22name%22%3A%22P4745%20%5BCERC2017%5DGambling%20Guide%22%2C%22slug%22%3A%22P4745%22%7D%7D%2C%7B%22id%22%3A48872%2C%22title%22%3A%22%5Cu3010%5Cu7ffb%5Cu8bd1%5Cu3011%22%2C%22forum%22%3A%7B%22id%22%3A27197%2C%22name%22%3A%22P4745%20%5BCERC2017%5DGambling%20Guide%22%2C%22slug%22%3A%22P4745%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P4238%22%2C%22title%22%3A%22%5Cu3010%5Cu6a21%5Cu677f%5Cu3011%5Cu591a%5Cu9879%5Cu5f0f%5Cu6c42%5Cu9006%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22CF997C%22%2C%22title%22%3A%22Sky%20Full%20of%20Stars%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22P4841%22%2C%22title%22%3A%22%5Cu57ce%5Cu5e02%5Cu89c4%5Cu5212%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P5103%22%2C%22title%22%3A%22%5BJOI%202016%20Final%5D%5Cu65ad%5Cu5c42%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22CF1215F%22%2C%22title%22%3A%22Radio%20Stations%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22CF%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22%5BCERC2017%5DGambling%20Guide%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573286098;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>[CERC2017]Gambling Guide</h1>
<h2>题意翻译</h2>
<div>一个在邻国的铁路系统是由$n$个城市（编号从$1$到$n$），和$m$条连接两个不同城市的双向铁路组成的。铁路票只能在安装在每个城市的自动售票机购买。不幸的是，黑客们已经篡改了这些售票机，现在它们有下面的规则：
当$a$市的售票机有一个硬币投入时，机器会发一张从$a$市到随机一个邻市的单程票。更精确地来说，目的地城市是被统一的、随机的从所有由出发城市为起点的铁路的终点中选取的。
一个研究计算机科学的学生需要从城市$1$（她生活在那里）到城市$n$（那里正举行一个编程比赛）。她知道机器是怎么工作的（但当然她不能预测随机的目的地）并且有一份铁路系统的地图。在每一个城市，当她买了一张票时，她可以选择立即使用它后到达目的地，或者是丢掉它并买一张新票。她可以无限制的购买的票。当她一到达n城市，旅行就会结束。
在做了一些计算之后，她制定了一个拥有以下的目标的旅行计划：
- 旅行最终到达终点的概率为1
- 预期花在旅行上的硬币越少越好
找到这个预期的她要花在旅途上的硬币数
### 输入格式：
第一行包含两个整数n和m(1≤n,m≤300000) （城市的数量和铁道的数量）。
接下来m行每行包含了两个不同的整数a和b(1≤a,b≤n) ，描述了一条连接a市和b市的双向铁路
两个城市之间最多只会有一条铁路，输入保证有一条从城市1到n的路径。
### 输出格式：
输出一个数——预期的要花在旅途上的硬币数。此输出只要与正解的相对差或绝对差小于10^−6就可以通过。
Translated by @s7a9 </div>
<h2>题目描述</h2>
<div>A railroad network in a nearby country consists of $n$ cities numbered $1$ through $n$, and $m$ two-way railroad tracks each connecting two different cities. Tickets can only be purchased at automated machines installed at every city. Unfortunately, hackers have tampered with the ticket machines and now they all work as follows: when a single coin is inserted in the machine installed at city $a$, the machine dispenses a single one-way ticket from $a$ to a random neighboring city. More precisely, the destination city is chosen uniformly at random among all cities directly connected to a with a railroad track. Destinations on different tickets originating in the same city are independent.
A computer science student needs to travel from city $1$ (where she lives) to city $n$ (where a regional programming contest has already started). She knows how the machines work (but of course cannot predict the random choices) and has a map of the railway network. In each city, when she purchases a ticket, she can either immediately use it and travel to the destination city on the ticket, or discard the ticket and purchase a new one. She can keep purchasing tickets indefinitely. The trip is finished as soon as she reaches city $n$.
After doing some calculations, she has devised a traveling strategy with the following properties:
- The probability that the trip will eventually finish is $1$.
- The expected number of coins spent on the trip is the smallest possible.
Find the expected number of coins she will spend on the trip.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains two integers $n$ and $m(1 \le n,m \le 300 000)$ — the number of cities and the number of railroad tracks. Each of the following $m$ lines contains two different integers $a$ and $b(1 \le a, b \le n)$ which describe a railroad track connecting cities $a$ and $b$.
There will be at most one railroad track between each pair of cities. It will be possible to reach city $n$ starting from city $1$.</div>
<h3>输出格式</h3>
<br />
<div>Output a single number — the expected number of coins spent. The solution will be accepted if the absolute or the relative difference from the judges solution is less than $10^{-6}$.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>4 4
1 2
1 3
2 4
3 4</code></pre>
<h3>输出样例 #1</h3>
<pre><code>3.0000000000</code></pre>
<h3>输入样例 #2</h3>
<pre><code>5 8
1 2
1 3
1 4
2 3
2 4
3 5
5 4
2 5</code></pre>
<h3>输出样例 #2</h3>
<pre><code>4.1111111111
</code></pre>
</article>
</div>
</div>
</body>
</html>
