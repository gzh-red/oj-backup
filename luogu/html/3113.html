<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>[USACO14DEC]马拉松赛跑Marathon_Gold - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573376421:/Zq3YIAwV1sCPtT4G/lexBWqjvwLhxGZpaM1/ua+CGk=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%5Cu4f5c%5Cu4e3a%5Cu4e00%5Cu540d%5Cu72c2%5Cu70ed%5Cu7684%5Cu9a6c%5Cu62c9%5Cu677e%5Cu957f%5Cu8dd1%5Cu8fd0%5Cu52a8%5Cu5458%5Cuff0c%5Cu8d1d%5Cu831c%5Cu559c%5Cu6b22%5Cu4e3a%5Cu5979%5Cu7684%5Cu540c%5Cu4f34%5Cu4eec%5Cu5f00%5Cu8bbe%5Cu9a6c%5Cu62c9%5Cu677e%5Cu8bfe%5Cu7a0b%5Cu3002%5Cu5979%5Cu6700%5Cu8fd1%5Cu8bbe%5Cu8ba1%5Cu4e86%5Cu4e00%5Cu4e2a%5Cu6709N%5Cu4e2a%5Cu68c0%5Cu67e5%5Cu70b9%5Cu7684%5Cu8def%5Cu7ebf%281%20%3C%20%3D%20N%20%3C%20%3D%20100%2C000%29%5Cuff0c%5Cu5fc5%5Cu987b%5Cu6309%5Cu987a%5Cu5e8f%5Cu7ecf%5Cu8fc7%5Cu3002%5Cn%5Cn%5Cn%5Cu4e0d%5Cu5e78%5Cu7684%5Cu662f%5Cuff0c%5Cu8d1d%5Cu831c%5Cu610f%5Cu8bc6%5Cu5230%5Cu5176%5Cu4ed6%5Cu7684%5Cu5976%5Cu725b%5Cu53ef%5Cu80fd%5Cu6ca1%5Cu6709%5Cu8db3%5Cu591f%5Cu7684%5Cu8010%5Cu529b%5Cu8dd1%5Cu5b8c%5Cu5168%5Cu7a0b%5Cu3002%5Cu56e0%5Cu6b64%5Cuff0c%5Cu5979%5Cu60f3%5Cu77e5%5Cu9053%5Cu7279%5Cu5b9a%5Cu7684%5Cu5b50%5Cu8def%5Cu7ebf%5Cu9700%5Cu8981%5Cu591a%5Cu957f%5Cu65f6%5Cu95f4%5Cu624d%5Cu80fd%5Cu8dd1%5Cu5b8c%5Cuff0c%5Cu5176%5Cu4e2d%5Cu7684%5Cu5b50%5Cu8def%5Cu7ebf%5Cu662f%5Cu4ece%5Cu5b8c%5Cu6574%5Cu8def%5Cu7ebf%5Cu7684%5Cu68c0%5Cu67e5%5Cu70b9%5Cu4e2d%5Cu622a%5Cu53d6%5Cu7684%5Cu7684%5Cu8fde%5Cu7eed%5Cu5b50%5Cu5e8f%5Cu5217%5Cu3002%5Cu8ba9%5Cu4e8b%5Cu60c5%5Cu53d8%5Cu5f97%5Cu66f4%5Cu590d%5Cu6742%5Cu7684%5Cu662f%5Cuff0c%5Cu8d1d%5Cu897f%5Cu77e5%5Cu9053%5Cu5176%5Cu4ed6%5Cu7684%5Cu725b%5Cu5341%5Cu5206%5Cu61d2%5Cu60f0%5Cuff0c%5Cu53ef%5Cu80fd%5Cu4f1a%5Cu9009%5Cu62e9%5Cu5728%5Cu4efb%5Cu4f55%5Cu65f6%5Cu5019%5Cu8df3%5Cu8fc7%5Cu4e00%5Cu4e2a%5Cu68c0%5Cu67e5%5Cu70b9%5Cu2014%5Cu2014%5Cu65e0%5Cu8bba%5Cu54ea%5Cu4e00%5Cu79cd%5Cu65b9%5Cu6cd5%5Cu90fd%5Cu80fd%5Cu5728%5Cu6700%5Cu77ed%5Cu7684%5Cu65f6%5Cu95f4%5Cu5185%5Cu5b8c%5Cu6210%5Cu3002%5Cu7136%5Cu800c%5Cuff0c%5Cu4ed6%5Cu4eec%5Cu4e0d%5Cu5141%5Cu8bb8%5Cu5728%5Cu5b50%5Cu8def%5Cu7ebf%5Cu4e2d%5Cu8df3%5Cu8fc7%5Cu7b2c%5Cu4e00%5Cu4e2a%5Cu6216%5Cu6700%5Cu540e%5Cu4e00%5Cu4e2a%5Cu68c0%5Cu67e5%5Cu70b9%5Cu3002%5Cn%5Cn%5Cn%5Cu4e3a%5Cu4e86%5Cu5efa%5Cu9020%5Cu6700%5Cu597d%5Cu7684%5Cu9a6c%5Cu62c9%5Cu677e%5Cu8d5b%5Cu9053%5Cuff0c%5Cu8d1d%5Cu831c%5Cu60f3%5Cu8981%5Cu7814%5Cu7a76%5Cu4e00%5Cu4e0b%5Cu5728%5Cu5979%5Cu76ee%5Cu524d%5Cu7684%5Cu8bfe%5Cu7a0b%5Cu4e2d%5Cu5bf9%5Cu68c0%5Cu67e5%5Cu70b9%5Cu4f4d%5Cu7f6e%5Cu505a%5Cu51fa%5Cu6539%5Cu53d8%5Cu540e%5Cu53ef%5Cu80fd%5Cu9020%5Cu6210%5Cu7684%5Cu540e%5Cu679c%5Cu3002%5Cu8bf7%5Cu5e2e%5Cu52a9%5Cu5979%5Cu786e%5Cu5b9a%5Cu68c0%5Cu67e5%5Cu70b9%5Cu4f4d%5Cu7f6e%5Cu7684%5Cu54ea%5Cu4e9b%5Cu66f4%5Cu6539%5Cu5c06%5Cu4f1a%5Cu5f71%5Cu54cd%5Cu8fd0%5Cu884c%5Cu4e0d%5Cu540c%5Cu5b50%5Cu8def%5Cu7ebf%5Cu6240%5Cu9700%5Cu7684%5Cu65f6%5Cu95f4%28%5Cu8003%5Cu8651%5Cu5230%5Cu5976%5Cu725b%5Cu53ef%5Cu80fd%5Cu4f1a%5Cu9009%5Cu62e9%5Cu5728%5Cu5b50%5Cu8def%5Cu7ebf%5Cu8dd1%5Cu6b65%5Cu65f6%5Cu5ffd%5Cu7565%5Cu4e00%5Cu4e2a%5Cu68c0%5Cu67e5%5Cu70b9%29%5Cu3002%5Cn%5Cn%5Cu7531%5Cu4e8e%5Cu8be5%5Cu8bfe%5Cu7a0b%5Cu8bbe%5Cu7f6e%5Cu5728%5Cu5e02%5Cu4e2d%5Cu5fc3%5Cu7684%5Cu8857%5Cu9053%5Cu7f51%5Cu7edc%5Cu4e2d%5Cuff0c%5Cu4e24%5Cu4e2a%5Cu68c0%5Cu67e5%5Cu70b9%5Cu4e4b%5Cu95f4%5Cu7684%5Cu8ddd%5Cu79bb%28x1%2Cy1%29%5Cu548c%28x2%2Cy2%29%5Cu662f%5Cu7531%7C%20x1%20-%20x2%20%7C%20%2B%20%7C%20y1%20-%20y2%20%7C%5Cu5f97%5Cu51fa%5Cu7684%5Cu3002%5Cn%22%2C%22description%22%3A%22An%20avid%20marathon%20runner%20herself%2C%20Bessie%20enjoys%20creating%20marathon%20courses%20for%20her%20fellow%20cows%20to%20run.%20%20She%20has%20most%20recently%20designed%20a%20route%20specified%20by%20N%20checkpoints%20%281%20%3C%3D%20N%20%3C%3D%20100%2C000%29%20that%20must%20be%20visited%20in%20sequence.%5Cn%5Cn%5CnUnfortunately%2C%20Bessie%20realizes%20that%20the%20other%20cows%20may%20not%20have%20the%20stamina%20to%20run%20the%20full%20route.%20She%20therefore%20wants%20to%20know%20how%20long%20certain%20sub-routes%20take%20to%20run%2C%20where%20a%20sub-route%20is%20a%20contiguous%20subsequence%20of%20the%20checkpoints%20from%20the%20full%20route.%20%20To%20make%20matters%20more%20complicated%2C%20Bessie%20knows%20that%20the%20other%20cows%2C%20being%20lazy%2C%20might%20choose%20to%20skip%20one%20checkpoint%20any%20time%20they%20run%20a%20sub-route%20--%20whichever%20one%20results%20in%20a%20minimum%20total%20travel%20time.%20%20They%20are%20not%20allowed%20to%20skip%20the%20first%20or%20last%20checkpoints%20in%20a%20sub-route%2C%20however.%5Cn%5Cn%20%5CnIn%20order%20to%20build%20the%20best%20possible%20marathon%20course%2C%20Bessie%20wants%20to%20investigate%20the%20ramifications%20of%20making%20changes%20to%20the%20checkpoint%20locations%20in%20her%20current%20course.%20%20Please%20help%20her%20determine%20how%20certain%20changes%20to%20checkpoint%20locations%20will%20affect%20the%20time%20required%20to%20run%20different%20sub-routes%20%28taking%20into%20account%20that%20the%20cows%20might%20choose%20to%20omit%20one%20checkpoint%20any%20time%20they%20run%20a%20sub-route%29.%5Cn%5Cn%20%5CnSince%20the%20course%20is%20set%20in%20a%20downtown%20area%20with%20a%20grid%20of%20streets%2C%20the%20distance%20between%20two%20checkpoints%20at%20locations%20%28x1%2C%20y1%29%20and%20%28x2%2C%20y2%29%20is%20given%20by%20%7Cx1-x2%7C%20%2B%20%7Cy1-y2%7C.%20%22%2C%22inputFormat%22%3A%22%5Cn%5CnINPUT%3A%20%28file%20marathon.in%29%20%5Cn%5CnThe%20first%20line%20gives%20N%20and%20Q%20%281%20%3C%3D%20Q%20%3C%3D%20100%2C000%29.%20%5Cn%5CnThe%20next%20N%20lines%20contain%20%28x%2C%20y%29%20locations%20of%20N%20checkpoints%20in%20the%20%5Cn%5Cnsequence%20they%20must%20be%20visited%20along%20the%20route.%20%20All%20coordinates%20are%20in%20the%20range%20-1000%20..%201000.%5Cn%5Cn%5CnThe%20next%20Q%20lines%20consist%20of%20updates%20and%20queries%2C%20one%20per%20line%2C%20to%20be%20processed%20in%20the%20order%20they%20are%20given.%20Lines%20will%20either%20take%20the%20form%20%5C%22U%20I%20X%20Y%5C%22%20or%20%5C%22Q%20I%20J%5C%22.%20%20A%20line%20of%20the%20form%20%5C%22U%20I%20X%20Y%5C%22%20indicates%20that%20the%20location%20of%20checkpoint%20I%20%281%20%3C%3D%20I%20%3C%3D%20N%29%20is%20to%20be%20changed%20to%20location%20%28X%2C%20Y%29.%20%20A%20line%20of%20the%20form%20%5C%22Q%20I%20J%5C%22%20asks%20for%20the%20minimum%20travel%20time%20of%20the%20sub-route%20from%20checkpoint%20I%20to%20checkpoint%20J%20%28I%20%3C%3D%20J%29%2C%20given%20that%20the%20cows%20choose%20to%20skip%20one%20checkpoint%20along%20this%20sub-route%20%28but%20not%20the%20endpoints%20I%20and%20J%29.%5Cn%5Cn%22%2C%22outputFormat%22%3A%22%5Cn%20%5CnOUTPUT%3A%20%28file%20marathon.out%29%20%5Cn%5CnFor%20each%20sub-route%20length%20request%2C%20output%20on%20a%20single%20line%20the%20desired%20length.%20%5Cn%5Cn%22%2C%22samples%22%3A%5B%5B%225%205%20%5Cn-4%204%20%5Cn-5%20-3%20%5Cn-1%205%20%5Cn-3%204%20%5Cn0%205%20%5CnQ%201%205%20%5CnU%204%200%201%20%5CnU%204%20-1%201%20%5CnQ%202%204%20%5CnQ%201%204%20%5Cn%22%2C%2211%20%5Cn8%20%5Cn8%20%5Cn%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A20%2C%22name%22%3A%22FarmerJohn2%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3Anull%2C%22isAdmin%22%3Afalse%2C%22color%22%3A%22Gray%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%5D%2C%22memory%22%3A%5B128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22tags%22%3A%5B1%2C3%2C31%2C46%2C111%2C319%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A169%2C%22totalAccepted%22%3A81%2C%22pid%22%3A%22P3113%22%2C%22title%22%3A%22%5BUSACO14DEC%5D%5Cu9a6c%5Cu62c9%5Cu677e%5Cu8d5b%5Cu8dd1Marathon_Gold%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22P%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A71220%2C%22title%22%3A%22%5Cu8fd9%5Cu9898%5Cu4e0d%5Cu662f%5Cu88f8%5Cu7ebf%5Cu6bb5%5Cu6811%5Cu5417%5Cuff0c%5Cu600e%5Cu4e48%5Cu6807%5Cu7b7e%5Cu662fdp%5Cu3002%5Cu3002%5Cu3002%22%2C%22forum%22%3A%7B%22id%22%3A2229%2C%22name%22%3A%22P3113%20%5BUSACO14DEC%5D%5Cu9a6c%5Cu62c9%5Cu677e%5Cu8d5b%5Cu8dd1Marathon_Gold%22%2C%22slug%22%3A%22P3113%22%7D%7D%2C%7B%22id%22%3A15689%2C%22title%22%3A%22%5Cu4e3a%5Cu4ec0%5Cu4e48%5Cu4e00%5Cu76f4%5Cu663e%5Cu793atoo%20many%20%20or%20too%20few%20lines%5Cu554a%22%2C%22forum%22%3A%7B%22id%22%3A2229%2C%22name%22%3A%22P3113%20%5BUSACO14DEC%5D%5Cu9a6c%5Cu62c9%5Cu677e%5Cu8d5b%5Cu8dd1Marathon_Gold%22%2C%22slug%22%3A%22P3113%22%7D%7D%2C%7B%22id%22%3A5927%2C%22title%22%3A%22%5Cu6837%5Cu4f8b%5Cu6709%5Cu8bef%22%2C%22forum%22%3A%7B%22id%22%3A2229%2C%22name%22%3A%22P3113%20%5BUSACO14DEC%5D%5Cu9a6c%5Cu62c9%5Cu677e%5Cu8d5b%5Cu8dd1Marathon_Gold%22%2C%22slug%22%3A%22P3113%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P2324%22%2C%22title%22%3A%22%5BSCOI2005%5D%5Cu9a91%5Cu58eb%5Cu7cbe%5Cu795e%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P3112%22%2C%22title%22%3A%22%5BUSACO14DEC%5D%5Cu540e%5Cu536b%5Cu9a6c%5Cu514bGuard%20Mark%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P3117%22%2C%22title%22%3A%22%5BUSACO15JAN%5D%5Cu725b%5Cu7684%5Cu77e9%5Cu5f62Cow%20Rectangles%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P3253%22%2C%22title%22%3A%22%5BJLOI2013%5D%5Cu5220%5Cu9664%5Cu7269%5Cu54c1%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P4873%22%2C%22title%22%3A%22%5BUSACO14DEC%5D%20Cow%20Jog_Gold%20%5Cu725b%5Cu6162%5Cu8dd1%28%5Cu91d1%29%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22P%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22%5BUSACO14DEC%5D%5Cu9a6c%5Cu62c9%5Cu677e%5Cu8d5b%5Cu8dd1Marathon_Gold%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>[USACO14DEC]马拉松赛跑Marathon_Gold</h1>
<h2>题目背景</h2>
<div>作为一名狂热的马拉松长跑运动员，贝茜喜欢为她的同伴们开设马拉松课程。她最近设计了一个有N个检查点的路线(1 < = N < = 100,000)，必须按顺序经过。
不幸的是，贝茜意识到其他的奶牛可能没有足够的耐力跑完全程。因此，她想知道特定的子路线需要多长时间才能跑完，其中的子路线是从完整路线的检查点中截取的的连续子序列。让事情变得更复杂的是，贝西知道其他的牛十分懒惰，可能会选择在任何时候跳过一个检查点——无论哪一种方法都能在最短的时间内完成。然而，他们不允许在子路线中跳过第一个或最后一个检查点。
为了建造最好的马拉松赛道，贝茜想要研究一下在她目前的课程中对检查点位置做出改变后可能造成的后果。请帮助她确定检查点位置的哪些更改将会影响运行不同子路线所需的时间(考虑到奶牛可能会选择在子路线跑步时忽略一个检查点)。
由于该课程设置在市中心的街道网络中，两个检查点之间的距离(x1,y1)和(x2,y2)是由| x1 - x2 | + | y1 - y2 |得出的。
</div>
<h2>题目描述</h2>
<div>An avid marathon runner herself, Bessie enjoys creating marathon courses for her fellow cows to run. She has most recently designed a route specified by N checkpoints (1 <= N <= 100,000) that must be visited in sequence.
Unfortunately, Bessie realizes that the other cows may not have the stamina to run the full route. She therefore wants to know how long certain sub-routes take to run, where a sub-route is a contiguous subsequence of the checkpoints from the full route. To make matters more complicated, Bessie knows that the other cows, being lazy, might choose to skip one checkpoint any time they run a sub-route -- whichever one results in a minimum total travel time. They are not allowed to skip the first or last checkpoints in a sub-route, however.
In order to build the best possible marathon course, Bessie wants to investigate the ramifications of making changes to the checkpoint locations in her current course. Please help her determine how certain changes to checkpoint locations will affect the time required to run different sub-routes (taking into account that the cows might choose to omit one checkpoint any time they run a sub-route).
Since the course is set in a downtown area with a grid of streets, the distance between two checkpoints at locations (x1, y1) and (x2, y2) is given by |x1-x2| + |y1-y2|. </div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>
INPUT: (file marathon.in)
The first line gives N and Q (1 <= Q <= 100,000).
The next N lines contain (x, y) locations of N checkpoints in the
sequence they must be visited along the route. All coordinates are in the range -1000 .. 1000.
The next Q lines consist of updates and queries, one per line, to be processed in the order they are given. Lines will either take the form "U I X Y" or "Q I J". A line of the form "U I X Y" indicates that the location of checkpoint I (1 <= I <= N) is to be changed to location (X, Y). A line of the form "Q I J" asks for the minimum travel time of the sub-route from checkpoint I to checkpoint J (I <= J), given that the cows choose to skip one checkpoint along this sub-route (but not the endpoints I and J).
</div>
<h3>输出格式</h3>
<br />
<div>
OUTPUT: (file marathon.out)
For each sub-route length request, output on a single line the desired length.
</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>5 5 
-4 4 
-5 -3 
-1 5 
-3 4 
0 5 
Q 1 5 
U 4 0 1 
U 4 -1 1 
Q 2 4 
Q 1 4 
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>11 
8 
8 
</code></pre>
</article>
</div>
</div>
</body>
</html>
