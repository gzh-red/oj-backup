<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>[NOI2017]游戏 - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573380727:NPhKtu0u9vQI74cDk5IP4fP0iT+GUKT1ztrlkYoKoQs=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%5Cu72c2%5Cu91ce%5Cu98d9%5Cu8f66%5Cu662f%5Cu5c0f%20L%20%5Cu6700%5Cu559c%5Cu6b22%5Cu7684%5Cu6e38%5Cu620f%5Cu3002%5Cu4e0e%5Cu5176%5Cu4ed6%5Cu4e1a%5Cu4f59%5Cu73a9%5Cu5bb6%5Cu4e0d%5Cu540c%5Cu7684%5Cu662f%5Cuff0c%5Cu5c0f%20L%20%5Cu5728%5Cu73a9%5Cu6e38%5Cu620f%5Cu4e4b%5Cu4f59%5Cuff0c%5Cu8fd8%5Cu7cbe%5Cu4e8e%5Cu7814%5Cu7a76%5Cu6e38%5Cu620f%5Cu7684%5Cu8bbe%5Cu8ba1%5Cuff0c%5Cu56e0%5Cu6b64%5Cu4ed6%5Cu6709%5Cu7740%5Cu4e0e%5Cu4f17%5Cu4e0d%5Cu540c%5Cu7684%5Cu6e38%5Cu620f%5Cu7b56%5Cu7565%5Cu3002%5Cn%22%2C%22description%22%3A%22%5Cu5c0f%20L%20%5Cu8ba1%5Cu5212%5Cu8fdb%5Cu884c%24n%24%5Cu573a%5Cu6e38%5Cu620f%5Cuff0c%5Cu6bcf%5Cu573a%5Cu6e38%5Cu620f%5Cu4f7f%5Cu7528%5Cu4e00%5Cu5f20%5Cu5730%5Cu56fe%5Cuff0c%5Cu5c0f%20L%20%5Cu4f1a%5Cu9009%5Cu62e9%5Cu4e00%5Cu8f86%5Cu8f66%5Cu5728%5Cu8be5%5Cu5730%5Cu56fe%5Cu4e0a%5Cu5b8c%5Cu6210%5Cu6e38%5Cu620f%5Cu3002%5Cn%5Cn%5Cu5c0f%20L%20%5Cu7684%5Cu8d5b%5Cu8f66%5Cu6709%5Cu4e09%5Cu8f86%5Cuff0c%5Cu5206%5Cu522b%5Cu7528%5Cu5927%5Cu5199%5Cu5b57%5Cu6bcd%2A%2AA%2A%2A%5Cu3001%2A%2AB%2A%2A%5Cu3001%2A%2AC%2A%2A%5Cu8868%5Cu793a%5Cu3002%5Cu5730%5Cu56fe%5Cu4e00%5Cu5171%5Cu6709%5Cu56db%5Cu79cd%5Cuff0c%5Cu5206%5Cu522b%5Cu7528%5Cu5c0f%5Cu5199%5Cu5b57%5Cu6bcd%2A%2Ax%2A%2A%5Cu3001%2A%2Aa%2A%2A%5Cu3001%2A%2Ab%2A%2A%5Cu3001%2A%2Ac%2A%2A%5Cu8868%5Cu793a%5Cu3002%5Cu5176%5Cu4e2d%5Cuff0c%5Cu8d5b%5Cu8f66%2A%2AA%2A%2A%5Cu4e0d%5Cu9002%5Cu5408%5Cu5728%5Cu5730%5Cu56fe%2A%2Aa%2A%2A%5Cu4e0a%5Cu4f7f%5Cu7528%5Cuff0c%5Cu8d5b%5Cu8f66%2A%2AB%2A%2A%5Cu4e0d%5Cu9002%5Cu5408%5Cu5728%5Cu5730%5Cu56fe%2A%2Ab%2A%2A%5Cu4e0a%5Cu4f7f%5Cu7528%5Cuff0c%5Cu8d5b%5Cu8f66%2A%2AC%2A%2A%5Cu4e0d%5Cu9002%5Cu5408%5Cu5728%5Cu5730%5Cu56fe%2A%2Ac%2A%2A%5Cu4e0a%5Cu4f7f%5Cu7528%5Cuff0c%5Cu800c%5Cu5730%5Cu56fe%2A%2Ax%2A%2A%5Cu5219%5Cu9002%5Cu5408%5Cu6240%5Cu6709%5Cu8d5b%5Cu8f66%5Cu53c2%5Cu52a0%5Cu3002%5Cu9002%5Cu5408%5Cu6240%5Cu6709%5Cu8d5b%5Cu8f66%5Cu53c2%5Cu52a0%5Cu7684%5Cu5730%5Cu56fe%5Cu5e76%5Cu4e0d%5Cu591a%5Cu89c1%5Cuff0c%5Cu6700%5Cu591a%5Cu53ea%5Cu4f1a%5Cu6709%2A%2Ad%2A%2A%5Cu5f20%5Cu3002%5Cn%5Cn%24n%24%5Cu573a%5Cu6e38%5Cu620f%5Cu7684%5Cu5730%5Cu56fe%5Cu53ef%5Cu4ee5%5Cu7528%5Cu4e00%5Cu4e2a%5Cu5c0f%5Cu5199%5Cu5b57%5Cu6bcd%5Cu7ec4%5Cu6210%5Cu7684%5Cu5b57%5Cu7b26%5Cu4e32%5Cu63cf%5Cu8ff0%5Cu3002%5Cu4f8b%5Cu5982%5Cuff1a%60S%3Dxaabxcbc%60%5Cu8868%5Cu793a%5Cu5c0f%20L%20%5Cu8ba1%5Cu5212%5Cu8fdb%5Cu884c%248%24%5Cu573a%5Cu6e38%5Cu620f%5Cuff0c%5Cu5176%5Cu4e2d%5Cu7b2c%241%24%5Cu573a%5Cu548c%5Cu7b2c%245%24%5Cu573a%5Cu7684%5Cu5730%5Cu56fe%5Cu7c7b%5Cu578b%5Cu662f%2A%2Ax%2A%2A%5Cuff0c%5Cu9002%5Cu5408%5Cu6240%5Cu6709%5Cu8d5b%5Cu8f66%5Cuff0c%5Cu7b2c%242%24%5Cu573a%5Cu548c%5Cu7b2c%243%24%5Cu573a%5Cu7684%5Cu5730%5Cu56fe%5Cu662f%2A%2Aa%2A%2A%5Cuff0c%5Cu4e0d%5Cu9002%5Cu5408%5Cu8d5b%5Cu8f66%2A%2AA%2A%2A%5Cuff0c%5Cu7b2c%244%24%5Cu573a%5Cu548c%5Cu7b2c%247%24%5Cu573a%5Cu7684%5Cu5730%5Cu56fe%5Cu662f%2A%2Ab%2A%2A%5Cuff0c%5Cu4e0d%5Cu9002%5Cu5408%5Cu8d5b%5Cu8f66%2A%2AB%2A%2A%5Cuff0c%5Cu7b2c%246%24%5Cu573a%5Cu548c%5Cu7b2c%248%24%5Cu573a%5Cu7684%5Cu5730%5Cu56fe%5Cu662f%2A%2Ac%2A%2A%5Cuff0c%5Cu4e0d%5Cu9002%5Cu5408%5Cu8d5b%5Cu8f66%2A%2AC%2A%2A%5Cu3002%5Cn%5Cn%5Cu5c0f%20L%20%5Cu5bf9%5Cu6e38%5Cu620f%5Cu6709%5Cu4e00%5Cu4e9b%5Cu7279%5Cu6b8a%5Cu7684%5Cu8981%5Cu6c42%5Cuff0c%5Cu8fd9%5Cu4e9b%5Cu8981%5Cu6c42%5Cu53ef%5Cu4ee5%5Cu7528%5Cu56db%5Cu5143%5Cu7ec4%20%24%28i%2C%20h_i%2C%20j%2C%20h_j%29%24%5Cu6765%5Cu63cf%5Cu8ff0%5Cuff0c%5Cu8868%5Cu793a%5Cu82e5%5Cu5728%5Cu7b2c%24i%24%5Cu573a%5Cu4f7f%5Cu7528%5Cu578b%5Cu53f7%5Cu4e3a%24h_i%24%5Cu7684%5Cu8f66%5Cu5b50%5Cuff0c%5Cu5219%5Cu7b2c%24j%24%5Cu573a%5Cu6e38%5Cu620f%5Cu8981%5Cu4f7f%5Cu7528%5Cu578b%5Cu53f7%5Cu4e3a%24h_j%24%5Cu7684%5Cu8f66%5Cu5b50%5Cu3002%5Cn%5Cn%5Cu4f60%5Cu80fd%5Cu5e2e%5Cu5c0f%20L%20%5Cu9009%5Cu62e9%5Cu6bcf%5Cu573a%5Cu6e38%5Cu620f%5Cu4f7f%5Cu7528%5Cu7684%5Cu8d5b%5Cu8f66%5Cu5417%5Cuff1f%5Cu5982%5Cu679c%5Cu6709%5Cu591a%5Cu79cd%5Cu65b9%5Cu6848%5Cuff0c%5Cu8f93%5Cu51fa%5Cu4efb%5Cu610f%5Cu4e00%5Cu79cd%5Cu65b9%5Cu6848%5Cu3002%5Cu5982%5Cu679c%5Cu65e0%5Cu89e3%5Cuff0c%5Cu8f93%5Cu51fa%20%5Cu201c%60-1%60%5Cu2019%5Cu2019%5Cuff08%5Cu4e0d%5Cu542b%5Cu53cc%5Cu5f15%5Cu53f7%5Cuff09%5Cu3002%5Cn%22%2C%22inputFormat%22%3A%22%5Cu8f93%5Cu5165%5Cu7b2c%5Cu4e00%5Cu884c%5Cu5305%5Cu542b%5Cu4e24%5Cu4e2a%5Cu975e%5Cu8d1f%5Cu6574%5Cu6570%24n%2C%20d%24%5Cu3002%5Cn%5Cn%5Cu8f93%5Cu5165%5Cu7b2c%5Cu4e8c%5Cu884c%5Cu4e3a%5Cu4e00%5Cu4e2a%5Cu5b57%5Cu7b26%5Cu4e32%24S%24%5Cu3002%24n%2C%20d%2C%20S%24%5Cu7684%5Cu542b%5Cu4e49%5Cu89c1%5Cu9898%5Cu76ee%5Cu63cf%5Cu8ff0%5Cuff0c%5Cu5176%5Cu4e2d%24S%24%5Cu5305%5Cu542b%24n%24%5Cu4e2a%5Cu5b57%5Cu7b26%5Cuff0c%5Cu4e14%5Cu5176%5Cu4e2d%5Cu6070%5Cu597d%24d%24%5Cu4e2a%5Cu4e3a%5Cu5c0f%5Cu5199%5Cu5b57%5Cu6bcd%24x%24%5Cu3002%5Cn%5Cn%5Cu8f93%5Cu5165%5Cu7b2c%5Cu4e09%5Cu884c%5Cu4e3a%5Cu4e00%5Cu4e2a%5Cu6b63%5Cu6574%5Cu6570%24m%24%5Cuff0c%5Cu8868%5Cu793a%5Cu6709%24m%24%5Cu6761%5Cu7528%5Cu8f66%5Cu89c4%5Cu5219%5Cu3002%5Cu63a5%5Cu4e0b%5Cu6765%24m%24%5Cu884c%5Cuff0c%5Cu6bcf%5Cu884c%5Cu5305%5Cu542b%5Cu4e00%5Cu4e2a%5Cu56db%5Cu5143%5Cu7ec4%24i%2C%20h_i%2C%20j%2C%20h_j%24%5Cuff0c%5Cu5176%5Cu4e2d%24i%2C%20j%24%5Cu4e3a%5Cu6574%5Cu6570%5Cuff0c%24h_i%2C%20h_j%24%5Cu4e3a%5Cu5b57%5Cu7b26%2A%2Aa%2A%2A%5Cu3001%2A%2Ab%2A%2A%5Cu6216%2A%2Ac%2A%2A%5Cuff0c%5Cu542b%5Cu4e49%5Cu89c1%5Cu9898%5Cu76ee%5Cu63cf%5Cu8ff0%5Cu3002%5Cn%22%2C%22outputFormat%22%3A%22%5Cu8f93%5Cu51fa%5Cu4e00%5Cu884c%5Cu3002%5Cn%5Cn%5Cu82e5%5Cu65e0%5Cu89e3%5Cu8f93%5Cu51fa%20%5Cu201c%60-1%60%5Cu2019%5Cu2019%5Cuff08%5Cu4e0d%5Cu542b%5Cu53cc%5Cu5f15%5Cu53f7%5Cuff09%5Cu3002%5Cn%5Cn%5Cu82e5%5Cu6709%5Cu89e3%5Cuff0c%5Cu5219%5Cu5305%5Cu542b%5Cu4e00%5Cu4e2a%5Cu957f%5Cu5ea6%5Cu4e3a%24n%24%5Cu7684%5Cu4ec5%5Cu5305%5Cu542b%5Cu5927%5Cu5199%5Cu5b57%5Cu6bcd%2A%2AA%2A%2A%5Cu3001%2A%2AB%2A%2A%5Cu3001%2A%2AC%2A%2A%5Cu7684%5Cu5b57%5Cu7b26%5Cu4e32%5Cuff0c%5Cu8868%5Cu793a%5Cu5c0f%20L%20%5Cu5728%5Cu8fd9%24n%24%5Cu573a%5Cu6e38%5Cu620f%5Cu4e2d%5Cu5982%5Cu4f55%5Cu5b89%5Cu6392%5Cu8d5b%5Cu8f66%5Cu7684%5Cu4f7f%5Cu7528%5Cu3002%5Cu5982%5Cu679c%5Cu5b58%5Cu5728%5Cu591a%5Cu7ec4%5Cu89e3%5Cuff0c%5Cu8f93%5Cu51fa%5Cu5176%5Cu4e2d%5Cu4efb%5Cu610f%5Cu4e00%5Cu7ec4%5Cu5373%5Cu53ef%5Cu3002%5Cn%5Cn%23%23%20%5Cu56e0%5Cu4e3aspacial%20judge%5Cuff0c%5Cu6700%5Cu540e%5Cu4e00%5Cu884c%5Cu4e0d%5Cu8981%5Cu8f93%5Cu51fa%5Cu56de%5Cu8f66%5Cu3002%5Cn%22%2C%22samples%22%3A%5B%5B%223%201%5Cnxcc%5Cn1%5Cn1%20A%202%20B%22%2C%22ABA%22%5D%2C%5B%22100%208%5Cnbbccxabbcxaabbabcaaxbxaaccbcxcccbaccbccbbacaabcbcabxccbbabccabcabbacbbbbabccaabcaaacbabcacxabaxcabbb%5Cn200%5Cn61%20B%2014%20A%5Cn34%20B%2076%20B%5Cn17%20B%2013%20A%5Cn5%20C%202%20C%5Cn90%20A%2073%20C%5Cn6%20B%2072%20C%5Cn21%20A%201%20C%5Cn54%20B%2096%20B%5Cn2%20C%2044%20B%5Cn7%20A%2032%20B%5Cn71%20A%2083%20C%5Cn65%20A%2021%20A%5Cn32%20B%2045%20B%5Cn18%20B%2034%20B%5Cn51%20A%2013%20A%5Cn89%20C%2063%20B%5Cn26%20B%2022%20C%5Cn38%20B%2094%20C%5Cn86%20C%2095%20C%5Cn95%20C%2076%20B%5Cn67%20B%20100%20A%5Cn99%20A%2040%20A%5Cn35%20A%2053%20B%5Cn47%20B%2041%20A%5Cn36%20B%2069%20A%5Cn75%20B%2052%20B%5Cn90%20A%207%20A%5Cn96%20B%2059%20A%5Cn92%20C%2098%20C%5Cn23%20B%2080%20B%5Cn13%20A%2048%20A%5Cn54%20B%202%20C%5Cn93%20C%2039%20A%5Cn96%20B%2087%20A%5Cn66%20A%2015%20C%5Cn38%20B%2016%20A%5Cn54%20B%2041%20A%5Cn67%20B%2040%20A%5Cn45%20B%2066%20A%5Cn32%20B%2080%20B%5Cn34%20B%2059%20A%5Cn31%20B%2075%20B%5Cn65%20A%2078%20C%5Cn34%20B%2056%20C%5Cn28%20B%208%20A%5Cn87%20A%2040%20A%5Cn56%20C%2040%20A%5Cn93%20C%20100%20A%5Cn31%20B%2041%20A%5Cn39%20A%2048%20A%5Cn55%20C%2028%20B%5Cn64%20C%2060%20B%5Cn69%20A%2082%20C%5Cn99%20A%2013%20A%5Cn47%20B%2030%20B%5Cn45%20B%2033%20A%5Cn88%20A%2075%20B%5Cn59%20A%204%20B%5Cn53%20B%2044%20B%5Cn11%20B%2080%20B%5Cn52%20B%2050%20C%5Cn71%20A%207%20A%5Cn41%20A%2063%20B%5Cn58%20A%2023%20B%5Cn55%20C%2096%20B%5Cn71%20A%209%20A%5Cn24%20B%2034%20B%5Cn68%20B%2092%20C%5Cn15%20C%2018%20B%5Cn56%20C%2014%20A%5Cn98%20C%2039%20A%5Cn27%20A%2056%20C%5Cn95%20C%2031%20B%5Cn100%20A%2057%20C%5Cn62%20C%2051%20A%5Cn6%20B%2032%20B%5Cn9%20A%2099%20A%5Cn46%20C%2066%20A%5Cn21%20A%201%20C%5Cn14%20A%2091%20C%5Cn61%20B%2037%20A%5Cn76%20B%2081%20B%5Cn80%20B%2043%20B%5Cn98%20C%2087%20A%5Cn56%20C%2049%20A%5Cn39%20A%205%20C%5Cn88%20A%2065%20A%5Cn60%20B%2034%20B%5Cn95%20C%2011%20B%5Cn90%20A%2056%20C%5Cn61%20B%2048%20A%5Cn87%20A%2021%20A%5Cn46%20C%2084%20A%5Cn87%20A%2018%20B%5Cn36%20B%2052%20B%5Cn61%20B%2097%20B%5Cn40%20A%2036%20B%5Cn77%20C%2071%20A%5Cn78%20C%2026%20B%5Cn57%20C%2085%20C%5Cn75%20B%2095%20C%5Cn41%20A%2014%20A%5Cn59%20A%201%20C%5Cn47%20B%205%20C%5Cn11%20B%2088%20A%5Cn60%20B%2024%20B%5Cn35%20A%2098%20C%5Cn44%20B%2032%20B%5Cn2%20C%2069%20A%5Cn33%20A%2062%20C%5Cn65%20A%2072%20C%5Cn97%20B%2093%20C%5Cn94%20C%2027%20A%5Cn19%20C%2051%20A%5Cn63%20B%2045%20B%5Cn97%20B%204%20B%5Cn10%20A%208%20A%5Cn4%20B%2056%20C%5Cn12%20C%2066%20A%5Cn95%20C%2072%20C%5Cn41%20A%2030%20B%5Cn69%20A%2085%20C%5Cn13%20A%202%20C%5Cn18%20B%2014%20A%5Cn71%20A%203%20B%5Cn75%20B%2087%20A%5Cn26%20B%2024%20B%5Cn80%20B%2020%20B%5Cn2%20C%2050%20C%5Cn70%20A%2064%20C%5Cn46%20C%2018%20B%5Cn67%20B%2055%20C%5Cn25%20B%2022%20C%5Cn62%20C%2037%20A%5Cn40%20A%2056%20C%5Cn60%20B%2080%20B%5Cn37%20A%2028%20B%5Cn16%20A%2050%20C%5Cn82%20C%2034%20B%5Cn15%20C%204%20B%5Cn88%20A%2042%20B%5Cn90%20A%2013%20A%5Cn17%20B%2021%20A%5Cn32%20B%2018%20B%5Cn22%20C%2053%20B%5Cn81%20B%2067%20B%5Cn71%20A%2048%20A%5Cn73%20C%2047%20B%5Cn21%20A%2034%20B%5Cn83%20C%2060%20B%5Cn40%20A%2078%20C%5Cn22%20C%207%20A%5Cn79%20C%2055%20C%5Cn40%20A%2046%20C%5Cn58%20A%2079%20C%5Cn87%20A%2099%20A%5Cn92%20C%2055%20C%5Cn20%20B%2075%20B%5Cn72%20C%2041%20A%5Cn28%20B%2052%20B%5Cn60%20B%2050%20C%5Cn51%20A%2032%20B%5Cn96%20B%2024%20B%5Cn18%20B%2031%20B%5Cn83%20C%2059%20A%5Cn24%20B%2074%20A%5Cn88%20A%2097%20B%5Cn81%20B%2067%20B%5Cn51%20A%2072%20C%5Cn64%20C%208%20A%5Cn51%20A%2050%20C%5Cn7%20A%2042%20B%5Cn4%20B%2078%20C%5Cn68%20B%2027%20A%5Cn70%20A%2095%20C%5Cn30%20B%2029%20C%5Cn96%20B%2081%20B%5Cn13%20A%2044%20B%5Cn4%20B%2082%20C%5Cn74%20A%2038%20B%5Cn92%20C%2049%20A%5Cn12%20C%2079%20C%5Cn46%20C%2044%20B%5Cn97%20B%2096%20B%5Cn15%20C%2060%20B%5Cn56%20C%2065%20A%5Cn61%20B%2014%20A%5Cn58%20A%2016%20A%5Cn43%20B%2026%20B%5Cn42%20B%2012%20C%5Cn72%20C%2024%20B%5Cn41%20A%2068%20B%5Cn4%20B%205%20C%5Cn63%20B%2059%20A%5Cn86%20C%2088%20A%5Cn48%20A%2077%20C%5Cn36%20B%2059%20A%5Cn7%20A%2033%20A%5Cn2%20C%2056%20C%5Cn81%20B%2069%20A%5Cn%22%2C%22CABABCCABBCBCABAACBCCBCCAACBCBAACCBAAABCCCACCAACACCBAAAACCBACAABCCCACCCABCAABBAACBBACBCBBBCBABBACACA%5Cn%22%5D%5D%2C%22hint%22%3A%22%5Cu3010%5Cu6837%5Cu4f8b1%5Cu89e3%5Cu91ca%5Cu3011%5Cn%5Cn%5Cu5c0f%20L%20%5Cu8ba1%5Cu5212%5Cu8fdb%5Cu884c%243%24%5Cu573a%5Cu6e38%5Cu620f%5Cuff0c%5Cu5176%5Cu4e2d%5Cu7b2c%241%24%5Cu573a%5Cu7684%5Cu5730%5Cu56fe%5Cu7c7b%5Cu578b%5Cu662f%2A%2Ax%2A%2A%5Cuff0c%5Cu9002%5Cu5408%5Cu6240%5Cu6709%5Cu8d5b%5Cu8f66%5Cuff0c%5Cu7b2c%242%24%5Cu573a%5Cu548c%5Cu7b2c%243%24%5Cu573a%5Cu7684%5Cu5730%5Cu56fe%5Cu662f%2A%2Ac%2A%2A%5Cuff0c%5Cu4e0d%5Cu9002%5Cu5408%5Cu8d5b%5Cu8f66%2A%2AC%2A%2A%5Cu3002%5Cn%5Cn%5Cu5c0f%20L%20%5Cu5e0c%5Cu671b%5Cuff1a%5Cu82e5%5Cu7b2c%241%24%5Cu573a%5Cu6e38%5Cu620f%5Cu4f7f%5Cu7528%5Cu8d5b%5Cu8f66%2A%2AA%2A%2A%5Cuff0c%5Cu5219%5Cu7b2c%242%24%5Cu573a%5Cu6e38%5Cu620f%5Cu4f7f%5Cu7528%5Cu8d5b%5Cu8f66%2A%2AB%2A%2A%5Cu3002%5Cu90a3%5Cu4e48%5Cu4e3a%5Cu8fd9%243%24%5Cu573a%5Cu6e38%5Cu620f%5Cu5206%5Cu522b%5Cu5b89%5Cu6392%5Cu8d5b%5Cu8f66%2A%2AA%2A%2A%5Cu3001%2A%2AB%2A%2A%5Cu3001%2A%2AA%2A%2A%5Cu53ef%5Cu4ee5%5Cu6ee1%5Cu8db3%5Cu6240%5Cu6709%5Cu6761%5Cu4ef6%5Cu3002%5Cu82e5%5Cu4f9d%5Cu6b21%5Cu4e3a%243%24%5Cu573a%5Cu6e38%5Cu620f%5Cu5b89%5Cu6392%5Cu8d5b%5Cu8f66%5Cu4e3a%2A%2ABBB%2A%2A%5Cu6216%2A%2ABAA%2A%2A%5Cu65f6%5Cuff0c%5Cu4e5f%5Cu53ef%5Cu4ee5%5Cu6ee1%5Cu8db3%5Cu6240%5Cu6709%5Cu6761%5Cu4ef6%5Cuff0c%5Cu4e5f%5Cu88ab%5Cu89c6%5Cu4e3a%5Cu6b63%5Cu786e%5Cu7b54%5Cu6848%5Cu3002%5Cu4f46%5Cu4f9d%5Cu6b21%5Cu5b89%5Cu6392%5Cu8d5b%5Cu8f66%5Cu4e3a%2A%2AAAB%2A%2A%5Cu6216%2A%2AABC%2A%2A%5Cu65f6%5Cuff0c%5Cu56e0%5Cu4e3a%5Cu4e0d%5Cu80fd%5Cu6ee1%5Cu8db3%5Cu6240%5Cu6709%5Cu6761%5Cu4ef6%5Cuff0c%5Cu6240%5Cu4ee5%5Cu4e0d%5Cu88ab%5Cu89c6%5Cu4e3a%5Cu6b63%5Cu786e%5Cu7b54%5Cu6848%5Cu3002%5Cn%5Cn%5Cn%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fpic%5C%2F6458.png%29%5Cn%5Cn%60%60%60%5Cn%5Cu8be6%5Cu7ec6%5Cu4fe1%5Cu606f%5Cu89e3%5Cu91ca%5Cuff1a%5Cn%5Cn1.score%3AQAQ%5Cuff1a%5Cu6b64%5Cu6d4b%5Cu8bd5%5Cu70b9%5Cu5e94%5Cu8be5%5Cu8f93%5Cu51fa-1%5Cu7136%5Cu800c%5Cu4f60%5Cu8f93%5Cu51fa%5Cu7684%5Cu662f%5Cu522b%5Cu7684%5Cn%5Cn2.score%3AQWQ%5Cuff1a%5Cu6b64%5Cu6d4b%5Cu8bd5%5Cu70b9%5Cu5e94%5Cu8be5%5Cu8f93%5Cu51fa-1%5Cu7136%5Cu800c%5Cu4f60%5Cu8f93%5Cu51fa%5Cu7684%5Cu662f-XXX%28%5Cu5c31%5Cu662f%5Cu8d1f%5Cu53f7%5Cu5bf9%5Cu4e86%5Cu540e%5Cu9762%5Cu9519%5Cu4e86%29%20%5Cn%5Cn3.score%3Apwp%5Cuff1a%5Cu6b64%5Cu6d4b%5Cu8bd5%5Cu70b9%5Cu5e94%5Cu8be5%5Cu8f93%5Cu51fa-1%5Cu5e76%5Cu4e14%5Cu4f60%5Cu7684%5Cu7b54%5Cu6848%5Cu662f%5Cu6b63%5Cu786e%5Cu7684%5Cn%5Cn4.score%3Aqwq%5Cuff1a%5Cu4f60%5Cu7684%5Cu65b9%5Cu6848%5Cu91cc%5Cu51fa%5Cu73b0%5Cu4e86%5Cu4e0d%5Cu662fA%2CB%2CC%5Cu7684%5Cu5b57%5Cu7b26%5Cn%5Cn5.score%3Aqaq%5Cuff1a%5Cu4f60%5Cu7684%5Cu65b9%5Cu6848%5Cu5728%5Cu7b2cx%5Cu7684%5Cu56fe%5Cu4e2d%5Cu7528%5Cu4e86%5Cu4e0d%5Cu8ba9%5Cu7528%5Cu7684%5Cu8f66%5Cn%5Cn6.score%3Apvp%5Cuff1a%5Cu4f60%5Cu7684%5Cu65b9%5Cu6848%5Cu4e0d%5Cu80fd%5Cu6ee1%5Cu8db3%5Cu7b2cx%5Cu4e2a%5Cu7ea6%5Cu675f%5Cn%5Cn7.score%3Aqvq%5Cuff1a%5Cu4f60%5Cu7684%5Cu7b54%5Cu6848%5Cu6b63%5Cu786e%5Cuff0c%5Cu606d%5Cu559c%5Cu5624%5Cu5624%5Cu5624%5Cn%5Cnelse%3A%5Cu86c7%5Cu76aejudge%5Cu6ca1%5Cu80fd%5Cu6b63%5Cu786e%5Cu8bfb%5Cu5165%5Cu5e94%5Cu8be5%5Cu8bfb%5Cu7684%5Cu4e1c%5Cu897f%5Cu2026%5Cu2026%5Cn%60%60%60%5Cn%22%2C%22provider%22%3A%7B%22uid%22%3A22558%2C%22name%22%3A%22deluxurous%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3Anull%2C%22isAdmin%22%3Afalse%2C%22color%22%3A%22Blue%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%5D%2C%22memory%22%3A%5B128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22tags%22%3A%5B34%2C77%2C107%2C108%2C159%2C176%2C179%2C319%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A3021%2C%22totalAccepted%22%3A840%2C%22pid%22%3A%22P3825%22%2C%22title%22%3A%22%5BNOI2017%5D%5Cu6e38%5Cu620f%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A164638%2C%22title%22%3A%22%5Cu4e0d%5Cu77e5%5Cu9053%5Cu6f0f%5Cu4e86%5Cu54ea%5Cu4e9b%5Cu7ec6%5Cu8282%5Cuff0c%5Cu6c42%5Cu5927%5Cu4f6c%5Cu5e2e%5Cu52a9%22%2C%22forum%22%3A%7B%22id%22%3A5136%2C%22name%22%3A%22P3825%20%5BNOI2017%5D%5Cu6e38%5Cu620f%22%2C%22slug%22%3A%22P3825%22%7D%7D%2C%7B%22id%22%3A144245%2C%22title%22%3A%22%5Cu59b9%5Cu5b50%5Cu840c%5Cu65b0%5Cu521a%5Cu5b66CSP%5Cu6c42%5Cu52a9%22%2C%22forum%22%3A%7B%22id%22%3A5136%2C%22name%22%3A%22P3825%20%5BNOI2017%5D%5Cu6e38%5Cu620f%22%2C%22slug%22%3A%22P3825%22%7D%7D%2C%7B%22id%22%3A123960%2C%22title%22%3A%22%5Cu8fd9%5Cu9898%5Cu4e3a%5Cu4ec0%5Cu4e48%5Cu8981%5Cu7528tarjan%5Cuff1f%22%2C%22forum%22%3A%7B%22id%22%3A5136%2C%22name%22%3A%22P3825%20%5BNOI2017%5D%5Cu6e38%5Cu620f%22%2C%22slug%22%3A%22P3825%22%7D%7D%2C%7B%22id%22%3A111787%2C%22title%22%3A%22%5Cu8bf7%5Cu6c42%5Cu52a0hack%5Cu6570%5Cu636e%22%2C%22forum%22%3A%7B%22id%22%3A5136%2C%22name%22%3A%22P3825%20%5BNOI2017%5D%5Cu6e38%5Cu620f%22%2C%22slug%22%3A%22P3825%22%7D%7D%2C%7B%22id%22%3A109962%2C%22title%22%3A%22%5Cu8fd9%5Cu9898%5Cu6808%5Cu7a7a%5Cu95f4%5Cu6709%5Cu6bd2%5Cu5427%22%2C%22forum%22%3A%7B%22id%22%3A5136%2C%22name%22%3A%22P3825%20%5BNOI2017%5D%5Cu6e38%5Cu620f%22%2C%22slug%22%3A%22P3825%22%7D%7D%2C%7B%22id%22%3A101125%2C%22title%22%3A%22%5Cu6ce8%5Cu610fspj%22%2C%22forum%22%3A%7B%22id%22%3A5136%2C%22name%22%3A%22P3825%20%5BNOI2017%5D%5Cu6e38%5Cu620f%22%2C%22slug%22%3A%22P3825%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P3209%22%2C%22title%22%3A%22%5BHNOI2010%5D%5Cu5e73%5Cu9762%5Cu56fe%5Cu5224%5Cu5b9a%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P3822%22%2C%22title%22%3A%22%5BNOI2017%5D%5Cu6574%5Cu6570%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P3823%22%2C%22title%22%3A%22%5BNOI2017%5D%5Cu86af%5Cu8693%5Cu6392%5Cu961f%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P3826%22%2C%22title%22%3A%22%5BNOI2017%5D%5Cu852c%5Cu83dc%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P4171%22%2C%22title%22%3A%22%5BJSOI2010%5D%5Cu6ee1%5Cu6c49%5Cu5168%5Cu5e2d%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22%5BNOI2017%5D%5Cu6e38%5Cu620f%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573286098;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>[NOI2017]游戏</h1>
<h2>题目背景</h2>
<div>狂野飙车是小 L 最喜欢的游戏。与其他业余玩家不同的是，小 L 在玩游戏之余，还精于研究游戏的设计，因此他有着与众不同的游戏策略。
</div>
<h2>题目描述</h2>
<div>小 L 计划进行$n$场游戏，每场游戏使用一张地图，小 L 会选择一辆车在该地图上完成游戏。
小 L 的赛车有三辆，分别用大写字母**A**、**B**、**C**表示。地图一共有四种，分别用小写字母**x**、**a**、**b**、**c**表示。其中，赛车**A**不适合在地图**a**上使用，赛车**B**不适合在地图**b**上使用，赛车**C**不适合在地图**c**上使用，而地图**x**则适合所有赛车参加。适合所有赛车参加的地图并不多见，最多只会有**d**张。
$n$场游戏的地图可以用一个小写字母组成的字符串描述。例如：`S=xaabxcbc`表示小 L 计划进行$8$场游戏，其中第$1$场和第$5$场的地图类型是**x**，适合所有赛车，第$2$场和第$3$场的地图是**a**，不适合赛车**A**，第$4$场和第$7$场的地图是**b**，不适合赛车**B**，第$6$场和第$8$场的地图是**c**，不适合赛车**C**。
小 L 对游戏有一些特殊的要求，这些要求可以用四元组 $(i, h_i, j, h_j)$来描述，表示若在第$i$场使用型号为$h_i$的车子，则第$j$场游戏要使用型号为$h_j$的车子。
你能帮小 L 选择每场游戏使用的赛车吗？如果有多种方案，输出任意一种方案。如果无解，输出 “`-1`’’（不含双引号）。
</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>输入第一行包含两个非负整数$n, d$。
输入第二行为一个字符串$S$。$n, d, S$的含义见题目描述，其中$S$包含$n$个字符，且其中恰好$d$个为小写字母$x$。
输入第三行为一个正整数$m$，表示有$m$条用车规则。接下来$m$行，每行包含一个四元组$i, h_i, j, h_j$，其中$i, j$为整数，$h_i, h_j$为字符**a**、**b**或**c**，含义见题目描述。
</div>
<h3>输出格式</h3>
<br />
<div>输出一行。
若无解输出 “`-1`’’（不含双引号）。
若有解，则包含一个长度为$n$的仅包含大写字母**A**、**B**、**C**的字符串，表示小 L 在这$n$场游戏中如何安排赛车的使用。如果存在多组解，输出其中任意一组即可。
## 因为spacial judge，最后一行不要输出回车。
</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>3 1
xcc
1
1 A 2 B</code></pre>
<h3>输出样例 #1</h3>
<pre><code>ABA</code></pre>
<h3>输入样例 #2</h3>
<pre><code>100 8
bbccxabbcxaabbabcaaxbxaaccbcxcccbaccbccbbacaabcbcabxccbbabccabcabbacbbbbabccaabcaaacbabcacxabaxcabbb
200
61 B 14 A
34 B 76 B
17 B 13 A
5 C 2 C
90 A 73 C
6 B 72 C
21 A 1 C
54 B 96 B
2 C 44 B
7 A 32 B
71 A 83 C
65 A 21 A
32 B 45 B
18 B 34 B
51 A 13 A
89 C 63 B
26 B 22 C
38 B 94 C
86 C 95 C
95 C 76 B
67 B 100 A
99 A 40 A
35 A 53 B
47 B 41 A
36 B 69 A
75 B 52 B
90 A 7 A
96 B 59 A
92 C 98 C
23 B 80 B
13 A 48 A
54 B 2 C
93 C 39 A
96 B 87 A
66 A 15 C
38 B 16 A
54 B 41 A
67 B 40 A
45 B 66 A
32 B 80 B
34 B 59 A
31 B 75 B
65 A 78 C
34 B 56 C
28 B 8 A
87 A 40 A
56 C 40 A
93 C 100 A
31 B 41 A
39 A 48 A
55 C 28 B
64 C 60 B
69 A 82 C
99 A 13 A
47 B 30 B
45 B 33 A
88 A 75 B
59 A 4 B
53 B 44 B
11 B 80 B
52 B 50 C
71 A 7 A
41 A 63 B
58 A 23 B
55 C 96 B
71 A 9 A
24 B 34 B
68 B 92 C
15 C 18 B
56 C 14 A
98 C 39 A
27 A 56 C
95 C 31 B
100 A 57 C
62 C 51 A
6 B 32 B
9 A 99 A
46 C 66 A
21 A 1 C
14 A 91 C
61 B 37 A
76 B 81 B
80 B 43 B
98 C 87 A
56 C 49 A
39 A 5 C
88 A 65 A
60 B 34 B
95 C 11 B
90 A 56 C
61 B 48 A
87 A 21 A
46 C 84 A
87 A 18 B
36 B 52 B
61 B 97 B
40 A 36 B
77 C 71 A
78 C 26 B
57 C 85 C
75 B 95 C
41 A 14 A
59 A 1 C
47 B 5 C
11 B 88 A
60 B 24 B
35 A 98 C
44 B 32 B
2 C 69 A
33 A 62 C
65 A 72 C
97 B 93 C
94 C 27 A
19 C 51 A
63 B 45 B
97 B 4 B
10 A 8 A
4 B 56 C
12 C 66 A
95 C 72 C
41 A 30 B
69 A 85 C
13 A 2 C
18 B 14 A
71 A 3 B
75 B 87 A
26 B 24 B
80 B 20 B
2 C 50 C
70 A 64 C
46 C 18 B
67 B 55 C
25 B 22 C
62 C 37 A
40 A 56 C
60 B 80 B
37 A 28 B
16 A 50 C
82 C 34 B
15 C 4 B
88 A 42 B
90 A 13 A
17 B 21 A
32 B 18 B
22 C 53 B
81 B 67 B
71 A 48 A
73 C 47 B
21 A 34 B
83 C 60 B
40 A 78 C
22 C 7 A
79 C 55 C
40 A 46 C
58 A 79 C
87 A 99 A
92 C 55 C
20 B 75 B
72 C 41 A
28 B 52 B
60 B 50 C
51 A 32 B
96 B 24 B
18 B 31 B
83 C 59 A
24 B 74 A
88 A 97 B
81 B 67 B
51 A 72 C
64 C 8 A
51 A 50 C
7 A 42 B
4 B 78 C
68 B 27 A
70 A 95 C
30 B 29 C
96 B 81 B
13 A 44 B
4 B 82 C
74 A 38 B
92 C 49 A
12 C 79 C
46 C 44 B
97 B 96 B
15 C 60 B
56 C 65 A
61 B 14 A
58 A 16 A
43 B 26 B
42 B 12 C
72 C 24 B
41 A 68 B
4 B 5 C
63 B 59 A
86 C 88 A
48 A 77 C
36 B 59 A
7 A 33 A
2 C 56 C
81 B 69 A
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>CABABCCABBCBCABAACBCCBCCAACBCBAACCBAAABCCCACCAACACCBAAAACCBACAABCCCACCCABCAABBAACBBACBCBBBCBABBACACA
</code></pre>
<h2>说明</h2>
<div>【样例1解释】
小 L 计划进行$3$场游戏，其中第$1$场的地图类型是**x**，适合所有赛车，第$2$场和第$3$场的地图是**c**，不适合赛车**C**。
小 L 希望：若第$1$场游戏使用赛车**A**，则第$2$场游戏使用赛车**B**。那么为这$3$场游戏分别安排赛车**A**、**B**、**A**可以满足所有条件。若依次为$3$场游戏安排赛车为**BBB**或**BAA**时，也可以满足所有条件，也被视为正确答案。但依次安排赛车为**AAB**或**ABC**时，因为不能满足所有条件，所以不被视为正确答案。
![](https://cdn.luogu.com.cn/upload/pic/6458.png)
```
详细信息解释：
1.score:QAQ：此测试点应该输出-1然而你输出的是别的
2.score:QWQ：此测试点应该输出-1然而你输出的是-XXX(就是负号对了后面错了)
3.score:pwp：此测试点应该输出-1并且你的答案是正确的
4.score:qwq：你的方案里出现了不是A,B,C的字符
5.score:qaq：你的方案在第x的图中用了不让用的车
6.score:pvp：你的方案不能满足第x个约束
7.score:qvq：你的答案正确，恭喜嘤嘤嘤
else:蛇皮judge没能正确读入应该读的东西……
```
</div>
</article>
</div>
</div>
</body>
</html>
