<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>[CERC2014]Pork barrel - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573381777:gpA88yGLzCIxosIns4/tmjBMglIg3XRxGJEQ7F/p7L4=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%22%2C%22description%22%3A%22Winning%20the%20election%20was%20simpler%20than%20you%20expected%3A%20it%20was%20enough%20to%20promise%20to%20finally%20build%20a%20good%20quality%2C%20country-wide%20road%20infrastructure%2C%20of%20course%20without%20crippling%20the%20budget...%20Your%20happiness%20did%20not%20last%20long%2C%20however%3A%20it%20seems%2C%20that%20the%20citizens%20have%20found%20a%20way%20to%20actually%20hold%20you%20accountable%20for%20your%20promise%21%5Cn%5CnThere%20are%20%24n%24%20major%20cities%20in%20your%20country.%20The%20Ministry%20of%20Transport%20has%20prepared%20a%20detailed%20map%2C%20outlining%20%24m%24%20possible%20highway%20connections%2C%20together%20with%20their%20costs.%20The%20Quality%20Assurance%20Committee%20will%20not%20let%20you%20build%20a%20highway%20cheaper%20than%20%24l%24%2C%20and%20the%20National%20Spendings%20Regulatory%20Committee%20will%20not%20let%20you%20build%20a%20highway%20more%20expensive%20than%20%24h%24.%20To%20claim%20a%20%5Cu201ccountry-wide%5Cu201d%20network%2C%20you%20have%20to%20connect%20%28possibly%20indirectly%29%20as%20many%20pairs%20of%20cities%2C%20as%20it%20is%20possible%20within%20these%20two%20constraints.%20You%20have%20to%20find%20the%20cheapest%20way%20to%20do%20it%2C%20and%20you%20have%20to%20find%20it%20quickly%21%20Of%20all%20networks%20that%20meet%20the%20constraints%20and%20connect%20the%20most%20pairs%20of%20cities%2Ccompute%20the%20cost%20of%20the%20cheapest%20one.%5Cn%5CnTo%20make%20things%20worse%2C%20both%20committees%20are%20heavily%20influenced%20by%20your%20angry%20competitors%3Aeach%20time%20you%20publish%20your%20hard-prepared%20plan%2C%20they%20immediately%20change%20their%20rulings%20%24l%24%20and%20%24h%24%2Cand%20you%20are%20forced%20to%20start%20from%20scratch.%22%2C%22inputFormat%22%3A%22The%20first%20line%20of%20input%20contains%20the%20number%20of%20test%20cases%20%24T%24.%20The%20descriptions%20of%20the%20test%20cases%20follow%3A%5Cn%5CnThe%20first%20line%20of%20each%20test%20case%20contains%20integers%20%24n%24%20and%20%24m%281%20%5C%5Cle%20n%20%5C%5Cle%201000%2C%200%20%5C%5Cle%20m%20%5C%5Cle%20100%20000%29%24%20%5Cu2013%20the%20number%20of%20cities%20in%20the%20country%2C%20and%20of%20possible%20direct%20connections%2C%20respectively.%5Cn%5CnEach%20of%20the%20following%20%24m%24%20lines%20contains%20three%20integers%20%24x%2C%20y%2C%20w%20%281%20%5C%5Cle%20x%20%5Cu2260%20y%20%5C%5Cle%20n%2C%201%20%5C%5Cle%20w%20%5C%5Cle%201%20000%20000%29%24%2C%20denoting%20that%20the%20cities%20%24x%24%20and%20%24y%24%20can%20be%20connected%20by%20a%20bidirectional%20highway%20at%20cost%20%24w%24.%20There%20might%20be%20many%20ways%20to%20connect%20a%20single%20pair%20of%20cities.%5Cn%5CnThe%20following%20line%20contains%20an%20integer%20%24q%281%20%5C%5Cle%20q%20%5C%5Cle%201%20000%20000%29%24%20%5Cu2013%20the%20number%20of%20rulings%20of%20the%20committees.%20Each%20of%20the%20following%20%24q%24%20lines%20contains%20two%20integers.%20The%20first%20of%20the%20lines%20contains%20the%20initial%20rulings%20%24l_1%2C%20h_1%24%2C%20given%20directly.%20The%20rest%20of%20the%20rulings%20are%20encoded.%20The%20numbers%20in%20the%20%24j-th%24%20of%20the%20lines%20for%20%24j%20%3E%201%24%20are%20%24l_j%20%2B%20c_%7Bj%20-1%7D%24%20and%20%24h_j%20%2B%20c_%7Bj-1%7D%24%2C%20where%20%24l_j%24%20and%20%24h_j%24%20are%20the%20actual%20rulings%20and%20%24c_%7Bj-1%7D%24%20is%20the%20correct%20answer%20for%20the%20preceding%20rulings%20%24l_%7Bj-1%7D%24%20and%20%24h_%7Bj-1%7D%24.%5Cn%5CnAll%20rulings%20satisfy%20%241%20%5C%5Cle%20l_j%20%5C%5Cle%20h_j%20%5C%5Cle%201%20000%20000%24.%5Cn%22%2C%22outputFormat%22%3A%22For%20each%20test%20case%2C%20output%20%24q%24%20lines%2C%20one%20for%20each%20ruling.%20In%20the%20%24j-th%24%20of%20them%2Coutput%20the%20minimal%20cost%20%24c_j%24%20of%20building%20a%20highway%20network%20which%20adheres%20to%20the%20committees%5Cu2019%20constraints%2C%20and%20creates%20the%20maximum%20number%20of%20connected%20pairs%20of%20cities.%5Cn%22%2C%22samples%22%3A%5B%5B%221%5Cn5%207%5Cn1%202%202%5Cn2%203%204%5Cn3%204%203%5Cn4%205%201%5Cn5%201%203%5Cn2%205%204%5Cn1%204%205%5Cn5%5Cn1%202%5Cn4%207%5Cn11%2012%5Cn11%2013%5Cn18%2019%5Cn%22%2C%223%5Cn9%5Cn8%5Cn14%5Cn13%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A41051%2C%22name%22%3A%22%5Cu548c%5Cu6cc9%5Cu6b63%5Cu5b97%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3Anull%2C%22isAdmin%22%3Afalse%2C%22color%22%3A%22Blue%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B5000%2C5000%2C5000%2C5000%2C1000%5D%2C%22memory%22%3A%5B128000%2C128000%2C128000%2C128000%2C128000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22translation%22%3A%22n%5Cu4e2a%5Cu70b9m%5Cu6761%5Cu8fb9%5Cu6709%5Cu8fb9%5Cu6743%5Cu7684%5Cu65e0%5Cu5411%5Cu56fe%5Cuff0c%5Cu6709q%5Cu4e2a%5Cu8be2%5Cu95ee%5Cuff0c%5Cu6bcf%5Cu6b21%5Cu8be2%5Cu95ee%5Cu6743%5Cu503c%5Cu5728%5BL%5Cuff0cR%5D%5Cu5185%5Cu7684%5Cu8fb9%5Cu7ec4%5Cu6210%5Cu7684%5Cu6700%5Cu5c0f%5Cu751f%5Cu6210%5Cu6811%5Cu7684%5Cu6743%5Cu503c%5Cu548c%5Cuff0c%5Cu5f3a%5Cu5236%5Cu5728%5Cu7ebf%5Cu3002%5Cr%5Cnn%20%3C%3D%201000%2C%20m%20%3C%3D%20100000%2C%20q%20%3C%3D%20100000%22%2C%22tags%22%3A%5B31%2C108%2C319%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A46%2C%22totalAccepted%22%3A8%2C%22pid%22%3A%22P4764%22%2C%22title%22%3A%22%5BCERC2014%5DPork%20barrel%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22P%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A128249%2C%22title%22%3A%22%5Cu7ffb%5Cu8bd1%5Cu6c42%5Cu52a9%22%2C%22forum%22%3A%7B%22id%22%3A27306%2C%22name%22%3A%22P4764%20%5BCERC2014%5DPork%20barrel%22%2C%22slug%22%3A%22P4764%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P1527%22%2C%22title%22%3A%22%5B%5Cu56fd%5Cu5bb6%5Cu96c6%5Cu8bad%5Cu961f%5D%5Cu77e9%5Cu9635%5Cu4e58%5Cu6cd5%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P3377%22%2C%22title%22%3A%22%5Cu3010%5Cu6a21%5Cu677f%5Cu3011%5Cu5de6%5Cu504f%5Cu6811%5Cuff08%5Cu53ef%5Cu5e76%5Cu5806%5Cuff09%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P2848%22%2C%22title%22%3A%22%5BUSACO16DEC%5DCow%20Checklist%5Cu5976%5Cu725b%5Cu786e%5Cu8ba4%5Cu5355%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22CF633D%22%2C%22title%22%3A%22Fibonacci-ish%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22P4213%22%2C%22title%22%3A%22%5Cu3010%5Cu6a21%5Cu677f%5Cu3011%5Cu675c%5Cu6559%5Cu7b5b%5Cuff08Sum%5Cuff09%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22%5BCERC2014%5DPork%20barrel%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>[CERC2014]Pork barrel</h1>
<h2>题意翻译</h2>
<div>n个点m条边有边权的无向图，有q个询问，每次询问权值在[L，R]内的边组成的最小生成树的权值和，强制在线。
n <= 1000, m <= 100000, q <= 100000</div>
<h2>题目描述</h2>
<div>Winning the election was simpler than you expected: it was enough to promise to finally build a good quality, country-wide road infrastructure, of course without crippling the budget... Your happiness did not last long, however: it seems, that the citizens have found a way to actually hold you accountable for your promise!
There are $n$ major cities in your country. The Ministry of Transport has prepared a detailed map, outlining $m$ possible highway connections, together with their costs. The Quality Assurance Committee will not let you build a highway cheaper than $l$, and the National Spendings Regulatory Committee will not let you build a highway more expensive than $h$. To claim a “country-wide” network, you have to connect (possibly indirectly) as many pairs of cities, as it is possible within these two constraints. You have to find the cheapest way to do it, and you have to find it quickly! Of all networks that meet the constraints and connect the most pairs of cities,compute the cost of the cheapest one.
To make things worse, both committees are heavily influenced by your angry competitors:each time you publish your hard-prepared plan, they immediately change their rulings $l$ and $h$,and you are forced to start from scratch.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line of input contains the number of test cases $T$. The descriptions of the test cases follow:
The first line of each test case contains integers $n$ and $m(1 \le n \le 1000, 0 \le m \le 100 000)$ – the number of cities in the country, and of possible direct connections, respectively.
Each of the following $m$ lines contains three integers $x, y, w (1 \le x ≠ y \le n, 1 \le w \le 1 000 000)$, denoting that the cities $x$ and $y$ can be connected by a bidirectional highway at cost $w$. There might be many ways to connect a single pair of cities.
The following line contains an integer $q(1 \le q \le 1 000 000)$ – the number of rulings of the committees. Each of the following $q$ lines contains two integers. The first of the lines contains the initial rulings $l_1, h_1$, given directly. The rest of the rulings are encoded. The numbers in the $j-th$ of the lines for $j > 1$ are $l_j + c_{j -1}$ and $h_j + c_{j-1}$, where $l_j$ and $h_j$ are the actual rulings and $c_{j-1}$ is the correct answer for the preceding rulings $l_{j-1}$ and $h_{j-1}$.
All rulings satisfy $1 \le l_j \le h_j \le 1 000 000$.
</div>
<h3>输出格式</h3>
<br />
<div>For each test case, output $q$ lines, one for each ruling. In the $j-th$ of them,output the minimal cost $c_j$ of building a highway network which adheres to the committees’ constraints, and creates the maximum number of connected pairs of cities.
</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>1
5 7
1 2 2
2 3 4
3 4 3
4 5 1
5 1 3
2 5 4
1 4 5
5
1 2
4 7
11 12
11 13
18 19
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>3
9
8
14
13</code></pre>
</article>
</div>
</div>
</body>
</html>
