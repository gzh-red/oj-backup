<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>[POI2007]KOL-Railway - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573376921:33RXCUh3GD41/yhQVgdrmWAz/xCiT99xOl6JYtZ+VL0=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%5Cu5f81%5Cu6c42%5Cu7ffb%5Cu8bd1%5Cu3002%5Cu5982%5Cu679c%5Cu4f60%5Cu80fd%5Cu63d0%5Cu4f9b%5Cu7ffb%5Cu8bd1%5Cu6216%5Cu8005%5Cu9898%5Cu610f%5Cu7b80%5Cu8ff0%5Cuff0c%5Cu8bf7%5Cu76f4%5Cu63a5%5Cu53d1%5Cu8ba8%5Cu8bba%5Cuff0c%5Cu611f%5Cu8c22%5Cu4f60%5Cu7684%5Cu8d21%5Cu732e%5Cu3002%5Cn%22%2C%22description%22%3A%22Byteland%20Railways%20encountered%20a%20necessity%20of%20restructuring%20and%20%20%20%20reduction%20of%20the%20rail%20network.%5Cn%5CnAfter%20a%20deep%20analysis%20of%20of%20the%20rail%20network%20it%20has%20been%20decided%20%20%20%20which%20railway%20stations%20will%20be%20removed%20and%20which%20ones%20will%20stay.%5Cn%5CnIt%20has%20been%20also%20decided%20that%20the%20rail%20network%20should%20be%20reduced%20as%20far%20%20%20%20as%20possible.%5Cn%5CnIt%20remains%20to%20choose%20which%20railway%20lines%20should%20be%20removed%20and%20which%20%20%20%20ones%20should%20stay.%5Cn%5CnThe%20rail%20network%20is%20composed%20of%20rail%20segments%20connecting%20railway%20%20%20%20stations.%5Cn%5CnIt%20is%20known%20that%20from%20each%20station%20one%20can%20travel%20to%20every%20other%20%20%20%20station%20%28potentially%20visiting%20some%20intermediate%20stations%29.%5Cn%5CnRail%20segments%20are%20bidirectional.%5Cn%5CnThere%20can%20be%20at%20most%20one%20rail%20segment%20connecting%20each%20pair%20of%20stations.%5Cn%5CnEach%20segment%20can%20be%20assigned%20a%20cost%20of%20maintenance%2C%20which%20is%20%20%20%20a%20positive%20integer.%5Cn%5CnThe%20rail%20segments%20that%20will%20remain%20should%20be%20chosen%20in%20such%20%20%20%20way%20that%3A%5Cn%5Cnit%20is%20possible%20to%20travel%20between%20every%20pair%20of%20stations%20%20%20%20%20%20%20%20that%20are%20not%20going%20to%20be%20removed%2C%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20their%20total%20cost%20of%20maintenance%20is%20low%20%28it%20can%20be%20at%20most%20two%20times%20%20%20%20%20%20%20%20greater%20than%20the%20lowest%20cost%20that%20can%20be%20achieved%2C%20assuming%20that%20the%20%20%20%20%20%20%20%20previous%20condition%20is%20satisfied%29.%5Cn%5CnAll%20remaining%20rail%20segments%20will%20be%20removed.%5Cn%5CnRailway%20lines%20that%20will%20remain%20can%20run%20through%20stations%20that%20will%20be%20%20%20%20removed.%5Cn%5CnTaskWrite%20a%20programme%20which%3A%5Cn%5Cnreads%20a%20description%20of%20the%20rail%20network%20and%20the%20stations%20%20%20%20%20%20%20%20%20%20that%20will%20not%20be%20removed%20from%20the%20standard%20input%2C%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20determines%20which%20rail%20segments%20should%20remain%20and%20which%20should%20%20%20%20%20%20%20%20%20%20be%20removed%2C%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20writes%20out%20the%20rail%20segments%20that%20should%20remain%20together%20with%20the%20%20%20%20%20%20%20%20%20%20total%20cost%20of%20their%20maintenance%20to%20the%20standard%20output.%5Cn%22%2C%22inputFormat%22%3A%22The%20first%20line%20of%20input%20contains%20two%20positive%20integers%20%24n%24%20and%20%24m%24%2C%20%242%5C%5Cle%20n%5C%5Cle%205%5C%5C%20000%24%2C%20%241%5C%5Cle%20m%5C%5Cle%20500%5C%5C%20000%24%28%24m%5C%5Cle%20%5C%5Cfrac%7Bn%28n-1%29%7D%7B2%7D%24%29%2C%20%20%20%20%20%20separated%20by%20a%20single%20space.%5Cn%5Cn%24n%24%20denotes%20the%20number%20of%20railway%20stations%20and%20%24m%24%20is%20the%20number%20of%20rail%20segments.%5Cn%5CnRailway%20stations%20are%20numbered%20from%20%241%24%20to%20%24n%24.%5Cn%5CnThe%20following%20%24m%24%20lines%20contain%20descriptions%20of%20the%20rail%20%20%20%20%20%20segments%2C%20one%20per%20line.%5Cn%5CnEach%20of%20these%20lines%20contains%20three%20positive%20integers%20%24a%24%2C%24b%24%20and%20%24u%24%2C%241%5C%5Cle%20a%2Cb%5C%5Cle%20n%24%2C%24a%5C%5Cne%20b%24%2C%241%5C%5Cle%20u%5C%5Cle%20100%5C%5C%20000%24.%5Cn%5Cn%24a%24%20and%20%24b%24%20are%20the%20numbers%20of%20stations%20that%20are%20connected%20%20%20%20%20%20by%20the%20segment%20and%20%24u%24%20is%20its%20cost%20of%20maintenance.%5Cn%5CnThe%20%24%28m%2B2%29%24%27th%20line%20contains%20a%20sequence%20of%20integers%20separated%20by%20%20%20%20%20%20single%20spaces.%5Cn%5CnThe%20first%20one%20of%20them%20is%20%24p%24%20-%20the%20number%20of%20stations%20that%20should%20remain%20%20%20%20%20%20%28%241%5C%5Cle%20p%5C%5Cle%20n%24%2C%20%24p%5C%5Ccdot%20m%5C%5Cle%2015%5C%5C%20000%5C%5C%20000%24%29.%5Cn%5CnIt%20is%20followed%20by%20the%20numbers%20of%20these%20stations%20in%20increasing%20order.%5Cn%22%2C%22outputFormat%22%3A%22The%20first%20line%20of%20output%20should%20contain%20two%20integers%20%24c%24%20and%20%24k%24%20separated%20by%20a%20single%20space%2C%20where%20%24c%24%20is%20the%20total%20cost%20of%20maintenance%20of%20the%20segments%20that%20%20%20%20%20%20should%20remain%20and%20%24k%24%20is%20the%20number%20of%20these%20segments.%5Cn%5CnEach%20of%20the%20following%20%24k%24%20lines%20should%20contain%20two%20integers%20%24a_i%24%20and%20%24b_i%24%2C%20separated%20by%20a%20single%20space%20-%20%20%20%20%20%20the%20numbers%20of%20stations%20that%20are%20connected%20by%20the%20segment.%5Cn%5CnThe%20total%20cost%20of%20maintenance%20of%20the%20segments%20can%20be%20at%20most%20%20%20%20%20%20two%20times%20greater%20than%20the%20lowest%20achievable%20total%20cost.%5Cn%22%2C%22samples%22%3A%5B%5B%228%2011%5Cn1%202%206%5Cn3%201%205%5Cn2%203%208%5Cn3%204%209%5Cn3%205%2010%5Cn5%204%203%5Cn5%206%209%5Cn6%204%208%5Cn6%208%208%5Cn6%207%207%5Cn8%207%2010%5Cn4%202%205%207%208%22%2C%2242%205%5Cn2%203%5Cn3%205%5Cn5%206%5Cn6%207%5Cn6%208%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%5D%2C%22memory%22%3A%5B128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22tags%22%3A%5B24%2C57%2C319%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A8%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22P3461%22%2C%22title%22%3A%22%5BPOI2007%5DKOL-Railway%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22P%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A141015%2C%22title%22%3A%22%5Cu9898%5Cu76ee%5Cu7ffb%5Cu8bd1%22%2C%22forum%22%3A%7B%22id%22%3A2699%2C%22name%22%3A%22P3461%20%5BPOI2007%5DKOL-Railway%22%2C%22slug%22%3A%22P3461%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22%5BPOI2007%5DKOL-Railway%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>[POI2007]KOL-Railway</h1>
<h2>题目背景</h2>
<div>征求翻译。如果你能提供翻译或者题意简述，请直接发讨论，感谢你的贡献。
</div>
<h2>题目描述</h2>
<div>Byteland Railways encountered a necessity of restructuring and reduction of the rail network.
After a deep analysis of of the rail network it has been decided which railway stations will be removed and which ones will stay.
It has been also decided that the rail network should be reduced as far as possible.
It remains to choose which railway lines should be removed and which ones should stay.
The rail network is composed of rail segments connecting railway stations.
It is known that from each station one can travel to every other station (potentially visiting some intermediate stations).
Rail segments are bidirectional.
There can be at most one rail segment connecting each pair of stations.
Each segment can be assigned a cost of maintenance, which is a positive integer.
The rail segments that will remain should be chosen in such way that:
it is possible to travel between every pair of stations that are not going to be removed, their total cost of maintenance is low (it can be at most two times greater than the lowest cost that can be achieved, assuming that the previous condition is satisfied).
All remaining rail segments will be removed.
Railway lines that will remain can run through stations that will be removed.
TaskWrite a programme which:
reads a description of the rail network and the stations that will not be removed from the standard input, determines which rail segments should remain and which should be removed, writes out the rail segments that should remain together with the total cost of their maintenance to the standard output.
</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line of input contains two positive integers $n$ and $m$, $2\le n\le 5\ 000$, $1\le m\le 500\ 000$($m\le \frac{n(n-1)}{2}$), separated by a single space.
$n$ denotes the number of railway stations and $m$ is the number of rail segments.
Railway stations are numbered from $1$ to $n$.
The following $m$ lines contain descriptions of the rail segments, one per line.
Each of these lines contains three positive integers $a$,$b$ and $u$,$1\le a,b\le n$,$a\ne b$,$1\le u\le 100\ 000$.
$a$ and $b$ are the numbers of stations that are connected by the segment and $u$ is its cost of maintenance.
The $(m+2)$'th line contains a sequence of integers separated by single spaces.
The first one of them is $p$ - the number of stations that should remain ($1\le p\le n$, $p\cdot m\le 15\ 000\ 000$).
It is followed by the numbers of these stations in increasing order.
</div>
<h3>输出格式</h3>
<br />
<div>The first line of output should contain two integers $c$ and $k$ separated by a single space, where $c$ is the total cost of maintenance of the segments that should remain and $k$ is the number of these segments.
Each of the following $k$ lines should contain two integers $a_i$ and $b_i$, separated by a single space - the numbers of stations that are connected by the segment.
The total cost of maintenance of the segments can be at most two times greater than the lowest achievable total cost.
</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>8 11
1 2 6
3 1 5
2 3 8
3 4 9
3 5 10
5 4 3
5 6 9
6 4 8
6 8 8
6 7 7
8 7 10
4 2 5 7 8</code></pre>
<h3>输出样例 #1</h3>
<pre><code>42 5
2 3
3 5
5 6
6 7
6 8</code></pre>
</article>
</div>
</div>
</body>
</html>
