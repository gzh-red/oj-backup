<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>[POI2009]WYS-Isles in a Triangular Grid - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573376949:dvMUFodhFplRmil60TEQ3XjUOGTrvmQGdq0nUF8R0WA=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%5Cu5f81%5Cu6c42%5Cu7ffb%5Cu8bd1%5Cu3002%5Cu5982%5Cu679c%5Cu4f60%5Cu80fd%5Cu63d0%5Cu4f9b%5Cu7ffb%5Cu8bd1%5Cu6216%5Cu8005%5Cu9898%5Cu610f%5Cu7b80%5Cu8ff0%5Cuff0c%5Cu8bf7%5Cu76f4%5Cu63a5%5Cu53d1%5Cu8ba8%5Cu8bba%5Cuff0c%5Cu611f%5Cu8c22%5Cu4f60%5Cu7684%5Cu8d21%5Cu732e%5Cu3002%5Cn%22%2C%22description%22%3A%22A%20triangular%20grid%20consists%20in%20equilateral%20triangles%20with%20side%20length%201%20%20%28see%20p.%203%29.%20A%20path%20in%20the%20triangular%20grid%20is%20an%20arbitrary%20finite%20%20sequence%20of%20triangles%20%28with%20side%20length%201%29%20of%20the%20grid%20such%20that%20every%20two%20%20successive%20ones%20share%20a%20side.%5Cn%5CnA%20shape%20formed%20by%20the%20points%20of%20any%20finite%20number%20of%20triangles%20is%20called%20an%20%20isle%20if%20any%20two%20triangles%20of%20the%20grid%20contained%20in%20this%20shape%20are%20%20connected%20by%20some%20path%20formed%20by%20the%20triangles%20contained%20in%20the%20shape.%5Cn%5Cn%21%5B%5D%28https%3A%5C%2F%5C%2Fszkopul.edu.pl%5C%2Fproblemset%5C%2Fproblem%5C%2Fx71UmM6wnV9BdT-ld0uFb33p%5C%2Fsite%5C%2Fimages%5C%2FOI16%5C%2Fwyspy.gif%29%5Cn%5CnThe%20shapes%20in%20the%20figures%201.1%2C%201.2%20and%201.3%20are%20isles.%5Cn%5CnThe%20shape%20in%20the%20figure%201.4%20is%20not%20an%20isle.%5Cn%5CnThe%20shapes%20in%20the%20figures%202.2%2C%202.3%20and%202.5%20are%20congruent.%5Cn%5CnWe%20aim%20at%20obtaining%20a%20systematic%20description%2C%20for%20each%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI16%5C%2Fwys-en-tex.1.png%29%2C%20of%20all%20%20non-congruent%20isles%20that%20can%20be%20formed%20by%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI16%5C%2Fwys-en-tex.2.png%29%20triangles%20with%20side%20length%201%2C%20%20and%20calculating%20how%20many%20such%20isles%20there%20are.%5Cn%5CnThe%20boundary%20of%20every%20isle%20formed%20by%20at%20most%20ten%20triangles%20is%20a%20polygonal%20%20chain%20consisting%20of%20unitary%20segments%20of%20the%20grid.%20It%20can%20be%20revolved%20%20about%2C%20i.e.%5Cn%5Cnit%20can%20be%20contoured%20without%20detaching%20pencil%20from%20the%20sheet%2C%20in%20such%20a%20way%20%20that%20its%20every%20segment%20is%20followed%20once%2C%20and%20we%20come%20back%20to%20the%20initial%20%20point.%20It%20may%20happen%20though%20that%20some%20point%20has%20to%20be%20crossed%20more%20than%20%20once%20%28see%20Figure%202.4%29.%5Cn%5CnLuckily%2C%20in%20case%20of%20isles%20formed%20by%20at%20most%20ten%20triangles%20the%20shape%27s%20%20perimeter%20is%20connected%20%28and%20can%20be%20thus%20contoured%20without%20detaching%20pencil%20%20from%20the%20sheet%29%2C%20unlike%20the%20one%20in%20Figure%201.2.%5Cn%5CnWhile%20circling%20around%20the%20perimeter%2C%20after%20each%20unit%20segment%20we%20make%20a%20turn%20%20of%20either%20of%20the%20following%20types%3A%5Cn%5Cna%20-%20120%20degrees%20left%2C%20%20%20%20%20%20%20%20%20b%20-%2060%20degrees%20left%2C%20%20%20%20%20%20%20%20%20c%20-%200%20degrees%20%28i.e.%20no%20turn%2C%20actually%29%2C%20%20%20%20%20%20%20%20%20d%20-%2060%20degrees%20right%2C%20%20%20%20%20%20%20%20%20e%20-%20120%20degrees%20right.%5Cn%5CnEach%20cycle%20around%20the%20isle%20can%20be%20described%20by%20a%20word%20consisting%20of%20letters%20%20from%20the%20set%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI16%5C%2Fwys-en-tex.3.png%29%2C%20%20where%20each%20letter%20tells%20which%20turn%20should%20be%20made%20after%20each%20successive%20unit%20%20segment%20the%20perimeter%20consists%20of.%20The%20cycle%20description%20has%20as%20many%20letters%20%20as%20there%20are%20such%20unit%20segments.%20This%20means%20we%20also%20describe%20the%20turn%20after%20%20the%20last%20segment%20of%20the%20polygonal%20chain%2C%20even%20though%20it%20is%20not%20required%20to%20%20uniquely%20determine%20the%20shape.%20This%20redundant%20letter%20is%2C%20however%2C%20very%20helpful%20%20in%20transforming%20one%20description%20of%20a%20cycle%20around%20the%20shape%20to%20another%20one%20%20that%20differs%20only%20in%20the%20initial%20point.%5Cn%5CnThe%20words%20cdddcddd%2C%20dcdddcdd%2C%20cbbbcbbb%20describe%20%20different%20cycles%20around%20the%20shape%20of%20the%20Figure%202.1.%5Cn%5CnThe%20words%20cbeddcde%2C%20adcabcbb%2C%20abcbbadc%20describe%20%20different%20cycles%20around%20the%20shape%20of%20the%20Figure%202.2.%5Cn%5CnThe%20words%20acdabbcb%20i%20cddebced%20describe%20%20different%20cycles%20around%20the%20shape%20of%20the%20Figure%202.3.%5Cn%5CnIf%20the%20inside%20of%20the%20shape%20is%20constantly%20on%20right%20hand%20side%20during%20a%20cycle%20%20around%20some%20shape%2C%20we%20call%20such%20cycle%20a%20clockwise%20cycle.%5Cn%5CnOne%20can%20determine%2C%20for%20each%20isle%2C%20the%20set%20of%20all%20isles%20congruent%20with%20it%20and%20%20these%20isles%27%20clockwise%20cycles.%5Cn%5CnThe%20code%20of%20an%20isle%20is%20such%20a%20word%20that%3A%5Cn%5Cnit%20is%20a%20description%20of%20a%20clockwise%20cycle%20around%20the%20contour%20of%20some%20isle%20congruent%20with%20the%20latter%2C%20%20%20%20%20%20%20%20%20it%20is%20the%20lexicographically%20smallest%20of%20all%20words%20satisfying%20the%20previous%20condition.%5Cn%5CnFor%20the%20isle%20depicted%20in%20Figures%202.2%20and%202.3%2C%20which%20are%20congruent%2C%20we%20take%20%20into%20account%20all%20clockwise%20cycles%20around%20each%20of%20them%3A%5Cn%5Cnbeddcdec%2C%20eddcdecb%2C%20ddcdecbe%2C%20dcdecbed%2C%20cdecbedd%2C%20%20decbeddc%2C%20ecbeddcd%2C%20cbeddcde%20%20and%20%20bcedcdde%2C%20cedcddeb%2C%20edcddebc%2C%20dcddebce%2C%20cddebced%2C%20%20ddebcedc%2C%20debcedcd%2C%20ebcedcdd%20%20so%20their%20common%20code%20is%3A%20bcedcdde%2C%20the%20lexicographically%20smallest%20of%20%20all%20the%20words%20above.%5Cn%5CnThe%20code%20of%20the%20isle%20depicted%20in%20Figure%202.4%20is%3A%20aadecddcddde.%5Cn%5CnWrite%20a%20programme%20that%3A%5Cn%5Cnfor%20a%20given%20code%20of%20an%20isle%20of%20size%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI16%5C%2Fwys-en-tex.4.png%29%20generates%20the%20codes%20of%20all%20isles%20of%20size%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI16%5C%2Fwys-en-tex.5.png%29%20that%20can%20be%20obtained%20from%20the%20latter%20by%20adding%20one%20triangle%20to%20it%2C%20%20%20%20%20%20%20%20%20for%20a%20given%20integer%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI16%5C%2Fwys-en-tex.6.png%29%20generates%20the%20codes%20of%20all%20isles%20of%20size%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI16%5C%2Fwys-en-tex.7.png%29.%5Cn%22%2C%22inputFormat%22%3A%22In%20the%20first%20line%20of%20the%20standard%20input%20an%20integer%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI16%5C%2Fwys-en-tex.8.png%29%20%28%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI16%5C%2Fwys-en-tex.9.png%29%29%2C%20%20denoting%20the%20number%20of%20queries%2C%20is%20given.%5Cn%5CnEach%20of%20the%20following%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI16%5C%2Fwys-en-tex.10.png%29%20lines%20contains%20a%20query%20of%20some%20type.%5Cn%5CnThe%20query%20of%20type%201%20consists%20of%20the%20letter%20K%20and%20a%20code%20of%20an%20isle%20%20formed%20by%20at%20most%20ten%20triangles%2C%20separated%20by%20a%20single%20space.%5Cn%5CnThe%20query%20of%20type%202%20consists%20of%20the%20letter%20N%20and%20an%20integer%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI16%5C%2Fwys-en-tex.11.png%29%20%20%28%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI16%5C%2Fwys-en-tex.12.png%29%29%2C%20separated%20by%20a%20single%20space.%5Cn%22%2C%22outputFormat%22%3A%22The%20answers%20to%20the%20queries%20should%20be%20printed%20out%20to%20the%20standard%20output.%5Cn%5CnFor%20queries%20of%20type%201%20the%20number%20of%20distinct%20codes%20of%20isles%20that%20can%20be%20%20obtained%20by%20adding%20one%20triangle%20from%20isles%20congruent%20to%20the%20one%20described%20%20by%20the%20given%20code.%5Cn%5CnIn%20the%20following%20line%20all%20these%20codes%2C%20separated%20by%20single%20spaces%2C%20should%20be%20%20printed%20in%20lexicographic%20order.%5Cn%5CnFor%20queries%20of%20type%202%20the%20number%20of%20distinct%20codes%20of%20isles%20formed%20by%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI16%5C%2Fwys-en-tex.13.png%29%20%20triangles%20should%20be%20printed.%5Cn%5CnIn%20the%20following%20line%20all%20these%20codes%20should%20be%20printed%20in%20lexicographic%20%20order.%5Cn%22%2C%22samples%22%3A%5B%5B%222%5CnK%20adeccecced%5CnN%205%5Cn%22%2C%225%5Cnacedccecced%20addebcecced%20adebebecced%20adecbedcced%20cceccecce%5Cn4%5Cnaedddde%20bdecdde%20bececde%20ccedcde%5Cn%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%5D%2C%22memory%22%3A%5B128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22tags%22%3A%5B26%2C57%2C319%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A2%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22P3484%22%2C%22title%22%3A%22%5BPOI2009%5DWYS-Isles%20in%20a%20Triangular%20Grid%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22P%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A147828%2C%22title%22%3A%22%5Cu8865%5Cu56fe%22%2C%22forum%22%3A%7B%22id%22%3A2707%2C%22name%22%3A%22P3484%20%5BPOI2009%5DWYS-Isles%20in%20a%20Triangular%20Grid%22%2C%22slug%22%3A%22P3484%22%7D%7D%2C%7B%22id%22%3A130921%2C%22title%22%3A%22%5Cu9898%5Cu76ee%5Cu7ffb%5Cu8bd1%22%2C%22forum%22%3A%7B%22id%22%3A2707%2C%22name%22%3A%22P3484%20%5BPOI2009%5DWYS-Isles%20in%20a%20Triangular%20Grid%22%2C%22slug%22%3A%22P3484%22%7D%7D%2C%7B%22id%22%3A130908%2C%22title%22%3A%22%5Cu89e3%5Cu7b54%5Cu6211%5Cu8fd9%5Cu4e2a%5Cu95ee%5Cu9898%5Cu5c31%5Cu53ef%5Cu4ee5%5Cu7ffb%5Cu8bd1%5Cu4e86%22%2C%22forum%22%3A%7B%22id%22%3A2707%2C%22name%22%3A%22P3484%20%5BPOI2009%5DWYS-Isles%20in%20a%20Triangular%20Grid%22%2C%22slug%22%3A%22P3484%22%7D%7D%2C%7B%22id%22%3A51650%2C%22title%22%3A%22%5Cu7ffb%5Cu8bd1%22%2C%22forum%22%3A%7B%22id%22%3A2707%2C%22name%22%3A%22P3484%20%5BPOI2009%5DWYS-Isles%20in%20a%20Triangular%20Grid%22%2C%22slug%22%3A%22P3484%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22%5BPOI2009%5DWYS-Isles%20in%20a%20Triangular%20Grid%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573286098;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>[POI2009]WYS-Isles in a Triangular Grid</h1>
<h2>题目背景</h2>
<div>征求翻译。如果你能提供翻译或者题意简述，请直接发讨论，感谢你的贡献。
</div>
<h2>题目描述</h2>
<div>A triangular grid consists in equilateral triangles with side length 1 (see p. 3). A path in the triangular grid is an arbitrary finite sequence of triangles (with side length 1) of the grid such that every two successive ones share a side.
A shape formed by the points of any finite number of triangles is called an isle if any two triangles of the grid contained in this shape are connected by some path formed by the triangles contained in the shape.
![](https://szkopul.edu.pl/problemset/problem/x71UmM6wnV9BdT-ld0uFb33p/site/images/OI16/wyspy.gif)
The shapes in the figures 1.1, 1.2 and 1.3 are isles.
The shape in the figure 1.4 is not an isle.
The shapes in the figures 2.2, 2.3 and 2.5 are congruent.
We aim at obtaining a systematic description, for each ![](http://main.edu.pl/images/OI16/wys-en-tex.1.png), of all non-congruent isles that can be formed by ![](http://main.edu.pl/images/OI16/wys-en-tex.2.png) triangles with side length 1, and calculating how many such isles there are.
The boundary of every isle formed by at most ten triangles is a polygonal chain consisting of unitary segments of the grid. It can be revolved about, i.e.
it can be contoured without detaching pencil from the sheet, in such a way that its every segment is followed once, and we come back to the initial point. It may happen though that some point has to be crossed more than once (see Figure 2.4).
Luckily, in case of isles formed by at most ten triangles the shape's perimeter is connected (and can be thus contoured without detaching pencil from the sheet), unlike the one in Figure 1.2.
While circling around the perimeter, after each unit segment we make a turn of either of the following types:
a - 120 degrees left, b - 60 degrees left, c - 0 degrees (i.e. no turn, actually), d - 60 degrees right, e - 120 degrees right.
Each cycle around the isle can be described by a word consisting of letters from the set ![](http://main.edu.pl/images/OI16/wys-en-tex.3.png), where each letter tells which turn should be made after each successive unit segment the perimeter consists of. The cycle description has as many letters as there are such unit segments. This means we also describe the turn after the last segment of the polygonal chain, even though it is not required to uniquely determine the shape. This redundant letter is, however, very helpful in transforming one description of a cycle around the shape to another one that differs only in the initial point.
The words cdddcddd, dcdddcdd, cbbbcbbb describe different cycles around the shape of the Figure 2.1.
The words cbeddcde, adcabcbb, abcbbadc describe different cycles around the shape of the Figure 2.2.
The words acdabbcb i cddebced describe different cycles around the shape of the Figure 2.3.
If the inside of the shape is constantly on right hand side during a cycle around some shape, we call such cycle a clockwise cycle.
One can determine, for each isle, the set of all isles congruent with it and these isles' clockwise cycles.
The code of an isle is such a word that:
it is a description of a clockwise cycle around the contour of some isle congruent with the latter, it is the lexicographically smallest of all words satisfying the previous condition.
For the isle depicted in Figures 2.2 and 2.3, which are congruent, we take into account all clockwise cycles around each of them:
beddcdec, eddcdecb, ddcdecbe, dcdecbed, cdecbedd, decbeddc, ecbeddcd, cbeddcde and bcedcdde, cedcddeb, edcddebc, dcddebce, cddebced, ddebcedc, debcedcd, ebcedcdd so their common code is: bcedcdde, the lexicographically smallest of all the words above.
The code of the isle depicted in Figure 2.4 is: aadecddcddde.
Write a programme that:
for a given code of an isle of size ![](http://main.edu.pl/images/OI16/wys-en-tex.4.png) generates the codes of all isles of size ![](http://main.edu.pl/images/OI16/wys-en-tex.5.png) that can be obtained from the latter by adding one triangle to it, for a given integer ![](http://main.edu.pl/images/OI16/wys-en-tex.6.png) generates the codes of all isles of size ![](http://main.edu.pl/images/OI16/wys-en-tex.7.png).
</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>In the first line of the standard input an integer ![](http://main.edu.pl/images/OI16/wys-en-tex.8.png) (![](http://main.edu.pl/images/OI16/wys-en-tex.9.png)), denoting the number of queries, is given.
Each of the following ![](http://main.edu.pl/images/OI16/wys-en-tex.10.png) lines contains a query of some type.
The query of type 1 consists of the letter K and a code of an isle formed by at most ten triangles, separated by a single space.
The query of type 2 consists of the letter N and an integer ![](http://main.edu.pl/images/OI16/wys-en-tex.11.png) (![](http://main.edu.pl/images/OI16/wys-en-tex.12.png)), separated by a single space.
</div>
<h3>输出格式</h3>
<br />
<div>The answers to the queries should be printed out to the standard output.
For queries of type 1 the number of distinct codes of isles that can be obtained by adding one triangle from isles congruent to the one described by the given code.
In the following line all these codes, separated by single spaces, should be printed in lexicographic order.
For queries of type 2 the number of distinct codes of isles formed by ![](http://main.edu.pl/images/OI16/wys-en-tex.13.png) triangles should be printed.
In the following line all these codes should be printed in lexicographic order.
</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>2
K adeccecced
N 5
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>5
acedccecced addebcecced adebebecced adecbedcced cceccecce
4
aedddde bdecdde bececde ccedcde
</code></pre>
</article>
</div>
</div>
</body>
</html>
