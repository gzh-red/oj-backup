<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>[CERC2014]Vocabulary - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573381773:fLYw6ah2n/WRe6EMoslM642tvTMjyf+m40IN5N2rlrs=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%22%2C%22description%22%3A%22According%20to%20a%20popular%20belief%2C%20computer%20programmers%20drink%20a%20lot%20of%20coffee%20and%20know%20only%20a%20few%20words.%20The%20vocabulary%20of%20a%20typical%20programmer%20consists%20of%20just%20three%20words.%20Besides%2C%20he%20rarely%20knows%20how%20to%20spell%20them.%20To%20help%20programmers%20with%20their%20spelling%20mistakes%2C%20we%20published%20a%20book%20titled%20%24The%20%5C%5C%20Dictionary%20%5C%5C%20of%20%5C%5C%20the%20%5C%5C%20Three%20%5C%5C%20Words%20%5C%5C%20Every%20%5C%5C%20Typical%20%5C%5C%20Programmer%20%5C%5C%20Should%20%5C%5C%20Know%24.%5Cn%5CnYou%20got%20a%20copy%20of%20the%20book%20but%2C%20soon%20after%20that%2C%20you%20spilled%20your%20coffee%20over%20it.%5Cn%5CnNow%2C%20youcannot%20read%20some%20of%20the%20characters.%20Fortunately%2C%20the%20three%20words%20were%2C%20as%20usually%20in%20dictionaries%2Cdistinct%20and%20printed%20in%20lexicographical%20order.%5CnBefore%20you%20attempt%20to%20use%20that%20fact%20to%20recover%20the%20missing%20characters%2C%20you%20want%20to%20know%20in%20how%20many%20different%20ways%20you%20can%20do%20it.%20Since%20you%20expect%20this%20number%20might%20be%20large%2C%20you%20want%20to%20know%20it%20modulo%20%2410%5E9%20%2B%209%24.%22%2C%22inputFormat%22%3A%22The%20first%20line%20of%20input%20contains%20the%20number%20of%20test%20cases%20%24T%24.%20The%20descriptions%20of%20the%20test%20cases%20follow%3A%5Cn%5CnEach%20test%20case%20consists%20of%20three%20lines%2C%20each%20containing%20a%20single%20nonempty%20word%20%5Cu2013%20in%20the%20order%20they%20appear%20in%20the%20dictionary.%20Words%20consist%20of%20small%20letters%20of%20the%20English%20alphabet%20and%20question%20marks%2C%20the%20latter%20denoting%20missing%20characters.%20Each%20word%20is%20at%20most%20%241%20000%20000%24%20characters%20long.%5Cn%22%2C%22outputFormat%22%3A%22For%20each%20test%20case%2C%20output%20one%20line%20containing%20the%20number%20of%20different%20ways%20you%20can%20substitute%20each%20question%20mark%20with%20one%20of%20the%20%2426%24%20letters%20from%20%60%60a%60%60%20to%20%60%60z%60%60%20in%20such%20a%20way%20that%20the%20three%20words%20are%20distinct%20and%20in%20lexicographical%20order.%20The%20number%20should%20be%20printed%20modulo%20%2410%5E9%20%2B%209%24.%22%2C%22samples%22%3A%5B%5B%223%5Cn%3Fheoret%3Fcal%5Cnc%3Fmputer%5Cn%3Fcience%5Cnjagiellonian%5Cn%3Fniversity%5Cnkra%3Fow%5Cn%3F%5Cnb%5Cnc%22%2C%2242562%5Cn52%5Cn1%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A41051%2C%22name%22%3A%22%5Cu548c%5Cu6cc9%5Cu6b63%5Cu5b97%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3Anull%2C%22isAdmin%22%3Afalse%2C%22color%22%3A%22Blue%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%2C1000%2C1000%5D%2C%22memory%22%3A%5B128000%2C128000%2C128000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22translation%22%3A%22%5Cu7ed9%5Cu4f60%5Cu4e09%5Cu4e2a%5Cu5b57%5Cu7b26%5Cu4e32%5Cuff0c%5Cu8fd9%5Cu4e9b%5Cu5b57%5Cu7b26%5Cu4e32%5Cu6709%5Cu4e9b%5Cu5355%5Cu8bcd%5Cu6a21%5Cu7cca%5Cu4e0d%5Cu53ef%5Cu8ba4%5Cu4e86%5Cuff0c%5Cu7528%5C%22%3F%5C%22%5Cu6765%5Cu4ee3%5Cu8868%5Cu3002%5Cn%5Cu73b0%5Cu5728%5Cu4f60%5Cu53ef%5Cu4ee5%5Cu7528%5Cu4efb%5Cu610f%5Cu82f1%5Cu6587%5Cu5c0f%5Cu5199%5Cu5b57%5Cu6bcd%5Cu6765%5Cu4ee3%5Cu8868%5Cu5b83%5Cu4eec%5Cu3002%5Cu8981%5Cu6c42%5Cu662f%5Cu4f7f%5Cu5f97%5Cu7ed9%5Cu5b9a%5Cu7684%5Cu4e09%5Cu4e2a%5Cu5b57%5Cu7b26%5Cu4e32%5Cu4e2d%5Cn%5Cu6240%5Cu6709%5Cu7684%5C%22%3F%5C%22%5Cu88ab%5Cu4f60%5Cu8ba4%5Cu5b9a%5Cu7684%5Cu5b57%5Cu6bcd%5Cu4ee3%5Cu66ff%5Cu540e%5Cuff0c%5Cu5404%5Cu4e0d%5Cu76f8%5Cu540c%5Cu4e14%5Cu6309%5Cu5b57%5Cu5178%5Cu5e8f%5Cu51fa%5Cu73b0%5Cu3002%5Cu95ee%5Cu6709%5Cu591a%5Cu5c11%5Cu79cd%5Cu65b9%5Cu5f0f%5Cu3002%5Cn%5Cn%5Cu8f93%5Cu5165%5Cuff1a%5Cu5148%5Cu7ed9%5Cu51fa%5Cu4e00%5Cu4e2a%5Cu6570%5Cu5b57N%5Cuff0c%5Cu4ee3%5Cu8868%5Cu6570%5Cu636e%5Cu7ec4%5Cu6570%5Cu3002%5Cn%5Cu63a5%5Cu4e0b%5Cu67653%2AN%5Cu884c%5Cuff0c%5Cu6bcf%5Cu884c%5Cu7ed9%5Cu51fa%5Cu4e00%5Cu4e2a%5Cu5b57%5Cu7b26%5Cu4e32%5Cu3002%5Cu957f%5Cu5ea6%3C%3D1000%20000%5Cn%5Cn%5Cu8f93%5Cu51fa%5Cuff1a%5Cu8f93%5Cu51fa%5Cu7ed3%5Cu679c%20Mod%2010%5E9%2B9%22%2C%22tags%22%3A%5B31%2C319%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A36%2C%22totalAccepted%22%3A19%2C%22pid%22%3A%22P4761%22%2C%22title%22%3A%22%5BCERC2014%5DVocabulary%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A50809%2C%22title%22%3A%22%5Cu6d1b%5Cu8c37P4761%5Cu7ffb%5Cu8bd1%22%2C%22forum%22%3A%7B%22id%22%3A27303%2C%22name%22%3A%22P4761%20%5BCERC2014%5DVocabulary%22%2C%22slug%22%3A%22P4761%22%7D%7D%2C%7B%22id%22%3A49677%2C%22title%22%3A%22%5Cu7ffb%5Cu8bd1%22%2C%22forum%22%3A%7B%22id%22%3A27303%2C%22name%22%3A%22P4761%20%5BCERC2014%5DVocabulary%22%2C%22slug%22%3A%22P4761%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22%5BCERC2014%5DVocabulary%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573295103;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>[CERC2014]Vocabulary</h1>
<h2>题意翻译</h2>
<div>给你三个字符串，这些字符串有些单词模糊不可认了，用"?"来代表。
现在你可以用任意英文小写字母来代表它们。要求是使得给定的三个字符串中
所有的"?"被你认定的字母代替后，各不相同且按字典序出现。问有多少种方式。
输入：先给出一个数字N，代表数据组数。
接下来3*N行，每行给出一个字符串。长度<=1000 000
输出：输出结果 Mod 10^9+9</div>
<h2>题目描述</h2>
<div>According to a popular belief, computer programmers drink a lot of coffee and know only a few words. The vocabulary of a typical programmer consists of just three words. Besides, he rarely knows how to spell them. To help programmers with their spelling mistakes, we published a book titled $The \ Dictionary \ of \ the \ Three \ Words \ Every \ Typical \ Programmer \ Should \ Know$.
You got a copy of the book but, soon after that, you spilled your coffee over it.
Now, youcannot read some of the characters. Fortunately, the three words were, as usually in dictionaries,distinct and printed in lexicographical order.
Before you attempt to use that fact to recover the missing characters, you want to know in how many different ways you can do it. Since you expect this number might be large, you want to know it modulo $10^9 + 9$.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line of input contains the number of test cases $T$. The descriptions of the test cases follow:
Each test case consists of three lines, each containing a single nonempty word – in the order they appear in the dictionary. Words consist of small letters of the English alphabet and question marks, the latter denoting missing characters. Each word is at most $1 000 000$ characters long.
</div>
<h3>输出格式</h3>
<br />
<div>For each test case, output one line containing the number of different ways you can substitute each question mark with one of the $26$ letters from ``a`` to ``z`` in such a way that the three words are distinct and in lexicographical order. The number should be printed modulo $10^9 + 9$.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>3
?heoret?cal
c?mputer
?cience
jagiellonian
?niversity
kra?ow
?
b
c</code></pre>
<h3>输出样例 #1</h3>
<pre><code>42562
52
1</code></pre>
</article>
</div>
</div>
</body>
</html>
