<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Nephren Ruq Insania - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573380852:ZLresGx6X1IGbSfh2XIva5/x7vjDYXgc+JPnklEoW+k=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%5BYnoi2016%5D%5Cu70b8%5Cu8116%5Cu9f99I%20%5Cu9898%5Cu9762%5Cu5907%5Cu4efd%20https%3A%5C%2F%5C%2Fwww.luogu.org%5C%2Fdiscuss%5C%2Fshow%5C%2F45962%5Cn%5Cn%5Cu5927%5Cu6837%5Cu4f8b%5Cu4e0b%5Cu53d1%5Cu94fe%5Cu63a5%3A%20https%3A%5C%2F%5C%2Fpan.baidu.com%5C%2Fs%5C%2F1nuVpRS1%20%5Cu5bc6%5Cu7801%3A%20sfxg%5Cn%5Cn%2A%2A%5Cu6ce8%5Cu610f%5Cuff1a%5Cu672c%5Cu9898%5Cu5927%5Cu6837%5Cu4f8b4%5Cu7684%5Cu8f93%5Cu51fa%5Cu6587%5Cu4ef6%5Cu4fee%5Cu6539%5Cu4e3a%20https%3A%5C%2F%5C%2Fpan.baidu.com%5C%2Fs%5C%2F1bUWuZW%2A%2A%5Cn%5Cn%5Cu5948%5Cu8299%5Cu83b2%5Cu00b7%5Cu5362%5Cu53ef%5Cu00b7%5Cu5370%5Cu8428%5Cu5c3c%5Cu4e9a%28Nephren-Ruq-Insania%29%5Cn%5Cn%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fpic%5C%2F9256.png%29%20%5Cn%5Cn%5Cu540c%5Cu4e3a%5Cu5996%5Cu7cbe%5Cu4ed3%5Cu5e93%5Cu7684%5Cu6210%5Cu4f53%5Cu5996%5Cu7cbe%5Cu5175%5Cuff0c%5Cu5929%5Cu8d4b%5Cu4e0d%5Cu5982%5Cu73c2%5Cu6735%5Cu8389%5Cu4e00%5Cu822c%5Cuff0c%5Cu53ea%5Cu662f%5Cu4e00%5Cu4e2a%5Cu5e73%5Cu51e1%5Cu7684%5Cu5996%5Cu7cbe.%5Cn%5Cn%5Cu7761%5Cu89c9%5Cu65f6%5Cu5982%5Cu540c%5Cu6bef%5Cu5b50%5Cu4e00%5Cu822c%5Cu5728%5Cu5a01%5Cu5ec9%5Cu8eab%5Cu4e0a%5Cu4e3a%5Cu5176%5Cu4fdd%5Cu6696%5Cu3002%5Cu4e60%5Cu60ef%5Cu4e8e%5Cu7c98%5Cu7740%5Cu5a01%5Cu5ec9%5Cuff0c%5Cu5728%5Cu68a6%5Cu5883%5Cu4e2d%5Cu4e0e%5Cu827e%5Cu5c14%5Cu6885%5Cu8389%5Cu4e9a%5Cu4ea4%5Cu8c08%5Cu65f6%5Cuff0c%5Cu81ea%5Cu79f0%5Cu5c31%5Cu50cf%5Cu662f%5Cu5a01%5Cu5ec9%5Cu7684%5Cu5ba0%5Cu7269%5Cu4e00%5Cu6837%5Cu3002%5Cn%5Cn%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fpic%5C%2F9257.png%29%20%5Cn%5Cn%5Cu672c%5Cu9898%5Cu9898%5Cu9762%5Cu4e2d%5Cu542b%5Cu6709%5Cu5927%5Cu91cf%5Cu7684%5Cu5267%5Cu900f%5Cuff0c%5Cu5efa%5Cu8bae%5Cu505a%5Cu9898%5Cu4e4b%5Cu524d%5Cu5c06%5Cu8fd9%5Cu90e8%5Cu756a%5Cu5267%5Cu770b%5Cu5b8c%5Cuff08%5Cn%22%2C%22description%22%3A%22%5Cu5979%5Cu53ea%5Cu662f%5Cu4e00%5Cu4e2a%5Cu975e%5Cu5e38%5Cu666e%5Cu901a%5Cu7684%5Cu9ec4%5Cu91d1%5Cu5996%5Cu7cbe%5Cu3002%5Cn%5Cn%5Cu5728%5Cu63f4%5Cu6551%5Cu6253%5Cu635e%5Cu961f%5Cu7684%5Cu4f5c%5Cu6218%5Cu4e2d%5Cuff0c%5Cu4ed6%5Cu4eec%5Cu4e0d%5Cu5e78%5Cu4e0e%5Cuff08%5Cu51e0%5Cu4e4e%5Cu662f%5Cu6240%5Cu6709%5Cu7684%5Cuff09%5Cu7b2c%5Cu516d%5Cu517d%5Cu76f8%5Cu9047%5Cu4e86%5Cu3002%5Cn%5Cn%5Cu6b64%5Cu65f6%5Cu7684%5Cu73c2%5Cu6735%5Cu8389%5Cu56e0%5Cu4e3a%5Cu63a5%5Cu89e6%5Cu5230%5Cu661f%5Cu795e%5Cu827e%5Cu9732%5Cu53ef%5Cu672c%5Cu4f53%5Cuff0c%5Cu6b63%5Cu5904%5Cu4e8e%5Cu660f%5Cu8ff7%5Cu4e4b%5Cu4e2d%5Cu3002%5Cu800c%5Cu5a01%5Cu5ec9%5Cu4e5f%5Cu65e0%5Cu6cd5%5Cu79bb%5Cu5f00%5Cu73c2%5Cu6735%5Cu8389%5Cu3002%5Cn%5Cn%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fpic%5C%2F9258.png%29%20%5Cn%5Cn%5Cu9ed8%5Cu9ed8%5Cu5b88%5Cu62a4%5Cu5728%5Cu623f%5Cu95f4%5Cu5916%5Cu7684%5Cu5979%5Cuff0c%5Cu63d0%5Cu8d77%5Cu5723%5Cu5251%5Cuff0c%5Cu8d70%5Cu5411%5Cu4e86%5Cu6218%5Cu573a%5Cu3002%5Cn%5Cn%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fpic%5C%2F9259.png%29%20%5Cn%5Cn%5Cu4f5c%5Cu4e3a%5Cu672c%5Cu8eab%5Cu5929%5Cu8d4b%5Cu53ea%5Cu662f%5Cu4e00%5Cu822c%5Cu7684%5Cu5996%5Cu7cbe%5Cu5c11%5Cu5973%5Cuff0c%5Cu5979%5Cu96be%5Cu4ee5%5Cu5bf9%5Cu6297%5Cu65e0%5Cu6570%5Cu500d%5Cu4e8e%5Cu81ea%5Cu5df1%5Cu7684%5Cu516d%5Cu53f7%5Cu517d%5Cu3002%5Cn%5Cn%5Cu6ca1%5Cu6709%5Cu591a%5Cu4e45%5Cuff0c%5Cu5979%5Cu5f00%5Cu59cb%5Cu4f53%5Cu529b%5Cu4e0d%5Cu652f%5Cu3002%5Cn%5Cn%5Cu7ec8%5Cu4e8e%5Cuff0c%5Cu5728%5Cu6e90%5Cu6e90%5Cu4e0d%5Cu65ad%5Cu7684%5Cu516d%5Cu53f7%5Cu517d%5Cu9762%5Cu524d%5Cuff0c%5Cu5979%5Cu96be%5Cu4ee5%5Cu62b5%5Cu6321%5Cu4e86%5Cu2026%5Cu2026%5Cn%5Cn%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fpic%5C%2F9261.png%29%20%5Cn%5Cn%5Cu7ec8%5Cu4e8e%5Cuff0c%5Cu7531%5Cu4e8e%5Cu9b54%5Cu529b%5Cu8fc7%5Cu5ea6%5Cu6fc0%5Cu53d1%5Cuff0c%5Cu5979%5Cu5df2%5Cu7ecf%5Cu5904%5Cu5728%5Cu4e86%5Cu9b54%5Cu529b%5Cu5931%5Cu63a7%5Cu7684%5Cu8fb9%5Cu7f18%5Cu2026%5Cu2026%5Cn%5Cn%5Cu201d%5Cu5a01%5Cu5ec9%5Cuff0c%5Cu62ef%5Cu6551%5Cuff0c%5Cu662f%5Cu6211%5Cu4eec%5Cu9ec4%5Cu91d1%5Cu5996%5Cu7cbe%5Cu7684%5Cu4f7f%5Cu547d%5Cu3002%5Cu201c%5Cn%5Cn%5Cu201d%5Cu51b5%5Cu4e14%5Cuff0c%5Cu5a01%5Cu5ec9%5Cu4e4b%5Cu524d%5Cu5df2%5Cu7ecf%5Cu6551%5Cu8fc7%5Cu6211%5Cu4eec%5Cu4e86%5Cu3002%5Cu201c%5Cn%5Cn%5Cu201d%5Cu6240%5Cu4ee5%5Cuff0c%5Cu5df2%5Cu7ecf%5Cu6ca1%5Cu6709%5Cu95ee%5Cu9898%5Cu4e86%5Cu3002%5Cu201c%5Cn%5Cn%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fpic%5C%2F9262.png%29%20%5Cn%5Cn%5Cu5a01%5Cu5ec9%5Cu60f3%5Cu8981%5Cu6551%5Cu4e0b%5Cu5948%5Cu8299%5Cu83b2%5Cuff0c%5Cu4f46%5Cu662f%5Cu4ed6%5Cu81ea%5Cu5df1%5Cu4e5f%5Cu5df2%5Cu7ecf%5Cu5904%5Cu4e8e%5Cu5d29%5Cu6e83%5Cu7684%5Cu8fb9%5Cu7f18%5Cu3002%5Cn%5Cn%5Cu51a5%5Cu51a5%5Cu4e4b%5Cu4e2d%5Cu4ed6%5Cu60f3%5Cu8d77%5Cu4e86%5Cu66fe%5Cu7ecf%5Cu5b66%5Cu4e60%5Cu8fc7%5Cu7684%5Cu4e00%5Cu79cd%5Cu9b54%5Cu6cd5%5Cu3002%5Cu5728%5Cu8fd9%5Cu6700%5Cu540e%5Cu4e00%5Cu523b%5Cuff0c%5Cu6216%5Cu8bb8%5Cu5df2%5Cu7ecf%5Cu662f%5Cu552f%5Cu4e00%5Cu7684%5Cu529e%5Cu6cd5%5Cu4e86%5Cu3002%5Cn%5Cn%5Cu8fd9%5Cu79cd%5Cu9b54%5Cu6cd5%5Cu64cd%5Cu4f5c%5Cu7684%5Cu5bf9%5Cu8c61%5Cu662f%5Cu4e00%5Cu4e2a%5Cu5492%5Cu8bed%5Cu7ec4%5Cu6210%5Cu7684%5Cu5e8f%5Cu5217%5Cuff0c%5Cu6bcf%5Cu4e00%5Cu4e2a%5Cu5355%5Cu72ec%5Cu7684%5Cu5492%5Cu8bed%5Cu62e5%5Cu6709%5Cu81ea%5Cu5df1%5Cu7684%5Cu6cd5%5Cu529b%5Cu503c%5Cu3002%5Cn%5Cn%5Cu5a01%5Cu5ec9%5Cu9700%5Cu8981%5Cu4e0d%5Cu65ad%5Cu5730%5Cu6309%5Cu7167%5Cu4e4b%5Cu524d%5Cu7684%5Cu8bb0%5Cu5fc6%5Cuff0c%5Cu5bf9%5Cu67d0%5Cu4e00%5Cu6bb5%5Cu533a%5Cu95f4%5Cu7684%5Cu6cd5%5Cu529b%5Cu503c%5Cu52a0%5Cu4e0a%5Cu4e00%5Cu4e2a%5Cu6570%5Cuff0c%5Cu6216%5Cu8005%5Cu6c42%5Cu51fa%5Cu67d0%5Cu4e00%5Cu6bb5%5Cu533a%5Cu95f4%5Cu7684%5Cu6cd5%5Cu5492%5Cu5171%5Cu9e23%5Cu3002%5Cn%5Cn%5Cu6cd5%5Cu5492%5Cu5171%5Cu9e23%5Cu5177%5Cu4f53%5Cu800c%5Cu8a00%5Cu662f%5Cu8fd9%5Cu4e48%5Cu8ba1%5Cu7b97%5Cu7684%5Cuff1a%5Cn%5Cn%5Cu5bf9%5Cu4e8e%5Cu533a%5Cu95f4%24%5Bl%2Cr%5D%24%5Cuff0c%20%5Cu67e5%5Cu8be2%20%24%20a%5Bl%5D%5E%7Ba%5Bl%2B1%5D%5E%7Ba%5Bl%2B2%5D%5E%7B.....%7D%7D%7D%20%5C%5Cbmod%20%5C%5C%20%20p%24%5Cuff0c%5Cu4e00%5Cu76f4%5Cu5230%20%24%20a%5Br%5D%20%24%5Cn%5Cn%5Cu8bf7%5Cu6ce8%5Cu610f%5Cu6bcf%5Cu6b21%5Cu7684%5Cu6a21%5Cu6570%5Cu4e0d%5Cu540c%5Cu3002%5Cn%5Cn%5Cu65f6%5Cu95f4%5Cu4e0d%5Cu591f%5Cu4e86%5Cuff0c%5Cu5a01%5Cu5ec9%5Cu81ea%5Cu5df1%5Cu65e0%5Cu529b%5Cu8ba1%5Cu7b97%5Cu8fd9%5Cu4e48%5Cu590d%5Cu6742%5Cu7684%5Cu9b54%5Cu6cd5%5Cu3002%5Cu4f46%5Cu662f%5Cu8fd9%5Cu662f%5Cu6700%5Cu540e%5Cu7684%5Cu5e0c%5Cu671b%5Cu4e86%5Cu3002%5Cn%5Cn%5Cu80fd%5Cu5426%5Cu62ef%5Cu6551%5Cu5948%5Cu8299%5Cu83b2%5Cuff0c%5Cu5c31%5Cu9760%5Cu60a8%5Cu4e86%5Cu3002%5Cn%5Cn%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fpic%5C%2F9263.png%29%5Cn%22%2C%22inputFormat%22%3A%22%5Cu7b2c%5Cu4e00%5Cu884c%5Cu4e24%5Cu4e2a%5Cu6574%5Cu6570%24n%2Cm%24%2C%5Cu8868%5Cu793a%5Cu5e8f%5Cu5217%5Cu957f%5Cu5ea6%5Cu548c%5Cu64cd%5Cu4f5c%5Cu6570%5Cu3002%5Cn%5Cn%5Cu63a5%5Cu4e0b%5Cu6765%5Cu4e00%5Cu884c%5Cuff0c%24n%24%5Cu4e2a%5Cu6574%5Cu6570%24a_i%24%5Cu8868%5Cu793a%5Cu8fd9%5Cu4e2a%5Cu5e8f%5Cu5217%5Cu3002%5Cn%5Cn%5Cu63a5%5Cu4e0b%5Cu6765%24m%24%5Cu884c%5Cuff0c%5Cu53ef%5Cu80fd%5Cu662f%5Cu4ee5%5Cu4e0b%5Cu4e24%5Cu79cd%5Cu64cd%5Cu4f5c%5Cu4e4b%5Cu4e00%5Cuff1a%5Cn%5Cn-%20%601%20l%2Cr%2Cx%60%5Cuff0c%5Cu8868%5Cu793a%5Cu533a%5Cu95f4%24%5Bl%2Cr%5D%24%5Cu52a0%5Cu4e0a%24x%24%5Cn%5Cn-%20%602%20l%2Cr%2Cp%60%20%2C%5Cu8868%5Cu793a%5Cu8fdb%5Cu884c%5Cu4e00%5Cu6b21%5Cu6cd5%5Cu5492%5Cu5171%5Cu9e23%5Cuff0c%5Cu6a21%5Cu6570%5Cu4e3a%24p%24%5Cn%22%2C%22outputFormat%22%3A%22%5Cu5bf9%5Cu4e8e%5Cu6bcf%5Cu4e2a%5Cu64cd%5Cu4f5c2%5Cuff0c%5Cu8f93%5Cu51fa%5Cu4e00%5Cu884c%5Cu8868%5Cu793a%5Cu7b54%5Cu6848%5Cu3002%5Cn%22%2C%22samples%22%3A%5B%5B%226%204%5Cn1%202%203%204%205%206%5Cn2%201%202%2010000007%5Cn2%202%203%205%5Cn1%201%204%201%5Cn2%202%204%2010%5Cn%22%2C%221%5Cn3%5Cn1%22%5D%2C%5B%225%205%5Cn2%203%203%203%203%5Cn1%201%201%20530739835%5Cn2%201%201%208356089%5Cn2%201%204%205496738%5Cn1%201%202%2066050181%5Cn1%202%204%20138625417%5Cn%22%2C%224306230%5Cn697527%5Cn%22%5D%5D%2C%22hint%22%3A%22%5Cu6d4b%5Cu8bd5%5Cu70b9%5Cu3000%5Cu3000%5Cu3000%7Cn%5Cu7684%5Cu8303%5Cu56f4%5Cu3000%5Cu3000%5Cu3000%5Cu3000%7C%20%20m%5Cu7684%5Cu8303%5Cu56f4%5Cu3000%5Cu3000%5Cu3000%5Cu3000%7C%20%20%5Cu7279%5Cu6b8a%5Cu9650%5Cu5236%5Cn-%7C-%7C-%7C-%20%5Cn1%7C%20%20%24n%20%3D%205%20%20%20%20%20%24%20%20%20%7C%24m%20%3D%205%20%20%20%20%20%24%20%20%20%7C%24a_i%20%5C%5Cle%203%24%5Cn2%7C%20%20%24n%20%3D%201000%20%20%24%20%20%20%7C%24m%20%3D%201000%20%20%24%20%20%20%7C%5Cu67e5%5Cu8be2%5Cu533a%5Cu95f4%5Cu957f%5Cu5ea6%5Cu4e3a1%5Cn3%7C%20%20%24n%20%3D%20100000%24%20%20%20%7C%24m%20%3D%20100000%24%20%20%20%7C%5Cu67e5%5Cu8be2%5Cu533a%5Cu95f4%5Cu957f%5Cu5ea6%5Cu4e3a1%5Cn4%7C%20%20%24n%20%3D%201000%20%20%24%20%20%20%7C%24m%20%3D%201000%20%20%24%20%20%20%7C%5Cu67e5%5Cu8be2%5Cu533a%5Cu95f4%5Cu957f%5Cu5ea6%5Cu4e0d%5Cu5927%5Cu4e8e2%5Cn5%7C%20%20%24n%20%3D%20100000%24%20%20%20%7C%24m%20%3D%20100000%24%20%20%20%7C%5Cu67e5%5Cu8be2%5Cu533a%5Cu95f4%5Cu957f%5Cu5ea6%5Cu4e0d%5Cu5927%5Cu4e8e2%5Cn6%7C%20%20%24n%20%3D%201000%20%20%24%20%20%20%7C%24m%20%3D%201000%20%20%24%20%20%20%7C%24a_i%20%5C%5Cle%202%24%5Cn7%7C%20%20%24n%20%3D%201000%20%20%24%20%20%20%7C%24m%20%3D%201000%20%20%24%20%20%20%7C%24p%20%3D%202%24%5Cn8%7C%20%20%24n%20%3D%20100000%24%20%20%20%7C%24m%20%3D%20100000%24%20%20%20%7C%24p%20%3D%202%24%20%5Cu65e0%5Cu4fee%5Cu6539%5Cn9%7C%20%20%24n%20%3D%201000%20%20%24%20%20%20%7C%24m%20%3D%201000%20%20%24%20%20%20%7C%24p%20%5C%5Cle%20100000%24%20%5Cu65e0%5Cu4fee%5Cu6539%5Cn10%7C%20%24n%20%3D%20500000%24%20%20%20%7C%24m%20%3D%20500000%24%20%20%20%7C%5Cu65e0%5Cn%5Cn%5Cu5bf9%5Cu4e8e100%25%5Cu7684%5Cu6570%5Cu636e%5Cuff0c%24n%20%2C%20m%20%5C%5Cle%20500000%24%20%2C%20%5Cu5e8f%5Cu5217%5Cu4e2d%5Cu6bcf%5Cu4e2a%5Cu6570%5Cu5728%24%5B1%2C2%5C%5Ccdot%2010%5E9%5D%24%5Cu5185%5Cuff0c%24p%20%5C%5Cle%202%20%5C%5Ccdot%2010%5E7%20%24%2C%20%5Cu6bcf%5Cu6b21%5Cu52a0%5Cu4e0a%5Cu7684%5Cu6570%5Cu5728%24%5B0%2C2%5C%5Ccdot%2010%5E9%5D%24%5Cu5185%5Cn%5Cn%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fpic%5C%2F9264.png%29%20%5Cn%5Cn%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fpic%5C%2F9387.png%29%5Cn%22%2C%22provider%22%3A%7B%22uid%22%3A3296%2C%22name%22%3A%22noip%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%5Cu6bd2%5Cu7624%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B3000%2C3000%2C3000%2C3000%2C3000%2C3000%2C3000%2C3000%2C3000%2C3000%5D%2C%22memory%22%3A%5B512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22tags%22%3A%5B42%2C53%2C81%2C108%2C111%2C319%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A2375%2C%22totalAccepted%22%3A289%2C%22pid%22%3A%22P3934%22%2C%22title%22%3A%22Nephren%20Ruq%20Insania%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A160343%2C%22title%22%3A%22%5Cu6c42%5Cu52a9%5Cuff0c%5Cu5168%5Cu90e8TLE%5Cuff0c%5Cu4f46%5Cu662f%5Cu6d4b%5Cu8bd5%5Cu70b9%5Cu4e0b%5Cu8f7d%5Cu4e0b%5Cu6765%5Cu80fd%5Cu8fc7%5Cuff0c%5Cu5728%5Cu7ebfIDE%5Cu4e5f%5Cu4e0d%5Cu8d85%5Cu65f6%5Cu7684%22%2C%22forum%22%3A%7B%22id%22%3A6757%2C%22name%22%3A%22P3934%20Nephren%20Ruq%20Insania%22%2C%22slug%22%3A%22P3934%22%7D%7D%2C%7B%22id%22%3A151752%2C%22title%22%3A%22%5Cu3010%5Cu6c42%5Cu52a9%5Cu3011%5Cu6000%5Cu7591%5Cu6700%5Cu540e%5Cu4e00%5Cu4e2a%5Cu70b9%5Cu6570%5Cu636e%5Cu6709%5Cu8bef%5Cuff01%22%2C%22forum%22%3A%7B%22id%22%3A6757%2C%22name%22%3A%22P3934%20Nephren%20Ruq%20Insania%22%2C%22slug%22%3A%22P3934%22%7D%7D%2C%7B%22id%22%3A120998%2C%22title%22%3A%22%5Cu611f%5Cu89c9%5Cu9898%5Cu89e3%5Cu540e%5Cu4e24%5Cu4e2a%5Cu6709%5Cu8bef%22%2C%22forum%22%3A%7B%22id%22%3A6757%2C%22name%22%3A%22P3934%20Nephren%20Ruq%20Insania%22%2C%22slug%22%3A%22P3934%22%7D%7D%2C%7B%22id%22%3A117475%2C%22title%22%3A%22WA%5Cu6700%5Cu540e%5Cu4e00%5Cu4e2a%5Cu70b9%22%2C%22forum%22%3A%7B%22id%22%3A6757%2C%22name%22%3A%22P3934%20Nephren%20Ruq%20Insania%22%2C%22slug%22%3A%22P3934%22%7D%7D%2C%7B%22id%22%3A112665%2C%22title%22%3A%22%5Cu6837%5Cu4f8b%22%2C%22forum%22%3A%7B%22id%22%3A6757%2C%22name%22%3A%22P3934%20Nephren%20Ruq%20Insania%22%2C%22slug%22%3A%22P3934%22%7D%7D%2C%7B%22id%22%3A103164%2C%22title%22%3A%22%5Cu840c%5Cu65b0%5Cu6c42%5Cu52a9%5Cuff0c%5Cu53c8%20WA%20%5Cu53c8%20T%22%2C%22forum%22%3A%7B%22id%22%3A6757%2C%22name%22%3A%22P3934%20Nephren%20Ruq%20Insania%22%2C%22slug%22%3A%22P3934%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P3747%22%2C%22title%22%3A%22%5B%5Cu516d%5Cu7701%5Cu8054%5Cu80032017%5D%5Cu76f8%5Cu9022%5Cu662f%5Cu95ee%5Cu5019%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22CF906D%22%2C%22title%22%3A%22Power%20Tower%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22CF%22%7D%2C%7B%22pid%22%3A%22P4314%22%2C%22title%22%3A%22CPU%5Cu76d1%5Cu63a7%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P4688%22%2C%22title%22%3A%22%5BYnoi2016%5D%5Cu6389%5Cu8fdb%5Cu5154%5Cu5b50%5Cu6d1e%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P5071%22%2C%22title%22%3A%22%5BYnoi2015%5D%5Cu6b64%5Cu65f6%5Cu6b64%5Cu523b%5Cu7684%5Cu5149%5Cu8f89%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22Nephren%20Ruq%20Insania%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>Nephren Ruq Insania</h1>
<h2>题目背景</h2>
<div>[Ynoi2016]炸脖龙I 题面备份 https://www.luogu.org/discuss/show/45962
大样例下发链接: https://pan.baidu.com/s/1nuVpRS1 密码: sfxg
**注意：本题大样例4的输出文件修改为 https://pan.baidu.com/s/1bUWuZW**
奈芙莲·卢可·印萨尼亚(Nephren-Ruq-Insania)
![](https://cdn.luogu.com.cn/upload/pic/9256.png)
同为妖精仓库的成体妖精兵，天赋不如珂朵莉一般，只是一个平凡的妖精.
睡觉时如同毯子一般在威廉身上为其保暖。习惯于粘着威廉，在梦境中与艾尔梅莉亚交谈时，自称就像是威廉的宠物一样。
![](https://cdn.luogu.com.cn/upload/pic/9257.png)
本题题面中含有大量的剧透，建议做题之前将这部番剧看完（
</div>
<h2>题目描述</h2>
<div>她只是一个非常普通的黄金妖精。
在援救打捞队的作战中，他们不幸与（几乎是所有的）第六兽相遇了。
此时的珂朵莉因为接触到星神艾露可本体，正处于昏迷之中。而威廉也无法离开珂朵莉。
![](https://cdn.luogu.com.cn/upload/pic/9258.png)
默默守护在房间外的她，提起圣剑，走向了战场。
![](https://cdn.luogu.com.cn/upload/pic/9259.png)
作为本身天赋只是一般的妖精少女，她难以对抗无数倍于自己的六号兽。
没有多久，她开始体力不支。
终于，在源源不断的六号兽面前，她难以抵挡了……
![](https://cdn.luogu.com.cn/upload/pic/9261.png)
终于，由于魔力过度激发，她已经处在了魔力失控的边缘……
”威廉，拯救，是我们黄金妖精的使命。“
”况且，威廉之前已经救过我们了。“
”所以，已经没有问题了。“
![](https://cdn.luogu.com.cn/upload/pic/9262.png)
威廉想要救下奈芙莲，但是他自己也已经处于崩溃的边缘。
冥冥之中他想起了曾经学习过的一种魔法。在这最后一刻，或许已经是唯一的办法了。
这种魔法操作的对象是一个咒语组成的序列，每一个单独的咒语拥有自己的法力值。
威廉需要不断地按照之前的记忆，对某一段区间的法力值加上一个数，或者求出某一段区间的法咒共鸣。
法咒共鸣具体而言是这么计算的：
对于区间$[l,r]$， 查询 $ a[l]^{a[l+1]^{a[l+2]^{.....}}} \bmod \ p$，一直到 $ a[r] $
请注意每次的模数不同。
时间不够了，威廉自己无力计算这么复杂的魔法。但是这是最后的希望了。
能否拯救奈芙莲，就靠您了。
![](https://cdn.luogu.com.cn/upload/pic/9263.png)
</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>第一行两个整数$n,m$,表示序列长度和操作数。
接下来一行，$n$个整数$a_i$表示这个序列。
接下来$m$行，可能是以下两种操作之一：
- `1 l,r,x`，表示区间$[l,r]$加上$x$
- `2 l,r,p` ,表示进行一次法咒共鸣，模数为$p$
</div>
<h3>输出格式</h3>
<br />
<div>对于每个操作2，输出一行表示答案。
</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>6 4
1 2 3 4 5 6
2 1 2 10000007
2 2 3 5
1 1 4 1
2 2 4 10
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>1
3
1</code></pre>
<h3>输入样例 #2</h3>
<pre><code>5 5
2 3 3 3 3
1 1 1 530739835
2 1 1 8356089
2 1 4 5496738
1 1 2 66050181
1 2 4 138625417
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>4306230
697527
</code></pre>
<h2>说明</h2>
<div>测试点　　　|n的范围　　　　| m的范围　　　　| 特殊限制
-|-|-|-
1| $n = 5 $ |$m = 5 $ |$a_i \le 3$
2| $n = 1000 $ |$m = 1000 $ |查询区间长度为1
3| $n = 100000$ |$m = 100000$ |查询区间长度为1
4| $n = 1000 $ |$m = 1000 $ |查询区间长度不大于2
5| $n = 100000$ |$m = 100000$ |查询区间长度不大于2
6| $n = 1000 $ |$m = 1000 $ |$a_i \le 2$
7| $n = 1000 $ |$m = 1000 $ |$p = 2$
8| $n = 100000$ |$m = 100000$ |$p = 2$ 无修改
9| $n = 1000 $ |$m = 1000 $ |$p \le 100000$ 无修改
10| $n = 500000$ |$m = 500000$ |无
对于100%的数据，$n , m \le 500000$ , 序列中每个数在$[1,2\cdot 10^9]$内，$p \le 2 \cdot 10^7 $, 每次加上的数在$[0,2\cdot 10^9]$内
![](https://cdn.luogu.com.cn/upload/pic/9264.png)
![](https://cdn.luogu.com.cn/upload/pic/9387.png)
</div>
</article>
</div>
</div>
</body>
</html>
