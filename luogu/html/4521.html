<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>[COCI2017-2018 Contest4] Automobil - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573381513:sExEfmWuLLrpMxpPQ84DUWha6WIdtzZJzsu6795sMKs=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%22%2C%22description%22%3A%22Mirko%20has%20found%20a%20matrix%20with%20N%20rows%20and%20M%20columns%20at%20the%20back%20seat%20of%20his%20car.%20The%20first%5Cnrow%20of%20the%20matrix%20consists%20of%20numbers%201%2C%202%2C%20%5Cu2026%20M%2C%20the%20second%20row%20of%20numbers%20M%2B1%2C%20M%2B2%2C%20%5Cu2026%5Cn2%5Cu22c5M%20and%20so%20on%20until%20the%20%24N%5E%7Bth%7D%24%20%20%5Cnrow%20which%20consists%20of%20numbers%20%28N-1%29%5Cu22c5M%20%2B%201%2C%20%28N-1%29%5Cu22c5M%20%2B%202%2C%20%5Cu2026%5CnN%5Cu22c5M%2C%20respectively.%5Cn%5CnFor%20example%2C%20for%20N%20%3D%203%20and%20M%20%3D%204%3A%5Cn%5Cn%7C%20-%20%7C%20-%20%7C%20-%20%7C%20-%20%7C%5Cn%7C%20%3A----------%3A%20%7C%20%3A----------%3A%20%7C%20%3A----------%3A%20%7C%20%3A----------%3A%20%7C%5Cn%7C%20%2A%2A1%2A%2A%20%7C%20%2A%2A2%2A%2A%20%7C%20%2A%2A3%2A%2A%20%7C%20%2A%2A4%2A%2A%20%7C%5Cn%7C%20%2A%2A5%2A%2A%20%7C%20%2A%2A6%2A%2A%20%7C%20%2A%2A7%2A%2A%20%7C%20%2A%2A8%2A%2A%20%7C%5Cn%7C%20%2A%2A9%2A%2A%20%7C%20%2A%2A10%2A%2A%20%7C%20%2A%2A11%2A%2A%20%7C%20%2A%2A12%2A%2A%20%7C%5Cn%5CnSuch%20matrix%20wasn%5Cu2019t%20interesting%20enough%20to%20him%2C%20so%20he%20chose%20a%20row%20or%20a%20column%20K%20times%20and%5Cnmultiplied%20its%20values%20with%20a%20non-negative%20integer.%5Cn%5CnNaturally%2C%20now%20he%20wants%20to%20know%20the%20sum%20of%20all%20the%20values%20from%20the%20matrix.%20Since%20this%20sum%5Cncan%20be%20very%20large%2C%20Mirko%20will%20be%20satisfied%20with%20the%20value%20modulo%20%2410%5E9%24%20%2B%207.%20Help%20Mirko%20answer%5Cnthis%20question.%22%2C%22inputFormat%22%3A%22The%20first%20line%20of%20input%20contains%20the%20numbers%20N%20%281%20%5Cu2264%20N%20%5Cu2264%201%20000%20000%29%2C%20M%20%281%20%5Cu2264%20M%20%5Cu2264%201%20000%5Cn000%29%20and%20K%20%281%20%5Cu2264%20K%20%5Cu2264%201000%29%20from%20the%20task.%5Cn%5Cn%20-%20Either%20the%20multiplication%20of%20the%20%24X%5E%7Bth%7D%24%5Cnrow%20with%20Y%2C%20in%20the%20form%20of%20%5C%22R%20X%20Y%5C%22%2C%20where%20%5Cu201cR%5Cu201d%5Cnrepresents%20row%20multiplication%2C%20X%20is%20a%20positive%20integer%20%281%20%5Cu2264%20X%20%5Cu2264%20N%29%2C%20and%20Y%20is%20a%5Cnnon-negative%20integer%20%280%20%5Cu2264%20Y%20%5Cu2264%20%2410%5E%7B9%7D%24%5Cn%29.%5Cn%5Cn%20-%20Or%20the%20multiplication%20of%20the%20%24X%5E%7Bth%7D%24%20column%20with%20Y%2C%20in%20the%20form%20of%20%5Cu201cS%20X%20Y%5Cu201d%2C%20where%20%5Cu201cS%5Cu201d%5Cnrepresents%20column%20multiplication%2C%20X%20is%20a%20positive%20integer%20%281%20%5Cu2264%20X%20%5Cu2264%20M%29%2C%20and%20Y%20is%20a%5Cnnon-negative%20integer%20%280%20%5Cu2264%20Y%20%5Cu2264%20%2410%5E%7B9%7D%24%5Cn%29.%22%2C%22outputFormat%22%3A%22You%20must%20output%20the%20sum%20of%20the%20final%20values%20from%20the%20matrix%20modulo%20%2410%5E%7B9%7D%24%20%2B%207%22%2C%22samples%22%3A%5B%5B%223%204%204%5CnR%202%204%5CnS%204%201%5CnR%203%202%5CnR%202%200%22%2C%2294%22%5D%2C%5B%223%201%201%5CnS%201%204%5Cn%22%2C%2224%22%5D%2C%5B%222%204%204%5CnS%202%200%5CnS%202%203%5CnR%201%205%5CnS%201%203%22%2C%2280%22%5D%5D%2C%22hint%22%3A%22In%20test%20cases%20worth%20a%20total%20of%2050%20points%2C%20it%20will%20hold%201%20%5Cu2264%20N%2C%20M%20%5Cu2264%201000.%5Cn%5Cn%2A%2AClarification%20of%20the%20first%20test%20case%3A%2A%2A%5CnAfter%20multiplying%20the%20second%20row%20with%204%2C%20the%20fourth%20column%20with%201%2C%20the%20third%20row%20with%202%2C%20and%20again%20the%5Cnsecond%20row%20with%200%2C%20the%20final%20matrix%20looks%20like%20this%3A%5Cn%5Cn%7C%20-%20%7C%20-%20%7C%20-%20%7C%20-%20%7C%5Cn%7C%20%3A----------%3A%20%7C%20%3A----------%3A%20%7C%20%3A----------%3A%20%7C%20%3A----------%3A%20%7C%5Cn%7C%20%2A%2A1%2A%2A%20%7C%20%2A%2A2%2A%2A%20%7C%20%2A%2A3%2A%2A%20%7C%20%2A%2A4%2A%2A%20%7C%5Cn%7C%20%2A%2A0%2A%2A%20%7C%20%2A%2A0%2A%2A%20%7C%20%2A%2A0%2A%2A%20%7C%20%2A%2A0%2A%2A%20%7C%5Cn%7C%20%2A%2A18%2A%2A%20%7C%20%2A%2A20%2A%2A%20%7C%20%2A%2A22%2A%2A%20%7C%20%2A%2A24%2A%2A%20%7C%5Cn%5CnThe%20sum%20of%20the%20elements%20from%20the%20final%20matrix%20is%201%20%2B%202%20%2B%203%20%2B%204%20%2B%200%20%2B%200%20%2B%200%20%2B%200%20%2B%2018%20%2B%2020%20%2B%2022%20%2B%2024%20%3D%5Cn94.%22%2C%22provider%22%3A%7B%22uid%22%3A50092%2C%22name%22%3A%22da32s1da%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3Anull%2C%22isAdmin%22%3Afalse%2C%22color%22%3A%22Blue%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%5D%2C%22memory%22%3A%5B64000%2C64000%2C64000%2C64000%2C64000%2C64000%2C64000%2C64000%2C64000%2C64000%2C64000%2C64000%2C64000%2C64000%2C64000%2C64000%2C64000%2C64000%2C64000%2C64000%2C64000%2C64000%2C64000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22tags%22%3A%5B34%2C319%2C333%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A191%2C%22totalAccepted%22%3A49%2C%22pid%22%3A%22P4521%22%2C%22title%22%3A%22%5BCOCI2017-2018%20Contest4%5D%20Automobil%20%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22P%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P4522%22%2C%22title%22%3A%22%5BCOCI2017-2018%20Contest4%5D%20Vo%5Cu0111e%20%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P4524%22%2C%22title%22%3A%22%5BCOCI2017-2018%20Contest4%5D%20Ceste%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P4614%22%2C%22title%22%3A%22%5BCOCI2017-2018%235%5D%20Spirale%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P4615%22%2C%22title%22%3A%22%5BCOCI2017-2018%235%5D%20Birokracija%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P4650%22%2C%22title%22%3A%22%5BCOCI2017-2018%235%5D%20Karte%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22P%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22%5BCOCI2017-2018%20Contest4%5D%20Automobil%20%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573286098;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>[COCI2017-2018 Contest4] Automobil </h1>
<h2>题目描述</h2>
<div>Mirko has found a matrix with N rows and M columns at the back seat of his car. The first
row of the matrix consists of numbers 1, 2, … M, the second row of numbers M+1, M+2, …
2⋅M and so on until the $N^{th}$
row which consists of numbers (N-1)⋅M + 1, (N-1)⋅M + 2, …
N⋅M, respectively.
For example, for N = 3 and M = 4:
| - | - | - | - |
| :----------: | :----------: | :----------: | :----------: |
| **1** | **2** | **3** | **4** |
| **5** | **6** | **7** | **8** |
| **9** | **10** | **11** | **12** |
Such matrix wasn’t interesting enough to him, so he chose a row or a column K times and
multiplied its values with a non-negative integer.
Naturally, now he wants to know the sum of all the values from the matrix. Since this sum
can be very large, Mirko will be satisfied with the value modulo $10^9$ + 7. Help Mirko answer
this question.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line of input contains the numbers N (1 ≤ N ≤ 1 000 000), M (1 ≤ M ≤ 1 000
000) and K (1 ≤ K ≤ 1000) from the task.
- Either the multiplication of the $X^{th}$
row with Y, in the form of "R X Y", where “R”
represents row multiplication, X is a positive integer (1 ≤ X ≤ N), and Y is a
non-negative integer (0 ≤ Y ≤ $10^{9}$
).
- Or the multiplication of the $X^{th}$ column with Y, in the form of “S X Y”, where “S”
represents column multiplication, X is a positive integer (1 ≤ X ≤ M), and Y is a
non-negative integer (0 ≤ Y ≤ $10^{9}$
).</div>
<h3>输出格式</h3>
<br />
<div>You must output the sum of the final values from the matrix modulo $10^{9}$ + 7</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>3 4 4
R 2 4
S 4 1
R 3 2
R 2 0</code></pre>
<h3>输出样例 #1</h3>
<pre><code>94</code></pre>
<h3>输入样例 #2</h3>
<pre><code>3 1 1
S 1 4
</code></pre>
<h3>输出样例 #2</h3>
<pre><code>24</code></pre>
<h3>输入样例 #3</h3>
<pre><code>2 4 4
S 2 0
S 2 3
R 1 5
S 1 3</code></pre>
<h3>输出样例 #3</h3>
<pre><code>80</code></pre>
<h2>说明</h2>
<div>In test cases worth a total of 50 points, it will hold 1 ≤ N, M ≤ 1000.
**Clarification of the first test case:**
After multiplying the second row with 4, the fourth column with 1, the third row with 2, and again the
second row with 0, the final matrix looks like this:
| - | - | - | - |
| :----------: | :----------: | :----------: | :----------: |
| **1** | **2** | **3** | **4** |
| **0** | **0** | **0** | **0** |
| **18** | **20** | **22** | **24** |
The sum of the elements from the final matrix is 1 + 2 + 3 + 4 + 0 + 0 + 0 + 0 + 18 + 20 + 22 + 24 =
94.</div>
</article>
</div>
</div>
</body>
</html>
