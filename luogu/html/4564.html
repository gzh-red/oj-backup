<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>[CTSC2018]假面 - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573381560:uwhynnvFGrhrlP5nruWmsgPlRwvDTSfNPAKcBHZ8fBo=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%23%20%5Cu672c%5Cu9898%5Cu6570%5Cu636e%5Cu635f%5Cu574f%5Cu65e0%5Cu6cd5%5Cu8bc4%5Cu6d4b%5Cn%5Cn%5Cu9488%5Cu9488%5Cu662f%5Cu7eff%5Cu7eff%5Cu7684%5Cu597d%5Cu670b%5Cu53cb%5Cu3002%22%2C%22description%22%3A%22%5Cu9488%5Cu9488%5Cu559c%5Cu6b22%5Cu73a9%5Cu4e00%5Cu6b3e%5Cu53eb%5Cu505a%20DotA%20%28%2A%2AD%2A%2Aefense%20%2A%2Ao%2A%2Af%20%2A%2At%2A%2Ahe%20%2A%2AA%2A%2Algorithm%29%20%5Cu7684%5Cu6e38%5Cu620f%5Cuff0c%5Cu5728%5Cu8fd9%5Cu4e2a%5Cu6e38%5Cu620f%5Cu4e2d%5Cuff0c%5Cu9488%5Cu9488%5Cu4f1a%5Cu64cd%5Cu7eb5%5Cu81ea%5Cu5df1%5Cu7684%5Cu82f1%5Cu96c4%5Cu4e0e%5Cu961f%5Cu53cb%5Cu4e00%5Cu8d77%5Cu5bf9%5Cu6297%5Cu53e6%5Cu4e00%5Cu652f%5Cu961f%5Cu4f0d%5Cu3002%5Cn%5Cu9488%5Cu9488%5Cu5728%20DotA%20%5Cu4e2d%5Cu6700%5Cu559c%5Cu6b22%5Cu4f7f%5Cu7528%5Cu7684%5Cu82f1%5Cu96c4%5Cu53eb%5Cu505a%5Cu5047%5Cu9762%5Cuff08Faceless%5Cuff09%5Cuff0c%5Cu8be5%5Cu82f1%5Cu96c4%5Cu6709%20%242%24%20%5Cu4e2a%5Cu6280%5Cu80fd%5Cuff1a%5Cn%5Cn-%20%5Cu9501%5Cu5b9a%5Cuff1a%5Cu5bf9%5Cu4e00%5Cu540d%5Cu6307%5Cu5b9a%5Cu7684%5Cu654c%5Cu65b9%5Cu5355%5Cu4f4d%5Cu4f7f%5Cu7528%5Cuff0c%5Cu4ee5%20%24p%24%20%5Cu7684%5Cu6982%5Cu7387%5Cu5bf9%5Cu8be5%5Cu5355%5Cu4f4d%5Cu9020%5Cu6210%20%241%24%20%5Cu70b9%5Cu4f24%5Cu5bb3%5Cuff08%5Cu4f7f%5Cu5176%5Cu51cf%5Cu5c11%20%241%24%20%5Cu70b9%5Cu751f%5Cu547d%5Cu503c%5Cuff09%5Cu3002%5Cn-%20%5Cu7ed3%5Cu754c%5Cuff1a%5Cu5728%5Cu4e00%5Cu7247%5Cu533a%5Cu57df%5Cu65bd%5Cu653e%5Cu7ed3%5Cu754c%5Cuff0c%5Cu8ba9%5Cu8be5%5Cu533a%5Cu57df%5Cu5185%5Cu7684%5Cu6240%5Cu6709%5Cu5176%5Cu4ed6%5Cu5355%5Cu4f4d%5Cu65e0%5Cu6cd5%5Cu52a8%5Cu5f39%5Cu3002%5Cn%5Cu5728%5Cu6e38%5Cu620f%5Cu4e2d%5Cuff0c%5Cu5982%5Cu679c%5Cu4e00%5Cu4e2a%5Cu5355%5Cu4f4d%5Cu7684%5Cu751f%5Cu547d%5Cu503c%5Cu964d%5Cu81f3%20%240%24%20%5Cu6216%20%240%24%20%5Cu4ee5%5Cu4e0b%5Cuff0c%5Cu90a3%5Cu4e48%5Cu8be5%5Cu5355%5Cu4f4d%5Cu5c31%5Cu4f1a%5Cu6b7b%5Cu4ea1%5Cu3002%5Cn%5Cn%5Cu9488%5Cu9488%5Cu64cd%5Cu7eb5%5Cu5047%5Cu9762%5Cu7684%5Cu6c34%5Cu5e73%5Cu4e00%5Cu822c%5Cuff0c%5Cu56e0%5Cu6b64%5Cu4ed6%5Cu51b3%5Cu5b9a%5Cu52e4%5Cu52a0%5Cu7ec3%5Cu4e60%5Cu3002%5Cu73b0%5Cu5728%5Cu6709%20%24n%24%20%5Cu4e2a%5Cu654c%5Cu65b9%5Cu5355%5Cu4f4d%5Cuff08%5Cu7f16%5Cu53f7%5Cu4ece%20%241%24%20%5Cu81f3%20%24n%24%5Cuff09%5Cuff0c%5Cu7f16%5Cu53f7%5Cu4e3a%20%24i%24%20%5Cu7684%5Cu654c%5Cu65b9%5Cu5355%5Cu4f4d%5Cu6709%20%24h_i%24%20%5Cu70b9%5Cu751f%5Cu547d%5Cu503c%5Cu3002%5Cn%5Cn%5Cu9488%5Cu9488%5Cu5df2%5Cu7ecf%5Cu5b89%5Cu6392%5Cu597d%5Cu4e86%5Cu7ec3%5Cu4e60%5Cu7684%5Cu8ba1%5Cu5212%5Cuff0c%5Cu4ed6%5Cu4f1a%5Cu6309%5Cu987a%5Cu5e8f%5Cu65bd%5Cu653e%20%24Q%24%20%5Cu4e2a%5Cu6280%5Cu80fd%5Cuff1a%5Cn%5Cn-%20%5Cu5bf9%5Cu4e8e%5Cu9501%5Cu5b9a%5Cu6280%5Cu80fd%5Cuff1a%5Cu9488%5Cu9488%5Cu4f1a%5Cu6307%5Cu5b9a%5Cu4e00%5Cu4e2a%5Cu654c%5Cu65b9%5Cu5355%5Cu4f4d%20%24id%24%20%5Cuff0c%5Cu5e76%5Cu5bf9%5Cu5b83%5Cu65bd%5Cu653e%5Cu3002%5Cu7531%5Cu4e8e%5Cu51b3%5Cu5b9a%5Cu6982%5Cu7387%5Cu7cfb%5Cu6570%20%24p%24%20%5Cu7684%5Cu56e0%5Cu7d20%5Cu5f88%5Cu591a%5Cuff0c%5Cu56e0%5Cu6b64%5Cu6bcf%5Cu6b21%5Cu7684%20%24p%24%20%5Cu90fd%5Cu4e0d%5Cu4e00%5Cu5b9a%5Cu76f8%5Cu540c%5Cu3002%5Cn%5Cu7279%5Cu522b%5Cu5730%5Cuff0c%5Cu5982%5Cu679c%5Cu8be5%5Cu654c%5Cu65b9%5Cu5355%5Cu4f4d%5Cu5df2%5Cu7ecf%5Cu6b7b%5Cu4ea1%5Cuff0c%5Cu90a3%5Cu4e48%5Cu8be5%5Cu6280%5Cu80fd%5Cu4e0d%5Cu4f1a%5Cu9020%5Cu6210%5Cu4efb%5Cu4f55%5Cu6548%5Cu679c%5Cu3002%5Cn-%20%5Cu5bf9%5Cu4e8e%5Cu7ed3%5Cu754c%5Cu6280%5Cu80fd%5Cuff1a%5Cu9488%5Cu9488%5Cu4f1a%5Cu5e0c%5Cu671b%5Cu5bf9%20%24k%24%20%5Cu4e2a%5Cu6307%5Cu5b9a%5Cu7684%5Cu654c%5Cu65b9%5Cu5355%5Cu4f4d%5Cu65bd%5Cu653e%5Cuff0c%5Cu4f46%5Cu7531%5Cu4e8e%5Cu9488%5Cu9488%5Cu5e76%5Cu4e0d%5Cu64c5%5Cu957f%5Cu65bd%5Cu653e%5Cu8be5%5Cu6280%5Cu80fd%5Cuff0c%5Cu56e0%5Cu6b64%5Cu4ed6%5Cu53ea%5Cu80fd%5Cu547d%5Cu4e2d%5Cu6070%5Cu597d%20%241%24%20%5Cu4e2a%5Cu654c%5Cu65b9%5Cu5355%5Cu4f4d%5Cu3002%5Cu547d%5Cu4e2d%5Cu6bcf%5Cu4e2a%5Cu5b58%5Cu6d3b%5Cu7684%5Cu654c%5Cu65b9%5Cu5355%5Cu4f4d%5Cu7684%5Cu6982%5Cu7387%5Cu662f%5Cu76f8%5Cu7b49%5Cu7684%5Cuff08%5Cu4e5f%5Cu5c31%5Cu662f%5Cu8bf4%5Cu5df2%5Cu7ecf%5Cu6b7b%5Cu4ea1%5Cu7684%5Cu654c%5Cu65b9%5Cu5355%5Cu4f4d%5Cu4e0d%5Cu4f1a%5Cu6709%5Cu4efb%5Cu4f55%5Cu5f71%5Cu54cd%5Cuff09%5Cu3002%5Cn%5Cu7279%5Cu522b%5Cu5730%5Cuff0c%5Cu5982%5Cu679c%5Cu8fd9%20%24k%24%20%5Cu4e2a%5Cu654c%5Cu65b9%5Cu5355%5Cu4f4d%5Cu5747%5Cu5df2%5Cu6b7b%5Cu4ea1%5Cuff0c%5Cu90a3%5Cu4e48%5Cu8be5%5Cu6280%5Cu80fd%5Cu540c%5Cu6837%5Cu4e0d%5Cu4f1a%5Cu547d%5Cu4e2d%5Cu4efb%5Cu4f55%5Cu654c%5Cu65b9%5Cu5355%5Cu4f4d%5Cu3002%5Cn%5Cn%5Cu73b0%5Cu5728%5Cuff0c%5Cu56f4%5Cu89c2%5Cu9488%5Cu9488%5Cu8fdb%5Cu884c%5Cu7ec3%5Cu4e60%5Cu7684%5Cu7eff%5Cu7eff%5Cu60f3%5Cu77e5%5Cu9053%5Cuff1a%5Cn%5Cn1.%20%5Cu5bf9%5Cu4e8e%5Cu9488%5Cu9488%5Cu65bd%5Cu653e%5Cu7684%5Cu6bcf%5Cu4e2a%5Cu7ed3%5Cu754c%5Cu6280%5Cu80fd%5Cuff0c%5Cu5b83%5Cu547d%5Cu4e2d%5Cu5404%5Cu654c%5Cu4eba%5Cu7684%5Cu6982%5Cu7387%5Cu5206%5Cu522b%5Cu662f%5Cu591a%5Cu5c11%5Cu3002%5Cn2.%20%5Cu5728%5Cu9488%5Cu9488%5Cu7684%5Cu6240%5Cu6709%5Cu6280%5Cu80fd%5Cu65bd%5Cu653e%5Cu5b8c%5Cu6bd5%5Cu540e%5Cuff0c%5Cu6240%5Cu6709%5Cu654c%5Cu65b9%5Cu5355%5Cu4f4d%5Cu5269%5Cu4f59%5Cu751f%5Cu547d%5Cu503c%5Cu7684%5Cu671f%5Cu671b%5Cu5206%5Cu522b%5Cu662f%5Cu591a%5Cu5c11%5Cu3002%5Cn%5Cn%5Cu7531%5Cu4e8e%5Cu7eff%5Cu7eff%5Cu8fd8%5Cu8981%5Cu56f4%5Cu89c2%5Cu9488%5Cu9488%5Cu8bad%5Cu7ec3%5Cuff0c%5Cu6240%5Cu4ee5%5Cu8bf7%5Cu4f60%5Cu5e2e%5Cu4ed6%5Cu89e3%5Cu51b3%5Cu8fd9%5Cu4e24%5Cu4e2a%5Cu95ee%5Cu9898%5Cu3002%5Cn%5Cn%5Cu4e3a%5Cu4e86%5Cu9632%5Cu6b62%5Cu7cbe%5Cu5ea6%5Cu8bef%5Cu5dee%5Cuff0c%5Cu5bf9%5Cu4e8e%5Cu6240%5Cu6709%5Cu9700%5Cu8981%5Cu8f93%5Cu51fa%5Cu7684%5Cu6570%5Cu503c%5Cuff0c%5Cu8bf7%5Cu8f93%5Cu51fa%5Cu5176%5Cu5728%5Cu6a21%20%24998244353%24%20%5Cu610f%5Cu4e49%5Cu4e0b%5Cu7684%5Cu503c%5Cu3002%5Cn%5Cn%5Cu7531%5Cu4e8e%5Cu7ed3%5Cu754c%5Cu4e3a%5Cu5047%5Cu9762%5Cu7684%5Cu7ec8%5Cu6781%5Cu6280%5Cu80fd%5Cuff0c%5Cu56e0%5Cu6b64%5Cu9488%5Cu9488%5Cu65bd%5Cu653e%5Cu8be5%5Cu6280%5Cu80fd%5Cu7684%5Cu6b21%5Cu6570%5Cu4e0d%5Cu4f1a%5Cu592a%5Cu591a%5Cu3002%5Cu5177%5Cu4f53%5Cu8bf7%5Cu89c1%5Cu201d%5Cu5b50%5Cu4efb%5Cu52a1%5Cu201c%5Cu3002%22%2C%22inputFormat%22%3A%22%5Cu7b2c%20%241%24%20%5Cu884c%5Cu4e3a%20%241%24%20%5Cu4e2a%5Cu6b63%5Cu6574%5Cu6570%20%24n%24%20%5Cuff0c%5Cu8868%5Cu793a%5Cu654c%5Cu65b9%5Cu5355%5Cu4f4d%5Cu7684%5Cu6570%5Cu91cf%5Cu3002%20%20%5Cn%5Cu7b2c%20%242%24%20%5Cu884c%5Cu4e3a%20%24n%24%20%5Cu4e2a%5Cu6b63%5Cu6574%5Cu6570%20%24m_1%2C%5C%5Ccdots%20%2C%20m_n%24%5Cuff0c%5Cu4f9d%5Cu6b21%5Cu8868%5Cu793a%5Cu5404%5Cu654c%5Cu65b9%5Cu5355%5Cu4f4d%5Cu7684%5Cu521d%5Cu59cb%5Cu751f%5Cu547d%5Cu503c%5Cu3002%20%20%5Cn%5Cu7b2c%20%243%24%20%5Cu884c%5Cu4e3a%20%241%24%20%5Cu4e2a%5Cu975e%5Cu8d1f%5Cu6574%5Cu6570%20%24Q%24%20%5Cuff0c%5Cu8868%5Cu793a%5Cu9488%5Cu9488%5Cu65bd%5Cu653e%5Cu6280%5Cu80fd%5Cu7684%5Cu6570%5Cu91cf%5Cu3002%20%20%5Cn%5Cu7b2c%20%244%24%20%5Cu884c%5Cu81f3%5Cu7b2c%20%24Q%20%2B%203%24%20%5Cu884c%5Cuff0c%5Cu6bcf%5Cu884c%5Cu63cf%5Cu8ff0%5Cu4e00%5Cu4e2a%5Cu6280%5Cu80fd%5Cuff0c%5Cu7b2c%20%24i%20%2B%203%24%20%5Cu884c%5Cu63cf%5Cu8ff0%5Cu7b2c%20%24i%24%20%5Cu4e2a%5Cu6280%5Cu80fd%5Cu3002%5Cn%5Cn%5Cu6bcf%5Cu884c%5Cu7684%5Cu5f00%5Cu5934%5Cu4e3a%5Cu4e00%5Cu4e2a%5Cu6574%5Cu6570%20%24op%24%20%5Cuff0c%5Cu8868%5Cu793a%5Cu8be5%5Cu6280%5Cu80fd%5Cu7684%5Cu79cd%5Cu7c7b%5Cu3002%20%20%5Cn%5Cu5982%5Cu679c%20%24op%20%3D%200%24%20%5Cuff0c%5Cu5219%5Cu8868%5Cu793a%5Cu9501%5Cu5b9a%5Cu6280%5Cu80fd%5Cu3002%5Cu5e76%5Cu5728%5Cu6b64%5Cu540e%5Cu8ddf%5Cu968f%5Cu7740%20%243%24%20%5Cu4e2a%5Cu6b63%5Cu6574%5Cu6570%20%24id%20%2C%20u%20%2C%20v%24%20%5Cuff0c%5Cu8868%5Cu793a%5Cu6280%5Cu80fd%5Cu65bd%5Cu653e%5Cu7684%5Cu76ee%5Cu6807%5Cu4e3a%20%24id%24%20%5Cuff0c%5Cu6280%5Cu80fd%5Cu547d%5Cu4e2d%5Cu7684%5Cu6982%5Cu7387%5Cu4e3a%20%24p%20%3D%20%5C%5Cfrac%7Bu%7D%7Bv%7D%24%20%5Cu3002%5Cuff08%5Cu4fdd%5Cu8bc1%20%241%5C%5Cle%20id%20%5C%5Cle%20n%20%2C%200%20%3C%20u%20%5C%5Cle%20v%20%3C%20998244353%24%20%5Cuff09%20%20%5Cn%5Cu5982%5Cu679c%20%24op%20%3D%201%24%20%5Cuff0c%5Cu5219%5Cu8868%5Cu793a%5Cu7ed3%5Cu754c%5Cu6280%5Cu80fd%5Cu3002%5Cu5e76%5Cu5728%5Cu6b64%5Cu540e%5Cu8ddf%5Cu968f%5Cu7740%20%241%24%20%5Cu4e2a%5Cu6b63%5Cu6574%5Cu6570%20%24k%24%20%5Cu8868%5Cu793a%5Cu6280%5Cu80fd%5Cu65bd%5Cu653e%5Cu7684%5Cu76ee%5Cu6807%5Cu6570%5Cu91cf%5Cuff0c%5Cu968f%5Cu540e%5Cu8fd8%5Cu6709%5Cu989d%5Cu5916%5Cu7684%20%24k%24%20%5Cu4e2a%5Cu6570%20%24id_1%2C%5C%5Ccdots%2Cid_k%24%20%5Cu63cf%5Cu8ff0%5Cu6280%5Cu80fd%5Cu65bd%5Cu653e%5Cu7684%5Cu6240%5Cu6709%5Cu76ee%5Cu6807%5Cu3002%5Cuff08%5Cu4fdd%5Cu8bc1%5Cu6240%5Cu6709%20%241%20%5C%5Cle%20id_i%20%5C%5Cle%20n%24%20%5Cu4e92%5Cu4e0d%5Cu76f8%5Cu540c%5Cuff09%20%5Cu5bf9%5Cu4e8e%5Cu6bcf%5Cu4e00%5Cu884c%5Cuff0c%5Cu5982%5Cu679c%5Cu884c%5Cu5185%5Cu5305%5Cu542b%5Cu591a%5Cu4e2a%5Cu6570%5Cuff0c%5Cu5219%5Cu7528%5Cu5355%5Cu4e2a%5Cu7a7a%5Cu683c%5Cu5c06%5Cu5b83%5Cu4eec%5Cu9694%5Cu5f00%5Cu3002%22%2C%22outputFormat%22%3A%22%5Cu8f93%5Cu51fa%5Cu5305%5Cu62ec%20%24C%20%2B%201%24%20%5Cu884c%5Cuff08%5Cu5176%5Cu4e2d%20%24C%24%20%5Cu4e3a%5Cu7ed3%5Cu754c%5Cu6280%5Cu80fd%5Cu7684%5Cu6570%5Cu91cf%5Cuff09%5Cuff1a%5Cn%5Cn%5Cu524d%20%24C%24%20%5Cu884c%5Cu4f9d%5Cu6b21%5Cu5bf9%5Cu5e94%5Cu6bcf%5Cu4e2a%5Cu7ed3%5Cu754c%5Cu6280%5Cu80fd%5Cuff0c%5Cu5bf9%5Cu4e8e%5Cu6bcf%5Cu884c%5Cuff1a%5Cn%5Cn%5Cu8f93%5Cu51fa%20%24k%24%20%5Cu4e2a%5Cu6570%5Cuff0c%5Cu7b2c%20%24i%24%20%5Cu4e2a%5Cu6570%5Cu8868%5Cu793a%5Cu7ed3%5Cu754c%5Cu547d%5Cu4e2d%5Cu654c%5Cu65b9%5Cu5355%5Cu4f4d%20%24id_i%24%20%5Cu7684%5Cu6982%5Cu7387%5Cu3002%20%20%20%5Cn%5Cu7b2c%20%24C%20%2B%201%24%20%5Cu884c%5Cu8f93%5Cu51fa%20%24n%24%20%5Cu4e2a%5Cu6570%5Cuff0c%5Cu7b2c%20%24i%24%20%5Cu4e2a%5Cu6570%5Cu8868%5Cu793a%5Cu5728%5Cu6240%5Cu6709%5Cu6280%5Cu80fd%5Cu65bd%5Cu653e%5Cu5b8c%5Cu6bd5%5Cu540e%5Cuff0c%5Cu654c%5Cu65b9%5Cu5355%5Cu4f4d%20%24i%24%20%5Cu5269%5Cu4f59%5Cu751f%5Cu547d%5Cu503c%5Cu7684%5Cu671f%5Cu671b%5Cu503c%5Cu3002%20%20%5Cn%5Cn%5Cu5bf9%5Cu4e8e%5Cu6bcf%5Cu4e00%5Cu884c%5Cuff0c%5Cu5982%5Cu679c%5Cu884c%5Cu5185%5Cu5305%5Cu542b%5Cu591a%5Cu4e2a%5Cu6570%5Cuff0c%5Cu5219%5Cu7528%5Cu5355%5Cu4e2a%5Cu7a7a%5Cu683c%5Cu5c06%5Cu5b83%5Cu4eec%5Cu9694%5Cu5f00%5Cu3002%5Cn%5Cn%5Cu5bf9%5Cu4e8e%5Cu6240%5Cu6709%5Cu6570%5Cu503c%5Cuff0c%5Cu8bf7%5Cu8f93%5Cu51fa%5Cu5b83%5Cu4eec%5Cu5bf9%20%24998244353%24%20%5Cu53d6%5Cu6a21%5Cu7684%5Cu7ed3%5Cu679c%5Cuff1a%5Cu5373%5Cu8bbe%5Cu7b54%5Cu6848%5Cu5316%5Cu4e3a%5Cu6700%5Cu7b80%5Cu5206%5Cu5f0f%5Cu540e%5Cu7684%5Cu5f62%5Cu5f0f%5Cu4e3a%20%24%5C%5Cfrac%7Ba%7D%7Bb%7D%24%20%5Cuff0c%5Cu5176%5Cu4e2d%20%24a%24%20%5Cu548c%20%24b%24%20%5Cu7684%5Cu4e92%5Cu8d28%5Cu3002%5Cu8f93%5Cu51fa%5Cu6574%5Cu6570%20%24x%24%20%5Cu4f7f%5Cu5f97%20%24bx%20%5C%5Cequiv%20a%5C%5Cbmod%20998244353%24%20%5Cu4e14%20%240%20%5C%5Cle%20x%20%3C%20998244353%24%20%5Cu3002%5Cuff08%5Cu53ef%5Cu4ee5%5Cu8bc1%5Cu660e%5Cu8fd9%5Cu6837%5Cu7684%5Cu6574%5Cu6570%20%24x%24%20%5Cu662f%5Cu552f%5Cu4e00%5Cu7684%5Cuff09%5Cn%22%2C%22samples%22%3A%5B%5B%223%5Cn1%202%203%5Cn6%5Cn0%202%201%201%5Cn1%201%202%5Cn0%202%201%201%5Cn0%203%201%201%5Cn1%201%202%5Cn1%203%201%202%203%22%2C%221%5Cn0%5Cn499122177%200%20499122177%5Cn1%200%202%5Cn%22%5D%2C%5B%223%5Cn1%201%201%5Cn4%5Cn0%202%201%202%5Cn1%202%201%202%5Cn0%203%202%203%5Cn1%203%201%202%203%22%2C%22249561089%20748683265%5Cn804141285%20887328314%20305019108%5Cn1%20499122177%20332748118%5Cn%22%5D%5D%2C%22hint%22%3A%22%23%23%23%20%5Cu6837%5Cu4f8b%5Cu89e3%5Cu91ca%201%5Cn%5Cu9488%5Cu9488%5Cu6309%5Cu987a%5Cu5e8f%5Cu65bd%5Cu653e%5Cu5982%5Cu4e0b%5Cu6280%5Cu80fd%5Cuff1a%5Cn%5Cn1.%20%5Cu5bf9%5Cu654c%5Cu65b9%5Cu5355%5Cu4f4d%20%242%24%20%5Cu65bd%5Cu653e%5Cu6280%5Cu80fd%5Cu9501%5Cu5b9a%5Cuff1a%5Cu4ee5%20%241%24%20%5Cu7684%5Cu6982%5Cu7387%5Cu5bf9%5Cu5176%5Cu9020%5Cu6210%20%241%24%20%5Cu70b9%5Cu4f24%5Cu5bb3%5Cu3002%5Cu6b64%5Cu65f6%20%242%24%20%5Cu53f7%5Cu654c%5Cu65b9%5Cu5355%5Cu4f4d%5Cu5fc5%5Cu5b9a%5Cu5269%5Cu4f59%20%241%24%20%5Cu70b9%5Cu751f%5Cu547d%5Cu503c%5Cu3002%5Cn2.%20%5Cu5bf9%5Cu654c%5Cu65b9%5Cu5355%5Cu4f4d%20%242%24%20%5Cu65bd%5Cu653e%5Cu6280%5Cu80fd%5Cu7ed3%5Cu754c%5Cuff1a%5Cuff08%5Cu7531%5Cu4e8e%20%242%24%20%5Cu53f7%5Cu654c%5Cu65b9%5Cu5355%5Cu4f4d%5Cu5c1a%5Cu5b58%5Cu6d3b%5Cuff0c%5Cuff09%5Cu5fc5%5Cu5b9a%5Cu547d%5Cu4e2d%20%242%24%20%5Cu53f7%5Cu5355%5Cu4f4d%5Cu3002%5Cn3.%20%5Cu5bf9%5Cu654c%5Cu65b9%5Cu5355%5Cu4f4d%20%242%24%20%5Cu65bd%5Cu653e%5Cu6280%5Cu80fd%5Cu9501%5Cu5b9a%5Cuff1a%5Cu4ee5%20%241%24%20%5Cu7684%5Cu6982%5Cu7387%5Cu5bf9%5Cu5176%5Cu9020%5Cu6210%20%241%24%20%5Cu70b9%5Cu4f24%5Cu5bb3%5Cu3002%5Cn4.%20%5Cu5bf9%5Cu654c%5Cu65b9%5Cu5355%5Cu4f4d%20%243%24%20%5Cu65bd%5Cu653e%5Cu6280%5Cu80fd%5Cu9501%5Cu5b9a%5Cuff1a%5Cu4ee5%20%241%24%20%5Cu7684%5Cu6982%5Cu7387%5Cu5bf9%5Cu5176%5Cu9020%5Cu6210%20%241%24%20%5Cu70b9%5Cu4f24%5Cu5bb3%5Cu3002%5Cu6b64%5Cu65f6%5Cu4e09%5Cu4e2a%5Cu654c%5Cu65b9%5Cu5355%5Cu4f4d%5Cu7684%5Cu751f%5Cu547d%5Cu503c%5Cu4e00%5Cu5b9a%5Cu5206%5Cu522b%5Cu4e3a%20%241%2C%200%20%2C2%24%20%5Cuff0c%5Cu654c%5Cu65b9%5Cu5355%5Cu4f4d%20%242%24%20%5Cu4e00%5Cu5b9a%5Cu6b7b%5Cu4ea1%5Cu3002%5Cn5.%20%5Cu5bf9%5Cu654c%5Cu65b9%5Cu5355%5Cu4f4d%20%242%24%20%5Cu65bd%5Cu653e%5Cu6280%5Cu80fd%5Cu7ed3%5Cu754c%5Cuff1a%5Cuff08%5Cu7531%5Cu4e8e%20%242%24%20%5Cu53f7%5Cu654c%5Cu65b9%5Cu5355%5Cu4f4d%5Cu5df2%5Cu6b7b%5Cu4ea1%5Cuff0c%5Cuff09%5Cu5fc5%5Cu5b9a%5Cu4e0d%5Cu547d%5Cu4e2d%5Cu4efb%5Cu4f55%5Cu5355%5Cu4f4d%5Cu3002%5Cn6.%20%5Cu5bf9%5Cu654c%5Cu65b9%5Cu5355%5Cu4f4d%20%241%2C%202%2C%203%24%20%5Cu65bd%5Cu653e%5Cu6280%5Cu80fd%5Cu7ed3%5Cu754c%5Cuff1a%5Cu547d%5Cu4e2d%5Cu654c%5Cu65b9%5Cu5355%5Cu4f4d%20%241%2C%203%24%20%5Cu7684%5Cu6982%5Cu7387%5Cu662f%5Cu76f8%5Cu7b49%5Cu7684%5Cuff0c%5Cu5373%5Cu5404%20%24%5C%5Cfrac%7B1%7D%7B2%7D%24%20%5Cu3002%20%5Cu6700%5Cu7ec8%5Cuff0c%5Cu4e09%5Cu4e2a%5Cu654c%5Cu65b9%5Cu5355%5Cu4f4d%5Cu7684%5Cu5269%5Cu4f59%5Cu751f%5Cu547d%5Cu503c%5Cu4e00%5Cu5b9a%5Cu4e3a%20%241%20%2C%200%20%2C%202%24%20%5Cu3002%5Cn%5Cn%23%23%23%20%5Cu6837%5Cu4f8b%5Cu89e3%5Cu91ca%202%5Cn%5Cu5bf9%5Cu4e8e%5Cu5404%5Cu7ed3%5Cu754c%5Cu6280%5Cu80fd%5Cu7684%5Cu5206%5Cu6790%5Cuff1a%5Cn%5Cn1.%20%5Cu7b2c%20%241%24%20%5Cu4e2a%5Cu7ed3%5Cu754c%5Cuff08%5Cu76ee%5Cu6807%5Cu4e3a%5Cu654c%5Cu65b9%5Cu5355%5Cu4f4d%20%241%2C2%24%20%5Cuff09%5Cuff1a%5Cn-%20%242%24%20%5Cu53f7%5Cu654c%5Cu65b9%5Cu5355%5Cu4f4d%5Cu5b58%5Cu6d3b%5Cu7684%5Cu6982%5Cu7387%5Cu4e3a%20%24%5C%5Cfrac%7B1%7D%7B2%7D%24%20%5Cuff0c%20%241%24%20%5Cu53f7%5Cu654c%5Cu65b9%5Cu5355%5Cu4f4d%5Cu5fc5%5Cu5b9a%5Cu5b58%5Cu6d3b%5Cu3002%5Cn-%20%5Cu5982%5Cu679c%20%242%24%20%5Cu53f7%5Cu654c%5Cu65b9%5Cu5355%5Cu4f4d%5Cu5b58%5Cu6d3b%5Cuff0c%5Cu90a3%5Cu4e48%5Cu7ed3%5Cu754c%5Cu547d%5Cu4e2d%20%241%20%2C%202%24%20%5Cu7684%5Cu6982%5Cu7387%5Cu76f8%5Cu7b49%5Cuff0c%5Cu5747%5Cu4e3a%20%24%5C%5Cfrac%7B1%7D%7B2%7D%24%20%5Cuff1b%5Cu5982%5Cu679c%20%242%24%20%5Cu53f7%5Cu654c%5Cu65b9%5Cu5355%5Cu4f4d%5Cu6b7b%5Cu4ea1%5Cuff0c%5Cu90a3%5Cu4e48%5Cu7ed3%5Cu754c%5Cu5fc5%5Cu5b9a%5Cu547d%5Cu4e2d%20%241%24%20%5Cu53f7%5Cu654c%5Cu65b9%5Cu5355%5Cu4f4d%5Cu3002%5Cn-%20%5Cu56e0%5Cu6b64%5Cuff1a%5Cu547d%5Cu4e2d%20%241%24%20%5Cu53f7%5Cu654c%5Cu65b9%5Cu5355%5Cu4f4d%5Cu7684%5Cu6982%5Cu7387%5Cu4e3a%20%24%5C%5Cfrac%7B1%7D%7B2%7D%20%5C%5Ctimes%201%20%2B%20%5C%5Cfrac%7B1%7D%7B2%7D%20%5C%5Ctimes%20%5C%5Cfrac%7B1%7D%7B2%7D%20%3D%20%5C%5Cfrac%7B3%7D%7B4%7D%24%20%5Cuff1b%5Cu547d%5Cu4e2d%20%242%24%20%5Cu53f7%5Cu654c%5Cu65b9%5Cu5355%5Cu4f4d%5Cu7684%5Cu6982%5Cu7387%5Cu4e3a%20%24%5C%5Cfrac%7B1%7D%7B2%7D%20%5C%5Ctimes%200%20%2B%20%5C%5Cfrac%7B1%7D%7B2%7D%20%5C%5Ctimes%20%5C%5Cfrac%7B1%7D%7B2%7D%20%3D%20%5C%5Cfrac%7B1%7D%7B4%7D%24%20%5Cu3002%5Cn2.%20%5Cu7b2c%20%242%24%20%5Cu4e2a%5Cu7ed3%5Cu754c%5Cuff08%5Cu76ee%5Cu6807%5Cu4e3a%5Cu654c%5Cu65b9%5Cu5355%5Cu4f4d%20%241%2C%202%2C%203%24%20%5Cuff09%5Cuff1a%5Cn-%20%5Cu4e09%5Cu4e2a%5Cu654c%5Cu65b9%5Cu5355%5Cu4f4d%5Cu5b58%5Cu6d3b%5Cu7684%5Cu6982%5Cu7387%5Cu5206%5Cu522b%5Cu4e3a%20%241%2C%20%5C%5Cfrac%7B1%7D%7B2%7D%20%2C%20%5C%5Cfrac%7B1%7D%7B3%7D%24%20%5Cu3002%5Cn-%20%241%20%2C%202%20%2C%203%24%20%5Cu540c%5Cu65f6%5Cu5b58%5Cu6d3b%5Cu7684%5Cu6982%5Cu7387%5Cu4e3a%20%24%5C%5Cfrac%7B1%7D%7B6%7D%24%20%5Cuff1b%5Cu53ea%5Cu6709%20%241%2C%202%24%20%5Cu5b58%5Cu6d3b%5Cu7684%5Cu6982%5Cu7387%5Cu4e3a%20%24%5C%5Cfrac%7B1%7D%7B3%7D%24%20%5Cuff1b%5Cu53ea%5Cu6709%20%241%20%2C%203%24%20%5Cu5b58%5Cu6d3b%5Cu7684%5Cu6982%5Cu7387%5Cu4e3a%20%24%5C%5Cfrac%7B1%7D%7B6%7D%24%20%5Cuff1b%5Cu53ea%5Cu6709%20%241%24%20%5Cu5b58%5Cu6d3b%5Cu7684%5Cu6982%5Cu7387%5Cu4e3a%20%24%5C%5Cfrac%7B1%7D%7B3%7D%24%20%5Cu3002%5Cn-%20%5Cu56e0%5Cu6b64%5Cuff1a%5Cu547d%5Cu4e2d%20%241%24%20%5Cu53f7%5Cu654c%5Cu65b9%5Cu5355%5Cu4f4d%5Cu7684%5Cu6982%5Cu7387%5Cu4e3a%20%24%5C%5Cfrac%7B1%7D%7B6%7D%20%5C%5Ctimes%20%5C%5Cfrac%7B1%7D%7B3%7D%20%2B%20%28%5C%5Cfrac%7B1%7D%7B3%7D%2B%5C%5Cfrac%7B1%7D%7B6%7D%29%20%5C%5Ctimes%20%5C%5Cfrac%7B1%7D%7B2%7D%2B%20%5C%5Cfrac%7B1%7D%7B3%7D%20%5C%5Ctimes%201%20%3D%20%5C%5Cfrac%7B23%7D%7B36%7D%24%20%5Cuff1b%5Cu547d%5Cu4e2d%20%242%24%20%5Cu53f7%5Cu654c%5Cu65b9%5Cu5355%5Cu4f4d%5Cu7684%5Cu6982%5Cu7387%5Cu4e3a%20%24%5C%5Cfrac%7B1%7D%7B6%7D%20%5C%5Ctimes%20%5C%5Cfrac%7B1%7D%7B3%7D%20%2B%20%5C%5Cfrac%7B1%7D%7B3%7D%20%5C%5Ctimes%20%5C%5Cfrac%7B1%7D%7B2%7D%20%3D%20%5C%5Cfrac%7B2%7D%7B9%7D%24%20%5Cuff1b%5Cu547d%5Cu4e2d%20%243%24%20%5Cu53f7%5Cu654c%5Cu65b9%5Cu5355%5Cu4f4d%5Cu7684%5Cu6982%5Cu7387%5Cu4e3a%20%24%5C%5Cfrac%7B1%7D%7B6%7D%20%5C%5Ctimes%20%5C%5Cfrac%7B1%7D%7B3%7D%20%2B%20%5C%5Cfrac%7B1%7D%7B6%7D%20%5C%5Ctimes%20%5C%5Cfrac%7B1%7D%7B2%7D%20%3D%20%5C%5Cfrac%7B5%7D%7B36%7D%24%20%5Cu3002%20%5Cu6700%5Cu7ec8%5Cuff0c%5Cu4e09%5Cu4e2a%5Cu654c%5Cu65b9%5Cu5355%5Cu4f4d%5Cu7684%5Cu5269%5Cu4f59%5Cu751f%5Cu547d%5Cu503c%5Cu7684%5Cu671f%5Cu671b%5Cu503c%5Cu4e3a%20%241%20%2C%20%5C%5Cfrac%7B1%7D%7B2%7D%20%2C%20%5C%5Cfrac%7B1%7D%7B3%7D%24%20%5Cu3002%5Cn%5Cn%5Cn%23%23%23%20%5Cu6570%5Cu636e%5Cu8303%5Cu56f4%5Cn%5Cn%5Cu6211%5Cu4eec%5Cu8bb0%20%24C%24%20%5Cu4e3a%5Cu7ed3%5Cu754c%5Cu6280%5Cu80fd%5Cu7684%5Cu6570%5Cu91cf%5Cu3002%5Cn%5Cn%5Cu6d4b%5Cu8bd5%5Cu70b9%5Cu7f16%5Cu53f7%7Cn%3D%7CQ%3D%7CC%3D%7Cu%2Cv%7C%5Cu5176%5Cu4ed6%5Cu9650%5Cu5236%5Cn-%7C-%7C-%7C-%7C-%7C-%5Cn1%7C5%7C21%7C6%7Cu%3Cv%7C%5Cu65e0%5Cn2%7C60%7C199992%7C500%7Cu%3Cv%7C%5Cu6240%5Cu6709%5Cu00a0p%20%5Cu5747%5Cu76f8%5Cu7b49%5Cn3%7C60%7C23%7C6%7Cu%3Cv%7C%5Cu6240%5Cu6709m_i%20%3D1%5Cn4%7C60%7C199994%7C500%7Cu%3Cv%7C%5Cu65e0%5Cn5%7C60%7C199995%7C500%7Cu%3Cv%7C%5Cu65e0%5Cn6%7C60%7C199996%7C0%7Cu%3Cv%7C%5Cu65e0%5Cn7%7C60%7C199997%7C500%7Cu%3Dv%7C%5Cu65e0%5Cn8%7C200%7C199998%7C1000%7Cu%3Cv%7C%5Cu65e0%5Cn9%7C200%7C199999%7C1000%7Cu%3Cv%7C%5Cu65e0%5Cn10%7C200%7C200000%7C1000%7Cu%3Cv%7C%5Cu65e0%5Cn%5Cn%5Cu5bf9%5Cu4e8e%5Cu6240%5Cu6709%5Cu6d4b%5Cu8bd5%5Cu70b9%5Cuff0c%5Cu4fdd%5Cu8bc1%20%24n%20%5C%5Cle%20200%20%2C%20Q%20%5C%5Cle%20200000%20%2C%20C%20%5C%5Cle%201000%20%2C%20m_i%20%5C%5Cle%20100%24%20%5Cu3002%5Cn%5Cn%5Cu63d0%5Cu793a%5Cn%5CnQ%20%5Cu7684%5Cu4e2a%5Cu4f4d%5Cu53ef%5Cu4ee5%5Cu5e2e%5Cu52a9%5Cu4f60%5Cu5feb%5Cu901f%5Cu786e%5Cu5b9a%5Cu6d4b%5Cu8bd5%5Cu70b9%5Cu7684%5Cu7f16%5Cu53f7%5Cu3002%5Cn%5Cu6d4b%5Cu8bd5%5Cu70b9%5Cu987a%5Cu5e8f%5Cu53ef%5Cu80fd%5Cu4e0e%5Cu96be%5Cu5ea6%5Cu65e0%5Cu5173%5Cu3002%5Cn%5Cn%5Cu611f%5Cu8c22%20%40%5Cu548c%5Cu6cc9%5Cu6b63%5Cu5b97%20%5Cu63d0%5Cu4f9b%5Cu9898%5Cu9762%20%22%2C%22provider%22%3A%7B%22uid%22%3A50167%2C%22name%22%3A%22Imagine%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3Anull%2C%22isAdmin%22%3Afalse%2C%22color%22%3A%22Blue%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%2C2000%2C2000%2C2000%2C2000%2C2000%2C2000%2C2000%2C2000%2C2000%5D%2C%22memory%22%3A%5B512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22tags%22%3A%5B5%2C35%2C52%2C108%2C111%2C270%2C319%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A328%2C%22totalAccepted%22%3A91%2C%22pid%22%3A%22P4564%22%2C%22title%22%3A%22%5BCTSC2018%5D%5Cu5047%5Cu9762%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A103814%2C%22title%22%3A%22%5Cu6c42%5Cu8865%5Cu6570%5Cu636e%22%2C%22forum%22%3A%7B%22id%22%3A25743%2C%22name%22%3A%22P4564%20%5BCTSC2018%5D%5Cu5047%5Cu9762%22%2C%22slug%22%3A%22P4564%22%7D%7D%2C%7B%22id%22%3A62068%2C%22title%22%3A%22%5Cu4e3a%5Cu4ec0%5Cu4e48%5Cu65e0%5Cu6cd5%5Cu8bc4%5Cu6d4b%22%2C%22forum%22%3A%7B%22id%22%3A25743%2C%22name%22%3A%22P4564%20%5BCTSC2018%5D%5Cu5047%5Cu9762%22%2C%22slug%22%3A%22P4564%22%7D%7D%2C%7B%22id%22%3A42476%2C%22title%22%3A%22%5Cu5efa%5Cu8bae%5Cu4fee%5Cu6539%5Cu65f6%5Cu9650%22%2C%22forum%22%3A%7B%22id%22%3A25743%2C%22name%22%3A%22P4564%20%5BCTSC2018%5D%5Cu5047%5Cu9762%22%2C%22slug%22%3A%22P4564%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P4602%22%2C%22title%22%3A%22%5BCTSC2018%5D%5Cu6df7%5Cu5408%5Cu679c%5Cu6c41%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P4565%22%2C%22title%22%3A%22%5BCTSC2018%5D%5Cu66b4%5Cu529b%5Cu5199%5Cu6302%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P4558%22%2C%22title%22%3A%22%5BJSOI2018%5D%5Cu673a%5Cu5668%5Cu4eba%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P4606%22%2C%22title%22%3A%22%5BSDOI2018%5D%5Cu6218%5Cu7565%5Cu6e38%5Cu620f%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P4620%22%2C%22title%22%3A%22%5BSDOI2018%5D%5Cu8363%5Cu8a89%5Cu79f0%5Cu53f7%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22%5BCTSC2018%5D%5Cu5047%5Cu9762%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573286098;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>[CTSC2018]假面</h1>
<h2>题目背景</h2>
<div># 本题数据损坏无法评测
针针是绿绿的好朋友。</div>
<h2>题目描述</h2>
<div>针针喜欢玩一款叫做 DotA (**D**efense **o**f **t**he **A**lgorithm) 的游戏，在这个游戏中，针针会操纵自己的英雄与队友一起对抗另一支队伍。
针针在 DotA 中最喜欢使用的英雄叫做假面（Faceless），该英雄有 $2$ 个技能：
- 锁定：对一名指定的敌方单位使用，以 $p$ 的概率对该单位造成 $1$ 点伤害（使其减少 $1$ 点生命值）。
- 结界：在一片区域施放结界，让该区域内的所有其他单位无法动弹。
在游戏中，如果一个单位的生命值降至 $0$ 或 $0$ 以下，那么该单位就会死亡。
针针操纵假面的水平一般，因此他决定勤加练习。现在有 $n$ 个敌方单位（编号从 $1$ 至 $n$），编号为 $i$ 的敌方单位有 $h_i$ 点生命值。
针针已经安排好了练习的计划，他会按顺序施放 $Q$ 个技能：
- 对于锁定技能：针针会指定一个敌方单位 $id$ ，并对它施放。由于决定概率系数 $p$ 的因素很多，因此每次的 $p$ 都不一定相同。
特别地，如果该敌方单位已经死亡，那么该技能不会造成任何效果。
- 对于结界技能：针针会希望对 $k$ 个指定的敌方单位施放，但由于针针并不擅长施放该技能，因此他只能命中恰好 $1$ 个敌方单位。命中每个存活的敌方单位的概率是相等的（也就是说已经死亡的敌方单位不会有任何影响）。
特别地，如果这 $k$ 个敌方单位均已死亡，那么该技能同样不会命中任何敌方单位。
现在，围观针针进行练习的绿绿想知道：
1. 对于针针施放的每个结界技能，它命中各敌人的概率分别是多少。
2. 在针针的所有技能施放完毕后，所有敌方单位剩余生命值的期望分别是多少。
由于绿绿还要围观针针训练，所以请你帮他解决这两个问题。
为了防止精度误差，对于所有需要输出的数值，请输出其在模 $998244353$ 意义下的值。
由于结界为假面的终极技能，因此针针施放该技能的次数不会太多。具体请见”子任务“。</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>第 $1$ 行为 $1$ 个正整数 $n$ ，表示敌方单位的数量。
第 $2$ 行为 $n$ 个正整数 $m_1,\cdots , m_n$，依次表示各敌方单位的初始生命值。
第 $3$ 行为 $1$ 个非负整数 $Q$ ，表示针针施放技能的数量。
第 $4$ 行至第 $Q + 3$ 行，每行描述一个技能，第 $i + 3$ 行描述第 $i$ 个技能。
每行的开头为一个整数 $op$ ，表示该技能的种类。
如果 $op = 0$ ，则表示锁定技能。并在此后跟随着 $3$ 个正整数 $id , u , v$ ，表示技能施放的目标为 $id$ ，技能命中的概率为 $p = \frac{u}{v}$ 。（保证 $1\le id \le n , 0 < u \le v < 998244353$ ）
如果 $op = 1$ ，则表示结界技能。并在此后跟随着 $1$ 个正整数 $k$ 表示技能施放的目标数量，随后还有额外的 $k$ 个数 $id_1,\cdots,id_k$ 描述技能施放的所有目标。（保证所有 $1 \le id_i \le n$ 互不相同） 对于每一行，如果行内包含多个数，则用单个空格将它们隔开。</div>
<h3>输出格式</h3>
<br />
<div>输出包括 $C + 1$ 行（其中 $C$ 为结界技能的数量）：
前 $C$ 行依次对应每个结界技能，对于每行：
输出 $k$ 个数，第 $i$ 个数表示结界命中敌方单位 $id_i$ 的概率。
第 $C + 1$ 行输出 $n$ 个数，第 $i$ 个数表示在所有技能施放完毕后，敌方单位 $i$ 剩余生命值的期望值。
对于每一行，如果行内包含多个数，则用单个空格将它们隔开。
对于所有数值，请输出它们对 $998244353$ 取模的结果：即设答案化为最简分式后的形式为 $\frac{a}{b}$ ，其中 $a$ 和 $b$ 的互质。输出整数 $x$ 使得 $bx \equiv a\bmod 998244353$ 且 $0 \le x < 998244353$ 。（可以证明这样的整数 $x$ 是唯一的）
</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>3
1 2 3
6
0 2 1 1
1 1 2
0 2 1 1
0 3 1 1
1 1 2
1 3 1 2 3</code></pre>
<h3>输出样例 #1</h3>
<pre><code>1
0
499122177 0 499122177
1 0 2
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>3
1 1 1
4
0 2 1 2
1 2 1 2
0 3 2 3
1 3 1 2 3</code></pre>
<h3>输出样例 #2</h3>
<pre><code>249561089 748683265
804141285 887328314 305019108
1 499122177 332748118
</code></pre>
<h2>说明</h2>
<div>### 样例解释 1
针针按顺序施放如下技能：
1. 对敌方单位 $2$ 施放技能锁定：以 $1$ 的概率对其造成 $1$ 点伤害。此时 $2$ 号敌方单位必定剩余 $1$ 点生命值。
2. 对敌方单位 $2$ 施放技能结界：（由于 $2$ 号敌方单位尚存活，）必定命中 $2$ 号单位。
3. 对敌方单位 $2$ 施放技能锁定：以 $1$ 的概率对其造成 $1$ 点伤害。
4. 对敌方单位 $3$ 施放技能锁定：以 $1$ 的概率对其造成 $1$ 点伤害。此时三个敌方单位的生命值一定分别为 $1, 0 ,2$ ，敌方单位 $2$ 一定死亡。
5. 对敌方单位 $2$ 施放技能结界：（由于 $2$ 号敌方单位已死亡，）必定不命中任何单位。
6. 对敌方单位 $1, 2, 3$ 施放技能结界：命中敌方单位 $1, 3$ 的概率是相等的，即各 $\frac{1}{2}$ 。 最终，三个敌方单位的剩余生命值一定为 $1 , 0 , 2$ 。
### 样例解释 2
对于各结界技能的分析：
1. 第 $1$ 个结界（目标为敌方单位 $1,2$ ）：
- $2$ 号敌方单位存活的概率为 $\frac{1}{2}$ ， $1$ 号敌方单位必定存活。
- 如果 $2$ 号敌方单位存活，那么结界命中 $1 , 2$ 的概率相等，均为 $\frac{1}{2}$ ；如果 $2$ 号敌方单位死亡，那么结界必定命中 $1$ 号敌方单位。
- 因此：命中 $1$ 号敌方单位的概率为 $\frac{1}{2} \times 1 + \frac{1}{2} \times \frac{1}{2} = \frac{3}{4}$ ；命中 $2$ 号敌方单位的概率为 $\frac{1}{2} \times 0 + \frac{1}{2} \times \frac{1}{2} = \frac{1}{4}$ 。
2. 第 $2$ 个结界（目标为敌方单位 $1, 2, 3$ ）：
- 三个敌方单位存活的概率分别为 $1, \frac{1}{2} , \frac{1}{3}$ 。
- $1 , 2 , 3$ 同时存活的概率为 $\frac{1}{6}$ ；只有 $1, 2$ 存活的概率为 $\frac{1}{3}$ ；只有 $1 , 3$ 存活的概率为 $\frac{1}{6}$ ；只有 $1$ 存活的概率为 $\frac{1}{3}$ 。
- 因此：命中 $1$ 号敌方单位的概率为 $\frac{1}{6} \times \frac{1}{3} + (\frac{1}{3}+\frac{1}{6}) \times \frac{1}{2}+ \frac{1}{3} \times 1 = \frac{23}{36}$ ；命中 $2$ 号敌方单位的概率为 $\frac{1}{6} \times \frac{1}{3} + \frac{1}{3} \times \frac{1}{2} = \frac{2}{9}$ ；命中 $3$ 号敌方单位的概率为 $\frac{1}{6} \times \frac{1}{3} + \frac{1}{6} \times \frac{1}{2} = \frac{5}{36}$ 。 最终，三个敌方单位的剩余生命值的期望值为 $1 , \frac{1}{2} , \frac{1}{3}$ 。
### 数据范围
我们记 $C$ 为结界技能的数量。
测试点编号|n=|Q=|C=|u,v|其他限制
-|-|-|-|-|-
1|5|21|6|u<v|无 2|60|199992|500|u<v|所有 p 均相等 3|60|23|6|u<v|所有m_i=1 4|60|199994|500|u<v|无 5|60|199995|500|u<v|无 6|60|199996|0|u<v|无 7|60|199997|500|u=v|无 8|200|199998|1000|u<v|无 9|200|199999|1000|u<v|无 10|200|200000|1000|u<v|无 对于所有测试点，保证 $n \le 200 , Q \le 200000 , C \le 1000 , m_i \le 100$ 。 提示 Q 的个位可以帮助你快速确定测试点的编号。 测试点顺序可能与难度无关。 感谢 @和泉正宗 提供题面 </div>
</article>
</div>
</div>
</body>
</html>
