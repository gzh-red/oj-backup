<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>[ZJOI2018]胖 - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573381488:Js3bJjnne8H3/ukjwzIqxTMqkcZaBFLdeKoK4Qe4c5A=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22Cedyks%20%5Cu662f%5Cu4e5d%5Cu6761%5Cu53ef%5Cu601c%5Cu7684%5Cu597d%5Cu670b%5Cu53cb%5Cuff08%5Cu53ef%5Cu80fd%5Cu8fd9%5Cu573a%5Cu6bd4%5Cu8d5b%5Cu516c%5Cu5f00%5Cu4ee5%5Cu540e%5Cu5c31%5Cu4e0d%5Cu662f%5Cu4e86%5Cuff09%5Cuff0c%5Cu4e5f%5Cu662f%5Cu8fd9%5Cu9898%5Cu7684%5Cu4e3b%5Cu4eba%5Cu516c%5Cu3002%22%2C%22description%22%3A%22Cedyks%20%5Cu662f%5Cu4e00%5Cu4e2a%5Cu5bcc%5Cu6709%5Cu7684%5Cu7537%5Cu5b69%5Cu5b50%5Cu3002%5Cu4ed6%5Cu4f4f%5Cu5728%5Cu8457%5Cu540d%5Cu7684The%20Place%5Cuff08%5Cu5bab%5Cu6bbf%5Cuff09%5Cu4e2d%5Cu3002%5Cn%5CnCedyks%20%5Cu662f%5Cu4e00%5Cu4e2a%5Cu52aa%5Cu529b%5Cu7684%5Cu7537%5Cu5b69%5Cu5b50%5Cu3002%5Cu4ed6%5Cu6bcf%5Cu5929%5Cu90fd%5Cu505a%5Cu7740%5Cu4e0d%5Cu4e00%5Cu6837%5Cu7684%5Cu9898%5Cu6765%5Cu953b%5Cu70bc%5Cu4ed6%5Cu7684The%20Salt%5Cuff08%5Cu7075%5Cu9b42%5Cuff09%5Cu3002%5Cn%5Cn%5Cu8fd9%5Cu5929%5Cuff0c%5Cu4ed6%5Cu6253%5Cu7b97%5Cu5728%5Cu4ed6%5Cu7684%5Cu5bab%5Cu6bbf%5Cu5916%5Cu56f4%5Cu4fee%5Cu7b51%5Cu4e00%5Cu9053%5Cu57ce%5Cu5899%5Cuff0c%5Cu57ce%5Cu5899%5Cu4e0a%5Cu6709%24n%24%20%5Cu5ea7%5Cu77ad%5Cu671b%5Cu5854%5Cu3002%5Cu4f60%5Cu53ef%5Cu4ee5%5Cu628a%5Cu57ce%5Cu5899%5Cu770b%5Cu505a%5Cu4e00%5Cu6761%5Cu7ebf%5Cu6bb5%5Cuff0c%5Cu77ad%5Cu671b%5Cu5854%5Cu662f%5Cu7ebf%5Cu6bb5%5Cu4e0a%5Cu7684%24n%24%20%5Cu4e2a%5Cu70b9%5Cuff0c%5Cu5176%5Cu4e2d%241%24%20%5Cu548c%24n%24%20%5Cu5206%5Cu522b%5Cu4e3a%5Cu57ce%5Cu5899%5Cu7684%5Cu4e24%5Cu4e2a%5Cu7aef%5Cu70b9%5Cu3002%5Cu5176%5Cu4e2d%5Cu7b2c%24i%24%20%5Cu5ea7%5Cu77ad%5Cu671b%5Cu5854%5Cu548c%5Cu7b2c%24i%20%2B%201%24%20%5Cu5ea7%5Cu77ad%5Cu671b%5Cu5854%5Cu7684%5Cu8ddd%5Cu79bb%5Cu4e3a%24w_i%24%5Cuff0c%5Cu4ed6%5Cu4eec%5Cu4e4b%5Cu95f4%5Cu7684%5Cu9053%5Cu8def%5Cu662f%5Cu53cc%5Cu5411%5Cu7684%5Cu3002%5Cn%5Cn%5Cu57ce%5Cu5899%5Cu5f88%5Cu5feb%5Cu5c31%5Cu4fee%5Cu5efa%5Cu597d%5Cu4e86%5Cuff0c%5Cu73b0%5Cu5728Cedyks%20%5Cu5f00%5Cu59cb%5Cu8ba1%5Cu5212%5Cu4fee%5Cu7b51%5Cu4ed6%5Cu7684%5Cu5bab%5Cu6bbf%5Cu5230%5Cu57ce%5Cu5899%5Cu7684%5Cu9053%5Cu8def%5Cu3002%5Cu56e0%5Cu4e3a%5Cu8fd9%5Cu9898%5Cu7684%5Cu9898%5Cu76ee%5Cu540d%5Cu79f0%5Cuff0cCedyks%20%5Cu6253%5Cu7b97%5Cu7528%5Cu4ed6%5Cu7684%5Cu5bab%5Cu6bbf%5Cu5230%5Cu6bcf%5Cu4e00%5Cu4e2a%5Cu77ad%5Cu671b%5Cu5854%5Cu7684%5Cu6700%5Cu77ed%5Cu9053%5Cu8def%5Cu4e4b%5Cu548c%5Cu6765%5Cu8861%5Cu91cf%5Cu4e00%5Cu4e2a%5Cu4fee%5Cu5efa%5Cu8ba1%5Cu5212%5Cu3002%5Cn%5Cn%5Cu73b0%5Cu5728Cedyks%20%5Cu624b%5Cu4e0a%5Cu6709%24m%24%20%5Cu4e2a%5Cu8bbe%5Cu8ba1%5Cu65b9%5Cu6848%5Cuff0c%5Cu7b2c%24k%24%20%5Cu4e2a%5Cu8bbe%5Cu8ba1%5Cu65b9%5Cu6848%5Cu4f1a%5Cu5728%5Cu5bab%5Cu6bbf%5Cu548c%5Cu77ad%5Cu671b%5Cu5854%5Cu4e4b%5Cu95f4%5Cu4fee%5Cu5efa%24T_k%24%20%5Cu6761%5Cu53cc%5Cu5411%5Cu9053%5Cu8def%5Cuff0c%5Cu7b2c%24i%24%20%5Cu6761%5Cu9053%5Cu8def%5Cu8fde%5Cu63a5%5Cu7740%5Cu77ad%5Cu671b%5Cu5854%24a_i%24%5Cuff0c%5Cu957f%5Cu5ea6%5Cu4e3a%24l_i%24%5Cu3002%5Cn%5Cn%5Cu8ba1%5Cu7b97%5Cu5230%5Cu6bcf%5Cu4e00%5Cu4e2a%5Cu77ad%5Cu671b%5Cu5854%5Cu7684%5Cu6700%5Cu77ed%5Cu8def%5Cu4e4b%5Cu548c%5Cu662f%5Cu4e00%5Cu4e2a%5Cu7e41%5Cu91cd%5Cu7684%5Cu5de5%5Cu7a0b%5Cuff0c%5Cu672c%5Cu6765Cedyks%20%5Cu60f3%5Cu7528%5Cu5e7f%5Cu4e3a%5Cu6d41%5Cu4f20%5Cu7684SPFA%5Cu7b97%5Cu6cd5%5Cu6765%5Cu6c42%5Cu89e3%5Cuff0c%5Cu4f46%5Cu662f%5Cu56e0%5Cu4e3a%5Cu4ed6%5Cu7684butter%5Cuff08%5Cu7f13%5Cu51b2%5Cu533a%5Cuff09%5Cu5b9e%5Cu5728%5Cu662f%5Cu592a%5Cu5c0f%5Cu4e86%5Cuff0c%5Cu4ed6%5Cu53ea%5Cu80fd%5Cu8f6c%5Cu800c%5Cu7528%5Cu539f%5Cu59cb%5Cu7684%5Cu8d1d%5Cu5c14%5Cu798f%5Cu7279%5Cu66fc%5Cu7b97%5Cu6cd5%5Cu6765%5Cu8ba1%5Cu7b97%5Cuff0c%5Cu7b97%5Cu6cd5%5Cu7684%5Cu6d41%5Cu7a0b%5Cu5927%5Cu6982%5Cu5982%5Cu4e0b%5Cuff1a%5Cn%5Cn1.%20%5Cu5b9a%5Cu4e49%5Cu5bab%5Cu6bbf%5Cu662f%240%24%20%5Cu53f7%5Cu70b9%5Cuff0c%5Cu7b2c%24i%24%20%5Cu4e2a%5Cu77ad%5Cu671b%5Cu5854%5Cu662f%24i%24%20%5Cu53f7%5Cu70b9%5Cuff0c%5Cu53cc%5Cu5411%5Cu8fb9%24%28u_i%2C%20v_i%2C%20l_i%29%24%20%5Cu4e3a%5Cu4e00%5Cu6761%5Cu8fde%5Cu63a5%24u_i%24%20%5Cu548c%24v_i%24%20%5Cu7684%5Cu53cc%5Cu5411%5Cu9053%5Cu8def%5Cu3002%5Cu4ee4%24d%24%20%5Cu4e3a%5Cu8ddd%5Cu79bb%5Cu6570%5Cu7ec4%5Cuff0c%5Cu6700%5Cu5f00%5Cu59cb%24d_0%20%3D%200%2C%20d_i%20%3D%2010%5E%7B18%7D%28i%20%5Cu2208%20%5B1%2C%20n%5D%29%24%5Cu3002%5Cn%5Cn2.%20%5Cu4ee4%5Cu8f85%5Cu52a9%5Cu6570%5Cu7ec4%24c%20%3D%20d%24%5Cu3002%5Cu4f9d%5Cu6b21%5Cu5bf9%5Cu4e8e%5Cu6bcf%5Cu4e00%5Cu6761%5Cu8fb9%24%28ui%2C%20vi%2Cwi%29%24%20%5Cu8fdb%5Cu884c%5Cu589e%5Cu5e7f%5Cuff0c%24c_%7Bu_i%7D%20%3D%20min%28c_%7Bu_i%7D%20%2C%20d_%7Bv_i%7D%20%2B%20w_i%29%24%5Cuff0c%24c_%7Bv_i%7D%20%3D%20min%28c_%7Bv_i%7D%20%2C%20d_%7Bu_i%7D%20%2B%20w_i%29%24%5Cu3002%5Cn%5Cn3.%20%5Cu4ee4%24t%24%20%5Cu4e3a%24c%24%20%5Cu548c%24d%24%20%5Cu4e2d%5Cu4e0d%5Cu4e00%5Cu6837%5Cu7684%5Cu4f4d%5Cu7f6e%5Cu4e2a%5Cu6570%5Cuff0c%5Cu5373%5Cu4ee4%24S%20%3D%20%5C%5C%7Bi%7Cc_i%5Cu2260d_i%5C%5C%7D%24%5Cuff0c%5Cu5219%24t%20%3D%20%7CS%7C%24%5Cu3002%5Cu82e5%24t%20%3D%200%24%5Cuff0c%5Cu8bf4%5Cu660e%24d%24%5Cu5c31%5Cu662f%5Cu6700%5Cu7ec8%5Cu7684%5Cu6700%5Cu77ed%5Cu8def%5Cuff0c%5Cu7b97%5Cu6cd5%5Cu7ed3%5Cu675f%5Cu3002%5Cu5426%5Cu5219%5Cu4ee4%24d%20%3D%20c%24%5Cuff0c%5Cu56de%5Cu5230%5Cu7b2c%5Cu4e8c%5Cu6b65%5Cu3002%5Cn%5Cn%5Cu56e0%5Cu4e3a%5Cu9700%5Cu8981%5Cu8ba1%5Cu7b97%5Cu7684%5Cu8bbe%5Cu8ba1%5Cu65b9%5Cu6848%5Cu5b9e%5Cu5728%5Cu662f%5Cu592a%5Cu591a%5Cu4e86%5Cuff0c%5Cu6240%5Cu4ee5Cedyks%20%5Cu96c7%5Cu4f63%5Cu4e86%5Cu4e00%5Cu4e9b%5Cu4eba%5Cu6765%5Cu5e2e%5Cu4ed6%5Cu8fdb%5Cu884c%5Cu8ba1%5Cu7b97%5Cu3002%5Cu4e3a%5Cu4e86%5Cu907f%5Cu514d%5Cu8fd9%5Cu4e9b%5Cu4eba%5Cu7528%5Cu634f%5Cu9020%5Cu51fa%5Cu6765%5Cu7684%5Cu6570%5Cu636e%5Cu5077%5Cu61d2%5Cuff0c%5Cu4ed6%5Cu5b9a%5Cu4e49%5Cu4e00%5Cu4e2a%5Cu8bbe%5Cu8ba1%5Cu65b9%5Cu6848%5Cu7684%5Cu6821%5Cu9a8c%5Cu503c%5Cu4e3a%5Cu5728%5Cu8fd9%5Cu4e2a%5Cu65b9%5Cu6848%5Cu4e0a%5Cu8fd0%5Cu884c%5Cu8d1d%5Cu5c14%5Cu798f%5Cu7279%5Cu66fc%5Cu7b97%5Cu6cd5%5Cu6bcf%5Cu4e00%5Cu6b21%5Cu8fdb%5Cu5165%5Cu7b2c%5Cu4e09%5Cu6b65%24t%24%20%5Cu7684%5Cu548c%5Cu3002%5Cu4ed6%5Cu4f1a%5Cu8ba9%5Cu597d%5Cu51e0%5Cu4e2a%5Cu96c7%5Cu4f63%5Cu6765%5Cu7684%5Cu4eba%5Cu8ba1%5Cu7b97%5Cu540c%5Cu6837%5Cu7684%5Cu8bbe%5Cu8ba1%5Cu65b9%5Cu6848%5Cuff0c%5Cu5e76%5Cu6bd4%5Cu5bf9%5Cu6bcf%5Cu4e00%5Cu4e2a%5Cu4eba%5Cu7ed9%5Cu51fa%5Cu7684%5Cu6821%5Cu9a8c%5Cu503c%5Cu3002%5Cn%5Cn%5Cu4f60%5Cu662fCedyks%20%5Cu96c7%5Cu4f63%5Cu6765%5Cu7684%5Cu82e6%5Cu529b%5Cu4e4b%5Cu4e00%5Cuff0c%5Cu806a%5Cu660e%5Cu7684%5Cu4f60%5Cu53d1%5Cu73b0%5Cu5728%5Cu8fd9%5Cu4e2a%5Cu60c5%5Cu5f62%5Cu4e0b%5Cu8ba1%5Cu7b97%5Cu6700%5Cu77ed%5Cu8def%5Cu7684%5Cu957f%5Cu5ea6%5Cu7684%5Cu548c%5Cu662f%5Cu4e00%5Cu4ef6%5Cu975e%5Cu5e38%5Cu7b80%5Cu5355%5Cu7684%5Cu4e8b%5Cu60c5%5Cu3002%5Cu4f46%5Cu662f%5Cu5bc4%5Cu4eba%5Cu7bf1%5Cu4e0b%5Cu4e0d%5Cu5f97%5Cu4e0d%5Cu4f4e%5Cu5934%5Cuff0c%5Cu4f60%5Cu4e0d%5Cu5f97%5Cu4e0d%5Cu518d%5Cu8ba1%5Cu7b97%5Cu51fa%5Cu6bcf%5Cu4e00%5Cu4e2a%5Cu65b9%5Cu6848%5Cu7684%5Cu6821%5Cu9a8c%5Cu503c%5Cu6765%5Cu4ea4%5Cu5dee%5Cu3002%22%2C%22inputFormat%22%3A%22%5Cu7b2c%5Cu4e00%5Cu884c%5Cu8f93%5Cu5165%5Cu4e24%5Cu4e2a%5Cu6574%5Cu6570%24n%2Cm%24%5Cuff0c%5Cu8868%5Cu793a%5Cu77ad%5Cu671b%5Cu5854%5Cu4e2a%5Cu6570%5Cu548c%5Cu8bbe%5Cu8ba1%5Cu65b9%5Cu6848%5Cu4e2a%5Cu6570%5Cu3002%5Cn%5Cn%5Cu63a5%5Cu4e0b%5Cu6765%5Cu4e00%5Cu884c%24n%20-%201%24%20%5Cu4e2a%5Cu6570%24w_i%24%5Cuff0c%5Cu8868%5Cu793a%5Cu77ad%5Cu671b%5Cu5854%24i%24%20%5Cu548c%24i%20%2B%201%24%20%5Cu4e4b%5Cu95f4%5Cu9053%5Cu8def%5Cu7684%5Cu957f%5Cu5ea6%5Cu3002%5Cn%5Cn%5Cu63a5%5Cu4e0b%5Cu6765%24m%24%20%5Cu884c%5Cuff0c%5Cu6bcf%5Cu884c%5Cu63cf%5Cu8ff0%5Cu4e00%5Cu4e2a%5Cu8bbe%5Cu8ba1%5Cu65b9%5Cu6848%5Cu3002%5Cu7b2c%5Cu4e00%5Cu4e2a%5Cu6574%5Cu6570%24K%24%20%5Cu8868%5Cu793a%5Cu8bbe%5Cu8ba1%5Cu65b9%5Cu6848%5Cu4e2d%5Cu7684%5Cu9053%5Cu8def%5Cu6570%5Cu91cf%5Cuff0c%5Cu63a5%5Cu4e0b%5Cu6765%24K%24%20%5Cu4e2a%5Cu6570%5Cu5bf9%24%28a_i%2C%20l_i%29%24%20%5Cu4e3a%5Cu4e00%5Cu6761%5Cu5bab%5Cu6bbf%5Cu5230%5Cu77ad%5Cu671b%5Cu5854%5Cu7684%5Cu8fb9%5Cu3002%22%2C%22outputFormat%22%3A%22%5Cu5bf9%5Cu4e8e%5Cu6bcf%5Cu4e00%5Cu4e2a%5Cu8bbe%5Cu8ba1%5Cu65b9%5Cu6848%5Cuff0c%5Cu8f93%5Cu51fa%5Cu4e00%5Cu884c%5Cu4e00%5Cu4e2a%5Cu6574%5Cu6570%5Cu8868%5Cu793a%5Cu6821%5Cu9a8c%5Cu503c%5Cu3002%22%2C%22samples%22%3A%5B%5B%225%205%5Cn2%203%201%204%5Cn1%202%202%5Cn2%201%201%204%2010%5Cn3%201%201%203%201%205%201%5Cn3%201%2010%202%20100%205%201%5Cn5%201%201%202%201%203%201%204%201%205%201%22%2C%225%5Cn8%5Cn5%5Cn8%5Cn5%22%5D%5D%2C%22hint%22%3A%22%23%23%23%20%5Cu6837%5Cu4f8b%5Cu89e3%5Cu91ca%5Cn%5Cn%5Cu5bf9%5Cu4e8e%5Cu7b2c%5Cu4e00%5Cu4e2a%5Cu8bbe%5Cu8ba1%5Cu65b9%5Cu6848%5Cuff0c%5Cu6bcf%5Cu4e00%5Cu4e2a%5Cu9636%5Cu6bb5%20%24d%24%20%5Cu7684%5Cu53d8%5Cu5316%5Cu4e3a%5Cuff1a%5Cn%5Cn-%20%24%5B0%2C10%5E%7B18%7D%2C10%5E%7B18%7D%2C10%5E%7B18%7D%2C10%5E%7B18%7D%2C10%5E%7B18%7D%5D%20%5C%5Crightarrow%20%5B0%2C10%5E%7B18%7D%2C2%2C10%5E%7B18%7D%2C10%5E%7B18%7D%2C10%5E%7B18%7D%5D%20%5C%5Crightarrow%24%5Cn-%20%24%5B0%2C4%2C2%2C5%2C10%5E%7B18%7D%2C10%5E%7B18%7D%5D%20%5C%5Crightarrow%20%5B0%2C4%2C2%2C5%2C6%2C10%5E%7B18%7D%5D%20%5C%5Crightarrow%20%5B0%2C4%2C2%2C5%2C6%2C10%5D%24%20%5Cu3002%5Cn%5Cn%5Cu56e0%5Cu6b64%5Cu6821%5Cu9a8c%5Cu503c%5Cu4e3a%201%2B2%2B1%2B1%3D5%5Cu3002%5Cn%5Cn%5Cu5bf9%5Cu4e8e%5Cu7b2c%5Cu4e8c%5Cu4e2a%5Cu8bbe%5Cu8ba1%5Cu65b9%5Cu6848%5Cuff0c%5Cu6bcf%5Cu4e00%5Cu4e2a%5Cu9636%5Cu6bb5%20%24d%24%20%5Cu7684%5Cu53d8%5Cu5316%5Cu4e3a%5Cuff1a%5Cn%5Cn-%20%24%5B0%2C10%5E%7B18%7D%2C10%5E%7B18%7D%2C10%5E%7B18%7D%2C10%5E%7B18%7D%2C10%5E%7B18%7D%5D%20%5C%5Crightarrow%20%5B0%2C1%2C10%5E%7B18%7D%2C10%5E%7B18%7D%2C10%2C10%5E%7B18%7D%5D%20%5C%5Crightarrow%24%5Cn-%20%24%5B0%2C1%2C3%2C11%2C10%2C14%5D%20%5C%5Crightarrow%20%5B0%2C1%2C3%2C6%2C10%2C14%5D%20%5C%5Crightarrow%20%5B0%2C1%2C3%2C6%2C7%2C14%5D%20%5C%5Crightarrow%20%5B0%2C1%2C3%2C6%2C7%2C11%5D%24%5Cu3002%5Cn%5Cn%5Cu56e0%5Cu6b64%5Cu6821%5Cu9a8c%5Cu503c%5Cu4e3a%202%2B3%2B1%2B1%2B1%3D8%5Cu3002%5Cn%5Cn%5Cu5bf9%5Cu4e8e%5Cu7b2c%5Cu4e09%5Cu4e2a%5Cu8bbe%5Cu8ba1%5Cu65b9%5Cu6848%5Cuff0c%5Cu6bcf%5Cu4e00%5Cu4e2a%5Cu9636%5Cu6bb5%20%24d%24%20%5Cu7684%5Cu53d8%5Cu5316%5Cu4e3a%5Cuff1a%5Cn%5Cn-%20%24%5B0%2C10%5E%7B18%7D%2C10%5E%7B18%7D%2C10%5E%7B18%7D%2C10%5E%7B18%7D%2C10%5E%7B18%7D%5D%20%5C%5Crightarrow%20%5B0%2C1%2C10%5E%7B18%7D%2C1%2C10%5E%7B18%7D%2C1%5D%20%5C%5Crightarrow%20%5B0%2C1%2C3%2C1%2C2%2C1%5D%24%20%5Cu3002%5Cn%5Cn%5Cu56e0%5Cu6b64%5Cu6821%5Cu9a8c%5Cu503c%5Cu4e3a%203%2B1%2B1%3D5%5Cu3002%5Cn%5Cn%5Cu5bf9%5Cu4e8e%5Cu7b2c%5Cu56db%5Cu4e2a%5Cu8bbe%5Cu8ba1%5Cu65b9%5Cu6848%5Cuff0c%5Cu6bcf%5Cu4e00%5Cu4e2a%5Cu9636%5Cu6bb5%20%24d%24%20%5Cu7684%5Cu53d8%5Cu5316%5Cu4e3a%5Cuff1a%5Cn%5Cn-%20%24%5B0%2C10%5E%7B18%7D%2C10%5E%7B18%7D%2C10%5E%7B18%7D%2C10%5E%7B18%7D%2C10%5E%7B18%7D%5D%20%5C%5Crightarrow%20%5B0%2C10%2C100%2C10%5E%7B18%7D%2C10%5E%7B18%7D%2C1%5D%20%5C%5Crightarrow%24%5Cn-%20%24%5B0%2C10%2C12%2C103%2C5%2C1%5D%20%5C%5Crightarrow%20%5B0%2C10%2C12%2C6%2C5%2C1%5D%20%5C%5Crightarrow%20%5B0%2C10%2C9%2C5%2C1%5D%24%5Cu3002%5Cn%5Cn%5Cu56e0%5Cu6b64%5Cu6821%5Cu9a8c%5Cu503c%5Cu4e3a%203%2B3%2B1%2B1%3D8%5Cu3002%5Cn%5Cn%5Cu5bf9%5Cu4e8e%5Cu7b2c%5Cu4e94%5Cu4e2a%5Cu8bbe%5Cu8ba1%5Cu65b9%5Cu6848%5Cuff0c%5Cu6bcf%5Cu4e00%5Cu4e2a%5Cu9636%5Cu6bb5%20%24d%24%20%5Cu7684%5Cu53d8%5Cu5316%5Cu4e3a%5Cuff1a%5Cn%5Cn-%20%24%5B0%2C10%5E%7B18%7D%2C10%5E%7B18%7D%2C10%5E%7B18%7D%2C10%5E%7B18%7D%2C10%5E%7B18%7D%5D%20%5C%5Crightarrow%20%5B0%2C1%2C1%2C1%2C1%2C1%5D%24%5Cn%5Cn%5Cu56e0%5Cu6b64%5Cu6821%5Cu9a8c%5Cu503c%5Cu4e3a%205%5Cu3002%5Cn%5Cn%23%23%23%20%5Cu6570%5Cu636e%5Cu8303%5Cu56f4%5Cn%5Cn%5Cu6d4b%5Cu8bd5%5Cu70b9%7C%24n%24%7C%24m%24%7C%24K%24%7C%5Cu5176%5Cu4ed6%5Cu7ea6%5Cu5b9a%5Cn-%7C-%7C-%7C-%7C-%5Cn1%2C2%7C%24%5C%5Cle%201000%24%7C%24%5C%5Cle%201000%24%7C%24%5C%5Cle%20100%24%7C%5Cu65e0%5Cn3%2C4%7C%24%5C%5Cle%202%20%5C%5Ctimes%2010%5E5%24%7C%24%5C%5Cle%202%20%5C%5Ctimes%2010%5E5%24%7C%24%5C%5Cle%20100%24%7C%5Cu65e0%5Cn5%2C6%7C%24%5C%5Cle%202%20%5C%5Ctimes%2010%5E5%24%7C%24%5C%5Cle%202%20%5C%5Ctimes%2010%5E5%24%7C%24%5C%5Cle%202%20%5C%5Ctimes%2010%5E5%24%7C%241%20%5C%5Cle%20w_i%2Cl_i%20%5C%5Cle%2050%24%5Cn7%2C8%2C9%2C10%7C%24%5C%5Cle%202%20%5C%5Ctimes%2010%5E5%24%7C%24%5C%5Cle%202%20%5C%5Ctimes%2010%5E5%24%7C%24%5C%5Cle%202%20%5C%5Ctimes%2010%5E5%24%7C%5Cu65e0%5Cn%5Cn%5Cn%5Cu5bf9%5Cu4e8e%20%24100%5C%5C%25%24%20%5Cu7684%5Cu6570%5Cu636e%5Cuff0c%5Cu4fdd%5Cu8bc1%5Cu6bcf%5Cu4e2a%5Cu8bbe%5Cu8ba1%5Cu65b9%5Cu6848%20%24a_i%24%20%5Cu4e24%5Cu4e24%5Cu4e0d%5Cu540c%5Cu4e14%20%241%5C%5Cle%20a_i%5C%5Cle%20n%24%20%5Cu3002%20%20%5Cn%5Cu5bf9%5Cu4e8e%20%24100%5C%5C%25%24%20%5Cu7684%5Cu6570%5Cu636e%5Cuff0c%5Cu4fdd%5Cu8bc1%20%241%5C%5Cle%20w_i%2Cl_i%5C%5Cle%2010%5E9%2C1%5C%5Cle%5C%5Csum%20K%5C%5Cle%202%5C%5Ctimes%2010%5E5%24%20%5Cu3002%5Cn%5Cn%5Cu611f%5Cu8c22%20%40Xeonacid%20%5Cu63d0%5Cu4f9b%5Cu9898%5Cu9762%22%2C%22provider%22%3A%7B%22uid%22%3A4223%2C%22name%22%3A%22jiry_2%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3Anull%2C%22isAdmin%22%3Afalse%2C%22color%22%3A%22Blue%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B3000%2C3000%2C3000%2C3000%2C3000%2C3000%2C3000%2C3000%2C3000%2C3000%5D%2C%22memory%22%3A%5B512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%2C512000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22tags%22%3A%5B35%2C42%2C48%2C88%2C125%2C290%2C319%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A383%2C%22totalAccepted%22%3A156%2C%22pid%22%3A%22P4501%22%2C%22title%22%3A%22%5BZJOI2018%5D%5Cu80d6%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A68285%2C%22title%22%3A%22%5Cu5176%5Cu5b9e%5Cu8fd9%5Cu9898%5Cu53ef%5Cu4ee5%5Cu4e00%5Cu4e2alog%22%2C%22forum%22%3A%7B%22id%22%3A25560%2C%22name%22%3A%22P4501%20%5BZJOI2018%5D%5Cu80d6%22%2C%22slug%22%3A%22P4501%22%7D%7D%2C%7B%22id%22%3A41705%2C%22title%22%3A%22%5Cu611f%5Cu89c9%5Cu96be%5Cu5ea6%5Cu6807%5Cu7b7e%5Cu5f88%5Cu771f%28%5Cu4e25%5Cu8083%22%2C%22forum%22%3A%7B%22id%22%3A25560%2C%22name%22%3A%22P4501%20%5BZJOI2018%5D%5Cu80d6%22%2C%22slug%22%3A%22P4501%22%7D%7D%2C%7B%22id%22%3A41587%2C%22title%22%3A%22%5Cu65b0%5Cu4eba%5Cu6c42%5Cu52a9%5Cuff0c%5Cu80d6%5Cu90a3%5Cu9898%5Cuff0cloj%20AC%20luogu%20TLE%22%2C%22forum%22%3A%7B%22id%22%3A25560%2C%22name%22%3A%22P4501%20%5BZJOI2018%5D%5Cu80d6%22%2C%22slug%22%3A%22P4501%22%7D%7D%2C%7B%22id%22%3A41489%2C%22title%22%3A%22%5Cu3010%5Cu9898%5Cu9762%5Cu3011%5Cu6570%5Cu636e%5Cu8303%5Cu56f4%5Cu4e0d%5Cu5168%22%2C%22forum%22%3A%7B%22id%22%3A25560%2C%22name%22%3A%22P4501%20%5BZJOI2018%5D%5Cu80d6%22%2C%22slug%22%3A%22P4501%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P4338%22%2C%22title%22%3A%22%5BZJOI2018%5D%5Cu5386%5Cu53f2%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P4339%22%2C%22title%22%3A%22%5BZJOI2018%5D%5Cu8ff7%5Cu5bab%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P4562%22%2C%22title%22%3A%22%5BJXOI2018%5D%5Cu6e38%5Cu620f%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P5268%22%2C%22title%22%3A%22%5BSNOI2017%5D%5Cu4e00%5Cu4e2a%5Cu7b80%5Cu5355%5Cu7684%5Cu8be2%5Cu95ee%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P5280%22%2C%22title%22%3A%22%5BZJOI2019%5D%5Cu7ebf%5Cu6bb5%5Cu6811%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22%5BZJOI2018%5D%5Cu80d6%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573286098;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>[ZJOI2018]胖</h1>
<h2>题目背景</h2>
<div>Cedyks 是九条可怜的好朋友（可能这场比赛公开以后就不是了），也是这题的主人公。</div>
<h2>题目描述</h2>
<div>Cedyks 是一个富有的男孩子。他住在著名的The Place（宫殿）中。
Cedyks 是一个努力的男孩子。他每天都做着不一样的题来锻炼他的The Salt（灵魂）。
这天，他打算在他的宫殿外围修筑一道城墙，城墙上有$n$ 座瞭望塔。你可以把城墙看做一条线段，瞭望塔是线段上的$n$ 个点，其中$1$ 和$n$ 分别为城墙的两个端点。其中第$i$ 座瞭望塔和第$i + 1$ 座瞭望塔的距离为$w_i$，他们之间的道路是双向的。
城墙很快就修建好了，现在Cedyks 开始计划修筑他的宫殿到城墙的道路。因为这题的题目名称，Cedyks 打算用他的宫殿到每一个瞭望塔的最短道路之和来衡量一个修建计划。
现在Cedyks 手上有$m$ 个设计方案，第$k$ 个设计方案会在宫殿和瞭望塔之间修建$T_k$ 条双向道路，第$i$ 条道路连接着瞭望塔$a_i$，长度为$l_i$。
计算到每一个瞭望塔的最短路之和是一个繁重的工程，本来Cedyks 想用广为流传的SPFA算法来求解，但是因为他的butter（缓冲区）实在是太小了，他只能转而用原始的贝尔福特曼算法来计算，算法的流程大概如下：
1. 定义宫殿是$0$ 号点，第$i$ 个瞭望塔是$i$ 号点，双向边$(u_i, v_i, l_i)$ 为一条连接$u_i$ 和$v_i$ 的双向道路。令$d$ 为距离数组，最开始$d_0 = 0, d_i = 10^{18}(i ∈ [1, n])$。
2. 令辅助数组$c = d$。依次对于每一条边$(ui, vi,wi)$ 进行增广，$c_{u_i} = min(c_{u_i} , d_{v_i} + w_i)$，$c_{v_i} = min(c_{v_i} , d_{u_i} + w_i)$。
3. 令$t$ 为$c$ 和$d$ 中不一样的位置个数，即令$S = \{i|c_i≠d_i\}$，则$t = |S|$。若$t = 0$，说明$d$就是最终的最短路，算法结束。否则令$d = c$，回到第二步。
因为需要计算的设计方案实在是太多了，所以Cedyks 雇佣了一些人来帮他进行计算。为了避免这些人用捏造出来的数据偷懒，他定义一个设计方案的校验值为在这个方案上运行贝尔福特曼算法每一次进入第三步$t$ 的和。他会让好几个雇佣来的人计算同样的设计方案，并比对每一个人给出的校验值。
你是Cedyks 雇佣来的苦力之一，聪明的你发现在这个情形下计算最短路的长度的和是一件非常简单的事情。但是寄人篱下不得不低头，你不得不再计算出每一个方案的校验值来交差。</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>第一行输入两个整数$n,m$，表示瞭望塔个数和设计方案个数。
接下来一行$n - 1$ 个数$w_i$，表示瞭望塔$i$ 和$i + 1$ 之间道路的长度。
接下来$m$ 行，每行描述一个设计方案。第一个整数$K$ 表示设计方案中的道路数量，接下来$K$ 个数对$(a_i, l_i)$ 为一条宫殿到瞭望塔的边。</div>
<h3>输出格式</h3>
<br />
<div>对于每一个设计方案，输出一行一个整数表示校验值。</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>5 5
2 3 1 4
1 2 2
2 1 1 4 10
3 1 1 3 1 5 1
3 1 10 2 100 5 1
5 1 1 2 1 3 1 4 1 5 1</code></pre>
<h3>输出样例 #1</h3>
<pre><code>5
8
5
8
5</code></pre>
<h2>说明</h2>
<div>### 样例解释
对于第一个设计方案，每一个阶段 $d$ 的变化为：
- $[0,10^{18},10^{18},10^{18},10^{18},10^{18}] \rightarrow [0,10^{18},2,10^{18},10^{18},10^{18}] \rightarrow$
- $[0,4,2,5,10^{18},10^{18}] \rightarrow [0,4,2,5,6,10^{18}] \rightarrow [0,4,2,5,6,10]$ 。
因此校验值为 1+2+1+1=5。
对于第二个设计方案，每一个阶段 $d$ 的变化为：
- $[0,10^{18},10^{18},10^{18},10^{18},10^{18}] \rightarrow [0,1,10^{18},10^{18},10,10^{18}] \rightarrow$
- $[0,1,3,11,10,14] \rightarrow [0,1,3,6,10,14] \rightarrow [0,1,3,6,7,14] \rightarrow [0,1,3,6,7,11]$。
因此校验值为 2+3+1+1+1=8。
对于第三个设计方案，每一个阶段 $d$ 的变化为：
- $[0,10^{18},10^{18},10^{18},10^{18},10^{18}] \rightarrow [0,1,10^{18},1,10^{18},1] \rightarrow [0,1,3,1,2,1]$ 。
因此校验值为 3+1+1=5。
对于第四个设计方案，每一个阶段 $d$ 的变化为：
- $[0,10^{18},10^{18},10^{18},10^{18},10^{18}] \rightarrow [0,10,100,10^{18},10^{18},1] \rightarrow$
- $[0,10,12,103,5,1] \rightarrow [0,10,12,6,5,1] \rightarrow [0,10,9,5,1]$。
因此校验值为 3+3+1+1=8。
对于第五个设计方案，每一个阶段 $d$ 的变化为：
- $[0,10^{18},10^{18},10^{18},10^{18},10^{18}] \rightarrow [0,1,1,1,1,1]$
因此校验值为 5。
### 数据范围
测试点|$n$|$m$|$K$|其他约定
-|-|-|-|-
1,2|$\le 1000$|$\le 1000$|$\le 100$|无
3,4|$\le 2 \times 10^5$|$\le 2 \times 10^5$|$\le 100$|无
5,6|$\le 2 \times 10^5$|$\le 2 \times 10^5$|$\le 2 \times 10^5$|$1 \le w_i,l_i \le 50$
7,8,9,10|$\le 2 \times 10^5$|$\le 2 \times 10^5$|$\le 2 \times 10^5$|无
对于 $100\%$ 的数据，保证每个设计方案 $a_i$ 两两不同且 $1\le a_i\le n$ 。
对于 $100\%$ 的数据，保证 $1\le w_i,l_i\le 10^9,1\le\sum K\le 2\times 10^5$ 。
感谢 @Xeonacid 提供题面</div>
</article>
</div>
</div>
</body>
</html>
