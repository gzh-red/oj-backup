<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>[CERC2016]地理哈希网格 Geohash Grid - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573377193:g0vcWKdjCLBJPANqghyHOdCVHfH7fmalSaR3AqscAKY=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%22%2C%22description%22%3A%22%5Cu201c%5Cu5730%5Cu7406%5Cu54c8%5Cu5e0c%5Cu201d%5Cu662f%5Cu4e00%5Cu4e2a%5Cu5c06%5Cu4e8c%5Cu7ef4%5Cu5e73%5Cu9762%5Cu5750%5Cu6807%5Cu7f16%5Cu7801%5Cu4e3a%5Cu6574%5Cu6570%5Cu7684%5Cu8fc7%5Cu7a0b%5Cuff0c%5Cu8fd9%5Cu5c06%5Cu4e3a%5Cu6570%5Cu636e%5Cu5e93%5Cu4e2d%5Cu5730%5Cu7406%5Cu6570%5Cu636e%5Cu7684%5Cu5b58%5Cu50a8%5Cu548c%5Cu67e5%5Cu8be2%5Cu5e26%5Cu6765%5Cu65b9%5Cu4fbf%5Cu3002%5Cu5728%5Cu8fd9%5Cu4e2a%5Cu95ee%5Cu9898%5Cu4e2d%5Cuff0c%5Cu4e00%5Cu4e2a%5Cu5730%5Cu56fe%5Cu662f%5Cu4e00%5Cu4e2a%5Cu5efa%5Cu7acb%5Cu5728%5Cu6807%5Cu51c6%5Cu4e8c%5Cu7ef4%5Cu7b1b%5Cu5361%5Cu5c14%5Cu5750%5Cu6807%5Cu7cfb%5Cu4e0a%5Cu76842%5En%5Cu884c2%5En%5Cu5217%5Cu7684%5Cu77e9%5Cu5f62%5Cu7f51%5Cu683c%5Cuff0c%5Cu8d8a%5Cu5f80%5Cu53f3x%5Cu5750%5Cu6807%5Cu8d8a%5Cu5927%5Cuff0c%5Cu8d8a%5Cu5f80%5Cu4e0ay%5Cu5750%5Cu6807%5Cu8d8a%5Cu5927%5Cu3002%5Cu4e00%5Cu4e2a%5Cu5730%5Cu56fe%5Cu683c%5Cu5b50%5Cu662f%5Cu4e00%5Cu4e2a%5Cu5355%5Cu4f4d%5Cu6b63%5Cu65b9%5Cu5f62%5Cuff0c%5Cu6ee1%5Cu8db3%5Cu5176%5Cu5de6%5Cu4e0b%5Cu89d2%5Cu7684%5Cu70b9%5Cu7684%5Cu5750%5Cu6807%5Cu4e3a%28x%2Cy%29%5Cuff0c%5Cu5176%5Cu4e2d0%3C%3Dx%2Cy%3C2%5En%5Cu3002%5Cn%5Cn%5Cn%5Cu57282%5En%5Cu884c2%5En%5Cu5217%5Cu7684%5Cu5730%5Cu56fe%5Cu4e0a%5Cu4e00%5Cu5171%5Cu67092%5E%282n%29%5Cu4e2a%5Cu683c%5Cu5b50%5Cu3002%5Cu5bf9%5Cu4e8e%5Cu4e00%5Cu4e2a%5Cu683c%5Cu5b50c%5Cuff0c%5Cu5b83%5Cu7684%5Cu5730%5Cu7406%5Cu54c8%5Cu5e0c%5Cu503ch%28c%29%5Cu662f%5Cu4e00%5Cu4e2a2n%5Cu4f4d%5Cu7684%5Cu975e%5Cu8d1f%5Cu4e8c%5Cu8fdb%5Cu5236%5Cu6574%5Cu6570%5Cu3002%5Cu4ece%5Cu6700%5Cu9ad8%5Cu4f4d%5Cu5f00%5Cu59cb%5Cu8003%5Cu8651%5Cu6574%5Cu4e2a%5Cu5730%5Cu56fe%5Cuff0c%5Cu7136%5Cu540e%5Cu91cd%5Cu590d%5Cu4e0b%5Cu9762%5Cu4e24%5Cu4e2a%5Cu6b65%5Cu9aa4n%5Cu6b21%5Cuff0c%5Cu5373%5Cu53ef%5Cu5f97%5Cu5230c%5Cu7684%5Cu5730%5Cu7406%5Cu54c8%5Cu5e0c%5Cu503ch%28c%29%5Cuff1a%5Cn%5Cn%5Cn1.%5Cu628a%5Cu5730%5Cu56fe%5Cu5206%5Cu6210%5Cu5de6%5Cu53f3%5Cu4e24%5Cu4e2a%5Cu9762%5Cu79ef%5Cu76f8%5Cu7b49%5Cu7684%5Cu533a%5Cu57df%5Cuff0c%5Cu5982%5Cu679c%5Cu683c%5Cu5b50c%5Cu5728%5Cu5de6%5Cu534a%5Cu8fb9%5Cuff0c%5Cu90a3%5Cu4e48%5Cu8fd9%5Cu4e00%5Cu4f4d%5Cu662f0%5Cuff0c%5Cu5426%5Cu5219%5Cu662f1%5Cu3002%5Cu7136%5Cu540e%5Cu5c06%5Cu8003%5Cu8651%5Cu8303%5Cu56f4%5Cu7f29%5Cu5c0f%5Cu5230c%5Cu6240%5Cu5728%5Cu7684%5Cu90a3%5Cu534a%5Cu8fb9%5Cu5730%5Cu56fe%5Cu3002%5Cn%5Cn%5Cn2.%5Cu628a%5Cu5730%5Cu56fe%5Cu5206%5Cu6210%5Cu4e0a%5Cu4e0b%5Cu4e24%5Cu4e2a%5Cu9762%5Cu79ef%5Cu76f8%5Cu7b49%5Cu7684%5Cu533a%5Cu57df%5Cuff0c%5Cu5982%5Cu679c%5Cu683c%5Cu5b50c%5Cu5728%5Cu4e0b%5Cu534a%5Cu8fb9%5Cuff0c%5Cu90a3%5Cu4e48%5Cu8fd9%5Cu4e00%5Cu4f4d%5Cu662f0%5Cuff0c%5Cu5426%5Cu5219%5Cu662f1%5Cu3002%5Cu7136%5Cu540e%5Cu5c06%5Cu8003%5Cu8651%5Cu8303%5Cu56f4%5Cu7f29%5Cu5c0f%5Cu5230c%5Cu6240%5Cu5728%5Cu7684%5Cu90a3%5Cu534a%5Cu8fb9%5Cu5730%5Cu56fe%5Cu3002%5Cn%5Cn%5Cn%5Cu4e00%5Cu4e2a%5Cu201c%5Cu5730%5Cu7406%5Cu54c8%5Cu5e0c%5Cu533a%5Cu95f4%5Cu201d%5Ba%2Cb%5D%5Cu8868%5Cu793a%5Cu6240%5Cu6709%5Cu54c8%5Cu5e0c%5Cu503c%5Cu5728%5Ba%2Cb%5D%5Cu4e4b%5Cu95f4%5Cu7684%5Cu683c%5Cu5b50%5Cu3002%5Cu901a%5Cu5e38%5Cu5e94%5Cu7528%5Cu4e2d%5Cuff0c%5Cu6211%5Cu4eec%5Cu4f1a%5Cu7528%5Cu4e00%5Cu4e9b%5Cu5730%5Cu7406%5Cu54c8%5Cu5e0c%5Cu533a%5Cu95f4%5Cu53bb%5Cu8fd1%5Cu4f3c%5Cu8868%5Cu793a%5Cu5730%5Cu56fe%5Cu3002%5Cu7ed9%5Cu5b9a%5Cu4e00%5Cu4e2a%5Cu683c%5Cu5b50%5Cu96c6%5Cu5408C%5Cuff0c%5Cu4ee5%5Cu53ca%5Cu4e00%5Cu4e2a%5Cu6b63%5Cu6574%5Cu6570t%5Cuff0c%5Cu90a3%5Cu4e48C%5Cu7684%5Cu6700%5Cu4f18t%5Cu8fd1%5Cu4f3c%5Cu662f%5Cu6307%5Cu4f7f%5Cu7528%5Cu4e0d%5Cu8d85%5Cu8fc7t%5Cu4e2a%5Cu5730%5Cu7406%5Cu54c8%5Cu5e0c%5Cu533a%5Cu95f4%5Cuff0c%5Cu8986%5Cu76d6%5Cu4f4f%5Cu6240%5Cu6709C%5Cu4e2d%5Cu7684%5Cu683c%5Cu5b50%5Cuff08%5Cu8986%5Cu76d6%5Cu5176%5Cu5b83%5Cu683c%5Cu5b50%5Cu662f%5Cu5141%5Cu8bb8%5Cu7684%5Cuff09%5Cuff0c%5Cu540c%5Cu65f6%5Cu6ee1%5Cu8db3%5Cu8986%5Cu76d6%5Cu4f4f%5Cu7684%5Cu533a%5Cu57df%5Cu7684%5Cu9762%5Cu79ef%5Cu6700%5Cu5c0f%5Cu3002%5Cn%5Cn%5Cn%5Cu7ed9%5Cu5b9a%5Cu4e00%5Cu4e2a%5Cu5730%5Cu56fe%5Cu4ee5%5Cu53ca%5Cu4e00%5Cu4e2a%5Cu683c%5Cu5b50%5Cu96c6%5Cu5408C%5Cuff0cC%5Cu7528%5Cu4e00%5Cu4e2a%5Cu8fb9%5Cu5e73%5Cu884c%5Cu4e8e%5Cu5750%5Cu6807%5Cu8f74%5Cu7684%5Cu7b80%5Cu5355%5Cu591a%5Cu8fb9%5Cu5f62%5Cu6765%5Cu8868%5Cu793a%5Cu3002%5Cu7136%5Cu540e%5Cu7ed9%5Cu5b9aq%5Cu4e2a%5Cu8be2%5Cu95eet%5C%5C_1%2Ct%5C%5C_2%2C...%2Ct%5C%5C_q%5Cuff0c%5Cu5bf9%5Cu4e8e%5Cu6bcf%5Cu4e2a%5Cu8be2%5Cu95eet%5C%5C_k%5Cuff0c%5Cu4f60%5Cu9700%5Cu8981%5Cu6c42%5Cu51faC%5Cu7684%5Cu6700%5Cu4f18t%5C%5C_k%5Cu8fd1%5Cu4f3c%5Cu8986%5Cu76d6%5Cu4f4f%5Cu7684%5Cu533a%5Cu57df%5Cu7684%5Cu9762%5Cu79ef%5Cu3002%5Cn%22%2C%22inputFormat%22%3A%22%5Cu7b2c%5Cu4e00%5Cu884c%5Cu5305%5Cu542b%5Cu4e00%5Cu4e2a%5Cu6b63%5Cu6574%5Cu6570n%281%3C%3Dn%3C%3D30%29%5Cuff0c%5Cu8868%5Cu793a%5Cu5730%5Cu56fe%5Cu7684%5Cu5c3a%5Cu5bf8%5Cu7684%5Cu4ee52%5Cu4e3a%5Cu5e95%5Cu7684%5Cu5bf9%5Cu6570%5Cu3002%5Cn%5Cn%5Cu7b2c%5Cu4e8c%5Cu884c%5Cu5305%5Cu542b%5Cu4e00%5Cu4e2a%5Cu6b63%5Cu6574%5Cu6570m%284%3C%3Dm%3C%3D200%29%5Cuff0c%5Cu8868%5Cu793a%5Cu591a%5Cu8fb9%5Cu5f62%5Cu9876%5Cu70b9%5Cu7684%5Cu4e2a%5Cu6570%5Cu3002%5Cn%5Cn%5Cu63a5%5Cu4e0b%5Cu6765m%5Cu884c%5Cuff0c%5Cu6bcf%5Cu884c%5Cu4e24%5Cu4e2a%5Cu6574%5Cu6570x%5C%5C_i%2Cy%5C%5C_i%280%3C%3Dx%5C%5C_i%2Cy%5C%5C_i%3C%3D2%5En%29%5Cuff0c%5Cu6309%5Cu9006%5Cu65f6%5Cu9488%5Cu4f9d%5Cu6b21%5Cu8868%5Cu793a%5Cu591a%5Cu8fb9%5Cu5f62%5Cu6bcf%5Cu4e2a%5Cu9876%5Cu70b9%5Cu7684%5Cu5750%5Cu6807%5Cu3002%5Cn%5Cn%5Cu8f93%5Cu5165%5Cu6570%5Cu636e%5Cu4fdd%5Cu8bc1%5Cu591a%5Cu8fb9%5Cu5f62%5Cu4e0d%5Cu81ea%5Cu4ea4%5Cuff0c%5Cu8fb9%5Cu5e73%5Cu884c%5Cu4e8e%5Cu5750%5Cu6807%5Cu8f74%5Cuff0c%5Cu4e14%5Cu4e0d%5Cu5b58%5Cu5728%5Cu76f8%5Cu90bb%5Cu4e24%5Cu6761%5Cu8fb9%5Cu662f%5Cu5e73%5Cu884c%5Cu7684%5Cu3002%5Cn%5Cn%5Cu63a5%5Cu4e0b%5Cu6765%5Cu4e00%5Cu884c%5Cu5305%5Cu542b%5Cu4e00%5Cu4e2a%5Cu6b63%5Cu6574%5Cu6570q%281%3C%3Dq%3C%3D100000%29%5Cuff0c%5Cu8868%5Cu793a%5Cu8be2%5Cu95ee%5Cu7684%5Cu4e2a%5Cu6570%5Cu3002%5Cn%5Cn%5Cu63a5%5Cu4e0b%5Cu6765q%5Cu884c%5Cuff0c%5Cu6bcf%5Cu884c%5Cu4e00%5Cu4e2a%5Cu6b63%5Cu6574%5Cu6570t%5C%5C_1%2Ct%5C%5C_2%2C...%2Ct%5C%5C_q%281%3C%3Dt%5C%5C_i%3C%3D10%5E9%29%5Cuff0c%5Cu4f9d%5Cu6b21%5Cu8868%5Cu793a%5Cu6bcf%5Cu4e2a%5Cu8be2%5Cu95ee%5Cu3002%5Cn%22%2C%22outputFormat%22%3A%22%5Cu8f93%5Cu51faq%5Cu884c%5Cuff0c%5Cu6bcf%5Cu884c%5Cu4e00%5Cu4e2a%5Cu6b63%5Cu6574%5Cu6570%5Cuff0c%5Cu4f9d%5Cu6b21%5Cu56de%5Cu7b54%5Cu6bcf%5Cu4e2a%5Cu8be2%5Cu95ee%5Cu3002%5Cn%22%2C%22samples%22%3A%5B%5B%223%208%5Cn1%201%5Cn5%201%5Cn5%204%5Cn3%204%5Cn3%208%5Cn0%208%5Cn0%205%5Cn1%205%5Cn4%202%203%205%207%22%2C%2232%5Cn30%5Cn26%5Cn24%5Cn%22%5D%5D%2C%22hint%22%3A%22%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fpic%5C%2F4687.png%29%20%5Cn%5Cn%5Cu533a%5Cu95f4%5B3%2C29%5D%5Cu3001%5B33%2C33%5D%5Cu548c%5B36%2C37%5D%5Cu7ec4%5Cu6210%5Cu6700%5Cu4f183%5Cu8fd1%5Cu4f3c%5Cuff0c%5Cu5176%5Cu8986%5Cu76d6%5Cu4f4f%5Cu7684%5Cu603b%5Cu9762%5Cu79ef%5Cu4e3a30%5Cu3002%5Cn%22%2C%22provider%22%3A%7B%22uid%22%3A1993%2C%22name%22%3A%22Claris%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3Anull%2C%22isAdmin%22%3Afalse%2C%22color%22%3A%22Blue%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%5D%2C%22memory%22%3A%5B128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22tags%22%3A%5B319%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A7%2C%22totalAccepted%22%3A3%2C%22pid%22%3A%22P3683%22%2C%22title%22%3A%22%5BCERC2016%5D%5Cu5730%5Cu7406%5Cu54c8%5Cu5e0c%5Cu7f51%5Cu683c%20Geohash%20Grid%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22P%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22%5BCERC2016%5D%5Cu5730%5Cu7406%5Cu54c8%5Cu5e0c%5Cu7f51%5Cu683c%20Geohash%20Grid%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573286098;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>[CERC2016]地理哈希网格 Geohash Grid</h1>
<h2>题目描述</h2>
<div>“地理哈希”是一个将二维平面坐标编码为整数的过程，这将为数据库中地理数据的存储和查询带来方便。在这个问题中，一个地图是一个建立在标准二维笛卡尔坐标系上的2^n行2^n列的矩形网格，越往右x坐标越大，越往上y坐标越大。一个地图格子是一个单位正方形，满足其左下角的点的坐标为(x,y)，其中0<=x,y<2^n。
在2^n行2^n列的地图上一共有2^(2n)个格子。对于一个格子c，它的地理哈希值h(c)是一个2n位的非负二进制整数。从最高位开始考虑整个地图，然后重复下面两个步骤n次，即可得到c的地理哈希值h(c)：
1.把地图分成左右两个面积相等的区域，如果格子c在左半边，那么这一位是0，否则是1。然后将考虑范围缩小到c所在的那半边地图。
2.把地图分成上下两个面积相等的区域，如果格子c在下半边，那么这一位是0，否则是1。然后将考虑范围缩小到c所在的那半边地图。
一个“地理哈希区间”[a,b]表示所有哈希值在[a,b]之间的格子。通常应用中，我们会用一些地理哈希区间去近似表示地图。给定一个格子集合C，以及一个正整数t，那么C的最优t近似是指使用不超过t个地理哈希区间，覆盖住所有C中的格子（覆盖其它格子是允许的），同时满足覆盖住的区域的面积最小。
给定一个地图以及一个格子集合C，C用一个边平行于坐标轴的简单多边形来表示。然后给定q个询问t\_1,t\_2,...,t\_q，对于每个询问t\_k，你需要求出C的最优t\_k近似覆盖住的区域的面积。
</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>第一行包含一个正整数n(1<=n<=30)，表示地图的尺寸的以2为底的对数。
第二行包含一个正整数m(4<=m<=200)，表示多边形顶点的个数。
接下来m行，每行两个整数x\_i,y\_i(0<=x\_i,y\_i<=2^n)，按逆时针依次表示多边形每个顶点的坐标。
输入数据保证多边形不自交，边平行于坐标轴，且不存在相邻两条边是平行的。
接下来一行包含一个正整数q(1<=q<=100000)，表示询问的个数。
接下来q行，每行一个正整数t\_1,t\_2,...,t\_q(1<=t\_i<=10^9)，依次表示每个询问。
</div>
<h3>输出格式</h3>
<br />
<div>输出q行，每行一个正整数，依次回答每个询问。
</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>3 8
1 1
5 1
5 4
3 4
3 8
0 8
0 5
1 5
4 2 3 5 7</code></pre>
<h3>输出样例 #1</h3>
<pre><code>32
30
26
24
</code></pre>
<h2>说明</h2>
<div> ![](https://cdn.luogu.com.cn/upload/pic/4687.png)
区间[3,29]、[33,33]和[36,37]组成最优3近似，其覆盖住的总面积为30。
</div>
</article>
</div>
</div>
</body>
</html>
