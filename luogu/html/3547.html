<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>[POI2013]CEN-Price List - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573377027:ARMGiaw6P/0jo5xKCME9TqYzUNb6tI6xKdK4nm18sQk=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%22%2C%22description%22%3A%22Railway%20has%20always%20been%20the%20most%20popular%20mean%20of%20transport%20in%20Byteotia.%5Cn%5CnOut%20of%20%24n%24%20towns%20in%20the%20land%2C%20%24m%24%20pairs%20are%20connected%20by%20track%20segments%20%20%20%20belonging%20to%20Byteotian%20State%20Railways%20%28BSR%29.%5Cn%5CnThe%20tracks%20do%20not%20cross%20outside%20of%20towns%2C%20and%20may%20lead%20through%20picturesque%20%20%20%20bridges%20and%20somewhat%20less%20picturesque%20tunnels.%5Cn%5CnThe%20ticket%20for%20travelling%20between%20any%20two%20towns%20%20%20%20directly%20connected%20by%20rail%20costs%20%24a%24%20bythalers.%5Cn%5CnCurrently%20the%20transportation%20market%20in%20Byteotia%20is%20changing.%5Cn%5CnAs%20of%20now%2C%20BSR%20faces%20a%20new%20competitor%3A%20Byteotian%20Airlines%20%28BA%29.%5Cn%5CnBA%20plans%20to%20operate%20flights%20between%20some%20pairs%20of%20towns.%5Cn%5CnSince%20Byteotian%20railways%20are%20quite%20comfortable%2C%20the%20BA%20board%20has%20decided%20to%20%20%20%20operate%20flights%20only%20between%20pairs%20of%20towns%20that%20are%20not%20directly%20%20%20%20connected%20by%20rail.%20%20Due%20to%20economy%2C%20BA%20will%20fly%20only%20between%20towns%20%20%20%20for%20which%20the%20cheapest%20railway%20connection%20requires%20exactly%20one%20change.%5Cn%5CnThe%20ticket%20for%20each%20such%20flight%20is%20going%20to%20cost%20%24b%24%20bythalers.%5Cn%5CnTo%20help%20Byteotian%20citizens%20in%20planning%20their%20trips%2C%20the%20Byteotian%20%20%20%20Ministry%20for%20Transport%20%28BMT%29%20has%20decided%20to%20issue%20leaflets%20specifying%20the%20%20%20%20cheapest%20routes%20between%20all%20possible%20towns.%20%20A%20sequence%20of%20an%20%20%20%20arbitrary%20number%20of%20direct%20railway%20or%20airplane%20connections%20is%20%20%20%20called%20a%20route.%20%20A%20BMT%20officer%20by%20the%20name%20of%20Byteasar%20has%20been%20%20%20%20commissioned%20with%20the%20task%20of%20preparing%20the%20price%20list%20for%20the%20leaflets.%5Cn%5CnCould%20you%20help%20him%20in%20writing%20a%20program%20that%20will%20determine%20the%20right%20%20%20%20prices%3F%5Cn%5CnLet%20us%20clarify%20that%20all%20the%20connections%20in%20Byteotia%2C%20both%20by%20railway%20and%20%20%20%20airplane%2C%20are%20bidirectional.%5Cn%5Cn%5Cu7ed9%5Cu4e00%5Cu4e2a%5Cu65e0%5Cu5411%5Cu56fe%5Cuff0c%5Cu8fb9%5Cu6743%5Cu5747%5Cu4e3aa%5Cuff0c%5Cu7136%5Cu540e%5Cu5c06%5Cu539f%5Cu6765%5Cu56fe%5Cu4e2d%5Cu6ee1%5Cu8db3%5Cu6700%5Cu77ed%5Cu8def%5Cu7b49%5Cu4e8e2a%5Cu6240%5Cu6709%5Cu7684%5Cu70b9%5Cu5bf9%28x%2Cy%29%5Cu4e4b%5Cu95f4%5Cu518d%5Cu52a0%5Cu4e00%5Cu6761%5Cu957f%5Cu5ea6%5Cu4e3ab%5Cu7684%5Cu65e0%5Cu5411%5Cu8fb9%5Cuff0c%5Cu95ee%5Cu64cd%5Cu4f5c%5Cu4e4b%5Cu540e%5Cu70b9K%5Cu5230%5Cu6240%5Cu6709%5Cu70b9%5Cu7684%5Cu6700%5Cu77ed%5Cu8def%5Cu662f%5Cu591a%5Cu5c11%5Cn%22%2C%22inputFormat%22%3A%22The%20first%20line%20of%20the%20standard%20input%20contains%20five%20integers%2C%24n%24%2C%24m%24%2C%24k%24%2C%24a%24%20and%20%24b%24%20%28%242%5C%5Cle%20n%5C%5Cle%20100%5C%5C%20000%24%2C%20%24%5C%5Cle%20m%5C%5Cle%20100%5C%5C%20000%24%2C%20%241%5C%5Cle%20k%5C%5Cle%20n%24%2C%20%241%5C%5Cle%20a%2Cb%5C%5Cle%201%5C%5C%20000%24%29%2C%20%20%20%20%20%20separated%20by%20single%20spaces.%5Cn%5CnThe%20numbers%20%24n%24%20and%20%24m%24%20denote%20the%20number%20of%20towns%20and%20the%20number%20of%20%20%20%20%20%20direct%20railway%20connections%20in%20Byteotia%2C%20respectively.%5Cn%5CnFor%20simplicity%2C%20we%20number%20the%20towns%20in%20Byteotia%20from%20%241%24%20to%20%24n%24.%20The%20other%20numbers%20denote%3A%24k%24%20-%20the%20number%20of%20the%20source%20town%20for%20which%20the%20connection%20prices%20are%20to%20be%20determined%3B%24a%24%20-%20the%20price%20of%20a%20direct%20railway%20connection%3B%24b%24%20-%20the%20price%20of%20a%20direct%20airplane%20connection.%5Cn%5CnEach%20of%20the%20following%20%24m%24%20lines%20contains%20a%20pair%20of%20integers%20%24u_i%24%20and%20%24v_i%24%28%241%5C%5Cle%20u_i%2Cv_i%5C%5Cle%20n%24%2C%24u_i%5C%5Cne%20v_i%24%20for%20%24i%3D1%2C2%2C%5C%5Ccdots%2Cm%24%29%2C%20separated%20by%20a%20single%20space%2C%20specifying%20the%20number%20of%20towns%20directly%20connected%20by%20tracks.%5Cn%5Cn%5CnYou%20may%20assume%20that%20all%20towns%20are%20reachable%20by%20railway%20from%20the%20town%20no.%20%24k%24.%5Cn%22%2C%22outputFormat%22%3A%22Your%20program%20should%20print%20%24n%24%20lines%20to%20the%20standard%20output.%5Cn%5CnThe%20line%20no.%20%24i%24%20%28for%20%24i%3D1%2C2%2C%5C%5Ccdots%2Cn%24%29%20should%20contain%20a%20single%20integer%3A%5Cn%5Cnthe%20cost%20of%20the%20cheapest%20route%20from%20town%20no.%20%24k%24%20to%20town%20no.%20%24i%24.%5Cn%5CnAmong%20those%2C%20the%20line%20no.%20%24k%24%20should%20contain%20the%20number%20%240%24.%5Cn%22%2C%22samples%22%3A%5B%5B%225%205%201%203%202%5Cn1%202%5Cn2%203%5Cn3%204%5Cn4%205%5Cn3%201%5Cn%22%2C%220%5Cn3%5Cn3%5Cn2%5Cn5%5Cn%22%5D%5D%2C%22hint%22%3A%22%5Cu7ed9%5Cu4e00%5Cu4e2a%5Cu65e0%5Cu5411%5Cu56fe%5Cuff0c%5Cu8fb9%5Cu6743%5Cu5747%5Cu4e3aa%5Cuff0c%5Cu7136%5Cu540e%5Cu5c06%5Cu539f%5Cu6765%5Cu56fe%5Cu4e2d%5Cu6ee1%5Cu8db3%5Cu6700%5Cu77ed%5Cu8def%5Cu7b49%5Cu4e8e2a%5Cu6240%5Cu6709%5Cu7684%5Cu70b9%5Cu5bf9%28x%2Cy%29%5Cu4e4b%5Cu95f4%5Cu518d%5Cu52a0%5Cu4e00%5Cu6761%5Cu957f%5Cu5ea6%5Cu4e3ab%5Cu7684%5Cu65e0%5Cu5411%5Cu8fb9%5Cuff0c%5Cu95ee%5Cu64cd%5Cu4f5c%5Cu4e4b%5Cu540e%5Cu70b9K%5Cu5230%5Cu6240%5Cu6709%5Cu70b9%5Cu7684%5Cu6700%5Cu77ed%5Cu8def%5Cu662f%5Cu591a%5Cu5c11%5Cn%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%5D%2C%22memory%22%3A%5B128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22tags%22%3A%5B30%2C57%2C126%2C319%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A117%2C%22totalAccepted%22%3A33%2C%22pid%22%3A%22P3547%22%2C%22title%22%3A%22%5BPOI2013%5DCEN-Price%20List%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A118933%2C%22title%22%3A%22%5Cu6570%5Cu636e%5Cu771f%5Cu6c34%5Cu2026%5Cu2026%22%2C%22forum%22%3A%7B%22id%22%3A2624%2C%22name%22%3A%22P3547%20%5BPOI2013%5DCEN-Price%20List%22%2C%22slug%22%3A%22P3547%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P2081%22%2C%22title%22%3A%22%5BNOI2012%5D%5Cu8ff7%5Cu5931%5Cu6e38%5Cu4e50%5Cu56ed%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P3953%22%2C%22title%22%3A%22%5Cu901b%5Cu516c%5Cu56ed%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P3551%22%2C%22title%22%3A%22%5BPOI2013%5DUSU-Take-out%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P4609%22%2C%22title%22%3A%22%5BFJOI2016%5D%5Cu5efa%5Cu7b51%5Cu5e08%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P5359%22%2C%22title%22%3A%22%5BSDOI2019%5D%5Cu67d3%5Cu8272%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22%5BPOI2013%5DCEN-Price%20List%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573286098;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>[POI2013]CEN-Price List</h1>
<h2>题目描述</h2>
<div>Railway has always been the most popular mean of transport in Byteotia.
Out of $n$ towns in the land, $m$ pairs are connected by track segments belonging to Byteotian State Railways (BSR).
The tracks do not cross outside of towns, and may lead through picturesque bridges and somewhat less picturesque tunnels.
The ticket for travelling between any two towns directly connected by rail costs $a$ bythalers.
Currently the transportation market in Byteotia is changing.
As of now, BSR faces a new competitor: Byteotian Airlines (BA).
BA plans to operate flights between some pairs of towns.
Since Byteotian railways are quite comfortable, the BA board has decided to operate flights only between pairs of towns that are not directly connected by rail. Due to economy, BA will fly only between towns for which the cheapest railway connection requires exactly one change.
The ticket for each such flight is going to cost $b$ bythalers.
To help Byteotian citizens in planning their trips, the Byteotian Ministry for Transport (BMT) has decided to issue leaflets specifying the cheapest routes between all possible towns. A sequence of an arbitrary number of direct railway or airplane connections is called a route. A BMT officer by the name of Byteasar has been commissioned with the task of preparing the price list for the leaflets.
Could you help him in writing a program that will determine the right prices?
Let us clarify that all the connections in Byteotia, both by railway and airplane, are bidirectional.
给一个无向图，边权均为a，然后将原来图中满足最短路等于2a所有的点对(x,y)之间再加一条长度为b的无向边，问操作之后点K到所有点的最短路是多少
</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line of the standard input contains five integers,$n$,$m$,$k$,$a$ and $b$ ($2\le n\le 100\ 000$, $\le m\le 100\ 000$, $1\le k\le n$, $1\le a,b\le 1\ 000$), separated by single spaces.
The numbers $n$ and $m$ denote the number of towns and the number of direct railway connections in Byteotia, respectively.
For simplicity, we number the towns in Byteotia from $1$ to $n$. The other numbers denote:$k$ - the number of the source town for which the connection prices are to be determined;$a$ - the price of a direct railway connection;$b$ - the price of a direct airplane connection.
Each of the following $m$ lines contains a pair of integers $u_i$ and $v_i$($1\le u_i,v_i\le n$,$u_i\ne v_i$ for $i=1,2,\cdots,m$), separated by a single space, specifying the number of towns directly connected by tracks.
You may assume that all towns are reachable by railway from the town no. $k$.
</div>
<h3>输出格式</h3>
<br />
<div>Your program should print $n$ lines to the standard output.
The line no. $i$ (for $i=1,2,\cdots,n$) should contain a single integer:
the cost of the cheapest route from town no. $k$ to town no. $i$.
Among those, the line no. $k$ should contain the number $0$.
</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>5 5 1 3 2
1 2
2 3
3 4
4 5
3 1
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>0
3
3
2
5
</code></pre>
<h2>说明</h2>
<div>给一个无向图，边权均为a，然后将原来图中满足最短路等于2a所有的点对(x,y)之间再加一条长度为b的无向边，问操作之后点K到所有点的最短路是多少
</div>
</article>
</div>
</div>
</body>
</html>
