<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>[SDOI2008]洞穴勘测 - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573374972:5Byd34oMvvlpnYxTlzDwVdOJOBoYB4maXDXCXm/PGnI=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%22%2C%22description%22%3A%22%5Cu8f89%5Cu8f89%5Cu70ed%5Cu8877%5Cu4e8e%5Cu6d1e%5Cu7a74%5Cu52d8%5Cu6d4b%5Cu3002%5Cn%5Cn%5Cu67d0%5Cu5929%5Cuff0c%5Cu4ed6%5Cu6309%5Cu7167%5Cu5730%5Cu56fe%5Cu6765%5Cu5230%5Cu4e86%5Cu4e00%5Cu7247%5Cu88ab%5Cu6807%5Cu8bb0%5Cu4e3aJSZX%5Cu7684%5Cu6d1e%5Cu7a74%5Cu7fa4%5Cu5730%5Cu533a%5Cu3002%5Cu7ecf%5Cu8fc7%5Cu521d%5Cu6b65%5Cu52d8%5Cu6d4b%5Cuff0c%5Cu8f89%5Cu8f89%5Cu53d1%5Cu73b0%5Cu8fd9%5Cu7247%5Cu533a%5Cu57df%5Cu7531n%5Cu4e2a%5Cu6d1e%5Cu7a74%5Cuff08%5Cu5206%5Cu522b%5Cu7f16%5Cu53f7%5Cu4e3a1%5Cu5230n%5Cuff09%5Cu4ee5%5Cu53ca%5Cu82e5%5Cu5e72%5Cu901a%5Cu9053%5Cu7ec4%5Cu6210%5Cuff0c%5Cu5e76%5Cu4e14%5Cu6bcf%5Cu6761%5Cu901a%5Cu9053%5Cu8fde%5Cu63a5%5Cu4e86%5Cu6070%5Cu597d%5Cu4e24%5Cu4e2a%5Cu6d1e%5Cu7a74%5Cu3002%5Cu5047%5Cu5982%5Cu4e24%5Cu4e2a%5Cu6d1e%5Cu7a74%5Cu53ef%5Cu4ee5%5Cu901a%5Cu8fc7%5Cu4e00%5Cu6761%5Cu6216%5Cu8005%5Cu591a%5Cu6761%5Cu901a%5Cu9053%5Cu6309%5Cu4e00%5Cu5b9a%5Cu987a%5Cu5e8f%5Cu8fde%5Cu63a5%5Cu8d77%5Cu6765%5Cuff0c%5Cu90a3%5Cu4e48%5Cu8fd9%5Cu4e24%5Cu4e2a%5Cu6d1e%5Cu7a74%5Cu5c31%5Cu662f%5Cu8fde%5Cu901a%5Cu7684%5Cuff0c%5Cu6309%5Cu987a%5Cu5e8f%5Cu8fde%5Cu63a5%5Cu5728%5Cu4e00%5Cu8d77%5Cu7684%5Cu8fd9%5Cu4e9b%5Cu901a%5Cu9053%5Cu5219%5Cu88ab%5Cu79f0%5Cu4e4b%5Cu4e3a%5Cu8fd9%5Cu4e24%5Cu4e2a%5Cu6d1e%5Cu7a74%5Cu4e4b%5Cu95f4%5Cu7684%5Cu4e00%5Cu6761%5Cu8def%5Cu5f84%5Cu3002%20%5Cu6d1e%5Cu7a74%5Cu90fd%5Cu5341%5Cu5206%5Cu575a%5Cu56fa%5Cu65e0%5Cu6cd5%5Cu7834%5Cu574f%5Cuff0c%5Cu7136%5Cu800c%5Cu901a%5Cu9053%5Cu4e0d%5Cu592a%5Cu7a33%5Cu5b9a%5Cuff0c%5Cu65f6%5Cu5e38%5Cu56e0%5Cu4e3a%5Cu5916%5Cu754c%5Cu5f71%5Cu54cd%5Cu800c%5Cu53d1%5Cu751f%5Cu6539%5Cu53d8%5Cuff0c%5Cu6bd4%5Cu5982%5Cuff0c%5Cu6839%5Cu636e%5Cu6709%5Cu5173%5Cu4eea%5Cu5668%5Cu7684%5Cu76d1%5Cu6d4b%5Cu7ed3%5Cu679c%5Cuff0c123%5Cu53f7%5Cu6d1e%5Cu7a74%5Cu548c127%5Cu53f7%5Cu6d1e%5Cu7a74%5Cu4e4b%5Cu95f4%5Cu6709%5Cu65f6%5Cu4f1a%5Cu51fa%5Cu73b0%5Cu4e00%5Cu6761%5Cu901a%5Cu9053%5Cuff0c%5Cu6709%5Cu65f6%5Cu8fd9%5Cu6761%5Cu901a%5Cu9053%5Cu53c8%5Cu4f1a%5Cu56e0%5Cu4e3a%5Cu67d0%5Cu79cd%5Cu7a00%5Cu5947%5Cu53e4%5Cu602a%5Cu7684%5Cu539f%5Cu56e0%5Cu88ab%5Cu6bc1%5Cu3002%5Cn%5Cn%5Cu8f89%5Cu8f89%5Cu6709%5Cu4e00%5Cu53f0%5Cu76d1%5Cu6d4b%5Cu4eea%5Cu5668%5Cu53ef%5Cu4ee5%5Cu5b9e%5Cu65f6%5Cu5c06%5Cu901a%5Cu9053%5Cu7684%5Cu6bcf%5Cu4e00%5Cu6b21%5Cu6539%5Cu53d8%5Cu72b6%5Cu51b5%5Cu5728%5Cu8f89%5Cu8f89%5Cu624b%5Cu8fb9%5Cu7684%5Cu7ec8%5Cu7aef%5Cu673a%5Cu4e0a%5Cu663e%5Cu793a%5Cuff1a%5Cn%5Cn%5Cu5982%5Cu679c%5Cu76d1%5Cu6d4b%5Cu5230%5Cu6d1e%5Cu7a74u%5Cu548c%5Cu6d1e%5Cu7a74v%5Cu4e4b%5Cu95f4%5Cu51fa%5Cu73b0%5Cu4e86%5Cu4e00%5Cu6761%5Cu901a%5Cu9053%5Cuff0c%5Cu7ec8%5Cu7aef%5Cu673a%5Cu4e0a%5Cu4f1a%5Cu663e%5Cu793a%5Cu4e00%5Cu6761%5Cu6307%5Cu4ee4%20%60Connect%20u%20v%60%5Cn%5Cn%5Cu5982%5Cu679c%5Cu76d1%5Cu6d4b%5Cu5230%5Cu6d1e%5Cu7a74u%5Cu548c%5Cu6d1e%5Cu7a74v%5Cu4e4b%5Cu95f4%5Cu7684%5Cu901a%5Cu9053%5Cu88ab%5Cu6bc1%5Cuff0c%5Cu7ec8%5Cu7aef%5Cu673a%5Cu4e0a%5Cu4f1a%5Cu663e%5Cu793a%5Cu4e00%5Cu6761%5Cu6307%5Cu4ee4%20%60Destroy%20u%20v%60%5Cn%5Cn%5Cu7ecf%5Cu8fc7%5Cu957f%5Cu671f%5Cu7684%5Cu8270%5Cu82e6%5Cu5353%5Cu7edd%5Cu7684%5Cu624b%5Cu5de5%5Cu63a8%5Cu7b97%5Cuff0c%5Cu8f89%5Cu8f89%5Cu53d1%5Cu73b0%5Cu4e00%5Cu4e2a%5Cu5947%5Cu602a%5Cu7684%5Cu73b0%5Cu8c61%5Cuff1a%5Cu65e0%5Cu8bba%5Cu901a%5Cu9053%5Cu600e%5Cu4e48%5Cu6539%5Cu53d8%5Cuff0c%5Cu4efb%5Cu610f%5Cu65f6%5Cu523b%5Cu4efb%5Cu610f%5Cu4e24%5Cu4e2a%5Cu6d1e%5Cu7a74%5Cu4e4b%5Cu95f4%5Cu81f3%5Cu591a%5Cu53ea%5Cu6709%5Cu4e00%5Cu6761%5Cu8def%5Cu5f84%5Cu3002%5Cn%5Cn%5Cu56e0%5Cu800c%5Cuff0c%5Cu8f89%5Cu8f89%5Cu575a%5Cu4fe1%5Cu8fd9%5Cu662f%5Cu7531%5Cu4e8e%5Cu67d0%5Cu79cd%5Cu672c%5Cu8d28%5Cu89c4%5Cu5f8b%5Cu7684%5Cu652f%5Cu914d%5Cu5bfc%5Cu81f4%5Cu7684%5Cu3002%5Cu56e0%5Cu800c%5Cuff0c%5Cu8f89%5Cu8f89%5Cu66f4%5Cu52a0%5Cu591c%5Cu4ee5%5Cu7ee7%5Cu65e5%5Cu5730%5Cu575a%5Cu5b88%5Cu5728%5Cu7ec8%5Cu7aef%5Cu673a%5Cu4e4b%5Cu524d%5Cuff0c%5Cu8bd5%5Cu56fe%5Cu901a%5Cu8fc7%5Cu901a%5Cu9053%5Cu7684%5Cu6539%5Cu53d8%5Cu60c5%5Cu51b5%5Cu6765%5Cu7814%5Cu7a76%5Cu8fd9%5Cu6761%5Cu672c%5Cu8d28%5Cu89c4%5Cu5f8b%5Cu3002%20%5Cu7136%5Cu800c%5Cuff0c%5Cu7ec8%5Cu4e8e%5Cu6709%5Cu4e00%5Cu5929%5Cuff0c%5Cu8f89%5Cu8f89%5Cu5728%5Cu5806%5Cu79ef%5Cu6210%5Cu5c71%5Cu7684%5Cu6f14%5Cu7b97%5Cu7eb8%5Cu4e2d%5Cu5d29%5Cu6e83%5Cu4e86%5Cu2026%5Cu2026%5Cu4ed6%5Cu628a%5Cu7ec8%5Cu7aef%5Cu673a%5Cu5f80%5Cu5730%5Cu9762%5Cu4e00%5Cu7838%5Cuff08%5Cu7ec8%5Cu7aef%5Cu673a%5Cu4e5f%5Cu8db3%5Cu591f%5Cu575a%5Cu56fa%5Cu65e0%5Cu6cd5%5Cu7834%5Cu574f%5Cuff09%5Cuff0c%5Cu8f6c%5Cu800c%5Cu6c42%5Cu52a9%5Cu4e8e%5Cu4f60%5Cuff0c%5Cu8bf4%5Cu9053%5Cuff1a%5Cu201c%5Cu4f60%5Cu8001%5Cu5144%5Cu628a%5Cu8fd9%5Cu7a0b%5Cu5e8f%5Cu5199%5Cu5199%5Cu5427%5Cu201d%5Cu3002%5Cn%5Cn%5Cu8f89%5Cu8f89%5Cu5e0c%5Cu671b%5Cu80fd%5Cu968f%5Cu65f6%5Cu901a%5Cu8fc7%5Cu7ec8%5Cu7aef%5Cu673a%5Cu53d1%5Cu51fa%5Cu6307%5Cu4ee4%20%60Query%20u%20v%60%5Cuff0c%5Cu5411%5Cu76d1%5Cu6d4b%5Cu4eea%5Cu8be2%5Cu95ee%5Cu6b64%5Cu65f6%5Cu6d1e%5Cu7a74u%5Cu548c%5Cu6d1e%5Cu7a74v%5Cu662f%5Cu5426%5Cu8fde%5Cu901a%5Cu3002%5Cu73b0%5Cu5728%5Cu4f60%5Cu8981%5Cu4e3a%5Cu4ed6%5Cu7f16%5Cu5199%5Cu7a0b%5Cu5e8f%5Cu56de%5Cu7b54%5Cu6bcf%5Cu4e00%5Cu6b21%5Cu8be2%5Cu95ee%5Cu3002%20%5Cu5df2%5Cu77e5%5Cu5728%5Cu7b2c%5Cu4e00%5Cu6761%5Cu6307%5Cu4ee4%5Cu663e%5Cu793a%5Cu4e4b%5Cu524d%5Cuff0cJSZX%5Cu6d1e%5Cu7a74%5Cu7fa4%5Cu4e2d%5Cu6ca1%5Cu6709%5Cu4efb%5Cu4f55%5Cu901a%5Cu9053%5Cu5b58%5Cu5728%5Cu3002%5Cn%22%2C%22inputFormat%22%3A%22%5Cu7b2c%5Cu4e00%5Cu884c%5Cu4e3a%5Cu4e24%5Cu4e2a%5Cu6b63%5Cu6574%5Cu6570n%5Cu548cm%5Cuff0c%5Cu5206%5Cu522b%5Cu8868%5Cu793a%5Cu6d1e%5Cu7a74%5Cu7684%5Cu4e2a%5Cu6570%5Cu548c%5Cu7ec8%5Cu7aef%5Cu673a%5Cu4e0a%5Cu51fa%5Cu73b0%5Cu8fc7%5Cu7684%5Cu6307%5Cu4ee4%5Cu7684%5Cu4e2a%5Cu6570%5Cu3002%20%5Cu4ee5%5Cu4e0bm%5Cu884c%5Cuff0c%5Cu4f9d%5Cu6b21%5Cu8868%5Cu793a%5Cu7ec8%5Cu7aef%5Cu673a%5Cu4e0a%5Cu51fa%5Cu73b0%5Cu7684%5Cu5404%5Cu6761%5Cu6307%5Cu4ee4%5Cu3002%5Cu6bcf%5Cu884c%5Cu5f00%5Cu5934%5Cu662f%5Cu4e00%5Cu4e2a%5Cu8868%5Cu793a%5Cu6307%5Cu4ee4%5Cu79cd%5Cu7c7b%5Cu7684%5Cu5b57%5Cu7b26%5Cu4e32s%5Cuff08%5C%22Connect%5Cu201d%5Cu3001%5Cu201dDestroy%5Cu201d%5Cu6216%5Cu8005%5Cu201dQuery%5Cu201d%5Cuff0c%5Cu533a%5Cu5206%5Cu5927%5Cu5c0f%5Cu5199%5Cuff09%5Cuff0c%5Cu4e4b%5Cu540e%5Cu6709%5Cu4e24%5Cu4e2a%5Cu6574%5Cu6570u%5Cu548cv%20%281%5Cu2264u%2C%20v%5Cu2264n%29%20%5Cu5206%5Cu522b%5Cu8868%5Cu793a%5Cu4e24%5Cu4e2a%5Cu6d1e%5Cu7a74%5Cu7684%5Cu7f16%5Cu53f7%5Cu3002%5Cn%22%2C%22outputFormat%22%3A%22%5Cu5bf9%5Cu6bcf%5Cu4e2aQuery%5Cu6307%5Cu4ee4%5Cuff0c%5Cu8f93%5Cu51fa%5Cu6d1e%5Cu7a74u%5Cu548c%5Cu6d1e%5Cu7a74v%5Cu662f%5Cu5426%5Cu4e92%5Cu76f8%5Cu8fde%5Cu901a%5Cuff1a%5Cu662f%5Cu8f93%5Cu51fa%5Cu201dYes%5Cu201d%5Cuff0c%5Cu5426%5Cu5219%5Cu8f93%5Cu51fa%5Cu201dNo%5Cu201d%5Cu3002%5Cuff08%5Cu4e0d%5Cu542b%5Cu53cc%5Cu5f15%5Cu53f7%5Cuff09%5Cn%22%2C%22samples%22%3A%5B%5B%22200%205%5CnQuery%20123%20127%5CnConnect%20123%20127%5CnQuery%20123%20127%5CnDestroy%20127%20123%5CnQuery%20123%20127%22%2C%22No%5CnYes%5CnNo%5Cn%22%5D%2C%5B%223%205%5CnConnect%201%202%5CnConnect%203%201%5CnQuery%202%203%5CnDestroy%201%203%5CnQuery%202%203%22%2C%22Yes%5CnNo%22%5D%5D%2C%22hint%22%3A%22%5Cu6570%5Cu636e%5Cu8bf4%5Cu660e%5Cn%5Cn%5Cn10%25%5Cu7684%5Cu6570%5Cu636e%5Cu6ee1%5Cu8db3n%5Cu22641000%2C%20m%5Cu226420000%5Cn%5Cn20%25%5Cu7684%5Cu6570%5Cu636e%5Cu6ee1%5Cu8db3n%5Cu22642000%2C%20m%5Cu226440000%5Cn%5Cn30%25%5Cu7684%5Cu6570%5Cu636e%5Cu6ee1%5Cu8db3n%5Cu22643000%2C%20m%5Cu226460000%5Cn%5Cn40%25%5Cu7684%5Cu6570%5Cu636e%5Cu6ee1%5Cu8db3n%5Cu22644000%2C%20m%5Cu226480000%5Cn%5Cn50%25%5Cu7684%5Cu6570%5Cu636e%5Cu6ee1%5Cu8db3n%5Cu22645000%2C%20m%5Cu2264100000%5Cn%5Cn60%25%5Cu7684%5Cu6570%5Cu636e%5Cu6ee1%5Cu8db3n%5Cu22646000%2C%20m%5Cu2264120000%5Cn%5Cn70%25%5Cu7684%5Cu6570%5Cu636e%5Cu6ee1%5Cu8db3n%5Cu22647000%2C%20m%5Cu2264140000%5Cn%5Cn80%25%5Cu7684%5Cu6570%5Cu636e%5Cu6ee1%5Cu8db3n%5Cu22648000%2C%20m%5Cu2264160000%5Cn%5Cn90%25%5Cu7684%5Cu6570%5Cu636e%5Cu6ee1%5Cu8db3n%5Cu22649000%2C%20m%5Cu2264180000%5Cn%5Cn100%25%5Cu7684%5Cu6570%5Cu636e%5Cu6ee1%5Cu8db3n%5Cu226410000%2C%20m%5Cu2264200000%5Cn%5Cn%5Cn%5Cu4fdd%5Cu8bc1%5Cu6240%5Cu6709Destroy%5Cu6307%5Cu4ee4%5Cu5c06%5Cu6467%5Cu6bc1%5Cu7684%5Cu662f%5Cu4e00%5Cu6761%5Cu5b58%5Cu5728%5Cu7684%5Cu901a%5Cu9053%5Cn%5Cn%5Cu672c%5Cu9898%5Cu8f93%5Cu5165%5Cu3001%5Cu8f93%5Cu51fa%5Cu89c4%5Cu6a21%5Cu6bd4%5Cu8f83%5Cu5927%5Cuff0c%5Cu5efa%5Cu8baec%5C%5Cc%2B%2B%5Cu9009%5Cu624b%5Cu4f7f%5Cu7528scanf%5Cu548cprintf%5Cu8fdb%5Cu884cI%5C%5CO%5Cu64cd%5Cu4f5c%5Cu4ee5%5Cu514d%5Cu8d85%5Cu65f6%5Cn%5Cn%22%2C%22provider%22%3A%7B%22uid%22%3A14%2C%22name%22%3A%22xmyzwls%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3Anull%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%5D%2C%22memory%22%3A%5B128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22tags%22%3A%5B25%2C47%2C48%2C97%2C221%2C229%2C319%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A4874%2C%22totalAccepted%22%3A2570%2C%22pid%22%3A%22P2147%22%2C%22title%22%3A%22%5BSDOI2008%5D%5Cu6d1e%5Cu7a74%5Cu52d8%5Cu6d4b%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A149137%2C%22title%22%3A%22%5Cu8fd9%5Cu9898%5Cu6570%5Cu636e%5Cu4f3c%5Cu4e4e%5Cu6709%5Cu70b9%5Cu6c34%5Cu2026%5Cu2026%22%2C%22forum%22%3A%7B%22id%22%3A1239%2C%22name%22%3A%22P2147%20%5BSDOI2008%5D%5Cu6d1e%5Cu7a74%5Cu52d8%5Cu6d4b%22%2C%22slug%22%3A%22P2147%22%7D%7D%2C%7B%22id%22%3A142526%2C%22title%22%3A%22BZOJ%20AC%5Cuff0c%5Cu6d1b%5Cu8c37%5Cu63d0%5Cu4ea4%20WA%22%2C%22forum%22%3A%7B%22id%22%3A1239%2C%22name%22%3A%22P2147%20%5BSDOI2008%5D%5Cu6d1e%5Cu7a74%5Cu52d8%5Cu6d4b%22%2C%22slug%22%3A%22P2147%22%7D%7D%2C%7B%22id%22%3A135701%2C%22title%22%3A%22%5Cu6c42%5Cu52a9%5Cuff0cwrong%20answer%20Too%20short%20on%20line%201.%22%2C%22forum%22%3A%7B%22id%22%3A1239%2C%22name%22%3A%22P2147%20%5BSDOI2008%5D%5Cu6d1e%5Cu7a74%5Cu52d8%5Cu6d4b%22%2C%22slug%22%3A%22P2147%22%7D%7D%2C%7B%22id%22%3A122840%2C%22title%22%3A%22LCT%20T%5Cu98de%5Cu6c42%5Cu52a9%22%2C%22forum%22%3A%7B%22id%22%3A1239%2C%22name%22%3A%22P2147%20%5BSDOI2008%5D%5Cu6d1e%5Cu7a74%5Cu52d8%5Cu6d4b%22%2C%22slug%22%3A%22P2147%22%7D%7D%2C%7B%22id%22%3A102304%2C%22title%22%3A%22%5Cu6570%5Cu636e%5Cu8303%5Cu56f4%5Cu6709%5Cu8bef%22%2C%22forum%22%3A%7B%22id%22%3A1239%2C%22name%22%3A%22P2147%20%5BSDOI2008%5D%5Cu6d1e%5Cu7a74%5Cu52d8%5Cu6d4b%22%2C%22slug%22%3A%22P2147%22%7D%7D%2C%7B%22id%22%3A99945%2C%22title%22%3A%22%5Cu5728%5Cu6a21%5Cu677f%5Cu9762%5Cu524d%5Cu8fd9%5Cu9053%5Cu9898%5Cu5c31%5Cu662f%5Cu7ea2%5Cu7684%22%2C%22forum%22%3A%7B%22id%22%3A1239%2C%22name%22%3A%22P2147%20%5BSDOI2008%5D%5Cu6d1e%5Cu7a74%5Cu52d8%5Cu6d4b%22%2C%22slug%22%3A%22P2147%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P1501%22%2C%22title%22%3A%22%5B%5Cu56fd%5Cu5bb6%5Cu96c6%5Cu8bad%5Cu961f%5DTree%20II%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P2387%22%2C%22title%22%3A%22%5BNOI2014%5D%5Cu9b54%5Cu6cd5%5Cu68ee%5Cu6797%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P3203%22%2C%22title%22%3A%22%5BHNOI2010%5D%5Cu5f39%5Cu98de%5Cu7ef5%5Cu7f8a%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P3690%22%2C%22title%22%3A%22%5Cu3010%5Cu6a21%5Cu677f%5Cu3011Link%20Cut%20Tree%20%5Cuff08%5Cu52a8%5Cu6001%5Cu6811%5Cuff09%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P3950%22%2C%22title%22%3A%22%5Cu90e8%5Cu843d%5Cu51b2%5Cu7a81%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22%5BSDOI2008%5D%5Cu6d1e%5Cu7a74%5Cu52d8%5Cu6d4b%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>[SDOI2008]洞穴勘测</h1>
<h2>题目描述</h2>
<div>辉辉热衷于洞穴勘测。
某天，他按照地图来到了一片被标记为JSZX的洞穴群地区。经过初步勘测，辉辉发现这片区域由n个洞穴（分别编号为1到n）以及若干通道组成，并且每条通道连接了恰好两个洞穴。假如两个洞穴可以通过一条或者多条通道按一定顺序连接起来，那么这两个洞穴就是连通的，按顺序连接在一起的这些通道则被称之为这两个洞穴之间的一条路径。 洞穴都十分坚固无法破坏，然而通道不太稳定，时常因为外界影响而发生改变，比如，根据有关仪器的监测结果，123号洞穴和127号洞穴之间有时会出现一条通道，有时这条通道又会因为某种稀奇古怪的原因被毁。
辉辉有一台监测仪器可以实时将通道的每一次改变状况在辉辉手边的终端机上显示：
如果监测到洞穴u和洞穴v之间出现了一条通道，终端机上会显示一条指令 `Connect u v`
如果监测到洞穴u和洞穴v之间的通道被毁，终端机上会显示一条指令 `Destroy u v`
经过长期的艰苦卓绝的手工推算，辉辉发现一个奇怪的现象：无论通道怎么改变，任意时刻任意两个洞穴之间至多只有一条路径。
因而，辉辉坚信这是由于某种本质规律的支配导致的。因而，辉辉更加夜以继日地坚守在终端机之前，试图通过通道的改变情况来研究这条本质规律。 然而，终于有一天，辉辉在堆积成山的演算纸中崩溃了……他把终端机往地面一砸（终端机也足够坚固无法破坏），转而求助于你，说道：“你老兄把这程序写写吧”。
辉辉希望能随时通过终端机发出指令 `Query u v`，向监测仪询问此时洞穴u和洞穴v是否连通。现在你要为他编写程序回答每一次询问。 已知在第一条指令显示之前，JSZX洞穴群中没有任何通道存在。
</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>第一行为两个正整数n和m，分别表示洞穴的个数和终端机上出现过的指令的个数。 以下m行，依次表示终端机上出现的各条指令。每行开头是一个表示指令种类的字符串s（"Connect”、”Destroy”或者”Query”，区分大小写），之后有两个整数u和v (1≤u, v≤n) 分别表示两个洞穴的编号。
</div>
<h3>输出格式</h3>
<br />
<div>对每个Query指令，输出洞穴u和洞穴v是否互相连通：是输出”Yes”，否则输出”No”。（不含双引号）
</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>200 5
Query 123 127
Connect 123 127
Query 123 127
Destroy 127 123
Query 123 127</code></pre>
<h3>输出样例 #1</h3>
<pre><code>No
Yes
No
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>3 5
Connect 1 2
Connect 3 1
Query 2 3
Destroy 1 3
Query 2 3</code></pre>
<h3>输出样例 #2</h3>
<pre><code>Yes
No</code></pre>
<h2>说明</h2>
<div>数据说明
10%的数据满足n≤1000, m≤20000
20%的数据满足n≤2000, m≤40000
30%的数据满足n≤3000, m≤60000
40%的数据满足n≤4000, m≤80000
50%的数据满足n≤5000, m≤100000
60%的数据满足n≤6000, m≤120000
70%的数据满足n≤7000, m≤140000
80%的数据满足n≤8000, m≤160000
90%的数据满足n≤9000, m≤180000
100%的数据满足n≤10000, m≤200000
保证所有Destroy指令将摧毁的是一条存在的通道
本题输入、输出规模比较大，建议c\c++选手使用scanf和printf进行I\O操作以免超时
</div>
</article>
</div>
</div>
</body>
</html>
