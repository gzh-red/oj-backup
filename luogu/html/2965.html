<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>[USACO09NOV]农活比赛The Grand Farm-off - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573376211:fJBviv/mW4LP9bdNeR6WBMkW9BNcjKbkCBBXEDx7OoA=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%22%2C%22description%22%3A%22Farmer%20John%20owns%203%5C%5C%2AN%20%281%20%3C%3D%20N%20%3C%3D%20500%2C000%29%20cows%20surprisingly%20numbered%200..3%5C%5C%2AN-1%2C%20each%20of%20which%20has%20some%20associated%20integer%20weight%20W%5C%5C_i%20%281%20%3C%3D%20W%5C%5C_i%20%3C%3D%20d%29.%20He%20is%20entering%20the%20Grand%20Farm-off%2C%20a%20farming%20competition%20where%20he%20shows%20off%20his%20cows%20to%20the%20greater%20agricultural%20community.%5Cn%5CnThis%20competition%20allows%20him%20to%20enter%20a%20group%20of%20N%20cows.%20He%20has%20given%20each%20of%20his%20cows%20a%20utility%20rating%20U%5C%5C_i%20%281%20%3C%3D%20U%5C%5C_i%20%3C%3D%20h%29%2C%20which%5Cn%5Cnrepresents%20the%20usefulness%20he%20thinks%20that%20a%20particular%20cow%20will%20have%20in%20the%20competition%2C%20and%20he%20wants%20his%20selection%20of%20cows%20to%20have%20the%20maximal%20sum%20of%20utility.%5Cn%5CnThere%20might%20be%20multiple%20sets%20of%20N%20cows%20that%20attain%20the%20maximum%20utility%20sum.%20FJ%20is%20afraid%20the%20competition%20may%20impose%20a%20total%20weight%20limit%20on%20the%20cows%20in%20the%20competition%2C%20so%20a%20secondary%20priority%20is%20to%20bring%20lighter%20weight%20competition%20cows.%5Cn%5CnHelp%20FJ%20find%20a%20set%20of%20N%20cows%20with%20minimum%20possible%20total%20weight%20among%20the%20sets%20of%20N%20cows%20that%20maximize%20the%20utility%2C%20and%20print%20the%20remainder%20when%20this%20total%20weight%20is%20divided%20by%20M%20%2810%2C000%2C000%20%3C%3D%20M%20%3C%3D%201%2C000%2C000%2C000%29.%5Cn%5CnNote%3A%20to%20make%20the%20input%20phase%20faster%2C%20FJ%20has%20derived%20polynomials%20which%20will%20generate%20the%20weights%20and%20utility%20values%20for%20each%20cow.%20For%20each%20cow%200%20%3C%3D%20i%20%3C%203%5C%5C%2AN%2C%5Cn%5Cn%60%60%60cpp%5CnW_i%20%3D%20%28a%2Ai%5E5%2Bb%2Ai%5E2%2Bc%29%20mod%20d%20%5Cnand%20%20%20U_i%20%3D%20%28e%2Ai%5E5%2Bf%2Ai%5E3%2Bg%29%20mod%20h%20%5Cnwith%20reasonable%20ranges%20for%20the%20coefficients%20%280%20%3C%3D%20a%20%3C%3D%201%2C000%2C000%2C000%3B%200%20%3C%3D%20b%20%3C%3D%201%2C000%2C000%2C000%3B%200%20%3C%3D%20c%20%3C%3D%201%2C000%2C000%2C000%3B%200%20%3C%3D%20e%20%3C%3D%20%5Cn1%2C000%2C000%2C000%3B%200%20%3C%3D%20f%20%3C%3D%201%2C000%2C000%2C000%3B%200%20%3C%3D%20g%20%3C%3D%201%2C000%2C000%2C000%3B%2010%2C000%2C000%20%3C%3D%20d%20%3C%3D%201%2C000%2C000%2C000%3B%2010%2C000%2C000%20%3C%3D%20h%20%3C%3D%201%2C000%2C000%2C000%29.%20%5CnThe%20formulae%20do%20sometimes%20generate%20duplicate%20numbers%3B%20your%20algorithm%20should%20handle%20this%20properly.%20%5Cn%60%60%60%5Cn%5Cu519c%5Cu592b%5Cu7ea6%5Cu7ff0%5Cu67093N%281%20%3C%20N%20%3C%20500000%29%5Cu5934%5Cu725b%5Cuff0c%5Cu7f16%5Cu53f7%5Cu4f9d%5Cu6b21%5Cu4e3a1..%23N%5Cuff0c%5Cu6bcf%5Cu5934%5Cu725b%5Cu90fd%5Cu6709%5Cu4e00%5Cu4e2a%5Cu6574%5Cu6570%5Cu503c%5Cu7684%5Cu4f53%20%5Cu91cd%5Cu3002%5Cu7ea6%5Cu7ff0%5Cu51c6%5Cu5907%5Cu53c2%5Cu52a0%5Cu519c%5Cu573a%5Cu6280%5Cu827a%5Cu5927%5Cu8d5b%5Cuff0c%5Cu5411%5Cu5e7f%5Cu5927%5Cu7684%5Cu519c%5Cu4e1a%5Cu793e%5Cu533a%5Cu5c55%5Cu793a%5Cu4ed6%5Cu7684%5Cu5976%5Cu725b.%5Cn%5Cu5927%5Cu8d5b%5Cu89c4%5Cu5219%5Cu5141%5Cu8bb8%5Cu7ea6%5Cu7ff0%5Cu5e26N%5Cu5934%5Cu725b%5Cu53c2%5Cu8d5b.%5Cu7ea6%5Cu7ff0%5Cu7ed9%5Cu6bcf%5Cu5934%5Cu725b%5Cu8d4b%5Cu4e88%5Cu4e86%5Cu4e00%5Cu4e2a%5Cu201c%5Cu6709%5Cu7528%5Cu5ea6%5Cu201dUi%5Cuff0c%5Cu5b83%5Cu8868%20%5Cu793a%5Cu4e86%5Cu67d0%5Cu5934%5Cu725b%5Cu5728%5Cu6bd4%5Cu8d5b%5Cu4e2d%5Cu7684%5Cu6709%5Cu7528%5Cu7a0b%5Cu5ea6.%5Cu7ea6%5Cu7ff0%5Cu5e0c%5Cu671b%5Cu4ed6%5Cu9009%5Cu51fa%5Cu7684%5Cu5976%5Cu725b%5Cu7684%5Cu6709%5Cu7528%5Cu5ea6%5Cu4e4b%5Cu548c%5Cu6700%5Cu5927.%5Cn%5Cn%5Cu6709%5Cu53ef%5Cu80fd%5Cu9009%5Cu51fa%5Cu5f88%5Cu591a%5Cu7ec4%5Cu7684N%5Cu5934%5Cu725b%5Cu90fd%5Cu80fd%5Cu8fbe%5Cu5230%5Cu6709%5Cu7528%5Cu5ea6%5Cu6700%5Cu5927%5Cu548c.%5Cu7ea6%5Cu7ff0%5Cu5bb3%5Cu6015%5Cu9009%5Cu51fa%5Cu7684N%5Cu5934%5Cu725b%5Cu7684%5Cu603b%5Cu91cd%5Cu91cf%5Cu4f1a%5Cu7ed9%5Cu5927%5Cu8d5b%20%5Cu5e26%5Cu6765%5Cu9707%5Cu64bc%5Cuff0c%5Cu6240%5Cu4ee5%5Cuff0c%5Cu8981%5Cu8003%5Cu8651%5Cu4f18%5Cu5148%5Cu9009%5Cu62e9%5Cu4f53%5Cu91cd%5Cu8f7b%5Cu7684%5Cu5976%5Cu725b.%5Cn%5Cn%5Cu5e2e%5Cu52a9%5Cu7ea6%5Cu7ff0%5Cu9009%5Cu51faN%5Cu5934%5Cu603b%5Cu91cd%5Cu91cf%5Cu6700%5Cu8f7b%5Cuff0c%5Cu5e76%5Cu4e14%5Cu6709%5Cu7528%5Cu5ea6%5Cu4e4b%5Cu548c%5Cu6700%5Cu5927%5Cu7684%5Cu5976%5Cu725b.%5Cu8f93%5Cu51fa%5Cu4f53%5Cu91cd%5Cu6a21M%5Cu540e%5Cu7684%5Cu4f59%5Cu6570.%5Cn%5Cn%5Cu6ce8%5Cu610f%5Cuff1a%5Cu4e3a%5Cu4e86%5Cu4f7f%5Cu8f93%5Cu5165%5Cu66f4%5Cu5feb%5Cuff0c%5Cu7ea6%5Cu7ff0%5Cu4f7f%5Cu7528%5Cu4e86%5Cu4e00%5Cu4e2a%5Cu591a%5Cu9879%5Cu5f0f%5Cu6765%5Cu751f%5Cu6210%5Cu6bcf%5Cu5934%5Cu725b%5Cu7684%5Cu4f53%5Cu91cd%5Cu548c%5Cu6709%5Cu7528%5Cu5ea6.%5Cu5bf9%5Cu6bcf%5Cu5934%5Cu725b%5C%2F%5Cuff0c%20%5Cu4f53%5Cu91cd%5Cu548c%5Cu6709%5Cu7528%5Cu5ea6%5Cu7684%5Cu8ba1%5Cu7b97%5Cu516c%5Cu5f0f%5Cu4e3a%5Cuff1a%5Cn%5Cn%60%60%60cpp%5CnW_i%20%3D%20%28a%2Ai%5E5%2Bb%2Ai%5E2%2Bc%29%20mod%20d%20%5Cnand%20%20%20U_i%20%3D%20%28e%2Ai%5E5%2Bf%2Ai%5E3%2Bg%29%20mod%20h%20%5Cn%20%280%20%3C%3D%20a%20%3C%3D%201%2C000%2C000%2C000%3B%200%20%3C%3D%20b%20%3C%3D%201%2C000%2C000%2C000%3B%200%20%3C%3D%20c%20%3C%3D%201%2C000%2C000%2C000%3B%200%20%3C%3D%20e%20%3C%3D%20%5Cn1%2C000%2C000%2C000%3B%200%20%3C%3D%20f%20%3C%3D%201%2C000%2C000%2C000%3B%200%20%3C%3D%20g%20%3C%3D%201%2C000%2C000%2C000%3B%2010%2C000%2C000%20%3C%3D%20d%20%3C%3D%201%2C000%2C000%2C000%3B%2010%2C000%2C000%20%3C%3D%20h%20%3C%3D%201%2C000%2C000%2C000%29.%20%5Cn%5Cn%60%60%60%22%2C%22inputFormat%22%3A%22%5C%5C%2A%20Line%201%3A%20Ten%20space-separated%20integers%3A%20N%2C%20a%2C%20b%2C%20c%2C%20d%2C%20e%2C%20f%2C%20g%2C%20h%2C%20and%20M%5Cn%22%2C%22outputFormat%22%3A%22%5C%5C%2A%20Line%201%3A%20A%20single%20integer%20representing%20the%20lowest%20sum%20of%20the%20weights%20of%20the%20N%20cows%20with%20the%20highest%20net%20utility.%5Cn%22%2C%22samples%22%3A%5B%5B%222%200%201%205%2055555555%200%201%200%2055555555%2055555555%20%5Cr%5Cn%22%2C%2251%20%5Cr%5Cn%22%5D%5D%2C%22hint%22%3A%22The%20functions%20generate%20weights%20of%205%2C%206%2C%209%2C%2014%2C%2021%2C%20and%2030%20along%20with%20utilities%20of%200%2C%201%2C%208%2C%2027%2C%2064%2C%20and%20125.%5Cn%5Cn%5CnThe%20two%20cows%20with%20the%20highest%20utility%20are%20cow%205%20and%206%2C%20and%20their%20combined%20weight%20is%2021%2B30%3D51.%5Cn%22%2C%22provider%22%3A%7B%22uid%22%3A20%2C%22name%22%3A%22FarmerJohn2%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3Anull%2C%22isAdmin%22%3Afalse%2C%22color%22%3A%22Gray%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%5D%2C%22memory%22%3A%5B128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22tags%22%3A%5B26%2C46%2C319%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A476%2C%22totalAccepted%22%3A192%2C%22pid%22%3A%22P2965%22%2C%22title%22%3A%22%5BUSACO09NOV%5D%5Cu519c%5Cu6d3b%5Cu6bd4%5Cu8d5bThe%20Grand%20Farm-off%22%2C%22difficulty%22%3A2%2C%22type%22%3A%22P%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A104318%2C%22title%22%3A%22%5Cu5c0f%5Cu63d0%5Cu793a%22%2C%22forum%22%3A%7B%22id%22%3A2094%2C%22name%22%3A%22P2965%20%5BUSACO09NOV%5D%5Cu519c%5Cu6d3b%5Cu6bd4%5Cu8d5bThe%20Grand%20Farm-off%22%2C%22slug%22%3A%22P2965%22%7D%7D%2C%7B%22id%22%3A36928%2C%22title%22%3A%22%5Cu6c42%5Cu52a9%2010%5Cu5206%20pascal%22%2C%22forum%22%3A%7B%22id%22%3A2094%2C%22name%22%3A%22P2965%20%5BUSACO09NOV%5D%5Cu519c%5Cu6d3b%5Cu6bd4%5Cu8d5bThe%20Grand%20Farm-off%22%2C%22slug%22%3A%22P2965%22%7D%7D%2C%7B%22id%22%3A7604%2C%22title%22%3A%22%5Cu7528long%20long%20%5Cu554a%5Cuff01%5Cuff01%5Cuff01%22%2C%22forum%22%3A%7B%22id%22%3A2094%2C%22name%22%3A%22P2965%20%5BUSACO09NOV%5D%5Cu519c%5Cu6d3b%5Cu6bd4%5Cu8d5bThe%20Grand%20Farm-off%22%2C%22slug%22%3A%22P2965%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P1938%22%2C%22title%22%3A%22%5BUSACO09NOV%5D%5Cu627e%5Cu5de5%5Cu5c31%5Cu4e1aJob%20Hunt%22%2C%22difficulty%22%3A4%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P2562%22%2C%22title%22%3A%22%5BAHOI2002%5DKitty%5Cu732b%5Cu57fa%5Cu56e0%5Cu7f16%5Cu7801%22%2C%22difficulty%22%3A2%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P2755%22%2C%22title%22%3A%22%5Cu6d17%5Cu724c%5Cu95ee%5Cu9898%22%2C%22difficulty%22%3A2%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P2913%22%2C%22title%22%3A%22%5BUSACO08OCT%5D%5Cu8f66%5Cu8f6e%5Cu65cb%5Cu8f6cWheel%20Rotation%22%2C%22difficulty%22%3A2%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P3887%22%2C%22title%22%3A%22%5BGDOI2014%5D%5Cu4e16%5Cu754c%5Cu676f%22%2C%22difficulty%22%3A2%2C%22type%22%3A%22P%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22%5BUSACO09NOV%5D%5Cu519c%5Cu6d3b%5Cu6bd4%5Cu8d5bThe%20Grand%20Farm-off%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>[USACO09NOV]农活比赛The Grand Farm-off</h1>
<h2>题目描述</h2>
<div>Farmer John owns 3\*N (1 <= N <= 500,000) cows surprisingly numbered 0..3\*N-1, each of which has some associated integer weight W\_i (1 <= W\_i <= d). He is entering the Grand Farm-off, a farming competition where he shows off his cows to the greater agricultural community.
This competition allows him to enter a group of N cows. He has given each of his cows a utility rating U\_i (1 <= U\_i <= h), which
represents the usefulness he thinks that a particular cow will have in the competition, and he wants his selection of cows to have the maximal sum of utility.
There might be multiple sets of N cows that attain the maximum utility sum. FJ is afraid the competition may impose a total weight limit on the cows in the competition, so a secondary priority is to bring lighter weight competition cows.
Help FJ find a set of N cows with minimum possible total weight among the sets of N cows that maximize the utility, and print the remainder when this total weight is divided by M (10,000,000 <= M <= 1,000,000,000).
Note: to make the input phase faster, FJ has derived polynomials which will generate the weights and utility values for each cow. For each cow 0 <= i < 3\*N,
```cpp
W_i = (a*i^5+b*i^2+c) mod d
and U_i = (e*i^5+f*i^3+g) mod h
with reasonable ranges for the coefficients (0 <= a <= 1,000,000,000; 0 <= b <= 1,000,000,000; 0 <= c <= 1,000,000,000; 0 <= e <=
1,000,000,000; 0 <= f <= 1,000,000,000; 0 <= g <= 1,000,000,000; 10,000,000 <= d <= 1,000,000,000; 10,000,000 <= h <= 1,000,000,000).
The formulae do sometimes generate duplicate numbers; your algorithm should handle this properly.
```
农夫约翰有3N(1 < N < 500000)头牛，编号依次为1..#N，每头牛都有一个整数值的体 重。约翰准备参加农场技艺大赛，向广大的农业社区展示他的奶牛.
大赛规则允许约翰带N头牛参赛.约翰给每头牛赋予了一个“有用度”Ui，它表 示了某头牛在比赛中的有用程度.约翰希望他选出的奶牛的有用度之和最大.
有可能选出很多组的N头牛都能达到有用度最大和.约翰害怕选出的N头牛的总重量会给大赛 带来震撼，所以，要考虑优先选择体重轻的奶牛.
帮助约翰选出N头总重量最轻，并且有用度之和最大的奶牛.输出体重模M后的余数.
注意：为了使输入更快，约翰使用了一个多项式来生成每头牛的体重和有用度.对每头牛/， 体重和有用度的计算公式为：
```cpp
W_i = (a*i^5+b*i^2+c) mod d
and U_i = (e*i^5+f*i^3+g) mod h
(0 <= a <= 1,000,000,000; 0 <= b <= 1,000,000,000; 0 <= c <= 1,000,000,000; 0 <= e <=
1,000,000,000; 0 <= f <= 1,000,000,000; 0 <= g <= 1,000,000,000; 10,000,000 <= d <= 1,000,000,000; 10,000,000 <= h <= 1,000,000,000).
```</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>\* Line 1: Ten space-separated integers: N, a, b, c, d, e, f, g, h, and M
</div>
<h3>输出格式</h3>
<br />
<div>\* Line 1: A single integer representing the lowest sum of the weights of the N cows with the highest net utility.
</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>2 0 1 5 55555555 0 1 0 55555555 55555555 
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>51 
</code></pre>
<h2>说明</h2>
<div>The functions generate weights of 5, 6, 9, 14, 21, and 30 along with utilities of 0, 1, 8, 27, 64, and 125.
The two cows with the highest utility are cow 5 and 6, and their combined weight is 21+30=51.
</div>
</article>
</div>
</div>
</body>
</html>
