<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>[POI2009]FIB-Words 2 - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573376958:ma2fzfx6ygil/8+KRllMlLX66wNMLpBxKYXVUaZVWPA=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%5Cu5f81%5Cu6c42%5Cu7ffb%5Cu8bd1%5Cu3002%5Cu5982%5Cu679c%5Cu4f60%5Cu80fd%5Cu63d0%5Cu4f9b%5Cu7ffb%5Cu8bd1%5Cu6216%5Cu8005%5Cu9898%5Cu610f%5Cu7b80%5Cu8ff0%5Cuff0c%5Cu8bf7%5Cu76f4%5Cu63a5%5Cu53d1%5Cu8ba8%5Cu8bba%5Cuff0c%5Cu611f%5Cu8c22%5Cu4f60%5Cu7684%5Cu8d21%5Cu732e%5Cu3002%5Cn%22%2C%22description%22%3A%22The%20following%20task%20is%20a%20significantly%20harder%20version%20of%20task%20Words%20from%20the%20third%20stage%20of%2016th%20Polish%20OI.%20It%20wasn%27t%20used%20in%20the%20contest%20itself%2C%20but%20is%20an%20extension%20for%20those%20who%20solved%20%5C%22Words%5C%22%20and%20want%20more.%20%3A-%29%20%20%20%20Let%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI16%5C%2Ffib-en-tex.1.png%29%20be%20a%20function%20acting%20on%20strings%20composed%20of%20the%20digits%200%20%20%20%20and%201.%5Cn%5CnThe%20function%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI16%5C%2Ffib-en-tex.2.png%29%20transforms%20the%20string%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI16%5C%2Ffib-en-tex.3.png%29%20by%20replacing%20%28independently%20%20%20%20and%20concurrently%29%20every%20digit%200%20with%201%20and%20every%20digit%20%20%20%201%20with%20the%20string%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI16%5C%2Ffib-en-tex.4.png%29.%5Cn%5CnFor%20example%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI16%5C%2Ffib-en-tex.5.png%29%2C%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI16%5C%2Ffib-en-tex.6.png%29%20%20%20%20%28i.e.%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI16%5C%2Ffib-en-tex.7.png%29%20assigns%20an%20empty%20string%20to%20the%20empty%20string%29.%5Cn%5CnNote%20that%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI16%5C%2Ffib-en-tex.8.png%29%20is%20an%20injection%2C%20or%20a%20one-to-one%20function.%5Cn%5CnBy%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI16%5C%2Ffib-en-tex.9.png%29%20we%20denote%20the%20function%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI16%5C%2Ffib-en-tex.10.png%29%20composed%20with%20itself%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI16%5C%2Ffib-en-tex.11.png%29%20times.%5Cn%5CnIn%20particular%2C%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI16%5C%2Ffib-en-tex.12.png%29%20is%20the%20identity%20function%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI16%5C%2Ffib-en-tex.13.png%29.%5Cn%5CnWe%20are%20interested%20in%20the%20strings%20of%20the%20form%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI16%5C%2Ffib-en-tex.14.png%29%20%20%20%20for%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI16%5C%2Ffib-en-tex.15.png%29%20This%20sequence%20begins%20with%20the%20following%20strings%3A%5Cn%5Cn%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI16%5C%2Ffib-en-tex.16.png%29%2C%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI16%5C%2Ffib-en-tex.17.png%29%2C%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI16%5C%2Ffib-en-tex.18.png%29%2C%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI16%5C%2Ffib-en-tex.19.png%29%2C%20%20%20%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI16%5C%2Ffib-en-tex.20.png%29%2C%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI16%5C%2Ffib-en-tex.21.png%29.%5Cn%5CnWe%20call%20the%20string%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI16%5C%2Ffib-en-tex.22.png%29%20a%20substring%20of%20the%20string%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI16%5C%2Ffib-en-tex.23.png%29%20if%20it%20occurs%20%20%20%20in%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI16%5C%2Ffib-en-tex.24.png%29%20as%20%20a%20contiguous%20%28i.e.%20one-block%29%20subsequence.%5Cn%5CnA%20sequence%20of%20integers%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI16%5C%2Ffib-en-tex.25.png%29%20is%20given.%5Cn%5CnYour%20task%20is%20to%20check%20whether%20a%20string%20of%20the%20form%20%20%20%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI16%5C%2Ffib-en-tex.26.png%29%20%20%20%20is%20a%20substring%20of%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI16%5C%2Ffib-en-tex.27.png%29%20for%20some%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI16%5C%2Ffib-en-tex.28.png%29%2C%20and%20if%20it%20is%2C%20%20%20%20you%20shuold%20find%20minimal%20such%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI16%5C%2Ffib-en-tex.29.png%29.%5Cn%22%2C%22inputFormat%22%3A%22The%20first%20line%20of%20the%20standard%20input%20contains%20a%20single%20integer%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI16%5C%2Ffib-en-tex.30.png%29%2C%20%20%20%20%20%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI16%5C%2Ffib-en-tex.31.png%29.%5Cn%5CnThe%20second%20line%20of%20standard%20input%20holds%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI16%5C%2Ffib-en-tex.32.png%29%20non-negative%20integers%20%20%20%20%20%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI16%5C%2Ffib-en-tex.33.png%29%28%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI16%5C%2Ffib-en-tex.34.png%29%29%2C%20separated%20by%20single%20spaces.%5Cn%22%2C%22outputFormat%22%3A%22Your%20programme%20should%20print%20out%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI16%5C%2Ffib-en-tex.35.png%29%20lines%20to%20the%20standard%20output%2C%20%20%20%20%20one%20for%20each%20test%20unit.%5Cn%5CnYour%20programm%20should%20print%20to%20standard%20output%20minimal%20non-negative%20integer%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI16%5C%2Ffib-en-tex.36.png%29%2C%20%20%20%20%20such%20that%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI16%5C%2Ffib-en-tex.37.png%29%20is%20a%20substring%20of%20%20%20%20%20%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI16%5C%2Ffib-en-tex.38.png%29%2C%20or%20NIE%20%28no%20in%20Polish%29%20if%20such%20%21%5B%5D%28http%3A%5C%2F%5C%2Fmain.edu.pl%5C%2Fimages%5C%2FOI16%5C%2Ffib-en-tex.39.png%29%20doesn%27t%20exist.%5Cn%22%2C%22samples%22%3A%5B%5B%222%5Cn1%202%5Cn%22%2C%224%5Cn%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%5D%2C%22memory%22%3A%5B128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22tags%22%3A%5B26%2C57%2C319%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A3%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22P3490%22%2C%22title%22%3A%22%5BPOI2009%5DFIB-Words%202%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22P%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22%5BPOI2009%5DFIB-Words%202%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573286098;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>[POI2009]FIB-Words 2</h1>
<h2>题目背景</h2>
<div>征求翻译。如果你能提供翻译或者题意简述，请直接发讨论，感谢你的贡献。
</div>
<h2>题目描述</h2>
<div>The following task is a significantly harder version of task Words from the third stage of 16th Polish OI. It wasn't used in the contest itself, but is an extension for those who solved "Words" and want more. :-) Let ![](http://main.edu.pl/images/OI16/fib-en-tex.1.png) be a function acting on strings composed of the digits 0 and 1.
The function ![](http://main.edu.pl/images/OI16/fib-en-tex.2.png) transforms the string ![](http://main.edu.pl/images/OI16/fib-en-tex.3.png) by replacing (independently and concurrently) every digit 0 with 1 and every digit 1 with the string ![](http://main.edu.pl/images/OI16/fib-en-tex.4.png).
For example ![](http://main.edu.pl/images/OI16/fib-en-tex.5.png), ![](http://main.edu.pl/images/OI16/fib-en-tex.6.png) (i.e. ![](http://main.edu.pl/images/OI16/fib-en-tex.7.png) assigns an empty string to the empty string).
Note that ![](http://main.edu.pl/images/OI16/fib-en-tex.8.png) is an injection, or a one-to-one function.
By ![](http://main.edu.pl/images/OI16/fib-en-tex.9.png) we denote the function ![](http://main.edu.pl/images/OI16/fib-en-tex.10.png) composed with itself ![](http://main.edu.pl/images/OI16/fib-en-tex.11.png) times.
In particular, ![](http://main.edu.pl/images/OI16/fib-en-tex.12.png) is the identity function ![](http://main.edu.pl/images/OI16/fib-en-tex.13.png).
We are interested in the strings of the form ![](http://main.edu.pl/images/OI16/fib-en-tex.14.png) for ![](http://main.edu.pl/images/OI16/fib-en-tex.15.png) This sequence begins with the following strings:
![](http://main.edu.pl/images/OI16/fib-en-tex.16.png), ![](http://main.edu.pl/images/OI16/fib-en-tex.17.png), ![](http://main.edu.pl/images/OI16/fib-en-tex.18.png), ![](http://main.edu.pl/images/OI16/fib-en-tex.19.png), ![](http://main.edu.pl/images/OI16/fib-en-tex.20.png), ![](http://main.edu.pl/images/OI16/fib-en-tex.21.png).
We call the string ![](http://main.edu.pl/images/OI16/fib-en-tex.22.png) a substring of the string ![](http://main.edu.pl/images/OI16/fib-en-tex.23.png) if it occurs in ![](http://main.edu.pl/images/OI16/fib-en-tex.24.png) as a contiguous (i.e. one-block) subsequence.
A sequence of integers ![](http://main.edu.pl/images/OI16/fib-en-tex.25.png) is given.
Your task is to check whether a string of the form ![](http://main.edu.pl/images/OI16/fib-en-tex.26.png) is a substring of ![](http://main.edu.pl/images/OI16/fib-en-tex.27.png) for some ![](http://main.edu.pl/images/OI16/fib-en-tex.28.png), and if it is, you shuold find minimal such ![](http://main.edu.pl/images/OI16/fib-en-tex.29.png).
</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line of the standard input contains a single integer ![](http://main.edu.pl/images/OI16/fib-en-tex.30.png), ![](http://main.edu.pl/images/OI16/fib-en-tex.31.png).
The second line of standard input holds ![](http://main.edu.pl/images/OI16/fib-en-tex.32.png) non-negative integers ![](http://main.edu.pl/images/OI16/fib-en-tex.33.png)(![](http://main.edu.pl/images/OI16/fib-en-tex.34.png)), separated by single spaces.
</div>
<h3>输出格式</h3>
<br />
<div>Your programme should print out ![](http://main.edu.pl/images/OI16/fib-en-tex.35.png) lines to the standard output, one for each test unit.
Your programm should print to standard output minimal non-negative integer ![](http://main.edu.pl/images/OI16/fib-en-tex.36.png), such that ![](http://main.edu.pl/images/OI16/fib-en-tex.37.png) is a substring of ![](http://main.edu.pl/images/OI16/fib-en-tex.38.png), or NIE (no in Polish) if such ![](http://main.edu.pl/images/OI16/fib-en-tex.39.png) doesn't exist.
</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>2
1 2
</code></pre>
<h3>输出样例 #1</h3>
<pre><code>4
</code></pre>
</article>
</div>
</div>
</body>
</html>
