<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>[CERC2014]Virus synthesis - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573381775:+FDL1hTwr1X/YTQMg7IJNzkAtMV8NWxSxbONhkwrHhg=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%22%2C%22description%22%3A%22Viruses%20are%20usually%20bad%20for%20your%20health.%20How%20about%20fighting%20them%20with...%20other%20viruses%3F%20In%20this%20problem%2C%20you%20need%20to%20find%20out%20how%20to%20synthesize%20such%20good%20viruses.%5Cn%5CnWe%20have%20prepared%20for%20you%20a%20set%20of%20strings%20of%20the%20letters%20%24A%2C%20G%2C%20T%24%20and%20%24C%24.%20They%20correspond%20to%20the%20DNA%20nucleotide%20sequences%20of%20viruses%20that%20we%20want%20to%20synthesize%2C%20using%20the%20following%20operations%3A%5Cn%5Cn%20%20%20-%20Adding%20a%20nucleotide%20either%20to%20the%20beginning%20or%20the%20end%20of%20the%20existing%20sequence.%5Cn%20%20%20-%20Replicating%20the%20sequence%2C%20reversing%20the%20copied%20piece%2C%20and%20gluing%20it%20either%20to%20the%20beginning%20or%20to%20the%20end%20of%20the%20original%20%28so%20that%20e.g.%2C%20%24AGTC%24%20can%20become%20%24AGTCCTGA%24%20or%20%24CTGAAGTC%24%29.%5Cn%5CnWe%5Cu2019re%20concerned%20about%20efficiency%2C%20since%20we%20have%20very%20many%20such%20sequences%2C%20some%20of%20them%20very%20long.%20Find%20a%20way%20to%20synthesize%20them%20in%20a%20minimum%20number%20of%20operations.%5Cn%22%2C%22inputFormat%22%3A%22The%20first%20line%20of%20input%20contains%20the%20number%20of%20test%20cases%20%24T%24.%20The%20descriptions%20of%20the%20test%20cases%20follow%3A%5Cn%5CnEach%20test%20case%20consists%20of%20a%20single%20line%20containing%20a%20non-empty%20string.%20The%20string%20uses%20only%20the%20capital%20letters%20%24A%2C%20C%2C%20G%24%20and%20%24T%24%20and%20is%20not%20longer%20than%20%24100%20000%24%20characters.%5Cn%22%2C%22outputFormat%22%3A%22For%20each%20test%20case%2C%20output%20a%20single%20line%20containing%20the%20minimum%20total%20number%20of%20operations%20necessary%20to%20construct%20the%20given%20sequence.%5Cn%22%2C%22samples%22%3A%5B%5B%224%5CnAAAA%5CnAGCTTGCA%5CnAAGGGGAAGGGGAA%5CnAAACAGTCCTGACAAAAAAAAAAAAC%22%2C%223%5Cn8%5Cn6%5Cn18%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A41051%2C%22name%22%3A%22%5Cu548c%5Cu6cc9%5Cu6b63%5Cu5b97%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3Anull%2C%22isAdmin%22%3Afalse%2C%22color%22%3A%22Blue%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B10000%2C10000%2C1000%2C10000%5D%2C%22memory%22%3A%5B128000%2C128000%2C128000%2C128000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22translation%22%3A%22%5Cu521d%5Cu59cb%5Cu6709%5Cu4e00%5Cu4e2a%5Cu7a7a%5Cu4e32%5Cuff0c%5Cu5229%5Cu7528%5Cu4e0b%5Cu9762%5Cu7684%5Cu64cd%5Cu4f5c%5Cu6784%5Cu9020%5Cu7ed9%5Cu5b9a%5Cu4e32%20%24S%24%20%5Cu3002%20%20%20%5Cn%5Cn1%5Cu3001%5Cu4e32%5Cu5f00%5Cu5934%5Cu6216%5Cu672b%5Cu5c3e%5Cu52a0%5Cu4e00%5Cu4e2a%5Cu5b57%5Cu7b26%20%20%20%5Cn%5Cn2%5Cu3001%5Cu4e32%5Cu5f00%5Cu5934%5Cu6216%5Cu672b%5Cu5c3e%5Cu52a0%5Cu4e00%5Cu4e2a%5Cu8be5%5Cu4e32%5Cu7684%5Cu9006%5Cu4e32%20%20%20%5Cn%5Cn%5Cu6c42%5Cu6700%5Cu5c0f%5Cu5316%5Cu64cd%5Cu4f5c%5Cu6570%5Cuff0c%20%24%7CS%7C%20%5C%5Cleq%2010%5E5%24%20%5Cu3002%20%20%5Cn%5CnTranslated%20by%20%20%40wasa855%20%22%2C%22tags%22%3A%5B31%2C108%2C319%2C325%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A363%2C%22totalAccepted%22%3A149%2C%22pid%22%3A%22P4762%22%2C%22title%22%3A%22%5BCERC2014%5DVirus%20synthesis%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A139221%2C%22title%22%3A%22%5Cu7591%5Cu95ee%22%2C%22forum%22%3A%7B%22id%22%3A27304%2C%22name%22%3A%22P4762%20%5BCERC2014%5DVirus%20synthesis%22%2C%22slug%22%3A%22P4762%22%7D%7D%2C%7B%22id%22%3A102209%2C%22title%22%3A%22%5Cu524d%5Cu6392%5Cu63d0%5Cu9192%5Cu6b64%5Cu9898%5Cu6570%5Cu636e%5Cu8303%5Cu56f4%5Cu7384%5Cu5b66%22%2C%22forum%22%3A%7B%22id%22%3A27304%2C%22name%22%3A%22P4762%20%5BCERC2014%5DVirus%20synthesis%22%2C%22slug%22%3A%22P4762%22%7D%7D%2C%7B%22id%22%3A63685%2C%22title%22%3A%22%5Cu8fd9%5Cu96be%5Cu5ea6%5Cu8c01%5Cu8bc4%5Cu7684%5Cu2026%5Cu2026%22%2C%22forum%22%3A%7B%22id%22%3A27304%2C%22name%22%3A%22P4762%20%5BCERC2014%5DVirus%20synthesis%22%2C%22slug%22%3A%22P4762%22%7D%7D%2C%7B%22id%22%3A56885%2C%22title%22%3A%22%5Cu7ffb%5Cu8bd1%22%2C%22forum%22%3A%7B%22id%22%3A27304%2C%22name%22%3A%22P4762%20%5BCERC2014%5DVirus%20synthesis%22%2C%22slug%22%3A%22P4762%22%7D%7D%2C%7B%22id%22%3A49392%2C%22title%22%3A%22%5Cu9898%5Cu76ee%22%2C%22forum%22%3A%7B%22id%22%3A27304%2C%22name%22%3A%22P4762%20%5BCERC2014%5DVirus%20synthesis%22%2C%22slug%22%3A%22P4762%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P1659%22%2C%22title%22%3A%22%5B%5Cu56fd%5Cu5bb6%5Cu96c6%5Cu8bad%5Cu961f%5D%5Cu62c9%5Cu62c9%5Cu961f%5Cu6392%5Cu7ec3%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P3804%22%2C%22title%22%3A%22%5Cu3010%5Cu6a21%5Cu677f%5Cu3011%5Cu540e%5Cu7f00%5Cu81ea%5Cu52a8%5Cu673a%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P4112%22%2C%22title%22%3A%22%5BHEOI2015%5D%5Cu6700%5Cu77ed%5Cu4e0d%5Cu516c%5Cu5171%5Cu5b50%5Cu4e32%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P4287%22%2C%22title%22%3A%22%5BSHOI2011%5D%5Cu53cc%5Cu500d%5Cu56de%5Cu6587%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P4555%22%2C%22title%22%3A%22%5B%5Cu56fd%5Cu5bb6%5Cu96c6%5Cu8bad%5Cu961f%5D%5Cu6700%5Cu957f%5Cu53cc%5Cu56de%5Cu6587%5Cu4e32%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22%5BCERC2014%5DVirus%20synthesis%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573295103;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>[CERC2014]Virus synthesis</h1>
<h2>题意翻译</h2>
<div>初始有一个空串，利用下面的操作构造给定串 $S$ 。
1、串开头或末尾加一个字符
2、串开头或末尾加一个该串的逆串
求最小化操作数， $|S| \leq 10^5$ 。
Translated by @wasa855 </div>
<h2>题目描述</h2>
<div>Viruses are usually bad for your health. How about fighting them with... other viruses? In this problem, you need to find out how to synthesize such good viruses.
We have prepared for you a set of strings of the letters $A, G, T$ and $C$. They correspond to the DNA nucleotide sequences of viruses that we want to synthesize, using the following operations:
- Adding a nucleotide either to the beginning or the end of the existing sequence.
- Replicating the sequence, reversing the copied piece, and gluing it either to the beginning or to the end of the original (so that e.g., $AGTC$ can become $AGTCCTGA$ or $CTGAAGTC$).
We’re concerned about efficiency, since we have very many such sequences, some of them very long. Find a way to synthesize them in a minimum number of operations.
</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line of input contains the number of test cases $T$. The descriptions of the test cases follow:
Each test case consists of a single line containing a non-empty string. The string uses only the capital letters $A, C, G$ and $T$ and is not longer than $100 000$ characters.
</div>
<h3>输出格式</h3>
<br />
<div>For each test case, output a single line containing the minimum total number of operations necessary to construct the given sequence.
</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>4
AAAA
AGCTTGCA
AAGGGGAAGGGGAA
AAACAGTCCTGACAAAAAAAAAAAAC</code></pre>
<h3>输出样例 #1</h3>
<pre><code>3
8
6
18</code></pre>
</article>
</div>
</div>
</body>
</html>
