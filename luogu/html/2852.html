<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>[USACO06DEC]牛奶模式Milk Patterns - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573376052:uK/owbhFYCj2PjzaCtDU49cIDSJcNyxnZx1TjeD215I=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%22%2C%22description%22%3A%22Farmer%20John%20has%20noticed%20that%20the%20quality%20of%20milk%20given%20by%20his%20cows%20varies%20from%20day%20to%20day.%20On%20further%20investigation%2C%20he%20discovered%20that%20although%20he%20can%27t%20predict%20the%20quality%20of%20milk%20from%20one%20day%20to%20the%20next%2C%20there%20are%20some%20regular%20patterns%20in%20the%20daily%20milk%20quality.%5Cn%5CnTo%20perform%20a%20rigorous%20study%2C%20he%20has%20invented%20a%20complex%20classification%20scheme%20by%20which%20each%20milk%20sample%20is%20recorded%20as%20an%20integer%20between%200%20and%201%2C000%2C000%20inclusive%2C%20and%20has%20recorded%20data%20from%20a%20single%20cow%20over%20N%20%281%20%5Cu2264%20N%20%5Cu2264%2020%2C000%29%20days.%20He%20wishes%20to%20find%20the%20longest%20pattern%20of%20samples%20which%20repeats%20identically%20at%20least%20K%20%282%20%5Cu2264%20K%20%5Cu2264%20N%29%20times.%20This%20may%20include%20overlapping%20patterns%20--%201%202%203%202%203%202%203%201%20repeats%202%203%202%203%20twice%2C%20for%20example.%5Cn%5CnHelp%20Farmer%20John%20by%20finding%20the%20longest%20repeating%20subsequence%20in%20the%20sequence%20of%20samples.%20It%20is%20guaranteed%20that%20at%20least%20one%20subsequence%20is%20repeated%20at%20least%20K%20times.%5Cn%5Cn%5Cu519c%5Cu592bJohn%5Cu53d1%5Cu73b0%5Cu4ed6%5Cu7684%5Cu5976%5Cu725b%5Cu4ea7%5Cu5976%5Cu7684%5Cu8d28%5Cu91cf%5Cu4e00%5Cu76f4%5Cu5728%5Cu53d8%5Cu52a8%5Cu3002%5Cu7ecf%5Cu8fc7%5Cu7ec6%5Cu81f4%5Cu7684%5Cu8c03%5Cu67e5%5Cuff0c%5Cu4ed6%5Cu53d1%5Cu73b0%5Cuff1a%5Cu867d%5Cu7136%5Cu4ed6%5Cu4e0d%5Cu80fd%5Cu9884%5Cu89c1%5Cu660e%5Cu5929%5Cu4ea7%5Cu5976%5Cu7684%5Cu8d28%5Cu91cf%5Cuff0c%5Cu4f46%5Cu8fde%5Cu7eed%5Cu7684%5Cu82e5%5Cu5e72%5Cu5929%5Cu7684%5Cu8d28%5Cu91cf%5Cu6709%5Cu5f88%5Cu591a%5Cu91cd%5Cu53e0%5Cu3002%5Cu6211%5Cu4eec%5Cu79f0%5Cu4e4b%5Cu4e3a%5Cu4e00%5Cu4e2a%5Cu201c%5Cu6a21%5Cu5f0f%5Cu201d%5Cu3002%20John%5Cu7684%5Cu725b%5Cu5976%5Cu6309%5Cu8d28%5Cu91cf%5Cu53ef%5Cu4ee5%5Cu88ab%5Cu8d4b%5Cu4e88%5Cu4e00%5Cu4e2a0%5Cu52301000000%5Cu4e4b%5Cu95f4%5Cu7684%5Cu6570%5Cu3002%5Cu5e76%5Cu4e14John%5Cu8bb0%5Cu5f55%5Cu4e86N%281%3C%3DN%3C%3D20000%29%5Cu5929%5Cu7684%5Cu725b%5Cu5976%5Cu8d28%5Cu91cf%5Cu503c%5Cu3002%5Cu4ed6%5Cu60f3%5Cu77e5%5Cu9053%5Cu6700%5Cu957f%5Cu7684%5Cu51fa%5Cu73b0%5Cu4e86%5Cu81f3%5Cu5c11K%282%3C%3DK%3C%3DN%29%5Cu6b21%5Cu7684%5Cu6a21%5Cu5f0f%5Cu7684%5Cu957f%5Cu5ea6%5Cu3002%5Cu6bd4%5Cu59821%202%203%202%203%202%203%201%20%5Cu4e2d%202%203%202%203%5Cu51fa%5Cu73b0%5Cu4e86%5Cu4e24%5Cu6b21%5Cu3002%5Cu5f53K%3D2%5Cu65f6%5Cuff0c%5Cu8fd9%5Cu4e2a%5Cu957f%5Cu5ea6%5Cu4e3a4%5Cu3002%5Cn%22%2C%22inputFormat%22%3A%22Line%201%3A%20Two%20space-separated%20integers%3A%20N%20and%20K%5Cn%5Cn%5CnLines%202..N%2B1%3A%20N%20integers%2C%20one%20per%20line%2C%20the%20quality%20of%20the%20milk%20on%20day%20i%20appears%20on%20the%20ith%20line.%5Cn%22%2C%22outputFormat%22%3A%22Line%201%3A%20One%20integer%2C%20the%20length%20of%20the%20longest%20pattern%20which%20occurs%20at%20least%20K%20times%5Cn%22%2C%22samples%22%3A%5B%5B%228%202%5Cr%5Cn1%5Cr%5Cn2%5Cr%5Cn3%5Cr%5Cn2%5Cr%5Cn3%5Cr%5Cn2%5Cr%5Cn3%5Cr%5Cn1%22%2C%224%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A20%2C%22name%22%3A%22FarmerJohn2%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3Anull%2C%22isAdmin%22%3Afalse%2C%22color%22%3A%22Gray%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%5D%2C%22memory%22%3A%5B128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22tags%22%3A%5B23%2C45%2C46%2C235%2C303%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A2663%2C%22totalAccepted%22%3A1145%2C%22pid%22%3A%22P2852%22%2C%22title%22%3A%22%5BUSACO06DEC%5D%5Cu725b%5Cu5976%5Cu6a21%5Cu5f0fMilk%20Patterns%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A138161%2C%22title%22%3A%22%5Cu6570%5Cu636e%5Cu8fc7%5Cu6c34%22%2C%22forum%22%3A%7B%22id%22%3A1982%2C%22name%22%3A%22P2852%20%5BUSACO06DEC%5D%5Cu725b%5Cu5976%5Cu6a21%5Cu5f0fMilk%20Patterns%22%2C%22slug%22%3A%22P2852%22%7D%7D%2C%7B%22id%22%3A128604%2C%22title%22%3A%22%5Cu840c%5Cu65b0%5Cu521a%5Cu5b66OI%5Cuff0c%5Cu6551%5Cu6551%5Cu5b69%5Cu5b50%5Cu5427%5Cuff01%5Cuff01%5Cuff01%22%2C%22forum%22%3A%7B%22id%22%3A1982%2C%22name%22%3A%22P2852%20%5BUSACO06DEC%5D%5Cu725b%5Cu5976%5Cu6a21%5Cu5f0fMilk%20Patterns%22%2C%22slug%22%3A%22P2852%22%7D%7D%2C%7B%22id%22%3A113403%2C%22title%22%3A%22%5Cu4e3a%5Cu4ec0%5Cu4e48%5Cu8bf4%5Cu8fd9%5Cu9898%5Cu6570%5Cu636e%5Cu6c34%5Cuff1f%22%2C%22forum%22%3A%7B%22id%22%3A1982%2C%22name%22%3A%22P2852%20%5BUSACO06DEC%5D%5Cu725b%5Cu5976%5Cu6a21%5Cu5f0fMilk%20Patterns%22%2C%22slug%22%3A%22P2852%22%7D%7D%2C%7B%22id%22%3A55647%2C%22title%22%3A%22%5Cu6211%5Cu662f%5Cu840c%5Cu65b0%5Cuff0c%5Cu521a%5Cu5b66OI%5Cuff0c%5Cu6c42%5Cu6559%5Cu6b64%5Cu989860%5Cu5206%5Cu600e%5Cu4e48%5Cu7834%22%2C%22forum%22%3A%7B%22id%22%3A1982%2C%22name%22%3A%22P2852%20%5BUSACO06DEC%5D%5Cu725b%5Cu5976%5Cu6a21%5Cu5f0fMilk%20Patterns%22%2C%22slug%22%3A%22P2852%22%7D%7D%2C%7B%22id%22%3A9820%2C%22title%22%3A%22%5Cu6570%5Cu636e%5Cu592a%5Cu6c34%22%2C%22forum%22%3A%7B%22id%22%3A1982%2C%22name%22%3A%22P2852%20%5BUSACO06DEC%5D%5Cu725b%5Cu5976%5Cu6a21%5Cu5f0fMilk%20Patterns%22%2C%22slug%22%3A%22P2852%22%7D%7D%2C%7B%22id%22%3A9209%2C%22title%22%3A%22%5Cu6570%5Cu636e%5Cu8303%5Cu56f4%5Cu6709%5Cu8bef%22%2C%22forum%22%3A%7B%22id%22%3A1982%2C%22name%22%3A%22P2852%20%5BUSACO06DEC%5D%5Cu725b%5Cu5976%5Cu6a21%5Cu5f0fMilk%20Patterns%22%2C%22slug%22%3A%22P2852%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P2463%22%2C%22title%22%3A%22%5BSDOI2008%5DSandy%5Cu7684%5Cu5361%5Cu7247%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P3181%22%2C%22title%22%3A%22%5BHAOI2016%5D%5Cu627e%5Cu76f8%5Cu540c%5Cu5b57%5Cu7b26%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P4051%22%2C%22title%22%3A%22%5BJSOI2007%5D%5Cu5b57%5Cu7b26%5Cu52a0%5Cu5bc6%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22SP694%22%2C%22title%22%3A%22DISUBSTR%20-%20Distinct%20Substrings%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22SP%22%7D%2C%7B%22pid%22%3A%22P4248%22%2C%22title%22%3A%22%5BAHOI2013%5D%5Cu5dee%5Cu5f02%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22%5BUSACO06DEC%5D%5Cu725b%5Cu5976%5Cu6a21%5Cu5f0fMilk%20Patterns%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573286098;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>[USACO06DEC]牛奶模式Milk Patterns</h1>
<h2>题目描述</h2>
<div>Farmer John has noticed that the quality of milk given by his cows varies from day to day. On further investigation, he discovered that although he can't predict the quality of milk from one day to the next, there are some regular patterns in the daily milk quality.
To perform a rigorous study, he has invented a complex classification scheme by which each milk sample is recorded as an integer between 0 and 1,000,000 inclusive, and has recorded data from a single cow over N (1 ≤ N ≤ 20,000) days. He wishes to find the longest pattern of samples which repeats identically at least K (2 ≤ K ≤ N) times. This may include overlapping patterns -- 1 2 3 2 3 2 3 1 repeats 2 3 2 3 twice, for example.
Help Farmer John by finding the longest repeating subsequence in the sequence of samples. It is guaranteed that at least one subsequence is repeated at least K times.
农夫John发现他的奶牛产奶的质量一直在变动。经过细致的调查，他发现：虽然他不能预见明天产奶的质量，但连续的若干天的质量有很多重叠。我们称之为一个“模式”。 John的牛奶按质量可以被赋予一个0到1000000之间的数。并且John记录了N(1<=N<=20000)天的牛奶质量值。他想知道最长的出现了至少K(2<=K<=N)次的模式的长度。比如1 2 3 2 3 2 3 1 中 2 3 2 3出现了两次。当K=2时，这个长度为4。
</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>Line 1: Two space-separated integers: N and K
Lines 2..N+1: N integers, one per line, the quality of the milk on day i appears on the ith line.
</div>
<h3>输出格式</h3>
<br />
<div>Line 1: One integer, the length of the longest pattern which occurs at least K times
</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>8 2
1
2
3
2
3
2
3
1</code></pre>
<h3>输出样例 #1</h3>
<pre><code>4</code></pre>
</article>
</div>
</div>
</body>
</html>
