<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>[USACO14JAN]Cross Country Skiing 越野滑雪 - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573382012:0Sm3/6MATE6qWDtVs6FFMTvwP0Ag/Ahx36/hVt8btac=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%22%2C%22description%22%3A%22The%20cross-country%20skiing%20course%20at%20the%20winter%20Moolympics%20is%20described%20by%20an%20%24M%20%2A%20N%24%20grid%20of%20elevations%20%281%20%3C%3D%20M%2CN%20%3C%3D%20500%29%2C%20each%20elevation%20being%20in%20the%20range%200%20..%201%2C000%2C000%2C000.%20%20%5Cn%5CnSome%20of%20the%20cells%20in%20this%20grid%20are%20designated%20as%20waypoints%20for%20the%20course.%20%20The%20organizers%20of%20the%20Moolympics%20want%20to%20assign%20a%20difficulty%20rating%20%24D%24%20to%20the%20entire%20course%20so%20that%20a%20cow%20can%20reach%20any%20waypoint%20from%20any%20other%20waypoint%20by%20repeatedly%20skiing%20from%20a%20cell%20to%20an%20adjacent%20cell%20with%20absolute%20elevation%20difference%20at%20most%20%24D%24.%20%20Two%20cells%20are%20adjacent%20if%20one%20is%20directly%20north%2C%20south%2C%20east%2C%20or%20west%20of%20the%20other.%20%20The%20difficulty%20rating%20of%20the%20course%20is%20the%20minimum%20value%20of%20%24D%24%20such%20that%20all%20waypoints%20are%20mutually%20reachable%20in%20this%20fashion.%22%2C%22inputFormat%22%3A%22%2A%20Line%201%3A%20The%20integers%20%24M%24%20and%20%24N%24.%5Cn%5Cn%2A%20Lines%202..1%2BM%3A%20Each%20of%20these%20%24M%24%20lines%20contains%20%24N%24%20integer%20elevations.%5Cn%5Cn%2A%20Lines%202%2BM..1%2B2M%3A%20Each%20of%20these%20%24M%24%20lines%20contains%20%24N%24%20values%20that%20are%20either%20%240%24%20or%20%241%24%2C%20with%20%241%24%20indicating%20a%20cell%20that%20is%20a%20waypoint.%22%2C%22outputFormat%22%3A%22The%20ski%20course%20is%20described%20by%20a%203%20x%205%20grid%20of%20elevations.%20%20The%20upper-left%2C%20upper-right%2C%20and%20lower-right%20cells%20are%20designated%20as%20waypoints.%22%2C%22samples%22%3A%5B%5B%223%205%5Cn20%2021%2018%2099%205%5Cn19%2022%2020%2016%2026%5Cn18%2017%2040%2060%2080%5Cn1%200%200%200%201%5Cn0%200%200%200%200%5Cn0%200%200%200%201%22%2C%2221%22%5D%5D%2C%22hint%22%3A%22If%20D%20%3D%2021%2C%20the%20three%20waypoints%20are%20reachable%20from%20each-other.%20%20If%20D%20%3C%2021%2C%20then%20the%20upper-right%20waypoint%20cannot%20be%20reached%20from%20the%20other%20two.%22%2C%22provider%22%3A%7B%22uid%22%3A57705%2C%22name%22%3A%22%5Cu4ffa%5Cu662f%5Cu5c0f%5Cu7a0b%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3Anull%2C%22isAdmin%22%3Afalse%2C%22color%22%3A%22Blue%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%5D%2C%22memory%22%3A%5B128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22tags%22%3A%5B31%2C46%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A206%2C%22totalAccepted%22%3A79%2C%22pid%22%3A%22P4955%22%2C%22title%22%3A%22%5BUSACO14JAN%5DCross%20Country%20Skiing%20%5Cu8d8a%5Cu91ce%5Cu6ed1%5Cu96ea%22%2C%22difficulty%22%3A4%2C%22type%22%3A%22P%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A102656%2C%22title%22%3A%22%5Cu7ffb%5Cu8bd1%22%2C%22forum%22%3A%7B%22id%22%3A31446%2C%22name%22%3A%22P4955%20%5BUSACO14JAN%5DCross%20Country%20Skiing%20%5Cu8d8a%5Cu91ce%5Cu6ed1%5Cu96ea%22%2C%22slug%22%3A%22P4955%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P2338%22%2C%22title%22%3A%22%5BUSACO14JAN%5D%5Cu5931%5Cu8d25%5Cu7684%5Cu6ed1%5Cu96eaBessie%20Slows%20Down%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P3115%22%2C%22title%22%3A%22%5BUSACO15JAN%5D%5Cu725b%5Cu8def%5Cu7ebfCow%20Routing%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P3116%22%2C%22title%22%3A%22%5BUSACO15JAN%5D%5Cu7ea6%5Cu4f1a%5Cu65f6%5Cu95f4Meeting%20Time%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P3469%22%2C%22title%22%3A%22%5BPOI2008%5DBLO-Blockade%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P4779%22%2C%22title%22%3A%22%5Cu3010%5Cu6a21%5Cu677f%5Cu3011%5Cu5355%5Cu6e90%5Cu6700%5Cu77ed%5Cu8def%5Cu5f84%5Cuff08%5Cu6807%5Cu51c6%5Cu7248%5Cuff09%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22P%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22%5BUSACO14JAN%5DCross%20Country%20Skiing%20%5Cu8d8a%5Cu91ce%5Cu6ed1%5Cu96ea%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573286098;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>[USACO14JAN]Cross Country Skiing 越野滑雪</h1>
<h2>题目描述</h2>
<div>The cross-country skiing course at the winter Moolympics is described by an $M * N$ grid of elevations (1 <= M,N <= 500), each elevation being in the range 0 .. 1,000,000,000.
Some of the cells in this grid are designated as waypoints for the course. The organizers of the Moolympics want to assign a difficulty rating $D$ to the entire course so that a cow can reach any waypoint from any other waypoint by repeatedly skiing from a cell to an adjacent cell with absolute elevation difference at most $D$. Two cells are adjacent if one is directly north, south, east, or west of the other. The difficulty rating of the course is the minimum value of $D$ such that all waypoints are mutually reachable in this fashion.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>* Line 1: The integers $M$ and $N$.
* Lines 2..1+M: Each of these $M$ lines contains $N$ integer elevations.
* Lines 2+M..1+2M: Each of these $M$ lines contains $N$ values that are either $0$ or $1$, with $1$ indicating a cell that is a waypoint.</div>
<h3>输出格式</h3>
<br />
<div>The ski course is described by a 3 x 5 grid of elevations. The upper-left, upper-right, and lower-right cells are designated as waypoints.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>3 5
20 21 18 99 5
19 22 20 16 26
18 17 40 60 80
1 0 0 0 1
0 0 0 0 0
0 0 0 0 1</code></pre>
<h3>输出样例 #1</h3>
<pre><code>21</code></pre>
<h2>说明</h2>
<div>If D = 21, the three waypoints are reachable from each-other. If D < 21, then the upper-right waypoint cannot be reached from the other two.</div>
</article>
</div>
</div>
</body>
</html>
