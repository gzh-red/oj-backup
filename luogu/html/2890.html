<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>[USACO07OPEN]便宜的回文Cheapest Palindrome - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573376107:rNpqYhH/a3E79CPkNaSGaSFUeryVh5m1NBjKMN+91l0=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%22%2C%22description%22%3A%22Keeping%20track%20of%20all%20the%20cows%20can%20be%20a%20tricky%20task%20so%20Farmer%20John%20has%20installed%20a%20system%20to%20automate%20it.%20He%20has%20installed%20on%20each%20cow%20an%20electronic%20ID%20tag%20that%20the%20system%20will%20read%20as%20the%20cows%20pass%20by%20a%20scanner.%20Each%20ID%20tag%27s%20contents%20are%20currently%20a%20single%20string%20with%20length%20M%20%281%20%5Cu2264%20M%20%5Cu2264%202%2C000%29%20characters%20drawn%20from%20an%20alphabet%20of%20N%20%281%20%5Cu2264%20N%20%5Cu2264%2026%29%20different%20symbols%20%28namely%2C%20the%20lower-case%20roman%20alphabet%29.%5Cn%5CnCows%2C%20being%20the%20mischievous%20creatures%20they%20are%2C%20sometimes%20try%20to%20spoof%20the%20system%20by%20walking%20backwards.%20While%20a%20cow%20whose%20ID%20is%20%5C%22abcba%5C%22%20would%20read%20the%20same%20no%20matter%20which%20direction%20the%20she%20walks%2C%20a%20cow%20with%20the%20ID%20%5C%22abcb%5C%22%20can%20potentially%20register%20as%20two%20different%20IDs%20%28%5C%22abcb%5C%22%20and%20%5C%22bcba%5C%22%29.%5Cn%5CnFJ%20would%20like%20to%20change%20the%20cows%27s%20ID%20tags%20so%20they%20read%20the%20same%20no%20matter%20which%20direction%20the%20cow%20walks%20by.%20For%20example%2C%20%5C%22abcb%5C%22%20can%20be%20changed%20by%20adding%20%5C%22a%5C%22%20at%20the%20end%20to%20form%20%5C%22abcba%5C%22%20so%20that%20the%20ID%20is%20palindromic%20%28reads%20the%20same%20forwards%20and%20backwards%29.%20Some%20other%20ways%20to%20change%20the%20ID%20to%20be%20palindromic%20are%20include%20adding%20the%20three%20letters%20%5C%22bcb%5C%22%20to%20the%20begining%20to%20yield%20the%20ID%20%5C%22bcbabcb%5C%22%20or%20removing%20the%20letter%20%5C%22a%5C%22%20to%20yield%20the%20ID%20%5C%22bcb%5C%22.%20One%20can%20add%20or%20remove%20characters%20at%20any%20location%20in%20the%20string%20yielding%20a%20string%20longer%20or%20shorter%20than%20the%20original%20string.%5Cn%5CnUnfortunately%20as%20the%20ID%20tags%20are%20electronic%2C%20each%20character%20insertion%20or%20deletion%20has%20a%20cost%20%280%20%5Cu2264%20cost%20%5Cu2264%2010%2C000%29%20which%20varies%20depending%20on%20exactly%20which%20character%20value%20to%20be%20added%20or%20deleted.%20Given%20the%20content%20of%20a%20cow%27s%20ID%20tag%20and%20the%20cost%20of%20inserting%20or%20deleting%20each%20of%20the%20alphabet%27s%20characters%2C%20find%20the%20minimum%20cost%20to%20change%20the%20ID%20tag%20so%20it%20satisfies%20FJ%27s%20requirements.%20An%20empty%20ID%20tag%20is%20considered%20to%20satisfy%20the%20requirements%20of%20reading%20the%20same%20forward%20and%20backward.%20Only%20letters%20with%20associated%20costs%20can%20be%20added%20to%20a%20string.%5Cn%5Cn%5Cu5b57%5Cu4e32S%5Cu957fM%5Cuff0c%5Cu7531N%5Cu4e2a%5Cu5c0f%5Cu5199%5Cu5b57%5Cu6bcd%5Cu6784%5Cu6210%5Cu3002%5Cu6b32%5Cu901a%5Cu8fc7%5Cu589e%5Cu5220%5Cu5b57%5Cu6bcd%5Cu5c06%5Cu5176%5Cu53d8%5Cu4e3a%5Cu56de%5Cu6587%5Cu4e32%5Cuff0c%5Cu589e%5Cu5220%5Cu7279%5Cu5b9a%5Cu5b57%5Cu6bcd%5Cu82b1%5Cu8d39%5Cu4e0d%5Cu540c%5Cuff0c%5Cu6c42%5Cu6700%5Cu5c0f%5Cu82b1%5Cu8d39%5Cu3002%5Cn%22%2C%22inputFormat%22%3A%22Line%201%3A%20Two%20space-separated%20integers%3A%20N%20and%20M%5Cn%5Cn%5CnLine%202%3A%20This%20line%20contains%20exactly%20M%20characters%20which%20constitute%20the%20initial%20ID%20string%5Cn%5Cn%5CnLines%203..N%2B2%3A%20Each%20line%20contains%20three%20space-separated%20entities%3A%20a%20character%20of%20the%20input%20alphabet%20and%20two%20integers%20which%20are%20respectively%20the%20cost%20of%20adding%20and%20deleting%20that%20character.%5Cn%22%2C%22outputFormat%22%3A%22Line%201%3A%20A%20single%20line%20with%20a%20single%20integer%20that%20is%20the%20minimum%20cost%20to%20change%20the%20given%20name%20tag.%5Cn%22%2C%22samples%22%3A%5B%5B%223%204%5Cr%5Cnabcb%5Cr%5Cna%201000%201100%5Cr%5Cnb%20350%20700%5Cr%5Cnc%20200%20800%22%2C%22900%22%5D%5D%2C%22hint%22%3A%22If%20we%20insert%20an%20%5C%22a%5C%22%20on%20the%20end%20to%20get%20%5C%22abcba%5C%22%2C%20the%20cost%20would%20be%201000.%20If%20we%20delete%20the%20%5C%22a%5C%22%20on%20the%20beginning%20to%20get%20%5C%22bcb%5C%22%2C%20the%20cost%20would%20be%201100.%20If%20we%20insert%20%5C%22bcb%5C%22%20at%20the%20begining%20of%20the%20string%2C%20the%20cost%20would%20be%20350%20%2B%20200%20%2B%20350%20%3D%20900%2C%20which%20is%20the%20minimum.%5Cn%22%2C%22provider%22%3A%7B%22uid%22%3A20%2C%22name%22%3A%22FarmerJohn2%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3Anull%2C%22isAdmin%22%3Afalse%2C%22color%22%3A%22Gray%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%2C1000%5D%2C%22memory%22%3A%5B128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%2C128000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22tags%22%3A%5B2%2C3%2C12%2C24%2C46%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A1055%2C%22totalAccepted%22%3A559%2C%22pid%22%3A%22P2890%22%2C%22title%22%3A%22%5BUSACO07OPEN%5D%5Cu4fbf%5Cu5b9c%5Cu7684%5Cu56de%5Cu6587Cheapest%20Palindrome%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22P%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A125733%2C%22title%22%3A%2290%5Cu5206%5Cu6c42%5Cu52a9%22%2C%22forum%22%3A%7B%22id%22%3A2020%2C%22name%22%3A%22P2890%20%5BUSACO07OPEN%5D%5Cu4fbf%5Cu5b9c%5Cu7684%5Cu56de%5Cu6587Cheapest%20Palindrome%22%2C%22slug%22%3A%22P2890%22%7D%7D%2C%7B%22id%22%3A6134%2C%22title%22%3A%22%5Cu7ffb%5Cu8bd1%22%2C%22forum%22%3A%7B%22id%22%3A2020%2C%22name%22%3A%22P2890%20%5BUSACO07OPEN%5D%5Cu4fbf%5Cu5b9c%5Cu7684%5Cu56de%5Cu6587Cheapest%20Palindrome%22%2C%22slug%22%3A%22P2890%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P1272%22%2C%22title%22%3A%22%5Cu91cd%5Cu5efa%5Cu9053%5Cu8def%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P2285%22%2C%22title%22%3A%22%5BHNOI2004%5D%5Cu6253%5Cu9f39%5Cu9f20%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P2889%22%2C%22title%22%3A%22%5BUSACO07NOV%5D%5Cu6324%5Cu5976%5Cu7684%5Cu65f6%5Cu95f4Milking%20Time%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P2893%22%2C%22title%22%3A%22%5BUSACO08FEB%5D%5Cu4fee%5Cu8defMaking%20the%20Grade%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P2915%22%2C%22title%22%3A%22%5BUSACO08NOV%5D%5Cu5976%5Cu725b%5Cu6df7%5Cu5408%5Cu8d77%5Cu6765Mixed%20Up%20Cows%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22P%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22%5BUSACO07OPEN%5D%5Cu4fbf%5Cu5b9c%5Cu7684%5Cu56de%5Cu6587Cheapest%20Palindrome%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>[USACO07OPEN]便宜的回文Cheapest Palindrome</h1>
<h2>题目描述</h2>
<div>Keeping track of all the cows can be a tricky task so Farmer John has installed a system to automate it. He has installed on each cow an electronic ID tag that the system will read as the cows pass by a scanner. Each ID tag's contents are currently a single string with length M (1 ≤ M ≤ 2,000) characters drawn from an alphabet of N (1 ≤ N ≤ 26) different symbols (namely, the lower-case roman alphabet).
Cows, being the mischievous creatures they are, sometimes try to spoof the system by walking backwards. While a cow whose ID is "abcba" would read the same no matter which direction the she walks, a cow with the ID "abcb" can potentially register as two different IDs ("abcb" and "bcba").
FJ would like to change the cows's ID tags so they read the same no matter which direction the cow walks by. For example, "abcb" can be changed by adding "a" at the end to form "abcba" so that the ID is palindromic (reads the same forwards and backwards). Some other ways to change the ID to be palindromic are include adding the three letters "bcb" to the begining to yield the ID "bcbabcb" or removing the letter "a" to yield the ID "bcb". One can add or remove characters at any location in the string yielding a string longer or shorter than the original string.
Unfortunately as the ID tags are electronic, each character insertion or deletion has a cost (0 ≤ cost ≤ 10,000) which varies depending on exactly which character value to be added or deleted. Given the content of a cow's ID tag and the cost of inserting or deleting each of the alphabet's characters, find the minimum cost to change the ID tag so it satisfies FJ's requirements. An empty ID tag is considered to satisfy the requirements of reading the same forward and backward. Only letters with associated costs can be added to a string.
字串S长M，由N个小写字母构成。欲通过增删字母将其变为回文串，增删特定字母花费不同，求最小花费。
</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>Line 1: Two space-separated integers: N and M
Line 2: This line contains exactly M characters which constitute the initial ID string
Lines 3..N+2: Each line contains three space-separated entities: a character of the input alphabet and two integers which are respectively the cost of adding and deleting that character.
</div>
<h3>输出格式</h3>
<br />
<div>Line 1: A single line with a single integer that is the minimum cost to change the given name tag.
</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>3 4
abcb
a 1000 1100
b 350 700
c 200 800</code></pre>
<h3>输出样例 #1</h3>
<pre><code>900</code></pre>
<h2>说明</h2>
<div>If we insert an "a" on the end to get "abcba", the cost would be 1000. If we delete the "a" on the beginning to get "bcb", the cost would be 1100. If we insert "bcb" at the begining of the string, the cost would be 350 + 200 + 350 = 900, which is the minimum.
</div>
</article>
</div>
</div>
</body>
</html>
